try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['suiteextensionscontrols.js'] = (new Date()).getTime();
var __extends=this.__extends||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);function r(){this.constructor=n}r.prototype=t.prototype;n.prototype=new r};function InitializeIconControls(){for(var t=document.querySelectorAll(".registerFileIcon"),u=SuiteExtensionsDataStore.GetInstance(),n=0;n<t.length;n++){var r=t[n].title.split(".");var i=r[r.length-1];var o=u.GetFileHandlerProperty("appId",i);var e=u.GetFileHandlerProperty("fileIcon",i);var f=new IconControl(i,o,e);f.Render(t[n])}}var SuiteExtensionsControl=function(){function n(n,t){this.dataStore=SuiteExtensionsDataStore.GetInstance();this.appId=t;this.fileExtension=n}n.prototype.get_appId=function(){return this.appId};n.prototype.get_fileExtension=function(){return this.fileExtension};return n}();var DocumentControl=function(n){__extends(t,n);function t(t,i,r,u,f,e){n.call(this,t,i);this.documentUrl=r;this.resourceId=u;this.cultureName=f;this.host=e}t.prototype.set_httpRoot=function(n){this.httpRoot=n};t.prototype.set_itemUrl=function(){return this.httpRoot};t.prototype.render=function(n,t,i,r,u){if(n!=null&&this.documentUrl!=null&&this.documentUrl!=""){var e=this.getNewForm(t,i,r);if(u){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_UsingFullWindow");n.appendChild(e)}else{this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_UsingChildIFrame");var f=document.createElement("iframe");f.style.width="100%";f.style.height="100%";f.style.borderWidth="0px";n.appendChild(f);var o=f.contentDocument;o.body==null&&o.write("<body></body>");o.body.appendChild(e);e=f.contentDocument.getElementsByTagName("form")[0]}e.submit();if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessCallingDocumentControlFormPost");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingUrlToGetDocument",!1,"Clicked link to interact with the file using app with file extension definition")}}};t.prototype.getNewForm=function(n,t,i){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_GeneratingContentRetrievalForm");var r=document.createElement("form");r.action=this.documentUrl;r.method="POST";r.style.visibility="Hidden";r.appendChild(this.newFormInput("fileget",t));r.appendChild(this.newFormInput("fileput",n));r.appendChild(this.newFormInput("fileid",i));r.appendChild(this.newFormInput("resourceid",this.resourceId));r.appendChild(this.newFormInput("culturename",this.cultureName));r.appendChild(this.newFormInput("client",this.host));var u=document.createElement("input");u.type="submit";r.appendChild(u);if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessCallingPreviewIframePost");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingPreviewUrl",!1,"Clicked preview to preview the file from app using file extension definition")}return r};t.prototype.newFormInput=function(n,t){var i=document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;return i};t.prototype.getRedirectUrl=function(){var n;if(this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.host=="SharePoint"){var t="/_layouts/15/online/cloudappsredirect.aspx?extensiontype=files";n=this.httpRoot+t+"&appurl="+this.documentUrl+"&appid="+this.get_appId()+"&itemurl="+this.itemUrl}return n};return t}(SuiteExtensionsControl);var IconControl=function(n){__extends(t,n);function t(t,i,r){n.call(this,t,i);this.iconUrl=r}t.prototype.Render=function(n){if(this.iconUrl!=null&&this.iconUrl!=""){var t=n;if(t!=null){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartUsingDocIconFromApp");t.setAttribute("src",this.iconUrl);t.setAttribute("width","16");t.setAttribute("height","16");if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessUsingDocIconFromApp");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingDocIconFromApp",!1,"App Icon loaded using file extension definition")}}}};return t}(SuiteExtensionsControl);var EditControl=function(n){__extends(t,n);function t(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e);this.openUrl=r}t.prototype.updateElement=function(n){if(this.openUrl!=null&&this.openUrl!=""){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartUpdateOpenUrl");n.setAttribute("href",this.getRedirectUrl());if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessUpdateOpenUrl");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingOpenUrl",!1,"FED app is installed as custom open url is not empty. Clicked open to open the file from app using file extension definition.")}}};return t}(DocumentControl);var PreviewControl=function(n){__extends(t,n);function t(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e);this.previewUrl=r}t.prototype.appendCustomIframe=function(n){if(this.previewUrl!=null&&this.previewUrl!=""){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartCallingCustomPreviewIframe");var t=document.createElement("iframe");t.setAttribute("width","350");t.setAttribute("height","250");t.setAttribute("src",this.getRedirectUrl());if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessCallingCustomPreviewIframe");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingCustomPreviewUrl",!1,"FED app is installed as custom preview url is not empty. Clicked preview to preview the file from app using file extension definition")}n.appendChild(t)}};return t}(DocumentControl);
window.scriptsLoaded['suiteextensionscontrols.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['suiteextensionscontrols.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
