try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.p.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.b()&&t.g().a()<9);var r=i.c().bl.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.m()&&i.m().bl.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bl.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={a:function(n,t,i){n.e(_mcp.C).b(IMailComposeActionFactory).a();n.e(_mcp.O).b(IGroupInlineComposeActionFactory).a();var v=this;n.b(_mcp.X,function(){return new _mcp.X(n.a(IInferenceTracker),n.a(_g.a),n.a(IMailComposeContextFactory),n.a(_mcp.C),n.d(ISmimeCommandFactory))}).b(IMailResponseViewModelFactory).a();var y=this;n.b(_mcp.R,function(){return new _mcp.R(n.a(_y.dz),n.a(_a.t))}).b(IMailComposeContextFactory).a();var e=n.a(_a.e);var o=n.a(_g.f);var f=MailComposeComponent.a(i.a(),e,o);var u=n.a(_a.h);var r=i.a()==="Mouse"&&u.a().bi().Enabled;var w=this;n.b(_mcp.U,function(){return new _mcp.U(n.d(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.d(IForgottenAttachmentDetectorFactory):null,n.d(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.C),n.a(_pe.e),n.a(_y.a),n.d(IOfflineHelpProvider),n.a(_mcp.y),n.a(_y.K),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.c(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dO),n.a(_a.w),n.c(IMyLocationBuilder),n.d(IMailTipsHandlerFactory),n.d(IPeopleRecommendationsHandlerFactory),n.d(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.t):null,r?n.d(ISendNotificationProviderViewModel):null,r?n.d(ISendFailureNotificationProviderViewModel):null,n.d(IFindRecipientMailComposeViewModelFactory),n.c(IComponentOverrideFactory),n.a(_g.a).bl.AttachmentPolicy,n.d(IIntroductionControllerFactory),n.c(ILinkPreviewBuilderFactory),n.d(IToPeoplePickerViewModelFactory),n.a(_a.e),i)}).b(IMailComposeViewModelFactory).a();var p=this;n.b(_mcp.V,function(){return new _mcp.V(n.d(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.d(IForgottenAttachmentDetectorFactory):null,n.d(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.C),n.a(_pe.e),n.a(_y.a),n.d(IOfflineHelpProvider),n.a(_mcp.y),n.a(_y.K),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.c(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dO),n.a(_a.w),n.c(IMyLocationBuilder),n.d(IMailTipsHandlerFactory),n.d(IPeopleRecommendationsHandlerFactory),n.d(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.t):null,r?n.d(ISendNotificationProviderViewModel):null,r?n.d(ISendFailureNotificationProviderViewModel):null,n.d(IFindRecipientMailComposeViewModelFactory),n.c(IComponentOverrideFactory),n.a(_g.a).bl.AttachmentPolicy,n.d(IIntroductionControllerFactory),n.c(ILinkPreviewBuilderFactory),n.d(IToPeoplePickerViewModelFactory),n.a(_a.e),i)}).b(IMailInlineComposeViewModelFactory).a();var a=this;n.b(_mcp.P,function(){return new _mcp.P(n.d(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.d(IForgottenAttachmentDetectorFactory):null,n.d(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.O),n.a(_pe.e),n.a(_y.a),n.d(IOfflineHelpProvider),n.a(_mcp.y),n.a(_y.K),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.c(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dO),n.a(_a.w),n.c(IMyLocationBuilder),n.d(IMailTipsHandlerFactory),n.d(IPeopleRecommendationsHandlerFactory),n.d(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.t):null,r?n.d(ISendNotificationProviderViewModel):null,r?n.d(ISendFailureNotificationProviderViewModel):null,n.d(IFindRecipientMailComposeViewModelFactory),n.c(IComponentOverrideFactory),n.a(_g.a).bl.AttachmentPolicy,n.d(IIntroductionControllerFactory),n.c(ILinkPreviewBuilderFactory),n.d(IToPeoplePickerViewModelFactory),n.a(_a.e),i)}).b(IGroupInlineComposeViewModelFactory).a();var h=this;n.b(_mcp.y,function(){return new _mcp.y(n.a(IMailComposeActionFactory))}).b(IMailComposeDiscardManager).a();var s=this;n.b(_mcp.l,function(){return new _mcp.l(window.document.createElement("div"),i.a(),n.a(_a.e),n.a(_a.t),n.a(_a.h),n.a(_ff.c),n.a(_a.w),n.a(_b.e))});var l=this;n.b(_mcp.j,function(){return new _mcp.j(window.document.createElement("div"),i.a(),n.a(_a.e),n.a(_a.t),n.a(_a.h),n.a(_ff.c),n.a(_a.w),n.a(_b.e))});var c=this;n.b(_mcp.F,function(){return new _mcp.F(n.c(IPopOutHelper),i.a())}).a()},b:function(){return[new _a.B(_mcp.F,1,1)]}};_mcp.F=function(n,t){if(t==="Mouse"){var i=this;n.e(function(n){n.a(_mcp.a,"MailComposeContext")})}};_mcp.N=function(){};_mcp.N.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.N.registerEnum("_mcp.N",!1);_mcp.Y=function(){};_mcp.Y.prototype={to:0,cc:1,bcc:2};_mcp.Y.registerEnum("_mcp.Y",!1);var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.S=function(){};_mcp.S.a=function(n){var t=null;_h.p.isInstanceOfType(n)?t=n.d:_h.n.isInstanceOfType(n)&&(t=n.k);return t};_mcp.m=function(n,t,i,r,u,f,e,o){this.by=Function.createDelegate(this,this.bY);this.bn=Function.createDelegate(this,this.bH);this.bp=Function.createDelegate(this,this.bW);this.bC=Function.createDelegate(this,this.bK);this.bA=Function.createDelegate(this,this.bZ);this.bB=Function.createDelegate(this,this.ca);this.br=Function.createDelegate(this,this.cg);this.bq=Function.createDelegate(this,this.bX);this.bi=Function.createDelegate(this,this.bU);this.bl=Function.createDelegate(this,this.bV);this.bv=Function.createDelegate(this,this.bN);this.bw=Function.createDelegate(this,this.bP);this.bx=Function.createDelegate(this,this.bT);this.bu=Function.createDelegate(this,this.bM);this.l=this.a;_mcp.m.initializeBase(this,[5,n]);this.z=i;this.P=u;this.bs=t;this.A=new _C(this.bu,this.G());this.B=r;this.bh=f;this.Z=e;this.X=o};_mcp.m.prototype={Q:null,z:null,B:null,P:null,bs:null,bh:null,N:null,Z:null,A:null,bd:null,bc:null,W:null,T:null,bg:!1,L:null,y:null,V:!1,X:null,bt:!0,Y:0,ba:null,bb:null,h:function(){this.Q||this.bF();return this.Q},bJ:function(n){if(this.Q!==n){this.Q=n;this.bj("Menu")}return n},cd:function(n){if(this.ba!==n){this.ba=n;this.bj("InsertButtonCommand")}return n},bI:function(n){if(this.bb!==n){this.bb=n;this.bj("InsertButtonText")}return n},f:function(){if(!this.bd){var n=this;this.bd=new _C(this.bx,this.G(),this.D.a.L,"BodyType",function(){return n.D.a.L.f()==="HTML"})}return this.bd},o:function(){this.bc||(this.bc=new _C(this.bw,this.G()));return this.bc},m:function(n){this.bz("AttachmentWellInitialized",n)},r:function(n){this.bS("AttachmentWellInitialized",n)},a:function(){return this.dS(_mcp.m.a)},s:function(n){this.dR(_mcp.m.a,n);return n},b:function(){return(this.a()?this.a().g():!1)||(this.N?this.N.c():!1)},e:function(){return this.a()&&this.a().b()?this.a().b().x.length>0:!1},n:function(){return this.Y},cb:function(n){if(this.Y!==n){this.Y=n;this.bj("AttachmentsVisibleCount")}return n},t:function(n){this.bt=n;return n},g:function(){var n=_a.UserAgent.getInstance();return n.c()&&!!this.z&&this.B.a()&&(this.z.a().x().Enabled&&n.a()||this.z.a().D().Enabled&&n.G)},K:function(){if(this.E.bH()&&!this.y){_js.Trace.logInfo(_a.a.a,"Setting attachment component override");this.y=this.E.bG().a();this.y.c(this.bv)}},J:function(){if(this.y){this.y.a();this.y=null}},d:function(){var t=this.D.a.L;this.K();this.bF();var i=t.bv();var r=t.x();var u=!((t.a()===4||t.a()===13)&&!this.B.a());if(this.a()){this.a().bD(t.i(),r,i,t.b(),t.X());this.bD(t,i)}else{var n=this;this.bs.a(function(f){if(_y.c.a.a()==="TouchNarrow")n.s(f.a(t.i(),r,i,u,t.X(),!0,n.D.a.M,t.b()));else{var e=f.b(t.i());e.e(t.Z());e.h(1);var o=n.E.L.bj();var s=o?o.EmailAddress:null;n.s(f.c(e,r,i,_y.c.a.a()==="Mouse"?3:0,u&&n.bt,t.X(),!0,n.D.a.M,t.b(),n.D.a.Y,n.D.a.cK,s))}n.a().p(n.bl);n.a().v(n.bi);n.a().apcl("EditorCallContext",n.bq);n.a().L(n.E.co);n.cc("AttachmentWellInitialized",n);n.E.V()&&n.a().apcl("VisibleCount",n.br);n.bD(t,i)})}},bN:function(){return this.a()},bX:function(n,t){t==="EditorCallContext"&&this.E.bk().a(this.a().Q())},k:function(n){this.W&&this.W.c(!n)},j:function(n){this.T&&this.T.c(!n)},bU:function(n){if(_a.bl.a){var t=this;_js.g.a().c(_a.a.J,"TriggerPolicyTipsIfNeeded",function(){var n=t.D.b(23);n.a(8)})}},bV:function(){var t=this.D.a;var n=t.L;if(n.i()){this.bE(n);this.a()&&this.a().d(n.i(),n.x(),n.X())}else t.c().b("Attach",this.bB,this.bA,!1)},v:function(){if(!this.bg&&this.a()){var n=this.D.a.L;if(_y.c.a.a()==="Mouse")this.a().d(n.i(),n.x(),n.X());else{_js.Trace.logInfo(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bk(n.i(),n.x(),n.X(),this.bC)}this.bK();this.D.a.T.a(_y.dx,new _y.dx);this.bg=!0}},bK:function(){var n=this.D.a.L;if(n.ee)if(n.x()){var t=new _js.f;t.p(n.x().g());n.ee.p(t);n.ed()&&n.ed().p(t)}else{n.ee.p(null);n.ed()&&n.ed().p(null)}},H:function(){var n=this.a();if(n){n.D(this.bl);n.C(this.bi);n.rpcl("EditorCallContext",this.bq);this.a().Z(this.E.co);this.E.V()&&this.a().rpcl("VisibleCount",this.br)}this.bg=!1;this.J();_mcp.bc.prototype.H.call(this)},p:function(){var n=[];var t=this.D.b(13);var i=this.D.b(20);if(t){t.a().b&&Array.add(n,new _y.g(_u.P.i,t.a()));t.b().b&&Array.add(n,new _y.g(_u.P.U,t.b()));this.U()&&Array.add(n,new _y.g(this.M(),this.A))}else if(i)Array.add(n,new _y.g(this.M(),i.a()));else if(_a.UserAgent.getInstance().y()){Array.add(n,new _y.g(this.M(),this.A));!this.B.c()||this.D.a.L.f()!=="HTML"||_a.UserAgent.getInstance().c()||this.z.a().A().Enabled||Array.add(n,new _y.g(_u.P.G,this.f()))}return n},i:function(){var n=new _ff.e;var t=this.D.b(13);var i=this.D.b(20);if(t){t.c.b&&n.c(new _fm.d(_u.P.i,null,t.c));t.e.b&&n.c(new _fm.d(_u.P.U,null,t.e));this.U()&&n.c(new _fm.d(this.M(),null,this.A))}else if(i)n.c(new _fm.d(this.M(),null,i.b));else if(_a.UserAgent.getInstance().y()){n.c(new _fm.d(this.M(),null,this.A));!this.B.c()||this.D.a.L.f()!=="HTML"||_a.UserAgent.getInstance().c()||this.z.a().A().Enabled||n.c(new _fm.d(_u.P.G,null,this.f()))}return n},w:function(){var n=this.D.a.L;if(!_js.d.a(n.bu())&&!this.V&&n.i()&&this.a()){this.V=!0;var t=!1;try{this.a().bd(n.bu(),this.bp,this.bn);t=!0}finally{t||(this.V=!1)}}},x:function(n){this.Z&&this.a()&&this.Z.a(this.a(),this.G()).b(n)},c:function(){var t=this.D.a;var n=t.L;if($a(n)||!n.g()){_js.Trace.logInfo(_a.a.a,"Show not allowed to add attachment due to context={0}; Upgraded={1}",n?"non-null":"null",n.g());t.U.a(0,_nbs.a.Yf,null);return!1}return!0},bM:function(){var t=this.D.a;var i=t.L;_js.Trace.logInfo(_a.a.a,"Insert attachment start");if(this.c()&&this.a()){this.E.Q().M(!1);if(this.y)this.y.b(!1);else if(this.U()){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_js.Trace.logInfo(_a.a.a,"Opening OWA's file picker");this.ce(n)}else{_js.Trace.logInfo(_a.a.a,"Opening OS's file picker");this.a().e(!1,null,null)}}this.E.R().a("AttachFile");_js.Trace.logInfo(_a.a.a,"Insert attachment end")},bT:function(){var n=this.D.a;var t=n.L;_js.Trace.logInfo(_a.a.a,"Insert picture start");if(this.c()&&this.a()){this.y?this.y.b(!0):this.a().e(!0,null,null);this.E.R().a("InsertPicture")}_js.Trace.logInfo(_a.a.a,"Insert picture end")},bP:function(){if(this.N)this.bG(this.N);else if(this.bh){var n=this;this.bh.a(function(t){n.N=t;n.bG(n.N)})}},bG:function(n){_js.Trace.logInfo(_a.a.a,"Inserting location");var i=_a.d.b(_a.a.bh,"BeamMeUpPlaceholderPopulated");var t=this;n.d(function(i){t.E.bk().a(i);n.a(t.a(),i.a())},this.by,i)},bY:function(n){if(n){var t=this.D.a;t.U.a(0,n,null)}},bF:function(){if(!this.Q){var n=[];var t=new _fm.d(this.M(),null,this.A,!1,null,_nbs.a.MJ);Array.add(n,t);if(this.B.c()){this.W=new _fm.d(_u.P.G,null,this.f(),!1,null,_nbs.a.es);this.z.a().A().Enabled||Array.add(n,this.W);this.k(this.D.a.L.f()==="HTML");if(_a.UserAgent.getInstance().c()&&this.z&&this.z.a().x().Enabled){this.T=new _fm.d(_nbs.a.el,null,this.o(),!1,null,_nbs.a.nV);Array.add(n,this.T)}this.j(this.D.a.L.f()==="HTML")}if(n.length===1){this.cd(this.A);this.bI(_nbs.a.IE);this.z.a().f().Enabled&&this.bJ(new _fm.f(n))}else{this.bJ(new _fm.f(n));this.bI(_nbs.a.be)}}},bD:function(n,t){this.a().bJ(!n.g());_js.Trace.logInfo(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.g()&&this.v();_mcp.bc.prototype.d.call(this)},bE:function(n){n.x()||n.bp(new _js.f)},ca:function(n){var i=this.D.a;var t=i.L;if(n.I===t.b()){this.bE(t);this.a()&&this.a().d(t.i(),t.x(),t.X());this.w()}},bZ:function(n){var t=this.D.a;var i=t.L;if(this.a()&&n.I===i.b()){this.a().E();t.U.j||t.U.a(0,_nbs.a.kn,null);this.w()}},ce:function(n){if(this.P){var t=this;this.P.a(function(i){t.L=i;t.L&&t.L.a(t.a(),n,!1,t.D.a.bt,t.D.a.Y,t.E.L.f()==="Text")})}},q:function(){if(this.U()&&this.P){var n=this;this.P.a(function(t){n.L=t;n.L&&n.L.b()})}},U:function(){return!this.F.A()&&!!this.B&&!!this.X&&this.B.d(this.X.AttachmentDataProviderAvailable)},bW:function(n){this.D.a.L.ch(null);this.bH(n)},bH:function(n){n.z(this.bp);n.U(this.bn);this.V=!1},M:function(){return this.U()?_u.P.B:_u.P.S},cg:function(n,t){this.cb(this.a().n())}};_mcp.bb=function(n,t,i,r,u){this.bb=Function.createDelegate(this,this.bw);this.bc=Function.createDelegate(this,this.bx);this.Q=Function.createDelegate(this,this.by);this.W=Function.createDelegate(this,this.bv);_mcp.bb.initializeBase(this,[n,t,i,r,u]);this.s=new _mcp.bt(this.W,6e4)};_mcp.bb.prototype={s:null,d:function(){var n=this.D.a;var t=n.L;_js.Trace.logInfo(_a.a.a,"Enabling timer during initialization of auto save component");this.s.b=!0;if(!t.bf()){this.bA();_js.Trace.logInfo(_a.a.a,"Auto save timer started")}_mcp.z.prototype.d.call(this);n.T.b(_a.cJ,this.Q)},bv:function(){var u=this.D;var r=u.a;var n=r.L;if(!n.bf()){if(!n.bz()){_js.Trace.logInfo(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var f=u.b(5);_js.Trace.logInfo(_a.a.a,"Checking dirty before auto save");var t=r.bx();var i=f.b();if(t&&!i){_js.Trace.logInfo(_a.a.a,"AutoSave:Context:{0}",n);this.s.e();this.b("AutoSave",this.bc,this.bb,!1)}else{this.s.c();_js.Trace.logInfo(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},bA:function(){var n=this.D.a.L;!n.bf()&&n.bz()&&this.s.c()},H:function(){_js.Trace.logInfo(_a.a.a,"Disabling the timer on reset");this.s.h();var n=this.D.a;n.T.c(_a.cJ,this.Q);_mcp.z.prototype.H.call(this)},bk:function(){var n=this.D.a;n.T.c(_a.cJ,this.Q)},by:function(n){_js.g.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.W)},bx:function(n){var r=this.D;var i=r.a;var t=i.L;t.bf()||this.s.c()},bw:function(n){_js.Trace.logInfo(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.t.message);this.D.a.L.bf()||this.s.c()}};_mcp.q=function(n){this.l=Function.createDelegate(this,this.y);_mcp.q.initializeBase(this,[0,n])};_mcp.q.prototype={g:null,f:null,j:null,k:null,h:null,b:null,a:function(){return this.b},z:function(n){if(this.b!==n){this.b=n;this.bj("ComposeCommandingBar")}return n},n:function(){return this.D.a.e().b()},q:function(){return this.D.a.bg().a()},x:function(){return this.D.a.be().i},t:function(){return this.D.a.b().e()},i:function(){return this.D.a.S().h()},m:function(){this.k||(this.k=new _fm.i(this.x(),_u.P.K,_mcp.c.v(),0,null,_mcp.c.w(),!1,!1));return this.k},w:function(){this.g||(this.g=this.F.A()?new _fm.i(this.n(),_u.P.a,_mcp.c.I(),0,null,null,!1,!1):new _fm.i(this.n(),_u.P.E,_mcp.c.K(),0,null,null,!1,!1));return this.g},r:function(){this.h||(this.h=new _fm.i(this.q(),_u.R.YW,null,0,null,null,!1,!1));return this.h},s:function(){if(!this.f)if(this.i().h.x.length>1){var n=this;this.f=new _fm.m(_nbs.a.cU,function(t){t(n.i())},0,_nbs.a.cU,!1,!1,_mcp.c.o(),!1)}else this.i().h.x.length===1&&(this.f=new _fm.i(this.i().h.x[0].i,_nbs.a.IE,_mcp.c.o(),0,null,null,!1,!1));return this.f},v:function(){this.j||(this.j=new _fm.i(this.t(),null,_mcp.c.H(),0,null,null,!0,!1));return this.j},d:function(){if(this.C()){_js.Trace.logInfo(_mcp.q.a,"Commanding bar component is already initialized, skipping redundant Initialize call.");return}if(!this.E.V()){_js.Trace.logInfo(_mcp.q.a,"Initializing compose commanding bar");this.z(new _fm.p(_u.R.Br));this.b.X=!0;this.b.Y=!0;this.e(this.w(),!0);this.e(this.s(),!0);this.e(this.m(),!1);this.e(this.r(),!0);this.D.a.bF()||this.D.a.L.l()===3||this.e(this.v(),!0);this.D.a.apcl("ShouldShowToolbarMessage",this.l);this.p();this.o(this.E.be().ba());_js.Trace.logInfo(_mcp.q.a,"Completed initializing compose commanding bar")}_mcp.bc.prototype.d.call(this)},bk:function(){this.D.a.rpcl("ShouldShowToolbarMessage",this.l);_js.x.prototype.bk.call(this)},p:function(){_js.Trace.logInfo(_mcp.q.a,"Adding affordance items to compose commanding bar");var n=new _ff.e;this.c(n,8);this.c(n,11);this.c(n,1);this.c(n,30);this.c(n,6);this.c(n,3);this.c(n,15);this.c(n,9);for(var i=0;i<n.d.length;i++)this.b.a(n.d[i]);var t=n.d[0];if(t){t.a(!t.e);t.a(!t.e);_js.Trace.logInfo(_mcp.q.a,"Completed added affordance items to compose commanding bar")}else _js.Trace.logWarning(_mcp.q.a,"Affordance menu item at index 0 is null.")},c:function(n,t){var r=null;var i=this.D.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_js.Trace.logInfo(_a.a.a,"Getting affordance menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.C());i.C()||i.d();r=i;n.h(r.j())}},e:function(n,t){if(!this.b.ce(n)){n.a(!0);n.b(t);this.b.a(n)}},y:function(n,t){var i=!this.D.a.bO;this.A(i)},A:function(n){for(var r=this.b.b.x.length,t=0;t<r;t++){var i=this.b.b.x[t];i&&i.i!==1&&i.a(n)}},o:function(n){this.b&&this.b.ce(this.m())&&this.m().b(n)}};_mcp.t=function(n,t,i,r){this.U=Function.createDelegate(this,this.bg);this.V=Function.createDelegate(this,this.bh);this.P=Function.createDelegate(this,this.bb);this.W=Function.createDelegate(this,this.T);_mcp.t.initializeBase(this,[3,n,i,r]);this.Q=t;this.v=!1};_mcp.t.b=function(n,t){return new _y.g(n,t)};_mcp.t.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.t.prototype={Q:null,L:null,r:null,K:null,w:null,J:!1,N:null,o:null,z:null,b:function(){return"IsIrmProtected"},s:null,f:function(){return this.s},l:null,c:function(){return this.l},a:function(){return this.J},M:function(n){if(this.J!==n){this.J=n;this.bj("IsIrmProtected")}return n},i:function(){return this.N},bd:function(n){if(this.N!==n){this.N=n;this.bj("ShowIrmInformationCommand")}return n},h:function(){return this.o},bc:function(n){if(this.o!==n){this.o=n;this.bj("DialogViewModel")}return n},v:!1,g:function(n){this.v=n;return n},e:function(){var i=_g.a.a();if(!$a(i.e())&&!i.e().bl.Irm||this.t.c()){_js.Trace.logInfo(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.D.a.L.B();var t=!n||!!n.a()||n.b()||n.k();_js.Trace.logInfo(_a.a.a,"CanSetCompliance={0}",t);return t},d:function(){var n=this.D.a;var u=n.L;var o=n.dp;var r=n.bd;if(this.e())if(_g.j.b){_js.Trace.logInfo(_a.a.a,"Checking main window for compliance configuration");this.l=_mcp.t.a;_g.j.b.hA(this.W)}else if(r.WasLoadedFromServer)this.T(r);else{_js.Trace.logInfo(_a.a.a,"Adding the loading permissions menu item");this.l=_mcp.t.a;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.a.a,"Submitting GetComplianceConfigurationAction");var e=n.T;e.b(_a.cO,this.P);var s=new _h.cm(r,n.T);s.d()}}else if(this.l&&this.v&&o.a){n.dp.A(this.l);this.v=!1}var t=u.B();this.M(!!t&&!t.a());if(this.J&&"Mouse"===_y.c.a.a()){var i=n.bb();i.a.apply(i,[4499].concat([t.bl.TemplateName,t.bl.TemplateDescription]));i.a.apply(i,[4500].concat([t.bl.ContentOwner]))}else if(u.bw()){var f=n.bb();f.a.apply(f,[3800].concat([u.cz(),u.cA()]))}"Mouse"===_y.c.a.a()||this.N||this.bd(new _C(this.V,this.G()));_mcp.n.prototype.d.call(this)},H:function(){this.M(!1);_mcp.n.prototype.H.call(this)},y:function(){if(!this.F.A())if(this.s){this.r=new _fm.k(_nbs.a.jw,null,this.s);this.q=[this.r]}else if(this.e()&&this.E.bd.IsLoadingFromServer){this.r=new _fm.k(_nbs.a.jw,null,null);this.r.c(!0);this.L=new _fm.d(_u.P.j,null,null);this.q=[this.L,this.r]}},x:function(){if(!this.F.A()){var n=this;this.w=new _fm.m(_nbs.a.jw,function(t){t(n.s)},1,null,!1,!1,null,!1);if(this.s)this.p=[this.w];else if(this.e()&&this.E.bd.IsLoadingFromServer){this.w.a(!1);this.K=_mcp.n.a(null,_u.P.j);this.p=[this.w,this.K]}}},A:function(){this.K&&this.K.a(!1);this.w&&this.w.a(!0)},B:function(){this.L&&this.L.c(!0);if(this.r){this.r.A(this.s);this.r.c(!1)}},Z:function(n){var t=this.D.a.bd;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_js.Trace.logInfo(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.o,new _C(this.U,this.G()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _C(this.X(c.Id),this.G()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _C(this.Y(l.Id),this.G()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _C(this.X(s.Id),this.G()));r++}else{i[f++]=n(h.Name,new _C(this.Y(h.Id),this.G()));u++}}return i},ba:function(){if("Mouse"===_y.c.a.a()||this.Q.b()){var r=this.Z(_mcp.t.c);r&&(this.s=new _fm.f(r))}else if(!this.v){if(!this.l){var u=this.Z(_mcp.t.b);u&&(this.l=new _y.g(_nbs.a.jw,null,u))}var i=this.D.a.dp;if(this.l&&i){var t=i.a;if(t)for(var n=0;n<t.length;n++)if(t[n]){if(_nbs.a.eQ===t[n].b){i.x(this.l,n+1);this.v=!0}}else _js.Trace.logError(_a.a.a,"existingMenuItems at index {0} can't be null",n)}}},bb:function(n){var t=this.D.a;this.T(t.bd);t.T.c(_a.cO,this.P)},T:function(n){var t=this.E;t.bd=n;_js.Trace.logInfo(_a.a.a,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.c.a.a()){this.l&&t.dp&&t.dp.A(this.l);this.l=null;this.v=!1}n.WasLoadedFromServer&&this.ba();"Mouse"===_y.c.a.a()&&n.WasLoadedFromServer&&this.m()},bg:function(){var i=this.D.a;var n=i.L;i.R().a(_mcp.N.toString(0));_js.Trace.logInfo(_a.a.a,"Set no restriction");n.bK("0");var t=i.bb();if($a(n.B())){if(n.bw()){t.b(3800);n.bN(!1);n.bH(null);n.bI(null);n.bJ(null)}}else{if("Mouse"===_y.c.a.a()){t.b(4499);t.b(4500)}n.bO(null);this.M(!1)}},Y:function(n){var t=this;return function(){var h=_a.d.b(_a.a.a,"MailComposeSetIRM",!0);var e=t.D.a;var r=e.L;r.bK(n);if(r.bw()){e.M.b(3800);t.E.N();r.bN(!1);r.bH(null);r.bI(null);r.bJ(null)}for(var s=e.bd.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();e.R().a(c);var i=new _g.dK;i.v(n);i.r(_g.a.a().c().bl.UserEmailAddress);i.s(!0);i.t(0);i.y(u.Name);i.x(u.Description);i.q(r.f());r.bO(i);if("Mouse"===_y.c.a.a()){var f=e.bb();f.b(4499);f.b(4500);f.a.apply(f,[4499].concat([u.Name,u.Description]));f.a.apply(f,[4500].concat([i.bl.ContentOwner]))}t.M(!0);_js.Trace.logInfo(_a.a.a,"Set IRM {0}",u.Name);break}}_a.d.a(h)}},X:function(n){var t=this;return function(){var u=t.D.a;var r=u.L;r.bK(n);if(!$a(r.B())&&"Mouse"===_y.c.a.a()){var s=u.bb();s.b(4499);s.b(4500);r.bO(null);t.M(!1)}for(var o=u.bd.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.R().a(h);r.bN(!0);r.bH(i.Name);r.bI(i.Description);r.bJ(i.Id);var e=u.bb();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_js.Trace.logInfo(_a.a.a,"Set class {0}",i.Name);break}}}},bh:function(){var t=this.D.a.L;if(t.B()){var n=t.B();this.bi(n.bl.TemplateName,n.bl.TemplateDescription,n.bl.ContentOwner)}else _js.Trace.logError(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},bi:function(n,t,i){if($a(this.o)){this.bc(new _bc.j);this.o.h.a(new _ff.f(this.o.i,_nbs.a.Qu))}this.o.k(n);$a(this.z)&&(this.z=new _mcp.Q);this.z.d(t);this.z.c(String.format(_nbs.a.lg,i));this.o.m(this.z);this.o.g(!0)}};_mcp.bc=function(n,t){_mcp.bc.initializeBase(this);this.ct=n;this.D=t;if(t&&t.a){this.E=t.a;this.F=this.E.L;this.I=this.E.M}};_mcp.bc.prototype={ct:0,D:null,E:null,F:null,I:null,bQ:!1,C:function(){return this.bQ},S:function(n){this.bQ=n;return n},G:function(){return _a.a.a},d:function(){this.S(!0)},H:function(){this.S(!1)},bm:function(n){var t=this.bf(n);this.E.cR(t);if(t===55||t===50){var i=this;this.E.bK.a(function(n){n.a(i.I);i.E.N()})}else this.E.N()},be:function(n){this.I.h(n);this.E.N()},cs:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.I).f.apply(r,[t,n].concat(u));this.E.N()},R:function(){this.I.G();this.I.e(_mcp.z.a);this.I.e(_mcp.A.a);this.I.e(_mcp.k.b);var n=this;this.E.bK.a(function(t){t.b(n.I);n.E.N()})},bf:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.be=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.f=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bd(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p);this.a=n};_mcp.be.prototype={c:null,e:null,a:null,b:function(n){var t=n;$a(this.c[t])&&(this.c[t]=this.e.q(n,this.a.X.a()));return this.c[t]},n:function(){this.d(this.g)},k:function(){_js.Trace.logInfo(_a.a.a,"Component Map Reset start.");this.d(this.h,!0);_js.Trace.logInfo(_a.a.a,"Component Map Reset end.")},r:function(){_js.Trace.logInfo(_a.a.a,"Component Map set override start.");this.d(this.i);_js.Trace.logInfo(_a.a.a,"Component Map set override end.")},m:function(){_js.Trace.logInfo(_a.a.a,"Component Map clear override start.");this.d(this.f);_js.Trace.logInfo(_a.a.a,"Component Map clear override end.")},d:function(n,t){if($a(t)||!t)for(var r=0;r<this.c.length;r++)this.j(n,r);else for(var i=this.c.length-1;i>=0;i--)this.j(n,i)},j:function(n,t){var i=this.c[t];$a(i)||n(i,t)},o:function(n,t){_mcp.J.isInstanceOfType(n)||n.C()||n.d()},p:function(n,t){var i=Object.getType(n).getName();if(n.C()){_js.Trace.logInfo(_a.a.a,"Reset {0} at index {1}",i,t);n.H()}else _js.Trace.logInfo(_a.a.a,"Skip uninitialized {0} at index {1}",i,t)},q:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.K()},l:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.J()}};_mcp.bf=function(n,t,i,r){this.o=Function.createDelegate(this,this.z);this.i=Function.createDelegate(this,this.v);this.l=Function.createDelegate(this,this.w);_mcp.bf.initializeBase(this,[15,n,i,r]);this.h=t};_mcp.bf.prototype={a:null,b:null,g:null,f:null,e:null,c:null,h:null,d:function(){this.b||(this.b=new _C(this.l,this.G()));this.a||(this.a=new _C(this.i,this.G()));_mcp.n.prototype.d.call(this)},y:function(){this.g=new _fm.d(_nbs.a.ZF,null,this.b);this.f=new _fm.d(_nbs.a.bC,null,this.a,!0);this.m();this.q=[this.g,this.f]},x:function(){this.e=_mcp.n.a(this.b,_nbs.a.ZF);this.c=_mcp.n.a(this.a,_nbs.a.bC);this.m();this.p=[this.e,this.c]},B:function(){this.f.c(this.F.f()==="HTML");this.g.c(this.F.f()!=="HTML")},A:function(){this.c.a(this.F.f()!=="HTML");this.e.a(this.F.f()==="HTML")},w:function(){_js.Trace.logInfo(this.G(),"User chose to convert to plain text");this.D.a.R().a("SwitchToPlain");if(this.s(_nbs.a.OQ)){this.D.a.L.bU().a();var r=this.D.a.L.L();var n;var i,t;var f=(t=_a.u.g(r,i={val:n}),n=i.val,t);if(!f){n=r;_js.Trace.logInfo(this.G(),"Using html due to failed conversion")}if(n.length>0){var u=this.D.a.U;u.b(1,[_nbs.a.Uo],this.o,!1,null,null,null,this.h,null)}else this.r()}},z:function(n,t){n&&this.r()},r:function(){var n=this.D.b(5);n.k(!1);n.j(!1);n.a()&&n.a().bP();this.D.a.L.m("Text");this.m();_js.Trace.logInfo(this.G(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},v:function(){_js.Trace.logInfo(this.G(),"User chose to convert to html");this.D.a.R().a("SwitchToHTML");if(this.s(_nbs.a.Pb)){var t=this.D;var r=t.a;var i=r.L;i.m("HTML");this.m();var n=this.D.b(5);n.k(!0);n.j(!0);_js.Trace.logInfo(this.G(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},s:function(n){_js.Trace.logInfo(this.G(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.D.a.L.g()){this.D.a.U.a(0,n,null);_js.Trace.logInfo(this.G(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.D.a.L.R()){this.D.a.U.a(0,n,null);_js.Trace.logInfo(this.G(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.D.b(5);if(t.a()&&t.a().z()){this.D.a.U.a(0,_nbs.a.Yi,null);_js.Trace.logInfo(this.G(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.v=function(n){_mcp.v.initializeBase(this,[16,n])};_mcp.v.prototype={a:function(){return this.dS(_mcp.v.a)},c:function(n){this.dR(_mcp.v.a,n);return n},d:function(){if(this.C()){_js.Trace.logInfo(_a.a.a,"Context menu component is already initialized, skipping redundant Initialize call.");return}if("Mouse"===_y.c.a.a()){var n=new _ff.e;this.b(n,8);this.b(n,11);this.b(n,1);this.b(n,30);this.b(n,6);this.b(n,3);this.b(n,15);this.b(n,9);this.c(new _fm.f(n.i()))}_mcp.bc.prototype.d.call(this)},b:function(n,t){var r=null;var i=this.D.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_js.Trace.logInfo(_a.a.a,"Getting context menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.C());i.C()||i.d();r=i;n.h(r.k())}}};_mcp.w=function(n,t,i){_mcp.w.initializeBase(this,[28,n]);this.f=_g.a.a().a();this.a=this.E.L;this.b=t;this.c=i};_mcp.w.prototype={b:null,c:null,f:null,a:null,e:function(){return this.dS(_mcp.w.a)},h:function(n){this.dR(_mcp.w.a,n);return n},g:function(){return!this.b.a()},d:function(){if("TouchNarrow"===_y.c.a.a()){var t=[];var n;if(this.b.a()){var o=this.D.b(5);var i=o.i();if(i)if(i.d.length>1){n=new _fm.k(_nbs.a.cU,null,new _fm.f(i.d));Array.add(t,n)}else if(i.d.length===1){var c=i.d[0].i;n=new _fm.d(_nbs.a.cU,null,c);Array.add(t,n)}}var l=this.D.b(22);n=new _fm.d(_u.P.e,null,l.i);Array.add(t,n);var e=this.E.cZ();if(!_js.d.b(e.a())){n=new _fm.d(_nbs.a.Bo,null,e.b());Array.add(t,n)}var r=this.D.b(1);if(!this.a.A()){n=new _fm.d(_nbs.a.Ja,null,r.K);_g.a.a().a().bl.AlwaysShowBcc&&n.c(!0);Array.add(t,n);n=new _fm.d(_nbs.a.Pu,null,r.U);_g.a.a().a().bl.AlwaysShowBcc||n.c(!0);Array.add(t,n)}if(this.a.bn()||this.a.t()){var v=this.D.b(1);n=new _fm.d(_nbs.a.kC,null,r.w);(_g.a.a().a().bl.AlwaysShowFrom||this.a.z())&&n.c(!0);Array.add(t,n);r.w.c(!this.a.t());n=new _fm.d(_nbs.a.NN,null,r.X);_g.a.a().a().bl.AlwaysShowFrom||this.a.z()||n.c(!0);Array.add(t,n)}var a=this.D.b(30);a.b(t);var f=this.E.cV();if(f.a()){n=new _fm.k(_nbs.a.eQ,null,f.a());Array.add(t,n)}var u=this.E.bE();if(u.f()){n=new _fm.k(_nbs.a.jw,null,u.f());Array.add(t,n)}else if(u.e()&&this.E.bd.IsLoadingFromServer){n=new _fm.d(_u.P.j,null,null);Array.add(t,n)}if(!this.a.A()&&!this.c.c()){var s=this.D.b(9);n=new _fm.d(_nbs.a.NI,null,s.b());Array.add(t,n)}var h=this.D.b(28);h.h(new _fm.f(t))}_mcp.bc.prototype.d.call(this)}};_mcp.x=function(n){this.t=Function.createDelegate(this,this.J);this.w=Function.createDelegate(this,this.q);this.v=Function.createDelegate(this,this.A);this.s=Function.createDelegate(this,this.z);this.x=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.T);_mcp.x.initializeBase(this,[19,n]);this.p=new _C(this.y,this.G());this.o=new _C(this.x,this.G());this.l=n.a.bq};_mcp.x.prototype={p:null,o:null,l:null,k:null,j:null,n:!1,m:!1,a:function(){return this.p},f:function(){return this.o},g:function(){return this.k},L:function(n){if(n!==this.k){this.k=n;this.bj("DiscardConfirmDialogButtonData")}return n},K:function(n){if(n!==this.j){this.j=n;this.bj("CloseConfirmDialogButtonData")}return n},h:function(){return this.n},i:function(n){if(n!==this.n){this.n=n;this.bj("IsDiscardConfirmDialogShown")}return n},r:function(n){if(n!==this.m){this.m=n;this.bj("IsCloseConfirmDialogShown")}return n},e:function(){var i=this.D;var t=i.a;var n=t.L;t.R().a("Discard");if(n.a()||!n.a()&&(n.i()||t.c().a())){_js.Trace.logInfo(_a.a.a,"Discard");this.B(n.b(),n.i())}},b:function(n,t){if(this.l.a(n)){_js.Trace.logInfo(_a.a.a,"Resuming discard of {0}",_h.bk.a(t));this.B(n,t)}else _js.Trace.logInfo(_a.a.a,"User had already discarded.")},c:function(){if(!this.F.ee)return!0;_js.Trace.logInfo(_a.a.a,"Comparing initial baseline to baseline. Context:{0}",this.F);if(!this.F.ee.q(this.F.ed()))return!0;_js.Trace.logInfo(_a.a.a,"Checking dirty before showing discard confirmation.");return this.E.bx()?!0:this.F.bV()?!0:!1},P:function(){_js.Trace.logInfo(_a.a.a,"Comparing initial baseline to baseline. Context:{0}",this.F);if(!this.F.ee.q(this.F.ed()))return!0;_js.Trace.logInfo(_a.a.a,"Checking dirty before showing discard confirmation.");return this.E.bx()?!0:!1},B:function(n,t){this.A();var i=this.D.a;var r=i.L.bY()||i.L.bV();this.l.b(n,t,i.W,r)},T:function(){var t=this.D.a;var n=t.L;_js.Trace.logInfo(_a.a.a,"User chose to discard");if(this.c()){this.N();_js.Trace.logInfo(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:{0}",n);this.i(!0)}else{_js.Trace.logInfo(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:{0}",n);this.z()}},Q:function(){var t=this.D.a;var n=t.L;_js.Trace.logInfo(_a.a.a,"User chose to close");if(this.P()){this.M();_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog. Context:{0}",n);this.r(!0)}else{_js.Trace.logInfo(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away. Context:{0}",n);this.q()}},A:function(){_js.Trace.logInfo(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:{0}",this.D.a.L);this.i(!1)},J:function(){_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog. Context:{0}",this.D.a.L);this.r(!1)},N:function(){if($a(this.k)){_js.Trace.logInfo(_a.a.a,"Creating discard confirm dialog.");var n=new _js.f;n.a(new _ff.f(new _C(this.s,this.G()),_u.R.IE,_u.R.Tg));n.a(new _ff.f(new _C(this.v,this.G()),_u.R.cq,_u.R.Ia));this.L(n)}},M:function(){if($a(this.j)){_js.Trace.logInfo(_a.a.a,"Creating close confirm dialog.");var n=new _js.f;n.a(new _ff.f(new _C(this.w,this.G()),_u.R.bJ,_u.R.am));n.a(new _ff.f(new _C(this.t,this.G()),_u.R.Jh,_u.R.Ia));this.K(n)}},z:function(){_js.Trace.logInfo(_a.a.a,"Discard and close");this.e();this.q()},q:function(){this.F.eA(null);this.E.b().b(this.E,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from compose")}};_mcp.bg=function(n,t){this.i=Function.createDelegate(this,this.e);this.g=Function.createDelegate(this,this.o);this.l=Function.createDelegate(this,this.n);_mcp.bg.initializeBase(this,[25,n]);this.f=t;this.k=new _C(this.l,_a.a.a);var i=n.a.L;i.dh(this.k)};_mcp.bg.prototype={k:null,f:null,h:!1,j:null,b:function(){return this.j},a:function(n){this.j=n;this.bj("EditorCallContext");return n},e:function(){this.a(new _cmc.A)},d:function(){if(!this.h){this.p();this.h=!0;_g.a.a().b().E(this.g);_g.a.a().b().V(this.g)}_mcp.bc.prototype.d.call(this)},H:function(){this.q();this.h=!1;_g.a.a().b().L(this.g);_g.a.a().b().Z(this.g);_js.Trace.logInfo(_a.a.a,"Editor component reset.");_mcp.bc.prototype.H.call(this)},c:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().cV();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_js.d.b(t)?"<P><BR></P>":_a.u.e+t+_a.u.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_js.d.b(t)?"\r\n":t;return i},n:function(){this.a(new _cmc.b(!1))},o:function(n,t){this.e()},p:function(){if(this.f)try{var n=this.f;if(!n.closed){var r=_js.m.b(n);var i=this;r.c("resize",function(n){i.e()},"MCEditorComponent")}}catch(u){var t=this.m(this.f);_js.Trace.logException(this.G(),u,"Projection window dump: {0}",t)}else _y.c.a.o(this.i)},q:function(){if(this.f){var n=_js.m.b(this.f);n.e("resize","MCEditorComponent")}else _y.c.a.q(this.i)},m:function(n){var t="";for(var i in n)t=t+i+",";return t}};_mcp.bh=function(n){_mcp.bh.initializeBase(this,[n,null])};_mcp.bh.prototype={e:function(){}};_mcp.I=function(n,t,i,r){this.s=Function.createDelegate(this,this.M);this.v=Function.createDelegate(this,this.N);this.r=Function.createDelegate(this,this.L);_mcp.I.initializeBase(this,[6,n,i,r]);this.i=t};_mcp.I.a=function(n,t){return new _y.g(n,t)};_mcp.I.b=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.I.prototype={e:null,f:null,l:!1,g:!1,o:!1,i:null,a:function(){return this.e},b:function(){return this.f},z:function(n){if(n!==this.l){this.l=n;this.bj("IsHighImportance")}return n},c:function(){return this.g},K:function(n){if(n!==this.g){this.g=n;this.bj("IsNormalImportance")}return n},J:function(n){if(n!==this.o){this.o=n;this.bj("IsLowImportance")}return n},d:function(){var i=this.D.a.L.ba();this.h(i);_js.Trace.logInfo(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||this.i.b()){if(!this.e){var t=this.w(_mcp.I.b);t&&(this.e=new _fm.f(t))}}else if(!this.f){var n=this.w(_mcp.I.a);n&&(this.f=new _y.g(_nbs.a.eQ,null,n))}_mcp.n.prototype.d.call(this)},y:function(){var n=new _fm.k(_nbs.a.eQ,null,this.e);this.q=[n]},x:function(){var t=this;var n=new _fm.m(_nbs.a.eQ,function(n){n(t.e)},1,null,!1,!1,null,!1);this.p=[n]},L:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_js.Trace.logInfo(_a.a.a,"User sets high importance");this.h("High");this.D.a.R().a("Importance:High");_a.d.a(n)},N:function(){_js.Trace.logInfo(_a.a.a,"User sets normal importance");this.h("Normal");this.D.a.R().a("Importance:Normal")},M:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_js.Trace.logInfo(_a.a.a,"User sets low importance");this.h("Low");this.D.a.R().a("Importance:Low");_a.d.a(n)},h:function(n){this.D.a.L.dk(n);this.z("High"===n);this.K("Normal"===n);this.J("Low"===n)},w:function(n){return[n(_nbs.a.WG,new _C(this.r,this.G())),n(_nbs.a.ME,new _C(this.v,this.G())),n(_nbs.a.ZY,new _C(this.s,this.G()))]}};_mcp.bj=function(n,t,i){this.X=Function.createDelegate(this,this.bT);this.x=Function.createDelegate(this,this.bU);this.bg=Function.createDelegate(this,this.bN);this.bn=Function.createDelegate(this,this.ci);this.bd=Function.createDelegate(this,this.bG);this.y=Function.createDelegate(this,this.bw);this.Q=Function.createDelegate(this,this.bC);this.P=Function.createDelegate(this,this.bB);this.T=Function.createDelegate(this,this.bD);this.U=Function.createDelegate(this,this.bE);this.V=Function.createDelegate(this,this.bF);this.W=Function.createDelegate(this,this.bI);this.bb=Function.createDelegate(this,this.br);this.bh=Function.createDelegate(this,this.cb);this.bc=Function.createDelegate(this,this.bA);this.bi=Function.createDelegate(this,this.cd);this.bl=Function.createDelegate(this,this.ce);_mcp.bj.initializeBase(this,[24,n]);this.l=_h.v.c(t);this.ba=i;this.o=_a.UserAgent.getInstance();this.A=t};_mcp.bj.prototype={n:null,B:null,l:!1,M:!1,L:!1,N:null,K:null,z:null,w:null,t:null,J:null,ba:null,k:null,p:null,r:null,s:null,o:null,q:null,A:null,v:null,bW:function(n){if(n!==this.l){this.l=n;this.bj("IsLinkPreviewEnabled")}return n},bV:function(n){if(n!==this.n){this.n=n;this.cg()}return n},bH:function(){this.J||(this.J={});return this.J},bX:function(n){this.B=n;this.bj("LinkPreviewResponse");this.B&&this.k&&this.bp(this.B,this.k.bB());return n},bZ:function(n){if(n!==this.w){this.w=n;this.w&&_h.v.a(this.w,null,this.bl,null,null)}return n},bY:function(n){if(n!==this.t){this.t=n;this.t&&_h.v.a(this.t,null,this.bi,null,null)}return n},e:function(){return this.M},h:function(n){if(this.M!==n){this.M=n;this.bj("ShowYouTubePlayer")}return n},c:function(){return this.L},g:function(n){if(this.L!==n){this.L=n;this.bj("ShowOEmbedVideoPlayer")}return n},f:function(){return this.N},ca:function(n){this.N=n;this.bj("YouTubePlayerUrl");return n},b:function(){return this.K},bv:function(n){this.K=n;this.bj("OEmbedVideoPlayerHtml");return n},a:function(){this.z||(this.z=new _C(this.bc,_a.a.f));return this.z},cg:function(){if(_h.v.b){_js.Trace.logInfo(_a.a.f,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.n.Url);this.br();return}if(this.n){var i=1;var r=_a.d.b(_a.a.f,"GetComposeLinkPreview");var n=[];Array.add(n,this.n);_js.Trace.logInfo(_a.a.f,"Preparing GetLinkPreview action for {0}",this.n.Url);this.n.Autoplay=!0;var u=new _h.v(this.n);_js.Trace.logInfo(_a.a.f,"Submitting GetLinkPreview action for {0}",this.n.Url);var t=this,f=this;this.D.a.W.a(u,function(u){_h.v.j(u,t.bh,t.bb,i,r,"GetComposeLinkPreview",n)},function(t){_h.v.g(t,i,r,"GetComposeLinkPreview",n)},null)}},cb:function(n){this.bX(n)},br:function(){this.bW(!1);this.k&&(this.k.cO=!1)},ce:function(n){this.ca(n);this.h(!!this.N)},cd:function(n){var t=this.p.b(n);t?this.bv(t):this.bv(n);this.g(!!this.K)},bA:function(){this.g(!1)},i:function(n){n.h(this.W);n.d(this.V);n.c(this.U);n.g(this.T);n.e(this.P);n.f(this.Q)},j:function(n){n.n(this.W);n.j(this.V);n.i(this.U);n.m(this.T);n.k(this.P);n.l(this.Q)},bK:function(n){if(!this.l){_js.Trace.logInfo(_a.a.f,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var r="a[id^='"+t+"']";var i=$(n);return _b.m.a(n.id,t)||i.find(r).length>0},bJ:function(n){if(!this.l){_js.Trace.logInfo(_a.a.f,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var r=$(n);var i="a[id^='LPlnk']";t=_b.m.a(n.id,"LPlnk")||r.find(i).length>0;!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.m.a(n.parentNode.id,"LPlnk"));return t},bI:function(n){var t=n.c();var i=n.d();if(_zz.i.isInstanceOfType(i))this.k=i;else{_js.Trace.logError(_a.a.f,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}if(t&&this.l){if(this.bK(t)||this.bJ(t))return;if(t.href.toLowerCase().startsWith("http")){t.id=_b.m.d();_js.Trace.logInfo(_a.a.f,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.ch(t.id,t.href)}}},bD:function(n){var t=n.d();if(_zz.i.isInstanceOfType(t))this.k=t;else{_js.Trace.logError(_a.a.f,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.Y(n.c())},bB:function(n){n.c()===1&&this.bx(n.e())},bC:function(n){this.Y(n.c())},bF:function(n){var t=n.c();this.by(t)},bE:function(n){var t=n.c();this.Y(t)},ch:function(n,t){if(!this.l){_js.Trace.logInfo(_a.a.f,"RTE: Skipping link preview requests because previews are disabled");return}_js.Trace.logInfo(_a.a.f,"RTE: Trigger link preview request for {0}",t);var i=new _g.fG;i.Id=n;i.Url=t;i.RequestStartTimeMilliseconds=_a.c.a().h();this.bw(i)},bp:function(n,t){_js.Trace.logInfo(_a.a.f,"Adding link preview for {0}",n.Url);var i=!1;_h.v.d(n)&&(i=!0);if(!this.m()){this.r=n;this.s=t;this.p&&this.bu();return}if(i){this.m().g(this.y);return}if(this.k&&this.k.S()&&this.k.x){this.k.bl(!0);this.m().c(n,this.y,t,this.bd);this.k.bg(3);this.k.bW()}else _js.Trace.logInfo(_a.a.f,"Ignore AddLinkPreview since the editor isn't active or initialized")},m:function(){if(!this.p){_js.Trace.logInfo(_a.a.f,"LinkPreviewBuilder: Create LinkPreviewBuilder");var t=!0;var n=this;this.ba.a(function(i){n.p=i.a(n.bn,n.bg,t,_y.c.a,n.A);n.p.a(n.bH());n.bu()})}return this.p},ci:function(n){this.bZ(new _a.bZ(new _a.bh(n)))},bN:function(n){this.bY(new _a.bZ(new _a.bh(n)))},bu:function(){_js.Trace.logInfo(_a.a.f,"LinkPreviewBuilder: LinkPreviewBuilderFactoryOnOnCreated");if(this.r&&this.s){_js.Trace.logInfo(_a.a.f,"LinkPreviewBuilder: There was a deferred AddLinkPreview. Calling it now");this.bp(this.r,this.s);this.r=null;this.s=null}if(this.q){_js.Trace.logInfo(_a.a.f,"LinkPreviewBuilder: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.bt(this.q);this.q=null}},bt:function(n){this.q=n;var s=!1;if(this.m())this.q=null;else return;for(var u=0;u<n.length;u++){var r=n[u];if(_b.m.a(r.id,"LPUrlAnchor")){var t;var o,e;if(e=this.m().m(r,o={val:t}),t=o.val,e){var h=this.v+"[id^='LPRemovePreview']";var c=$(t).find(h);if(c.length>0){_js.Trace.logInfo(_a.a.f,"Remove preview button already added. Skipping preview initialization.");return}this.Z(t);var i=!1;var f;this.m().i(t,f={val:i}),i=f.val;if(i){this.m().h(r);s=!0}this.bq(t)}}}s&&this.m().g(this.y)},bw:function(n){this.bV(n)},bG:function(n){this.bq(n);var t=n;if(this.o.b()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.Z(t);return t},bq:function(n){this.A.a().U().Enabled?this.bM(n):this.bP(n)},bP:function(n){var t=window.document.createElement("div");t.id="LPRemovePreview";this.v=t.tagName;t.setAttribute("unselectable","on");var i=$(t);i.css("-moz-user-select","none");i.css("-khtml-user-select","none");i.css("-webkit-user-select","none");i.css("-ms-user-select","none");t.style.textAlign="right";i.text(_nbs.a.WV);t.style.width=n.children[0].style.width;t.style.fontSize="13px";t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.color="#000000";t.style.cursor="pointer";i.one("click",this.x);n.appendChild(t)},bM:function(n){var t=window.document.createElement("a");t.id="LPRemovePreview";this.v=t.tagName;t.style.fontSize="12px";t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.color="#333333";t.style.fontWeight="normal";t.style.position="relative";t.style.cssText+="float: right";var i=$(t);t.style.cursor="pointer";i.one("click",this.x);i.text(_nbs.a.WV);i.css("-moz-user-select","none");i.css("-khtml-user-select","none");i.css("-webkit-user-select","none");i.css("-ms-user-select","none");var f=$(n);var r=f.find("td[id^='LPRemovePreviewContainer']");if(r.length>0){var u=r.get(0);u.appendChild(t)}},Z:function(n){_js.Trace.logInfo(_a.a.f,"InitializePreviewForEditor: InitializePreviewForEditor.");if(this.o&&(this.o.f()||this.o.b()||this.o.i()||this.o.a())){n.setAttribute("contenteditable",!1);var t=$(n);t.bind("click",this.X)}},bs:function(n){for(var r=[],i=n.getElementsByTagName(this.v),t=0;t<i.length;t++)i[t].id==="LPRemovePreview"&&Array.add(r,i[t]);return r},bU:function(n){var t=_a.d.b(_a.a.f,"RemoveLinkPreviewClickEvent");if(!this.k){_js.Trace.logError(_a.a.f,"RemovePreviewClicked: editor was null");return}this.k.ct(n);var r=n.target;var i=_b.m.b(r);var u=this.k.cB();if(i){this.k.mw(i);_a.d.a(t)}else if(t){t.k="Either cursor was invalid or Preview DOM was null";_a.d.a(t)}},by:function(n){if(!this.l){_js.Trace.logInfo(_a.a.f,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var r=this.bs(n),u=0;u<r.length;u++){var f=r[u];var t=_b.m.b(f);if(t){t.removeAttribute("contenteditable");var i=$(t);i.unbind("click",this.X);$(f).remove();this.m().k(i);this.m().j(i)}}return r.length>0},Y:function(n){if(!this.l){_js.Trace.logInfo(_a.a.f,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_js.Trace.logInfo(_a.a.f,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_js.Trace.logInfo(_a.a.f,"RTE: Skipping link preview initialization because bodyElement is text node");return}var t=n.getElementsByTagName("A");this.bt(t)},bx:function(n){if(!this.l){_js.Trace.logInfo(_a.a.f,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var u=this.bs(n),t=0;t<u.length;t++){var r=u[t];var i=_b.m.b(r);if(i){this.Z(i);var f=$(r);f.one("click",this.x)}}},bT:function(n){if(!this.k){_js.Trace.logError(_a.a.f,"PreviewClicked: editor was null");return}if(this.k.cB()){var i=n.target.parentNode;var t=_b.m.b(i);if(t){this.k.nd(t);this.D.a.T.a(_a.bE,new _a.bE(_nbs.a.Bk+t.innerText.replace(_nbs.a.WV,"")))}}}};_mcp.H=function(n){_mcp.H.initializeBase(this,[14,n])};_mcp.H.prototype={b:null,c:0,a:null,d:function(){_mcp.bc.prototype.d.call(this);this.a=this.i();var n=this.D.a;this.b=n.bb();this.c=n.L.a();_mcp.f.g(n.L)&&!n.L.by()&&this.m()},m:function(){this.b.e(_mcp.H.a);this.e()},i:function(){var n=this.D.a.L;var t=n.d()||n.Z();return t&&n.bl()?t:null},l:function(){if(_g.i.isInstanceOfType(this.a))return this.a.t();else if(_g.bk.isInstanceOfType(this.a)){var n=this.a;return n.v().t()==="RecurringMaster"?n.H()?"RecurringMaster":"Occurrence":n.v().t()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},e:function(){if(this.a){this.g();if(!_g.bC.isInstanceOfType(this.a)){this.b.a(6800);switch(this.l()){case"Occurrence":case"Exception":this.h();break;case"RecurringMaster":this.f();break}}}},j:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:t=3210;break;case 6:t=3215;break;case 7:t=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},k:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:t=3110;break;case 6:t=3115;break;case 7:t=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},f:function(){var n=this.k(this.c);this.b.a(n)},h:function(){var i=new _cc.bf;var t=i.a(this.a,null);var n=this.j(this.c);this.b.a(n,t)},g:function(){if(_g.H.isInstanceOfType(this.a)){var t=this.a;var i=t.dB()&&!!t.bl.ReceivedRepresenting;if(i){var n=-1;switch(this.c){case 5:n=3250;break;case 7:n=3260;break;case 6:n=3255;break}n!==-1&&this.b.a(n,t.bl.ReceivedRepresenting.Mailbox.Name)}}}};_mcp.J=function(n,t,i){this.l=Function.createDelegate(this,this.bc);this.m=Function.createDelegate(this,this.bg);this.B=Function.createDelegate(this,this.bs);this.x=Function.createDelegate(this,this.h);this.z=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.bd);this.K=Function.createDelegate(this,this.bu);this.J=Function.createDelegate(this,this.bt);this.c=Function.createDelegate(this,this.bi);this.A=Function.createDelegate(this,this.bp);this.n=Function.createDelegate(this,this.bl);this.o=Function.createDelegate(this,this.bq);_mcp.J.initializeBase(this,[0,n]);this.b=n.a.bq;this.f=t;this.w(!0);this.s=i};_mcp.J.prototype={b:null,i:!1,e:!1,k:!1,r:null,v:null,j:null,f:null,s:!1,a:null,C:function(){return _mcp.bc.prototype.C.call(this)},S:function(n){if(n!==_mcp.bc.prototype.C.call(this)){_mcp.bc.prototype.S.call(this,n);this.bj("IsInitialized")}this.D.a.L.dx(n);return n},X:function(n){if(n!==this.i){this.i=n;this.bj("IsSecondInitializationComplete")}return n},w:function(n){if(this.e!==n){this.e=n;this.bj("CanLoadPopoutSuccessfully")}return n},Y:function(){if(this.a){this.a.a();this.a=null}},d:function(){this.r=_js.e.s(_a.a.a,517,"VM.MailCompose.FirstInit");var i=this.D.a;var n=i.L;n.apcl("IsEditorInitialized",this.o);n.apcl("IsUpgraded",this.n);if(!n.ee&&!n.i()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline, context: {0}",n);n.ee=_mcp.b.b(n);n.en()||n.ep(!0)}if(n.eP()){_js.Trace.logInfo(_a.a.a,"Finish 1st init for complete context");this.g();_js.Trace.logInfo(_a.a.a,"Check begin upgrade for complete context");this.q()}else{var e=i.W;var r=n.i();var t=n.be();var o=n.fQ();if(!r&&o){var u;var f=_g.a.a().c();u=_js.d.a(f.bl.SharePointUrl)?f.bl.UserEmailAddress||"":f.bl.LogonEmailAddress||"";var v=new _g.ew("StoreId",o,u);var a=new _c.Q([v],"EwsId");var p=this;e.a(a,this.A,function(n){p.bn(n)},this.c);_js.Trace.logInfo(_a.a.a,"Calling server to convert id, storeId={0}",o)}else if(r)if(n.ce()&&n.en()){_js.Trace.logInfo(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.W()}else{_js.Trace.logInfo(_a.a.a,"Load draft {0}",_h.bk.a(r));this.t(r)}else if((4===n.a()||13===n.a())&&n.en()){_js.Trace.logInfo(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.W()}else if(t){i.M.b(3400);i.M.a(3400,null);if(n.eS()){var y=_cc.L.a(t,n.bZ());var h=new _cc.L(200,y);h.I=n.b();var l=this;e.a(h,this.J,function(n){l.V(n)},this.c);_js.Trace.logInfo(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var s=i.bu.e(t);s.I=n.b();var c=this;e.a(s,this.K,function(n){c.V(n)},this.c);_js.Trace.logInfo(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cn(!0);n.eq(!0);_js.Trace.logInfo(_a.a.a,"Finish 1st init for new mail");this.g()}else{this.h("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.l.b(_y.M,n.a())));}}_js.d.a(_g.a.a().c().bl.SharePointUrl)||i.M.a(110,null)},H:function(){var t=this.D.a;var n=t.L;n.rpcl("IsEditorInitialized",this.o);n.rpcl("IsUpgraded",this.n);this.S(!1);this.X(!1);this.w(!0);this.k=!1;this.Y()},L:function(){this.ba();this.v=_js.e.s(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.D;var n=i.a;var r=n.L;_js.Trace.logInfo(_a.a.a,"Queue 2nd init task, context:{0}",r);_js.g.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.y);if(n.fG()&&!n.dp.a){var f=i.b(10);_js.Trace.logInfo(_a.a.a,"Queue appbar setup task");var t=f;_js.g.a().c(_a.a.a,"SetupApplicationBarMenu",t.c||(t.c=Function.createDelegate(t,t.i)))}if(r.bu()){_js.Trace.logInfo(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var o=this;_js.g.a().c(_a.a.a,"Diagnostics save:",function(){n.c().b("Diagnostics",null,null,!1)})}if(_a.cC.a){var u=i.b(17);_js.Trace.logInfo(_a.a.a,"Queue GetMailTips if needed task");var e=this;_js.g.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){u.a(32)})}},bs:function(n){var f=_js.e.s(_a.a.a,2,"VM.MailCompose.ProcessDraft");var o=this.D.a.L;var e=this.E.bg();var i=n;var t=n.I;_js.Trace.logInfo(_a.a.a,"Got draft, checking pending discards for {0}",t);if(this.b.a(t))e.b(t,i.e[0]);else if(t===this.F.b()){var r=i.a;if(_g.bN.isInstanceOfType(r)){this.F.cS(r);this.p(!0);this.U(i)}else _a.j.a&&r.bA()?this.bh(r,i):this.Q(r,i);if(_a.bl.a){var u=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){var n=u.D.b(23);n.a(32)})}}else _js.Trace.logInfo(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",t,this.F);_js.e.e(f);_js.e.e(this.j)},bh:function(n,t){var i=this;this.E.cu(function(){i.Z();i.a.c(n,t)})},Z:function(){if(!this.a){_js.Trace.logInfo(_a.a.a,"Setting initializer component override");this.a=this.E.bG().b();var n=this.D.b(27);this.a.b(this.z,n.b,this.x,this.E.W)}},Q:function(n,t){this.F.cR(n);this.p(!1);this.U(t)},U:function(n){if(this.F.en()&&this.F.cQ()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline for a loaded draft.");this.F.ee=_mcp.b.b(this.F)}_js.Trace.logInfo(_a.a.a,"Finish 1st init for a loaded draft.");this.g();var t=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){var n=t.D.b(23);n.a(32)})},bt:function(n){var u=this.D;var f=u.a;var t=f.L;var i=n.I;if(i===t.b()&&!this.b.a(i)){var r=n;t.N(r.h);t.cl(!1);_js.Trace.logInfo(_a.a.a,"Got original cal item, finish 1st init with context:{0}",t);this.g();_js.Trace.logInfo(_a.a.a,"Check begin upgrade on original cal item");this.q()}},bu:function(n){var u=this.D;var f=u.a;var t=f.L;var i=n.I;if(i===t.b()&&!this.b.a(i)){var r=n;t.N(r.a);_js.Trace.logInfo(_a.a.a,"Got original message, finish 1st init with context:{0}",t);this.g();_js.Trace.logInfo(_a.a.a,"Check begin upgrade on original message item");this.q()}},bc:function(n,t){this.E.b().b(this.D.a,!1);_js.Trace.logInfo(_a.a.a,"Navigate away on action failure")},bi:function(n){var t=this.D.a;var i=t.L;if(n.I===i.b()){t.M.b(3400);this.E.N()}},g:function(){var e=_js.e.s(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.D;var u=n.a;var f=u.L;var s=f.a();n.b(7).d();n.b(8).d();n.b(1).d();f.bl()&&n.b(14).d();var i=n.b(11);i.d();if(this.F.a()!==4&&!this.F.L()||!this.F.a()&&this.F.L()){var t=this.E.bk().c(this.f.a()&&this.F.f()==="HTML",this.F.L());if(i.c()){var r=i.a();r&&(t=t+r)}this.F.H(t)}var o=_y.c.a.a();if(o!=="Mouse"){if(this.f.b()){n.b(5).d();n.b(6).d();n.b(3).d();n.b(9).d();n.b(22).d();n.b(28).d()}n.b(10).d()}else n.b(22).d();_js.e.e(e);_js.e.e(this.r);if(u.bI){_js.Trace.logInfo(_a.a.a,"Begin 2nd init in finish 1st because we are already in view.");this.L()}this.S(!0)},bd:function(){var n=this.D;var i=n.a;var t=i.L;n.b(2);n.b(15);n.b(25);n.b(29);n.n();t.ed()||t.fn();this.X(!0);_js.Trace.logInfo(_a.a.a,"Finish 2nd init, context:{0}",t);_js.e.e(this.v)},t:function(n){this.j=_js.e.s(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.D.a;var t=i.L;var e=i.W;if(t.en()){if(t.cQ()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline since message was a clean new message before popout, context: {0}",t);t.ee=_mcp.b.b(t)}t.bd()&&!t.g()&&this.p(!0)}else t.eZ(!0);i.M.b(3400);i.M.a(3400,null);t.eR()&&i.M.a(3480);var r=this.f.a()&&t.f()==="HTML"?_h.b.c():_h.b.m();var o="MailCompose";var u=i.bu.e(n,r,o);u.I=t.b();var f=this;e.a(u,this.B,function(n){f.br(n)},this.c);_js.Trace.logInfo(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.bk.a(n),r.BodyType,_y.c.a.a(),t.f())},p:function(n){if(n!==this.k){var t=this.D.a.M;t.b(3440);n&&t.a(3440,null);this.E.N();this.k=n}},bp:function(n){var i=n;var t=new _g.g(i.e().Id);this.D.a.L.D(t);this.t(t)},q:function(){var u=this.D;var n=u.a.L;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.i()||n.g()){if(i&&n.i()&&n.g()&&_a.UserAgent.getInstance().D){var r=this;_js.g.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){r.E.N()},1e3)}}else this.E.bw().c()},W:function(){var n=this.D.a.L.b();if(this.s){_js.Trace.logInfo(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.Q.b,this.m)}else{_js.Trace.logInfo(_a.a.a,"Calling main window to process save result {0}",n);_g.j.b.getSaveResultForPopout(n,_a.Q.b,this.m)}},bg:function(n){var t=this.D.a.L;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.bd()&&!t.g()&&t.cn(!0);this.t(i)}else{_js.Trace.logInfo(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.w(!1);this.h("ErrorSaveFailedOnMainWindow",null,null)}},bq:function(n,t){var r=this.D.a;var i=r.L;i.ev&&this.bb()},bl:function(n,t){var r=this.D.a;var f=r.L;if(f.g()){var i=this.E.bw();if(i.b()){var u=r.bA()?r.bA().toString():"";_y.j.a(i.b(),null,null,null,u);i.j(null)}}},bb:function(){var t=this.D.a;var n=t.L;if(n.eG()){var i=t.bA()?t.bA().toString():"";_y.j.a(n.eG(),null,"",null,i);n.T(null)}this.M()},h:function(n,t,i){var f=this.D.a;var r=f.L;if(r.cB()){var u=new _a.r;_js.d.a(i)||u.b("E",i);_y.j.a(r.cB(),null,n,t,this.T(u.toString(),r.cB().j));r.G(null)}if(r.eG()){_y.j.a(r.eG(),null,n,t,i);r.T(null)}this.M()},T:function(n,t){var i="";i=_js.d.a(n)?t:_js.d.a(t)?n:n+"|"+t;return i},ba:function(){var i=this.D.a;var n=i.L;if(n.cB()){var t=n.cB().j;i.bA()&&(t=this.T(i.bA().toString(),t));_y.j.a(n.cB(),null,"",null,t);n.G(null)}},M:function(){var i=this.D.a;var t=i.L;if(t.fS()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.y.endPT(n);t.U(!1)}}},bn:function(n){this.P(n,"ConvertIdAction")},br:function(n){this.P(n,n.g)},P:function(n,t){var i=this;this.N(n,t,function(t){t.g(n,_nbs.a.Kf,_nbs.a.Cx,_nbs.a.Kf,_bms.E.BC,i.l)})},V:function(n){var t=this;this.N(n,n.g,function(i){i.f(n,t.l)})},N:function(n,t,i){var u=t+"_UnknownError";var s=this.D;var e=s.a;var h=e.L;var f=n.I;f!==h.b()||this.b.a(f)||i(e.W);var r=u;r=_g.X.a(n.t)?_g.X.b(n.t)||u:n.t.ExceptionName||u;var o=n.t.FaultMessage||n.t.message;_js.e.e(this.j);this.h(r,n.B(),o)}};_mcp.f=function(n){_mcp.f.initializeBase(this,[4,n])};_mcp.f.f=function(){_mcp.f.b||(_mcp.f.b=new _H("LocationViewModel",_cc.I,_mcp.f));return _mcp.f.b};_mcp.f.e=function(){_mcp.f.a||(_mcp.f.a=new _H("IsMeetingForwardOnBehalfOf",Boolean,_mcp.f));return _mcp.f.a};_mcp.f.g=function(n){switch(n.a()){case 4:return n.by();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_mcp.f.prototype={c:function(){return this.dS(_mcp.f.c)},f:function(n){this.dR(_mcp.f.c,n);return n},b:function(){return this.dS(_mcp.f.d)},a:function(n){this.dR(_mcp.f.d,n);return n},h:function(){return this.dS(_mcp.f.f())},g:function(n){this.dR(_mcp.f.f(),n);return n},e:function(){return this.dS(_mcp.f.e())},i:function(n){this.dR(_mcp.f.e(),n);return n},d:function(){var n=this.D.a.L;var i=this.D.a.ch;n.bW()?this.g(new _cc.I(n.cH(),null,this.D.a.ch,this.D.a.X,!1,!1)):this.g(null);if(n.bl()&&n.bx()){var t=2;var f=_pc.a.k(n.j());var e=i.e(f,_bc.f.a,!0,t);this.f(e);this.i(!!n.bo()&&!!n.bo().Mailbox&&!!n.j()&&!!n.j().Mailbox&&!_g.o.b(n.j().Mailbox,n.bo().Mailbox));if(this.e()){var r=_pc.a.k(n.bo());var u=i.e(r,_bc.f.a,!0,t);this.a(u)}else this.b()&&this.a(null)}else{this.c()&&this.f(null);this.b()&&this.a(null)}_js.Trace.logInfo(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.bl(),n.bx());_mcp.bc.prototype.d.call(this)}};_mcp.n=function(n,t,i,r){_mcp.n.initializeBase(this,[n,t]);this.t=r;this.n=i};_mcp.n.a=function(n,t){return new _fm.i(n,t,null,1,null,null,!1,!1)};_mcp.n.prototype={t:null,n:null,q:null,p:null,k:function(){return this.q},j:function(){return this.p},cu:function(){return!!this.n&&this.n.a().b().Enabled&&!!this.t&&this.t.a()==="TouchNarrow"},bn:function(){return this.t.a()==="Mouse"&&!!this.n&&this.n.a().f().Enabled&&!this.E.V()},d:function(){this.bn()?this.x():this.y();_mcp.bc.prototype.d.call(this)},H:function(){this.q=null;this.p=null;_mcp.bc.prototype.H.call(this)},m:function(){this.bn()?this.A():this.B()},B:function(){},A:function(){}};_mcp.bl=function(n,t,i,r){this.h=Function.createDelegate(this,this.P);this.g=Function.createDelegate(this,this.N);this.v=Function.createDelegate(this,this.L);this.l=Function.createDelegate(this,this.Q);this.s=Function.createDelegate(this,this.K);this.w=Function.createDelegate(this,this.T);this.z=Function.createDelegate(this,this.X);_mcp.bl.initializeBase(this,[9,n,i,r]);this.r=t};_mcp.bl.prototype={r:null,f:null,e:null,c:null,o:null,b:function(){return this.f},W:function(n){if(this.f!==n){this.f=n;this.bj("ShowMessageOptionsCommand")}return n},a:function(){return this.e},V:function(n){if(this.e!==n){this.e=n;this.bj("DialogViewModel")}return n},d:function(){this.f||this.W(new _C(this.z,this.G()));this.J();_mcp.n.prototype.d.call(this)},y:function(){if(!this.F.A()&&!this.t.c()&&!this.E.V()){var n=new _fm.d(_nbs.a.NI,null,this.f);this.q=[n]}},x:function(){if(!this.F.A()&&!this.t.c()){var n=_mcp.n.a(this.f,_nbs.a.NI);this.p=[n]}},X:function(){_js.Trace.logInfo(_a.a.a,"User chose to show message options");$a(this.c)&&(this.c=new _mcp.D);this.c.t(this.F);if($a(this.e)){var t=new _bc.j;t.x(this.r);this.V(t);this.e.k(_nbs.a.Ez);this.o=[new _ff.f(new _C(this.w,this.G()),_u.P.T,null),new _ff.f(new _C(this.s,this.G()),_u.R.fU,null)];this.e.h.p(this.o)}this.e.m(this.c);if("TouchNarrow"===_y.c.a.a()){var n=this.D.a.br();this.c.v(n);n.b().d(this.l)}this.e.g(!0)},T:function(){if(this.e.D){_js.Trace.logInfo(_a.a.a,"User tried to click OK button more than once.");return}var n=this.E.L;if(n.C()!==this.c.d){this.D.a.R().a("Sensitivity:"+this.c.d);"Normal"!==n.C()&&this.U();n.dG(this.c.d);"Normal"!==n.C()&&this.J()}n.bb()!==this.c.e&&this.D.a.R().a("RequestDeliveryReceipt");n.bc()!==this.c.f&&this.D.a.R().a("ReadReceiptRequested");n.dn(this.c.e);n.du(this.c.f);this.c.a&&!n.q()||this.c.b&&!n.E()?this.E.cu(this.v):this.L();this.c.a!==n.q()&&this.D.a.R().a("EncryptMessage");this.c.b!==n.E()&&this.D.a.R().a("SignMessage")},L:function(){var n=this.E.L;var u=this.D.a;var t=this.E.S();var i=t.a();if(n.q()!==this.c.a){n.dI(this.c.a);this.bj("SmimeEncryptMessage");_js.Trace.logInfo(_a.a.g,"SmimeEncryptMessage option is changed to {0} by user.",this.c.a)}if(n.E()!==this.c.b){n.dK(this.c.b);this.bj("SmimeSignMessage");_js.Trace.logInfo(_a.a.g,"SmimeSignMessage option is changed to {0} by user.",this.c.b)}var r=this.c.a||this.c.b;r&&u.dP();i&&i.ba(n.t());if(this.c.k&&!r&&t.e())if(t.b()){_js.Trace.logInfo(_a.a.g,"Waiting to move attachments because the attachment well is currently in progress.");this.e.r(!0);i.O(this.g)}else this.N(null,null);else if(!this.c.k&&r){this.E.bw().f()&&!n.S()&&this.E.bw().a().a();if(t.e())if(t.b()){_js.Trace.logInfo(_a.a.g,"Waiting to move attachments because the attachment well is currently in progress.");this.e.r(!0);i.O(this.h)}else this.P(null,null);else this.i()}else this.i()},N:function(n,t){if(this.M(n,t)){_js.Trace.logInfo(_a.a.g,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.u(this.g);this.e.r(!1)}var i=this.E.S().a();if(this.E.L.i())i.V();else{var r=this;this.E.c().b("Attach",function(){i.V()},null,!1)}this.i()}},P:function(n,t){if(this.M(n,t)){_js.Trace.logInfo(_a.a.g,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.u(this.h);this.e.r(!1)}this.E.S().a().W();this.i()}},M:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.g()},i:function(){_js.Trace.logInfo(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.F.C()+"; DeliveryReceipt="+this.F.bb()+"; ReadReceipt="+this.F.bc()+"; SmimeEncryptMessage="+this.F.q()+"; SmimeSignMessage="+this.F.E());this.K()},K:function(){if(this.e.D){_js.Trace.logInfo(_a.a.a,"User tried to close dialog when busy.");return}var t=this.D.a.L;var i=this.E.bb();if(t.t()&&t.z()){_a.M.a(_u.R.Hk,1);i.a(750)}else i.b(750);this.E.Q().w.c(!t.t());var n=this.E.S();if(n.a()){n.a().u(this.g);n.a().u(this.h)}"TouchNarrow"===_y.c.a.a()&&this.c.g.b().e(this.l);_js.Trace.logInfo(_a.a.a,"Close message options dialog");this.e.i.a()},Q:function(n,t){_mcp.d.isInstanceOfType(this.D.a.br().a())?this.e.g(!0):this.e.g(!1)},U:function(){var t=this.D.a;var n=t.bb();switch(t.L.C()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.E.N()},J:function(){var t=this.D.a;var n=t.bb();switch(t.L.C()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.E.N()}};_mcp.k=function(n,t){this.Q=Function.createDelegate(this,this.bg);this.Z=Function.createDelegate(this,this.bv);this.V=Function.createDelegate(this,this.bs);this.X=Function.createDelegate(this,this.bl);this.Y=Function.createDelegate(this,this.bu);this.T=Function.createDelegate(this,this.bp);this.W=Function.createDelegate(this,this.bt);this.z=Function.createDelegate(this,this.bq);this.ba=Function.createDelegate(this,this.bw);this.U=Function.createDelegate(this,this.br);_mcp.k.initializeBase(this,[2,n]);this.J=new _C(this.U,this.G());var u=this;this.N=new _C(function(){u.A("Upconvert")},this.G());var f=this;this.L=new _C(function(){f.A("ShowOriginalMessage")},this.G());var i=this,r=this;this.P=new _C(function(){i.A("UpconvertOnFormat")},this.G(),this.D.a.L,"BodyType",function(){return r.D.a.L.f()==="HTML"});this.M=new _C(this.ba,this.G());this.n=n.a.bq;this.q=t};_mcp.k.prototype={n:null,q:null,J:null,N:null,P:null,L:null,M:null,s:!1,t:!1,m:!1,o:!1,x:!1,l:null,p:null,w:!1,e:function(){return this.J},v:function(n){this.s!==n&&(this.s=n);return n},j:function(){return this.t},y:function(n){if(this.t!==n){this.t=n;this.bb(n)}return n},i:function(){return this.m},K:function(n){if(this.m!==n){this.m=n;this.bb(n)}return n},k:function(){return this.o},h:function(){return this.r().n()},f:function(n){this.r().q(n);return n},r:function(){$a(this.p)&&(this.p=this.bd());return this.p},d:function(){var n=_y.c.a;"Mouse"!==n.a()||n.c()||n.x(this.z);_mcp.bc.prototype.d.call(this)},a:function(n){this.p=n},b:function(n,t){n.D(!0);this.r().o(n,t)},g:function(n){this.D.a.bh&&(this.w=!0);if(!this.w){_js.Trace.logInfo(_a.a.a,"Checking dirty before prompting user for before unload confirmation. Context: {0}",this.D.a.L);this.D.a.bx()&&n.a(_nbs.a.JM)}this.w=!0;_js.g.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.W,100)},c:function(){var n=!0;var u=this.D;var t=u.a;var i=t.L;var r=t.e();var o=t.c();var e=i.b();var s=i.a();if(this.n.a(e))_js.Trace.logInfo(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.bd()&&this.n.g(u,!1))_js.Trace.logInfo(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.bc())n=!1;else if(r.a()){_js.Trace.logInfo(_a.a.a,"We're sending the message, can't exit yet.");n=!1}else if(r.h()){_js.Trace.logInfo(_a.a.a,"We're resolving the recipients before sending, can't exit yet.");r.f();n=!1}else if(i.A()){var f=t.bg();f.a().a();n=!1}else{_js.Trace.logInfo(_a.a.a,"Checking dirty before navigating away from compose. Context:{0}",i);if(t.bx()){this.x=!1;_js.g.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.T,1e4);this.R();if(o.b("ReadingPaneExit",this.Y,this.X,!1)){this.K(!0);_js.Trace.logInfo(_a.a.a,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},bd:function(){return new _y.bf},bt:function(){this.w=!1},bq:function(){_y.c.a.H(this.z);this.n.g(this.D,!0)},bb:function(n){var t=this.D.a;t.df(_u.P.k);t.de(n);t.dJ(n)},br:function(){var f=this.D;var t=f.a;var n=t.L;var o=n.b();_js.g.a().j(_a.a.a,"MailComposePopOut");if(this.s){_js.Trace.logInfo(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.bh()){n.G(this.l=_y.j.b(_a.a.a,"MailComposeReadingPanePopOut",!0));this.v(!0);var e=!1;try{var h=this.D.a.M;h.e(_mcp.k.b);this.E.N();var i=t.c();_js.Trace.logInfo(_a.a.a,"Checking dirty before popping out from reading pane. Context:{0}",n);var u=t.bx();var r=t.L.cF();var s=f.b(11);if(!n.i()||u||s.c()||r){this.y(!0);(n.i()&&!r||u||i.e())&&n.ep(!1);_js.Trace.logInfo(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.cQ());this.o=!1;_js.g.a().a(_a.a.a,"PopoutSaveTimeout",this.V,1e4);n.fe(!0);this.R();t.bc.get_saveForPopoutMap()[o]=new _y.fR;this.bi();i.b("Popout",this.Z,this.Q,!1)}else{if(n.bY())n.ep(!1);else if(n.bV())n.ep(!1);else if(i.e())n.ep(!1);else if(n.ee){_js.Trace.logInfo(_a.a.a,"Comparing initial baseline with baseline. Context:{0}",n);n.ee.q(n.ed())||n.ep(!1)}else n.ep(!1);n.fe(!1);_js.i.c(t.bc,"PopoutManager");_js.i.c(t.bc.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bc.get_saveForPopoutMap()[o];this.bi()}_js.Trace.logInfo(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.r().p(!0);e=!0}finally{if(!e){this.v(!1);this.y(!1);_y.j.a(this.l,null,_mcp.k.a.toString(4));n.G(null);this.l=null}}}},bh:function(){var r=this.D;var u=r.a;var i=u.L;var n=i.b();var t=this.E.e();if(t.a()){_js.Trace.logInfo(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.bc()||this.n.a(n)){_js.Trace.logInfo(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}return!0},bc:function(){var n=this.D.a;var t=n.S();if(t.b()){if(!n.U.j){_js.Trace.logInfo(_a.a.a,"Show attachment in progress error dialog");n.U.a(0,_u.R.NO,null)}return!0}return!1},bi:function(){var r=this.D.a;var t=r.L;var n=new _mcp.a;if(this.q){n.dE(this.q.c());n.dj(this.q.a())}n.o(0);n.k(!1);if(t.a()===11||t.a()===12){n.e(13);n.dC(t.cb());n.dB(t.bA())}else n.e(4);n.D(t.i());n.m(t.f());var i=this.bd();n.gd(!0);n.cn(t.g());n.dL(t.F());n.dv(t.bd());n.eZ(t.bY());n.eY(t.bV());n.ep(t.cQ());n.fe(t.ce());n.fd(t.b());n.J(t.w());n.G(t.cB());t.g()||t.a()!==3||t.cT()||!t.d().U()||n.bp(t.d().U().c);i.a(n);if(!t.ce()){this.B();this.v(!1)}},bv:function(n){this.y(!1);if(this.o){_js.Trace.logInfo(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.j.a(this.l,null,_mcp.k.a.toString(3));this.l=null}else{var i=n.I;var t=this.D.a;if(i in t.bc.get_saveForPopoutMap()){var u=_mcp.S.a(n);var r=t.bc.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bc.pushSaveResultToPopout(f,r.a);delete t.bc.get_saveForPopoutMap()[i]}else r.b=u}if(t.L.b()===i){_js.Trace.logInfo(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.B();this.v(!1)}else _js.Trace.logInfo(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.L.b())}},bu:function(n){this.m&&this.K(!1);if(this.x){_js.Trace.logInfo(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.B()},bl:function(n){if(this.m){_js.Trace.logInfo(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.K(!1)}},B:function(){var n=this.D.a;this.b(n,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from reading-pane compose")},bn:function(){var u=this.D;var r=u.a;var n=r.L;if(!n.g()&&!n.i()&&!n.F()){_js.Trace.logInfo(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",n.b());r.U.a(0,_nbs.a.fa);return}if(this.bh()){var t=this.r();if(IInlineComposeConductorViewModel.isInstanceOfType(t)){var i=t;this.E.bw().a().a();i.e(!1);i.j(n)}}},bw:function(){var n=this;this.D.a.L.dD(function(n){var t=n.be().h;t?t.a().a():_js.Trace.logError(_a.a.a,"ExtensibilityViewModel is null, Apps pane is not opened after upconvert")});this.E.R().a("UpconvertAndShowApps");this.bn()},bg:function(n){if(this.s){this.v(!1);this.y(!1);var f=this.D;var i=f.a;var t;t=n?n.I:i.L.b();if(t in i.bc.get_saveForPopoutMap()){var r=i.bc.get_saveForPopoutMap()[t];r.a.length>0&&i.bc.pushSaveResultToPopout(null,r.a);delete i.bc.get_saveForPopoutMap()[t]}}var u=this.o?2:1;_y.j.a(this.l,null,_mcp.k.a.toString(u));this.l=null},bs:function(){_js.Trace.logInfo(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.t){this.o=!0;this.bg(null);var t=this.D;var n=t.a.M;this.R();n.a(84);this.E.N()}},bp:function(){_js.Trace.logInfo(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.m){this.x=!0;this.bl(null);var n=this.E.M;this.R();n.a(86);this.E.N()}},A:function(n){this.E.R().a(n);this.bn()}};_mcp.k.a=function(){};_mcp.k.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.k.a.registerEnum("_mcp.k.a",!1);_mcp.bm=function(n,t,i){this.h=Function.createDelegate(this,this.w);this.s=Function.createDelegate(this,this.z);this.v=Function.createDelegate(this,this.J);_mcp.bm.initializeBase(this,[30,n,t,i]);this.g=new _C(this.v,this.G());this.f=new _C(this.s,this.G());if(this.E.L.bm()){var r=this.E.bb();r.a(10206)}};_mcp.bm.prototype={g:null,f:null,r:null,l:null,o:null,i:null,a:function(){return!!this.E.bd.OmeSettings},e:function(){return this.g},c:function(){return this.f},d:function(){if(!this.E.bd.WasLoadedFromServer){var n=this.E.T;n.b(_a.cO,this.h)}_mcp.n.prototype.d.call(this)},H:function(){this.E.T.c(_a.cO,this.h);this.g=null;this.f=null;_mcp.n.prototype.H.call(this)},b:function(n){if(!_y.c.a.h()){this.r=new _fm.d(_nbs.a.JB,null,this.g);this.l=new _fm.d(_nbs.a.kY,null,this.f);Array.add(n,this.r);Array.add(n,this.l);this.B()}},y:function(){var n=[];this.b(n);this.q=n},x:function(){if(!_y.c.a.h()){var n=this.D.b(30);this.o=new _fm.i(this.g,_nbs.a.JB,null,1,null,null,!1,!1);this.i=new _fm.i(this.f,_nbs.a.kY,null,1,null,null,!1,!1);this.p=[this.o,this.i];this.A()}},m:function(){if(_y.c.a.a()==="Mouse"||this.cu())this.bn()?this.A():this.B();else{var n=this.D.b(10);n.j()}},A:function(){var t=this.a();var n=this.E.L.bm();this.o.a(t&&!n);this.i.a(t&&n)},B:function(){var t=this.a();var n=this.E.L.bm();this.r.c(!t||n);this.l.c(!t||!n)},J:function(){this.E.L.cm(!0);this.m();var n=this.E.bb();n.a(10206,null)},z:function(){this.E.L.cm(!1);this.m();var n=this.E.bb();n.b(10206)},w:function(n){var t=this.D.a;this.m();t.T.c(_a.cO,this.h)}};_mcp.bn=function(n,t){this.c=Function.createDelegate(this,this.e);_mcp.bn.initializeBase(this,[13,n]);this.b=new _C(this.c,this.G());this.b.c(t.d().a().c())};_mcp.bn.prototype={b:null,a:function(){return this.b},e:function(){_js.Trace.logInfo(_a.a.a,"OpenFilePicker on PAL.");var n=this.D.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}if(!n.c()){_js.Trace.logError(_a.a.a,"Unable to open file picker, ViewModel is not upgraded.");return}n.a().bz();_js.Trace.logInfo(_a.a.a,"OpenFilePicker on PAL end.")}};_mcp.bp=function(n,t){this.g=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.h);_mcp.bp.initializeBase(this,[13,n]);var i;i=t.b(t.d())?t.d().a():this;var u=this;this.c=new _C(this.f,this.G(),i,"CameraAvailable",function(){return t.b(t.d())&&t.d().a().e()});var r=this;this.e=new _C(this.g,this.G(),i,"GalleryAvailable",function(){return t.b(t.d())&&t.d().a().f()})};_mcp.bp.prototype={c:null,e:null,a:function(){return this.c},b:function(){return this.e},h:function(){_js.Trace.logInfo(_a.a.a,"User chose to attach from camera");var n=this.D.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}if(!n.c()){_js.Trace.logError(_a.a.a,"Unable to open camera, ViewModel is not upgraded.");return}n.a().X(n.g());_js.Trace.logInfo(_a.a.a,"Attach from camera end")},i:function(){_js.Trace.logInfo(_a.a.a,"User chose to attach from gallery");var n=this.D.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}if(!n.c()){_js.Trace.logInfo(_a.a.a,"Unable to open gallery, ViewModel is not upgraded.");return}n.a().B(n.g());_js.Trace.logInfo(_a.a.a,"Attach from gallery end")}};_mcp.u=function(n,t,i){this.cA=Function.createDelegate(this,this.dC);this.cB=Function.createDelegate(this,this.dD);this.cD=Function.createDelegate(this,this.dE);this.cE=Function.createDelegate(this,this.dF);this.cv=Function.createDelegate(this,this.dm);this.cx=Function.createDelegate(this,this.bu);this.cy=Function.createDelegate(this,this.cN);this.cz=Function.createDelegate(this,this.cO);this.bX=Function.createDelegate(this,this.dQ);this.bU=Function.createDelegate(this,this.dL);this.bV=Function.createDelegate(this,this.dN);this.o=Function.createDelegate(this,this.dM);this.cI=Function.createDelegate(this,this.dT);this.N=Function.createDelegate(this,this.dK);this.bW=Function.createDelegate(this,this.dP);this.bp=Function.createDelegate(this,this.dd);this.cH=Function.createDelegate(this,this.dO);this.cJ=Function.createDelegate(this,this.dX);this.bT=Function.createDelegate(this,this.dl);this.cG=Function.createDelegate(this,this.dH);this.cL=Function.createDelegate(this,this.cY);this.cF=Function.createDelegate(this,this.dG);this.cK=Function.createDelegate(this,this.dZ);_mcp.u.initializeBase(this,[1,n,t,i]);this.c=this.ce();this.e=this.ce();this.f=this.ce();this.K=new _C(this.cK,this.G());this.U=new _C(this.cF,this.G());this.w=new _C(this.cL,this.G());this.X=new _C(this.cG,this.G());this.cg=new _C(this.bT,this.G());this.cb=new _C(this.cJ,this.G());this.Y=new _C(this.cH,this.G());this.L=new _ff.e;this.dg();if(this.du()){var r=_fp.a.v("ASD",1);n.a.W.a(r,null,null,null);this.cM=!0}};_mcp.u.d=function(n,t){n.bh(t)};_mcp.u.b=function(n,t){n.cg(t)};_mcp.u.e=function(n,t){n.cs(t)};_mcp.u.c=function(n,t){n.cZ(t)};_mcp.u.a=function(n,t){n.cY(t)};_mcp.u.prototype={c:null,e:null,f:null,K:null,U:null,w:null,X:null,cg:null,cb:null,Y:null,bA:!0,bN:null,bs:null,br:null,bK:null,bc:null,W:null,ba:null,T:null,Z:null,Q:null,bb:null,V:null,bM:null,bx:null,bJ:null,bw:null,h:null,s:null,bF:!1,g:!1,i:null,P:null,bt:null,by:null,cm:!1,cq:!1,bH:!1,bG:!1,L:null,z:null,l:null,bB:null,bC:null,cn:null,bh:null,bI:!0,dc:function(n){this.bz("ResolveOperationSucceeded",n)},dV:function(n){this.bS("ResolveOperationSucceeded",n)},db:function(n){this.bz("ResolveOperationCanceled",n)},dU:function(n){this.bS("ResolveOperationCanceled",n)},bE:function(n){if(this.h!==n){this.h=n;this.bj("FromPersonaViewModel")}return n},b:function(){return this.h&&this.h.bA?this.h.bA.a():null},dv:function(){return!!this.n&&this.n.a().Q().Enabled&&_y.c.a.a()==="Mouse"},du:function(){return!!this.n&&this.n.a().N().Enabled},cM:!1,r:function(){if(!this.s){var n=this;this.E.cB.a(function(t){var i=t.a();i.d(!0);i.F(!1);i.bq(100);i.G(0);i.bo("PersonaDetailedView");i.T();i.w(!0);i.J(new _C(n.bp,_a.a.a));n.t.c()&&n.dx()&&i.I(new _C(n.bp,_a.a.a));_y.c.a.a()!=="Mouse"&&i.bj(new _C(n.bp,_a.a.a));i.q(n.bW);n.s=i;if(n.bH){n.cY();n.bH=!1}else if(n.bG){n.cl();n.bG=!1}})}return this.s},cp:function(n){if(this.bF!==n){this.bF=n;this.bj("ShouldHighlightFromAsInvalid")}return n},dx:function(){return!!this.n&&this.n.a().R().Enabled},dY:function(n){this.g=n;this.bj("IsReadWrite");return n},bq:!1,bi:function(n){this.cm=n;this.bj("IsPeoplePickerShown");return n},bv:function(){var n=this.D.a.L;return!!n.j()&&!!n.j().Mailbox&&!_a.D.a(n.j().Mailbox.EmailAddress)},bY:!1,J:!1,bg:function(){this.bM||(this.bM=new _y.g(_nbs.a.kC,this.w));return this.bM},cj:function(){this.bx||(this.bx=new _y.g(_nbs.a.NN,this.X));return this.bx},ck:function(){this.bJ||(this.bJ=new _y.g(_nbs.a.Ja,this.K));return this.bJ},ci:function(){this.bw||(this.bw=new _y.g(_nbs.a.Pu,this.U));return this.bw},cX:function(n){if(this.bA!==n){this.bA=n;this.bj("IsCCShown")}return n},dy:function(){var n=this.D.a.L;return!n.Q()&&this.E.V()},dw:function(){return!this.D.a.L.A()},dt:function(){return this.D.a.L.A()},ds:function(){return this.ca(this.g?this.c.a.w:this.c.b.c())||this.ca(this.g?this.e.a.w:this.e.b.c())||this.ca(this.g?this.f.a.w:this.f.b.c())},cP:function(){return this.D.a.L.A()||this.D.a.cW()},M:function(n){if(!this.E.V())return n;if(this.bI!==n){if(n){this.bd();this.c.f.i(this.F.h());this.e.f.i(this.F.n());this.f.f.i(this.F.c())}this.bI=n;this.bj("ShowAggregatedHeader")}return n},ea:function(){this.c.C();this.e.C();this.f.C()},dh:function(n,t,i){if(this.i){this.i.c(this.P);this.i.a(i);this.P=i;this.i.e(t);this.i.d(n);this.bi(!0);this.D.a.bt(this.i)}else{var r=this;this.E.cL.a(function(u){r.i=u.a(n,t);r.i.a(i);r.i.b(r.N);r.P=i;r.bi(!0);r.D.a.bt(r.i)})}},df:function(){this.bZ(0);this.bZ(1)},a:function(){return this.L},di:function(n,t,i,r){var f=null;this.bB=n;this.bC=r;this.cn=t;this.bh=i;r&&(f=this.cT(this.bC));if(!this.l&&f){var u=this;this.E.cM.a(function(t){u.l=t.a();u.l.c(u.N);u.l.b(u.bB);u.l.a(u.bh);u.bt=n;f.a.v().K(u.l);u.bi(f.m=!0);f.a.v().L()})}else{f.a.v().K(this.l);this.l.d(this.bt);this.l.c(this.N);this.l.b(n);this.l.a(this.bh);this.bt=n;this.bi(f.m=!0);f.a.v().L()}},cT:function(n){var t=null;n===_u.R.NV?t=this.c:n===_u.R.QZ?t=this.e:n===_u.R.NG&&(t=this.f);return t},d:function(){var n=this.D.a.L;var t=n.B();this.dY(!t||!!t.a()||t.o()||t.b());this.z=new _mcp.h(n.bj(),this.cP());if(n.bC()&&n.bC().b()>0){this.c.N(n.bC(),this.g,_u.R.NV);n.cr(null)}else{var u,f;var e=(f=this.z.l(u={val:n}),n=u.val,f);this.c.A(e,n.bg(),this.g,_u.R.NV)}this.e.A(n.n(),n.Y(),this.g,_u.R.QZ);this.cX(!this.cP()&&(this.E.V()?!$a(n.n())&&n.n().b()>0:!0));this.z.n(this.g?this.c.a:this.c.b,this.g?this.e.a:this.e.b);_y.c.a.h()&&this.cZ(!0);this.df();var i=_g.a.a().c();if(!_js.d.a(i.bl.SharePointUrl)&&!_js.d.a(i.bl.LogonEmailAddress)){var r=new _g.bh;r.Mailbox=this.cd(i.bl.LogonEmailAddress);n.cj(r)}("Mouse"===_y.c.a.a()||n.j()||_g.a.a().a().bl.AlwaysShowFrom||!$a(n.c())&&n.c().b()>0||_g.a.a().a().bl.AlwaysShowBcc)&&this.v();this.da(n);if(this.E.V()){this.c.w(this.E.L.h());this.e.w(this.E.L.n());this.f.w(this.E.L.c())}_mcp.n.prototype.d.call(this)},H:function(){if(this.h){this.h.dispose();this.h=null}if(this.i){this.i.c(this.P);this.i.g(this.N);this.i.dispose();this.i=null;this.P=null}if(this.dv()&&this.l){this.l.f(this.N);this.l.d(this.bB);this.l.e(this.bh)}this.cV();if(this.s){this.s.j(this.bW);this.s.V();this.s=null}this.cV();this.dW();this.L.f();this.c.dispose();this.e.dispose();this.f.dispose();this.z=null;_mcp.n.prototype.H.call(this)},bd:function(){this.v();var n=this.D.a.L;this.bP();this.co(n,this.c,this.cI,_mcp.u.e);this.co(n,this.e,_mcp.u.d,_mcp.u.c);this.co(n,this.f,_mcp.u.b,_mcp.u.a)},bl:function(n,t){var r=_a.D.a(n);if(r){this.r().b("");var e=this.cd(n);var o=_pc.a.b(e);var f=this.D.a.bM.c;var i=f.a(o,4,!0,2);i.bv(this.cb);i.b(!0);i.ca=!0;this.bE(i);this.dk()}else{this.r().b(n);this.bE(null)}if(t&&_a.cC.a){var u=this.D.a.cE();u.a(1)}this.cp(!r);this.bd()},cU:function(){this.v();return this.c.g()+this.e.g()+this.f.g()},dF:function(){this.v();return this.c.g()},dE:function(){this.v();return this.e.g()},dD:function(){this.v();return this.f.g()},cW:function(n){this.M(!1);this.v();this.bP();this.dj();this.cq=n;this.dp()},dB:function(){var n=new _ff.e;this.c.a?n.h(this.c.a.h()):this.c.b&&n.h(this.c.b.h());this.e.a?n.h(this.e.a.h()):this.e.b&&n.h(this.e.b.h());this.f.a?n.h(this.f.a.h()):this.f.b&&n.h(this.f.b.h());return n.i()},y:function(){var n=new _ff.e;if(!this.F.A()){this.ba=new _fm.d(_nbs.a.Ja,null,this.K);(_g.a.a().a().bl.AlwaysShowBcc||this.E.V())&&this.ba.c(!0);n.c(this.ba);this.T=new _fm.d(_nbs.a.Pu,null,this.U);(!_g.a.a().a().bl.AlwaysShowBcc||this.E.V())&&this.T.c(!0);n.c(this.T)}if(this.F.bn()||this.F.t()){var i=this.D.b(1);this.bc=new _fm.d(_nbs.a.kC,null,this.w);(_g.a.a().a().bl.AlwaysShowFrom||this.F.z())&&this.bc.c(!0);n.c(this.bc);this.w.c(!this.F.t());this.W=new _fm.d(_nbs.a.NN,null,this.X);_g.a.a().a().bl.AlwaysShowFrom||this.F.z()||this.W.c(!0);n.c(this.W)}if(!this.F.A()&&!_y.c.a.h()){var t=new _fm.d(_nbs.a.du,null,this.Y);n.c(t)}this.q=n.i()},x:function(){var n=new _ff.e;if(!this.F.A()){this.Z=_mcp.n.a(this.K,_nbs.a.Ja);n.c(this.Z);this.Q=_mcp.n.a(this.U,_nbs.a.Pu);n.c(this.Q);this.Z.a(!_g.a.a().a().bl.AlwaysShowBcc);this.Q.a(_g.a.a().a().bl.AlwaysShowBcc)}if(this.F.bn()||this.F.t()){this.bb=_mcp.n.a(this.w,_nbs.a.kC);n.c(this.bb);this.V=_mcp.n.a(this.X,_nbs.a.NN);n.c(this.V);(_g.a.a().a().bl.AlwaysShowFrom||this.F.z())&&this.bb.a(!1);this.w.c(!this.F.t());_g.a.a().a().bl.AlwaysShowFrom||this.F.z()||this.V.a(!1)}if(!this.F.A()&&!_y.c.a.h()){var t=_mcp.n.a(this.Y,_nbs.a.du);n.c(t)}this.p=n.i()},m:function(){if(_y.c.a.a()==="Mouse"||this.cu())this.bn()?this.A():this.B();else{var n=this.D.a.L;var t=this.D.a.dp;var u=n.z()?this.cj():this.bg();var f=n.z()?this.bg():this.cj();t.M(f,u);var i=n.Q()?this.ci():this.ck();var r=n.Q()?this.ck():this.ci();t.M(r,i)}},B:function(){if(this.bc&&this.W){this.bc.c(this.F.z());this.W.c(!this.F.z())}if(this.ba&&this.T){this.ba.c(this.F.Q()||this.E.V());this.T.c(!this.F.Q()||this.E.V())}},A:function(){if(this.bb&&this.V){this.bb.a(!this.F.z());this.V.a(this.F.z())}if(this.Z&&this.Q){this.Z.a(!this.F.Q());this.Q.a(this.F.Q())}},dp:function(){this.c.c?this.c.z():this.cO(!0)},cO:function(n){n?this.e.c?this.e.z():this.cN(!0):this.bu(!1)},cN:function(n){n?this.f.c?this.f.z():this.bu(!0):this.bu(!1)},bu:function(n){if(this.cq)if(n){_js.Trace.logInfo(_a.a.a,"Force resolve completed");this.cw("ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.a.a,"Force resolve cancelled");this.cw("ResolveOperationCanceled")}},dn:function(){this.v();this.bP();this.c.y();this.e.y();this.f.y()},v:function(){if(!this.bY){this.bY=!0;var n=this.D.a.L;this.f.A(n.c(),n.K(),this.g,_u.R.NG);if(!$a(n.c())&&0<n.c().b()||!_js.d.a(n.K())||_g.a.a().a().bl.AlwaysShowBcc){n.bM(!0);_js.Trace.logInfo(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$a(n.c())?0:n.c().b(),!_js.d.a(n.K()),_g.a.a().a().bl.AlwaysShowBcc)}this.bZ(2);_js.Trace.logInfo(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.j()||!n.j().Mailbox?"<not set>":n.j().Mailbox.EmailAddress,$a(n.h())?0:n.h().b(),$a(n.n())?0:n.n().b(),$a(n.c())?0:n.c().b());this.da(n);if(n.bn()&&(n.j()||_g.a.a().a().bl.AlwaysShowFrom||this.dI()))if(this.r()){this.cl();_js.Trace.logInfo(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.j()||!n.j().Mailbox?"<not set>":n.j().Mailbox.EmailAddress,_g.a.a().a().bl.AlwaysShowFrom)}else this.bG=!0;else if(_g.a.a().a().bl.AlwaysShowFrom&&!$a(n.B())&&!n.B().b()){var t=this.D.a.M;t.b(4525);t.a(4525);this.E.N()}}},dJ:function(){this.c.B();this.e.B();this.f.B()},dC:function(){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.D.a.L;var t=new _ff.e;var u=this.g?this.c.a.w:this.c.b.c();var f=this.g?this.e.a.w:this.e.b.c();var r=this.g?this.f.a.w:this.f.b.c();if(u){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.h(u.g())}if(f){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.h(f.g())}if(r){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.h(r.g())}_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.cf();if(!n){var i=_g.a.a().c();n=new _g.d;n.Name=i.bl.UserDisplayName;n.EmailAddress=i.bl.UserEmailAddress||i.bl.LogonEmailAddress;n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.c(n);return t},dX:function(){if(this.h){_js.Trace.logInfo(_a.a.a,"User selected from persona");this.h.n(!0);this.by&&this.by()}else _js.Trace.logInfo(_a.a.a,"User tries to select from persona, but it is null")},dO:function(){this.D.a.R().a("ResolveRecipients");this.cW(!1)},dl:function(){_js.Trace.logInfo(_a.a.a,"User chose to delete from persona");this.bE(null);this.r().k(!0)},dd:function(){this.bl(this.r().a(),!0)},dP:function(n,t){this.de()},ce:function(){return new _mcp.s(this.D.a.bM,this,this.n,this.D)},dT:function(n,t){if(this.z){var i;this.z.k(t,i={val:n}),n=i.val}else n.r(t)},dM:function(n,t){this.L.f();this.cr(this.c);this.cr(this.e);this.cr(this.f)},cr:function(n){n.a?this.L.c(n.a):n.b&&this.L.c(n.b)},dg:function(){this.c.apcl("ReadWriteRecipientWellViewModel",this.o);this.e.apcl("ReadWriteRecipientWellViewModel",this.o);this.f.apcl("ReadWriteRecipientWellViewModel",this.o);this.c.apcl("ReadOnlyRecipientWellViewModel",this.o);this.e.apcl("ReadOnlyRecipientWellViewModel",this.o);this.f.apcl("ReadOnlyRecipientWellViewModel",this.o)},dW:function(){this.c.rpcl("ReadWriteRecipientWellViewModel",this.o);this.e.rpcl("ReadWriteRecipientWellViewModel",this.o);this.f.rpcl("ReadWriteRecipientWellViewModel",this.o);this.c.rpcl("ReadOnlyRecipientWellViewModel",this.o);this.e.rpcl("ReadOnlyRecipientWellViewModel",this.o);this.f.rpcl("ReadOnlyRecipientWellViewModel",this.o)},dL:function(n,t){this.M(!1);this.c.d()||this.e.d()||this.f.d()||this.D.a.M.b(65);this.c.j()&&this.e.j()&&this.f.j()||this.D.a.M.b(70);_y.c.a.h()&&this.cZ(!1);if(t&&t.c===2){var r=this.D.a.cE();r.b();if(_a.bl.a){var i=this;_js.g.a().c(_a.a.J,"TriggerPolicyTipsIfNeeded",function(){if(i.D&&i.D.a){var n=i.D.a.cX();n.a(1)}})}}},dQ:function(n,t){this.z&&this.z.m(n,t)},dj:function(){this.c.a&&this.c.a.bb();this.e.a&&this.e.a.bb();this.f.a&&this.f.a.bb()},dK:function(){this.bi(!1);this.cT(this.bC).m=!1;this.cn()},cV:function(){this.bD(0);this.bD(1);this.bD(2)},bZ:function(n){var t=this.bD(n);if(t){t.bQ(this.cS(n));t.ds(this.bV);t.t.d(this.bU);n||t.t.d(this.bX)}return t},bD:function(n){var t=null;switch(n){case 0:t=this.c.a;break;case 1:t=this.e.a;break;case 2:t=this.f.a;break}if(t){t.bY(this.cS(n));t.dB(this.bV);t.t.e(this.bU);n||t.t.e(this.bX)}return t},cS:function(n){switch(n){case 0:return this.cz;case 1:return this.cy;case 2:return this.cx;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},dN:function(){this.E.N()},dZ:function(){var t=_a.d.b(_a.a.a,"MailComposeShowBcc",!0);this.D.a.R().a("ShowBcc");_js.Trace.logInfo(_a.a.a,"User chose to show bcc");this.v();var n=this.D.a.L;if(!n.Q()){n.bM(!0);this.bj("ShowBccButton");this.E.N();this.m()}_a.d.a(t)},dG:function(){var t=_a.d.b(_a.a.a,"MailComposeHideBcc",!0);this.D.a.R().a("HideBcc");_js.Trace.logInfo(_a.a.a,"User chose to hide bcc");this.v();var n=this.D.a.L;if(n.Q()){n.bM(!1);this.bj("ShowBccButton");this.E.N();this.m()}_a.d.a(t)},da:function(n){if("Mouse"!==_y.c.a.a()){var f=this.D;var u=f.a;var r=u.dp;if(r){var i=r.a;if(i)if(n.bn()){if(!this.J)for(var t=0;t<i.length;t++)if(_nbs.a.Ja===i[t].b){r.x(this.bg(),t+1);this.J=!0}}else if(this.J){u.dp.A(this.bg());this.J=!1}}}},bP:function(){var i=this.D.a.L;var n=null;if(i.z()){var t=null;this.h?t=this.h.bA.a():this.s&&!_js.d.a(this.s.a())&&(t=this.cd(this.s.a()));n=new _g.bh;n.Mailbox=t;i.cj(n);this.bv()||this.D.a.M.b(66)}return n},dI:function(){var t=!1;if(this.t.c()){var n=_g.a.a().c();t=n.h().b()>0||!$a(n.b())&&n.b().b()>0||n.a().b()>1}return t},cd:function(n){var t=new _g.d;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},dk:function(){var t=_mcp.s.b;var n=[];(t&4)==4&&Array.add(n,new _fm.d(_u.R.VV,null,new _C(this.cv,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.d(_u.R.Te,null,new _C(this.bT,_a.a.a)));$a(this.h.bP)||(t&1)!=1||Array.addRange(n,this.h.bP);this.h.W(n)},cl:function(){var n=this.D.a.L;var i=null;var t=_g.a.a().c();i=_js.d.a(t.bl.SharePointUrl)||_js.d.a(t.bl.LogonEmailAddress)?null!==n.j()&&n.j().Mailbox?n.j().Mailbox.EmailAddress:_h.l.f(null)||t.bl.UserEmailAddress:t.bl.LogonEmailAddress;this.bl(i,!1);n.dq(!0);var u=this.bP();n.ed()&&n.ed().z(u);var r=this.E.ce();$a(r.b())&&r.d()},dm:function(){var n=this.h.bA.a().EmailAddress;this.bE(null);this.r().b(n);this.r().k(!0)},de:function(){var n=this.r().h();if($a(n)||$a(n.a())||$a(n.a().a()))_js.Trace.logWarning(_a.a.a,"User selected from but the SelectedResultItem persona is invalid");else{var t=n.a().a().EmailAddress;_js.Trace.logInfo(_a.a.a,"User selected from={0}",t);this.bl(t,!0)}},cY:function(){if(!this.r()){this.bH=!0;return}var t=_a.d.b(_a.a.a,"MailComposeShowFrom",!0);this.D.a.R().a("ShowFrom");var n=this.D.a.L;if(n.z())_js.Trace.logInfo(_a.a.a,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.a.a,"User chose to show from");this.M(!1);this.bq=!0;this.cl();this.E.N();this.m()}_a.d.a(t)},dH:function(){this.M(!1);var t=_a.d.b(_a.a.a,"MailComposeHideFrom",!0);this.D.a.R().a("HideFrom");var n=this.D.a.L;if(n.z()){n.dq(!1);this.bq=!1;this.E.N()}else _js.Trace.logInfo(_a.a.a,"Skip hide from since it is already hidden");this.m();this.D.a.M.b(750);_a.d.a(t)},co:function(n,t,i,r){var u=this.g?t.a:t.b;if(!$a(u)){i(n,u.c());if(_rw.b.isInstanceOfType(u)){var f=u;f.v()&&r(n,f.v().a())}}},cZ:function(n){var e=this.D.a.L;var i=!1;var u=e.cf();if(u){var t=this.e.a.w;if(t)for(var r=0;r<t.x.length;r++){var f=t.x[r];if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.D.a.M.b(4450);this.D.a.M.a(4450)}else n||i||this.D.a.M.b(4450)},ca:function(n){if(!n||!n.x.length)return!1;for(var t=0;t<n.x.length;t++){var i=n.x[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},ch:function(n){var t=this.c.x(n)||this.e.x(n)||this.f.x(n);t&&n.a.cF(t)},dA:function(){if(!this.bN){var n=this;this.bN=new _C(function(){n.ch(n.c)},_a.a.a)}return this.bN},dr:function(){if(!this.bs){var n=this;this.bs=new _C(function(){n.ch(n.e)},_a.a.a)}return this.bs},dq:function(){if(!this.br){var n=this;this.br=new _C(function(){n.ch(n.f)},_a.a.a)}return this.br},dz:function(){if(!this.bK){var n=this;this.bK=new _C(function(){n.cX(!0);n.E.N();n.D.a.R().a("ShowCc")},_a.a.a)}return this.bK}};_mcp.s=function(n,t,i,r){this.F=Function.createDelegate(this,this.T);this.E=Function.createDelegate(this,this.S);this.H=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.U);this.v=Function.createDelegate(this,this.W);this.t=Function.createDelegate(this,this.Q);this.p=Function.createDelegate(this,this.R);this.D=Function.createDelegate(this,this.P);_mcp.s.initializeBase(this);this.o=n;this.q=t;this.n=i;this.i=r};_mcp.s.prototype={o:null,n:null,s:null,a:null,b:null,f:null,q:null,h:null,k:null,r:null,i:null,L:function(){return!!this.n&&this.n.a().Q().Enabled&&_y.c.a.a()==="Mouse"},J:function(n){if(this.a!==n){this.a=n;this.bj("ReadWriteRecipientWellViewModel")}return n},m:!1,M:function(){this.s||(this.s=new _C(this.D,_a.a.bf));return this.s},l:0,Y:function(n){if(n!==this.b){this.b=n;this.bj("ReadOnlyRecipientWellViewModel")}return n},X:function(n){if(n!==this.f){this.f=n;this.bj("AggregatedRecipientWellViewModel")}return n},j:function(){var o=this.c&&_rw.a.g(this.a);if(this.c){var f;var n;var s="";var t="";var i="";var r="";if(this.a){for(var u=0;u<this.a.t.x.length;u++){f=this.a.t.x[u];if(f){s=f.i.d();i=i+" "+s}}for(var e=0;e<this.a.w.x.length;e++){n=this.a.w.x[e];if(n){t="";_js.d.b(n.EmailAddress)?_js.d.b(n.Name)||(t=n.Name):t=n.EmailAddress;r=r+" "+t}}}_js.Trace.logInfo(_a.a.T,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.h,o,i,r)}return o},c:!1,d:function(){return this.c&&!$a(this.a)&&this.a.I},e:function(){this.c&&this.a&&this.a.dp()},N:function(n,t,i){this.k=n;this.c=t;this.a?this.a.i(null):this.J(this.I(null));var r=this.a.v();if(r){r.b("");r.C(this.k)}else this.a.apcl("FindRecipientViewModel",this.p);this.h=i},A:function(n,t,i,r){this.c=i;this.r=t;if(this.c){this.a?this.a.i(n):this.J(this.I(n));var u=this.a.v();if(u){!_js.d.a(u.a())&&_js.d.a(t)&&u.b(t);_js.d.a(t)||u.b(t)}else this.a.apcl("FindRecipientViewModel",this.p);this.h=r}else this.b?this.b.i(n):this.Y(this.K(n))},z:function(){$a(this.a)||this.a.bU()},y:function(){this.a&&!this.m&&this.a.bh()},C:function(){if(!$a(this.a)&&this.a.v().z())if(this.a.v().bd()){this.a.cz(!0);this.a.cz(!1)}else{this.a.cB(!0);this.a.cB(!1)}},g:function(){var n;n=this.c?$a(this.a)?0:!this.a.v()||_js.d.a(this.a.v().a())?this.a.w.x.length:this.a.w.x.length+1:$a(this.b)?0:this.b.c().x.length;return n},B:function(){if(this.a){for(var f="",u="",r="",i,n,t=0,o=this.a.t.x.length;t<o;t++){i=this.a.t.x[t];if(i&&!i.k){n=this.a.w.x[t];if(n){u=_js.d.b(n.Name)?"":n.Name;f=_js.d.b(n.EmailAddress)?"":n.EmailAddress;var e=String.format("( {0} , {1} ),",u,f);r+=e}}}r!==""&&_js.Trace.logInfo(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.h,r)}},bk:function(){if(!$a(this.a)){this.a.dk(this.t);this.a.rpcl("SelectedRecipient",this.v);this.a.ci(!1);this.a.dispose();this.a=null}},I:function(n){var t=this.o.b(_mcp.s.b,_pe.c.b,n,!0,!0);t.cU(this.t);t.apcl("SelectedRecipient",this.v);return t},K:function(n){return this.o.a(_mcp.s.a,_bc.f.a,n,2)},w:function(n){this.X(this.o.a(_mcp.s.a,_bc.f.a,n,2,!1,!0,!1,n?n.b():0,0,this.n));return this.f},W:function(n,t){if(this.i){var i=n;var r=this.i.a;if(i.y!==i.Z){r.M.e([95,96]);i.Z=null}}},Q:function(n){if(this.i){var t=this.i.a;switch(n){case 1:t.M.a(95);break;case 0:t.M.a(96);break}}},R:function(n,t){var r=n;var i=r.v();if(this.k&&this.k.x.length>0){i.b("");i.C(this.k)}_js.d.b(this.r)||i.b(this.r);r.rpcl("FindRecipientViewModel",this.p)},P:function(){if(this.c&&!OwaApplication.b)if(this.L()){_js.Trace.logInfo(_a.a.a,"User chose to launch the new people picker");_a.l.a.c("VM.PeoplePicker.Launched",_a.c.a());_a.k.b(_a.a.bf,"LaunchV2PeoplePicker",!0);this.l=0;this.q.di(this.G,this.H,this.E,this.h)}else{_js.Trace.logInfo(_a.a.a,"User chose to launch rich people picker");this.a.bh();_a.l.a.c("VM.PeoplePicker.Launched",_a.c.a());_a.k.b(_a.a.bf,"PeoplePicker",!0);this.q.dh(this.a.t,this.h,this.F)}},S:function(n){this.a&&this.a.v().bp(n)},U:function(n){var t=n;if(t.a()){_a.D.a(_g.o.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.n(t):this.a.bd(t);this.l++}},V:function(){if(this.l>0){var t=_a.d.b(_a.a.bf,"CloseV2ToPicker ");var n=new _a.r;n.a("sc",this.l);t.j=n.toString();_a.d.a(t)}},T:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.t.f();var t=this;n.v(function(n){var i=n;i.k?t.a.n(i.j):t.a.bd(i.j)})},x:function(n){var u=this.a.t;var r=null;if(this!==n)for(var t=0;t<u.x.length;t++){var i=u.x[t];if(i.w){r=i;this.a.S(i);break}}return r}};_mcp.z=function(n,t,i,r,u){this.bd=Function.createDelegate(this,this.bC);this.bg=Function.createDelegate(this,this.bD);this.bi=Function.createDelegate(this,this.bt);this.bl=Function.createDelegate(this,this.bu);this.bh=Function.createDelegate(this,this.bE);this.l={};_mcp.z.initializeBase(this,[8,n,r,u]);this.Z=t;this.V=new _C(this.bh,this.G());this.T=n.a.bq;this.X=i};_mcp.z.prototype={T:null,V:null,X:null,Z:null,w:!1,M:!1,P:null,v:null,N:null,U:null,o:null,f:function(){return this.V},a:function(){return this.w},ba:function(n){if(n!==this.w){this.w=n;this.bj("IsSaving")}return n},bF:function(n){if(n!==this.U){this.U=n;this.bj("DraftSavedTime")}return n},z:!1,g:function(){return this.z},i:function(n){this.z=n;return n},r:!1,e:function(){return this.r},c:function(n,t){var i=this.D;var f=i.b(5);var u=i.a.U;var r=i.a.L;_js.Trace.logInfo(_a.a.a,"UserInitiatedSave - SaveStart:Context:{0}",r);i.a.R().a("Save");this.R();if(!r.bz()){_js.Trace.logInfo(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_js.Trace.logInfo(_a.a.a,"Skip save and show attachment in progress dialog");u.j||u.a(0,_u.R.NO,null);return}this.r=!0;this.b("Save",n,t,!1)},d:function(){this.K();_mcp.n.prototype.d.call(this)},K:function(){if(this.E.bH()&&!this.o){_js.Trace.logInfo(_a.a.a,"Setting save component override");this.o=this.E.bG().d();var n=this.D.b(27);this.o.b(this.bl,this.bi,n.c,n.b)}},J:function(){if(this.o){this.o.a();this.o=null}},b:function(n,t,i,r){if(this.o&&!this.o.c()){_js.Trace.logInfo(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var s=this.D;var o=s.a;var u=o.L;var c=o.M;var f=u.b();var a=this.D.b(5);var h=this.E.e();if(h.a()&&!r){_js.Trace.logInfo(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.T.a(f)){_js.Trace.logInfo(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.l={};return!1}var e=s.b(1);e.dn();if(_g.a.a().bl.MaxRecipientsPerMessage<e.cU()){c.a(800,null);this.E.N();return!0}this.E.L.R()&&this.E.bk().a(new _cmc.bb);e.bd();u.bU().a();this.l[n]=new _mcp.bx(t,i);if(!this.w||r){this.P=_mcp.b.b(u);this.ba(!0)}else{this.M=!this.P.t(u);return!0}if(!u.g()&&!u.i()&&!u.F()){_js.Trace.logInfo(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}_a.y.stPT(_a.a.a,"MailComposeSave",5);this.v=_y.j.b(_a.a.a,"MailComposeSave",!0);this.N=n;_js.g.a().j(_a.a.a,"MailComposeSave");_js.Trace.logInfo(_a.a.a,"Started new task runner context before starting save.");try{this.o?this.o.d(n):this.bu(n);return!0}catch(l){this.bt(l);throw l;}},H:function(){this.w=!1;this.M=!1;this.r=!1;this.z=!1;this.l={};this.P=null;this.J();_mcp.n.prototype.H.call(this)},h:function(){this.w=!1;this.M=!1;_js.Trace.logInfo(_a.a.a,"ResumeSave:Context:{0}",this.D.a.L);var i=this.l;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.b(n.key,t.a,t.b,!0);break}},bf:function(n){return _y.t.c(n.t,40,50,60,700,88,89,43,57)},bm:function(n){if("ReadingPaneExit"in this.l||"Popout"in this.l){var u=this.D.a;var t=u.M;var r=this.bf(n);var e=new _y.cM;var i=e.a(r,null);t.e(_mcp.k.b);"ReadingPaneExit"in this.l?t.a(87,i):t.a(85,i);if(r===50){var f=this;u.bK.a(function(n){n.a(t);f.E.N()})}else this.E.N()}else"Save"in this.l&&_mcp.bc.prototype.bm.call(this,n)},y:function(){if(this.F.a()!==8&&!this.F.A()&&!_y.c.a.h()){var n=new _fm.d(_nbs.a.Dm,null,this.E.c().f());this.q=[n]}},x:function(){if(this.F.a()!==8&&!this.F.A()&&!_y.c.a.h()){var n=_mcp.n.a(this.V,_nbs.a.Dm);this.p=[n]}},bu:function(n){_js.Trace.logInfo(_a.a.Y,"Setup save action, context:{0}; OriParentFolderId={1}",this.F,this.F.d()&&this.F.d().bl.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.F.d().bl.ParentFolderId):"null");var t=this.E.bu.d(this.E,0,this.X);if((_h.l.isInstanceOfType(t)||_h.n.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.F.A()){var i=t;i.S=new _g.R(new _g.C("internalsubmission"))}this.E.W.a(t,this.bg,this.bd,null);_js.Trace.logInfo(_a.a.a,"Save action submitted")},bE:function(){this.D.a.R().a("Save");this.c(null,null)},bt:function(n){this.ba(!1);this.r=!1;var t=n.toString();_y.j.a(this.v,null,t,null,this.Y(this.N,n.message));this.v=null;_a.y.endPT("MailComposeSave");_js.Trace.logWarning(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},bs:function(n){var s=this.D;var u=s.a;var f=u.L;var t=n.I;var r=!1;if(this.T.a(t)){f.b()===t&&(this.l={});this.L(n);var e=_mcp.S.a(n);if(e){_js.Trace.logInfo(_a.a.a,"Resume discard for context {0}",t);u.bg().b(t,e)}r=!0}else if(t===f.b()){if(this.z){this.z=!1;_js.Trace.logInfo(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.l={};this.L(n);var i=null;_h.p.isInstanceOfType(n)?i=n.d:_h.n.isInstanceOfType(n)&&(i=n.k);i&&f.D(i);var o=this.E.e();o.c();r=!0}else if(this.M){_js.Trace.logInfo(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.h();r=!0}}else _js.Trace.logInfo(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,u.L.b());return r},bD:function(n){var e=this.D;var r=e.a;var u=r.L;var h=r.bg();var f=n.I;_js.Trace.logInfo(_a.a.a,"Save action returned success, ContextId={0}; Context:{1}",f,u);if(!this.bs(n)&&f===u.b()){this.bB(n);this.br();var i=!1;var t=null;if("Attach"in this.l){if("AutoSave"in this.l){t=this.l.AutoSave;t&&t.a(n)}t=this.l.Attach}else if("Popout"in this.l){t=this.l.Popout;var o=r.b();if(o&&o.k()&&"ReadingPaneExit"in this.l){t&&t.a(n);t=this.l.ReadingPaneExit}}else if("ReadingPaneExit"in this.l)t=this.l.ReadingPaneExit;else if("AutoSave"in this.l){t=this.l.AutoSave;i=!0}else if("Save"in this.l){t=this.l.Save;i=!0}else"Diagnostics"in this.l&&(i=!0);t&&t.a&&t.a(n);if(i){var s=e.b(5);s.w()}this.l={}}_y.j.a(this.v,null,"",this.bq(n),this.Y(this.N,""));this.v=null},br:function(){var i="";var t=this.l;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_js.Trace.logInfo(_a.a.a,"ProcessorKeys:{0}",i)},bC:function(n){var o=this.D.a.L;var e=n.I;_js.Trace.logInfo(_a.a.a,"Save action returned a failure, ContextId={0}; Context:{1}",e,o);if(!this.bs(n)&&e===o.b()){this.br();var t=!1;var h=this.l;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.b){u.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.bp(n);t=!0}}else if(!t){this.bp(n);t=!0}}t||this.L(n);this.l={}}var r="SaveFailure_UnknownError";var f="";if(_g.X.a(n.t)){r=_g.X.b(n.t)||"SaveFailure_UnknownError";f=n.t.FaultMessage}_y.j.a(this.v,null,r,this.bq(n),this.Y(this.N,f));this.v=null},bB:function(n){var f=this.D;var t=f.a;var i=t.L;var e=n.I;var h=this.r;if(e===i.b()){this.bG(n);i.ck(!1);t.dg()}this.cw("MailSaveSucceeded");if(e===i.b()){var s=_a.c.a();var r=s.a(0);this.bF(String.format(_nbs.a.ZX,r));if(h&&!t.V()){var u=t.M;u.e(_mcp.z.a);u.a(1001,r);this.E.N()}}if(_a.bl.a){var o=f.b(23);o.a(this.r?4:2)}this.L(n)},bp:function(n){_js.Trace.logInfo(_a.a.a,"SaveActionFailed: Error: {0}",n.t.message);n.I===this.D.a.L.b()&&this.bm(n);var t=this.D.a;t.bh&&t.D(!1);this.L(n)},L:function(n){var i=this.D;var t=i.a.L;if(n.I===t.b()){this.ba(!1);this.r=!1}_a.y.endPT("MailComposeSave")},bq:function(n){var t=null;_h.p.isInstanceOfType(n)&&n.C?t=n.C.correlationId:_h.n.isInstanceOfType(n)&&n.C&&(t=n.C.correlationId);return t},Y:function(n,t){var i=new _a.r;i.b("Ctx",n||"");i.b("Err",t||"");return i.toString()},bG:function(n){var t=this.D.a.L;t.eA(this.P);if(this.r){t.eY(!0);this.r=!1;_js.Trace.logInfo(_a.a.a,"Explicit save recorded. ContextId={0}",t.b())}if(_h.l.isInstanceOfType(n)){var u=n;var r=u.d;u.c.bL(r);t.D(r);t.dd(u.c);_js.Trace.logInfo(_a.a.a,"Updated context from create action. Context:{0}",t.toString());this.Z.y(r)}else if(_h.n.isInstanceOfType(n)){var i=n;var s=i.k;i.a.bL(s);t.D(s);t.dd(i.a);_js.Trace.logInfo(_a.a.a,"Updated context from update action. Context:{0}",t)}else if(_h.N.isInstanceOfType(n)){var y=n;var v=y.d;t.D(v);_js.Trace.logInfo(_a.a.a,"Updated context from create response action. Context:{0}",t)}else if(_mcp.B.isInstanceOfType(n)){var p=n;var b=p.a.d;t.D(b);_js.Trace.logInfo(_a.a.a,"Updated context from create response from modern group action. Context:{0}",t)}else if(_cc.bA.isInstanceOfType(n)){var e=n;var w=e.meetingResponseMessageId;t.D(w);t.dd(e.c);_js.Trace.logInfo(_a.a.a,"Updated context from create meeting response message. Context:{0}",t)}else if(_c.v.isInstanceOfType(n)){var a=n;var c=a.d;t.D(c);_js.Trace.logInfo(_a.a.a,"Updated context from create approval response action. Context:{0}",t)}if(_h.p.isInstanceOfType(n)&&t.Z()){var l=n;var f=l.bx;var o=t.Z().dO();if(f&&o){var h=0;var k=this;o.v(function(n){var t=n;t.g(f[h]);h++});_js.Trace.logInfo(_a.a.a,"Attachment IDs have been updated.")}}}};_mcp.o=function(n,t){this.f=Function.createDelegate(this,this.m);_mcp.o.initializeBase(this,[18,n]);this.e=t.c()};_mcp.o.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.o.prototype={e:!1,b:function(){return this.dS(_mcp.o.b)},h:function(n){this.dR(_mcp.o.b,n);return n},d:function(){if($a(this.b())){var n=this.l(_fm.d,_mcp.o.c);if(n){this.h(new _fm.f(n));this.b().bK(new _C(this.f,this.G()))}}_mcp.bc.prototype.d.call(this)},H:function(){this.b()&&this.h(null);_mcp.bc.prototype.H.call(this)},a:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bl.UserEmailAddress&&!_h.l.e(n)){var t=_g.a.a().a().bL();if(!$a(t)){if(t.j(r))return;t.b()===1&&t.a(0)===""&&t.m(0)}var i=new(_a.gd.$$(String));i.e(r);i.B(t);i.b()>_mcp.o.a&&i.m(i.b()-1);_g.a.a().a().cR(i);_h.g.a(_g.a.a().a().v,OwaApplication.a);this.j(r)}}},j:function(n){if(!this.e&&this.b()){for(var r=_mcp.o.c(n,new _C(this.c(n),this.G())),t=this.b().h,i=t.x.length-1;i>0;i--)if(_fm.j.isInstanceOfType(t.x[i])){t.r(i+1,r);var u=t.x.length-i-1;u>_mcp.o.a&&t.n(t.x.length-1);return}t.a(new _fm.j);t.a(r)}},m:function(){if(this.b()&&this.b().l){var f=this.b().l;var r=_g.a.a().a().bL();var e=r.q(f.j);if(e){for(var n=this.b().h,t=n.x.length-1;t>0;t--)if(n.x[t].j===f.j){n.n(t);var u=n.x.length;_fm.j.isInstanceOfType(n.x[u-1])&&n.n(u-1);break}var i=new(_a.gd.$$(String));r.b()>0?i.B(r):i.e("");_g.a.a().a().cR(i);_h.g.a(_g.a.a().a().v,OwaApplication.a)}}},l:function(n,t){var i=new _ff.e;var r=_g.a.a().c().bl.UserEmailAddress;i.c(t(r,new _C(this.c(r),this.G())));if(this.e){var e;this.i(e={val:i},t,r),i=e.val;var o;this.g(o={val:i},t),i=o.val}else{var u;this.g(u={val:i},t),i=u.val;var f;this.k(f={val:i},t),i=f.val}return i.i()},g:function(n,t){for(var u,r=_g.a.a().c().h(),f=$a(r)?0:r.b(),i=0;i<f;i++){u=r.a(i).EmailAddress;n.val.c(t(u,new _C(this.c(u),this.G())))}},i:function(n,t,i){for(var u,r,s=_g.a.a().c().a(),c=$a(s)?0:s.b(),o=_g.a.a().c().b(),h=$a(o)?0:o.b(),f=0;f<c;f++){u=s.a(f);i!==u&&n.val.c(t(u,new _C(this.c(u),this.G())))}for(var e=0;e<h;e++){r=o.a(e);i!==r&&n.val.c(t(r,new _C(this.c(r),this.G())))}},k:function(n,t){var i=_g.a.a().a().bL();var r=$a(i)?0:i.b();if(r===1&&i.a(0)===""){i.m(0);r=0}if(r>0){var f;n.val.c(new _fm.j);for(var u=0;u<r;u++){f=i.a(u);n.val.c(t(f,new _C(this.c(f),this.G())))}}},c:function(n){var t=this;return function(){_js.Trace.logInfo(_a.a.a,"User chose from={0}",n);t.D.a.Q().bl(n,!0)}}};_mcp.A=function(n,t,i,r){this.ba=Function.createDelegate(this,this.bE);this.bd=Function.createDelegate(this,this.bN);this.bi=Function.createDelegate(this,this.bU);this.bc=Function.createDelegate(this,this.bM);this.s=Function.createDelegate(this,this.bK);this.B=Function.createDelegate(this,this.bI);this.Y=Function.createDelegate(this,this.bu);this.Z=Function.createDelegate(this,this.bv);this.bl=Function.createDelegate(this,this.bW);this.bn=Function.createDelegate(this,this.bX);this.z=Function.createDelegate(this,this.bp);this.bb=Function.createDelegate(this,this.T);this.bg=Function.createDelegate(this,this.bP);this.bh=Function.createDelegate(this,this.bT);_mcp.A.initializeBase(this,[7,n]);this.q=new _C(this.bh,this.G());this.L=new _C(this.bg,this.G());this.M=n.a.bq;this.P=t;this.v=i;this.m=r};_mcp.A.prototype={M:null,L:null,P:null,v:null,m:null,W:null,V:null,y:!1,w:null,o:null,r:null,n:null,A:!1,U:!1,l:null,x:null,g:function(){return this.l?this.l.c():null},q:null,b:function(){return this.q},j:function(n){this.q=n;return n},t:!1,h:function(){return this.t},a:function(){return this.y},p:function(n){if(n!==this.y){this.y=n;this.bj("IsSending");var t=this.D.a;t.df(_u.P.M);t.de(n)}return n},i:function(){return this.Q()&&this.U},Q:function(){return this.v.a().bi().Enabled&&this.E.X.a()==="Mouse"&&!this.E.bF()&&!this.F.t()&&!!this.E.by&&!!this.E.bC&&this.F.l()!==3},e:function(){return this.r},K:function(){if(this.E.bH()&&!this.l){_js.Trace.logInfo(_a.a.a,"Setting send component override");this.l=this.E.bG().e();var t=this.D.b(27);var n=this.D.b(1);this.l.d(this.E.s(),this.bb,this.z,this.bn,this.bl,this.Z,this.Y,this.E.W,this.D.a.bM,n.cE,n.cD,n.cB,n.cA,t.c,t.e,t.b);this.bj("InvalidRecipientsDialogViewModel")}},J:function(){if(this.l){this.l.a();this.l=null;this.bj("InvalidRecipientsDialogViewModel")}},d:function(){this.K();var n=this.D.b(1);if(n){n.dV(this.B);n.dU(this.z);n.dc(this.B);n.db(this.z)}_mcp.bc.prototype.d.call(this)},H:function(){this.p(!1);this.J();_mcp.bc.prototype.H.call(this)},c:function(){_js.Trace.logInfo(_a.a.a,"ResumeSend() called by external mail-compose component.");this.T()},T:function(){var u=this.D;var i=u.a;var n=i.L;var r=i.c();u.b(23).e();if(r.a()){r.i(!0);_js.Trace.logInfo(_a.a.a,"Send deferred due to in progress save.")}if(n.g()||n.i()||n.F()){if(!r.g()){var o=this.D.b(1);o.bd();_js.Trace.logInfo(_a.a.a,"Send without pending saves, context:{0}; OriParentFolderId={1}",n,n.d()&&n.d().bl.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.d().bl.ParentFolderId):"null");var t=i.bu.d(i,1,this.P);_js.Trace.logInfo(_a.a.a,"Submitting send action");var f=_g.j.a;_bc.k.isInstanceOfType(f)?_h.n.isInstanceOfType(t)?t.bD(this.s):_h.l.isInstanceOfType(t)&&t.Y(this.s):this.bw();i.W.a(t,this.bv(),this.bu(),this.bc);_js.Trace.logInfo(_a.a.a,"Send action submitted")}}else{var e=n.b();_js.Trace.logInfo(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",e)}},bp:function(){var i=this.D.a.M;var t=this.D.a.Q();var n=null;this.p(!1);if(t.c.d()||t.e.d()||t.f.d()){i.a(65,null);n=_js.l.b(_bc.InfoBarMessageId,65);this.m.a(_a.bE,new _a.bE(_u.R.aM))}if(t.bv()){i.a(66,null);n=_js.l.b(_bc.InfoBarMessageId,66)}this.E.N();this.f();n=n||"CancelSend_UnknownError";this.k(n,null,null)},f:function(){var n=this;_js.g.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.t=!1},2e3)},bf:function(n){var t;var i=_a.b.l(n.t);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.bZ(n.t,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:_y.t.c(n.t,45,55,62,700,88,89,46,58))}return t},bv:function(){return this.W||this.bi},bu:function(){return this.V||this.bd},bX:function(n){this.W=n},bW:function(n){this.V=n},bZ:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.R.b(i)==="Value"&&_a.R.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.R.a(i))){t.val=48;return!0}}t.val=-1;return!1},bT:function(){if(this.l&&!this.l.e()){_js.Trace.logInfo(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.y.stPT(_a.a.a,"MailComposeSend",5);this.A=!0;this.o=_y.j.b(_a.a.a,"MailComposeSend",!0);if(this.Q()){this.r=_y.j.b(_a.a.a,"MailComposeSendAsync",!0);if(_mcp.g.isInstanceOfType(this.E)){var n=this.E;_g.r.isInstanceOfType(this.F.d())&&n.bj&&(this.n=_y.j.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0))}}_js.Trace.logInfo(_a.a.a,"SendStart:Context:{0}",this.F);this.R();this.F.E()?this.bJ():this.by();this.E.R().a("Send")},bJ:function(){var n=this;var t=function(t){n.k(_js.l.b(_bc.InfoBarMessageId,t),null,null);n.F.fB(null);n.bp();t!==-1&&n.cs(_u.R.Ke,t)};if(this.F.eT())this.bA(t);else{var i=this;this.E.dA().l(13,function(n){if(i.F.fB(n))i.bA(t);else{t(-1);_js.Trace.logWarning(_a.a.g,"The send is canceled due to unavailable cert.")}})}},bA:function(n){this.bY();var t=new _h.cl(200,this.F.eT(),!0);var i=this,r=this;this.D.a.W.a(t,function(){_js.Trace.logInfo(_a.a.g,"Retrieving certs info completed.");if(t.A.IsValid){i.N(null);i.by()}else{_js.Trace.logWarning(_a.a.g,"Retrieving certs info determined the certificate is INVALID.");var r=t.A.ChainValidityStatus;i.N(r.toString());switch(r){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){_js.Trace.logWarning(_a.a.g,"Retrieving certs info failed. "+t.t.message);r.N(t.D());n(743)},null)},by:function(){_js.Trace.logInfo(_a.a.a,"User chose to send, start force resolve recipients");this.t=!0;var n=this.D.b(1);n.cW(!0)},bI:function(){if(this.y){_js.Trace.logInfo(_a.a.a,"Skip send since another send is in progress");return}this.p(!0);this.t=!1;_js.g.a().j(_a.a.a,"MailComposeSend");_js.Trace.logInfo(_a.a.a,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.bH(i={val:n}),n=i.val,t)?n?_js.Trace.logInfo(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.X():this.p(!1);r=!1}finally{if(r){this.p(!1);_js.Trace.logWarning(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.k("SendFailure_UnhandledException",null,null)}}},X:function(){this.F.fw(!1);if(this.E.L.R()){this.F.ci(new _cmc.R);this.F.gh(this.F.cC().b)}if(this.l)this.l.b();else{this.T();var n=!1;if(this.Q()&&!this.F.eH()){if(this.E.bC.b()){var i=this;this.E.bC.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.E.by.b()){var r=this;this.E.by.a(function(t){t.a()>0&&(n=!0)})}if(!n){_js.Trace.logInfo(_a.a.a,"Navigating away after submitting action for send via notification");this.F.fw(!0);this.U=!0;this.bx();this.bw();var t=this;this.E.by.a(function(){t.m.a(ISendEvent,new _mcp.bz(t.E))})}}}},bw:function(){if(_mcp.g.isInstanceOfType(this.E)&&_g.r.isInstanceOfType(this.F.d())&&this.F.bX()){var n=this.E;if(n.bj&&n.bz){var u=this.F.d();var r=_cmc.k.b(n.bj.bl,n.bz,this.F.j()||this.F.bo(),this.F.bo(),"sentitems");var f="MC:"+r.InternetMessageId;this.m.a(_a.bV,new _a.bV(f,this.F));_h.d.z(r,u.bl.InternetMessageId,n.bS?u:null);var i="OMC:"+n.bj.bl.ConversationId.Id;var t=n.cl.c[i];if(t)t.d.c(n.bz.bl.InternetMessageId);else{t=new _cmc.S(n.bz.bl.InternetMessageId);this.m.a(_a.bV,new _a.bV(i,t))}if(this.n){_y.j.a(this.n);this.n=null}}}},bH:function(n){n.val=!1;var f=this.D;var r=f.a;var t=f.b(1);var o=f.a.S();var u=r.M;var h=f.b(23);if(this.M.a(r.L.b())){_js.Trace.logInfo(_a.a.a,"User had already discarded, skipping send.");this.k("InvalidToSend",null,"User has already discarded, skipping send");return!1}else if(t.bv()){_js.Trace.logInfo(_a.a.a,"Not valid to send since sender's address is invalid");u.a(66,null);this.E.N();this.k("InvalidToSend",null,"Sender's address is invalid, not valid to send");return!1}else if(!r.L.A()&&t.c.j()&&t.e.j()&&t.f.j()){_js.Trace.logInfo(_a.a.a,"Not valid to send since no recipients were specified");u.a(70,null);this.E.N();this.k("InvalidToSend",null,"No recipients were specified, not valid to send");return!1}else if(t.c.d()||t.e.d()||t.f.d()){_js.Trace.logInfo(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.bv(),t.c.d(),t.e.d(),t.f.d());t.dJ();u.a(65,null);this.E.N();this.k("InvalidToSend",null,"Invalid recipients are present, not valid to send");return!1}else if(o.b()){_js.Trace.logInfo(_a.a.a,"Not valid to send since attachment is in progress");var c=r.U;c.a(0,_u.R.NO,null,!1,null,null,null,c.v);this.k("InvalidToSend",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bl.MaxRecipientsPerMessage<t.cU()){u.a(800,null);this.E.N();this.k("InvalidToSend",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.bl.a&&h.c()){_js.Trace.logInfo(_a.a.a,"Not valid to send since policy violation detected");var l=r.U;l.a(0,h.b(),null,!1,null,null,null,l.v);this.k("InvalidToSend",null,"PolicyTip violation detected, not valid to send");return!1}else if(_js.d.a(this.E.L.w())){n.val=!0;var s=r.U;s.b(2,[_nbs.a.Qk],this.ba,!1,_nbs.a.Rh,_nbs.a.Hg,_nbs.a.Jc,s.v,null);return!1}else if(o&&o.a()&&this.E.cb)if(this.w)return this.bq();else{n.val=!0;var i=this;this.E.cb.a(function(n){i.w=n.a(i.E.U,i.q);i.bq()?i.X():i.p(!1)})}else if(this.F.t())if(this.F.z()){_a.M.a(_u.R.Hk,0);this.k("InvalidToSend",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.ds()){_a.M.a(_u.R.Pz,0);this.k("InvalidToSend",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.F.x()){var e=new _ff.e;var a=this;this.F.x().v(function(n){_g.l.isInstanceOfType(n)||_g.x.isInstanceOfType(n)||_g.A.isInstanceOfType(n)||e.c(n.bl.Name)});if(e.d.length>0){_a.M.a(String.format(_u.R.ad,e.d.join(", ")),0);this.k("InvalidToSend",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},bq:function(){var n=this.E.S();try{if(this.w.a(this.E.L,n.a().b())){this.k("InvalidToSend",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_js.Trace.logException(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.w,this.E.L,n.a().b())}return!0},bU:function(n){var s=this.D;var i=s.a;var t=i.L;var r=n.I;_js.Trace.logInfo(_a.a.a,"Send action succeeded, ContextId={0}; Context:{1}",r,t);this.bV();var u=!1;var h=_g.j.a;_bc.k.isInstanceOfType(h)&&(u=!0);t.bn()&&!u&&this.E.ce().a(t.j());if(t.ej&&t.ej.length>0){var c=this.D.a.M;c.a(742,t.ej);_js.Trace.logInfo(_a.a.a,"Showing infobar message for Bcc forking failed");this.p(!1);i.W.d(n);this.k(_js.l.b(_bc.InfoBarMessageId,742),null,null)}else{if(r===t.b()){t.eA(null);if(this.F.bX()){_js.Trace.logInfo(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.E.by.a(function(){f.m.a(ISendSucceededEvent,new _mcp.bB(i))});this.F.fq()}else{_js.Trace.logInfo(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",r);this.bx()}}else _js.Trace.logInfo(_a.a.a,"Context does not match, skipping navigating away from compose.");this.cw("MailSendSucceeded");var e=!i.S()||!i.S().a()?null:i.S().a().bu();var o=this.bt(t,null,e);this.bC(o)}this.m.a(_a.bE,new _a.bE(_nbs.a.CR))},bx:function(){this.E.b().b(this.E,!0)},bN:function(n){var r=this.D.a;var t=r.L;var f=n.I;_js.Trace.logInfo(_a.a.a,"Send action failed, ContextId={0}; Context:{1}",f,t);var i="SendFailure_UnknownError";var u="";if(_g.X.a(n.t)){i=_g.X.b(n.t);u=n.t.FaultMessage}if(f===t.b()){if(t.ej&&t.ej.length>0){var o=this.D.a.M;o.a(65,t.ej)}this.p(!1);_js.Trace.logInfo(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",i);this.bm(n);if(this.F.bX()){_js.Trace.logInfo(_a.a.a,"Raise send failed event for send via notification");t.ge(this.bf(n));var e=this;this.E.bC.a(function(){e.m.a(ISendFailedEvent,new _mcp.bA(r))});t.fq()}}else _js.Trace.logInfo(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",i);this.k(i,this.bD(n),u);r.W.d(n)},bM:function(n){this.bs();this.bG()?this.m.a(_y.db,new _y.db(32)):this.bF()&&this.m.a(_y.db,new _y.db(64))},bG:function(){return this.v.a().ce().Enabled||_a.A.e(window.location.href,"survey")==="1"?!0:!1},bF:function(){return this.v.a().cd().Enabled||_a.A.e(window.location.href,"survey")==="2"?!0:!1},bD:function(n){var t=null;_h.p.isInstanceOfType(n)&&n.C?t=n.C.correlationId:_h.n.isInstanceOfType(n)&&n.C&&(t=n.C.correlationId);return t},bP:function(){this.D.a.cU()&&this.q.b&&this.q.a()},bV:function(){var t=this.E.Q();var n=this.E.S();_js.Trace.logInfo(_a.a.a,"Check to see if we have attachments to set permissions for");n.a()&&n.a().z()&&n.a().bc(t.dB())},bt:function(n,t,i){var r;if(n){var e=n.f()==="HTML"?"html":"text";var f;f=n.a()===1||n.a()===2||n.a()===3?n.g()?"yes":"no":"na";var u=new _a.r;u.b("BT",e);u.b("U",f);n.er!==-1&&u.a("S",n.er);u.a("O",n.a());_js.d.a(t)||u.b("E",t);r=u.toString()}else r=null;r?i&&(r=r+"|"+i):r=i;return r},k:function(n,t,i){var r=this.bt(this.F,i,null);if(this.o){_y.j.a(this.o,null,n,t,r);this.o=null}if(this.r){_y.j.a(this.r,null,n,t,r);this.r=null}this.br(n,t,r);this.bs()},bC:function(n){if(this.o){_y.j.a(this.o,null,null,null,n);this.o=null}this.br(null,null,n)},bs:function(){if(this.A){_a.y.endPT("MailComposeSend");this.A=!1}},br:function(n,t,i){if(this.n){if(this.F.bX()){_js.Trace.logError(this.G(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.j.a(this.n,null,n,t,i);this.n=null}},bE:function(n,t){n?this.X():this.k("MissingSubject_NotSent",null,'No subject was specified, and user chose "Don\'t Send"')},bK:function(n){var i=this.D;var r=i.a;var t=r.L;_h.l.isInstanceOfType(n)&&n.l(this.s);_h.n.isInstanceOfType(n)&&n.bC(this.s);t.bn()&&this.E.ce().a(t.j())},bY:function(){this.x=_a.d.b(_a.a.g,"SMIMEGetCertsInfo");this.x.j=this.bB()},N:function(n){this.x.k=n;_a.d.a(this.x)},bB:function(){var n=new _a.r;n.b("S","S");return n.toString()}};_mcp.bs=function(n){this.e=Function.createDelegate(this,this.i);this.c=Function.createDelegate(this,this.k);this.b=Function.createDelegate(this,this.h);_mcp.bs.initializeBase(this,[27,n])};_mcp.bs.prototype={a:null,i:function(n,t){this.cs(n,t)},h:function(n){this.be(n)},l:function(n,t){var e=this;var f=function(i){_js.Trace.logWarning(_a.a.g,i.message);if(_a.K.b(i)){_a.K.c(i,n);e.be(i);t(null)}else{_a.j.j(i,"An error occurred when choosing cert.");throw i;}};try{var i=_a.j.r(!0,!0,!1,!1,!1);if(i)if(_a.K.d(i))this.be(i);else throw i;_js.Trace.logInfo(_a.a.g,"S/MIME choosing a cert...");var r;var u=_g.a.a();r=u.bl.SmimeAdminSettings.AllowUserChoiceOfSigningCertificate&&u.a().bl.ManuallyPickCertificate?u.a().bl.SigningCertificateId:null;_js.Trace.logInfo(_a.a.g,"Choosing a cert. KeyIdentifier={0}",r);var s=this;_a.j.b.f(r,function(n){var i=JsonParser.deserialize(n);i.ErrorCode?f(_a.K.a("No certificate was found.",i.ErrorCode)):t(i.Data)})}catch(o){f(o)}},k:function(n,t,i,r){_js.Trace.logInfo(_a.a.g,"Building S/MIME data package...");var u=this.p();this.r(u,t);try{var o=this.m();var e=this.o(t);var f=this;_a.j.b.i(u,o,e,this.F.eT(),function(t){f.n(t,n,i,r)})}catch(s){this.g(s,r)}},r:function(n,t){var r=_g.a.a().bl.SmimeAdminSettings;var i=_g.a.a().a();var l=this.F.a();var c=this.F.l();var h=r.AlwaysSign;var o=r.AlwaysEncrypt;var u=i.bl.SmimeSign;var f=i.bl.SmimeEncrypt;var e=r.ClearSign;var s=r.TripleWrapSignedEncryptedMail;_js.Trace.logInfo(_a.a.g,"Admin.AlwaysEncrypt="+o);_js.Trace.logInfo(_a.a.g,"Admin.AlwaysSign="+h);_js.Trace.logInfo(_a.a.g,"Admin.IsClearSign="+e);_js.Trace.logInfo(_a.a.g,"Admin.TripleWrap="+s);_js.Trace.logInfo(_a.a.g,"User.AlwaysEncrypt="+f);_js.Trace.logInfo(_a.a.g,"User.AlwaysSign="+u);_js.Trace.logInfo(_a.a.g,"User.SigningCert="+i.bl.SigningCertificateSubject);_js.Trace.logInfo(_a.a.g,"User.SigningCertId="+i.bl.SigningCertificateId);_js.Trace.logInfo(_a.a.g,"Context.Encrypt="+this.F.q());_js.Trace.logInfo(_a.a.g,"Context.Sign="+this.F.E());this.a=_a.d.b(_a.a.g,"SMIMECreateSmimeFromMessage");this.a.j=this.j(n,t,l,c,h,o,u,f,e,s)},p:function(){var n;var t=_g.a.a().bl.SmimeAdminSettings;if(!this.F.E()&&this.F.q())n=6;else if(this.F.E()&&!this.F.q())n=t.ClearSign?11:10;else if(this.F.E()&&this.F.q())n=t.TripleWrapSignedEncryptedMail?14:12;else throw Error.invalidOperation("The context is not in S/MIME mode.");return n},o:function(n){var i;if(n===2&&this.F.q()){var t=this.E.Q();var e=t.g?t.c.a.w:t.c.b.c();var u=t.g?t.e.a.w:t.e.b.c();var f=t.g?t.f.a.w:t.f.b.c();var o=e?e.x.length:0;var h=u?u.x.length:0;var s=f?f.x.length:0;var r=o+h;switch(this.F.em){case 0:i=this.F.cN();break;case 1:i=this.F.ez(0,r);break;case 2:i=this.F.ez(r+this.F.ex,1);break;case 3:i=this.F.ez(r,s);break;default:i=null;break}}else i=null;return i?JsonParser.serialize(i):null},m:function(){var n=new _g.r;n.cl(this.F.fl());n.z().a()==="HTML"&&n.z().b(_a.G.f(n.z().bl.Value,!0));this.q(n,this.E.S().a().b());n.cF(new _g.bh);n.bl.From.Mailbox=this.F.cf();if(!n.bl.From.Mailbox){var t=_g.a.a().c();n.bl.From.Mailbox=new _g.d;n.bl.From.Mailbox.Name=t.bl.UserDisplayName;n.bl.From.Mailbox.EmailAddress=t.bl.UserEmailAddress||t.bl.LogonEmailAddress;n.bl.From.Mailbox.MailboxType="Mailbox";n.bl.From.Mailbox.RoutingType="SMTP"}n.ce(new(_a.gd.$$(_g.d)));this.F.h()&&n.k().h(this.F.h().g());n.ct(new(_a.gd.$$(_g.d)));this.F.n()&&n.m().h(this.F.n().g());n.bR(this.F.w());n.dr(this.F.ba());n.cN(this.F.C());n.id(_a.c.a());n.cP(this.F.bc());n.cO(this.F.bb());if(n.fb(this.F.bw())){n.fL(this.F.fo());n.eY(this.F.eN());n.eW(this.F.cz());n.eX(this.F.cA())}return JsonParser.serialize(n.bl)},q:function(n,t){if(t&&t.x.length){var i=new(_a.ge.$$(_g.Attachment,_g.bO));var f=new _ff.e;var s=this;t.v(function(t){var o=t;var r=o.a();if(r.q()){_js.Trace.logInfo(_a.a.g,"Skipping SmimeDataPackage.");return}if(!(_g.l.isInstanceOfType(r)||_g.x.isInstanceOfType(r)||_g.A.isInstanceOfType(r))){_js.Trace.logWarning(_a.a.g,"S/MIME only supports FileAttachment, ItemAttachment, and ItemIdAttachment. The attachment {0} is ignored.",r.bl.Name);return}if(n.z().a()==="HTML"&&r.b()&&n.z().bl.Value.indexOf(r.bl.ContentId)<0){_js.Trace.logInfo(_a.a.g,"Removing unreferenced inline attachment: {0}",r.bl.ContentId);f.c(o);return}if(_g.A.isInstanceOfType(r)){var e=r;var u=new _g.x;u.e(e.bl.Name);u.j(e.bl.ContentType||"message/rfc822");u.h(e.a());u.p(e.bl.MimeContent);i.e(u)}else i.e(r)});for(var u=f.d,e=u.length,r=0;r<e;++r){var o=u[r];this.E.S().a().k(o,!1)}n.ba(i.b()>0?i:null)}},n:function(n,t,i,r){var u=JsonParser.deserialize(n);if(u.ErrorCode){var f=_a.K.c(_a.K.a("Cannot encode the message.",u.ErrorCode),15);this.g(f,r)}else{_js.Trace.logInfo(_a.a.g,"S/MIME data package built successfully.");this.f(null);this.F.gf(u.Data);i(t)}},g:function(n,t){_js.Trace.logWarning(_a.a.g,n.message);this.f(n.message);if(_a.K.b(n))this.be(n);else{_a.j.j(n,"Unknown error occurred when building data package.");n=_a.K.c(_a.K.a(n.message,11),15);this.be(n)}t(n)},f:function(n){this.a.k=n;_a.d.a(this.a)},j:function(n,t,i,r,u,f,e,o,s,h){var c=new _a.r;c.a("ST",n);c.b("SC",_a.gG.toString(t));c.b("O",_y.M.toString(i));c.b("M",_y.dy.toString(r));c.c("AS",u);c.c("AE",f);c.c("UAS",e);c.c("UAE",o);c.c("CS",s);c.c("TW",h);return c.toString()}};_mcp.br=function(n,t){_mcp.br.initializeBase(this,[21,n]);this.a=t};_mcp.br.prototype={a:null,d:function(){if(!this.C()&&this.a.a().a().f()===2&&this.a.k().c().a()){var n=this.D.b(5);n&&n.a()&&n.c()&&n.a().bf()}_mcp.bc.prototype.d.call(this)}};_mcp.r=function(n,t,i,r){this.o=Function.createDelegate(this,this.s);_mcp.r.initializeBase(this,[11,n,i,r]);this.g=new _C(this.o,this.G());this.h=t;this.f=_a.UserAgent.getInstance();this.e=_a.bb.a()};_mcp.r.a=function(n,t){return t?n.bl.SignatureHtml:n.bl.SignatureText};_mcp.r.prototype={g:null,h:null,l:null,i:null,f:null,e:null,a:function(){var t=this.D.a.L;var n=t.f()==="HTML"&&this.h.a();return n?this.i:this.l},c:function(){return this.D.a.L.cL()&&this.v()?!0:!1},b:function(){return this.g},d:function(){var u=_g.a.a().a();if(!this.C()){var n=this.r(u,!0);if(_js.d.a(n)){_js.Trace.logInfo(_a.a.a,"No html signature.");this.i=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var i=_mcp.r.c+e+n.replace(_mcp.r.b," ")+f;_js.Trace.logInfo(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",n,i);this.i=i}var t=this.r(u,!1);if(_js.d.a(t)){_js.Trace.logInfo(_a.a.a,"No plain text signature.");this.l=null}else{var r="\n"+t;_js.Trace.logInfo(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.l=r}_mcp.n.prototype.d.call(this)}},y:function(){if(!_js.d.b(_g.a.a().a().bl.SignatureText)){var n=new _fm.d(_nbs.a.Bo,null,this.g);n.bd(_nbs.a.Bo);this.q=[n]}},x:function(){if(!_js.d.b(_g.a.a().a().bl.SignatureText)){var n=_mcp.n.a(this.g,_nbs.a.Bo);this.p=[n]}},v:function(){var n=_g.a.a().a();return"Mouse"===_y.c.a.a()?n.bl.AutoAddSignature:this.f.c()?this.e.b("MOWA.IsSignatureChanged")==="true"?this.e.b("MOWA.AutoAddSignature")==="true":!0:n.bl.AutoAddSignatureOnMobile},r:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.r.a(n,t);if(this.f.c()){if(this.e.b("MOWA.IsSignatureChanged")==="true")if(this.e.b("MOWA.UseDesktopSignature")==="true")return _mcp.r.a(n,t);else{var r=this.e.b("MOWA.SignatureText")||"";return t?_a.u.b(r):r}return t?_a.u.b(_c.s.a(this.f)):_c.s.a(this.f)}if(n.bl.UseDesktopSignature)return _mcp.r.a(n,t);else{var i=n.bl.SignatureTextOnMobile||"";return t?_a.u.b(i):i}},s:function(){var i=this.D.a.L;var u=_g.a.a().a();i.ck(!0);var r=i.f()==="HTML"&&this.h.a();var t=!_js.d.a(this.a());if(t){var n=new _cmc.d(0,this.a(),r);n.l=!0;n.m=!1;this.E.bk().a(n)}else _js.Trace.logInfo(_a.a.a,"Skip insert signature due to HasSignature={0};",t)}};_mcp.T=function(n,t,i,r){this.z=Function.createDelegate(this,this.v);this.y=Function.createDelegate(this,this.s);this.A=Function.createDelegate(this,this.P);this.B=Function.createDelegate(this,this.K);_mcp.T.initializeBase(this,[10,n]);this.l=new _C(this.B,this.G());this.k=t;this.t=i;this.p=r};_mcp.T.a=function(n){if(OwaApplication.b)return null;var t=n.b(22);return new _y.f(_y.b.bq(),_y.b.br(),_u.P.e,t.i)};_mcp.T.prototype={l:null,n:null,o:!1,k:null,t:null,p:null,w:!1,r:null,q:null,m:null,a:function(){return this.l},e:function(){return this.n},Q:function(n){if(n!==this.n){this.n=n;this.bj("CloseConfirmDialogButtonData")}return n},f:function(){return this.o},h:function(n){if(n!==this.o){this.o=n;this.bj("IsCloseConfirmDialogShown")}return n},T:function(n){if(n!==this.w){this.w=n;this.bj("IsAppBarSetup")}return n},i:function(){var i=this.D;var e=i.a.L;_js.Trace.logInfo(_a.a.a,"Setup appbar menu. Context: {0}",e);var n=new _ff.e;var f=this.E.cZ();OwaApplication.b||_js.d.b(f.a())||n.c(new _y.g(_nbs.a.Bo,f.b()));var t=i.b(1);_g.a.a().a().bl.AlwaysShowBcc?n.c(t.ci()):n.c(t.ck());if(e.bn())if(_g.a.a().a().bl.AlwaysShowFrom){n.c(t.cj());t.J=!1}else{n.c(t.bg());t.J=!0}else t.J=!1;OwaApplication.b||n.c(new _y.g(_nbs.a.du,t.Y));var u=this.D.b(30);if(!_y.c.a.h()&&u.a()){this.r=new _y.g(_nbs.a.JB,u.e());this.q=new _y.g(_nbs.a.kY,u.c());this.m=this.E.L.bm()?this.q:this.r;n.c(this.m)}var s=i.b(6);n.c(s.b());var r=i.b(3);if(r.c()&&r.e()){n.c(r.c());r.g(!0)}else r.g(!1);if(this.p&&!this.p.c()){var o=i.b(9);n.c(new _y.g(_nbs.a.NI,o.b()))}i.a.dp.f(n.d);this.T(!0)},d:function(){var t=this.D;var n=t.a;var i=n.L;_js.Trace.logInfo(_a.a.a,"InitTouchComponent:Context:{0}",i);this.k&&this.k.a().b().Enabled&&n.X.a()==="TouchNarrow"?this.N():n.dp||this.L();t.b(21);_mcp.bc.prototype.d.call(this)},g:function(n,t){if(this.E.bh)return!1;else if(this.E.bg().c()){this.o||this.K();return!0}else if(this.E.L.bd()&&!this.J()){_js.Trace.logInfo(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.s();return!0}else{this.E.D(!0);return!1}},j:function(){var i=this.D.b(30);if(i.a()){var n=this.F.bm()?this.q:this.r;var t=this.E.dp;if(this.m){t.M(this.m,n);this.m=n}else this.i()}},J:function(){var n=this.E.e();return n.a()},L:function(){var e=this.D;var f=e.a;var o=f.L;var l=this.E.e();var c=new _y.f(_y.b.G(),_y.b.H(),_u.P.V,l.b());var h=_y.f.a(_nbs.a.Qu,this.l);var r=_mcp.T.a(e);var i=this.M(o,e);var u=2;u+=r?1:0;u+=i?1:0;var n=new Array(u);var t=0;n[t++]=c;r&&(n[t++]=r);n[t++]=h;i&&(n[t++]=i);_js.Trace.logInfo(_a.a.a,"Creating appbar. ContextId={0}",o.b());var s=_y.i.a(f,n,null);s.G("TouchNarrow"===_y.c.a.a());f.dK(s)},N:function(){var f=this.E.L;var i=this.E.e();var n=new _ms.b;if(_a.UserAgent.getInstance().a()){n.e(2);n.h(_nbs.a.Wy);n.f(new _ms.a(_fm.a.a,_fm.a.a,this.l,_u.R.ZZ));n.g(new _ms.a(_fm.a.a,_fm.a.a,i.b(),_u.R.Kd));n.i.a(!0)}else{n.e(1);n.h(_nbs.a.Ol);n.f(new _ms.a(_y.b.a(),_y.b.a(),this.l,""));n.m(new _ms.a(_fm.a.h,_fm.a.h,null,""));n.n(this.D.b(28).e());var r=this.E.S();var t=r.i();if(t&&t.d.length>0){if(t.d.length>1){n.g(new _ms.a(_y.b.J(),_y.b.J(),null,""));n.E(new _fm.f(t.d))}else{var u=t.d[0].i;n.g(new _ms.a(_y.b.J(),_y.b.J(),u,""))}n.l(new _ms.a(_y.b.s(),_y.b.s(),i.b(),""))}else n.g(new _ms.a(_y.b.s(),_y.b.s(),i.b(),""))}this.E.dO(n)},K:function(){var t=this.D;var i=t.a;var n=i.L;_js.Trace.logInfo(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",n);if(this.J()){_js.Trace.logInfo(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.E.bg().c()){this.U();_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.h(!0)}else if(n.bd()){_js.Trace.logInfo(_a.a.a,"Removing unedited reply forward draft on close.");this.s()}else{_js.Trace.logInfo(_a.a.a,"Navigate away due to unmodified message.");this.x()}},v:function(){_js.Trace.logInfo(_a.a.a,"Hide close confirm dialog");this.h(!1)},U:function(){if($a(this.n)){_js.Trace.logInfo(_a.a.a,"Create close confirm dialog.");var n=new _js.f;OwaApplication.b||n.a(new _ff.f(new _C(this.A,this.G()),_u.P.b,_nbs.a.lt));n.a(new _ff.f(new _C(this.y,this.G()),_u.R.IE,_u.R.Tg));n.a(new _ff.f(new _C(this.z,this.G()),_bcs.D.A,_u.R.Ia));this.Q(n)}},P:function(){_js.Trace.logInfo(_a.a.a,"User select save and close");var i=this.D;this.v();var t=i.a.c();var n=this;t.c(function(t){n.x()},null)},s:function(){_js.Trace.logInfo(_a.a.a,"User select discard and close");var n=this.D;this.v();n.a.bg().e();this.x()},x:function(){var n=this.E;n.b().b(n,!1)},M:function(n,t){if(n.bv())return null;var i=new _ff.e;var f=t.a.S();var u=f.p();if(u&&u.length>0)for(var e=u,h=e.length,r=0;r<h;++r){var s=e[r];i.c(s)}OwaApplication.b||this.k&&(this.k.a().x().Enabled&&_a.UserAgent.getInstance().a()&&!_a.UserAgent.getInstance().Z||this.k.a().D().Enabled&&_a.UserAgent.getInstance().G)&&this.t.a()&&_a.UserAgent.getInstance().c()&&this.E.L.f()==="HTML"&&i.c(new _y.g(_nbs.a.el,f.o()));if(i.d.length===1){var o=i.d[0];return new _y.f(_y.b.be(),_y.b.bf(),_u.P.P,o.a())}else return new _y.f(_y.b.be(),_y.b.bf(),_u.P.P,null,i.d)}};_mcp.bu=function(n,t,i){this.L=Function.createDelegate(this,this.V);this.B=Function.createDelegate(this,this.N);this.M=Function.createDelegate(this,this.bb);this.J=Function.createDelegate(this,this.X);this.p=Function.createDelegate(this,this.P);this.K=Function.createDelegate(this,this.ba);_mcp.bu.initializeBase(this,[12,n]);this.s=this.D.a.bq;this.l=t;this.U=i};_mcp.bu.prototype={s:null,l:null,U:null,v:null,n:null,m:null,z:null,y:null,A:null,r:null,k:null,a:function(){this.r||(this.r=new _C(this.K,_a.a.a));return this.r},i:function(){var n=this.D.a.L;return this.g()&&!n.S()},h:function(){var n=this.D.a.L;return this.g()&&n.S()&&!this.k&&!n.F()},g:function(){return this.f()&&this.E.V()&&!this.F.t()},f:function(){var n=this.E.L.a();return n===1||n===2||n===3},e:function(){return this.i()||this.h()},o:null,b:function(){return this.o},j:function(n){this.o=n;return n},d:function(){if(this.g()){var n=this.E.L;if(n.S()&&n.F()){_js.Trace.logInfo(_a.a.Y,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.w();this.E.N()}}_mcp.bc.prototype.d.call(this)},c:function(){_a.y.stPT(_a.a.a,"MailComposeUpgrade",3);this.n=_y.j.b(_a.a.a,"MailComposeUpgrade",!0);this.o=_y.j.b(_a.a.a,"MailComposeQuoteBody",!0);var i=this.D.a;var n=i.L;var u=n.b();this.v=u;if(!n.g()){if(!this.g()){var f=this;_js.g.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.g()||n.F()||u!==f.v||f.x(i.M)},5e3)}var t;t=this.l.a()||n.f()!=="HTML"?n.f()==="Text"?_h.b.m():_h.b.c():_h.b.K();if(t===_h.b.c()||t===_h.b.K()){t.BlockExternalImages=n.d().bl.HasBlockedImages;t.FilterHtmlContent=n.d().bl.HasBlockedImages}var r=i.bu.c(n,t,this.l);n.a()===12&&(r.S=new _g.R(new _g.C("internalsubmission")));r.bI(this.p);_js.Trace.logInfo(_a.a.Y,"Begin upgrade, context:{0}; OriParentFolderId={1}",n,n.d()&&n.d().bl.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.d().bl.ParentFolderId):"null");r.f="MailComposeUpgrade";if(n.bk()){var e=new _mcp.B(r);i.W.a(e,this.J,this.M,null)}else i.W.a(r,this.B,this.L,null)}},X:function(n){var t=n;this.N(t.a)},bb:function(n){var i=n;var t=i.a;t.bn(this.p);this.V(t);this.W(n.t,t.I,t.C?t.C.correlationId:null,this.D.a.L)},N:function(n){var c=this.D;var e=c.a;var r=e.L;var t=n;var h=e.bg();var u=t.d;var i=n.I;var o=t.C?t.C.correlationId:null;var l=!!t.c;if(this.s.a(i)){_js.Trace.logInfo(_a.a.Y,"Check upgrade callback, resume discard for context {0}",i);h.b(i,u)}else if(i===r.b()){r.D(u);_js.Trace.logInfo(_a.a.Y,"Context match, updated the draft id. Context:{0}; ResponseMessageBodyType={1}",r,l&&t.c.z()?t.c.z().a():"null");var f=e.c();var s=e.e();if(!f.a()&&s.a()){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.q("SkipUpgrade",o,"Skip upgrade since send is in progress");s.c();return}if(f.a()&&f.g()){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.q("SkipUpgrade",o,"SkipUpgrade since saving is in progress");f.h();return}}if(t.c){_js.Trace.logInfo(_a.a.Y,"Check upgrade, action has response message, call complete upgrade. context:{0}; ActionItemId={1}",r,_h.bk.a(u));this.P(n)}else if(n.I===r.b()){_js.Trace.logInfo(_a.a.Y,"Check upgrade: action has id only, updated draft id. context:{0}; ActionItemId={1}",r,_h.bk.a(u));this.Q()}},Y:function(n){n.cT()&&this.D.a.M.a(3050)},P:function(n){var o=this.D;var r=o.a;var t=r.L;var i=n;var c=i.C?i.C.correlationId:null;var e=n.I;i.bn(this.p);if(e===t.b()){t.dd(i.c);this.k=i.c;t.gj(i.c.bB());try{if(this.g())if(t.S()){_js.Trace.logInfo(_a.a.Y,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.t();this.bo("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.E.N()}else t.cn(!0);else this.t();i.c.U()&&t.bp(i.c.U().c);var s=r.S();s.v()}finally{t.g()&&r.M.b(3440);_js.Trace.logInfo(_a.a.Y,"IsUpgraded for context is {0}",t.g())}this.Y(t);this.E.N();_js.Trace.logInfo(_a.a.Y,"Complete upgrade context:{0}",t);var u=r.c();if(u.a())u.h();else if(_a.bl.a){var f=this.D.b(23);var h=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){f&&f.a(32)})}r.T.a(_y.ef,new _mcp.bv(t.Z().bl.ItemId.Id,r))}else _js.Trace.logInfo(_a.a.Y,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",e,t)},ba:function(){this.m=_y.j.b(_a.a.a,"MailComposeOnDemandUpgrade",!0);var n=this.D.a.L;n.ds(!0);if(this.k||n.Z()&&n.g()){this.k||(this.k=n.Z());_js.Trace.logInfo(_a.a.Y,"user requests for quoted body, upgrade was successful, complete the body merge");this.t();this.bo("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.F()){_js.Trace.logInfo(_a.a.Y,"user requests for quoted body, upgrade failed, show error message");this.bo("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.w();this.E.N();this.T()}else{_js.Trace.logInfo(_a.a.Y,"user requests for quoted body, upgrade has yet to come back, show spinner");this.bo("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},t:function(){var n=this.D.a.L;var e=!1;if(this.l.c()){if(n.ed()){n.ei.a();n.L()===n.ed().a()&&(e=!0)}else n.eD=!0;n.eC=!0}if(this.E.V()&&this.g()&&this.k.z()&&n.f()!==this.k.z().a()&&this.l.a()){var f=this.k.z().bl.Value;if(n.f()==="HTML")n.eB(_a.u.b(f));else{var i;var o,r;r=_a.u.a(f,o={val:i}),i=o.val,r;n.eB(i);var h=this;n.eu=function(n){n.S().t(!1)}}}else if(this.l.a()||n.f()!=="HTML"){var u=this.k.z().bl.Value;n.eB(!this.l.c()&&n.f()==="Text"?_a.u.F(u):u)}else n.eB(this.k.bC().bl.Value);if(_y.c.a.a()==="Mouse"||this.l.c()){var t=new _cmc.d(2,n.cK(),n.f()==="HTML");t.o=!1;t.t=!0;var c=this;t.u=function(){n.cn(!0)};this.E.bk().a(t)}else n.cn(!0);if(e){n.ei.a();n.ed().s(n.L());var s=n.ee;s&&n.ee.s(n.L())}this.Q()},V:function(n){var h=this.D;var i=h.a;var u=i.L;var s=i.bg();var r=n;var f=r.C?r.C.correlationId:null;r.bn(this.p);u.dL(!0);var t=n.I;if(this.s.a(t)){_js.Trace.logInfo(_a.a.Y,"Resume discard for context {0}",t);s.b(t,r.d)}else if(t===u.b()){_js.Trace.logInfo(_a.a.Y,"Recording on context upgrade failed");var e=i.c();var o=i.e();if(e.a()){if(e.g()){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",t);this.q("SkipUpgrade",f,"Skip upgrade since saving is in progress");e.h();return}this.x(i.M)}else if(o.a()){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for context {0} since send was triggered during upgrade",t);this.q("SkipUpgrade",f,"Skip upgrade since send is in progress");o.c();return}else this.x(i.M);if(this.g()&&u.S()){_js.Trace.logInfo(_a.a.Y,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.bo("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.w();this.E.N()}}n.t&&this.W(n.t,t,f,u)},W:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.X.a(n)){f=_g.X.b(n);u=n.FaultMessage}_js.Trace.logWarning(_a.a.Y,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.q(f,i,u)},x:function(n){if(!this.g()){n.b(3440);n.a(3440,null);this.E.N()}},w:function(){var n=this.D.a.M;n.b(3450);n.a(3450,null)},q:function(n,t,i){this.z=n;this.y=t;this.A=i;if(this.n){_y.j.a(this.n,null,n,t,i);this.n=null;_a.y.endPT("MailComposeUpgrade")}if(this.o){_y.j.a(this.o,null,n,t,i);this.o=null}this.T()},Q:function(){if(this.n){_y.j.a(this.n);this.n=null;_a.y.endPT("MailComposeUpgrade")}this.Z()},Z:function(){if(this.m){_y.j.a(this.m);this.m=null}},T:function(){if(this.m){_y.j.a(this.m,null,this.z,this.y,this.A);this.m=null}}};_mcp.bk=function(n,t){this.g=Function.createDelegate(this,this.h);_mcp.bk.initializeBase(this,[17,n]);if(_a.cC.a){var i=this;t.a(function(t){i.c=t.a(n.b(1),n.a.M);i.c.d(i.g);if(i.e){i.c.b();i.e=!1}if(i.f){i.c.a();i.f=!1}})}};_mcp.bk.prototype={c:null,e:!1,f:!1,d:function(){if(!_a.cC.a){_mcp.bc.prototype.d.call(this);return}this.c?this.c.b():this.e=!0;_mcp.bc.prototype.d.call(this)},a:function(n){if(_a.cC.a){if(n===32){var r=this.D;var i=r.a;var t=i.L;if(t.cG()){i.M.b(4400);i.M.a(4400);this.E.N()}if(!t.a()||t.a()===3||t.a()===11)return}this.C()||this.d();this.i()}},b:function(){if(_a.cC.a){this.C()||this.d();if(this.c){_js.Trace.logInfo(_a.a.a,"Remove MailTips for deleted recipients");this.c.c()}else _js.Trace.logInfo(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},i:function(){if(_a.cC.a)if(this.c){_js.Trace.logInfo(_a.a.a,"Prepares to submit mailtips action");this.c.a()}else{_js.Trace.logInfo(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.f=!0}},h:function(){_a.cC.a&&this.E.N()}};_mcp.bo=function(n,t){this.f=Function.createDelegate(this,this.g);_mcp.bo.initializeBase(this,[31,n]);var i=this;t.a(function(t){i.b=t.a(n.b(1),n.a.M);i.b.c(i.f);if(i.c){i.b.a();i.c=!1}if(i.e){i.b.b();i.e=!1}})};_mcp.bo.prototype={b:null,c:!1,e:!1,d:function(){this.b?this.b.a():this.c=!0;_mcp.bc.prototype.d.call(this)},a:function(n){this.C()||this.d();this.h()},h:function(){if(this.b){_js.Trace.logInfo(_a.a.a,"Prepares to submit PeopleRecommendations action");this.b.b()}else{_js.Trace.logInfo(_a.a.a,"Remember to submit PeopleRecommendations action once the PeopleRecommendationsHandler is created");this.e=!0}},g:function(){this.E.N()}};_mcp.bq=function(n,t){this.o=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.r);_mcp.bq.initializeBase(this,[23,n]);if(_a.bl.a){var i=this;t.a(function(t){i.f=t.a(i.D.b(1),i.D.b(5),n.a.M);i.f.i(i.k);i.f.e(i.l);i.f.d(i.m);i.f.f(i.n);i.f.g(i.o);if(i.h){i.f.b();i.h=!1}if(i.i){i.a(i.j);i.i=!1}})}};_mcp.bq.prototype={g:null,f:null,h:!1,i:!1,j:0,d:function(){if(!_a.bl.a){_mcp.bc.prototype.d.call(this);return}this.f?this.f.b():this.h=!0;_mcp.bc.prototype.d.call(this)},bk:function(){this.g&&(this.g=_js.g.a().b(this.g));_js.x.prototype.bk.call(this)},c:function(){if(!_a.bl.a)return!1;switch(this.p()){case 1:return!1;case 2:case 3:return $a(this.D.a.L.bT())&&$a(this.D.a.L.bS());case 4:case 5:return $a(this.D.a.L.bS());default:return!1}},b:function(){if(!_a.bl.a)return"";switch(this.p()){case 2:case 3:return _u.P.O;case 4:case 5:return _u.P.Y;default:return""}},e:function(){if(_a.bl.a){if(!this.f){_js.Trace.logInfo(_a.a.J,"skip setting message sent flag since handler hasn't been created yet.");return}this.f.h(!0);if(!$a(this.D.a.L.bT())){var n=_a.d.b(_a.a.J,"DlpPolicyTipOverridden");_a.d.a(n)}}},a:function(n){this.q(n,0)},x:function(n,t,i){_js.Trace.logInfo(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.ed()){u=_a.G.b(n.ed().f());r=_a.G.b(n.ed().a())}else{u=_a.G.b(n.w());r=_a.G.b(n.L())}this.f.c(i,n.x(),u,r,t)},q:function(n,t){if(_a.bl.a){if(!this.f){_js.Trace.logInfo(_a.a.J,"Remember to resume triggering policy tips once the handler is created");this.j=n;this.i=!0;return}var f=this.D;var e=f.a;var r=e.L;this.C()||this.d();this.g&&(this.g=_js.g.a().b(this.g));var i=r.i();if(i){_bc.g.a(i)&&!_g.j.b&&(i=_g.j.a.q(i));if(_bc.g.a(i)){if(t<4){var u=this;this.g=_js.g.a().a(_a.a.J,"TriggerPolicyTipsIfNeeded",function(){u.q(n,t+1)},5e3)}}else this.x(r,n,i)}}},p:function(){this.C()||this.d();return this.f?this.f.a():0},r:function(){this.E.N()},s:function(n){var r=this.D;var i=r.a;var t=i.L;t.dc(n)},t:function(n){var r=this.D;var i=r.a;var t=i.L;t.db(n)},v:function(){this.a(64)},w:function(n){var r=this.D;var i=r.a;var t=i.L;t.da(n)}};_mcp.bi=function(n,t){this.P=Function.createDelegate(this,this.bp);this.K=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.bl);this.N=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.bg);this.L=Function.createDelegate(this,this.bi);this.V=Function.createDelegate(this,this.bd);this.W=Function.createDelegate(this,this.br);_mcp.bi.initializeBase(this,[22,n]);this.j=!1;this.T=t;this.i=new _C(this.W,_a.a.j);this.i.c(!1)};_mcp.bi.prototype={j:!1,h:null,T:null,Q:null,i:null,bq:function(n){if(this.h!==n){this.h=n;this.bj("ExtensibilityViewModel")}return n},ba:function(){return!!this.h&&this.h.b()&&this.i.b},X:!1,d:function(){if(!OwaApplication.b&&!this.C()){var n=this;this.T.a(function(t){if(!n.h){n.Q=t;n.bq(t.d(n,n.V));var u=n.D.a.bE();n.h.q(u.a());var c=n.D.a.T;c.b(_a.dr,n.L);n.h.f();u.apcl(u.b(),n.J);n.h.h(n.N);n.h.g(n.M);if(n.h.w()){n.i.c(n.h.a().b);n.U()}else n.h.a().k(n.K);n.E.cc()&&n.h.apcl("ShowAppsButton",n.P);_mcp.bc.prototype.d.call(n);var r;if(n.F.ek()&&n.F.ek().length>0){for(var i=0;i<n.F.ek().length;i++)if(n.F.ek()[i][0]==="file"){var s,o;o=n.Y(n.F.ek()[i][2],n.F.ek()[i][1],s={val:r},!0),r=s.val,o}else if(n.F.ek()[i][0]==="item"){var f=new _g.A;f.p(new _g.g(n.F.ek()[i][2]));f.e(n.F.ek()[i][1]);var e,h;h=n.Z(f,e={val:r},!0),r=e.val,h}n.F.cX(null)}}})}},U:function(){if(this.E.cc()){var n=this.D.b(29);n.o(this.ba())}},bp:function(n,t){this.U()},H:function(){if(this.C()){var n=this.D.a.bE();n.rpcl(n.b(),this.J);this.h.o(this.N);this.h.n(this.M);this.h.k();var t=this.D.a.T;t.c(_a.dr,this.L)}_mcp.bc.prototype.H.call(this)},a:function(){return _y.c.a.a()==="Mouse"?this.D.a.L.f():this.D.a.L.cE()?"HTML":"Text"},s:function(){return this.D.a.L.w()},z:function(n){this.D.a.L.J(n)},r:function(n,t,i){i.val=0;var r=new _cmc.e(n);this.D.a.L.cp(r);r.d&&(i.val=9016);t.val=r.e;return r.a},y:function(n,t,i){i.val=0;var r=new _cmc.h(n,!0,t);this.D.a.L.cp(r);r.q?i.val=2006:r.r&&(i.val=9016)},o:function(){this.X=!0;this.bj("RequestCloseComposeForm")},q:function(n){var t=this.bb(n);return t.t},B:function(n,t){return this.bc(n,t,!1)},x:function(n,t){this.bc(n,t,!0)},m:function(n,t){return this.Z(n,t,!1)},Z:function(n,t,i){t.val=0;if(!this.D.a.L.g()){_js.Trace.logInfo(_a.a.j,"Attachment not added - well not upgraded.");t.val=9005;return null}var u=this.D.b(5);var f=_y.F.b(n);if(u.a()){var e=_a.d.b(_a.a.c,"AttachmentExtensibilityItemAttachments");var r=new _ff.e;u.a().w(f,r,e);if(!r.d.length){_js.Trace.logInfo(_a.a.j,"Attachment not added - max number exceeded.");t.val=9001;return null}r.d[0].A(i);return r.d[0]}else{_js.Trace.logInfo(_a.a.j,"Attachment not added - max number exceeded.");t.val=9001;return null}},l:function(n,t,i){return this.Y(n,t,i,!1)},Y:function(n,t,i,r){i.val=0;if(!this.D.a.L.g()){_js.Trace.logInfo(_a.a.j,"Attachment not added - well not upgraded.");i.val=9005;return null}var e=this.D.b(5);var f=e.a();if(f){var o=this.Q.b(n,t);var u=f.N(o);u.A(r);return u}_js.Trace.logError(_a.a.j,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},g:function(){return this.D.a.L.bi()?this.D.a.L.bi().Id:null},e:function(n,t){var i=new _cmc.d(0,n,t);i.m=!0;i.l=!0;this.k(i)},f:function(n,t){var i=new _cmc.d(1,n,t);this.k(i)},v:function(n,t){var r=this,i=this;this.D.a.c().c(function(t){n()},function(n){_js.Trace.logInfo(_a.a.j,"SaveActionFailed: Error: {0}",n.t.message);t()})},p:function(n){var t=new _cmc.q(n);this.D.a.L.ci(t);return t.a},w:function(n,t,i){i.val=0;var r=new _cmc.K(n,t);this.D.a.L.ci(r);r.c&&(i.val=2006)},br:function(){this.h&&this.h.z()},bh:function(n,t){this.i.c(this.h.a().b);this.U()},bn:function(){if(_y.c.a.a()==="TouchWide"&&this.h.m()){var n=this.D.a;n.dc(6)}},bl:function(){var n=this.D.a;n.dc(4)},k:function(n){this.E.bk().a(n)},c:function(){return this.D.a.L.i()?this.D.a.L.i().Id:null},b:function(){this.D.a.L.M()||this.D.a.L.dg(new _js.f);return this.D.a.L.M()},t:function(){},A:function(){var n=new _cmc.g(null);this.k(n)},n:function(n){var t=new _cmc.g(n);this.k(t)},bk:function(){this.E.cc()&&this.h.rpcl("ShowAppsButton",this.P);this.h.a().i(this.K);_js.x.prototype.bk.call(this)},bc:function(n,t,i){var u=this.bb(n);i&&u.bE();var f=t.d.length;if(f+u.t.x.length>500)return!1;n===2&&this.D.a.Q().K.a();for(var r=0;r<f;r++){var e=t.d[r];u.ba(e)}return!0},bi:function(n){if(this.j){this.j=!1;this.h.e(!1)}},bd:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.D.a.T;i.a(_a.dN,new _a.dN(!0));this.j=!0}}else if(n===2&&this.j){var t=this.D.a.T;t.a(_a.dN,new _a.dN(!1));this.j=!1}this.E.N()},bb:function(n){var t=this.D.a.Q();return n?n===1?t.e.a:n===2?t.f.a:null:t.c.a},bg:function(n,t){var i=this.D.a.bE();t===i.b()&&this.bs(i)},bs:function(n){this.h.q(n.a());n.a()&&this.h.e(!1)}};_mcp.bw=function(n,t,i){this.d=n;this.f=t;this.e=i};_mcp.bw.prototype={d:null,f:null,e:null,a:function(){return this.d},c:function(){return this.f},b:function(){return this.e}};_mcp.bv=function(n,t){this.c=n;this.d=t};_mcp.bv.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bz=function(n){this.a=n};_mcp.bz.prototype={a:null};_mcp.bA=function(n){this.b=n};_mcp.bA.prototype={b:null,a:function(){return this.b}};_mcp.E=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.E.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.Z=function(n){this.b=n};_mcp.Z.prototype={b:!1,a:function(){return this.b}};_mcp.bB=function(n){this.b=n};_mcp.bB.prototype={b:null,a:function(){return this.b}};_mcp.C=function(){};_mcp.C.prototype={d:function(n,t,i){var r=n.L;var f=r.a();var c=3===f||2===f||1===f;var h=i.c()&&r.g();n.bw().g()&&(h=!!(h&r.S()));var e=null;if(c&&!h){_js.Trace.logInfo(_a.a.a,"Creating CreateResponseAction for context:{0}; layout={1}; disposition={2}",r,_y.c.a.a(),t);var l=r.s(!1);var o=this.b(r,l,i);o.a=t;o.bf=r.bF(100);o.bG=_y.M.toString(r.a());o.bt=r.bD();o.bu=r.bE();if(r.bk()){var a=new _mcp.B(o);e=a}else e=o}else if(r.by()){_js.Trace.logInfo(_a.a.a,"Creating UpdateMessageForComposeAction for context:{0}; disposition={1}",r,t);var s=this.f(t,r,i);if(r.bk()&&!r.a()){s.a.bR(s.W);r.J(s.W)}e=s}else if(8===r.a()){_js.Trace.logInfo(_a.a.a,"Creating CancelCalendarItemAction for context:{0}; disposition={1}",r,t);e=this.h(r,t)}else if(f===5||f===6||f===7){_js.Trace.logInfo(_a.a.a,"Creating MeetingResponseAction for context:{0}; disposition={1}",r,t);e=this.i(r,t)}else if(f===9||f===10){_js.Trace.logInfo(_a.a.a,"CreateComposeAction: ApprovalRequestAction");e=this.g(r,t,i)}else{_js.Trace.logInfo(_a.a.a,"Creating CreateMessageForComposeAction for context:{0}; disposition={1}",r,t);var u=null;if(f===11||f===12){u=new _h.l(r.bs(!1),r.bA());u.a=0}else{u=new _h.l(r.s(!1),null);u.a=t}u.T=!i.a();$a(r.p())||(u.X=r.p());u.bf=r.bF(100);u.bG=_y.M.toString(r.a());u.bt=r.bD();u.bu=r.bE();if(r.bk()&&!r.a()){u.c.bR(u.bf);r.J(u.bf)}e=u}e.I=r.b();return e},e:function(n,t,i){var r=new _h.cQ(200,n);r.d=t||_h.b.c();r.i=$a(i)?"MailCompose":i;return r},a:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _h.ej([n],r,2)},c:function(n,t,i){var u=null;u=n.A()?n.bs(!0):n.s(!0);var r=this.b(n,u,i);r.n=t;r.ba=!i.a()&&n.f()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.bD=_g.a.a().a().bl.TimeFormat;return r},h:function(n,t){var i=new _c.z(n.be(),1,n.cD());i.c=n.s(!1);n.p()&&(i.X=n.p());return i},b:function(n,t,i){var u=n.bZ()?new _h.T(n.be()):n.be();var r=null;r=new _h.N(this.j(n.a()),u,i);r.bc(t);r.e=n.cI();r.T=!i.a();n.p()&&(r.X=n.p());r.o=n.bi();r.i=n.cJ();r.I=n.b();n.d()&&_g.r.isInstanceOfType(n.d())&&n.d().bl.IsReadReceiptRequested&&(r.Y=!0);switch(n.a()){case 1:case 2:r.bw=_u.R.JW;break;case 3:r.bw=_nbs.a.QB;break}return r},i:function(n,t){return _cc.f.b(n.d(),_cc.f.c(n.a()),n.s(!1),t,n.cc())},f:function(n,t,i){var r=null;if(t.A()){r=new _h.n(t.bs(!1));r.S=_g.s.c(t.bA());r.i=0}else{r=new _h.n(t.s(!1));r.i=n}r.bA=!i.a();r.Z=t.bD();r.ba=t.bE();t.p()&&(r.m=t.p());r.W=t.bF(100);r.T="AlwaysOverwrite";r.bc=_y.M.toString(t.a());return r},j:function(n){switch(n){case 1:return new _g.cD;case 2:return new _g.bZ;case 3:return new _g.cz;case 12:return new _g.lo;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.M.toString(n));}},g:function(n,t,i){var u=n.d();var r=new _c.v(u,n.s(!1),n.a()===9,t);r.T=!i.a();return r}};_mcp.O=function(){_mcp.O.initializeBase(this)};_mcp.O.prototype={d:function(n,t,i){if(_mcp.g.isInstanceOfType(n)){var r=n;if(r.bR&&t===1&&(r.L.a()===2||!r.L.a())){r.L.d()&&r.bj&&r.L.d().bl.ConversationId.Id!==r.bj.bl.ConversationId.Id&&r.L.d().fM(r.bj.bl.ConversationId);var f=this;var u=r.bR(r.bS,r.L,function(n){r.bz=n});u.I=r.L.b();return u}}return _mcp.C.prototype.d.call(this,n,t,i)}};_mcp.bd=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_a.b.b(e,"nativeBridge");this.a=n;this.b=i;this.c=r;this.l=u;this.k=t;this.m=f;this.e=e;this.f=o;this.o=s;this.g=h;this.h=c;this.i=l;this.j=a;this.n=v;this.p=y;this.d=p};_mcp.bd.prototype={a:null,b:null,c:null,l:null,o:null,k:null,m:null,e:null,f:null,g:null,h:null,i:null,n:null,p:null,d:null,j:null,q:function(n,t){switch(n){case 0:return new _mcp.J(this.a,this.c,!!this.f);case 1:return new _mcp.u(this.a,this.b,this.d);case 2:return new _mcp.k(this.a,this.c);case 3:return new _mcp.t(this.a,this.c,this.b,this.d);case 4:return new _mcp.f(this.a);case 5:return new _mcp.m(this.a,this.k,this.b,this.c,this.l,this.o,this.a.a.ct,this.j);case 6:return new _mcp.I(this.a,this.c,this.b,this.d);case 7:return new _mcp.A(this.a,this.c,this.b,this.a.a.T);case 8:return new _mcp.bb(this.a,this.m,this.c,this.b,this.d);case 9:return new _mcp.bl(this.a,this.f,this.b,this.d);case 10:if("Mouse"!==t)return new _mcp.T(this.a,this.b,this.c,this.d);break;case 11:return new _mcp.r(this.a,this.c,this.b,this.d);case 12:return new _mcp.bu(this.a,this.c,this.b);case 13:if(this.e.b(this.e.d())&&this.e.d().a().a())return new _mcp.bp(this.a,this.e);break;case 20:if(this.e.b(this.e.d())&&this.e.d().a().c())return new _mcp.bn(this.a,this.e);break;case 14:return new _mcp.H(this.a);case 15:if("Mouse"===t)return new _mcp.bf(this.a,this.f,this.b,this.d);break;case 16:if("Mouse"===t)return new _mcp.v(this.a);break;case 18:return new _mcp.o(this.a,this.d);case 17:return new _mcp.bk(this.a,this.g);case 31:return new _mcp.bo(this.a,this.h);case 23:return new _mcp.bq(this.a,this.i);case 19:return new _mcp.x(this.a);case 21:if(this.e.b(this.e.k()))return new _mcp.br(this.a,this.e);break;case 22:return new _mcp.bi(this.a,this.a.a.cv);case 24:if(this.c.a())return new _mcp.bj(this.a,this.b,this.n);break;case 25:return t!=="Mouse"?new _mcp.bh(this.a):new _mcp.bg(this.a,this.f);case 27:return new _mcp.bs(this.a);case 28:if(this.c.b())return new _mcp.w(this.a,this.p,this.d);break;case 29:if(this.b.a().f().Enabled&&t==="Mouse")return new _mcp.q(this.a);break;case 30:return new _mcp.bm(this.a,this.b,this.d)}return null}};_mcp.R=function(n,t){this.d=n;this.c=t};_mcp.R.prototype={c:null,d:null,a:function(n,t){var i=new _mcp.a;if(this.c){i.dE(this.c.c());i.dj(this.c.a())}i.o(n?0:this.d.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.o(this.d.a());u.e(4);u.k(!1);u.D(n);u.dr(t);r&&!r.a()?u.m(r.e()):u.m(i===1?"Text":"HTML");return u}};_mcp.U=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){_a.b.b(k,"nativeBridge");this.n=n;this.C=t;this.s=i;this.D=r;this.K=u;this.c=f;this.A=e;this.z=o;this.y=s;this.l=h;this.B=c;this.m=l;this.r=v;this.o=y;this.p=p;this.h=a;this.t=w;this.j=b;this.x=k;this.w=d;this.d=g;this.e=nt;this.f=tt;this.k=it;this.F=rt;this.E=ut;this.q=ft;this.G=et;this.g=ot;this.u=st;this.v=ht;this.H=ct;this.I=lt;this.i=at};_mcp.U.prototype={n:null,C:null,s:null,D:null,K:null,c:null,m:null,A:null,z:null,y:null,l:null,B:null,r:null,o:null,p:null,H:null,h:null,j:null,t:null,k:null,w:null,x:null,d:null,e:null,f:null,F:null,E:null,q:null,G:null,g:null,u:null,v:null,I:null,i:null,b:function(n,t,i){return this.L(n,null,t,i)},a:function(n,t,i){return this.J(n,null,t,i)},L:function(n,t,i,r){var u=this.K.a(!1,!1);u.fY(n);return this.J(u,t,i,r)},J:function(n,t,i,r){var u=new _mcp.d(n,t,this.n,this.C,this.s,this.D,this.A,this.z,this.y,this.l,this.B,this.m,this.h,this.r,this.o,this.p,this.t,this.j,this.x,this.c,i,r,this.w,this.d,this.e,this.f,this.k,this.F,this.E,this.q,this.G,this.g,this.u,this.v,this.H,this.I,this.i);u.cG();return u}};_mcp.V=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){_mcp.V.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at])};_mcp.V.prototype={J:function(n,t,i,r){var u=new _mcp.e(n,t,this.n,this.C,this.s,this.D,this.A,this.z,this.y,this.l,this.B,this.m,this.h,this.r,this.o,this.p,this.t,this.j,this.x,this.c,i,r,this.w,this.d,this.e,this.f,this.k,this.F,this.E,this.q,this.G,this.g,this.u,this.v,this.H,this.I,this.i);u.cG();return u}};_mcp.P=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){_mcp.P.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at])};_mcp.P.prototype={J:function(n,t,i,r){var u=new _mcp.g(n,t,this.n,this.C,this.s,this.D,this.A,this.z,this.y,this.l,this.B,this.m,this.h,this.r,this.o,this.p,this.t,this.j,this.x,this.c,i,r,this.w,this.d,this.e,this.f,this.k,this.F,this.E,this.q,this.G,this.g,this.u,this.v,this.H,this.I,this.i);u.cG();return u}};_mcp.Q=function(){_mcp.Q.initializeBase(this)};_mcp.Q.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.dQ("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.dQ("ConversationOwner")}return n}};_mcp.G=function(n){this.e=Function.createDelegate(this,this.i);_mcp.G.initializeBase(this);this.b=OwaApplication.a;this.c=n};_mcp.G.prototype={c:null,b:null,a:function(n,t,i,r){$a(t)||n.w(t);n.v(i||this.e);$a(r)||n.z(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.Lx;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.t;if(o){if(_g.X.a(o)){var h=o;if(h.ErrorCode===503){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.eY);e=_u.R.eY}else if(h.ErrorCode===408&&u){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.X.c(h)&&i){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.b.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.Xv:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.a.ca,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.a.ca,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_js.Trace.logInfo(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.a(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.cc("MailComposeActionFailed",n)}};_mcp.a=function(){this.eJ=Function.createDelegate(this,this.fI);this.y=this.w;this.bR=this.J;this.cw=this.L;this.cx=this.bU;this.dP=this.f;this.dO=this.x;_mcp.a.initializeBase(this);this.m("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.a.b.a,this.eJ);this.apcl(_mcp.a.h.a,this.eJ);if(_a.j.a&&_a.j.d()){this.dI(_g.a.a().a().bl.SmimeEncrypt);this.dK(_g.a.a().a().bl.SmimeSign)}this.er=-1};_mcp.a.$$cctor=function(){_mcp.a.n.b(new _a.bs(_g.d));_mcp.a.f.b(new _a.bs(_g.d));_mcp.a.e.b(new _a.bs(_g.d));_mcp.a.m.b(new _a.bs(_pc.a));_mcp.a.d.b(new _a.bs(_g.Attachment));_mcp.a.g.b(new _a.bs(_g.bM))};_mcp.a.bQ=function(){_mcp.a.i||(_mcp.a.i=new _H("MeetingCalendarTimePeriod",_cc.r,_mcp.a));return _mcp.a.i};_mcp.a.bW=function(){_mcp.a.k||(_mcp.a.k=new _H("ProposedNewTime",_cc.s,_mcp.a));return _mcp.a.k};_mcp.a.bT=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.d.a(u)?r:_js.l.a(n,u)};_mcp.a.bS=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.d.a(r)?i:Boolean.parse(r)};_mcp.a.bR=function(n){return!_js.d.b(_mcp.a.a)&&!_js.d.b(n)&&(_mcp.a.a===n||_mcp.a.a.toLowerCase()===n.toLowerCase())};_mcp.a.bk=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.b();u++){r.val+=_g.o.g(t.c(u));u!==t.b()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.a.bX=function(n){return n.replace(_mcp.a.bU,"\r\n")};_mcp.a.prototype={eV:null,eh:null,ev:!1,eI:null,eO:function(){return!!this.cc()},cc:function(){return this.dS(_mcp.a.bW())},fT:function(){return this.eO()?_nbs.a.ZG:_u.P.N},cy:function(n){this.dV("OnAsyncSendCallbackEvent",n)},cV:function(n){this.dW("OnAsyncSendCallbackEvent",n)},eC:!1,cF:function(){return this.eC},ck:function(n){this.eC=n;return n},ff:!1,b:function(){return this.dS(_mcp.a.bM)},fd:function(n){this.dR(_mcp.a.bM,n);return n},a:function(){return this.dS(_mcp.a.b)},e:function(n){this.dR(_mcp.a.b,n);return n},l:function(){return this.dS(_mcp.a.j)},o:function(n){this.dR(_mcp.a.j,n);return n},be:function(){return this.dS(_mcp.a.bm)},co:function(n){this.dR(_mcp.a.bm,n);return n},cI:function(){return this.dS(_mcp.a.bl)},dz:function(n){this.dR(_mcp.a.bl,n);return n},d:function(){this.eh||(this.eh=this.dS(_mcp.a.bn));return this.eh},dA:function(n){this.eh=n;this.dR(_mcp.a.bn,this.eh);return n},i:function(){return this.dS(_mcp.a.E)},D:function(n){if($a(this.i())||!n)this.dR(_mcp.a.E,n);else{this.i().Id=n.Id;this.i().ChangeKey=n.ChangeKey}return n},by:function(){return!!this.i()},W:function(){return!this.fs()},fQ:function(){return this.dS(_mcp.a.bG)},gg:function(n){this.dR(_mcp.a.bG,n);return n},w:function(){return this.dS(_mcp.a.bH)},J:function(n){this.dR(_mcp.a.bH,n);return n},L:function(){return this.dS(_mcp.a.H)},H:function(n){this.dR(_mcp.a.H,n);return n},v:function(){return this.dS(_mcp.a.bw)},cp:function(n){this.dR(_mcp.a.bw,n);return n},cC:function(){return this.dS(_mcp.a.G)},ci:function(n){this.dR(_mcp.a.G,n);return n},ei:null,bU:function(){return this.ei},dh:function(n){this.ei=n;return n},f:function(){return this.dS(_mcp.a.s)},m:function(n){this.dR(_mcp.a.s,n);return n},h:function(){return this.dS(_mcp.a.n)},r:function(n){this.dR(_mcp.a.n,n);return n},bC:function(){return this.dS(_mcp.a.m)},cr:function(n){this.dR(_mcp.a.m,n);return n},bg:function(){return this.dS(_mcp.a.bI)},cs:function(n){this.dR(_mcp.a.bI,n);return n},n:function(){return this.dS(_mcp.a.f)},bh:function(n){this.dR(_mcp.a.f,n);return n},Y:function(){return this.dS(_mcp.a.t)},cZ:function(n){this.dR(_mcp.a.t,n);return n},c:function(){return this.dS(_mcp.a.e)},cg:function(n){this.dR(_mcp.a.e,n);return n},K:function(){return this.dS(_mcp.a.r)},cY:function(n){this.dR(_mcp.a.r,n);return n},cL:function(){return this.dS(_mcp.a.l)},k:function(n){this.dR(_mcp.a.l,n);return n},ba:function(){return this.dS(_mcp.a.Q)},dk:function(n){this.dR(_mcp.a.Q,n);return n},cK:function(){return this.dS(_mcp.a.bu)},eB:function(n){this.dR(_mcp.a.bu,n);return n},fO:function(){return this.dS(_mcp.a.bA)},gf:function(n){this.dR(_mcp.a.bA,n);return n},bB:function(){return this.dS(_mcp.a.bC)},cq:function(n){this.dR(_mcp.a.bC,n);return n},fp:function(){return this.dS(_mcp.a.bD)},dJ:function(n){this.dR(_mcp.a.bD,n);return n},ek:function(){return this.dS(_mcp.a.o)},cX:function(n){this.dR(_mcp.a.o,n);return n},ex:0,P:function(){return this.ex},bL:function(n){this.ex=n;return n},ej:null,bt:function(){return this.ej},bG:function(n){this.ej=n;return n},em:0,cM:function(){return this.em},I:function(n){this.em=n;return n},eP:function(){return this.dS(_mcp.a.U)},eq:function(n){this.dR(_mcp.a.U,n);return n},bl:function(){return this.dS(_mcp.a.h)},fa:function(n){this.dR(_mcp.a.h,n);return n},bx:function(){return this.dS(_mcp.a.Y)},fb:function(n){this.dR(_mcp.a.Y,n);return n},cG:function(){return this.dS(_mcp.a.bf)},fy:function(n){this.dR(_mcp.a.bf,n);return n},cH:function(){return this.dS(_mcp.a.bj)},fz:function(n){this.dR(_mcp.a.bj,n);return n},bW:function(){return this.dS(_mcp.a.M)},fv:function(n){this.dR(_mcp.a.M,n);return n},eo:function(){return this.dS(_mcp.a.bQ())},fA:function(n){this.dR(_mcp.a.bQ(),n);return n},j:function(){return this.dS(_mcp.a.J)},cj:function(n){this.dR(_mcp.a.J,n);return n},bo:function(){return this.dS(_mcp.a.bx)},dF:function(n){this.dR(_mcp.a.bx,n);return n},g:function(){return this.dS(_mcp.a.bi)},cn:function(n){this.dR(_mcp.a.bi,n);return n},z:function(){return this.dS(_mcp.a.W)},dq:function(n){this.dR(_mcp.a.W,n);return n},Q:function(){return this.dS(_mcp.a.S)},bM:function(n){this.dR(_mcp.a.S,n);return n},cb:function(){return this.dS(_mcp.a.bq)},dC:function(n){this.dR(_mcp.a.bq,n);return n},bA:function(){return this.dS(_mcp.a.bp)},dB:function(n){this.dR(_mcp.a.bp,n);return n},eS:function(){return this.dS(_mcp.a.bc)},dt:function(n){this.dR(_mcp.a.bc,n);return n},bZ:function(){return this.dS(_mcp.a.ba)},cl:function(n){this.dR(_mcp.a.ba,n);return n},cD:function(){return this.dS(_mcp.a.I)},df:function(n){this.dR(_mcp.a.I,n);return n},fK:function(){return this.dS(_mcp.a.R)},dl:function(n){this.dR(_mcp.a.R,n);return n},bV:function(){return this.dS(_mcp.a.L)},eY:function(n){this.dR(_mcp.a.L,n);return n},bD:function(){return this.dS(_mcp.a.bJ)},ct:function(n){this.dR(_mcp.a.bJ,n);return n},bE:function(){return this.dS(_mcp.a.bK)},gh:function(n){this.dR(_mcp.a.bK,n);return n},bd:function(){return this.dS(_mcp.a.bg)},dv:function(n){this.dR(_mcp.a.bg,n);return n},Z:function(){return this.dS(_mcp.a.F)},dd:function(n){this.dR(_mcp.a.F,n);return n},X:function(){return this.dS(_mcp.a.p)},gc:function(n){this.dR(_mcp.a.p,n);return n},bj:function(){return this.dS(_mcp.a.K)},di:function(n){this.dR(_mcp.a.K,n);return n},x:function(){return this.dS(_mcp.a.d)},bp:function(n){var i=null;if(n){i=new _js.f;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.dR(_mcp.a.d,i);this.fG();return n},F:function(){return this.dS(_mcp.a.bL)},dL:function(n){this.dR(_mcp.a.bL,n);return n},ed:function(){return this.dS(_mcp.a.q)},eA:function(n){this.dR(_mcp.a.q,n);return n},ee:null,ey:!1,bk:function(){return this.ey},dm:function(n){this.ey=n;return n},B:function(){return this.dS(_mcp.a.bv)},bO:function(n){if(n!==this.B()){this.dR(_mcp.a.bv,n);this.dU("IsCopyRestricted","IsPrintRestricted")}return n},p:function(){return this.dS(_mcp.a.y)},bK:function(n){this.dR(_mcp.a.y,n);return n},fg:!1,dH:function(n){this.fg=n;return n},R:function(){return this.ev},dp:function(n){if(this.ev!==n){this.ev=n;n&&!this.ed()&&this.fn();this.dQ("IsEditorInitialized")}return n},eK:null,de:function(n){this.eK=n;return n},eL:!1,dx:function(n){this.eL=n;return n},bY:function(){return this.dS(_mcp.a.X)},eZ:function(n){this.dR(_mcp.a.X,n);return n},cQ:function(){return this.dS(_mcp.a.bN)},ep:function(n){this.dR(_mcp.a.bN,n);return n},bv:function(){return this.dS(_mcp.a.O)},fx:function(n){this.dR(_mcp.a.O,n);return n},eR:function(){return this.dS(_mcp.a.Z)},dr:function(n){this.dR(_mcp.a.Z,n);return n},ce:function(){return this.dS(_mcp.a.bO)},fe:function(n){this.dR(_mcp.a.bO,n);return n},fM:function(){return!!this.B()&&!this.B().a()&&!this.B().h()&&!this.B().b()},cd:function(){return this.bl()&&_mcp.f.g(this)},fL:function(){return!!this.B()&&0===this.B().a()&&!this.B().f()&&!this.B().b()},V:function(){return null},bP:function(){return this.w()},br:function(){return this.eV},bw:function(){return this.dS(_mcp.a.T)},bN:function(n){this.dR(_mcp.a.T,n);return n},eN:function(){return this.dS(_mcp.a.v)},bJ:function(n){this.dR(_mcp.a.v,n);return n},bT:function(){return this.dS(_mcp.a.D)},dc:function(n){this.dR(_mcp.a.D,n);return n},bS:function(){return this.dS(_mcp.a.C)},db:function(n){this.dR(_mcp.a.C,n);return n},fJ:function(){return this.dS(_mcp.a.B)},da:function(n){this.dR(_mcp.a.B,n);return n},cz:function(){return this.dS(_mcp.a.x)},bH:function(n){this.dR(_mcp.a.x,n);return n},cA:function(){return this.dS(_mcp.a.u)},bI:function(n){this.dR(_mcp.a.u,n);return n},fo:function(){return this.dS(_mcp.a.w)},fu:function(n){this.dR(_mcp.a.w,n);return n},C:function(){return this.dS(_mcp.a.bz)},dG:function(n){this.dR(_mcp.a.bz,n);return n},bb:function(){return this.dS(_mcp.a.V)},dn:function(n){this.dR(_mcp.a.V,n);return n},bc:function(){return this.dS(_mcp.a.be)},du:function(n){this.dR(_mcp.a.be,n);return n},fR:function(){return this.t()},eT:function(){return this.dS(_mcp.a.bE)},fB:function(n){this.dR(_mcp.a.bE,n);return n},t:function(){return _a.j.a&&(this.q()||this.E())},q:function(){if(!_a.j.a||!_a.j.k()||!this.cU()||_g.a.a().a().bl.AlwaysShowFrom)return!1;var n=_g.a.a().bl.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.dS(_mcp.a.bB)},dI:function(n){this.dR(_mcp.a.bB,n);this.dQ(_mcp.a.c);_js.Trace.logInfo(_a.a.g,"Context.SmimeEncryptMessage is set to {0}",n);return n},E:function(){if(!_a.j.a||!_a.j.k()||!this.cU()||_g.a.a().a().bl.AlwaysShowFrom)return!1;var n=_g.a.a().bl.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.dS(_mcp.a.bF)},dK:function(n){this.dR(_mcp.a.bF,n);this.dQ(_mcp.a.c);_js.Trace.logInfo(_a.a.g,"Context.SmimeSignMessage is set to {0}",n);return n},cO:function(){return _g.a.a().bl.SmimeAdminSettings&&(_g.a.a().bl.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bl.AlwaysShowFrom)||this.z()?!1:!0},cP:function(){return _g.a.a().bl.SmimeAdminSettings&&(_g.a.a().bl.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bl.AlwaysShowFrom)||this.z()?!1:!0},er:0,bi:function(){return this.dS(_mcp.a.z)},eX:function(n){this.dR(_mcp.a.z,n);return n},cJ:function(){return this.dS(_mcp.a.bo)},fc:function(n){this.dR(_mcp.a.bo,n);return n},bn:function(){if(this.bl()||_y.c.a.h()||this.t())return!1;var n=this.B();return!n||!!n.a()||n.b()},bz:function(){return OwaApplication.b?!1:this.a()!==8&&!this.A()},en:function(){return this.dS(_mcp.a.bd)},gd:function(n){this.dR(_mcp.a.bd,n);return n},eD:!1,fi:!1,bf:function(){return this.fi},A:function(){return this.a()===11||this.a()===12||this.a()===13},cB:function(){return this.dS(_mcp.a.bs)},G:function(n){this.dR(_mcp.a.bs,n);return n},eG:function(){return this.dS(_mcp.a.br)},T:function(n){this.dR(_mcp.a.br,n);return n},fS:function(){return this.dS(_mcp.a.bP)},U:function(n){this.dR(_mcp.a.bP,n);return n},dE:function(n){this.dR(_mcp.a.bV,n);return n},cE:function(){return this.dS(_mcp.a.P)},dj:function(n){this.dR(_mcp.a.P,n);return n},M:function(){return this.dS(_mcp.a.g)},dg:function(n){this.dR(_mcp.a.g,n);return n},S:function(){return this.dS(_mcp.a.bb)},ds:function(n){this.dR(_mcp.a.bb,n);return n},eH:function(){return this.dS(_mcp.a.bh)},dw:function(n){this.dR(_mcp.a.bh,n);return n},bX:function(){return this.dS(_mcp.a.N)},fw:function(n){this.dR(_mcp.a.N,n);return n},fN:function(){return this.dS(_mcp.a.by)},ge:function(n){this.dR(_mcp.a.by,n);return n},cN:function(){this.eI||(this.eI=this.ez());return this.eI},cv:function(){return this.dS(_mcp.a.bt)},bQ:function(n){this.dR(_mcp.a.bt,n);return n},bu:function(){return this.dS(_mcp.a.A)},ch:function(n){this.dR(_mcp.a.A,n);return n},bm:function(){if(!$a(this.M())){var n=_g.c.p(this.M().g(),_g.c.a());return!!n&&n.bl.Value.toUpperCase()==="TRUE"}return!1},cm:function(n){_js.Trace.logInfo(_a.a.a,"Setting IsOmeRequested to {0}",n);this.gk(n);return n},et:null,ca:function(){return this.et},dy:function(n){this.et=n;return n},eu:null,dD:function(n){this.eu=n;return n},fY:function(n){this.o(_mcp.a.bT(_y.dy,n,_mcp.a.j.a,0));this.e(_mcp.a.bT(_y.M,n,_mcp.a.b.a,0));this.k(_mcp.a.bS(n,_mcp.a.l.a,!0));this.dt(_mcp.a.bS(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.eq(!1);this.gg(n.StoreId)}this.fZ(n);this.cn(0===this.a()||4===this.a())},cS:function(n){_g.dJ.isInstanceOfType(n)?this.e(1):_g.dI.isInstanceOfType(n)?this.e(2):_g.ej.isInstanceOfType(n)&&this.e(3);this.fH(n,n.f());this.co(n.bl.ReferenceItemId);this.dz(n.p());this.D(n.bl.ItemId);this.J(n.bl.Subject);this.H(n.f().bl.Value);this.cj(n.bl.From);this.r(n.k()?n.k().c:null);this.bh(n.m()?n.m().c:null);this.cg(n.o()?n.o().c:null);this.k(!1);this.dk(n.bB());this.eE(n);this.bO(n.by());this.dG(n.bH());this.dn(n.bl.IsDeliveryReceiptRequested);this.du(n.bl.IsReadReceiptRequested);this.B()&&!this.B().a()?this.m(this.B().e()):$a(n.f())||(n.bN()?this.m(n.bN().a()):this.m(n.cJ()===1?"Text":"HTML"));this.fr(n);this.cn(!1);this.eq(!0);_js.Trace.logInfo(_a.a.a,"Initialized context with smart response, context: {0}",this)},cR:function(n){if($a(n))throw Error.argumentNull("message");this.fH(n,n.z());this.dd(n);this.D(n.bl.ItemId);this.J(n.bl.Subject);this.H(n.bN()?n.bN().bl.Value:n.z().bl.Value);this.eX(n.bl.ConversationId);if(_g.r.isInstanceOfType(n)){var t=n;this.cj(t.bl.From);this.r(t.k()?t.k().C():null);this.bh(t.m()?t.m().C():null);this.cg(t.o()?t.o().C():null);this.dn(t.bl.IsDeliveryReceiptRequested);this.du(t.bl.IsReadReceiptRequested)}else if(_g.by.isInstanceOfType(n)){var u=n;this.cj(u.bl.From)}this.k(!1);this.dk(n.bB());this.eE(n);this.bO(n.by());this.dG(n.bH());n.by()&&!n.by().a()?this.m(n.by().e()):n.bN()?this.m(n.bN().a()):this.m(n.cJ()===1?"Text":"HTML");this.fa(_g.bk.isInstanceOfType(n));if(this.bl()){var i=n;this.eF(i.v());this.fb(_g.H.isInstanceOfType(i));i.bl.From&&this.cj(i.bl.From);i.bl.Sender&&this.dF(i.bl.Sender)}n.bU()&&n.bU().b()?this.bp(n.bU()?n.bU().c:null):(!this.en()||this.g())&&this.bp(n.U()?n.U().c:null);if(this.x()&&n.z().a()==="Text")for(var r=0;r<this.x().b();r++)this.x().c(r)&&this.x().c(r).b()&&this.x().c(r).f(!1);this.fr(n);this.cn(!0);this.eq(!0);_js.Trace.logInfo(_a.a.a,"Initialized context with draft, context: {0}",this)},N:function(n){this.dA(n);this.fV(n)},fq:function(){this.dZ("OnAsyncSendCallbackEvent",this)},s:function(n){var i=new _g.r;var t;this.fC(i,t={val:n}),n=t.val;return i},bs:function(n){var i=new _g.by;var t;this.fC(i,t={val:n}),n=t.val;return i},fl:function(){var t=this.fm();_a.b.b(this.ei,"GetEditorContentCommand");this.ei.a();var n=this.L();t.a()==="Text"&&(n=_mcp.a.bX(n));t.b(n);this.er=_js.d.a(n)?0:n.length;_js.Trace.logInfo(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.er);return t},gj:function(n){var t=this.ed();if(!t||this.ba()===t.i()){this.dk(n);t&&t.A(n)}},fn:function(){if(this.ev&&this.eL){this.ei.a();if($a(this.ed())){this.eA(_mcp.b.b(this));_js.Trace.logInfo(_a.a.a,"Captured baseline for the first time, context: {0}",this);if(this.eD&&this.ee){this.ee.s(this.ed().a());this.eD=!1}if(!this.i()||this.en()&&this.cQ()){this.ee=_mcp.b.b(this);_js.Trace.logInfo(_a.a.a,"Captured initial baseline for context: {0}",this)}}else{_mcp.b.z(this.ed(),this);_js.Trace.logInfo(_a.a.a,"Updated baseline, context: {0}",this)}}},fs:function(){if($a(this.ed()))return!1;this.ei.a();return!this.ed().t(this)},bF:function(n){var t=null;if(this.f()==="HTML"){var r,i;i=_a.u.a(this.L(),r={val:t}),t=r.val,i}else t=this.L();t=t?t.length>n?t.substr(0,n)+"...":t:"";return t},el:function(n,t,i,r,u){this.r(new _js.f);var f=n?n.Mailbox:null;if(!_mcp.a.a){var h=_g.a.a().c();_mcp.a.a=_js.d.a(h.bl.SharePointUrl)?h.bl.UserEmailAddress||"":h.bl.LogonEmailAddress||""}if(this.fK()||this.a()!==8&&(!u||!u.b())&&f&&(2!==this.a()||!_mcp.a.bR(f.EmailAddress))){this.h().a(f);_js.Trace.logInfo(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.o.g(n),_mcp.a.a)}if(this.a()===2||this.a()===8){_js.Trace.logInfo(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.eM(t,this.h(),f,null);_js.Trace.logInfo(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.bh(new _js.f);this.eM(i,this.n(),f,this.h());_js.Trace.logInfo(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.cg(new _js.f);this.eM(r,this.c(),f,this.h())}if(u&&u.b()>0)if(this.a()===1){this.h().f();for(var s=0;s<u.b();s++){var l=u.c(s);this.h().a(l)}}else if(this.a()===2)for(var e=0;e<u.b();e++){var o=u.c(e);var a=this;if(this.h().b()===this.h().h(function(n){return _g.o.b(o,n)})){var v=this;var c=this.n().h(function(n){return _g.o.b(o,n)});c!==this.n().b()&&this.n().n(c);this.h().a(o)}}if(this.a()!==8&&f&&0===this.h().b()&&(!this.n()||0===this.n().b())){this.h().a(f);_js.Trace.logInfo(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.o.g(n))}this.fj()},toString:function(){var n="Id="+this.b()+"; Op="+this.a()+"; Mode="+this.l()+"; Oid=";n+=this.be()?this.be().Id+":"+this.be().ChangeKey+";":this.eh&&this.eh.bl.ItemId?this.eh.bl.ItemId.Id+":"+this.eh.bl.ItemId.ChangeKey+";":"null;";n+=" Did=";n+=this.i()?this.i().Id+":"+this.i().ChangeKey+";":this.Z()&&this.Z().bl.ItemId?this.Z().bl.ItemId.Id+":"+this.Z().bl.ItemId.ChangeKey+";":"null;";n+=" Subject="+this.w()+"; ContentLength="+(_js.d.a(this.L())?"0":this.L().length.toString())+"; BodyType="+this.f()+";";var r;_mcp.a.bk("To",this.h(),this.bg(),r={val:n}),n=r.val;var i;_mcp.a.bk("Cc",this.n(),this.Y(),i={val:n}),n=i.val;var t;_mcp.a.bk("Bcc",this.c(),this.K(),t={val:n}),n=t.val;n+=" AutoSig="+this.cL()+"; Imp="+this.ba()+"; QuotedBodyLength="+(_js.d.a(this.cK())?"0":this.cK().length.toString())+"; IsComplete="+this.eP()+"; IsMeeting="+this.bl()+"; IsMeetingForward="+this.bx()+"; IsReplyBcc="+this.cG()+"; HasLocation="+this.bW()+"; MeetingTime="+(this.eo()?this.eo().T()+":"+(this.eo().L()?this.eo().L().j():"null")+":"+(this.eo().K()?this.eo().K().j():"null"):"null")+"; From="+_g.o.g(this.j())+"; Sender="+_g.o.g(this.bo())+"; IsFromShown="+this.z()+"; IsBccShown="+this.Q()+"; AttachmentCount="+(this.x()?this.x().b().toString():"0")+"; UpgradeFailed="+this.F()+"; HasBaseline="+(!!this.ed()).toString()+"; HasInitBaseline="+(!!this.ee).toString()+"; UserSaved="+this.bV()+"; IsReplyForward="+this.bd()+"; HasDraft="+(!!this.Z()).toString()+"; HasRMLD="+(!!this.B()).toString()+"; Classified="+this.bw()+"; Class="+this.cz()+"; Sensitivity="+this.C()+"; DeliveryReceipt="+this.bb()+"; ReadReceipt="+this.bc()+"; SmimeEncryptMessage="+this.q()+"; SmimeSignMessage="+this.E()+"; ConversationId="+(this.bi()?this.bi().Id+":"+this.bi().ChangeKey:"null")+" ParentConversationNodeId="+this.cJ()+"; IsOriCalId="+this.eS()+"; OccurrenceRefMaster="+this.bZ()+"; IsLoadedDraft="+this.bY()+"; IsMovedToDraftFromOutbox="+this.eR()+"; IsUpgraded="+this.g()+"; IsCached="+this.ff+";";return n},cW:function(){_js.Trace.logInfo(_a.a.a,"Context reset start.");this.fd(null);this.a()&&this.e(0);this.l()&&this.o(0);this.be()&&this.co(null);this.d()&&this.dA(null);this.i()&&this.D(null);_js.d.a(this.w())||this.J(null);_js.d.a(this.L())||this.H("");this.h()&&this.r(null);_js.d.a(this.bg())||this.cs(null);this.n()&&this.bh(null);_js.d.a(this.Y())||this.cZ(null);this.c()&&this.cg(null);_js.d.a(this.K())||this.cY(null);this.cL()||this.k(!0);this.ba()!=="Normal"&&this.dk("Normal");_js.d.a(this.cK())||this.eB(null);this.eP()&&this.eq(!1);this.bl()&&this.fa(!1);this.bx()&&this.fb(!1);this.cG()&&this.fy(!1);this.cH()&&this.fz(null);this.bW()&&this.fv(!1);this.eo()&&this.fA(null);this.j()&&this.cj(null);this.bo()&&this.dF(null);this.g()&&this.cn(!1);this.z()&&this.dq(!1);this.Q()&&this.bM(!1);this.x()&&this.bp(null);this.F()&&this.dL(!1);this.ed()&&this.eA(null);this.bV()&&this.eY(!1);this.bd()&&this.dv(!1);this.Z()&&this.dd(null);this.B()&&this.bO(null);_js.d.a(this.p())||this.bK(null);this.bw()&&this.bN(!1);_js.d.a(this.eN())||this.bJ(null);_js.d.a(this.cz())||this.bH(null);_js.d.a(this.cA())||this.bI(null);this.fo()&&this.fu(!1);this.C()!=="Normal"&&this.dG("Normal");this.bb()&&this.dn(!1);this.bc()&&this.du(!1);this.q()&&this.dI(!1);this.E()&&this.dK(!1);this.fp()&&this.dJ(null);this.bi()&&this.eX(null);_js.d.a(this.cJ())||this.fc(null);this.eS()&&this.dt(!1);this.bZ()&&this.cl(!1);this.bY()&&this.eZ(!1);this.eR()&&this.dr(!1);this.M()&&this.dg(null);if(this.cB()){_y.j.a(this.cB(),null,"ContextReset",null,null);this.G(null)}_js.Trace.logInfo(_a.a.a,"Context reset end.")},cT:function(){return!!this.d().by()&&0===this.d().by().a()&&!this.d().by().j()&&!this.d().by().k()},cf:function(){var n=null;if(this.j()&&this.j().Mailbox&&!_js.d.a(this.j().Mailbox.EmailAddress))n=this.j().Mailbox;else if(this.bo()&&this.bo().Mailbox&&!_js.d.a(this.bo().Mailbox.EmailAddress))n=this.bo().Mailbox;else if(!_js.d.a(_mcp.a.a)){n=new _g.d;n.EmailAddress=_mcp.a.a;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},cU:function(){if(!_a.j.a||_a.j.s)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.Z()&&!this.eU(this.Z())?!1:this.d()&&!this.eU(this.d())?!1:_js.d.a(this.bu())?!0:!1},eU:function(n){if(_js.d.a(n.bl.ItemClass)||n.bl.ItemClass==="IPM.Note"||n.bA())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bl.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bl.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bl.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bl.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bl.ItemClass==="IPM.Post"?!0:!1}},cu:function(n){_js.Trace.logInfo(_a.a.g,"Updating S/MIME options...");if(_a.j.a)switch(n){case 6:this.dI(!0);this.dK(!1);break;case 10:case 11:this.dI(!1);this.dK(!0);break;case 12:case 13:case 14:this.dI(!0);this.dK(!0);break;case-1:case 0:default:this.dI(!1);this.dK(!1);break}},gl:function(n){_js.Trace.logInfo(_a.a.g,"Upgrading S/MIME options...");if(_a.j.a)switch(n){case 6:this.dI(!0);break;case 10:case 11:this.dK(!0);break;case 12:case 13:case 14:this.dI(!0);this.dK(!0);break;case-1:case 0:default:break}},bq:function(){if(this.cB()){var t=!1;var n=this;this.eV=function(i){if(!t&&n.cB()){_y.j.a(n.cB(),null,i);n.G(null);t=!0}}}},ez:function(n,t){var i=this.fp();if(!i||!i.length)return null;$a(n)&&(n=0);$a(t)&&(t=i.length);for(var r=new _ff.e,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_js.d.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_js.d.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},fC:function(n,t){t.val=$a(t.val)?!1:t.val;n.bR(this.w());n.dr(this.ba());n.bL(this.i());n.ba(new(_a.ge.$$(_g.Attachment,_g.bO)));if(this.t()){var o=_g.a.a().bl.SmimeAdminSettings.ClearSign;n.eL(this.q()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bl.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.cl(this.fk(t.val)):n.cl(new _g.w(new _g.G(this.f(),"")));var e=_a.bj.b(this.fO());n.gN(new _g.kQ(e))}else{n.cl(this.fk(t.val));(this.Z()&&this.Z().bA()||this.d()&&this.d().bA())&&n.eL("IPM.Note");this.x()&&n.U().h(this.x().g())}n.ix(this.B());n.cN(this.C());n.fb(this.bw());n.eW(this.cz());n.eX(this.cA());n.eY(this.eN());n.gF(this.bT());n.gE(this.bS());n.gD(this.fJ());if(this.M()){n.fN(new(_a.ge.$$(_g.bM,_g.bp)));n.bJ().h(this.M().g())}if(_g.r.isInstanceOfType(n)){var i=n;i.cF(this.j());if(this.t()&&this.em){if(this.em===1){i.ce(new(_a.gd.$$(_g.d)));this.h()&&i.k().h(this.h().g());i.ct(new(_a.gd.$$(_g.d)));this.n()&&i.m().h(this.n().g())}else if(this.em===2){i.cD(new(_a.gd.$$(_g.d)));this.c()&&i.o().e(this.c().c(this.ex))}else if(this.em===3){i.cD(new(_a.gd.$$(_g.d)));this.c()&&i.o().h(this.c().g())}}else{i.ce(new(_a.gd.$$(_g.d)));this.h()&&i.k().h(this.h().g());i.ct(new(_a.gd.$$(_g.d)));this.n()&&i.m().h(this.n().g());i.cD(new(_a.gd.$$(_g.d)));this.c()&&i.o().h(this.c().g())}i.cO(this.bb());i.cP(this.bc());i.fq(this.q());i.fr(this.E())}else{var u=n;u.cb(this.bA());var f=_g.a.a().c();var r=null;r=_js.d.a(f.bl.LogonEmailAddress)?null!==this.j()&&this.j().Mailbox?this.j().Mailbox.EmailAddress:_h.l.f(null)||f.bl.UserEmailAddress:f.bl.LogonEmailAddress;if(r){u.g(new _g.bh);u.bl.From.Mailbox=new _g.d;u.bl.From.Mailbox.EmailAddress=r}}},eM:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.o.b(u,i)){_js.Trace.logInfo(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.a.bR(u.EmailAddress)||this.ga(u.EmailAddress)){_js.Trace.logInfo(_a.a.a,"Excluding self address {0}",_mcp.a.a||"null");continue}var e=this;if(r&&r.b()!==r.h(function(n){return _g.o.b(u,n)})){_js.Trace.logInfo(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},ga:function(n){var t=this.j();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},fI:function(n,t){this.dQ("ShowMeetingReadonlyFields")},fZ:function(n){var t=this.gb(n);switch(this.a()){case 0:case 4:this.D(t);break;case 1:case 2:case 3:this.co(t);break}},fr:function(n){if(n.bJ()){this.dg(new _js.f);this.M().p(n.bJ().f())}},gb:function(n){var t=null;if(!$a(n)&&"Id"in n){t=new _g.g(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},fH:function(n,t){0===n.cJ()&&n.fU(t&&t.a()==="Text"?1:3)},fX:function(n){var r=_h.l.f(n);if(r){this.cj(new _g.bh);this.j().Mailbox=new _g.d;this.j().Mailbox.EmailAddress=r}this.dt(!1);this.B()&&!this.B().a()?this.m(n.by().e()):n.bN()?this.m(n.bN().a()):n.z()&&this.m(n.z().a());switch(this.a()){case 1:case 2:case 12:this.eE(n);if(_g.r.isInstanceOfType(n)){var t=n;t.q()?this.el(t.bl.From||t.bl.Sender,null,null,null,null):this.el(t.bl.From||t.bl.Sender,t.k()?t.k().c:null,t.m()?t.m().c:null,t.o()?t.o().c:null,t.cE()?t.cE().c:null);this.fy(this.a()===2&&n.hT()&&!t.bl.IsGroupEscalationMessage);this.dz(n.eG())}else if(_g.by.isInstanceOfType(n)){var u=n;this.el(u.bl.From||u.bl.Sender,null,null,null,null)}this.eW(n);break;case 5:case 6:case 7:if(_g.r.isInstanceOfType(n)){var i=n;this.el(i.bl.From||i.bl.Sender,i.k()?i.k().c:null,i.m()?i.m().c:null,i.o()?i.o().c:null,i.cE()?i.cE().c:null)}break;case 3:_g.bk.isInstanceOfType(n)||this.eE(n);this.dz(n.eG());this.fj();this.eW(n);break;case 9:case 10:_g.r.isInstanceOfType(n)?this.el(n.bl.Sender,null,null,null,null):_g.by.isInstanceOfType(n)&&this.el(n.bl.Sender,null,null,null,null);this.eW(n);break;default:this.fD();break}_js.Trace.logInfo(_a.a.a,"Initialized context with original email message, context: {0}",this)},fV:function(n){this.co(n.bl.ItemId);var i=this.cT();this.bO(i?null:n.by());this.gi(n.cK());this.dG(n.bH());this.H(this.L()||"");this.B()&&!this.B().a()?this.m(this.B().e()):n.bN()?this.m(n.bN().a()):this.m(n.cJ()===1?"Text":"HTML");if(!this.g()){this.cn(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.j.a&&n.bA()||i||this.B()&&this.B().a()||this.bp(n.U()?n.U().c:null)}if(_g.ICalendaring.isInstanceOfType(n)){var t=n;t.bf();this.fW(t)}else if(_g.r.isInstanceOfType(n)||_g.by.isInstanceOfType(n)){if(3===this.a()&&!this.g()){this.dk(n.bB());_js.Trace.logInfo(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.ba(),_h.bk.a(n.bl.ItemId))}this.fX(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.fG();_g.r.isInstanceOfType(n)&&n.bG?this.eq(!1):this.eq(!0)},fU:function(n){var t=null;_g.bC.isInstanceOfType(n)||_g.ba.isInstanceOfType(n)?t=n.bl.From:n.B()?t=n.B():_js.Trace.logError(_a.a.a,"ICalendaring doesnt have an organizer");return t},fG:function(){var n=new _ff.e;this.bx()&&n.h(_g.H.a(this.x()));if(this.eh&&_a.j.a&&this.eh.bA()&&this.eh.en()){var t=this.eh.U().a(0).bl.AttachmentId.Id;n.c(t)}this.gc(n.i())},fW:function(n){this.dt(!0);n.z()&&this.m(n.z().a());var r=this.fU(n);var t;var i;if(_g.bC.isInstanceOfType(n)||_g.ba.isInstanceOfType(n)){t=n.k()?_g.o.f(n.k().c):null;i=n.m()?_g.o.f(n.m().c):null}else{t=n.p()?_g.o.f(_g.t.d(n.p().c)):null;i=n.s()?_g.o.f(_g.t.d(n.s().c)):null}switch(this.a()){case 1:case 2:this.el(r,t,i,null,null);break;case 5:case 6:case 7:this.el(r,t,i,null,null);this.eF(n);this.fx(!0);break;case 8:var u=n.p().s();u.h(n.D().f());t=_g.o.f(_g.t.d(u.c));this.el(r,t,i,null,null);this.eF(n);this.fx(!0);break;case 3:if(_g.H.isInstanceOfType(n)||_g.i.isInstanceOfType(n)){this.fb(!0);this.cj(r);this.eF(n)}break;default:this.fD();break}this.fa(!0);_js.Trace.logInfo(_a.a.a,"Initialized context from original calendar item, context: {0}",this)},eF:function(n){this.fA(_cc.r.e(n));this.fz(n.r());this.fv(!!this.cH()&&!_js.d.a(this.cH().bl.DisplayName))},gi:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.R.JW;break;case 3:t=_nbs.a.QB;break;case 5:t=_nbs.a.Ts;break;case 6:t=_nbs.a.eP;break;case 7:t=_nbs.a.cG;break;case 8:t=_nbs.a.RE;break;case 9:t=_nbs.a.jv;break;case 10:t=_nbs.a.MX;break}this.eO()&&(t=_nbs.a.Ut);var i=String.format(_nbs.a.fq,t,n);_js.Trace.logInfo(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.J(i.substr(0,255));_js.Trace.logInfo(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.w(),255)}else this.J(i)},eW:function(n){this.eX(n.bl.ConversationId);_g.r.isInstanceOfType(n)?this.fc(n.bl.InternetMessageId):_g.by.isInstanceOfType(n)&&this.fc(n.bl.InternetMessageId)},fD:function(){var n=_js.l.b(_y.M,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},eE:function(n){this.bN(n.dE());this.bJ(n.eF());this.bH(n.eD());this.bI(n.eE());this.fu(n.hN())},fk:function(n){return n?this.fm():this.fl()},fm:function(){var n=new _g.w(new _g.G("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.cE()){_js.Trace.logInfo(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.f());n.c(this.f())}else{_js.Trace.logInfo(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},fj:function(){if(_y.c.a.h()){var n=this.cf();if(n){if(!this.ft(this.h(),n.EmailAddress)&&!this.ft(this.n(),n.EmailAddress)){this.n()||this.bh(new _js.f);this.n().a(n);_js.Trace.logInfo(_a.a.a,"Adding self to CC")}}else _js.Trace.logError(_a.a.a,"Could not add self to CC as the address was missing")}},ft:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},gk:function(n){var t=null;if(n){$a(this.M())?this.dg(new _js.f):t=_g.c.p(this.M().g(),_g.c.a());if($a(t)){var i=new _g.bp;i.ExtendedFieldURI=_g.c.a();t=new _g.bM(i);this.M().a(t)}t.c("True")}else{if($a(this.M()))return;t=_g.c.p(this.M().g(),_g.c.a());$a(t)||t.c("False")}}};_mcp.y=function(n){this.e={};this.f=n};_mcp.y.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.K(t))}else this.e[n]=new _mcp.K(t)},g:function(n,t){var u=n.a;var i=u.L;var r=i.b();var o=i.i();var f=!1;if(i.bY())_js.Trace.logInfo(_a.a.a,"Not discarding a loaded draft for context {0}",r);else if(i.bV())_js.Trace.logInfo(_a.a.a,"Not discarding an explicitly saved draft for context {0}",r);else if(u.c().e())_js.Trace.logInfo(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",r);else if(u.e().a())_js.Trace.logInfo(_a.a.a,"Not discarding a draft currently being sent for context {0}",r);else{var e=!1;if(t)_js.Trace.logInfo(_a.a.a,"Skipping dirty check for context {0}",r);else{_js.Trace.logInfo(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away. Context:{0}",i);e=u.bx()}if(e)_js.Trace.logInfo(_a.a.a,"Not discarding a dirty draft for context {0}",r);else if(i.ee)if(i.ee.q(i.ed())){if(_g.j.b&&i.bd()&&!i.i()){_js.Trace.logInfo(_a.a.a,"Calling main window to remember the pending discard for context {0}",r);_g.j.b.hK(r,!i.bV());f=!0}else if(!i.A()){_js.Trace.logInfo(_a.a.a,"Discarding unused draft for context {0}",r);this.b(r,o,u.W,i.bV());f=!0}}else _js.Trace.logInfo(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",r);else _js.Trace.logInfo(_a.a.a,"Not discarding without an initial baseline for context {0}",r)}return f},b:function(n,t,i,r){i||(i=new _mcp.G(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.a(t,u);i.a(f,null,null,null);delete this.e[n];_js.Trace.logInfo(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.e[n]=new _mcp.K(u);_js.Trace.logInfo(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.G(new _bc.b),!1)}};_mcp.b=function(){_mcp.b.initializeBase(this)};_mcp.b.$$cctor=function(){_mcp.b.h.b(_mcp.b.f);_mcp.b.e.b(_mcp.b.f);_mcp.b.d.b(_mcp.b.f);_mcp.b.c.b(new _a.bs(_g.Attachment));_mcp.b.g.b(new _a.bs(_g.bM))};_mcp.b.b=function(n){var t=new _mcp.b;_mcp.b.z(t,n);return t};_mcp.b.z=function(n,t){n.K(t.w());n.s(t.L());if(t.h()){n.B(new _js.f);n.e().p(t.h().g())}else n.B(null);n.L(t.bg());if(t.n()){n.x(new _js.f);n.d().p(t.n().g())}else n.x(null);n.D(t.Y());if(t.c()){n.w(new _js.f);n.c().p(t.c().g())}else n.w(null);if(t.x()){n.p(new _js.f);n.b().p(t.x().g())}else n.p(null);if(t.M()){n.y(new _js.f);n.r().p(t.M().g())}else n.y(null);n.C(t.K());n.A(t.ba());n.z(t.j());n.E(t.p());n.H(t.C());n.F(t.bb());n.G(t.bc());n.I(t.q());n.J(t.E())};_mcp.b.a=function(n,t,i,r){if(i!==r&&!(_js.d.a(i)&&_js.d.a(r))||!_mcp.b.x(n,t))return!1;if($a(n)||$a(t))return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.b.i(e,f))return!1}return!0};_mcp.b.i=function(n,t){return $a(n)&&!$a(t)||$a(t)&&!$a(n)?!1:$a(n)&&$a(t)?!0:_g.o.b(n,t)};_mcp.b.x=function(n,t){var r=_mcp.b.y(n);var i=_mcp.b.y(t);return r===i};_mcp.b.y=function(n){return $a(n)?0:n.b()};_mcp.b.w=function(n,t){if(!_mcp.b.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.b.B(u,r))return!1}return!0};_mcp.b.A=function(n,t){return _h.cL.a(n,t)};_mcp.b.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bl.AttachmentId&&t.bl.AttachmentId||!t.bl.AttachmentId&&n.bl.AttachmentId?!1:n.bl.AttachmentId&&n.bl.AttachmentId.Id!==t.bl.AttachmentId.Id?!1:n.bl.Name!==t.bl.Name?!1:n.bl.ContentType!==t.bl.ContentType?!1:n.bl.ContentId!==t.bl.ContentId?!1:n.bl.ContentLocation!==t.bl.ContentLocation?!1:n.a()!==t.a()?!1:!n.o()&&t.o()||!t.o()&&n.o()?!1:n.o()&&!n.o().bd(t.o())?!1:n.b()!==t.b()?!1:!0};_mcp.b.prototype={f:function(){return this.dS(_mcp.b.u)},K:function(n){this.dR(_mcp.b.u,n);return n},a:function(){return this.dS(_mcp.b.m)},s:function(n){this.dR(_mcp.b.m,n);return n},e:function(){return this.dS(_mcp.b.h)},B:function(n){this.dR(_mcp.b.h,n);return n},j:function(){return this.dS(_mcp.b.v)},L:function(n){this.dR(_mcp.b.v,n);return n},d:function(){return this.dS(_mcp.b.e)},x:function(n){this.dR(_mcp.b.e,n);return n},h:function(){return this.dS(_mcp.b.k)},D:function(n){this.dR(_mcp.b.k,n);return n},c:function(){return this.dS(_mcp.b.d)},w:function(n){this.dR(_mcp.b.d,n);return n},g:function(){return this.dS(_mcp.b.j)},C:function(n){this.dR(_mcp.b.j,n);return n},i:function(){return this.dS(_mcp.b.o)},A:function(n){this.dR(_mcp.b.o,n);return n},l:function(){return this.dS(_mcp.b.n)},z:function(n){this.dR(_mcp.b.n,n);return n},k:function(){return this.dS(_mcp.b.l)},E:function(n){this.dR(_mcp.b.l,n);return n},o:function(){return this.dS(_mcp.b.r)},H:function(n){this.dR(_mcp.b.r,n);return n},m:function(){return this.dS(_mcp.b.p)},F:function(n){this.dR(_mcp.b.p,n);return n},n:function(){return this.dS(_mcp.b.q)},G:function(n){this.dR(_mcp.b.q,n);return n},u:function(){return this.dS(_mcp.b.s)},I:function(n){this.dR(_mcp.b.s,n);return n},v:function(){return this.dS(_mcp.b.t)},J:function(n){this.dR(_mcp.b.t,n);return n},b:function(){return this.dS(_mcp.b.c)},p:function(n){this.dR(_mcp.b.c,n);return n},r:function(){return this.dS(_mcp.b.g)},y:function(n){this.dR(_mcp.b.g,n);return n},t:function(n){if(this.i()!==n.ba()){_js.Trace.logInfo(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.ba());return!1}if(this.f()!==n.w()){_js.Trace.logInfo(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$a(this.f())?0:this.f().length,$a(n.w())?0:n.w().length);return!1}if(this.k()!==n.p()){_js.Trace.logInfo(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.p());return!1}if(this.o()!==n.C()){_js.Trace.logInfo(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.C());return!1}if(this.m()!==n.bb()){_js.Trace.logInfo(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.bb());return!1}if(this.n()!==n.bc()){_js.Trace.logInfo(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.bc());return!1}if(this.u()!==n.q()){_js.Trace.logInfo(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.q());return!1}if(this.v()!==n.E()){_js.Trace.logInfo(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.E());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.j()?n.j().Mailbox:null;if(!_mcp.b.i(i,t)){_js.Trace.logInfo(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.b.a(this.e(),n.h(),this.j(),n.bg())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.e())?0:this.e().x.length,$a(n.h())?0:n.h().b(),$a(this.j())?0:this.j().length,$a(n.bg())?0:n.bg().length);return!1}if(!_mcp.b.a(this.d(),n.n(),this.h(),n.Y())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.d())?0:this.d().x.length,$a(n.n())?0:n.n().b(),$a(this.h())?0:this.h().length,$a(n.Y())?0:n.Y().length);return!1}if(!_mcp.b.a(this.c(),n.c(),this.g(),n.K())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.c())?0:this.c().x.length,$a(n.c())?0:n.c().b(),$a(this.g())?0:this.g().length,$a(n.K())?0:n.K().length);return!1}if(!_mcp.b.w(this.b(),n.x())){_js.Trace.logInfo(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.x()?n.x().b():0));return!1}if(!_mcp.b.A(this.r(),n.M())){_js.Trace.logInfo(_a.a.a,"snapshotExtendedPropertyCount="+(this.r()?this.r().x.length:0)+", contextExtendedPropertyCount="+(n.M()?n.M().x.length:0));return!1}if(this.a()!==n.L()){_js.Trace.logInfo(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$a(this.a())?0:this.a().length,$a(n.L())?0:n.L().length);return!1}_js.Trace.logInfo(_a.a.a,"Context is clean");return!0},q:function(n){if(!n){_js.Trace.logInfo(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_js.Trace.logInfo(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_js.Trace.logInfo(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_js.Trace.logInfo(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_js.Trace.logInfo(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_js.Trace.logInfo(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_js.Trace.logInfo(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.b.i(i,t)){_js.Trace.logInfo(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.b.a(this.e(),n.e(),this.j(),n.j())){_js.Trace.logInfo(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().x.length:0,n.e()?n.e().x.length:0,this.j(),n.j());return!1}if(!_mcp.b.a(this.d(),n.d(),this.h(),n.h())){_js.Trace.logInfo(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().x.length:0,n.d()?n.d().x.length:0,this.h(),n.h());return!1}if(!_mcp.b.a(this.c(),n.c(),this.g(),n.g())){_js.Trace.logInfo(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().x.length:0,n.c()?n.c().x.length:0,this.g(),n.g());return!1}if(!_mcp.b.w(this.b(),n.b())){_js.Trace.logInfo(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_js.Trace.logInfo(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_js.Trace.logInfo(_a.a.a,"snapshot is clean");return!0}};_mcp.bt=function(n,t){this.g=Function.createDelegate(this,this.i);if($a(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.bt.prototype={f:0,d:null,a:null,b:!1,c:function(){!this.a&&this.b&&(this.a=_js.g.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_js.Trace.logInfo(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_js.Trace.logInfo(_a.a.a,"Clearing timer.");this.a=_js.g.a().b(this.a)}},i:function(){_js.Trace.logInfo(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt){this.cm=Function.createDelegate(this,this.dF);this.cP=Function.createDelegate(this,this.ed);this.bT=Function.createDelegate(this,this.da);this.cN=Function.createDelegate(this,this.cT);this.cn=Function.createDelegate(this,this.dG);this.cO=Function.createDelegate(this,this.dB);this.co=Function.createDelegate(this,this.N);_mcp.d.resolveInheritance();this.G=this.dispose;_mcp.d.initializeBase(this);_a.b.b(k,"nativeBridge");this.bL=4;this.L=n;this.U=t||new _bc.b;this.U.x(g);this.M=this.bb();this.cv=i;this.bM=r;this.cb=u;this.W=new _mcp.G(this.U);this.cL=f;this.bK=s;this.ch=e;this.X=o;this.bq=h;this.bc=c;this.T=l;this.bv=v;this.cw=p;this.cs=a;this.cF=w;this.bd=b;this.ca=y;this.cJ=k;this.bu=d;this.Y=g;this.cK=nt;this.cI=tt;this.cp=it;this.cq=rt;this.cr=ut;this.ct=ft;this.by=et;this.bC=ot;this.cB=st;this.bP=ht;this.bD=ct;this.cg=lt;this.cH=at;this.cM=vt;this.bi=yt;this.bY=pt;if(o){var wt=o;this.bt=wt.w||(wt.w=Function.createDelegate(wt,wt.d))}this.Y||(this.bJ=!0);this.X&&this.X.a()==="Mouse"&&this.dD();this.bU=!0;this.bW=!0;_js.Trace.logInfo(_a.a.a,"ViewModel created")};_mcp.d.a=function(){return+new Date+":"+Math.random()};_mcp.d.prototype={cv:null,L:null,bM:null,cb:null,cL:null,ch:null,bK:null,U:null,X:null,bv:null,cw:null,cM:null,bq:null,T:null,bc:null,ca:null,cJ:null,cF:null,cg:null,bu:null,cp:null,cq:null,cr:null,ct:null,Y:null,cK:null,by:null,bC:null,cB:null,bi:null,cs:null,cI:null,bP:null,bD:null,bY:null,cH:null,cf:null,M:null,bI:!1,bO:!1,ck:null,ci:!1,bh:!1,bL:0,bJ:!1,cj:!1,bN:!1,bp:null,bl:null,bZ:null,a:function(){return this.L},dH:function(n){if(this.M!==n){this.M=n;this.dQ("InfoBarViewModel")}return n},bG:function(){_a.b.d(this.bP.c(),"MailComposeViewModel: Smime override factory has not been created");return this.bP.b()},bf:function(){return this.P.b(0)},z:function(){return this.P.b(10)},b:function(){return this.P.b(2)},S:function(){return this.P.b(5)},cZ:function(){return this.P.b(11)},dw:function(){return this.P.b(4)},Q:function(){return this.P.b(1)},cV:function(){return this.P.b(6)},e:function(){return this.P.b(7)},c:function(){return this.P.b(8)},bB:function(){return this.P.b(9)},bs:function(){return this.P.b(16)},ce:function(){return this.P.b(18)},bE:function(){return this.P.b(3)},cE:function(){return this.P.b(17)},dx:function(){return this.P.b(31)},cX:function(){return this.P.b(23)},bg:function(){return this.P.b(19)},be:function(){return this.P.b(22)},cC:function(){return this.P.b(24)},bk:function(){return this.P.b(25)},bw:function(){return this.P.b(12)},dA:function(){return this.P.b(27)},du:function(){return this.P.b(28)},dt:function(){return this.P.b(29)},W:null,d:function(){return this.Y},bF:function(){return!this.X.c()||!!this.Y},dd:function(n){if(this.cj!==n){this.cj=n;this.dQ("ShouldShowModernAttachmentsIntroductionPeek")}return n},V:function(){return!1},cD:function(){return"MailCompose"},cW:function(){return!1},bA:function(){var t=this.bF();var n=new _a.r;n.c("P",t);n.b("I",t?this.cd().toString():"NA");n.b("ET",this.L.eK);return n},dj:function(){return this.bF()||this.X.h()},dI:function(n){if(this.bJ!==n){this.bJ=n;this.dQ("IsReadyForViewInitialization")}return n},cd:function(){return!!this.Y},bm:function(){return this.bL},dc:function(n){if(this.bL!==n){this.bL=n;this.dQ("PopupPanelSize")}return n},q:function(){if(this.z()){var n=this.z();return n.b||(n.b=Function.createDelegate(n,n.g))}else return this.cO},n:function(){return this.cf},f:function(n){_js.Trace.logInfo(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.cf?"non-null":"null",n?"non-null":"null");this.cf=n;return n},bU:!1,bn:function(){return this.bU},C:function(n){this.bU=n;return n},bW:!1,F:function(n){this.bW=n;return n},dm:function(){return this.bi.f()},dk:function(){return this.bi.d()},dr:function(){return this.bi.i()},dn:function(){return this.bi.e()},dq:function(){return this.bi.b()},j:function(){return this.X.a()==="Mouse"?0:1},di:function(){return this.bi.A()},bV:!1,x:function(){return this.bV},E:function(n){this.bV=n;return n},db:function(n){if(this.bI!==n){this.bI=n;this.dQ("IsInView")}return n},bX:!1,m:function(n){this.bX=n;return n},de:function(n){var t=this.cY();if(this.bO!==t){this.bO=t;this.dQ("ShouldShowToolbarMessage")}return n},df:function(n){if(this.ck!==n){this.ck=n;this.dQ("ToolbarMessage")}return n},P:null,dJ:function(n){var t=this.cY();if(t!==this.ci){this.ci=t;this.dQ("ShouldBlockView")}return n},D:function(n){if(this.bh!==n){this.bh=n;this.dQ("IsNavigatingAway")}return n},cY:function(){return this.b()&&(this.b().j()||this.b().i())?!0:this.e()&&this.e().a()?!0:!1},cU:function(){return!this.bi.h()},bd:null,cQ:null,h:function(n){this.cQ=n;return n},bt:null,y:function(n){this.bt=n;return n},g:function(){var n=this.P.b(29);n.C()||n.d();return n.a()},bH:function(){return this.L.fR()},l:function(n){if(this.bN!==n){this.bN=n;this.dQ("SharedCommandingBarShown")}return n},cc:function(){return!!this.bv&&this.bv.a().f().Enabled&&this.X.a()==="Mouse"},R:function(){this.bZ||(this.bZ=new _cmc.U);return this.bZ},dG:function(n,t){if(this.L.t()){this.K();this.P.r()}else{this.J();this.P.m()}},dh:function(){this.L.apcl(_mcp.a.c,this.cn)},K:function(){if(this.bH()&&!this.bl){_js.Trace.logInfo(_a.a.a,"Setting mail compose viewmodel override");this.bl=this.bG().c();this.bl.b(this.M)}},J:function(){if(this.bl){this.bl.a();this.bl=null}},N:function(){this.bk().e();this.Q().ea()},cG:function(){this.L.b()&&(this.L.en()||this.L.eH())||this.L.fd(_mcp.d.a());_js.Trace.logInfo(_a.a.a,"Init:Context:{0}",this.L);this.P||(this.P=new _mcp.be(this,this.cs,this.bv,this.ca,this.cw,this.cF,this.cJ,this.Y,this.cI,this.cp,this.cq,this.cr,this.bD,this.cH,this.bi,this.bY));if(this.bH()){_js.Trace.logInfo(_a.a.a,"Creating Smime override factory");this.cu(this.cN)}else this.cT()},cu:function(n){_js.Trace.logInfo(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.bP.a(function(i){_js.Trace.logInfo(_a.a.a,"Smime override factory created");i.f(t.L,t.T);_js.Trace.logInfo(_a.a.a,"Calling createFactoryCallback");n()})},cT:function(){_js.Trace.logInfo(_a.a.a,"Completing initialization");this.K();this.dh();if(this.M){this.M.o();this.T.a(_y.dA,new _y.dA);this.L.eH()&&this.cR(this.L.fN())}this.D(!1);this.P.b(0).d();if(!this.Y){this.X.n(this.bT);this.X.k(this.bT);_js.Trace.logInfo(_a.a.a,"Before unload handler has been hooked up")}},cR:function(n){n===90||n===91||n===92||n===94?this.M.d(n,null,_u.R.Re,this.cP):this.M.a(n,null)},ed:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.M.b(90);this.M.b(91);this.M.b(92);this.M.b(93);this.M.b(94)},dK:function(n){this.ds(n);_js.Trace.logInfo(_a.a.a,"Set screen view model appbar. ContextId={0}",this.L.b())},dO:function(n){this.dy(n);_js.Trace.logInfo(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.L.b())},cx:function(){_y.hJ.prototype.cx.call(this);var n=this.bf();if(n.C()){_js.Trace.logInfo(_a.a.a,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.L()}else _js.Trace.logInfo(_a.a.a,"PostTransitionIn view model, not initialized yet");this.db(!0);if(this.L.eH()&&this.L.bX()){var i=this.L.b();this.T.a(_y.eF,new _y.eF(i))}(this.L.a()||this.X.a()!=="TouchNarrow")&&this.L.et&&this.L.et();if(this.X.a()==="Mouse"){var t=this;_js.g.a().c(_a.a.c,"PreloadOwaFilePicker",function(){var n=t.S();n&&n.q()})}if(this.L.eu){this.L.eu(this);this.L.eu=null}this.R().i(this.cD())},cy:function(){_js.Trace.logInfo(_a.a.a,"Post transition out");if(this.e().e()){var n=this.e().e();n.j=this.L.bX()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.d.a(n)}this.db(!1);this.R().d();if(!this.e().i()){if(this.bX){this.Q().bd();this.L.ei.a()}this.k()}_y.hJ.prototype.cy.call(this)},k:function(){_js.Trace.logInfo(_a.a.a,"Calling reset on the mail compose view model, context:{0}",this.L);this.J();this.L.rpcl(_mcp.a.c,this.cn);if(this.P){var n=this.b();if(n&&n.h()){this.P.k();this.L&&!this.bX&&this.L.cW();this.M&&this.M.c.f();this.be()&&this.be().h&&this.be().h.e(!1);this.Y||this.X.n(this.bT);this.bt=null;n.f(!1)}else _js.Trace.logWarning(_a.a.a,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.a.a,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.bV=!1},bx:function(){if(this.S().b()){_js.Trace.logInfo(_a.a.a,"Dirty due to attachment in progress");return!0}var n=this.P.b(1);n.bd();return this.L.fs()},bb:function(){$a(this.M)&&this.dH(new _y.t);return this.M},A:function(){_h.u.k()},B:function(){_h.u.g()},dP:function(){this.bl&&this.bl.c()},I:function(){this.dI(!0)},H:function(){var n=new _y.eM;this.da(n);return n.b},da:function(n){this.b().g(n);this.R().d()},o:function(){this.R().d()},dg:function(){this.bF()&&this.L&&!_js.d.a(this.L.w())&&!this.Y&&(document.title=this.L.w())},dT:function(){_js.Trace.logInfo(_a.a.a,"Disposing view model, context: {0}",this.L?this.L:"null");this.P&&this.P.k();this.bp&&this.bp.e(this.cm);this.dv&&_ms.b.isInstanceOfType(this.dv)&&this.dv.dispose();_a.jV.prototype.dT.call(this)},cS:function(){this.bp&&this.bp.a(!0)},dD:function(){if(this.cg&&this.bv&&this.bD&&_y.k.b(9)&&this.ca.d(this.bD.AttachmentDataProviderAvailable)&&!this.bv.a().d().Enabled){var t=this.bY.c()?_u.R.Go:_u.R.GP;var n=this;this.cg.a(function(i){n.bp=i.a(_u.R.MS,t,10,null,null,9);n.dd(!0);n.bp.d(n.cm);n.bp.b()})}},dF:function(){this.dd(!1)},dB:function(n,t){return t===1?!this.bW:!1}};_mcp.e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt){_mcp.e.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt])};_mcp.e.prototype={V:function(){return!0},cD:function(){return"MailInlineCompose"}};_mcp.g=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt){_mcp.g.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt])};_mcp.g.prototype={V:function(){return!0},cW:function(){return!0},cD:function(){return"GroupInlineCompose"},bR:null,t:function(n){this.bR=n;return n},bS:!1,w:function(n){this.bS=n;return n},bj:null,r:function(n){this.bj=n;return n},bz:null,cl:null,p:function(n){this.cl=n;return n}};_mcp.h=function(n,t){this.b=n;this.c=t};_mcp.h.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.h.prototype={b:null,e:null,c:!1,a:null,f:null,d:null,g:function(){!this.e&&this.b&&(this.e=_a.G.a(this.b.EmailAddress));return this.e},l:function(n){if(!this.c)return n.val.h();_js.Trace.logInfo(_mcp.h.a,"begin calculating initial audience");var t=new _js.f;this.a={};if(this.b){_js.Trace.logInfo(_mcp.h.a,"adding always keep address "+this.g()+" as the first To recipient");t.a(this.b);this.a[this.g()]=0}this.h(t,n.val.h(),0);this.h(t,n.val.n(),1);_js.Trace.logInfo(_mcp.h.a,"end calculating initial audience");this.k(t,n);return t},n:function(n,t){_rw.b.isInstanceOfType(n)&&(this.f=n);this.d=t},k:function(n,t){if(!this.c||!n){t.val.r(n);return}for(var f=new _js.f,e=new _js.f,o=n.x.length,r=0;r<o;r++){var i=n.x[r];var u=_mcp.h.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_js.Trace.logInfo(_mcp.h.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.r(f);t.val.bh(e);if(this.d){this.d.q(e);_js.Trace.logInfo(_mcp.h.a,"Update Cc recipient well with the separated Cc recipients")}},m:function(n,t){if(this.c){var i=t.c;_js.Trace.logInfo(_mcp.h.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.i(r);break;case 2:this.j(u);break;case 3:this.j(u);this.i(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},j:function(n){if(n)for(var u=n.length,r=0;r<u;r++){var f=n[r].j.a();var t=_mcp.h.b(f);_js.Trace.logInfo(_mcp.h.a,"recording removed recipient "+t);if(t in this.a)if(t===this.g()){var i=this;_js.g.a().a(_mcp.h.a,"ProcessAlwaysKeepRecipients",function(){if(i.f){_js.Trace.logInfo(_mcp.h.a,"adding the always keep address "+t+" back in To well");i.f.ba(i.b)}},0)}else{_js.Trace.logInfo(_mcp.h.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},i:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].j.a();var i=_mcp.h.b(u);_js.Trace.logInfo(_mcp.h.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},h:function(n,t,i){var e=t?t.b():0;_js.Trace.logInfo(_mcp.h.a,"merging "+e+" "+_mcp.Y.toString(i)+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.h.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.W=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.L);this.A=Function.createDelegate(this,this.E);this.H=Function.createDelegate(this,this.J);_mcp.W.initializeBase(this);this.D=f;this.k=f.a;this.o=n;this.v=t;this.l=f.e;this.z=i;this.C=r;this.G=u};_mcp.W.prototype={v:null,o:null,k:null,l:null,D:null,z:null,C:null,G:null,p:null,m:0,y:!1,t:null,n:null,q:null,w:!1,f:function(){$a(this.p)&&(this.p=new _y.bf);return this.p},e:function(n){this.p=n;return n},x:function(){return this.l?this.l.bM():null},B:null,j:function(n){this.B=n;return n},c:function(n){_a.y.stPT(_a.a.z,"MailComposeReplyLoad",3);this.w=!0;this.n=_y.j.b(_a.a.z,"MailComposeReply",!0);this.q=_y.j.b(_a.a.z,"MailComposeReplyLoad",!0);this.o.f("Inference.Reply",this.k.bl.ItemId,this.k.bl.ConversationId,this.l?this.l.G():null,this.x());this.r(1,n)},d:function(n){_a.y.stPT(_a.a.z,"MailComposeReplyAllLoad",3);this.w=!0;this.n=_y.j.b(_a.a.z,"MailComposeReplyAll",!0);this.q=_y.j.b(_a.a.z,"MailComposeReplyAllLoad",!0);this.o.f("Inference.ReplyAll",this.k.bl.ItemId,this.k.bl.ConversationId,this.l?this.l.G():null,this.x());this.r(2,n)},h:function(n){this.y=!0;this.d(n)},b:function(n){this.o.a("Inference.PostReply",this.k.bl.ItemId,this.x());this.r(12,n)},a:function(n){_a.y.stPT(_a.a.z,"MailComposeForwardLoad",3);this.w=!0;this.n=_y.j.b(_a.a.z,"MailComposeForward",!0);this.q=_y.j.b(_a.a.z,"MailComposeForwardLoad",!0);this.o.f("Inference.Forward",this.k.bl.ItemId,this.k.bl.ConversationId,this.l?this.l.G():null,this.x());this.r(3,n)},g:function(n){this.y=!0;this.a(n)},i:function(){if(!this.D.o())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _c.bs(this.k.bl.ItemId.Id,t.Id);n.w(this.H);n.v(this.A);OwaApplication.a.a(n)},J:function(n){var i=n.d;if(i.length>0){var t=this.C.e(_g.g.b(i));t.w(this.I);t.v(this.A);OwaApplication.a.a(t)}else this.E(n)},E:function(n){this.l.E().b(9500);this.l.E().a(9500)},L:function(n){var t=n;if(t.a){this.l.E().b(9500);var i=this.z.b(t.e[0],!1,t.a.cJ(),t.a.by());_y.c.a.c()||i.o(0);this.f().a(i)}else this.E(n)},r:function(n,t){this.m=n;this.M(t)},M:function(n){var u=_g.i.isInstanceOfType(this.k);n||(n=!_y.c.a.c());var t=this.z.a(n,!1);t.U(this.w);n&&t.o(0);var r=null;switch(this.m){case 1:r=!t.l()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:r=!t.l()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:r=!t.l()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(r&&this.n){this.n.p=r;t.G(this.n);t.T(this.q);t.bq()}t.dB(this.k.bl.ParentFolderId);this.l&&t.dC(this.l.bT());t.e(this.m);t.dv(!0);t.ey=this.y;t.k(!t.ey||this.m===3);var i=new _g.bh;i.Mailbox=new _g.d;i.Mailbox.EmailAddress=this.v.c().bl.UserEmailAddress;i.Mailbox.Name=this.v.c().bl.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.dF(i);t.et=this.B;if(u){var o=this.k;if(o.bS())t.N(o);else{t.dt(!0);t.co(this.k.bl.ItemId);t.cl(_g.i.d(o))}}else t.N(this.k);if((this.m===1||this.m===2)&&_g.r.isInstanceOfType(this.k)){var e;var f=this.k;var l=this.F(f.o())+this.F(f.m())+this.F(f.k());e=this.m===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.d.b(_a.a.z,e);c.j=l.toString();_a.d.a(c)}if((_g.r.isInstanceOfType(this.k)||u)&&t.eU(this.k)){var s=_a.j.d();s&&t.gl(this.k.di());if(this.k.bT()||t.t()&&s){var h=this;this.K(function(n){n.b(t,h.k,h.m)})}else this.f().a(t)}else this.f().a(t)},K:function(n){_js.Trace.logInfo(_a.a.g,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.G.a(function(i){if(!t.t){_js.Trace.logInfo(_a.a.g,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");t.t=i.f();t.t.a(t,t.v,function(n,t){var i=new _cc.L(200,_cc.L.a(n.bl.ItemId,t.bZ()));i.I=t.b();return i},function(n,t,i){var r=new _mcp.by(n,t,i);return r.toString()})}_js.Trace.logInfo(_a.a.g,"[MailResponseViewModel] Executing smime operation.");n(t.t)})},F:function(n){return n?n.b():0}};_mcp.X=function(n,t,i,r,u){this.c=n;this.f=t;this.d=i;this.b=r;this.e=u};_mcp.X.prototype={c:null,f:null,d:null,b:null,e:null,a:function(n){return new _mcp.W(this.c,this.f,this.d,this.b,this.e,n)}};_mcp.D=function(){_mcp.D.initializeBase(this)};_mcp.D.prototype={c:null,d:"Normal",e:!1,f:!1,a:!1,b:!1,i:!1,j:!1,g:null,h:!1,k:!1,l:!1,r:function(){if($a(this.c)){this.c=new _js.f;this.c.a("Normal");this.c.a("Personal");this.c.a("Private");this.c.a("Confidential")}return this.c},o:function(n){if(this.d!==n){this.d=n;this.dQ("Sensitivity")}return n},m:function(n){if(this.e!==n){this.e=n;this.dQ("IsDeliveryReceiptRequested")}return n},n:function(n){if(this.f!==n){this.f=n;this.dQ("IsReadReceiptRequested")}return n},w:function(n){if(this.h!==n){this.h=n;this.dQ("ShowSmimeOptions")}return n},p:function(n){if(this.a!==n){this.a=n;this.dQ("SmimeEncryptMessage")}return n},q:function(n){if(this.b!==n){this.b=n;this.dQ("SmimeSignMessage")}return n},x:function(n){if(this.i!==n){this.i=n;this.dQ("SmimeEncryptMessageIsEnabled")}return n},y:function(n){if(this.j!==n){this.j=n;this.dQ("SmimeSignMessageIsEnabled")}return n},z:function(n){if(this.l!==n){this.l=n;this.dQ("WaitingForPreviousAction")}return n},v:function(n){if(this.g!==n){this.g=n;this.dQ("Conductor")}return n},t:function(n){this.k=n.t();this.w(_a.j.a&&_a.j.k()&&n.cU());this.z(!1);this.o(n.C());this.m(n.bb());this.n(n.bc());this.p(n.q());this.q(n.E());this.x(n.cO());this.y(n.cP())}};_mcp.K=function(n){this.a=n};_mcp.K.prototype={a:!1};_mcp.bx=function(n,t){this.a=n;this.b=t};_mcp.bx.prototype={a:null,b:null};_mcp.by=function(n,t,i){this.i=new RegExp("<","g");this.h=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.by.prototype={e:0,a:null,d:!1,toString:function(){_js.Trace.logInfo(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.m();var t=this.f(!0);var r=this.f(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.R.Nw,r,t));var o=this.a.cq()||this.a.cy();var w=o?o.toString():this.a.hU();var h=this.g(!0);var e=this.g(!1);var i,n;var s,u;this.n(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.cO,t);var k=this.b(_nbs.a.Jt,w);var b=h?this.b(_u.R.NV,h.join("; ")):null;var y=e?this.b(_u.R.QZ,e.join("; ")):null;var l=this.b(_u.P.X,a);var c=i?this.b(_u.P.N,i):null;var v=n?this.b(_u.P.I,n):null;var f=this.j(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},j:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _ff.e,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_js.d.a(i)||f.c(i)}return f.i()},m:function(){if(this.a.bl.Subject)return this.a.bl.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.R.JW;break;case 3:n=_nbs.a.QB;break;case 5:n=_nbs.a.Ts;break;case 6:n=_nbs.a.eP;break;case 7:n=_nbs.a.cG;break;case 8:n=_nbs.a.RE;break;case 9:n=_nbs.a.jv;break;case 10:n=_nbs.a.MX;break;default:n="";break}return String.format(_nbs.a.fq,n,this.a.cK()||_u.R.Tp)}},f:function(n){if(_g.r.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bl.From:r.bl.Sender;return i?this.c(i.Mailbox):null}else if(_g.i.isInstanceOfType(this.a)){var t=this.a;return t.bl.Organizer?this.c(t.bl.Organizer.Mailbox):null}else return null},g:function(n){if(_g.r.isInstanceOfType(this.a)){var i=this.a;return this.l(n?i.k():i.m())}else if(_g.i.isInstanceOfType(this.a)){var t=this.a;return this.k(n?t.p():t.s(),n)}else return null},n:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_g.bk.isInstanceOfType(this.a)){var f=this.a;i=f.v();r=f.eN()}else if(_g.i.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=new _cc.bf;n.val=e.a(r,null)||" "}i&&(t.val=i.r()?i.r().bl.DisplayName||" ":" ")},l:function(n){if(!n||!n.b())return null;var t=new _ff.e;var i=this;n.o(function(n){t.c(i.c(n))});return t.i()},k:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bl.Organizer.Mailbox)]:null;var i=new _ff.e;var r=this;n.o(function(n){i.c(r.c(n.bl.Mailbox))});return i.i()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.o(t):n+" "+t},o:function(n){if(!n)return null;n=n.replace(this.i,"&lt;");n=n.replace(this.h,"&gt;");return n}};_mcp.B=function(n){_mcp.B.initializeBase(this);this.a=n};_mcp.B.prototype={a:null,s:function(n){var i=this.c();var t=new _g.BE(this.x);t.explicitLogonUser=this.a.J;$a(this.a.f)||t.actionName||(t.actionName=this.a.f);n.dn(i,t,this.r,this.q)},c:function(){var t=this.a.bT();var i=new _g.nq(this.y());var n=new _g.jt;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},P:function(n){_h.dY.prototype.P.call(this,n)},cp:function(n){this.a.bV(n)}};_mcp.ba=function(){};_mcp.ba.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.mH;break;case"Personal":i=_nbs.a.Sz;break;case"Private":i=_nbs.a.Kx;break;case"Confidential":i=_nbs.a.r;break;default:i=_nbs.a.mH;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.p=function(n){_mcp.p.initializeBase(this,[n])};_mcp.p.prototype={a:null,p:function(){},o:function(){},s:function(n){},q:function(n){},r:function(n){},v:function(n){},t:function(n,t){t.val=3;this.a.a();return!0}};_mcp.c=function(){};_mcp.c.J=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.K=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.L=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.I=function(){return _fm.b.a(_fm.a.bn,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.h=function(){return _fm.b.a(_fm.a.bn,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.z=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.o=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.v=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.w=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.c.i=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_mcp.c.j=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.d,"ms-fcl-nd-b")};_mcp.c.x=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.c.y=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.c.C=function(){return _fm.b.a(_fm.a.bK,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.E=function(){return _fm.b.a(_fm.a.bK,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.D=function(){return _fm.b.a(_fm.a.bK,_fm.WebfontSizes.a.b,"ms-fcl-nta-b")};_mcp.c.A=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.f=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.H=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.f,"ms-fcl-tp-b")};_mcp.c.g=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.s=function(){return _fm.b.a(_fm.a.bw,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.t=function(){return _fm.b.a(_fm.a.bw,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.p=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.h,"ms-fcl-ns-b")};_mcp.c.r=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.h,"ms-fcl-nd-b")};_mcp.c.q=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.h,"ms-fcl-nta-b")};_mcp.c.F=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.h,"ms-fcl-tp-b")};_mcp.c.a=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.b=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.c=function(){return _fm.b.a(_fm.a.bx,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.u=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.c.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.c.B=function(){return _fm.b.a(_fm.a.cP,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_mcp.c.k=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-ns-b")};_mcp.c.m=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-nd-b")};_mcp.c.n=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-tp-b")};_mcp.c.l=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-nta-b")};_mcp.c.G=function(){return _fm.b.a(_fm.a.h,"ms-fcl-ns-b")};_mcp.L=function(n){this.b=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.d);_mcp.L.initializeBase(this,[n]);this.a=!1;_y.c.a.o(this.c)};_mcp.L.prototype={a:!1,f:function(n){if(this.a!==n){this.a=n;this.bj("DisplayEllipsis")}return n},d:function(){var n=this;_js.g.a().c(_a.a.a,"MailComposeAggregatedRecipientWell.UpdateEllipsisState",function(){var i=n.z.childNodes&&n.z.childNodes.length>0?n.z.childNodes[0]:null;var t=i&&i.childNodes&&i.childNodes.length>1?i.childNodes[1]:null;var r=t&&t.childNodes&&t.childNodes.length>1?t.childNodes[1]:null;n.f(t?t.offsetWidth<r.offsetWidth:!1)})},K:function(){_js.b.prototype.K.call(this);this.d();if(this.E()&&_mcp.e.isInstanceOfType(this.E())){var n=this.E();n.Q().apcl("ShowAggregatedHeader",this.b)}},bI:function(n){_js.c.prototype.bI.call(this,n);if(this.E()&&_mcp.e.isInstanceOfType(this.E())){var t=this.E();t.Q().M(!1)}},bk:function(){if(this.E()&&_mcp.e.isInstanceOfType(this.E())){var n=this.E();n.Q().rpcl("ShowAggregatedHeader",this.b)}_y.c.a.q(this.c);_js.b.prototype.bk.call(this)},e:function(n,t){this.d()}};_mcp.i=function(n){_mcp.i.initializeBase(this,[n])};_mcp.i.prototype={a:null,b:function(){this.a&&_rw.d.a(this.a.B,this.a.B)},K:function(){_js.b.prototype.K.call(this);this.a=this.F?this.F.a("FromPersona"):null}};_mcp.l=function(n,t,i,r,u,f,e,o){this.dq=Function.createDelegate(this,this.gb);this.dr=Function.createDelegate(this,this.gc);this.bw=Function.createDelegate(this,this.fG);this.dV=Function.createDelegate(this,this.ey);this.cD=Function.createDelegate(this,this.eY);this.cF=Function.createDelegate(this,this.eZ);this.cu=Function.createDelegate(this,this.eS);this.cx=Function.createDelegate(this,this.eU);this.cz=Function.createDelegate(this,this.eW);this.cv=Function.createDelegate(this,this.eT);this.cB=Function.createDelegate(this,this.eX);this.cH=Function.createDelegate(this,this.fa);this.dW=Function.createDelegate(this,this.ej);this.cE=Function.createDelegate(this,this.ei);this.cy=Function.createDelegate(this,this.eV);this.dg=Function.createDelegate(this,this.fL);this.cL=Function.createDelegate(this,this.fq);this.df=Function.createDelegate(this,this.fK);this.bX=Function.createDelegate(this,this.fJ);this.bW=Function.createDelegate(this,this.fI);this.cU=Function.createDelegate(this,this.fy);this.bU=Function.createDelegate(this,this.fz);this.bt=Function.createDelegate(this,this.ft);this.bT=Function.createDelegate(this,this.fw);this.cZ=Function.createDelegate(this,this.em);this.dh=Function.createDelegate(this,this.fM);this.cS=Function.createDelegate(this,this.fv);this.cW=Function.createDelegate(this,this.fB);this.di=Function.createDelegate(this,this.fX);this.cO=Function.createDelegate(this,this.fs);this.cX=Function.createDelegate(this,this.fC);this.cY=Function.createDelegate(this,this.fD);this.dt=Function.createDelegate(this,this.en);this.ds=Function.createDelegate(this,this.ge);this.cK=Function.createDelegate(this,this.fp);this.cM=Function.createDelegate(this,this.fr);this.dd=Function.createDelegate(this,this.fF);this.dc=Function.createDelegate(this,this.fE);this.de=Function.createDelegate(this,this.fH);this.cP=Function.createDelegate(this,this.fu);this.dj=Function.createDelegate(this,this.fZ);this.dk=Function.createDelegate(this,this.ga);this.br=Function.createDelegate(this,this.eA);this.bZ=Function.createDelegate(this,this.gd);this.r=Function.createDelegate(this,this.ee);this.ct=Function.createDelegate(this,this.eB);this.dY=Function.createDelegate(this,this.fb);this.bV=Function.createDelegate(this,this.fA);this.cT=Function.createDelegate(this,this.fx);this.cV=Function.createDelegate(this,this.dE);this.dX=Function.createDelegate(this,this.ek);this.bY=Function.createDelegate(this,this.fY);this.dZ=Function.createDelegate(this,this.et);this.cJ=Function.createDelegate(this,this.fd);this.n={};_mcp.l.initializeBase(this,[n]);this.k=t;this.p=i;this.ca=r;this.o=u;this.bd=f;this.Q=e;this.dC=o;this.o&&this.o.a().h().Enabled&&this.bd.b(_cmc.o,this.cJ);this.a={};_js.Trace.logInfo(_a.a.a,"View created with layout={0}",this.k)};_mcp.l.prototype={x:!1,p:null,ca:null,o:null,d:null,m:null,c:null,bJ:null,j:null,bl:!1,cj:!1,cd:!1,cb:!1,bn:!1,bN:!1,bQ:!1,t:!1,cp:!1,bK:!1,bG:!1,ce:!1,bg:!1,dD:!1,Q:null,bd:null,dC:null,bC:!1,bf:function(){return this.a?this.a.EditorControl:null},ef:function(){return this.o.a().P().Enabled},eC:function(){var n;n=this.k==="TouchNarrow"?50:100;return n},eD:function(){var t=this.k==="Mouse"||this.dy()?1:3;var i=this.E();if(i)if(i.V())t=2;else{var n=i.L;this.k==="Mouse"||this.dy()||n.g()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},q:function(n){if(this.c!==n){this.gn(n,this.c);this.c=n;this.dF();this.go()}return n},eO:function(){return _y.c.a.h()||this.dz()?!1:this.cj},cn:function(n){if(this.cj!==n){this.cj=n;this.bj("IsToRecipientWellPeoplePickerButtonShown")}return n},eF:function(){return _y.c.a.h()||this.dz()?!1:this.cd},cl:function(n){if(this.cd!==n){this.cd=n;this.bj("IsCcRecipientWellPeoplePickerButtonShown")}return n},eE:function(){return _y.c.a.h()||this.dz()?!1:this.cb},ck:function(n){if(this.cb!==n){this.cb=n;this.bj("IsBccRecipientWellPeoplePickerButtonShown")}return n},eQ:function(){var n=this.E();return n&&n.L&&n.bf()?n.L.R()&&n.bf().e:!0},a:null,k:0,du:null,fi:function(){return!0},dH:function(n){if(this.bG!==n){this.bG=n;this.bj("IsReadyToShowContent")}return n},dI:function(n){if(this.bg!==n){this.bg=n;this.bj("IsReadyToShowEditor");this.bg&&this.dJ()}return n},dG:function(n){if(this.ce!==n){this.ce=n;this.bj("IsReadyToShowAppBarContent")}return n},s:function(n){if(this.bl!==n){this.bl=n;this.bj("ShouldPreventShiftTabDefault")}return n},gf:function(n){this.dD=n;this.bj("IsTabAnchorNeeded");return n},dy:function(){return this.ca.c()},eP:function(){return this.E()?this.E().bN:!1},eR:function(){return this.a.SubjectTextBox.B},eG:function(){return!!this.o&&this.o.a().h().Enabled},H:function(){return _a.a.a},dz:function(){return this.o.a().f().Enabled&&this.k==="Mouse"},ep:function(n){if(this.bC!==n){this.bC=n;this.bq();this.Z()}return n},gg:function(){this.bJ?this.b(this.bJ):this.gh()},gh:function(){if(!this.E()){_js.Trace.logInfo(_a.a.a,"No data context yet, skipping set initial focus");return}var n=this.E();if(this.gk()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to To well. Context:{0}",n.L);if(this.p.a()||this.p.d()){var r=this.a.ComposeViewContent;r.M(!1);this.dw();this.n&&this.n.ToRecipientWellControl&&this.n.ToRecipientWellControl.removeAttr("disabled");this.b("ToRecipientWellControl")}else{var i=this;_js.g.a().a(_a.a.a,"SetFocusToRecipientWell",function(){i.b("ToRecipientWellControl")},500)}}else if(this.gj()){_js.Trace.logInfo(_a.a.a,"Set initial focus to subject. Context: {0}",n.L);this.b("SubjectTextBox");if(this.p.b()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to subject for IE. Context:{0}",n.L);var t=this;_js.g.a().a(_a.a.a,"SetFocusToSubject",function(){t.b("SubjectTextBox")},500)}}else{_js.Trace.logInfo(_a.a.a,"Set initial focus to body. Context: {0}",n.L);if(this.p.b()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to body for IE. Context:{0}",n.L);_js.g.a().a(_a.a.a,"SetFocusToEditor",this.dZ,1500)}else this.et()}},gk:function(){var n=this.E();return n.Q().c.g()<1},gj:function(){return _js.d.a(this.a.SubjectTextBox.B.val())},g:function(n){},e:function(n){this.cp=!this.E();if(this.cp)_js.Trace.logInfo(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.E();var i=t.bf();if(i.C()){this.bK=!!this.a.EditorControl;this.bK?this.S()?t.cd()&&!t.bJ?t.apcl("IsReadyForViewInitialization",this.bY):this.bB():_js.Trace.logInfo(_a.a.a,"PostTransitionIn view not active yet. Context:{0}",t.L):_js.Trace.logInfo(_a.a.a,"PostTransitionIn template not applied yet. Context:{0}",t.L)}else this.eu(i,t.L);this.k==="Mouse"&&t.dg()}this.t=!0},h:function(){this.t=!1;_js.Trace.logInfo(_a.a.a,"PreTransitionOut view");var n=this.c;this.bJ=n;if(n&&n in this.a)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.dw();this.bn=!0;var t=this.n[n];if(t[0]===document.activeElement){_js.Trace.logInfo(_a.a.a,"Blur from {0}",n);t.blur()}this.c=null;this.bn=!1;break;case"EditorControl":this.bn=!0;this.a.EditorControl.cs();this.c=null;this.bn=!1;break}else _js.Trace.logInfo(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},f:function(){_js.Trace.logInfo(_a.a.a,"PostTransitionOut view");this.cn(!0);this.cl(!1);this.ck(!1);this.eo();this.dH(!1);this.dI(!1);this.dG(!1)},X:function(){this.v();return!0},bk:function(){_js.Trace.logInfo(_a.a.a,"Disposing view");this.bd.c(_cmc.o,this.cJ);this.gm();this.gp();this.dK();this.n=null;this.a=null;this.c=null;_js.b.prototype.bk.call(this)},K:function(){_js.b.prototype.K.call(this);var n=this.F;var t=null;this.E()&&(t=this.E());if(n){this.a.SubjectTextBox=n.a("SubjectTextBox");this.a.FromFieldControl=n.a("FromFieldControl");this.a.ToRecipientWellControl=n.a("ToRecipientWellControl");this.a.CcRecipientWellControl=n.a("CcRecipientWellControl");this.a.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.a.EditorControl=i;this.a.ComposeViewContent=n.a("ComposeViewContent");i.ho=!t.V();i.dk=t.V()?0:2;this.a.CancelConfirmDialog=n.a("CancelConfirmDialog");this.a.MessageBox=n.a("MessageBox");this.a.ComposeDockPanel=n.a("ComposeDockPanel");this.a.ToRecipientButton=n.a("ToRecipientButton");this.a.CcRecipientButton=n.a("CcRecipientButton");this.a.BccRecipientButton=n.a("BccRecipientButton");this.a.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.a.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.a.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.a.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");this.a.AttachmentWellViewWrapper=n.a("AttachmentWellViewWrapper");if(this.k==="Mouse"){this.a.SendButton=n.a("SendButton");this.a.DiscardButton=n.a("DiscardButton");this.a.InsertButton=n.a("InsertButton");this.a.AppsButton=n.a("AppsButton");this.a.AffordanceMenuButton=n.a("AffordanceMenuButton");this.a.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.a.ComposeAppsPane=n.a("ComposeAppsPane");this.x=t.L.f()==="HTML"}this.du=new _C(this.dX,this.H());this.gi();if(this.t&&!this.bK){_js.Trace.logInfo(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:{0}",t?t.L:"null");this.e(null)}else _js.Trace.logInfo(_a.a.a,"Applying template. Context:{0}",!t||!t.L?"null":t.L.toString());this.a.EditorControl&&this.a.EditorControl.apcl("IsPlainTextContent",this.cV)}else{_js.Trace.logInfo(_a.a.a,"Applying null template. Context:{0}",t?t.L.toString():"null");this.a.SubjectTextBox=null;this.a.FromFieldControl=null;this.a.ToRecipientWellControl=null;this.a.CcRecipientWellControl=null;this.a.BccRecipientWellControl=null;this.a.EditorControl=null;this.a.CancelConfirmDialog=null;this.a.MessageBox=null;this.a.ComposeDockPanel=null;this.a.AttachmentWellViewWrapper=null}this.ev()},bF:function(){var t=new _b.f(this.dC);t.i("ShowAddressBook");var r=this;t.k=new _C(function(){r.b("ToRecipientWellControl")},this.H());var n=new _fc.g;n.a([t]);var i=_js.c.prototype.bF.call(this);return i?i.concat(n):[n]},R:function(){_js.c.prototype.R.call(this);if(this.E()){var t=this.E();var i=t.L;var n=t.bf();i.apcl("IsUpgraded",this.cT);this.x=i.f()==="HTML";if(this.cp)if(n.C()){_js.Trace.logInfo(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: {0}",t.L);this.e(null)}else this.eu(n,i);n.i||n.apcl("IsSecondInitializationComplete",this.bV);t.Q().by=this.dY}else _js.Trace.logInfo(_a.a.a,"Updated DataContext to null")},J:function(){_js.b.prototype.J.call(this);if(this.t&&this.E()&&this.bK){var t=this.E();var n=t.bf();n.C()&&this.bB()}},P:function(){this.eo();_js.b.prototype.P.call(this)},dv:function(){var n=this.E();if(this.bQ){_js.Trace.logInfo(_a.a.a,"Events already bound. Context:{0}",n.L);return}if(this.p.a()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.ct);var u=this;_js.g.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",u.ct)},1e3)}this.d=new _ff.e;if(this.k==="Mouse"){this.d.c(new _mcp.l.a("DiscardButton",this.r));this.d.c(new _mcp.l.a("InsertButton",this.r));this.d.c(new _mcp.l.a("AppsButton",this.r));this.d.c(new _mcp.l.a("AffordanceMenuButton",this.r));this.d.c(new _mcp.l.a("OpenSeperateWindowButton",this.r));this.d.c(new _mcp.l.a("ToRecipientButton",this.r))}this.d.c(new _mcp.l.a("SubjectTextBox",this.r));this.d.c(new _mcp.l.a("FromFieldControl",this.r));this.d.c(new _mcp.l.a("ToRecipientWellControl",this.bZ));this.d.c(new _mcp.l.a("CcRecipientWellControl",this.bZ));this.d.c(new _mcp.l.a("BccRecipientWellControl",this.bZ));this.d.c(new _mcp.l.a("AttachmentWellViewWrapper",this.r));this.m=new _ff.e;this.m.c(new _mcp.l.a("FromFieldControl",this.br));this.m.c(new _mcp.l.a("ToRecipientWellControl",this.br));this.m.c(new _mcp.l.a("CcRecipientWellControl",this.br));this.m.c(new _mcp.l.a("BccRecipientWellControl",this.br));if(n.cd()){n.Y.addEventListener("focusin",this.dk,!0);n.Y.addEventListener("focusout",this.dj,!0)}else{for(var i=0;i<this.d.d.length;i++)this.a[this.d.d[i].a].B.bind("focusin",{uiComponent:this.d.d[i].a},this.d.d[i].b);for(var t=0;t<this.m.d.length;t++)this.a[this.m.d[t].a].B.bind("focusout",{uiComponent:this.m.d[t].a},this.m.d[t].b)}this.ed();this.a.CancelConfirmDialog.apcl("IsHidden",this.cP);this.a.MessageBox.apcl("IsHidden",this.de);this.Z();n.M.apcl("ActionPerformed",this.dc);n.M.apcl("Count",this.dd);n.S().m(this.cM);if(!$a(this.a.ComposeAppsPane)){this.a.ComposeAppsPane.apcl("IsHidden",this.cK);_y.c.a.o(this.ds);_y.c.a.o(this.dt);_g.a.a().b().E(this.cY)}if(this.Q.b(this.Q.f())&&this.k==="TouchWide"){var r=n.be().h;if(r){r.i(this.cX);r.r(this.cO)}}n.L.apcl("SelectedDataCallContext",this.di);n.L.apcl("EditorCallContext",this.cW);n.bf().apcl("CanLoadPopoutSuccessfully",this.cS);n.be().apcl("RequestCloseComposeForm",this.dh);this.a.FromFieldControl.apcl("IsHidden",this.cZ);this.a.CcRecipientWellControl.apcl("IsHidden",this.bT);this.a.BccRecipientWellControl.apcl("IsHidden",this.bt);this.bQ=!0},dK:function(){var n=this.E();if(n){var e=n.bf();e.rpcl("IsInitialized",this.bU);e.rpcl("IsSecondInitializationComplete",this.bV);var s=n.L;s.rpcl("IsUpgraded",this.cT)}if(!this.bQ){_js.Trace.logInfo(_a.a.a,"Events aren't bound. Context:{0}",n?n.L.toString():"null");return}if(this.a){"CancelConfirmDialog"in this.a&&this.a.CancelConfirmDialog.rpcl("IsHidden",this.cP);"MessageBox"in this.a&&this.a.MessageBox.rpcl("IsHidden",this.de);this.bq();this.a&&this.a.BccRecipientWellControl&&this.a.BccRecipientWellControl.rpcl("IsHidden",this.bt);this.a.CcRecipientWellControl&&this.a.CcRecipientWellControl.rpcl("IsHidden",this.bT);this.a.FromFieldControl&&this.a.FromFieldControl.rpcl("IsHidden",this.cZ);if(n&&n.cd()){var u=n.Y;if(u&&!u.closed){u.removeEventListener("focusin",this.dk,!0);u.removeEventListener("focusout",this.dj,!0)}}else{for(var t=0;t<this.d.d.length;t++)this.d.d[t].a in this.a&&this.a[this.d.d[t].a].B.unbind("focusin",this.d.d[t].b);for(var i=0;i<this.m.d.length;i++)this.m.d[i].a in this.a&&this.a[this.m.d[i].a].B.unbind("focusout",this.m.d[i].b)}"EditorControl"in this.a&&this.a.EditorControl.rpcl("IsPlainTextContent",this.cV)}if(n){_js.Trace.logInfo(_a.a.a,"Unbind view events on view model. Context:{0}",n.L);n.bs()&&n.bs().a()&&n.bs().a().rpcl("IsShown",this.cU);var r=n.bB();if(r){r.rpcl("DialogViewModel",this.bW);r.a()&&r.a().rpcl("IsShown",this.bX)}var o=n.Q();o&&o.rpcl("IsPeoplePickerShown",this.df);n.M.rpcl("ActionPerformed",this.dc);n.M.rpcl("Count",this.dd);n.S().r(this.cM);n.rpcl("IsReadyForViewInitialization",this.bY);n.S().a()&&n.S().a().C(this.cL);if(this.Q.b(this.Q.f())&&this.k==="TouchWide"){var f=n.be().h;if(f){f.p(this.cX);f.y(this.cO)}}n.L.rpcl("SelectedDataCallContext",this.di);n.L.rpcl("EditorCallContext",this.cW);n.bf().rpcl("CanLoadPopoutSuccessfully",this.cS);n.be().rpcl("RequestCloseComposeForm",this.dh)}if(this.a.ComposeAppsPane){this.a.ComposeAppsPane.rpcl("IsHidden",this.cK);_y.c.a.q(this.ds);_y.c.a.q(this.dt);_g.a.a().b().L(this.cY)}this.bQ=!1},eV:function(n){_js.Trace.logInfo(_a.a.a,"Focused in the RTE");this.c!=="EditorControl"&&this.q("EditorControl")},ee:function(n){var i=n.data;var t=i.uiComponent;this.dx(t)},gd:function(n){this.ee(n);this.dA()},eA:function(n){_js.Trace.logInfo(_a.a.a,"User blured from {0}",this.c);if(this.E()&&_mcp.d.isInstanceOfType(this.E())&&!this.bn&&!this.E().bh){if(this.c==="FromFieldControl"){var t=this.E().Q();if(t&&t.r()){var u=t.r().a();_js.d.a(u)||t.bl(u,!0)}}if(_a.cC.a){var r=this;_js.g.a().a(this.H(),"Delayed MailTips retrieval",function(){if(r.E()){var n=r.E().cE();n.a(1)}},100)}if(_a.bl.a){var i=this;_js.g.a().a(this.H(),"Delayed PolicyTips retrieval",function(){if(i.E()){var n=i.E().cX();n.a(1)}},100)}}},v:function(){if(this.a&&this.S()&&this.t&&this.c&&this.E()&&!this.E().bh){_js.Trace.logInfo(_a.a.a,"Restore focus to {0}",this.c);this.b(this.c)}else _js.Trace.logInfo(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.a?"non-null":"null",this.S(),this.t,this.c,this.E()?"non-null":"null")},b:function(n){this.dw();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.n&&this.n[n]){this.n[n].focus();this.q(n);this.dA()}break;case"EditorControl":if(this.a&&this.a[n]){this.a[n].cS(!1);this.q(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"AppsButton":case"AffordanceMenuButton":case"AttachmentWellViewWrapper":if(this.a&&this.i(n)){this.a[n].X();this.q(n)}break}},dw:function(){if(this.n&&!("SubjectTextBox"in this.n)){this.n.SubjectTextBox=this.a.SubjectTextBox.B;this.n.FromFieldControl=this.a.FromFieldControl.B.find("input");this.n.ToRecipientWellControl=this.a.ToRecipientWellControl.B.find("input");this.n.CcRecipientWellControl=this.a.CcRecipientWellControl.B.find("input");this.n.BccRecipientWellControl=this.a.BccRecipientWellControl.B.find("input")}},dE:function(n,t){this.ed();var i=this.E();this.x=i.L.f()==="HTML";this.x||this.eh()},dF:function(){},eB:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_js.Trace.logInfo(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},gi:function(){this.a.FromFieldControl.eJ(this.dg)},fp:function(n,t){var i=this.a.ComposeAppsPane;if(this.t){i.bA()?this.b("ToRecipientWellControl"):this.dJ();this.en()}},fv:function(n,t){this.bj("ShouldHideSpinner")},fX:function(n,t){var i=this.E();var u=this.c||this.bJ;if(u==="SubjectTextBox"){i.L.v().c("subject");this.a.SubjectTextBox.q(i.L.v())}else if(u==="EditorControl"){if("EditorControl"in this.a){var r=this.a.EditorControl;if(r.x)r.bq(i.L.v());else if(_cmc.e.isInstanceOfType(i.L.v()))i.L.v().a=r.eC;else if(_cmc.h.isInstanceOfType(i.L.v())){r.eC=i.L.v().n;r.bq(i.L.v())}}i.L.v().c("body")}else i.L.v().f(!0)},fM:function(n,t){var r=this.E();if(r){var u=r.P;var i=null;if(this.k==="Mouse"){var e=u.b(19);i=e.f()}else{var f=u.b(10);i=f.a()}i&&i.b&&i.a();this.k==="TouchNarrow"&&r.be().h.j()}},fB:function(n,t){if("EditorControl"in this.a){var i=this.E();this.a.EditorControl.bq(i.L.cC())}},gm:function(){var n=this.a.FromFieldControl;var r=this.a.ToRecipientWellControl;var i=this.a.CcRecipientWellControl;var t=this.a.BccRecipientWellControl;n&&n.fU(this.dg)},fL:function(n){if(this.a.FromFieldControl===n){var t=n.B.find("input");t.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}},fb:function(){var n=this.a.FromFieldControl;n&&n.b()},dA:function(){switch(this.c){case"ToRecipientWellControl":this.cn(!0);this.cl(!1);this.ck(!1);break;case"CcRecipientWellControl":this.cl(!0);this.cn(!1);this.ck(!1);break;case"BccRecipientWellControl":this.ck(!0);this.cl(!1);this.cn(!1);break}},ek:function(){var n=!0;if(this.bl){switch(this.c){case"DiscardButton":this.b("SendButton");break;case"InsertButton":this.b("DiscardButton");n=!1;break;case"AppsButton":this.b("InsertButton");n=!1;break;case"AffordanceMenuButton":var i=this.a.AppsButton;i&&!i.bA()?this.b("AppsButton"):this.b("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.b("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":var t=this.E();if(t.Q().bq||t.M.c.x.length)this.s(!1);else{var u=this.a.ComposeAppsPane;if(u.bA()){this.b("OpenSeperateWindowButton");n=!1}else this.s(!1)}break;case"ToRecipientWellControl":if(this.k==="Mouse"){this.b("ToRecipientButton");n=!1}else this.s(!1);break;case"CcRecipientWellControl":this.b("CcRecipientButton");break;case"BccRecipientWellControl":this.b("BccRecipientButton");break;case"AttachmentWellViewWrapper":this.b("SubjectTextBox");break}if(n){var r=this;_js.g.a().a(this.H(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.s(!1)},100)}}},go:function(){if(this.gl()){var n=this.E();switch(this.c){case"ToRecipientWellControl":n.Q().e.e();n.Q().f.e();break;case"CcRecipientWellControl":n.Q().c.e();n.Q().f.e();break;case"BccRecipientWellControl":n.Q().c.e();n.Q().e.e();break;default:n.Q().c.e();n.Q().e.e();n.Q().f.e();break}}},fd:function(n){if(this.bf()&&n.b===this.bf().bw()&&n.a){var i=this.a.ToReadWriteRecipientWellView;if(i){var t=i.E();t&&(t.bV(n.a)||t.ba(n.a))}}},gl:function(){return this.k!=="Mouse"&&this.E()?!0:!1},fu:function(n,t){if(this.a.CancelConfirmDialog.bA()&&this.E()&&!this.E().bh){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.v()}},fH:function(n,t){if(this.a.MessageBox.bA()){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of message box.");this.v()}},fz:function(n,t){var i=this.E();i.bf().rpcl("IsInitialized",this.bU);_js.Trace.logInfo(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.e(null)},fx:function(n,t){var i=this.E();i.L.g()&&this.bj("EditorSizingMode")},fA:function(n,t){var i=this.E();i.bf().rpcl("IsSecondInitializationComplete",this.bV);this.k==="Mouse"&&i.bs()&&i.bs().a()&&i.bs().a().apcl("IsShown",this.cU);var r=i.bB();r.a()?r.a().apcl("IsShown",this.bX):r.apcl("DialogViewModel",this.bW);var u=i.Q();u&&u.apcl("IsPeoplePickerShown",this.df)},fy:function(n,t){var i=this.E();if(!i.bs().a().i){var r=i.bB();var u=this;_js.g.a().a(this.H(),"MailComposeView.OnContextMenuShownChanged",function(){var t=!r.a()||!r.a().j;var n=!i.U||!i.U.j;if(t&&n){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of context menu");u.v()}},100)}},fI:function(n,t){var r=this.E();var i=r.bB();i.rpcl("DialogViewModel",this.bW);i.a().apcl("IsShown",this.bX)},fJ:function(n,t){var r=this.E();var i=this;_js.g.a().a(this.H(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.bB().a().j){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of message options dialog");i.v()}},100)},fK:function(n,t){var i=this.E();if(!i.Q().cm){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of people picker");this.v()}},fE:function(n,t){this.v()},fF:function(n,t){this.ev();this.dJ()},ev:function(){var a=this.F.a("InfoBarControl");if(a){var f=this.E();if(f.M.c.x.length>0){for(var l=new _y.cM,o=_nbs.a.Gx+". ",n,r=0;r<f.M.c.x.length;r++){n="";var t=f.M.c.x[r];if(_y.bX.isInstanceOfType(t)){var h=t;h&&(n=h.c)}else if(_y.bY.isInstanceOfType(t)){var e=t;e&&(n=e.c)}else if(_y.bW.isInstanceOfType(t)){var i=t;if(i&&_y.ft.isInstanceOfType(i.c)){var u=i.c;u&&u.a()&&(n=u.a())}}if(n===""){var s=t;s&&(n=l.a(s.a,null))}o+=n+". "}var c=this.F.a("InfoBarControl").B;c.attr("aria-label",o)}}},fr:function(n){n.a().v(this.cL);this.ep(!n.a().j())},fq:function(n){if(n.bp()){n.bI(!1);this.q("EditorControl")}this.ep(!n.j());this.v()},eu:function(n,t){if(n.sz("IsInitialized"))_js.Trace.logInfo(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:{0}",t);else{_js.Trace.logInfo(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:{0}",t);n.apcl("IsInitialized",this.bU)}},ez:function(){if(this.bN){_js.Trace.logWarning(this.H(),"Editor events were already bound.");return}var i=this.E().cC();if("EditorControl"in this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.ge(this.cy);n.gf(this.cE);n.lA(this.dW);n.eD(this.cH);n.hr(this.cB);n.jD(this.cv);n.hq(this.cz);n.hp(this.cx);n.d(this.cu);n.gg(this.cF);n.lz(this.cD);i&&i.i(n)}if(this.p.b()){var t=this.F.a("TabAnchor");t&&t.B.bind("focusin",this.dV)}this.bN=!0},gp:function(){if(!this.bN){_js.Trace.logWarning(this.H(),"Editor events weren't bound. No need to unbind.");return}var i=this.E().cC();if("EditorControl"in this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.gt(this.cy);n.eO(this.cE);n.eP(this.cH);n.hC(this.cB);n.jJ(this.cv);n.hB(this.cz);n.hA(this.cx);n.j(this.cu);n.gu(this.cF);n.lH(this.cD);i&&i.j(n)}if(this.p.b()){var t=this.F.a("TabAnchor");t&&t.B.unbind("focusin")}this.bN=!1},ey:function(n){var t=new _a.U(n);this.b("EditorControl");t.b()},ei:function(n){_js.d.a(this.j)||this.b(this.j);n.a(!0)},ej:function(n){},Z:function(){this.j=null;this.bC&&(this.j="AttachmentWellViewWrapper");var n=this.E();n.L.cd()||_js.d.a(this.j)&&this.i("SubjectTextBox")&&(this.j="SubjectTextBox");_js.d.a(this.j)&&this.i("BccRecipientWellControl")&&(this.j="BccRecipientWellControl");if(_js.d.a(this.j)&&this.i("CcRecipientWellControl")){this.j="CcRecipientWellControl";this.a.BccRecipientWellControl.rpcl("IsHidden",this.bt);this.a.BccRecipientWellControl.apcl("IsHidden",this.bt)}_js.d.a(this.j)&&this.i("ToRecipientWellControl")&&(this.j="ToRecipientWellControl");!_js.d.a(this.j)&&this.a&&this.a[this.j]?this.a[this.j].B.bind("keydown",this.bw):_js.Trace.logWarning(this.H(),"Compose form doesn't have any control preceeding editor")},bq:function(){!_js.d.a(this.j)&&this.a&&this.a[this.j]&&this.a[this.j].B.unbind("keydown",this.bw)},i:function(n){if(!this.a)return!1;var t=this.a[n];return!!t&&!t.bA()},ft:function(n,t){this.i("BccRecipientWellControl")&&this.b("BccRecipientWellControl");this.bq();this.Z()},fw:function(n,t){this.a.CcRecipientWellControl.rpcl("IsHidden",this.bT);this.i("CcRecipientWellControl")&&this.b("CcRecipientWellControl");this.bq();this.Z()},em:function(n,t){},fa:function(n){var t=this.E();if(t){t.L.dH(n.f());t.L.de(n.e());t.L.dp(n.c())}n.c()&&this.bj("ShouldHideSpinner")},eX:function(n){var t=this.E();t&&t.S().x(n.c())},eT:function(n){var i=this.E();if(i){var t=i.S().a().S();t.b(n.c());t.a(n.c())}},eW:function(n){var i=this.E();if(i){var t=i.S().a();t.G(n.e());t.H(n.f());t.F(n.c());t.bF(n.h());t.bE(n.g());t.l().a()}},eU:function(n){var t=this.E();if(t){var i=t.S().a();i.r(n.c())}},eS:function(n){this.eh()},eZ:function(n){var i=this.E();if(i){var f=i.P;switch(n.c()){case 0:var s=i.e();var u=s.b();u&&u.b&&u.a();break;case 1:this.bd&&this.bd.a(_y.et,new _y.et);break;case 2:var r=i.c().f();r&&r.b&&r.a();break;case 3:var t=null;if(this.k==="Mouse"){var o=f.b(19);t=o.a()}else{var e=f.b(10);t=e.a()}t&&t.b&&t.a();break;case 4:this.b("ToRecipientWellControl");break}}},eY:function(n){var i=this.E();if(i){var r=!!this.o&&this.o.a().h().Enabled;if(r){var t=n.c().outerText;t=_js.d.a(t)?n.c().text:t;n.a(_cmc.f.b(0,n.c().id,n.c().href,t,i.T))}}},dJ:function(){var t=this.E();if(this.a&&t){var n;n=this.a.EditorControl;n&&n.x&&t.bI&&this.bG&&this.bg&&n.ef()}},eo:function(){if(this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.x&&n.bq(new _cmc.b(!1))}},eh:function(){var t=this.E();if(this.x&&this.a&&this.a.EditorControl){var n=this.a.EditorControl;if(n.x&&!n.eF()){n.bq(new _cmc.Q);t.L.ct(n.bZ.b)}}else t.L.ct(0)},fD:function(n,t){},ge:function(){},en:function(){var i=this.a.ToReadWriteRecipientWellView;var t=this.a.CcReadWriteRecipientWellView;var n=this.a.BccReadWriteRecipientWellView;this.dL(i);this.dL(t);this.dL(n)},dL:function(n){if(n&&_rw.b.isInstanceOfType(n.E())){var t=n.E();t.bu(!0);t.bu(!1)}},fC:function(){var n=this.a.QuotedBodyHtmlLabel;if(n){this.a.QuotedBodyHtmlLabel.B.on("touchstart",null,null,this.dr);this.a.QuotedBodyHtmlLabel.B.on("touchend",null,null,this.dq)}},fs:function(){var n=this.a.QuotedBodyHtmlLabel;if(n){this.a.QuotedBodyHtmlLabel.B.off("touchstart",null,this.dr);this.a.QuotedBodyHtmlLabel.B.off("touchend",null,this.dq)}},gb:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.Q.f().a(t);n.stopImmediatePropagation();n.preventDefault()}},gc:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},bB:function(){var n=this.E();var t=this.a.EditorControl;this.p.f()&&this.a&&this.a.SubjectTextBox&&_zz.q.a(this.p,this.a.SubjectTextBox.B,null);this.ez();this.ca.b()?this.dG(!1):this.dG(!0);this.bf().gd=n.P.b(5).f();this.dH(!0);this.dI(!0);_js.Trace.logInfo(_a.a.a,"PostTransitionIn active view. Context: {0}",n.L);this.gg();this.dv()},fY:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.bY);this.bB()},et:function(){if(this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.cS(!0);this.q("EditorControl")}},ga:function(n){for(var t=0;t<this.d.d.length;t++){var r=this.d.d[t];var i=this.a[r.a];if(n.target===i.z||i.B.has(n.target).length){this.dx(r.a);this.dA();break}}return!0},fZ:function(n){for(var t=0;t<this.m.d.length;t++){var r=this.m.d[t];var i=this.a[r.a];if(n.target===i.z||i.B.has(n.target).length){r.b(null);break}}return!0},el:function(n){return n==="ToRecipientWellControl"||n==="BccRecipientWellControl"||n==="CcRecipientWellControl"},fc:function(){return!!this.o&&this.o.a().bv().Enabled},gn:function(n,t){if(this.fc()&&!this.el(n)&&this.el(t)){var i=this;_js.g.a().a(this.H(),"Delayed PeopleRecommendations recipients retrieval",function(){if(i.E()){var t=i.E();if(t){var n=i.E().dx();n.a(1)}}},100)}},dx:function(n){_js.Trace.logInfo(_a.a.a,"Focused in {0}",n);this.q(n);this.s(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.E()&&_mcp.d.isInstanceOfType(this.E())){var i=this.E();if(this.c==="FromFieldControl"){var t=i.Q();t&&t.cp(!1)}this.c==="InsertButton"&&i.cS()}},ed:function(){var n=this.E();n&&this.gf(this.p.b()&&n.L.f()==="Text"?!0:!1)},fG:function(n){var t=new _a.U(n);var i=t.a();if(i===9&&!t.l()){this.b("EditorControl");this.fg(t)}}};_mcp.l.a=function(n,t){this.a=n;this.b=t};_mcp.l.a.prototype={a:null,b:null};_mcp.M=function(n){this.g=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.o);this.b={};_mcp.M.initializeBase(this,[n])};_mcp.M.prototype={c:null,a:null,d:null,e:function(){this.b.UpConvertButton.X();this.c="UpConvertButton";_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!0)},K:function(){_js.b.prototype.K.call(this);this.b.ShowCcButton=this.F.a("ShowCcButton");this.b.ShowBccButton=this.F.a("ShowBccButton");this.b.UpConvertButton=this.F.a("UpConvertButton")},ea:function(){_js.c.prototype.ea.call(this);this.q()},P:function(){this.i();_js.b.prototype.P.call(this)},bk:function(){this.i();_js.b.prototype.bk.call(this)},j:function(n){if(!$a(this.b[n])){this.b[n].X();this.c=n}},q:function(){this.d=this.L;this.a=this.d.L;_mcp.i.isInstanceOfType(this.a)&&(this.a=this.a.L);_mcp.j.isInstanceOfType(this.a)&&this.a.gv(this);this.d.B.bind("focusout",this.f);this.d.B.bind("keydown",this.g)},h:function(n){if(!this.b)return!1;var t=this.b[n];return!!t&&!t.bA()},p:function(n){var t=new _a.U(n);var i=t.a();if(i===9&&t.h())if(this.b.UpConvertButton.gP()){this.c="UpConvertButton";this.n()}else if(this.b.ShowBccButton.gP()){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.gP()){this.c="ShowCcButton";this.l()}},n:function(){if(this.h("ShowBccButton")){this.j("ShowBccButton");_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!0)}else this.h("ShowCcButton")&&this.k()},k:function(){if(this.h("ShowCcButton")){this.j("ShowCcButton");_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!0)}else this.l()},l:function(){this.c=null;this.a.gw();this.a.w=!1},i:function(){this.m();this.d.B.unbind("focusout",this.f);this.d.B.unbind("keydown",this.g)},o:function(n){this.m()},m:function(){this.c=null;_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!1)}};_mcp.j=function(n,t,i,r,u,f,e,o){this.dM=Function.createDelegate(this,this.gt);this.ew=Function.createDelegate(this,this.gr);_mcp.j.initializeBase(this,[n,t,i,r,u,f,e,o]);this.dN=f;this.dU=i};_mcp.j.prototype={dN:null,dU:null,cs:!1,cr:!1,U:null,l:null,w:!1,gu:function(n){this.cr=n;this.bj("EnableRichTextOptions");return n},gv:function(n){n&&(this.U=n)},gw:function(){if(this.i("FromFieldControl"))this.b("FromFieldControl");else{this.cs=!0;this.b("ToRecipientWellControl")}},K:function(){_mcp.l.prototype.K.call(this);if(this.F){this.a.InlineComposeBottomEdge=this.F.a("InlineComposeBottomEdge");this.a.InlineComposeBody=this.F.a("InlineComposeBody");this.a.InsertPictureButton=this.F.a("InsertPictureButton");this.a.FormatButton=this.F.a("FormatButton");this.a.Emoji=this.F.a("Emoji");this.a.ShowOriginalMessage=this.F.a("ShowOriginalMessage");this.a.MailComposeAggregatedRecipientWell=this.F.a("MailComposeAggregatedRecipientWell");this.a.ReadWriteHeader=this.F.a("ReadWriteHeader")}else{this.a.InlineComposeBottomEdge=null;this.a.InlineComposeBody=null;this.a.InsertPictureButton=null;this.a.FormatButton=null;this.a.Emoji=null;this.a.ShowOriginalMessage=null;this.a.MailComposeAggregatedRecipientWell=null;this.a.ReadWriteHeader=null}},bB:function(){_mcp.l.prototype.bB.call(this);var i=this.a.InlineComposeBody;var t=this.a.InlineComposeBottomEdge;this.ex();i&&this.bf()&&t&&this.dN.a(IMailComposeViewInitializedEvent,new _mcp.bw(i.B,this.bf().B,t.B));var n=this.a.MailComposeAggregatedRecipientWell;n&&n.B.bind("click",this.ew)},gr:function(n){this.dO(!1);this.b("ToRecipientWellControl")},dO:function(n){if(this.E()&&_mcp.e.isInstanceOfType(this.E())){var t=this.E();t.Q().M(n)}},dE:function(n,t){_mcp.l.prototype.dE.call(this,n,t);this.ex()},b:function(n){if(this.a)switch(n){case"Emoji":if(this.a[n]){this.a[n].X();this.q(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":if(this.i(n)){this.a[n].X();this.q(n)}break;default:_mcp.l.prototype.b.call(this,n);break}},Z:function(){this.l=null;this.bC&&(this.l="AttachmentWellViewWrapper");$a(this.l)&&this.i("BccRecipientWellControl")&&(this.l="BccRecipientWellControl");$a(this.l)&&this.i("CcRecipientWellControl")&&(this.l="CcRecipientWellControl");$a(this.l)&&this.i("ToRecipientWellControl")&&(this.l="ToRecipientWellControl");!_js.d.a(this.l)&&this.i(this.l)?this.a[this.l].B.bind("keydown",this.bw):_js.Trace.logWarning(this.H(),"Compose form doesn't have any control preceeding editor")},bq:function(){!_js.d.a(this.l)&&this.a&&this.a[this.l]&&this.a[this.l].B.unbind("keydown",this.bw)},ek:function(){this.bl&&this.gq()},ei:function(n){this.dO(!1);if(!_js.d.a(this.l)){this.b(this.l);this.l!=="ToRecipientWellControl"||this.i("FromFieldControl")||this.U.e()}n.a(!0)},ej:function(n){if(!$a(this.a.SendButton)){if(!this.dU.f()){this.a.ShowOriginalMessage.X();this.q("ShowOriginalMessage")}n.a(!0)}},dF:function(){this.dO(!this.gs());_mcp.l.prototype.dF.call(this)},gs:function(){if(this.a){var n=this.a.ReadWriteHeader;if(n&&n.z){var t=this.a[this.c];return n.z.contains(t.z)}}return!0},dx:function(n){_js.Trace.logInfo(_a.a.a,"Focused in {0}",n);this.q(n);this.s(n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl"||n==="AttachmentWellViewWrapper");if(this.E()&&_mcp.d.isInstanceOfType(this.E())){var i=this.E();if(this.c==="FromFieldControl"){var t=i.Q();t&&t.cp(!1)}this.c==="InsertButton"&&i.cS()}},dv:function(){_mcp.l.prototype.dv.call(this);var n=this.a.ShowOriginalMessage;$a(n)||n.B.bind("keydown",this.dM)},dK:function(){_mcp.l.prototype.dK.call(this);var n=this.a.ShowOriginalMessage;$a(n)||n.B.unbind("keydown",this.dM)},em:function(n,t){this.bq();this.Z()},ex:function(){this.gu(this.x);this.gx(!this.cr)},gx:function(n){this.i("FormatButton")&&this.a.FormatButton.gV(n);this.i("InsertPictureButton")&&this.a.InsertPictureButton.gV(n);if(this.ef()){var t=this.a.Emoji;t&&!t.bA()&&t.gV(n)}},gt:function(n){var t=new _a.U(n);var i=t.a();if(i===9&&!t.l()){this.b("SendButton");this.fg(t)}},gq:function(){if(!this.w)switch(this.c){case"BccRecipientWellControl":this.b("BccRecipientButton");break;case"BccRecipientButton":this.i("CcRecipientWellControl")?this.b("CcRecipientWellControl"):this.i("FromFieldControl")?this.b("ToRecipientWellControl"):this.U.e();break;case"CcRecipientWellControl":this.b("CcRecipientButton");break;case"CcRecipientButton":this.i("FromFieldControl")?this.b("ToRecipientWellControl"):this.U.e();break;case"ToRecipientWellControl":this.cs?this.cs=!1:this.b("ToRecipientButton");break;case"ToRecipientButton":this.i("FromFieldControl")?this.U.e():this.s(!1);break;case"FromFieldControl":this.w||this.s(!1);break;case"ShowOriginalMessage":this.b("EditorControl");break;case"SendButton":this.b("ShowOriginalMessage");break;case"AttachmentWellViewWrapper":this.i("FromFieldControl")?this.b("ToRecipientWellControl"):this.U.e();break;default:this.s(!1);break}}};_mcp._TI=function(){};_mcp._TI.$$cctor=function(){var p="IrmDialogView";new _A(p,function(){_mcp._TI.a[p]===undefined&&(_mcp._TI.a[p]=[[[-1,0,["Description"],[_mcp._TI.fx],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp._TI.fw],null,"Text",null,_mcp._TI.h,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.Q,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a);var w="MailComposeView._tid1._tid3";new _A(w,function(){_mcp._TI.a[w]===undefined&&(_mcp._TI.a[w]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.H],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_v ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.BasicDetailsPopup");n.bc("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var y="MailComposeView._tid1._tid4";new _A(y,function(){_mcp._TI.a[y]===undefined&&(_mcp._TI.a[y]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp._TI.d,_mcp._TI.cU],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[2].cloneNode(!0);var n=new _fp.e(t.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));n.bc("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var a="MailComposeView._tid1";new _A(a,function(){_mcp._TI.a[a]===undefined&&(_mcp._TI.a[a]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_b.d.b()],[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.VW],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.jl],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.S,_mcp._TI.M,_mcp._TI.F],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.H],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.u(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.H],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.u(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.H],null,"IsHidden",null,_mcp._TI.b,1,new _js.j([_mcp._TI.u(),_mcp._TI.c()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp._TI.d,_mcp._TI.cW],null,"_mcp_d",null,null,0,null,null,null]]]);var t=_mcp._TI._hf.childNodes[3].cloneNode(!0);var u=new _js.b(t.children[3]);u.y("MailComposeView._tid1._tid4");var f=new _js.b(t.children[2]);var r=new _js.b(t.children[1]);r.y("MailComposeView._tid1._tid3");var n=new _fc.b(t.children[0]);n.y("MailComposeView.FromButtonTemplate");n.V("MailCompose.FromRecipientWellButton");n.C(0);var i=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));i.A(_E.a(["SendAsContextMenuComponent","Menu"],[_mcp._TI.S,_mcp._TI.M],null,"MenuDataContext",null,_mcp._TI.bc,1)).A(_E.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.S,_mcp._TI.M,_mcp._TI.F],_mcp._TI.bd,"IsShown",_mcp._TI.ba,_mcp._TI.bb,2,null,null,!1));i.a=3;i.b=1;n.G([i]);return new _B(t,[n,r,f,u]).R({FromPersona:r})},_mcp.d,_mcp.i,function(n){return new _mcp.i(n)},!1,!0,!1,0,_mcp._TI.a);var v="MailComposeView._tid9";new _A(v,function(){_mcp._TI.a[v]===undefined&&(_mcp._TI.a[v]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.P.X]],[[-1,0,["Context","Subject"],[_mcp._TI.e,_mcp._TI.bl],null,"Text",null,_mcp._TI.h,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var b="MailComposeView._tida._tidb";new _A(b,function(){_mcp._TI.a[b]===undefined&&(_mcp._TI.a[b]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp._TI.s,_mcp._TI.cS],_mcp._TI.cT,"DataContext",_mcp._TI.bz,_mcp._TI.f,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.s,_mcp._TI.bm],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var i=_mcp._TI._hf.childNodes[5].cloneNode(!0);var t=new _pe.b(i.children[1],_js.a.Instance.a(_a.m));t.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");t.y("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.b(i.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _B(i,[n,t])},_mcp.d,_b.j,function(n){return new _b.j(n)},!1,!0,!1,0,_mcp._TI.a);var nt="MailComposeView._tida._tidc";new _A(nt,function(){_mcp._TI.a[nt]===undefined&&(_mcp._TI.a[nt]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.s,_mcp._TI.bm],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[6].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var tt="MailComposeView._tida";new _A(tt,function(){_mcp._TI.a[tt]===undefined&&(_mcp._TI.a[tt]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.cO]],[[-1,4,null,null,null,"FormatString",null,_mcp._TI.ct,0,null,null,null,_u.R.Nw],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.s,_mcp._TI.bn],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.s,_mcp._TI.bn],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]]]);var n=_mcp._TI._hf.childNodes[7].cloneNode(!0);var i=new _js.b(_B.a(n,[1,1]));i.y("MailComposeView._tida._tidc");var t=new _b.j(_B.a(n,[1,0]));t.y("MailComposeView._tida._tidb");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var g="MailComposeView._tidd";new _A(g,function(){_mcp._TI.a[g]===undefined&&(_mcp._TI.a[g]=[[[-1,0,["Context","WhenLabel"],[_mcp._TI.e,_mcp._TI.cQ],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,0,["Context","MeetingCalendarTimePeriod"],[_mcp._TI.e,_mcp._TI.cP],null,"Text",null,_mcp._TI.h,1,_mcp._TI.cr(),null,null]]]);var n=_mcp._TI._hf.childNodes[8].cloneNode(!0);var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var k="MailComposeView._tide";new _A(k,function(){_mcp._TI.a[k]===undefined&&(_mcp._TI.a[k]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.XI]],[[-1,0,["Context","ProposedNewTime"],[_mcp._TI.e,_mcp._TI.cB],null,"Text",null,_mcp._TI.h,1,_mcp._TI.cq(),null,null]]]);var n=_mcp._TI._hf.childNodes[9].cloneNode(!0);var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var d="MailComposeView._tidf";new _A(d,function(){_mcp._TI.a[d]===undefined&&(_mcp._TI.a[d]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.P.I]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp._TI.s,_mcp._TI.cR],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[10].cloneNode(!0);var n=new _js.b(_B.a(t,[1,0]));n.y("LocationView");n.T(!0);var i=new _fc.a(t.children[0]);return new _B(t,[i,n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var l="MailComposeView._tidg";new _A(l,function(){_mcp._TI.a[l]===undefined&&(_mcp._TI.a[l]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_b.d.a()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.o,0,null,null,null,_n.a.g()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.V,0,null,null,null,_n.a.g()],[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.iD],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.iD],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp._TI.J,_mcp._TI.dX],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp._TI.J,_mcp._TI.cM],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.U,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp._TI.bp,0,null,null,null,_nbs.a.iD],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp._TI.J,_mcp._TI.cL],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]]]);var t=_mcp._TI._hf.childNodes[11].cloneNode(!0);var n=new _fce.g(t.children[1],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));n.a=0;n.C(-1);var i=new _fc.b(t.children[0]);i.C(0);return new _B(t,[i,n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var r="MailComposeView._tidh";new _A(r,function(){_mcp._TI.a[r]===undefined&&(_mcp._TI.a[r]=[[[-1,0,["IsOwaExtensibilityActive"],[_mcp._TI.fh],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["IsXOwaExtensibilityActive"],[_mcp._TI.fi],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]]]);var n=_mcp._TI._hf.childNodes[12].cloneNode(!0);var i=new _js.b(n.children[1]);i.y("XComposeExtensibilityView");var t=new _js.b(n.children[0]);t.y("ComposeExtensibilityView");return new _B(n,[t,i])},_y.fE,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var u="MailComposeView.FromButtonTemplate";new _A(u,function(){_mcp._TI.a[u]===undefined&&(_mcp._TI.a[u]=[[[-1,1,["Text"],[_mcp._TI.eT],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp._TI.eS],null,"Id",null,_mcp._TI.B,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[13].cloneNode(!0);var i=new _fc.d(n.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _B(n,[t,i]).R({Label:t,Image:i})},Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp._TI.a);var i="MailComposeView";new _A(i,function(){_mcp._TI.a[i]===undefined&&(_mcp._TI.a[i]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.U,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp._TI.E],null,"IsBusy",null,_mcp._TI.dh,1,_mcp._TI.c(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp._TI.eP],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,5,["GenericMailMode"],[_mcp._TI.eC],null,"_mcp_Q",null,null,0,_mcp._TI.c(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp._TI.Q,_mcp._TI.N,_mcp._TI.bk],null,"_mcp_Z",null,null,0,_mcp._TI.c(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp._TI.eP],null,"_mcp_P",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp._TI.eC],null,"_mcp_T",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp._TI.fJ],null,"_mcp_L",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.U,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp._TI.dd],null,"BusyText",null,_mcp._TI.bp,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp._TI.bo],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.E],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp._TI.bu],null,"DataSource",null,_mcp._TI.dn,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_V",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp._TI.bv],null,"_mcp_U",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp._TI.eO],null,"_mcp_4",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp._TI.e,_mcp._TI.bR],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_u.R.NV],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.SH],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.I,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_V",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.V,0,null,null,null,_mcp.c.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp._TI.eQ],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.I,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.ef],null,"_mcp_S",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.q,0,null,null,null,_nbs.a.ZZ],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.I,_mcp._TI.P],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bA],null,"_mcp_S",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.I,_mcp._TI.O],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bA],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_u.R.QZ],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.Pz],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.D,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_V",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.V,0,null,null,null,_mcp.c.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp._TI.ek],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.D,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.ef],null,"_mcp_S",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.q,0,null,null,null,_nbs.a.WC],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.D,_mcp._TI.P],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bA],null,"_mcp_S",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.D,_mcp._TI.O],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bA],null,"_mcp_S",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp._TI.e,_mcp._TI.dK],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_u.R.NG],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.fk],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.C,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_V",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.V,0,null,null,null,_mcp.c.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp._TI.ej],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.C,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.ef],null,"_mcp_S",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.q,0,null,null,null,_nbs.a.Pn],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.C,_mcp._TI.P],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bA],null,"_mcp_S",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.C,_mcp._TI.O],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bA],null,"_mcp_S",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.X],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.P.X]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_mcp.c.c()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp._TI.bt,_mcp._TI.fm],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.bt,_mcp._TI.bP],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_n.a.bA()],[-1,0,["Context","SmimeSignMessage"],[_mcp._TI.e,_mcp._TI.dN],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_n.a.bH()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp._TI.e,_mcp._TI.dM],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.bW,_mcp._TI.bS],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.e,_mcp._TI.bQ],null,"Id",null,_mcp._TI.B,1,_mcp._TI.bG(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_mcp.c.G()],[-1,0,["MailComposeContextMenuTouchComponent","IsNotIOS"],[_mcp._TI.eg,_mcp._TI.fz],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["Context","Subject"],[_mcp._TI.e,_mcp._TI.bl],_mcp._TI.cF,"Text",_mcp._TI.dk,_mcp._TI.dm,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp._TI.e,_mcp._TI.cO],null,"MaxLength",null,_mcp._TI.dl,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp._TI.e,_mcp._TI.cC],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.X],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.X],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],null,[[-1,0,["Context","HasProposedNewTime"],[_mcp._TI.e,_mcp._TI.cN],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.u(),null,!0]],[[-1,0,["Context","HasLocation"],[_mcp._TI.e,_mcp._TI.cA],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp._TI.w,_mcp._TI.bO,_mcp._TI.ep],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp._TI.w,_mcp._TI.bO],_mcp._TI.fj,"DataContext",_mcp._TI.bz,_mcp._TI.f,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.Fm],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.G],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.G],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp._TI.du,0,null,null,null,_nbs.a.Nb],[-1,1,["EditorSizingMode"],[_mcp._TI.df],null,"SizingMode",null,_mcp._TI.dy,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp._TI.de],null,"MinHeight",null,_mcp._TI.dx,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp._TI.E],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bC],null,"IsCopyRestricted",null,_mcp._TI.cc,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.G],null,"IsPrintRestricted",null,_mcp._TI.dw,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp._TI.e,_mcp._TI.cz],_mcp._TI.cE,"Content",_mcp._TI.dq,_mcp._TI.dt,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp._TI.e,_mcp._TI.cy],_mcp._TI.cD,"IsPlainTextContent",_mcp._TI.dr,_mcp._TI.dv,2,_mcp._TI.cs(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp._TI.cZ,_mcp._TI.cG],_mcp._TI.cH,"CallContext",_mcp._TI.dp,_mcp._TI.ds,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.G],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.E],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp._TI.J,_mcp._TI.cK],null,"_mcp_K",null,null,0,_mcp._TI.c(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp._TI.eO],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bC],null,"TextSelectionType",null,_mcp._TI.gh,1,_mcp._TI.fd(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bC],null,"IsCopyRestricted",null,_mcp._TI.cc,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp._TI.e,_mcp._TI.ev],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.u(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp._TI.e,_mcp._TI.ev],null,"Html",null,_mcp._TI.eo,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp._TI.Q,_mcp._TI.N],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp._TI.bk],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp._TI.da],null,"DataContext",null,_mcp._TI.f,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp._TI.ce,0,null,null,null,_nbs.a.Gj],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp._TI.ei,_mcp._TI.fr],null,"ButtonDataList",null,_mcp._TI.cd,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp._TI.ei,_mcp._TI.fs],_mcp._TI.ft,"IsShown",_mcp._TI.x,_mcp._TI.y,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp._TI.bt,_mcp._TI.fl],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsShown"],[_mcp._TI.bL],_mcp._TI.bN,"IsShown",_mcp._TI.x,_mcp._TI.y,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bM],null,"DialogTitle",null,_mcp._TI.br,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bI],null,"CloseCommand",null,_mcp._TI.bs,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bJ],null,"ContentDataContext",null,_mcp._TI.ca,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bK],null,"ButtonDataList",null,_mcp._TI.bq,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp._TI.db,_mcp._TI.cI],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.cu],_mcp._TI.cv,"IsBusy",_mcp._TI.di,_mcp._TI.dj,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.bL],_mcp._TI.bN,"IsShown",_mcp._TI.x,_mcp._TI.y,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bM],null,"DialogTitle",null,_mcp._TI.br,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bI],null,"CloseCommand",null,_mcp._TI.bs,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bJ],null,"ContentDataContext",null,_mcp._TI.ca,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bK],null,"ButtonDataList",null,_mcp._TI.bq,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp._TI.fL],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]]]);var n=_mcp._TI._hf.childNodes[14].cloneNode(!0);var ei=new _js.c(n.children[8]);var at=new _fce.m(n.children[7],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));at.d("MessageOptionsView");var vt=new _fce.m(n.children[6],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));vt.d("IrmDialogView");var ot=new _b.l(n.children[5],_js.a.Instance.a(_y.a),_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));ot.g(!1);var st=new _js.b(n.children[4]);st.y("MessageBoxDefaultView");var ct=new _js.b(n.children[3]);ct.y("MailComposeView._tidh");var yt=new _b.p(_B.a(n,[2,1,3,0]));var ur=new _js.c(_B.a(n,[2,1,3]));var pt=new _js.b(_B.a(n,[2,1,2,1]));pt.y("MailComposeView._tidg");var t=_js.a.Instance.a(_js.L.$$(_zz.h)).a(_B.a(n,[2,1,2,0]));t.bt("_mcp_z ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");t.T(!0);t.C(-1);t.cp="0";var di=new _js.c(_B.a(n,[2,1,2]));var ki=new _fc.a(_B.a(n,[2,1,1,7]));var u=new _js.b(_B.a(n,[2,1,1,6,0,0]));u.y("AttachmentWellViewWrapper");u.cG(!0);u.T(!0);var tr=new _js.c(_B.a(n,[2,1,1,6]));var dt=new _js.b(_B.a(n,[2,1,1,5,4]));dt.y("MailComposeView._tidf");var kt=new _js.b(_B.a(n,[2,1,1,5,3]));kt.y("MailComposeView._tide");var ii=new _js.b(_B.a(n,[2,1,1,5,2]));ii.y("MailComposeView._tidd");var ti=new _js.b(_B.a(n,[2,1,1,5,1]));ti.y("MailComposeView._tida");var lt=new _js.b(_B.a(n,[2,1,1,5,0]));lt.y("MailComposeView._tid9");var hi=new _js.c(_B.a(n,[2,1,1,5]));var ft=new _cmc.j(_B.a(n,[2,1,1,4,1,5,0]));ft.C(0);var gt=new _fc.b(_B.a(n,[2,1,1,4,1,4]));var c=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));c.A(_E.a(["MailComposeContextMenuTouchComponent","Menu"],[_mcp._TI.eg,_mcp._TI.ey],null,"MenuDataContext",null,_mcp._TI.bc,1)).A(_E.a(["MailComposeContextMenuTouchComponent","Menu","IsShown"],[_mcp._TI.eg,_mcp._TI.ey,_mcp._TI.F],_mcp._TI.bd,"IsShown",_mcp._TI.ba,_mcp._TI.bb,2,null,null,!1));c.a=3;c.b=5;gt.G([c]);var ui=new _fc.d(_B.a(n,[2,1,1,4,1,3]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var ri=new _fc.d(_B.a(n,[2,1,1,4,1,2]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var fi=new _fc.d(_B.a(n,[2,1,1,4,1,1]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var oi=new _fc.b(_B.a(n,[2,1,1,4,1,0]));var ni=new _fc.a(_B.a(n,[2,1,1,4,0]));ni.C(-1);var ir=new _js.c(_B.a(n,[2,1,1,4]));var l=new _js.b(_B.a(n,[2,1,1,3,2,0]));l.y("ReadOnlyRecipientWellView");l.cG(!0);l.T(!0);var rr=new _js.c(_B.a(n,[2,1,1,3,2]));var a=new _js.b(_B.a(n,[2,1,1,3,1,1]));a.y("ReadWriteRecipientWellView");a.I(26);a.cG(!0);var h=new _fc.b(_B.a(n,[2,1,1,3,1,0,0]));h.l=!0;h.C(-1);h.N(!0);var wi=new _js.c(_B.a(n,[2,1,1,3,1,0]));var pi=new _js.c(_B.a(n,[2,1,1,3,1]));var nt=new _fc.b(_B.a(n,[2,1,1,3,0]));nt.C(-1);var bt=new _js.c(_B.a(n,[2,1,1,3]));var e=new _js.b(_B.a(n,[2,1,1,2,2,0]));e.y("ReadOnlyRecipientWellView");e.cG(!0);e.T(!0);var bi=new _js.c(_B.a(n,[2,1,1,2,2]));var f=new _js.b(_B.a(n,[2,1,1,2,1,1]));f.y("ReadWriteRecipientWellView");f.cG(!0);f.I(26);f.T(!0);var b=new _fc.b(_B.a(n,[2,1,1,2,1,0,0]));b.l=!0;b.C(-1);b.N(!0);var yi=new _js.c(_B.a(n,[2,1,1,2,1,0]));var li=new _js.c(_B.a(n,[2,1,1,2,1]));var it=new _fc.b(_B.a(n,[2,1,1,2,0]));it.C(-1);var ht=new _js.c(_B.a(n,[2,1,1,2]));var rt=new _js.b(_B.a(n,[2,1,1,1,2,0]));rt.y("ReadOnlyRecipientWellView");rt.T(!0);var gi=new _js.c(_B.a(n,[2,1,1,1,2]));var r=new _js.b(_B.a(n,[2,1,1,1,1,1]));r.y("ReadWriteRecipientWellView");r.I(26);r.T(!0);var w=new _fc.b(_B.a(n,[2,1,1,1,1,0,0]));w.l=!0;w.C(-1);w.N(!0);var fr=new _js.c(_B.a(n,[2,1,1,1,1,0]));var nr=new _js.c(_B.a(n,[2,1,1,1,1]));var ut=new _fc.b(_B.a(n,[2,1,1,1,0]));ut.C(0);var g=new _mcp.i(_B.a(n,[2,1,1,0,0]));g.y("MailComposeView._tid1");var vi=new _js.c(_B.a(n,[2,1,1]));var v=_js.a.Instance.a(_js.L.$$(_b.x)).a(_B.a(n,[2,1,0]));v.g="_mcp_C";v.C(0);var y=new _js.c(_B.a(n,[2,1]));y.C(-1);var wt=new _fc.g;var tt=new _fc.c;tt.A(_E.a(["TouchComponent","CloseCommand"],[_mcp._TI.ei,_mcp._TI.fq],null,"Command",null,_mcp._TI.p,1));tt.i("ESC");var p=new _fc.c;p.A(_E.a(["SaveComponent","SaveCommand"],[_mcp._TI.bY,_mcp._TI.cJ],null,"Command",null,_mcp._TI.p,1));p.i("S");p.j=2;var d=new _fc.c;d.A(_E.a(["SendComponent","AltSSendCommand"],[_mcp._TI.T,_mcp._TI.cX],null,"Command",null,_mcp._TI.p,1)).A(_E.a(["DoesSupportAltSForSend"],[_mcp._TI.cY],null,"PreventDefault",null,_mcp._TI.W,1,null,null,!1));d.i("S");d.j=4;var k=new _fc.c;k.A(_E.a(["SendComponent","SendCommand"],[_mcp._TI.T,_mcp._TI.Y],null,"Command",null,_mcp._TI.p,1));k.i("ENTER");k.j=2;var s=new _fc.c;s.A(_E.a(["RecipientComponent","ResolveCommand"],[_mcp._TI.d,_mcp._TI.cV],null,"Command",null,_mcp._TI.p,1));s.i("K");s.j=2;var o=new _fc.c;o.D(_E.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp._TI.l,_mcp._TI.l,_mcp._TI.bx],null,"Command",null,_mcp._TI.p,1)).D(_E.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.l,_mcp._TI.l,_mcp._TI.L],null,"PreventDefault",null,_mcp._TI.W,1,null,null,!1)).D(_E.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.l,_mcp._TI.l,_mcp._TI.L],null,"StopPropagation",null,_mcp._TI.by,1,null,null,!1));o.i("TAB");o.j=1;wt.a([tt,p,d,k,s,o]);y.G([wt]);var si=new _fce.g(_B.a(n,[2,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));var ci=new _fce.f(n.children[2],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));var ai=new _js.c(n.children[1]);var et=new _fce.g(n.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));et.a=0;et.d("");return new _B(n,[et,ai,ci,si,y,v,vi,g,ut,nr,fr,w,r,gi,rt,ht,it,li,yi,b,f,bi,e,bt,nt,pi,wi,h,a,rr,l,ir,ni,oi,fi,ri,ui,gt,ft,hi,lt,ti,ii,kt,dt,tr,u,ki,di,t,pt,ur,yt,ct,st,ot,vt,at,ei]).R({ComposeViewContent:y,InfoBarControl:v,FromFieldControl:g,ToRecipientButton:ut,ToRecipientWellControl:r,CcRecipientWellControl:ht,CcRecipientButton:it,BccRecipientWellControl:bt,BccRecipientButton:nt,SubjectTextBox:ft,AttachmentWellViewWrapper:u,EditorControl:t,QuotedBodyHtmlLabel:yt,MessageBox:st,CancelConfirmDialog:ot})},_mcp.d,_mcp.l,function(n){return new _mcp.l(n,_js.a.Instance.a(_js.F),_js.a.Instance.a(_a.e),_js.a.Instance.a(_a.t),_js.a.Instance.a(_a.h),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.w),_js.a.Instance.a(_b.e))},!1,!1,!1,0,_mcp._TI.a);var n="MailComposeAggregatedRecipientWellView._tidj1";new _A(n,function(){_mcp._TI.a[n]===undefined&&(_mcp._TI.a[n]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.R.NV]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.dA,0,null,null,null,_u.R.Fy],[-1,0,["RecipientComponent","To","AggregatedRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.I,_mcp._TI.bV],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[54].cloneNode(!0);var i=new _rw.c(t.children[1]);i.y("ReadOnlyRecipientWellExpandCollapseView");var r=new _fc.a(t.children[0]);return new _B(t,[r,i])},_mcp.e,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var t="MailComposeAggregatedRecipientWellView._tidk1";new _A(t,function(){_mcp._TI.a[t]===undefined&&(_mcp._TI.a[t]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.R.QZ]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.dA,0,null,null,null,_u.R.FQ],[-1,0,["RecipientComponent","Cc","AggregatedRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.D,_mcp._TI.bV],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[55].cloneNode(!0);var i=new _rw.c(n.children[1]);i.y("ReadOnlyRecipientWellExpandCollapseView");var r=new _fc.a(n.children[0]);return new _B(n,[r,i])},_mcp.e,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var f="MailComposeAggregatedRecipientWellView._tidl1";new _A(f,function(){_mcp._TI.a[f]===undefined&&(_mcp._TI.a[f]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.R.NG]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.dA,0,null,null,null,_u.R.CO],[-1,0,["RecipientComponent","Bcc","AggregatedRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.C,_mcp._TI.bV],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[56].cloneNode(!0);var t=new _rw.c(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _B(n,[i,t])},_mcp.e,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var h="MailComposeAggregatedRecipientWellView._tidm1";new _A(h,function(){_mcp._TI.a[h]===undefined&&(_mcp._TI.a[h]=[[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.bW,_mcp._TI.bS],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.e,_mcp._TI.bQ],null,"Id",null,_mcp._TI.B,1,_mcp._TI.bG(),!1,null]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_mcp.c.c()],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.bt,_mcp._TI.bP],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_mcp.c.u()],[-1,0,["AttachmentComponent","AttachmentsVisibleCount"],[_mcp._TI.w,_mcp._TI.dI],null,"IsHidden",null,_mcp._TI.b,1,new _js.j([_mcp._TI.dz(),_mcp._TI.c()],[0,null]),null,!0]],[[-1,0,["AttachmentComponent","AttachmentsVisibleCount"],[_mcp._TI.w,_mcp._TI.dI],null,"IsHidden",null,_mcp._TI.b,1,new _js.j([_mcp._TI.dz(),_mcp._TI.c()],[0,null]),null,!0],[-1,0,["AttachmentComponent","AttachmentsVisibleCount"],[_mcp._TI.w,_mcp._TI.dI],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.k,0,null,null,null,_mcp.c.s()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.o,0,null,null,null,_mcp.c.t()],[-1,4,null,null,null,"Title",null,_mcp._TI.z,0,null,null,null,_nbs.a.hu],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.hu],[-1,0,["NavigationComponent","UpconvertCommand"],[_mcp._TI.bw,_mcp._TI.ez],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[57].cloneNode(!0);var t=new _fc.b(n.children[4]);t.a("ms-font-color-black");t.C(-1);var u=new _fc.a(n.children[3]);var f=new _fc.d(n.children[2],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var i=new _fc.d(n.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var r=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[r,i,f,u,t])},_mcp.e,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var c="MailComposeAggregatedRecipientWellView";new _A(c,function(){_mcp._TI.a[c]===undefined&&(_mcp._TI.a[c]=[null,[[-1,0,["RecipientComponent","Cc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp._TI.d,_mcp._TI.D,_mcp._TI.bV,_mcp._TI.ew,_mcp._TI.cb],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.bH(),null,!0]],[[-1,0,["RecipientComponent","Bcc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp._TI.d,_mcp._TI.C,_mcp._TI.bV,_mcp._TI.ew,_mcp._TI.cb],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.bH(),null,!0]],[[-1,5,["DisplayEllipsis"],[_mcp._TI.fU],null,"_mcp_V4:hidden",null,null,1,null,null,null]],[[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_05",null,null,0,null,null,null]]]);var n=_mcp._TI._hf.childNodes[58].cloneNode(!0);var u=new _js.b(_B.a(n,[0,2]));u.y("MailComposeAggregatedRecipientWellView._tidm1");var f=new _js.c(_B.a(n,[0,1]));var t=new _js.b(_B.a(n,[0,0,0,2]));t.C(-1);t.y("MailComposeAggregatedRecipientWellView._tidl1");var i=new _js.b(_B.a(n,[0,0,0,1]));i.C(-1);i.y("MailComposeAggregatedRecipientWellView._tidk1");var r=new _js.b(_B.a(n,[0,0,0,0]));r.C(-1);r.y("MailComposeAggregatedRecipientWellView._tidj1");return new _B(n,[r,i,t,f,u])},_mcp.e,_mcp.L,function(n){return new _mcp.L(n)},!1,!1,!1,0,_mcp._TI.a);var s="MessageOptionsView._tidn1";new _A(s,function(){_mcp._TI.a[s]===undefined&&(_mcp._TI.a[s]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.Lj],[-1,0,["SmimeEncryptMessage"],[_mcp._TI.fO],_mcp._TI.fS,"IsChecked",_mcp._TI.bE,_mcp._TI.bF,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp._TI.fP],null,"IsEnabled",null,_mcp._TI.dg,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.MQ],[-1,0,["SmimeSignMessage"],[_mcp._TI.fQ],_mcp._TI.fT,"IsChecked",_mcp._TI.bE,_mcp._TI.bF,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp._TI.fR],null,"IsEnabled",null,_mcp._TI.dg,1,null,null,!1]]]);var n=_mcp._TI._hf.childNodes[59].cloneNode(!0);var i=new _fc.i(n.children[1],_js.a.Instance.a(_ff.a));var t=new _fc.i(n.children[0],_js.a.Instance.a(_ff.a));return new _B(n,[t,i])},_mcp.D,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var e="MessageOptionsView.SensitivityTemplate";new _A(e,function(){_mcp._TI.a[e]===undefined&&(_mcp._TI.a[e]=[[[-1,1,["DataContext"],[_mcp._TI.bz],null,"Text",null,_mcp._TI.h,1,_mcp._TI.en(),null,null]]]);var n=_mcp._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},Object,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a);var o="MessageOptionsView";new _A(o,function(){_mcp._TI.a[o]===undefined&&(_mcp._TI.a[o]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.Tf]],[[-1,0,["SensitivityOptions"],[_mcp._TI.eI],null,"Options",null,_mcp._TI.eV,1,null,null,null],[-1,0,["Sensitivity"],[_mcp._TI.eH],_mcp._TI.eN,"SelectedValue",_mcp._TI.eU,_mcp._TI.eW,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.WK],[-1,0,["IsDeliveryReceiptRequested"],[_mcp._TI.eF],_mcp._TI.eL,"IsChecked",_mcp._TI.bE,_mcp._TI.bF,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp._TI.eJ],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.ZT],[-1,0,["IsReadReceiptRequested"],[_mcp._TI.eG],_mcp._TI.eM,"IsChecked",_mcp._TI.bE,_mcp._TI.bF,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp._TI.eK],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp._TI.fN],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.c(),null,!0]]]);var n=_mcp._TI._hf.childNodes[60].cloneNode(!0);var i=new _js.b(n.children[4]);i.y("MessageOptionsView._tidn1");var u=new _fc.i(n.children[3],_js.a.Instance.a(_ff.a));var f=new _fc.i(n.children[2],_js.a.Instance.a(_ff.a));var t=new _fce.j(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,f,u,i])},_mcp.D,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a)};_mcp._TI.ff=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mcp_2'></span> <span class='_mcp_2'></span> </div><div> <span></span> </div><div> <div class='_mcp_s ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_e'></button> <div class='_mcp_u'></div> <div class='_mcp_c'></div> <div class='_mcp_c'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_j ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_q'></span> <span class='_mcp_q'></span> </div><div> <span class='_mcp_q'></span> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_n _mcp_o _mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <div class='_mcp_7'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_W _mcp_X'></div>  <div class='_mcp_W _mcp_Y'></div> </div><div> <span class='_mcp_g ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_f'></span> </div><div> <div class='_mcp_F'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_H'> <div class='_mcp_I ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_O'></div> <div class='_mcp_M'> <div class='_mcp_a'> <div class='_mcp_5 _mcp_N _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_5 _mcp_R _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_E'></button> <div> <div class='_mcp_D'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_R _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_E'></button> <div> <div class='_mcp_D'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_R _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_E'></button> <div> <div class='_mcp_D'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_9 _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <span class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_k'></span> <div class='_mcp_r'> <button type='button' class='_mcp_w _mcp_m'></button> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <button type='button' class='_mcp_w ms-font-xl'></button> <div class='_mcp_x'> <input autoid=\"_mcp_3\" class='_mcp_s _mcp_t ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6'></div> <div class='_mcp_6 ms-bg-color-white'></div> </div> <div> <div class='_mcp_5 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_M ms-bg-color-white'> <div autoid=\"_mcp_4\" class='_mcp_y'></div> <div class='_mcp_J ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_M ms-bg-color-white'> <span class='_mcp_A ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_G'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_C1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_q1'></button> <div class='_mcp_F1'></div> <div class='_mcp_n1'></div> <div class='_mcp_n1'></div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <span autoid=\"_mcp_l\" class='_mcp_v1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_K1'></span> <span class='_mcp_K1'></span> </div><div> <span class='_mcp_K1'></span> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <div> <span class='_mcp_K1 _mcp_J1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_L1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <span autoid=\"_mcp_m\" class='_mcp_J1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <span autoid=\"_mcp_n\" class='_mcp_J1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black _mcp_w1'></span> <div class='_mcp_y1'> <div class='_mcp_j1'></div> </div> </div><div> <button autoid=\"_mcp_o\" type='button'></button> <div></div> </div><div> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_r1'></span> </div><div> <iframe autoid=\"_mcp_t\" class='_mcp_62'></iframe> </div><div> <div class='_mcp_72'> <button type='button' class='_mcp_82 _mcp_P1 ms-font-weight-regular'></button> <span></span> </div> </div><div> <div></div> <div class='_mcp_Z1'></div> <span class='_mcp_Z1'></span> <div class='_mcp_81 ms-bg-color-white'> <div class='_mcp_52'></div> <div class='_mcp_b1'>  <span class='_mcp_d1'> <div class='_mcp_U1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_P1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_P1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_P1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_P1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_P1 ms-font-weight-regular _mcp_S1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_P1 ms-font-weight-regular'></button> </span> <span class='_mcp_e1'> <button autoid=\"_mcp_b\" type='button' class='_mcp_P1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_c1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_11'> <div class='_mcp_21 _mcp_51'></div> <div class='_mcp_21 _mcp_41'> <div class='_mcp_61 ms-bg-color-white customScrollBar'>  <div class='_mcp_f1 ms-font-weight-regular'></div> <div class='_mcp_h1 _mcp_m1 ms-border-color-neutralTertiary'></div> <div class='_mcp_h1 _mcp_k1 _mcp_m1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_32'></button> <div class='_mcp_y1 _mcp_A1 _mcp_z1'> <div class='_mcp_22'> <button autoid=\"_mcp_e\" type='button'></button> </div> <div autoid=\"_mcp_f\" class='_mcp_W1'></div> </div> <div class='_mcp_y1 _mcp_A1 _mcp_z1 _mcp_B1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_h1 _mcp_k1 _mcp_m1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_32'></button> <div class='_mcp_y1 _mcp_A1 _mcp_z1'> <div class='_mcp_22'> <button type='button'></button> </div> <div autoid=\"_mcp_g\" class='_mcp_W1'></div> </div> <div class='_mcp_y1 _mcp_A1 _mcp_z1 _mcp_B1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_h1 _mcp_k1 _mcp_m1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_32'></button> <div class='_mcp_y1 _mcp_A1 _mcp_z1'> <div class='_mcp_22'> <button type='button'></button> </div> <div autoid=\"_mcp_h\" class='_mcp_W1'></div> </div> <div class='_mcp_y1 _mcp_A1 _mcp_z1 _mcp_B1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_h1'> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_x1 '></span> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_x1 '></span> </div> <div class='_mcp_h1 _mcp_i1 _mcp_m1 ms-border-color-neutralTertiary'> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_x1'></span> <div class='_mcp_y1'> <span class='_mcp_Y1'></span> <span autoid=\"_mcp_i\" class='_mcp_X1'></span> <span autoid=\"_mcp_j\" class='_mcp_X1'></span> <span class='_mcp_X1'></span> <div class='_mcp_W1'> <input autoid=\"_mcp_k\" class='_mcp_C1 _mcp_D1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_l1'></div> <div class='_mcp_l1'></div> <div class='_mcp_l1'></div> <div class='_mcp_l1'></div> <div class='_mcp_l1'></div> </div> <div class='_mcp_H1 ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> <span></span> <span></span> <div class='_mcp_M1'></div> <div class='_mcp_92 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_02 ms-bg-color-white'></div> <div autoid=\"_mcp_p\"></div> <div autoid=\"_mcp_q\"></div> <div></div> <div></div>  <div autoid=\"_mcp_r\"></div> <div autoid=\"_mcp_s\"></div>     </div><div> <div class='_mcp_R2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_u\" type='button' class='_mcp_E2'></button> <div class='_mcp_U2'></div> <div class='_mcp_C2'></div> <div class='_mcp_C2'></div> <div></div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <span autoid=\"_mcp_A\" class='_mcp_J2 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_13'></span> <span class='_mcp_13'></span> </div><div> <span class='_mcp_13'></span> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <div> <span class='_mcp_13 _mcp_03 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_23'></span> <div></div> </div> </div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <span autoid=\"_mcp_B\" class='_mcp_03 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <span autoid=\"_mcp_C\" class='_mcp_03 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black _mcp_K2'></span> <div class='_mcp_M2'> <div class='_mcp_t2'></div> </div> </div><div> <span class='ms-font-weight-regular ms-font-color-neutralSecondary ms-font-m'></span> </div><div> <span class='_mcp_p2'></span> <span class='_mcp_p2'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_p2'></button> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_p2'></button> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_z2 _mcp_p2 _mcp_q2 ms-border-color-neutralTertiary'></button> </div><div> <div class='_mcp_k2 _mcp_n2'></div> </div><div> <div class='_mcp_o3'></div> <span class='_mcp_o3'></span> <div class='_mcp_b2'> <div class='_mcp_c2 _mcp_t3'></div> <div class='_mcp_c2 _mcp_d2 ms-bg-color-white'> <div class='_mcp_f2'> <div class='_mcp_l2 ms-font-weight-regular'></div> </div> <div class='ms-border-color-neutralTertiary _mcp_y2'> <div class='_mcp_e2 ms-bg-color-white customScrollBar _mcp_A2 ms-border-color-neutralTertiary'>  <div class='_mcp_v2'> <div></div>  </div> <div> <div class='_mcp_r2 _mcp_A2 ms-border-color-neutralLight'></div> <div class='_mcp_r2 _mcp_u2'> <button autoid=\"_mcp_v\" type='button' class='_mcp_H2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_r3'></button> <div class='_mcp_M2 _mcp_N2'> <div autoid=\"_mcp_w\" class='_mcp_l3'></div> </div> <div class='_mcp_M2 _mcp_N2 _mcp_O2'> <div class='_mcp_l3'></div> </div> <div></div>  </div> <div class='_mcp_r2 _mcp_u2 _mcp_B2 ms-border-color-neutralLight'> <button type='button' class='_mcp_H2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_r3'></button> <div class='_mcp_M2 _mcp_N2'> <div autoid=\"_mcp_x\" class='_mcp_l3'></div> </div> <div class='_mcp_M2 _mcp_O2'> <div class='_mcp_l3'></div> </div>  </div> <div class='_mcp_r2 _mcp_u2 _mcp_B2 ms-border-color-neutralLight'> <button type='button' class='_mcp_H2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_r3'></button> <div class='_mcp_M2 _mcp_N2'> <div autoid=\"_mcp_y\" class='_mcp_l3'></div> </div> <div class='_mcp_M2 _mcp_O2'> <div class='_mcp_l3'></div> </div>  </div> <div class='_mcp_r2'> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_L2 '></span> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_L2 '></span> </div> <div class='_mcp_r2 _mcp_s2 _mcp_A2 ms-border-color-neutralTertiary'> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_L2'></span> <div class='_mcp_M2'> <div class='_mcp_l3'> <input autoid=\"_mcp_z\" class='_mcp_R2 _mcp_S2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_x2'></div> <div class='_mcp_x2'></div> <div class='_mcp_x2'></div> <div class='_mcp_x2'></div> <div class='_mcp_x2'></div> </div> <div class='_mcp_W2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_X2 ms-border-color-neutralLight'></div> </div> </div> <span></span> <span></span> <div class='_mcp_33'> <div></div> </div> <div class='_mcp_x3'> <button autoid=\"_mcp_D\" type='button'></button> <div></div> </div> </div> <div class='_mcp_f2 ms-bg-color-white ms-border-color-neutralTertiary'> <div class='_mcp_h2'>  <span> <div class='_mcp_j3'> <button autoid=\"_mcp_E\" type='button' class='_mcp_83 _mcp_b3'></button> <button type='button' class='_mcp_73 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_j3'> <button autoid=\"_mcp_F\" type='button' class='_mcp_83 _mcp_c3'></button> </div> <div class='_mcp_j3'> <button autoid=\"_mcp_G\" type='button' class='_mcp_d3'></button> </div> <div class='_mcp_j3'> <button autoid=\"_mcp_H\" type='button' class='_mcp_d3'></button> </div> <div class='_mcp_j3'> <div></div> </div> <div class='_mcp_j3'> <span class='_mcp_d3 _mcp_z3 ms-fwt-r ms-fcl-nt ms-font-m'></span> </div> <div class='_mcp_j3'> <button type='button' class='_mcp_d3'></button> </div> <div class='_mcp_j3'> <button autoid=\"_mcp_I\" type='button' class='_mcp_d3'></button> </div> <div class='_mcp_j3'> <button autoid=\"_mcp_J\" type='button' class='_mcp_d3'></button> </div> </span> <span class='_mcp_k2'> <button autoid=\"_mcp_K\" type='button' class='_mcp_73 ms-font-weight-regular'></button> <div class='_mcp_A3'></div> </span> </div> <div class='_mcp_i2 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_p3 ms-bg-color-white'></div> <div autoid=\"_mcp_L\"></div> <div></div> <div></div> <div autoid=\"_mcp_M\"></div> <div autoid=\"_mcp_N\"></div>  </div><div> <div class='_mcp_94 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_O\" type='button' class='_mcp_X3'></button> <div class='_mcp_c4'></div> <div class='_mcp_U3'></div> <div class='_mcp_U3'></div> </div><div> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_54'> <span autoid=\"_mcp_X\" class='_mcp_24 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_i4'></span> <span class='_mcp_i4'></span> </div><div> <span class='_mcp_i4'></span> </div><div> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_54'> <div> <span class='_mcp_i4 _mcp_h4 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_j4'></span> <div></div> </div> </div> </div><div> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_54'> <span autoid=\"_mcp_Y\" class='_mcp_h4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_54'> <span autoid=\"_mcp_Z\" class='_mcp_h4 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black _mcp_34'></span> <div class='_mcp_54'> <div class='_mcp_Q3'></div> </div> </div><div> <button autoid=\"_mcp_01\" type='button'></button> <div></div> </div><div> <div class='_mcp_E4'></div> <span class='_mcp_E4'></span> <div class='_mcp_C3'> <div class='_mcp_D3 _mcp_K4'></div> <div class='_mcp_D3 _mcp_E3 ms-bg-color-white'> <div class='_mcp_F3 ms-bg-color-white customScrollBar'>  <div class='_mcp_M3 ms-font-weight-regular'></div> <div class='_mcp_O3 _mcp_T3 ms-border-color-neutralTertiary'></div> <div class='_mcp_O3 _mcp_R3 _mcp_T3 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_P\" type='button' class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_I4'></button> <div class='_mcp_54 _mcp_74 _mcp_64'> <div class='_mcp_H4'> <button autoid=\"_mcp_Q\" type='button'></button> </div> <div autoid=\"_mcp_R\" class='_mcp_B4'></div> </div> <div class='_mcp_54 _mcp_74 _mcp_64'> <div class='_mcp_B4'></div> </div>  </div> <div class='_mcp_O3 _mcp_R3 _mcp_T3 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_I4'></button> <div class='_mcp_54 _mcp_74 _mcp_64'> <div class='_mcp_H4'> <button type='button'></button> </div> <div autoid=\"_mcp_S\" class='_mcp_B4'></div> </div> <div class='_mcp_54 _mcp_74'> <div class='_mcp_B4'></div> </div>  </div> <div class='_mcp_O3 _mcp_R3 _mcp_T3 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_I4'></button> <div class='_mcp_54 _mcp_74 _mcp_64'> <div class='_mcp_H4'> <button type='button'></button> </div> <div autoid=\"_mcp_T\" class='_mcp_B4'></div> </div> <div class='_mcp_54 _mcp_74'> <div class='_mcp_B4'></div> </div>  </div> <div class='_mcp_O3'> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_44 '></span> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_44 '></span> </div> <div class='_mcp_O3 _mcp_P3 _mcp_T3 ms-border-color-neutralTertiary'> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_44'></span> <div class='_mcp_54'> <span class='_mcp_D4'></span> <span autoid=\"_mcp_U\" class='_mcp_C4'></span> <span autoid=\"_mcp_V\" class='_mcp_C4'></span> <span class='_mcp_C4'></span> <div class='_mcp_B4'> <input autoid=\"_mcp_W\" class='_mcp_94 _mcp_a4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_S3'></div> <div class='_mcp_S3'></div> <div class='_mcp_S3'></div> <div class='_mcp_S3'></div> <div class='_mcp_S3'></div> </div> </div> <span></span> <span></span> <div class='_mcp_k4 ms-bg-color-white'></div> <div class='_mcp_O4 ms-border-color-neutralTertiary'></div> <div class='_mcp_e4 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_f4 ms-bg-color-white'></div> <div class='_mcp_G3 ms-bg-color-white ms-border-color-neutralTertiary'> <div class='_mcp_I3'>  <span> <div class='_mcp_z4'> <button autoid=\"_mcp_11\" type='button' class='_mcp_o4 _mcp_r4'></button> <button type='button' class='_mcp_n4 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_z4'> <button autoid=\"_mcp_21\" type='button' class='_mcp_o4 _mcp_s4'></button> </div> <div class='_mcp_y4'> <button autoid=\"_mcp_31\" type='button' class='_mcp_n4 ms-font-weight-regular _mcp_w4'></button> </div> <button autoid=\"_mcp_41\" type='button' class='_mcp_n4 ms-font-weight-regular'></button> </span> <span class='_mcp_L3'> <div class='_mcp_z4'> <button autoid=\"_mcp_51\" type='button' class='_mcp_t4'></button> <button autoid=\"_mcp_61\" type='button' class='_mcp_t4'></button> </div> <button autoid=\"_mcp_71\" type='button' class='_mcp_n4 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_J3 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_F4 ms-bg-color-white'></div> <div autoid=\"_mcp_81\"></div> <div></div> <div></div> <div autoid=\"_mcp_91\"></div> <div autoid=\"_mcp_a1\"></div> </div><div> <span class='_mcp_W4 _mcp_X4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_S4'></div> </div><div> <span class='_mcp_W4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_T4'></div> </div><div> <span class='_mcp_W4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_U4'></div> </div><div> <span class='_mcp_15'></span> <span class='_mcp_15'></span> <span class='_mcp_25'></span> <span class='ms-font-weight-regular ms-font-color-neutralSecondary ms-font-m _mcp_15'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_15 _mcp_35 ms-border-color-neutralTertiary'></button> </div><div> <div class='ms-font-color-neutralSecondary ms-font-s _mcp_Y4'> <div class='_mcp_Q4 _mcp_P4'> <div class='_mcp_R4'>  <div class='_mcp_S4'></div>  <div class='_mcp_T4'></div>  <div class='_mcp_U4'></div> </div> </div> <span>\n                    ...\n                </span> <div class='_mcp_Z4'></div> </div> </div><div> <button autoid=\"_mcp_e1\" type='button' class='_mcp_65'></button> <button autoid=\"_mcp_f1\" type='button' class='_mcp_65'></button> </div><div> <span class='_mcp_45 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_b1\" class='_mcp_55'></div> <button autoid=\"_mcp_c1\" type='button' class='_mcp_65'></button> <button autoid=\"_mcp_d1\" type='button' class='_mcp_65'></button>  <div></div> <div class='_mcp_75'></div>  </div><div> <span class='_mcp_85 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_95'></div> <button type='button' class='_mcp_a5'></button> <button type='button' class='_mcp_a5'></button>  </div>";_js.c.a().appendChild(n);return n};_mcp._TI.fx=function(n){return n.b};_mcp._TI.fw=function(n){return n.a};_mcp._TI.d=function(n){return n.Q()};_mcp._TI.H=function(n){return n.h};_mcp._TI.cU=function(n){return n.r()};_mcp._TI.S=function(n){return n.ce()};_mcp._TI.M=function(n){return n.b()};_mcp._TI.F=function(n){return n.i};_mcp._TI.ba=function(n){return n.c()};_mcp._TI.cW=function(n){return n.bF};_mcp._TI.e=function(n){return n.L};_mcp._TI.bl=function(n){return n.w()};_mcp._TI.s=function(n){return n.dw()};_mcp._TI.cS=function(n){return n.b()};_mcp._TI.bz=function(n){return n.E()};_mcp._TI.bm=function(n){return n.c()};_mcp._TI.bn=function(n){return n.e()};_mcp._TI.cQ=function(n){return _mcp.a.isInstanceOfType(n)?n.fT():null};_mcp._TI.cP=function(n){return _mcp.a.isInstanceOfType(n)?n.eo():null};_mcp._TI.cB=function(n){return n.cc()};_mcp._TI.cR=function(n){return n.h()};_mcp._TI.J=function(n){return n.bw()};_mcp._TI.dX=function(n){return n.a()};_mcp._TI.cM=function(n){return n.i()};_mcp._TI.cL=function(n){return n.h()};_mcp._TI.fh=function(n){return n.c()};_mcp._TI.fi=function(n){return n.d()};_mcp._TI.eT=function(n){return n.w};_mcp._TI.eS=function(n){return n.s()};_mcp._TI.E=function(n){return n.bG};_mcp._TI.eP=function(n){return n.ce};_mcp._TI.eC=function(n){return OwaApplication.b};_mcp._TI.Q=function(n){return n.be()};_mcp._TI.N=function(n){return n.h};_mcp._TI.bk=function(n){return n.l()};_mcp._TI.fJ=function(n){return n.di()};_mcp._TI.dd=function(n){return n.ck};_mcp._TI.bo=function(n){return n.bO};_mcp._TI.ei=function(n){return n.z()};_mcp._TI.fq=function(n){return n.a()};_mcp._TI.bY=function(n){return n.c()};_mcp._TI.cJ=function(n){return n.f()};_mcp._TI.T=function(n){return n.e()};_mcp._TI.cX=function(n){return _mcp.A.isInstanceOfType(n)?n.L:null};_mcp._TI.cY=function(n){return n.cU()};_mcp._TI.Y=function(n){return n.b()};_mcp._TI.cV=function(n){return n.Y};_mcp._TI.l=function(n){return n.L};_mcp._TI.bx=function(n){return _mcp.l.isInstanceOfType(n)?n.du:null};_mcp._TI.L=function(n){return _mcp.l.isInstanceOfType(n)?n.bl:null};_mcp._TI.bu=function(n){return n.M};_mcp._TI.n=function(n){return n.dn()};_mcp._TI.bv=function(n){return n.dq()};_mcp._TI.eO=function(n){return n.dy()};_mcp._TI.bR=function(n){return n.z()};_mcp._TI.I=function(n){return n.c};_mcp._TI.v=function(n){return n.M()};_mcp._TI.g=function(n){return n.dm()};_mcp._TI.r=function(n){return n.g};_mcp._TI.eQ=function(n){return n.eO()};_mcp._TI.ef=function(n){return n.dk()};_mcp._TI.P=function(n){return n.a};_mcp._TI.bA=function(n){return _rw.a.isInstanceOfType(n)?n.dw():null};_mcp._TI.O=function(n){return n.b};_mcp._TI.D=function(n){return n.e};_mcp._TI.ek=function(n){return n.eF()};_mcp._TI.dK=function(n){return n.Q()};_mcp._TI.C=function(n){return n.f};_mcp._TI.ej=function(n){return n.eE()};_mcp._TI.X=function(n){return n.bx()};_mcp._TI.bt=function(n){return n.bE()};_mcp._TI.fm=function(n){return n.i()};_mcp._TI.bP=function(n){return n.a()};_mcp._TI.dN=function(n){return n.E()};_mcp._TI.dM=function(n){return n.q()};_mcp._TI.bW=function(n){return n.cV()};_mcp._TI.bS=function(n){return n.c()};_mcp._TI.bQ=function(n){return n.ba()};_mcp._TI.eg=function(n){return n.du()};_mcp._TI.fz=function(n){return n.g()};_mcp._TI.ey=function(n){return n.e()};_mcp._TI.dk=function(n){return n.b};_mcp._TI.cO=function(n){return _mcp.a.isInstanceOfType(n)?255:null};_mcp._TI.cC=function(n){return n.cd()};_mcp._TI.cN=function(n){return _mcp.a.isInstanceOfType(n)?n.eO():null};_mcp._TI.cA=function(n){return n.bW()};_mcp._TI.w=function(n){return n.S()};_mcp._TI.bO=function(n){return n.a()};_mcp._TI.ep=function(n){return n.j()};_mcp._TI.G=function(n){return _mcp.a.isInstanceOfType(n)?n.fM():null};_mcp._TI.bC=function(n){return _mcp.a.isInstanceOfType(n)?n.fL():null};_mcp._TI.cz=function(n){return n.L()};_mcp._TI.dq=function(n){return n.ca()};_mcp._TI.cy=function(n){return n.f()};_mcp._TI.dr=function(n){return n.eF()};_mcp._TI.cZ=function(n){return n.bk()};_mcp._TI.cG=function(n){return n.b()};_mcp._TI.dp=function(n){return n.bZ};_mcp._TI.df=function(n){return n.eD()};_mcp._TI.de=function(n){return n.eC()};_mcp._TI.cK=function(n){return n.e()};_mcp._TI.ev=function(n){return n.cK()};_mcp._TI.da=function(n){return n.U};_mcp._TI.fr=function(n){return n.e()};_mcp._TI.fs=function(n){return n.f()};_mcp._TI.x=function(n){return n.b()};_mcp._TI.fl=function(n){return n.h()};_mcp._TI.bL=function(n){return n.j};_mcp._TI.bM=function(n){return n.p};_mcp._TI.bI=function(n){return n.i};_mcp._TI.bJ=function(n){return n.q};_mcp._TI.bK=function(n){return n.h};_mcp._TI.db=function(n){return n.bB()};_mcp._TI.cI=function(n){return n.a()};_mcp._TI.cu=function(n){return n.D};_mcp._TI.di=function(n){return n.bX};_mcp._TI.fL=function(n){return n.bh};_mcp._TI.A=function(n){return n.dr()};_mcp._TI.bD=function(n){return n.cg};_mcp._TI.bi=function(n){return n.cC()};_mcp._TI.fp=function(n){return n.f()};_mcp._TI.fn=function(n){return n.a()};_mcp._TI.fo=function(n){return n.b()};_mcp._TI.gb=function(n){return n.eR()};_mcp._TI.fX=function(n){return n.eG()};_mcp._TI.gd=function(n){return n.m};_mcp._TI.ga=function(n){return n.eQ()};_mcp._TI.bX=function(n){return n.bf()};_mcp._TI.bU=function(n){return n.e};_mcp._TI.be=function(n){return n.bA()};_mcp._TI.R=function(n){return n.cc()};_mcp._TI.fM=function(n){return n.dt()};_mcp._TI.fk=function(n){return n.a()};_mcp._TI.fZ=function(n){return n.eP()};_mcp._TI.bg=function(n){return n.dt()};_mcp._TI.K=function(n){return n.bg()};_mcp._TI.bB=function(n){return n.a()};_mcp._TI.ex=function(n){return _mcp.m.isInstanceOfType(n)?n.ba:null};_mcp._TI.dJ=function(n){return n.bv()};_mcp._TI.dZ=function(n){return _mcp.m.isInstanceOfType(n)?n.bb:null};_mcp._TI.cx=function(n){return n.h()};_mcp._TI.eE=function(n){return n.cj};_mcp._TI.dc=function(n){return n.bp};_mcp._TI.cw=function(n){return n.c()};_mcp._TI.es=function(n){return n.b()};_mcp._TI.fb=function(n){return n.c()};_mcp._TI.eX=function(n){return n.B};_mcp._TI.eq=function(n){return n.a()};_mcp._TI.er=function(n){return n.b()};_mcp._TI.bh=function(n){return n.bs()};_mcp._TI.bf=function(n){return n.a()};_mcp._TI.fK=function(n){return n.dj()};_mcp._TI.bw=function(n){return n.b()};_mcp._TI.dV=function(n){return n.e()};_mcp._TI.eD=function(n){return n.bN};_mcp._TI.dC=function(n){return n.v()};_mcp._TI.dY=function(n){return n.c};_mcp._TI.cb=function(n){return n.x.length};_mcp._TI.ed=function(n){return n.dw()};_mcp._TI.ee=function(n){return n.dA()};_mcp._TI.ec=function(n){return n.bA};_mcp._TI.eb=function(n){return n.dr()};_mcp._TI.ea=function(n){return n.dq()};_mcp._TI.dL=function(n){return n.cb()};_mcp._TI.el=function(n){return n.dD};_mcp._TI.fY=function(n){return n.bg};_mcp._TI.eh=function(n){return n.ci};_mcp._TI.dO=function(n){return n.g()};_mcp._TI.dP=function(n){return n.h()};_mcp._TI.fA=function(n){return _mcp.x.isInstanceOfType(n)?n.j:null};_mcp._TI.fB=function(n){return _mcp.x.isInstanceOfType(n)?n.m:null};_mcp._TI.dB=function(n){return n.v};_mcp._TI.dW=function(n){return n.g()};_mcp._TI.dF=function(n){return n.c()};_mcp._TI.dG=function(n){return n.e()};_mcp._TI.dD=function(n){return n.a()};_mcp._TI.dE=function(n){return n.b()};_mcp._TI.dS=function(n){return n.e()};_mcp._TI.dR=function(n){return n.c()};_mcp._TI.eB=function(n){return _mcp.z.isInstanceOfType(n)?n.U:null};_mcp._TI.fI=function(n){return n.dz()};_mcp._TI.fG=function(n){return n.dy()};_mcp._TI.fH=function(n){return n.K};_mcp._TI.ez=function(n){return _mcp.k.isInstanceOfType(n)?n.N:null};_mcp._TI.eA=function(n){return n.bI};_mcp._TI.fg=function(n){return n.n()};_mcp._TI.fD=function(n){return _mcp.k.isInstanceOfType(n)?n.L:null};_mcp._TI.fy=function(n){return _mcp.m.isInstanceOfType(n)?n.A:null};_mcp._TI.eu=function(n){return n.f()};_mcp._TI.eR=function(n){return n.cr};_mcp._TI.fV=function(n){return n.bf()};_mcp._TI.fW=function(n){return n.ef()};_mcp._TI.fF=function(n){return _mcp.k.isInstanceOfType(n)?n.P:null};_mcp._TI.fE=function(n){return _mcp.k.isInstanceOfType(n)?n.M:null};_mcp._TI.t=function(n){return n.a()};_mcp._TI.fv=function(n){return n.c()};_mcp._TI.bT=function(n){return n.e()};_mcp._TI.fu=function(n){return n.b()};_mcp._TI.bV=function(n){return n.f};_mcp._TI.dI=function(n){return n.n()};_mcp._TI.ew=function(n){return n.a()};_mcp._TI.fU=function(n){return n.a};_mcp._TI.fO=function(n){return n.a};_mcp._TI.bE=function(n){return n.p()};_mcp._TI.fP=function(n){return n.i};_mcp._TI.fQ=function(n){return n.b};_mcp._TI.fR=function(n){return n.j};_mcp._TI.eI=function(n){return n.r()};_mcp._TI.eH=function(n){return n.d};_mcp._TI.eU=function(n){return n.b()};_mcp._TI.eF=function(n){return n.e};_mcp._TI.eJ=function(n){return!OwaApplication.b};_mcp._TI.eG=function(n){return n.f};_mcp._TI.eK=function(n){return!OwaApplication.b};_mcp._TI.fN=function(n){return n.h};_mcp._TI.h=function(n,t){n.a(t)};_mcp._TI.f=function(n,t){n.ba(t)};_mcp._TI.k=function(n,t){n.i(t)};_mcp._TI.m=function(n,t){n.g(t)};_mcp._TI.j=function(n,t){n.bb(t)};_mcp._TI.bc=function(n,t){n.d(t)};_mcp._TI.bd=function(n,t){n.j(t)};_mcp._TI.bb=function(n,t){n.e(t)};_mcp._TI.b=function(n,t){n.M(t)};_mcp._TI.cT=function(n,t){n.a(t)};_mcp._TI.ct=function(n,t){n.a(t)};_mcp._TI.i=function(n,t){n.be(t)};_mcp._TI.o=function(n,t){n.j(t)};_mcp._TI.V=function(n,t){n.q(t)};_mcp._TI.U=function(n,t){n.c(t)};_mcp._TI.bp=function(n,t){n.d(t)};_mcp._TI.B=function(n,t){n.a(t)};_mcp._TI.dh=function(n,t){n.b(t)};_mcp._TI.p=function(n,t){n.k=t};_mcp._TI.W=function(n,t){n.m=t};_mcp._TI.by=function(n,t){n.l=t};_mcp._TI.dn=function(n,t){n.e(t)};_mcp._TI.q=function(n,t){n.bb(t)};_mcp._TI.cF=function(n,t){n.J(t)};_mcp._TI.dm=function(n,t){n.c(t)};_mcp._TI.dl=function(n,t){n.a(t)};_mcp._TI.fj=function(n,t){n.s(t)};_mcp._TI.cc=function(n,t){n.gX(t)};_mcp._TI.dw=function(n,t){n.jK(t)};_mcp._TI.cE=function(n,t){n.H(t)};_mcp._TI.dt=function(n,t){n.cv(t)};_mcp._TI.cD=function(n,t){n.m(t)};_mcp._TI.dv=function(n,t){n.dc(t)};_mcp._TI.cH=function(n,t){n.a(t)};_mcp._TI.ds=function(n,t){n.bq(t)};_mcp._TI.du=function(n,t){n.cj=t};_mcp._TI.dy=function(n,t){n.bV(t)};_mcp._TI.dx=function(n,t){n.cH=t};_mcp._TI.gh=function(n,t){n.cg(t)};_mcp._TI.eo=function(n,t){n.a(t)};_mcp._TI.ce=function(n,t){n.j(t)};_mcp._TI.cd=function(n,t){n.d(t)};_mcp._TI.ft=function(n,t){n.h(t)};_mcp._TI.y=function(n,t){n.a(t)};_mcp._TI.bN=function(n,t){n.g(t)};_mcp._TI.br=function(n,t){n.k(t)};_mcp._TI.bs=function(n,t){n.i(t)};_mcp._TI.ca=function(n,t){n.m(t)};_mcp._TI.bq=function(n,t){n.j(t)};_mcp._TI.cv=function(n,t){n.r(t)};_mcp._TI.dj=function(n,t){n.dj(t)};_mcp._TI.ge=function(n,t){n.a(t)};_mcp._TI.gf=function(n,t){n.I(t)};_mcp._TI.z=function(n,t){n.by(t)};_mcp._TI.gl=function(n,t){n.j(t)};_mcp._TI.Z=function(n,t){n.dH(t)};_mcp._TI.fa=function(n,t){n.b(t)};_mcp._TI.eZ=function(n,t){n.m(t)};_mcp._TI.et=function(n,t){n.a(t)};_mcp._TI.fc=function(n,t){n.e(t)};_mcp._TI.eY=function(n,t){n.d(t)};_mcp._TI.bj=function(n,t){n.a=t};_mcp._TI.gc=function(n,t){n.dI(t)};_mcp._TI.dQ=function(n,t){n.i(t)};_mcp._TI.fC=function(n,t){n.r(t)};_mcp._TI.em=function(n,t){n.bB(t)};_mcp._TI.dH=function(n,t){n.f(t)};_mcp._TI.dU=function(n,t){n.h(t)};_mcp._TI.dT=function(n,t){n.g(t)};_mcp._TI.bZ=function(n,t){n.t(t)};_mcp._TI.dg=function(n,t){n.o(t)};_mcp._TI.gj=function(n,t){n.i=t};_mcp._TI.gi=function(n,t){n.o=t};_mcp._TI.gk=function(n,t){n.s(t)};_mcp._TI.gg=function(n,t){n.C(t)};_mcp._TI.dA=function(n,t){n.bb(t)};_mcp._TI.fS=function(n,t){n.p(t)};_mcp._TI.bF=function(n,t){n.m(t)};_mcp._TI.fT=function(n,t){n.q(t)};_mcp._TI.eV=function(n,t){n.c(t)};_mcp._TI.eN=function(n,t){n.o(t)};_mcp._TI.eW=function(n,t){n.e(t)};_mcp._TI.eL=function(n,t){n.m(t)};_mcp._TI.eM=function(n,t){n.n(t)};_mcp._TI.u=function(){_mcp._TI.co||(_mcp._TI.co=new _fc.m);return _mcp._TI.co};_mcp._TI.c=function(){_mcp._TI.cl||(_mcp._TI.cl=new _fc.k);return _mcp._TI.cl};_mcp._TI.cr=function(){_mcp._TI.cg||(_mcp._TI.cg=new _cc.bf);return _mcp._TI.cg};_mcp._TI.cq=function(){_mcp._TI.cf||(_mcp._TI.cf=new _cc.bk);return _mcp._TI.cf};_mcp._TI.bG=function(){_mcp._TI.ci||(_mcp._TI.ci=new _n.s);return _mcp._TI.ci};_mcp._TI.cs=function(){_mcp._TI.cp||(_mcp._TI.cp=new _b.cv);return _mcp._TI.cp};_mcp._TI.fd=function(){_mcp._TI.ch||(_mcp._TI.ch=new _n.V);return _mcp._TI.ch};_mcp._TI.bH=function(){_mcp._TI.cm||(_mcp._TI.cm=new _fce.t);return _mcp._TI.cm};_mcp._TI.dz=function(){_mcp._TI.cn||(_mcp._TI.cn=new _fce.C);return _mcp._TI.cn};_mcp._TI.fe=function(){_mcp._TI.cj||(_mcp._TI.cj=new _n.q);return _mcp._TI.cj};_mcp._TI.en=function(){_mcp._TI.ck||(_mcp._TI.ck=new _mcp.ba);return _mcp._TI.ck};MailComposeComponent.registerClass("MailComposeComponent",null,_a.iR);_mcp.F.registerClass("_mcp.F");_mcp.bc.registerClass("_mcp.bc",_js.x,IMailComposeComponent,_js.z);_mcp.m.registerClass("_mcp.m",_mcp.bc,IMailComposeAttachmentComponent,IMailComposeComponent,_js.z,_y.gu,IMailComposeOverridable);_mcp.n.registerClass("_mcp.n",_mcp.bc,IMailComposeContextMenuProvider);_mcp.z.registerClass("_mcp.z",_mcp.n,IMailComposeSaveComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider,IMailComposeOverridable);_mcp.bb.registerClass("_mcp.bb",_mcp.z,IMailComposeAutoSaveComponent,IMailComposeComponent,_js.z);_mcp.q.registerClass("_mcp.q",_mcp.bc,IMailComposeCommandingBarComponent,IMailComposeComponent,_js.z);_mcp.t.registerClass("_mcp.t",_mcp.n,IMailComposeComplianceComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.be.registerClass("_mcp.be");_mcp.bf.registerClass("_mcp.bf",_mcp.n,IMailComposeContentConversionComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.v.registerClass("_mcp.v",_mcp.bc,IMailComposeContextMenuComponent,IMailComposeComponent,_js.z);_mcp.w.registerClass("_mcp.w",_mcp.bc);_mcp.x.registerClass("_mcp.x",_mcp.bc,IMailComposeDiscardComponent,IMailComposeComponent,_js.z);_mcp.bg.registerClass("_mcp.bg",_mcp.bc,IMailComposeEditorComponent,IMailComposeComponent,_js.z);_mcp.bh.registerClass("_mcp.bh",_mcp.bg);_mcp.I.registerClass("_mcp.I",_mcp.n,IMailComposeImportanceComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.bj.registerClass("_mcp.bj",_mcp.bc,IMailComposeLinkPreviewComponent,IMailComposeComponent,_js.z);_mcp.H.registerClass("_mcp.H",_mcp.bc,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_js.z);_mcp.J.registerClass("_mcp.J",_mcp.bc);_mcp.f.registerClass("_mcp.f",_mcp.bc);_mcp.bl.registerClass("_mcp.bl",_mcp.n,IMailComposeMessageOptionsComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.k.registerClass("_mcp.k",_mcp.bc,IMailComposeNavigationComponent);_mcp.bm.registerClass("_mcp.bm",_mcp.n,IMailComposeOmeComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.bn.registerClass("_mcp.bn",_mcp.bc,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_js.z);_mcp.bp.registerClass("_mcp.bp",_mcp.bc,IMailComposePhotoComponent,IMailComposeComponent,_js.z);_mcp.u.registerClass("_mcp.u",_mcp.n,_y.hN);_mcp.s.registerClass("_mcp.s",_js.x);_mcp.o.registerClass("_mcp.o",_mcp.bc,IMailComposeSendAsContextMenuComponent,IMailComposeComponent,_js.z);_mcp.A.registerClass("_mcp.A",_mcp.bc,IMailComposeSendComponent,IMailComposeOverridable);_mcp.bs.registerClass("_mcp.bs",_mcp.bc);_mcp.br.registerClass("_mcp.br",_mcp.bc,IMailComposeShareAttachmentComponent,IMailComposeComponent,_js.z);_mcp.r.registerClass("_mcp.r",_mcp.n,IMailComposeSignatureComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.T.registerClass("_mcp.T",_mcp.bc,IMailComposeTouchComponent,IMailComposeComponent,_js.z);_mcp.bu.registerClass("_mcp.bu",_mcp.bc,IMailComposeUpgradeComponent,IMailComposeComponent,_js.z);_mcp.bk.registerClass("_mcp.bk",_mcp.bc,IMailComposeMailTipsComponent,IMailComposeComponent,_js.z);_mcp.bo.registerClass("_mcp.bo",_mcp.bc,IMailComposePeopleRecommendationsComponent,IMailComposeComponent,_js.z);_mcp.bq.registerClass("_mcp.bq",_mcp.bc,IMailComposePolicyTipsComponent,IMailComposeComponent,_js.z);_mcp.bi.registerClass("_mcp.bi",_mcp.bc,_y.gU,_y.gT,_y.gR);_mcp.C.registerClass("_mcp.C",null,IMailComposeActionFactory);_mcp.O.registerClass("_mcp.O",_mcp.C,IGroupInlineComposeActionFactory,IMailComposeActionFactory);_mcp.R.registerClass("_mcp.R",null,IMailComposeContextFactory);_mcp.U.registerClass("_mcp.U",null,IMailComposeViewModelFactory,_bc.bd);_mcp.V.registerClass("_mcp.V",_mcp.U,IMailInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.bd);_mcp.P.registerClass("_mcp.P",_mcp.U,IGroupInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.bd);_mcp.Q.registerClass("_mcp.Q",_a.by);_mcp.G.registerClass("_mcp.G",_js.x,_y.hi);_mcp.a.registerClass("_mcp.a",_a.jV,_g.Wn,_y.fa,_bc.bM,IContext,_js.z);_mcp.y.registerClass("_mcp.y",null,IMailComposeDiscardManager);_mcp.b.registerClass("_mcp.b",_a.ea);_mcp.d.registerClass("_mcp.d",_y.hJ,_y.m,_y.A,_bc.t,_a.jO,_js.z,Sys.IDisposable,_y.dq,_y.cC,_bc.i,_bc.q,_y.L,IMailComposeOverridable);_mcp.e.registerClass("_mcp.e",_mcp.d);_mcp.g.registerClass("_mcp.g",_mcp.d,IGroupInlineComposeViewModel,_y.m,_y.A,_bc.t,_a.jO,_js.z,Sys.IDisposable,_y.dq,_y.cC,_bc.i,_bc.q);_mcp.h.registerClass("_mcp.h");_mcp.W.registerClass("_mcp.W",_a.by,_y.hk);_mcp.X.registerClass("_mcp.X",null,IMailResponseViewModelFactory);_mcp.D.registerClass("_mcp.D",_a.by);_mcp.K.registerClass("_mcp.K");_mcp.bx.registerClass("_mcp.bx");_mcp.B.registerClass("_mcp.B",_h.dk.$$(_g.ut,_g.kG));_mcp.ba.registerClass("_mcp.ba",null,_js.S);_mcp.p.registerClass("_mcp.p",_js.c,_b.bX);_mcp.L.registerClass("_mcp.L",_js.b);_mcp.i.registerClass("_mcp.i",_js.b);_mcp.l.registerClass("_mcp.l",_js.b,_ff.n);_mcp.M.registerClass("_mcp.M",_js.b);_mcp.j.registerClass("_mcp.j",_mcp.l);_mcp._TI.registerClass("_mcp._TI");MailComposeComponent.$$cctor();_mcp.m.a=new _H("AttachmentWellViewModel",_y.x,_mcp.m);_mcp.q.a=_a.a.eu;_mcp.t.a=new _y.g(_u.P.j,null,null);_mcp.v.a=new _H("Menu",_fm.f,_mcp.v);_mcp.w.a=new _H("Menu",_fm.f,_mcp.w);_mcp.H.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.f.c=new _H("FromDetailsViewModel",_pe.d,_mcp.f);_mcp.f.d=new _H("SenderDetailsViewModel",_pe.d,_mcp.f);_mcp.f.b=null;_mcp.f.a=null;_mcp.f.h=new _H("RecurrencePatternDataObject",_cc.bm,_mcp.f);_mcp.k.b=[84,85,86,87];_mcp.s.b=7;_mcp.s.a=1;_mcp.z.a=[60,40,43,1001,700,50,800,88,89];_mcp.o.a=10;_mcp.o.b=new _H("Menu",_fm.f,_mcp.o);_mcp.A.a=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_mcp.r.c="<P><BR></P>";_mcp.r.b=new RegExp("[\n\r]+","g");_mcp.a.bM=new _H("ViewModelId",String,_mcp.a);_mcp.a.b=new _H("Operation",_y.M,_mcp.a);_mcp.a.j=new _H("Mode",_y.dy,_mcp.a);_mcp.a.bm=new _H("OriginalId",_g.g,_mcp.a);_mcp.a.bl=new _H("OriginalDocumentId",Number,_mcp.a);_mcp.a.bn=new _H("OriginalItem",_g.h,_mcp.a);_mcp.a.E=new _H("DraftId",_g.g,_mcp.a);_mcp.a.bG=new _H("StoreId",String,_mcp.a);_mcp.a.bH=new _H("Subject",String,_mcp.a,"");_mcp.a.bw=new _H("SelectedDataCallContext",_h.dv,_mcp.a);_mcp.a.G=new _H("EditorCallContext",_h.dv,_mcp.a);_mcp.a.H=new _H("EditorContent",String,_mcp.a,"");_mcp.a.s=new _H("BodyType",String,_mcp.a);_mcp.a.n=new _H("ToRecipients",_js.v,_mcp.a);_mcp.a.m=new _H("SpeechResultRecipients",_js.v,_mcp.a);_mcp.a.bI=new _H("ToQueryString",String,_mcp.a);_mcp.a.f=new _H("CcRecipients",_js.v,_mcp.a);_mcp.a.t=new _H("CcQueryString",String,_mcp.a);_mcp.a.e=new _H("BccRecipients",_js.v,_mcp.a);_mcp.a.r=new _H("BccQueryString",String,_mcp.a);_mcp.a.l=new _H("AutoAddSignature",Boolean,_mcp.a,!0);_mcp.a.Q=new _H("Importance",String,_mcp.a,"Normal");_mcp.a.bu=new _H("QuotedBody",String,_mcp.a);_mcp.a.bA=new _H("SmimeContent",String,_mcp.a);_mcp.a.bC=new _H("SmimeErrorCode",Number,_mcp.a);_mcp.a.bD=new _H("SmimeRecipientCerts",Array,_mcp.a);_mcp.a.bE=new _H("SmimeSigningCert",String,_mcp.a);_mcp.a.o=new _H("AttachmentsToAdd",Array,_mcp.a);_mcp.a.U=new _H("IsComplete",Boolean,_mcp.a);_mcp.a.h=new _H("IsMeeting",Boolean,_mcp.a);_mcp.a.Y=new _H("IsMeetingForward",Boolean,_mcp.a);_mcp.a.bf=new _H("IsReplyAllOnBcc",Boolean,_mcp.a);_mcp.a.bj=new _H("Location",_g.y,_mcp.a);_mcp.a.M=new _H("HasLocation",Boolean,_mcp.a);_mcp.a.i=null;_mcp.a.k=null;_mcp.a.J=new _H("From",_g.bh,_mcp.a);_mcp.a.bx=new _H("Sender",_g.bh,_mcp.a);_mcp.a.bi=new _H("IsUpgraded",Boolean,_mcp.a);_mcp.a.W=new _H("IsFromShown",Boolean,_mcp.a);_mcp.a.S=new _H("IsBccShown",Boolean,_mcp.a);_mcp.a.bq=new _H("ParentFolderNameToPost",String,_mcp.a);_mcp.a.bp=new _H("ParentFolderIdToPost",_g.n,_mcp.a);_mcp.a.d=new _H("AttachmentCollection",_js.f,_mcp.a);_mcp.a.p=new _H("AttachmentsToHide",Array,_mcp.a);_mcp.a.bL=new _H("UpgradeFailed",Boolean,_mcp.a);_mcp.a.q=new _H("Baseline",_mcp.b,_mcp.a);_mcp.a.L=new _H("HasBeenSavedByUser",Boolean,_mcp.a);_mcp.a.bJ=new _H("UnpromotedEmojiCountProperty",Number,_mcp.a);_mcp.a.bK=new _H("UnpromotedInlineImageCountProperty",Number,_mcp.a);_mcp.a.bg=new _H("IsReplyForward",Boolean,_mcp.a);_mcp.a.F=new _H("Draft",_g.h,_mcp.a);_mcp.a.K=new _H("GroupEmailAddress",_g.d,_mcp.a);_mcp.a.bv=new _H("RightsManagementLicenseData",_g.dK,_mcp.a);_mcp.a.y=new _H("ComplianceId",String,_mcp.a);_mcp.a.T=new _H("IsClassified",Boolean,_mcp.a);_mcp.a.v=new _H("ClassificationGuid",String,_mcp.a);_mcp.a.x=new _H("Classification",String,_mcp.a);_mcp.a.u=new _H("ClassificationDescription",String,_mcp.a);_mcp.a.w=new _H("ClassificationKeep",Boolean,_mcp.a);_mcp.a.bz=new _H("Sensitivity",String,_mcp.a,"Normal");_mcp.a.V=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.a);_mcp.a.be=new _H("IsReadReceiptRequested",Boolean,_mcp.a);_mcp.a.bB=new _H("SmimeEncryptMessage",Boolean,_mcp.a);_mcp.a.bF=new _H("SmimeSignMessage",Boolean,_mcp.a);_mcp.a.z=new _H("ConversationId",_g.g,_mcp.a);_mcp.a.bo=new _H("ParentConversationNodeId",String,_mcp.a);_mcp.a.bc=new _H("IsOriginalIdCalendarItemId",Boolean,_mcp.a);_mcp.a.ba=new _H("IsOccurrenceReferencingMaster",Boolean,_mcp.a);_mcp.a.bd=new _H("IsPoppedOutFromReadingPane",Boolean,_mcp.a);_mcp.a.X=new _H("IsLoadedDraft",Boolean,_mcp.a);_mcp.a.bN=new _H("WasCleanNewMessageBeforePopout",Boolean,_mcp.a);_mcp.a.O=new _H("HideIncludeEntrypoint",Boolean,_mcp.a,!1);_mcp.a.bO=new _H("WasSavingBeforePopout",Boolean,_mcp.a,!1);_mcp.a.Z=new _H("IsMovedToDraftFromOutbox",Boolean,_mcp.a,!1);_mcp.a.bs=new _H("PerfContext",_a.bN,_mcp.a,null);_mcp.a.br=new _H("PerfContextE2E",_a.bN,_mcp.a,null);_mcp.a.bP=new _H("WaterfallTraceStarted",Boolean,_mcp.a,null);_mcp.a.bV=new _H("RichTextEditorSupported",Boolean,_mcp.a,null);_mcp.a.P=new _H("HtmlSupportedProperty",Boolean,_mcp.a,null);_mcp.a.D=new _H("DlpSenderOverride",String,_mcp.a,null);_mcp.a.C=new _H("DlpFalsePositive",String,_mcp.a,null);_mcp.a.B=new _H("DlpDetectedClassification",String,_mcp.a,null);_mcp.a.I=new _H("ExplicitLogonUser",String,_mcp.a,null);_mcp.a.R=new _H("IncludeOriginalFromInToRecipients",Boolean,_mcp.a,!1);_mcp.a.g=new _H("ExtendedPropertyCollection",_js.f,_mcp.a,null);_mcp.a.bb=new _H("IsOnDemandUpgradeRequested",Boolean,_mcp.a,!1);_mcp.a.bh=new _H("IsResumingSendFailure",Boolean,_mcp.a,!1);_mcp.a.N=new _H("HasSentViaNotification",Boolean,_mcp.a,!1);_mcp.a.by=new _H("SendFailureInfobarMessageId",_bc.InfoBarMessageId,_mcp.a,45);_mcp.a.bt=new _H("PopoutPerfContext",_a.bN,_mcp.a);_mcp.a.A=new _H("DiagnosticContent",String,_mcp.a);_mcp.a.c="UseOverride";_mcp.a.bU=new RegExp("(\r)?\n","gi");_mcp.a.a=null;_mcp.a.$$cctor();_mcp.b.u=new _H("Subject",String,_mcp.b,"");_mcp.b.m=new _H("EditorContent",String,_mcp.b,"");_mcp.b.h=new _H("ToRecipients",_js.f,_mcp.b);_mcp.b.v=new _H("ToQueryString",String,_mcp.b);_mcp.b.e=new _H("CcRecipients",_js.f,_mcp.b);_mcp.b.k=new _H("CcQueryString",String,_mcp.b);_mcp.b.d=new _H("BccRecipients",_js.f,_mcp.b);_mcp.b.j=new _H("BccQueryString",String,_mcp.b);_mcp.b.o=new _H("Importance",String,_mcp.b,"Normal");_mcp.b.n=new _H("From",_g.d,_mcp.b);_mcp.b.l=new _H("ComplianceId",String,_mcp.b);_mcp.b.r=new _H("Sensitivity",String,_mcp.b,"Normal");_mcp.b.p=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.q=new _H("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.s=new _H("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.t=new _H("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.c=new _H("AttachmentCollection",_js.f,_mcp.b);_mcp.b.g=new _H("ExtendedPropertyCollection",_js.f,_mcp.b,null);_mcp.b.f=new _a.bs(_g.d);_mcp.b.$$cctor();_mcp.h.a=_a.a.a;_mcp.W.a=_a.a.a;_mcp._TI._hf=_mcp._TI.ff();_mcp._TI.co=null;_mcp._TI.cl=null;_mcp._TI.cg=null;_mcp._TI.cf=null;_mcp._TI.ci=null;_mcp._TI.cp=null;_mcp._TI.ch=null;_mcp._TI.cm=null;_mcp._TI.cn=null;_mcp._TI.cj=null;_mcp._TI.ck=null;_mcp._TI.a={};_mcp._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
