try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.application.mowastarreadingpane.js'] = (new Date()).getTime();
function MowaStarReadingPaneComponents(){}MowaStarReadingPaneComponents.$$cctor=function(){_a.p.a().a(MowaStarReadingPaneComponents)};MowaStarReadingPaneComponents.prototype={a:function(n,t,i){var r=this;n.b(_mrp.a,function(){return new _mrp.a}).a()},b:function(){return[]}};Type.registerNamespace("_mrp");_mrp.c=function(n,t){_mrp.c.initializeBase(this,[n]);this.j=t;var i=this.z.style;i["background-size"]=i["-webkit-background-size"]=i["-ms-background-size"]=i["-moz-background-size"]="cover";this.z.style.backgroundPosition="center"};_mrp.c.prototype={f:null,e:null,j:null,v:function(n){if(this.f!==n){this.f=n;this.bj("ImgUrl");this.j.h(this.e);this.e=null;this.i();if(this.f){var t=this;this.j.j(this.f,function(n,i){if(t.f===n){t.e=i;t.m()}})}}return n},i:function(){if(!this.f||!this.e){this.z.style.backgroundImage="";this.z.style.color=""}},m:function(){if(this.e){this.z.style.backgroundImage="url('"+this.e+"')";this.z.style.color="transparent"}else this.i()}};_mrp.b=function(n,t,i){this.n=Function.createDelegate(this,this.o);_mrp.b.initializeBase(this,[n,t]);this.l=i};_mrp.b.prototype={a:null,h:null,b:null,d:null,c:null,g:!1,l:null,q:function(n){if(this.a!==n){this.a=n;this.p();_js.d.b(this.b)?this.k():this.t();this.bj("DisplayName")}return n},r:function(n){if(this.d!==n){_js.d.b(this.d)||this.bx(this.d);this.d=n;_js.d.b(this.a)&&this.k();this.bj("DoughBoyCssClassName")}return n},s:function(n){if(this.c!==n){_js.d.b(this.c)||this.bx(this.c);this.c=n;_js.d.b(this.a)&&this.k();this.bj("FadeInTransitionCssClassName")}return n},m:function(){_mrp.c.prototype.m.call(this);this.o()},i:function(){_mrp.c.prototype.i.call(this);if(!this.g){this.g=!0;this.l.a(this.H(),"AnimatedShowPersonImage",this.n,1500);this.z.style.opacity="0";_js.d.b(this.c)||this.bx(this.c)}},o:function(){if(this.g){this.g=!1;this.z.style.opacity="";_js.d.b(this.c)||this.bp(this.c)}},t:function(){this.bx(this.d);this.z.style.backgroundColor=this.h;this.z.textContent=this.b},k:function(){this.z.style.backgroundColor="";this.z.textContent="";_js.d.b(this.d)||this.bp(this.d)},p:function(){this.h=this.b="";if(this.a){for(var u=this.a.split(" "),n=0;n<u.length&&this.b.length<2;n++)if(u[n].length>0){var f=u[n].charCodeAt(0);(f>=97&&f<=122||f>=65&&f<=90)&&(this.b+=u[n].charAt(0).toUpperCase())}if(this.b.length<=1){this.b="";for(var r=0;r<this.a.length&&this.b.length<2;r++){var t=this.a.charCodeAt(r);(t>=97&&t<=122||t>=65&&t<=90)&&(this.b+=this.a.charAt(r).toUpperCase())}}for(var s=0,i=this.a.length-1;i>=0;i--){var o=this.a.charCodeAt(i);var e=i%8;s^=(o<<e)+(o>>8-e)}this.h=_mrp.b.a[s%_mrp.b.a.length]}}};_mrp.a=function(){this.c={};this.f={};this.b={};this.a=new Array(0);this.e=[]};_mrp.a.prototype={d:0,h:function(n){if(_mrp.a.a&&!Array.contains(this.a,n)){Array.add(this.a,n);var r=window.URL||window.webkitURL;if(this.a.length>_mrp.a.b){var t=this.a[0];Array.removeAt(this.a,0);r.revokeObjectURL(t);var i=this.f[t];delete this.c[i];delete this.f[t]}}},j:function(n,t){if(n in this.c){var i=this.c[n];_mrp.a.a&&Array.remove(this.a,i);t(n,this.c[n])}else this.i(n,t)},i:function(n,t){var i;if(n in this.b)i=this.b[n];else{i=[];Array.enqueue(this.e,n);this.b[n]=i}i[i.length]=t;this.g()},g:function(){if(!(this.d>=3)&&this.e.length){var t=Array.dequeue(this.e);this.d++;var n=new XMLHttpRequest;n.open("GET",t,!0);_mrp.a.a&&(n.responseType="blob");var i=this;n.onreadystatechange=function(){if(n.readyState===4){i.d--;var e=0;var u=null;try{if(n.status===200){var s=n.getResponseHeader("Content-Length");s&&(e=parseInt(n.getResponseHeader("Content-Length")));if(_mrp.a.a){u=n.response;u&&(e=u.size)}}}catch(c){}var r=null;if(e>100)if(_mrp.a.a){var h=window.URL||window.webkitURL;r=h.createObjectURL(u)}else r=t;i.c[t]=r;var o=i.b[t];delete i.b[t];_mrp.a.a&&r&&(i.f[r]=t);for(var f=0;f<o.length;f++)o[f](t,r);i.g()}};n.send(null)}}};MowaStarReadingPaneComponents.registerClass("MowaStarReadingPaneComponents",null,_a.iR);_mrp.c.registerClass("_mrp.c",_js.c);_mrp.b.registerClass("_mrp.b",_mrp.c);_mrp.a.registerClass("_mrp.a");MowaStarReadingPaneComponents.$$cctor();_mrp.b.a=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"];_mrp.a.a=!_a.UserAgent.getInstance().D||_a.UserAgent.getInstance().L;_mrp.a.b=100;
window.scriptsLoaded['microsoft.owa.application.mowastarreadingpane.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.application.mowastarreadingpane.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
