try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_d");_d.bR=function(){};_d.bR.prototype={sendStarted:0,sendSucceeded:1,sendFailed:2,sendResumedOnNewSendFailure:3,sendResumedOnFailedResume:4,sendResumeSucceeded:5,browserClosing:6,quickComposeReSendTrigerred:7,quickComposeSendFailed:8};_d.bR.registerEnum("_d.bR",!1);_d.a=function(){};_d.a.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};_d.a.registerEnum("_d.a",!1);_d.dd=function(){};_d.dd.registerInterface("_d.dd");_d.dg=function(){};_d.dg.prototype={FifteenMinutesBeforeStart:-15,TenMinutesBeforeStart:-10,FiveMinutesBeforeStart:-5,ZeroMinutesBeforeStart:0,FiveMinutes:5,TenMinutes:10,FifteenMinutes:15,ThirtyMinutes:30,OneHour:60,TwoHours:120,FourHours:240,EightHours:480,halfDay:720,OneDay:1440,TwoDays:2880,ThreeDays:4320,FourDays:5760,OneWeek:10080,TwoWeeks:20160};_d.dg.registerEnum("_d.dg",!1);_d.db=function(){};_d.db.registerInterface("_d.db");_d.dc=function(){};_d.dc.registerInterface("_d.dc");var IInlineExploreListViewModelFactory=function(){};IInlineExploreListViewModelFactory.registerInterface("IInlineExploreListViewModelFactory");var IInlineExploreListViewModel=function(){};IInlineExploreListViewModel.registerInterface("IInlineExploreListViewModel");_d.df=function(){};_d.df.prototype={ToRecipient:0,CcRecipient:1,BccRecipient:2};_d.df.registerEnum("_d.df",!1);_d.da=function(){};_d.da.prototype={Minutes:0,Hours:1,Days:2,Weeks:3};_d.da.registerEnum("_d.da",!1);_d.ca=function(){};_d.ca.registerInterface("_d.ca");_d.bE=function(){};_d.bE.registerInterface("_d.bE");_d.g=function(){};_d.g.m=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_d.g.v=function(){return _fm.b.a(_fm.a.u,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.x=function(){return _fm.b.a(_fm.a.u,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.w=function(){return _fm.b.a(_fm.a.u,"ms-bcl-nd-b ms-bg-transparent ms-icon-font-circle","ms-fcl-nd-b",_fm.WebfontSizes.b.b)};_d.g.y=function(){return _fm.b.a(_fm.a.u,"ms-fcl-w-b","ms-bcl-ns-b ms-bgc-ns-b ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.o=function(){return _fm.b.a(_fm.a.A,"ms-fcl-w-b","ms-bcl-ns-b ms-bgc-ns-b ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.q=function(){return _fm.b.a(_fm.a.g,"ms-fcl-w-b","ms-bcl-ns-b ms-bgc-ns-b ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.u=function(){return _fm.b.a(_fm.a.i,"ms-fcl-w-b","ms-bcl-ns-b ms-bgc-ns-b ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.s=function(){return _fm.b.a(_fm.a.H,"ms-fcl-w-b","ms-bcl-ns-b ms-bgc-ns-b ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.n=function(){return _fm.b.a(_fm.a.A,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.b=function(){return _fm.b.a(_fm.a.A,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.a=function(){return _fm.b.a(_fm.a.A,"ms-bcl-nd-b ms-bg-transparent ms-icon-font-circle","ms-fcl-nd-b",_fm.WebfontSizes.b.b)};_d.g.p=function(){return _fm.b.a(_fm.a.g,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.d=function(){return _fm.b.a(_fm.a.g,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.c=function(){return _fm.b.a(_fm.a.g,"ms-bcl-nd-b ms-bg-transparent ms-icon-font-circle","ms-fcl-nd-b",_fm.WebfontSizes.b.b)};_d.g.t=function(){return _fm.b.a(_fm.a.i,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.h=function(){return _fm.b.a(_fm.a.i,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.g=function(){return _fm.b.a(_fm.a.i,"ms-bcl-nd-b ms-bg-transparent ms-icon-font-circle","ms-fcl-nd-b",_fm.WebfontSizes.b.b)};_d.g.r=function(){return _fm.b.a(_fm.a.H,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.f=function(){return _fm.b.a(_fm.a.H,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.a)};_d.g.e=function(){return _fm.b.a(_fm.a.H,"ms-bcl-nd-b ms-bg-transparent ms-icon-font-circle","ms-fcl-nd-b",_fm.WebfontSizes.b.b)};_d.g.A=function(){return _fm.b.a(_fm.a.R,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.z=function(){return _fm.b.a(_fm.a.R,"ms-bcl-nd-b ms-bg-transparent ms-icon-font-circle","ms-fcl-nd-b",_fm.WebfontSizes.b.b)};_d.g.k=function(){return _fm.b.a(_fm.a.c,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.g.j=function(){return _fm.b.a(_fm.a.d,"ms-font-color-officeAccent10","ms-icon-font-size-15")};_d.g.i=function(){return _fm.b.a(_fm.a.b,"ms-font-color-error","ms-icon-font-size-15")};_d.g.l=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.f,"ms-fcl-tp-b")};_d.g.B=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.f,"ms-fcl-tp-b")};_d.g.C=function(){return _fm.b.a(_fm.a.e,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};function CoreViewModelsComponent(){}CoreViewModelsComponent.$$cctor=function(){_a.p.a().a(CoreViewModelsComponent)};CoreViewModelsComponent.prototype={a:function(n,t,i){var st=this;n.b(_d.bL,function(){return new _d.bL(n.a(_d.bK),n.a(_ff.c),n.a(_a.w),n.a(_h.Y),n.a(_a.e),n.a(_g.a),n.a(_a.h))}).a();var ot=this;n.b(_d.bQ,function(){return new _d.bQ(n.a(_y.a),n.a(_bc.a),n.a(_a.q),n.a(IMailComposeContextFactory),n.a(_a.e))}).b(IApprovalRequestHeaderViewModelFactory).a();var ct=this;n.b(_d.cx,function(){return new _d.cx(n.a(_a.w),n.a(IAttachmentDownloadUrlFactory))}).b(IUMMessagePostHeaderViewModelFactory).a();var ht=this;n.b(_d.ce,function(){return new _d.ce(n.a(_a.q),n.a(_pcf.a),n.d(IModernGroupsProvider))}).b(IModernGroupMembershipRequestHeaderViewModelFactory).a();n.e(_d.cK).b(IItemReadingPaneContextFactory).a();var et=this;n.b(_d.bK,function(){return new _d.bK(n.a(_y.a))}).a();var rt=this;n.b(IUnsupportedItemReadingPaneViewModel,function(){return new _d.z(n.a(_y.c),n.a(_a.h))});var it=this;n.b(_d.k,function(){return new _d.k(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),n.a(_a.h),n.c(IAttachmentsFilePickerPanelViewModel))}).b(_y.cT);var ft=this;n.b(_d.ct,function(){return new _d.ct(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),n.a(_a.h),n.c(IAttachmentsFilePickerPanelViewModel))}).b(ITaskReadingPaneViewModelFactory).a();var ut=this;n.b(_d.cu,function(){return new _d.cu(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),n.a(_a.h),n.c(IAttachmentsFilePickerPanelViewModel))}).b(ITaskReadingPaneViewModelPopOutFactory);var lt=this;n.b(_d.Y,function(){return new _d.Y(n.a(_y.a),n.a(_pe.e),n.a(_a.h),n.a(ICompositePersonaViewModelFactory))}).b(IPeopleSearchSuggestionAdaptorViewModel);var kt=this;n.e(_d.bC).a().c(function(t){t.a=n.a(_pe.e)});var bt=this,gt=this;n.b(_d.bp,function(){return new _d.bp(n.a(_fp.d),n.a(_rw.h))}).a().c(function(t){t.c=n.a(_pe.e)});var dt=this;n.e(_d.bY).a().c(function(t){t.a=n.a(_pe.e)});var wt=this;n.b(_d.bI,function(){return new _d.bI(n.a(IInferenceTracker))}).b(IUploadPhotoViewModelFactory).a();if(i.a()!=="Mouse")if(i.a()==="TouchNarrow"){var vt=this;n.b(_d.cg,function(){return new _d.cf(n.a(_ff.c),n.a(_d.bE),n.a(_a.h),n.a(_a.e))}).b(IOptionsViewModel)}else{var at=this;n.b(_d.cg,function(){return new _d.t(n.a(_ff.c),n.a(_d.bE),n.a(_a.w),n.a(_y.ck),n.a(_a.e),n.a(_a.h))}).b(IOptionsViewModel)}var pt=this;n.b(_d.cy,function(){return new _d.cy}).b(IUserOofNotificationProvider).a();if(i.a()==="Mouse"){var yt=this;n.b(_d.cr,function(){return new _d.cr(n.a(_ff.c),n.a(_js.k),n.a(_y.a))}).b(ISendNotificationProviderViewModel).a();var tt=this;n.b(_d.cq,function(){return new _d.cq(n.a(_ff.c),n.a(_js.k),n.a(_y.a),n.a(IMailComposeViewModelFactory))}).b(ISendFailureNotificationProviderViewModel).a()}var h=this;n.b(_d.ch,function(){return new _d.ch(n.a(_cm.m),n.a(_ff.a),n.a(_a.z))}).b(IOwaOptionPeoplePickerViewModelFactory);n.e(_c.F).b(ISpeechJsonDeserializerUtils);n.e(_a.dS).a();var s=this;n.b(IDumpsterPopOutViewModelFactory,function(){return new _d.cH(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.a(_h.m),n.a(IInferenceTracker),n.c(IMailErrorHandler),n.a(_y.v))}).a();var l=this;n.b(_d.bZ,function(){var t=n.a(_g.bf);return new _d.bZ(t.bl.HelpUrl,t.bl.IsBposUser,n.a(_a.Z),n.a(_d.bF),n.a(_y.q),i.a(),n.a(_y.a),n.a(_y.J))}).b(IModuleHelpProvider).a();var c=this;n.b(_d.bF,function(){return new _d.bF(n.a(_h.Y),n.a(_y.a),n.a(_g.a).bl.PolicySettings.AllowOfflineOn,n.a(_ff.c))}).b(IOfflineHelpProvider).a();var o=this;n.b(_d.bm,function(){return new _d.bm(n.a(_y.a),n.a(_a.q),n.d(IChatProviderFactory),n.c(ILocationMapViewModelFactory),n.c(IComposeCalendarItemViewModelFactory),n.a(IMailComposeContextFactory),n.a(_g.bV),n.a(_a.Z),n.a(_a.e))}).b(_d.bm).a();var u=this;n.b(_d.Z,function(){return new _d.Z(n.a(_y.a),n.a(_a.Z),n.a(_pe.e),n.a(_d.bm))}).b(_d.Z).a();var r=this;n.b(_d.cb,function(){var t=n.a(_a.cw);return new _d.cb(n.a(_y.a),n.a(_d.bq),n.a(_a.z),t.b()?n.a(_y.bV):null)}).b(ILinkSummaryCardViewModelFactory).a();var e=this,f=this;n.b(_d.bq,function(){var t=n.a(_a.cw);return new _d.bq(n.a(_y.a),n.a(_a.z),t.b()?n.a(_y.bV):null)}).b(_d.bq).a().c(function(t){t.c=n.a(_pcf.a)});var a=this,d=this;n.b(_d.bX,function(){return new _d.bX(n.a(_a.q),n.a(_a.h),n.a(_y.a),n.a(_d.bC),n.a(_d.bp),n.a(_d.bY),n.a(_a.Z),n.a(IBasePersonaViewModelFactory))}).b(IGroupCardViewModelFactory).a().c(function(t){t.g=n.a(_d.Z)});var k=this;n.b(IFlowHomeScreenViewModelFactory,function(){return new _d.cI(n.a(_a.q),n.a(IBasePersonaViewModelFactory))}).a();var nt=this;n.b(_d.bx,function(){return new _d.bx(n.a(_a.q))}).a();var g=this;n.b(_d.bA,function(){return new _d.bA(n.a(_fp.d),n.a(_a.q))}).b(IExtendedSharedFolderViewModel);var b=this;n.b(_d.bG,function(){return new _d.bG(n.a(_ff.c),n.a(_fp.d))}).b(IOpenAnotherMailboxViewModel);var y=this;n.b(_d.r,function(){return new _d.r(n.a(_fp.d),n.a(_a.q))}).b(IMailFolderPermissionsDialogViewModel);var v=this;n.b(_d.cc,function(){return new _d.cc(n.a(_ff.c))}).b(IMailErrorHandler).a();var w=this;n.b(_d.C,function(){return new _d.C(n.a(_ff.c),n.a(_js.k),n.a(_y.a))}).b(IFolderPickerContainer);var p=this;n.b(_d.bP,function(){return new _d.bP(n.c(IPopOutHelper),i.a())}).a()},b:function(){return[new _a.B(_y.dB,1,13),new _a.B(_d.bL,2,9),new _a.B(_a.bm,2,1),new _a.B(_y.ew,2,9),new _a.B(_d.bx,2,9),new _a.B(_d.bP,1,1)]}};_d.bV=function(n,t){_d.bV.initializeBase(this);_a.b.b(n,"personaViewModelFactory");_a.b.b(t,"flowConversationItem");this.b=n;this.a=t};_d.bV.prototype={b:null,a:null,c:function(){for(var t="",n=0;n<this.a.Participants.length;n++)t+=this.a.Participants[n].Name+"; ";return t},d:function(){return _a.c.b(this.a.ReceivedTimeUtc)},f:function(){return this.a.UnReadCount>0?_js.d.c("({0})",this.a.UnReadCount):""},e:function(){var n=new _g.d;n.EmailAddress=this.a.SenderPhotoEmailAddress;n.MailboxType="Mailbox";return this.b.a(_h.k.a(n),2,!1,4)}};_d.bB=function(n,t){this.c=Function.createDelegate(this,this.d);_d.bB.initializeBase(this);this.b=t;this.a=new _js.f;var i=new _c.bA(_g.s.a(_g.s.d("inbox")),20);i.w(this.c);n.a(i)};_d.bB.prototype={b:null,a:null,d:function(n){var i=n;var r=new _ff.e;if(i.a)for(var t=0;t<i.a.length;t++)r.c(new _d.bV(this.b,i.a[t]));this.a.p(r.i())}};_d.cI=function(n,t){_a.b.b(n,"actionSubmitter");_a.b.b(t,"personaViewModelFactory");this.b=n;this.c=t};_d.cI.prototype={b:null,c:null,a:function(){return new _d.bB(this.b,this.c)}};_d.ce=function(n,t,i){this.b=n;this.d=t;this.c=i};_d.ce.prototype={b:null,d:null,c:null,a:function(n){return new _d.br(n,this.b,this.d.c(new _bc.o,1,null),this.c)}};_d.cz=function(n,t,i){_d.cz.initializeBase(this,[1,"AsyncSendDatapoint"]);this.a.ET=_d.bR.toString(n);this.a.SC=t.toString();this.a.FC=i.toString()};_d.o=function(){};_d.o.i=function(n){_d.o.a(0,n,-1)};_d.o.c=function(n){_d.o.a(2,-1,n)};_d.o.d=function(n){_d.o.a(8,-1,n)};_d.o.j=function(n){_d.o.a(1,n,-1)};_d.o.g=function(n){_d.o.a(3,-1,n)};_d.o.f=function(n){_d.o.a(4,-1,n)};_d.o.h=function(n){_d.o.a(5,-1,n)};_d.o.e=function(n){_d.o.a(7,-1,n)};_d.o.b=function(n){_d.o.a(6,-1,n)};_d.o.a=function(n,t,i){var r=new _d.cz(n,t,i);_a.l.d.b()&&_a.l.d.a(r)};_d.cq=function(n,t,i,r){this.f=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.C);this.u=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.z);this.w=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.D);n.b(ISendFailedEvent,this.v);n.b(_y.eF,this.w);n.b(IQuickComposeSendFailedEvent,this.t);n.b(IQuickComposeSendFailureRemoveEvent,this.u);this.s=t;this.e=i;this.d=n;this.q=r};_d.cq.prototype={s:null,e:null,d:null,j:null,n:null,b:0,c:0,h:!1,m:!1,l:!1,q:null,i:null,a:function(){return this.b},x:function(n){if(this.b===n)return n;var t=!this.b;var i=this.b<n;this.b=n;!this.b!==t&&(this.c||(this.b?this.e.k(this.f):this.e.n(this.f)));i?!this.b!==t?this.d.a(ISendFailedO365Event,new _mcp.E(!0,this.p,!0,this.i)):this.d.a(ISendFailedO365Event,new _mcp.E(!1,this.p,!0,this.i)):!this.b!==t&&this.d.a(ISendFailureRemoveO365Event,new _mcp.Z(!0));return n},r:function(n){if(this.c===n)return n;var t=!this.c;var i=this.c<n;this.c=n;!this.c!==t&&(this.b||(this.c?this.e.k(this.f):this.e.n(this.f)));i?!this.c!==t?this.d.a(ISendFailedO365Event,new _mcp.E(!0,this.o,!1,"")):this.d.a(ISendFailedO365Event,new _mcp.E(!1,this.o,!1,"")):!this.c!==t&&this.d.a(ISendFailureRemoveO365Event,new _mcp.Z(!1));return n},k:function(){this.j||(this.j={});return this.j},g:function(){this.n||(this.n={});return this.n},D:function(n){_d.o.c(this.b);var t=n.a().a();this.i=t.w();this.k()[t.b()]=n.a();this.x(this.b+1);this.h=!1},C:function(){this.h?_d.o.f(this.b):_d.o.g(this.b);if(this.m){_js.Trace.logInfo(_a.a.a,"skipping resuming messages failed to send since another resume is currently in progress");return}this.m=!0;try{_js.Trace.logInfo(_a.a.a,"resuming messages failed to send per user request");var i=this.k();for(var r in i){var u={key:r,value:i[r]};var t=u.value.a();t.dw(!0);var n=this.q.a(t,null,null);n.C(!1);n.F(!1);this.e.f(n,0,!0)}}finally{this.h=!0;this.m=!1}},E:function(n){_d.o.h(this.b);var t=this.k()[n.a];var i=this;this.s.f(_a.a.a,"Clean up on SendFailure failed",function(){t.m(!0);t.k()});delete this.k()[n.a];this.x(this.b-1);this.h=!1},z:function(n){_d.o.d(this.c);var t=n.a();this.g()[t.d()]=t;this.r(this.c+1)},B:function(){_js.Trace.logInfo(_a.a.t,"resend failed message for quick compose via global header");if(this.l){_js.Trace.logInfo(_a.a.t,"skipping resending messages failed to send since another resend is currently in progress");return}this.l=!0;try{var i=this.g();for(var t in i){var r={key:t,value:i[t]};_d.o.e(this.c);var n=r.value;n.a().c();delete this.g()[n.d()];this.r(this.c-1)}}finally{this.l=!1}},A:function(n){var t=n.a();if(t.d()in this.g()){delete this.g()[t.d()];this.r(this.c-1)}},y:function(n){_d.o.b(this.b);n.a(_nbs.a.li)}};_d.cr=function(n,t,i){this.d=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);n.b(ISendEvent,this.f);n.b(ISendSucceededEvent,this.h);n.b(ISendFailedEvent,this.g);this.e=t;this.c=i};_d.cr.prototype={e:null,c:null,b:0,a:function(){return this.b},k:function(n){_d.o.i(this.b);this.b++;this.b===1&&this.c.k(this.d)},m:function(n){_d.o.j(this.b);var t=this;this.e.f(_a.a.a,"Clean up on send succeeded",function(){n.a().k()});this.i()},l:function(n){this.i()},i:function(){this.b--;this.b||this.c.n(this.d)},j:function(n){n.a(_nbs.a.St)}};_d.cy=function(){this.h=Function.createDelegate(this,this.o);this.g=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.m);this.d=Function.createDelegate(this,this.k);this.e=Function.createDelegate(this,this.l);_d.cy.initializeBase(this);this.c=new _c.x;this.j=new _C(this.e,_a.a.p);this.i=new _C(this.d,_a.a.p);_js.g.a().c(_a.a.p,"UserOofNotificationProvider::ctor",this.f)};_d.cy.prototype={c:null,j:null,i:null,m:function(){var n=new _c.U(this.c);n.w(this.g);OwaApplication.a.a(n)},n:function(n){this.c.a()},b:function(n){this.c=n;!this.c.a()},a:function(){return new _c.x},l:function(){},k:function(){this.c.b(!1);var n=new _c.Y(this.c);n.v(this.h);OwaApplication.a.a(n)},o:function(n){_a.M.a(_nbs.a.Mu,0)}};_d.bX=function(n,t,i,r,u,f,e,o){this.c=n;this.e=t;this.f=i;this.i=r;this.j=u;this.k=f;this.d=e;this.l=o};_d.bX.prototype={c:null,e:null,f:null,i:null,j:null,d:null,l:null,g:null,k:null,h:!1,b:function(n,t,i,r,u){return new _d.G(n,t,i,this.f,this.c,this.j,this.k,this.h,this.d,this.g,r,this.e,u)},a:function(n,t,i,r,u,f){return new _d.d(n,t,i,this.f,this.c,r,this.i,this.h,this.d,this.g,u,this.e,this.l,f)}};_d.bo=function(){};_d.bo.c=function(n){for(var r=[],t=0;t<n.b();++t){var i={};i.DisplayName=n.c(t).bl.Mailbox.Name;i.SmtpAddress=n.c(t).bl.Mailbox.EmailAddress;i.RoutingType=n.c(t).bl.Mailbox.RoutingType;Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.bo.a=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.f;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var u=new _g.t;var i=new _g.d;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;u.g(i);t.a(u)});return t};_d.bo.d=function(n){for(var r=[],t=0;t<n.x.length;++t){var i={};i.DisplayName=n.x[t].a().c();i.SmtpAddress=n.x[t].a().a().EmailAddress;i.RoutingType=n.x[t].a().a().RoutingType;i.GALContactGuid=n.x[t].a().bj();Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.bo.b=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.f;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var i=new _g.d;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;t.a(i)});return t};_d.e=function(n,t,i){this.o=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.w);_d.e.initializeBase(this,[_d.e.f(),_d.e.h(),_d.e.i(),_d.e.g(t,i),n,null,t,i]);this.h=_d.e.c("AllowMultipleSelection");this.i=new _C(this.n,_a.a.b);this.j=new _C(this.o,_a.a.b);var r=this.y();this.z(_y.i.a(null,r,null));this.d.H(!1);this.F()};_d.e.d=function(){if(!_d.e.a){_d.e.a={};_d.e.a[_d.a.toString(0)]=_nbs.a.Qe;_d.e.a[_d.a.toString(1)]=_nbs.a.s;_d.e.a[_d.a.toString(2)]=_nbs.a.s;_d.e.a[_d.a.toString(3)]=_nbs.a.Qe;_d.e.a[_d.a.toString(4)]=_nbs.a.eG;_d.e.a[_d.a.toString(6)]=_nbs.a.IN;_d.e.a[_d.a.toString(5)]=_nbs.a.NQ;_d.e.a[_d.a.toString(7)]=_nbs.a.y;_d.e.a[_d.a.toString(8)]=_nbs.a.MP;_d.e.a[_d.a.toString(9)]=_nbs.a.iw;_d.e.a[_d.a.toString(10)]=_nbs.a.iw;_d.e.a[_d.a.toString(11)]=_nbs.a.iw}return _d.e.a};_d.e.e=function(){if(!_d.e.b){_d.e.b={};_d.e.b[_d.a.toString(0)]=_nbs.a.PT;_d.e.b[_d.a.toString(1)]=_nbs.a.WB;_d.e.b[_d.a.toString(2)]=_nbs.a.WB;_d.e.b[_d.a.toString(3)]=_nbs.a.PT;_d.e.b[_d.a.toString(4)]=_nbs.a.Eo;_d.e.b[_d.a.toString(6)]=_nbs.a.jm;_d.e.b[_d.a.toString(5)]=_nbs.a.hZ;_d.e.b[_d.a.toString(7)]=_nbs.a.CW;_d.e.b[_d.a.toString(8)]=_nbs.a.Nf;_d.e.b[_d.a.toString(9)]=_nbs.a.HJ;_d.e.b[_d.a.toString(10)]=_nbs.a.HJ;_d.e.b[_d.a.toString(11)]=_nbs.a.HJ}return _d.e.b};_d.e.f=function(){var n=window.dialogArguments;return _d.bo.a(n)};_d.e.c=function(n){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);return t[n]};_d.e.h=function(){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);var n=t.PickerCallerType;return _d.e.d()[_d.a.toString(n)]};_d.e.i=function(){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);var n=t.PickerCallerType;return _d.e.e()[_d.a.toString(n)]};_d.e.g=function(n,t){var r=window.dialogArguments;var f=JsonParser.deserialize(r.Metadata);var u=f.PickerCallerType;var i=null;switch(u){case 4:case 6:case 5:case 7:case 8:case 10:case 11:i=_fp.a.x;break;case 0:case 1:case 2:case 3:case 9:default:i=_fp.a.f;break}return new _fp.b(i,_fp.a.b(),n,t,_d.e.c("AllowAddAsSmtpAddress"),null,!1,null,null,null,null,null,0)};_d.e.prototype={i:null,j:null,d:null,h:!1,z:function(n){if(this.d!==n){this.d=n;this.dQ("ApplicationBarViewModel")}return n},q:function(n){return this.h?!0:n.b()>=1?!1:!0},v:function(n){n.l(1,new Array(0),n.bA.a().EmailAddress)},r:function(n){return this.g.e(_pe.c.a,n)},w:function(){var n=window.dialogArguments;n.Properties=_d.bo.c(this.a);window.close()},x:function(){window.close()},y:function(){var n=new Array(2);n[0]=new _y.f(_y.b.d(),_y.b.h(),_u.W.h,this.i);n[1]=_y.f.a(_u.R.YW,this.j);return n}};_d.ch=function(n,t,i){this.e=n;this.d=t;this.c=i};_d.ch.prototype={e:null,d:null,c:null,b:function(n,t,i){return new _d.e(this.e,this.d,this.c)},a:function(n,t,i){return new _d.e(this.e,this.d,this.c)}};_d.N=function(n){this.h=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.l);_d.N.initializeBase(this);this.d=n;var t=this;this.f=new _C(this.i,_a.a.B,this,"Persona",function(){return!!t.a})};_d.N.a=function(n){return n.b()!==5};_d.N.prototype={d:null,b:null,f:null,a:null,e:function(){if(!this.b){this.b=this.d.a(_fp.a.K,_fp.a.b(),!1,"PersonaDetailedView",!1,_d.N.a,null,0);this.b.T();this.b.w(!0);this.b.bG(!0);this.b.F(!1);this.b.q(this.h);this.b.bq(100);this.b.G(0)}return this.b},g:function(n){if(this.a!==n){this.a=n;this.dU("Persona","RemoveRecipientText")}return n},j:function(){return!this.a||!this.a.a()?String.format(_u.P.l,""):String.format(_u.P.l,this.a.a().c())},c:function(){this.g(null);this.e().g("")},k:function(n,t){var i=n.h();i&&this.g(i)},l:function(){this.g(null);this.e().k(!0)}};_d.bW=function(n,t,i,r,u,f){this.k=Function.createDelegate(this,this.o);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.p);_d.bW.initializeBase(this);_a.b.a(i,"folderPickerContainer shouldn't be null");_a.b.a(r,"owaShell shouldn't be null");_a.b.a(u,"passFolderCheck shouldn't be null");_a.b.a(f,"conductor shouldn't be null");this.a=i;this.i=r;this.d(n);this.c(t);this.j=u;this.f=f;this.h=new _C(this.l,_a.a.C);this.g=new _C(this.m,_a.a.C)};_d.bW.prototype={a:null,i:null,j:null,f:null,e:null,b:null,h:null,g:null,d:function(n){if(this.e!==n){this.e=n;this.dQ("FolderName")}return n},c:function(n){if(this.b!==n){this.b=n;this.dQ("FolderId")}return n},p:function(){switch(this.i.a()){case"Mouse":case"TouchWide":this.q();break;case"TouchNarrow":this.r();break}},q:function(){this.a.c||this.a.b();if(this.a.c){var n=this;var t=new _C(function(){n.a.c.a.a()&&n.n(n.a.c.a.a().j)},_a.a.C);this.a.c.c(t,_nbs.a.lf,_nbs.a.lf)}},r:function(){this.a.d||this.a.r();if(this.a.d){this.a.d.a.r=new _C(this.k,_a.a.o);this.f.d(this.a.d)}},o:function(){var n=this.a.d.a;n.a()&&this.n(n.a().j);n.r=null;this.f.c()},n:function(n){if(this.j(n)){this.d(n.bl.DisplayName);this.c(n.bl.FolderId.Id)}},t:function(){this.d("");this.c("")}};_d.C=function(n,t,i){this.j=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.m);_d.C.initializeBase(this);this.f=n;this.g=t;this.h=i};_d.C.prototype={f:null,g:null,h:null,e:null,c:null,d:null,a:function(){return this.c},k:function(n){if(n!==this.c){this.c=n;this.dQ("FolderPickerDialog")}return n},b:function(){if(this.l()){this.k(new _y.cs(new _y.bi(this.f,this.e,_g.a.a(),this.h,null,null,!0,!1,!1,null,null,null,null)));this.g.a(_d.C.a,"RemovePickerDialog",this.i,9e5)}},r:function(){if(this.l()){this.d=new _y.bD(new _y.bi(this.f,this.e,_g.a.a(),this.h,null,null,!0,!1,!1,null,null,null,null),null);this.d.d(_nbs.a.Cn);this.g.a(_d.C.a,"RemoveFolderPickerScreen",this.j,9e5)}},l:function(){var n=_h.a.b("msgfolderroot");var t=n.h||_g.q.a("msgfolderroot");if(n&&t){this.e=new _js.f;var i=new _y.Y(this.f,"msgfolderroot",t,n,_g.a.a());this.e.a(i);return!0}else{this.q();return!1}},m:function(){this.c&&this.c.j?this.g.a(_d.C.a,"RemovePickerDialog",this.i,9e5):this.o()},n:function(){_js.Trace.logInfo(_d.C.a,"FolderPickerContainer.RemoveFolderPickerScreen");this.d.c?this.g.a(_d.C.a,"RemoveFolderPickerScreen",this.j,9e5):this.p()},o:function(){this.e=null;this.k(null)},p:function(){this.e=null;this.d=null},q:function(){var n=new _a.o([_nbs.a.Mn],0,null,0,!1,_bcs.D.D,null,_nbs.a.Eb);this.f.a(_a.o,n)}};_d.bU=function(){this.c=timeRange;this.isDueDate=isDueDate;this.d=flagStatus;this.e=this.getHeader()};_d.bU.prototype={e:null,c:null,d:"NotFlagged",a:function(){return this.e},b:function(n){var t=n;return t?this.c.d(t):!1},toString:function(){return this.e},bd:function(n){if(_d.bU.isInstanceOfType(n)){var t=n;if(this.d===this.d)return this.c?this.c.bd(t.c):!t.c}return!1}};_d.bZ=function(n,t,i,r,u,f,e,o){this.f=t;this.e="";this.k=i;this.m=r;this.h=u;this.l=f;this.j=e;this.i=o;this.g=n};_d.bZ.prototype={g:null,i:null,f:!1,k:null,m:null,e:null,h:null,l:0,j:null,c:function(n){this.e=_js.d.b(n)?"":n.startsWith("&")?n:"&"+n;return n},b:function(){if(this.i.z())this.a(this.i.E());else{var t=0;this.q()?t=4:this.h&&this.h.a()&&(t=this.h.a().a);var n=0;switch(t){case 0:n=0;break;case 1:n=1;break;case 2:n=2;break;case 3:n=3;break;case 4:n=5;break;default:break}this.a(n)}},a:function(n){this.r(n)},d:function(n,t){var r=this.o(n,t);var i=this.f?"MicrosoftOffice365Help":"OWAPremiumHelp";this.k.a(r,i,this.n())},s:function(n){var t=this.p(n);if(t){var i=this.f?"MicrosoftOffice365Help":"OWAPremiumHelp";this.k.a(t,i,this.n())}},q:function(){return this.j.a()==="TouchWide"&&_d.t.isInstanceOfType(this.j.p().a())?!0:!1},p:function(n){var t=null;if(this.g){t=n!==119?String.format(this.g,_js.l.b(_y.fD,n)):this.g;this.f&&(t+=this.e)}return t},o:function(n,t){var i=null;i=_js.d.c("http://office.microsoft.com/client/15/help/results?ShowNav=true&lcid=1033&ns=OLWAO365E&ver=15&mode=Desktop&helpid=ms.exch.owap.{0}&qu={1}",n,t);this.f&&(i+=this.e);return i},n:function(){return this.l==="Mouse"?"width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes":""},r:function(n){this.m.c(_g.j.a)||this.s(n)}};_d.bG=function(n,t){this.g=Function.createDelegate(this,this.i);_d.bG.initializeBase(this);this.e=n;this.c=new _d.N(t);this.h()};_d.bG.prototype={e:null,f:null,d:null,c:null,a:function(){return this.d},j:function(n){if(this.d!==n){this.d=n;this.dQ("DialogViewModel")}return n},b:function(){this.c.c();this.d.g(!0)},i:function(){if(this.c.a){this.e.a(_y.dY,new _y.dY(this.c.a.a().a().EmailAddress));this.d.i.a();_a.l.b("VM.MailUsage.OpenFromExplicitLogonWindow")}},h:function(){var n=new _bc.j;n.k(_nbs.a.kb);n.m(this);var t=this;this.f=new _C(this.g,_a.a.dg,this.c,"Persona",function(){return!!t.c.a});n.h.a(new _ff.f(this.f,_nbs.a.ea));n.h.a(new _ff.f(n.i,_u.R.ZZ));this.j(n)}};_d.bF=function(n,t,i,r){this.i=Function.createDelegate(this,this.l);this.j=Function.createDelegate(this,this.n);_a.b.b(n,"offlineSettings");_a.b.b(t,"owaShell");_a.b.b(r,"eventAggregator");this.d=n;this.g=t;this.e=i;r.b(_a.cU,this.j);var u=this;this.h=new _ff.l(function(){return new _y.fk})};_d.bF.prototype={d:null,g:null,h:null,e:0,f:function(){return this.h.e()},k:function(){return!this.d.b()&&this.d.k(this.e,!1)},c:function(n){if(n&&!n.n.a){if(this.d.b()){this.m();return!0}if(this.k()){this.l();return!0}}return!1},a:function(n){this.k()&&!n.j(9600)&&n.d(9600,null,_nbs.a.e,this.i)},b:function(n){n.b(9600)},m:function(){this.f().g(!1);this.g.d(this.f())},l:function(){this.f().g(!0);this.g.d(this.f())},n:function(n){var t=n.a;this.e=t.bl.PolicySettings.AllowOfflineOn}};_d.J=function(n,t){this.g=Function.createDelegate(this,this.j);_d.J.initializeBase(this);this.b=t;this.a=n;this.c=_d.J.b();this.h=new _C(this.g,_a.a.x);this.k();switch(this.a.e()){case 0:case 1:break;default:throw Error.invalidOperation(String.format("Invalid value {0} for reminder group",this.a.e()));}};_d.J.a=function(n,t){_a.b.b(n,"object1");_a.b.b(t,"object2");var r=n.a;var i=t.a;return r.a().b(i.a())};_d.J.b=function(){var n=_a.c.a();return new _a.c(n.e(),n.d(),n.i(),n.l(),n.p(),0)};_d.J.prototype={b:null,h:null,a:null,c:null,f:!1,d:null,e:null,i:function(){var n="";this.a.e()?this.a.e()===1&&(n=this.a.b().a(18)):n=_a.c.k(this.a.a(),this.c)&&_a.c.k(this.a.a(),this.a.f())?String.format(_nbs.a.La,this.a.a().a(18),this.a.f().a(18)):String.format(_nbs.a.NR,this.a.a().a(18),this.a.a().a(3));return n},k:function(){var i=null;this.a.e()?this.a.e()===1&&(i=this.a.b()):i=this.a.a();var n=Math.floor(i.g(this.c)/1e3);var t=_a.c.bU(n<0?-n:n,!0,!0);this.f=n<0;if(n&&t.length){this.d=t[1];this.e=t[0]}else{this.d=_nbs.a.NE;this.e=""}this.eb("TimeToItemStartUnit","TimeToItemStartValue","IsReminderOverdue")},j:function(){var n=this.a.h();if((n&1)==1){var i=new _y.I;i.b(this.a.c());var r=(n&4)==4?IBirthdayFactory:ICalendarItemDetailsViewModelFactory;this.b.t(r,null,i.a,_bc.c.a())}else if(n===2){var t={};t.ItemID=this.a.c().Id;this.b.t(ITaskReadingPaneViewModelPopOutFactory,null,t,_bc.c.a())}}};_d.bK=function(n){_d.bK.initializeBase(this);this.a=n};_d.bK.prototype={a:null,b:function(n){return new _d.J(n,this.a)}};_d.bL=function(n,t,i,r,u,f,e){this.w=Function.createDelegate(this,this.H);this.z=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.K);this.k=Function.createDelegate(this,this.J);this.v=Function.createDelegate(this,this.G);this.x=Function.createDelegate(this,this.I);this.t=Function.createDelegate(this,this.F);_d.bL.initializeBase(this);_a.b.b(i,"nativeBridge");_a.b.b(r,"offlineSettings");_a.b.b(u,"userAgent");this.q=n;this.d=new _h.cd;this.e={};this.p=r;this.h=u;this.b=f;this.l=e;this.a=new _a.dx(this.t);this.a.d(this.x);this.c=new _a.dx(this.v);this.j=i;if(t){t.d(_h.dd,new _h.dd);var o=this;t.b(_a.bz,function(n){n.a&&o.L()})}};_d.bL.prototype={p:null,q:null,h:null,b:null,l:null,a:null,c:null,j:null,d:null,e:null,g:null,i:null,f:null,m:!0,o:!1,L:function(){if(!this.A()){this.b.a().apcl("EnableReminders",this.k);this.o=!0;_js.Trace.logInfo(_a.a.x,"Disabling reminders entirely. EnableReminders:{0}, IsPalEnabled:{1} Seg.Calendar:{2} Seg.Tasks:{3}",this.b.a().bl.EnableReminders,this.h.c(),this.b.e().bl.Calendar,this.b.e().bl.Tasks);return}this.D();if(this.p.a())_js.Trace.logInfo(_a.a.x,"Fetch reminders on OwaStarted event skipped as offline is enabled.");else{_js.Trace.logInfo(_a.a.x,"Fetch reminders on OwaStarted event.");this.n(0,null)}},n:function(n,t){_js.Trace.logInfo(_a.a.x,"Calling GetReminders. ReminderType = {0}",n);n&&n!==1||this.r(null);this.f=_js.g.a().b(this.f);var u=!this.h.c()||this.l.a().o().Enabled;var i=new _h.du(u,this.b.e());i.c=n;i.j(this.h.a()?64:200);var r=_a.c.a();switch(n){case 0:i.a=r.c(10);break;case 1:i.e=r.m(-864e5);i.a=i.a=r.c(10);break;case 2:i.a=r.m(-864e5);break}i.w(this.y);if(t){var f=this;i.z(function(n){t()})}OwaApplication.a.a(i)},E:function(n){for(var i=[],t,f,e,r=this.c.x.length-1;r>=0;r--){t=this.c.x[r];f=this.q.b(t);if(t.b().t().b(n)<=0){var u=t.d()?t.d().Id:"";if(this.e[u]){e=this.e[u];this.a.m(e,!0);e.dispose();this.e[u]=f}Array.add(i,f)}else break}if(i.length>0){this.a.p(i);this.c.q(this.c.x.length-i.length,i.length)}this.B(n)},D:function(){_js.Trace.logInfo(_a.a.x,"Subscribe for reminders notifications.");var n=new _g.be;n.NotificationType="ReminderNotification";var t=new _h.J(n);t.l(_a.a.x,"ReminderNotification",this.z,0)},G:function(n,t){return _h.cd.a(t,n)},F:function(n,t){return _d.J.a(t,n)},I:function(n,t){this.m&&this.ea("ActiveRemindersChanged",n,t)},M:function(n){_a.b.a(n,"notification");if(n.id!=="ReminderNotification")throw Error.argument("notification","Notification Id must be ReminderNotification");_js.Trace.logInfo(_a.a.x,"Received reminder notification");var i=n;if(i.shouldGetReminders){this.f&&(this.f=_js.g.a().b(this.f));var t=this;this.f=_js.g.a().a(_a.a.x,"ReminderNotification",function(){t.n(0,null)},8e3)}},K:function(n){var t=n;_js.Trace.logInfo(_a.a.x,"GetReminders succeeded. Received {0} reminders",t.d.x.length);this.N(t)||this.P(t)},P:function(n){this.ea("BeforeRemindersRefresh",this,null);this.g=_js.g.a().b(this.g);this.c.f();this.m=!1;var h=this.d;this.d=n.d;for(var c=this.a.x.length,u=0;u<c;u++)this.a.x[u]&&this.a.x[u].dispose();this.a.f();this.e={};for(var s=_a.c.get_utcNow(),t,r=-1,i=!1,f=this.d.x.length-1;f>=0;f--){t=this.d.x[f];if(t.b().t().b(s)>0)this.c.a(t);else{this.a.x.length||(r=h.k(t));var o=!!t.d();if(!o||!(t.d().Id in this.e)){var e=this.q.b(t);this.a.a(e);o&&(this.e[t.d().Id]=e);if(i)continue;i=r<0||!h.x[r].bd(t)}r--}}i=!!(i|c!==this.a.x.length);i&&this.ea("ActiveRemindersChanged",this.a,new _js.A(4,0,[],[]));this.c.x.length>0&&this.B(s);this.r(n);this.m=!0;this.ea("AfterRemindersRefresh",this,null)},N:function(n){_js.Trace.logInfo(_a.a.x,"Scheduling reminders in PAL...");if(!this.j.b(this.j.j()))return!1;for(var i=n.A.Body.Reminders,h=this.l.a().o().Enabled,u=new Array(0),f=i,c=f.length,r=0;r<c;++r){var t=f[r];!t.ReminderGroup&&_a.c.b(t.EndDate).b(_a.c.a())>=0?Array.add(u,t):t.ReminderGroup===1&&h&&Array.add(u,t)}i=u;_js.Trace.logInfo(_a.a.x,"Serializing {0} reminders...",i.length);var s=JsonParser.serialize(i);_js.Trace.logInfo(_a.a.x,"Scheduling {0} reminders on PAL...",i.length);var o=this,e=this;this.j.j().b(s,function(){_js.Trace.logInfo(_a.a.x,"Schedule reminders on PAL succeeded.");o.r(n)},function(t){_js.Trace.logError(_a.a.x,"Failed to schedule reminders on PAL : {0}",t.message);e.r(n)});return!0},r:function(n){this.i&&(this.i=_js.g.a().b(this.i));if(this.p.a()){_js.Trace.logInfo(_a.a.x,"Offline is enabled and so no need to schedule reminders timer");return}if(n){if(!n.c||n.c===1){var r=_a.c.get_utcNow();var i=null;this.d.x.length===n.f&&this.d.x.length>=1&&(i=this.d.x[this.d.x.length-1].b().t());var u=r.m(288e5);var t=288e5;if(i)if(i.b(r)<=0)t=6e5;else if(i.b(u)<0){t=i.g(r);t=Math.max(t,6e5)}this.C(t)}}else this.C(6e5)},C:function(n){_js.Trace.logInfo(_a.a.x,"Scheduling next GetReminers call to happen in {0} milliseconds",n);this.i=_js.g.a().a(_a.a.x,"GetReminders",this.w,n)},H:function(){_js.Trace.logInfo(_a.a.x,"GetReminers timer expired");this.n(0,null)},B:function(n){this.g=_js.g.a().b(this.g);if(this.c.x.length){var r=this.c.x[this.c.x.length-1];var i=r.b().t().g(n);var t=this;this.g=_js.g.a().a(_a.a.x,"ActivateReminders",function(){t.E(_a.c.get_utcNow())},i)}},A:function(){var i=this.b.a().bl.EnableReminders;var t=this.b.e().bl.Calendar;var n=this.b.e().bl.Tasks;return this.h.c()?this.b.e().bl.Calendar:i&&(t||n)},J:function(n,t){if(this.A()){this.D();this.n(0,null);this.b.a().rpcl("EnableReminders",this.k);this.o=!1}},dT:function(){this.o&&this.b.a().rpcl("EnableReminders",this.k);_a.jV.prototype.dT.call(this)}};_d.bg=function(){this.$$d_openSelectedReminder=Function.createDelegate(this,this.openSelectedReminder);this.$$d_updateCalculatedProperties=Function.createDelegate(this,this.updateCalculatedProperties);this.$$d_dismissAllReminders=Function.createDelegate(this,this.dismissAllReminders);this.$$d_dismissSelectedReminders=Function.createDelegate(this,this.dismissSelectedReminders);this.$$d_onSnoozeReminderButtonPressed=Function.createDelegate(this,this.onSnoozeReminderButtonPressed);this.$$d_onSelectedRemindersCountChanged=Function.createDelegate(this,this.onSelectedRemindersCountChanged);this.$$d_onAfterRemindersRefresh=Function.createDelegate(this,this.onAfterRemindersRefresh);this.$$d_onBeforeRemindersRefresh=Function.createDelegate(this,this.onBeforeRemindersRefresh);this.$$d_onActiveRemindersChanged=Function.createDelegate(this,this.onActiveRemindersChanged);_d.bg.initializeBase(this);this.f=remindersManager;remindersManager.a.d(this.$$d_onActiveRemindersChanged);remindersManager.add_beforeRemindersRefresh(this.$$d_onBeforeRemindersRefresh);remindersManager.add_afterRemindersRefresh(this.$$d_onAfterRemindersRefresh);this.c=new _js.f;this.c.apcl("Count",this.$$d_onSelectedRemindersCountChanged);this.previouslySelectedReminders=[];var i=this;this.snoozeRemindersCommand=new _C(this.$$d_onSnoozeReminderButtonPressed,_d.bg.a,this,"CanActOnSelectedReminders",function(){return i.get_canActOnSelectedReminders()});var t=this;this.dismissRemindersCommand=new _C(this.$$d_dismissSelectedReminders,_d.bg.a,this,"CanActOnSelectedReminders",function(){return t.get_canActOnSelectedReminders()});this.dismissAllRemindersCommand=new _C(this.$$d_dismissAllReminders,_d.bg.a);this.g=new _C(this.$$d_updateCalculatedProperties,_d.bg.a);this.e=new _C(this.$$d_openSelectedReminder,_d.bg.a);this.a=new _js.f;this.generateDefaultSnoozeOptions();this.m(!1);if(_y.c.a.a()!=="Mouse"){var n=[new _y.f(_y.b.v(),_y.b.w(),_nbs.a.Wu,this.snoozeRemindersCommand),new _y.f(_y.b.f(),_y.b.g(),_u.R.Qp,this.dismissRemindersCommand)];this.ds(_y.i.b(this,n,null))}};_d.bg.prototype={g:null,f:null,b:null,c:null,a:null,d:0,e:null,j:function(){return _y.c.a.a()!=="Mouse"?_y.hJ.prototype.j.call(this):0},h:function(n){if(this.b!==n){this.b=n;this.dQ("SelectedReminder");this.m(!0)}return n},l:function(n){if(n!==this.d){this.d=n;this.dQ("SelectedSnoozeTime")}return n},k:function(n){this.c!==n&&(this.c=n);return n},m:function(n){var t=[];if(this.b&&this.c.x.length===1){var r=_a.c.a();var u=this.b.a.a().r(-15);r.b(u)<=0&&Array.add(t,-15);r.b(u.r(5))<=0&&Array.add(t,-10);r.b(u.r(10))<=0&&Array.add(t,-5);r.b(this.b.a.a())<=0&&Array.add(t,0)}if(!t.length||t[0]!==this.a.x[0]){for(var i=0;i<this.a.x.length;i++)if(this.a.x[i]===5)break;this.a.q(0,i);t.length>0&&this.a.s(0,t)}(this.d<this.a.x[0]||n)&&this.l(this.a.x[0])}};_d.cp=function(n,t,i,r){this.a=this.$$gta["_d.cp"].T===Number||Type.isEnum(this.$$gta["_d.cp"].T)?0:this.$$gta["_d.cp"].T===Boolean?!1:null;if(!t)throw Error.argumentNull("isSameSelection");if(!i)throw Error.argumentNull("setSelection");if(!r)throw Error.argumentNull("undoSelection");this.a=n;this.b=t;this.c=i;this.d=r};_d.cp.$$=function(n){var t="cp"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.cp.apply(this,t)};r.registerClass("_d."+t);var e={"_d.cp":{T:n}};r.prototype.$$gta=e;var f=_d.cp.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.cp.prototype={b:null,c:null,d:null,e:function(n){if(!this.b(this.a)){var t=this;n.k(function(n){n?t.a=t.c():t.d(t.a)})}}};_d.cA=function(n,t){_d.cA.initializeBase(this,[t]);this.f=n};_d.cA.prototype={f:null,j:function(){if(this.c.x.length===1){var n=this.c.x[0];this.f.a(n)}},i:function(){this.b.a(_nbs.a.nG);this.b.a(_nbs.a.ie);this.b.a(_nbs.a.Bp);this.b.a(_nbs.a.Tv);this.a=new _d.b(new(_d.cs.$$(_c.ca))(this.e),_nbs.a.Me,_nbs.a.Zb,this.b);this.a.n=_nbs.a.Rk}};_d.dh=function(n){this.h=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.k);_d.dh.initializeBase(this);_a.b.b(n,"speechManager");this.e=n;if(this.l()){this.b=new _js.f;this.c=new _js.f;this.i();this.a.by(new _C(this.g,_a.a.bk));this.a.bf(this.h)}else this.a=null};_d.dh.prototype={e:null,a:null,c:null,d:null,b:null,l:function(){return this.e.e()&&_g.a.a().c().bl.IsUserCultureSpeechEnabled},k:function(){this.c.f();this.d=this.a.a(this.c);this.a.be();this.d&&OwaApplication.a.a(this.d)},m:function(n,t){if(!n.ba()){this.j();this.a.bh()}}};_d.cs=function(n){_a.b.b(n,"speechManager");this.b=n};_d.cs.$$=function(n){var t="cs"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.cs.apply(this,t)};r.registerClass("_d."+t,null,_bc.bI);var e={"_d.cs":{TAction:n}};r.prototype.$$gta=e;var f=_d.cs.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.cs.prototype={b:null,a:function(n){var t=new this.$$gta["_d.cs"].TAction;t.j(this.b,n);return t}};_d.b=function(n,t,i,r){this.H=Function.createDelegate(this,this.br);this.K=Function.createDelegate(this,this.bs);this.G=Function.createDelegate(this,this.bq);this.W=Function.createDelegate(this,this.bC);this.V=Function.createDelegate(this,this.bp);this.U=Function.createDelegate(this,this.X);_d.b.initializeBase(this);this.m(this);this.F=t;this.T=i;this.S=r;this.L=n;this.t(new _C(this.U,_a.a.bk));this.bt(new _C(this.V,_a.a.bk));this.l=!1;this.bz(new _C(this.W,_a.a.bk));this.P(new _js.f);this.n=_nbs.a.Rk;this.C(!0)};_d.b.l=function(n){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.OnIsErrorChanged: NewValue: {0}",n.newValue);var t=n.instance;t.w.b(!n.newValue);t.e.b(!n.newValue)};_d.b.m=function(n){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.OnIsListeningChanged: NewValue: {0}",n.newValue);var t=n.instance;t.d.b(!n.newValue);t.f.b(!n.newValue)};_d.b.n=function(n){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.OnIsThinkingChanged: NewValue: {0}",n.newValue);var t=n.instance;t.d.b(!n.newValue)};_d.b.prototype={b:null,w:null,f:null,d:null,e:null,S:null,F:null,T:null,n:null,N:!1,E:!1,y:null,L:null,l:!1,bf:function(n){this.apcl(_d.b.a.a,n)},M:function(){return this.dS(_d.b.g)},by:function(n){this.dR(_d.b.g,n);return n},bn:function(){return this.dS(_d.b.i)},bz:function(n){this.dR(_d.b.i,n);return n},bj:function(){return this.dS(_d.b.c)},Q:function(n){this.dR(_d.b.c,n);return n},ba:function(){return this.dS(_d.b.a)},z:function(n){this.dR(_d.b.a,n);return n},Y:function(){return this.dS(_d.b.d)},bu:function(n){this.dR(_d.b.d,n);return n},Z:function(){return this.dS(_d.b.e)},bv:function(n){this.dR(_d.b.e,n);return n},bc:function(n){this.dR(_d.b.j,n);return n},bm:function(){return this.dS(_d.b.h)},c:function(n){this.dR(_d.b.h,n);return n},bk:function(){return this.dS(_d.b.k)},bi:function(){return this.dS(_d.b.b)},P:function(n){this.dR(_d.b.b,n);return n},bl:function(){return this.dS(_d.b.f)},bx:function(n){this.dR(_d.b.f,n);return n},bd:function(n){if(n){if(this.b)throw Error.invalidOperation("SpeechAction cannot be set while another speech action is active");this.b=n;this.b.z(this.G);this.b.a.c(this.K);this.b.a.b(this.H)}else if(this.b){this.b.K(this.G);this.b.a.h(this.K);this.b.a.g(this.H);this.b=null}return n},C:function(n){if(this.E!==n){this.E=n;this.dQ("ShowShortPanelSize")}return n},bt:function(n){if(this.y!==n){this.y=n;this.dQ("HelpCommand")}return n},a:function(n){this.bd(this.L.a(n));return this.b},be:function(){this.bB();this.k(this.F)},bh:function(){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.Deactivate");this.X()},bA:function(n){this.bb();switch(_a.W.b(n).a){case 1e3:this.R();this.k(this.bk());this.C(!1);break;case 1:this.R();this.k(_nbs.a.Zz);this.C(!1);this.l=!1;break;case 1003:this.R();this.k(this.n);break;case 5:this.k(_nbs.a.dS);this.c(_nbs.a.YK);break;case 4:case 3:this.k(_nbs.a.Xs);this.c(_nbs.a.eR);break;case 1002:this.k(_nbs.a.Xs);this.c(_nbs.a.Pf);break;case 1006:this.k(_nbs.a.PV);this.c(_nbs.a.Hk);break;case 6:this.k(_nbs.a.He);this.c(_nbs.a.mW);break;case 1005:this.k(_nbs.a.He);this.c(_nbs.a.Ou);break;case 1004:this.k(this.n);this.c(_nbs.a.Jl);break;default:this.k(_nbs.a.He);this.c(n.message);break}},R:function(){this.c(this.T);this.P(this.S)},bs:function(n){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.OnSpeechStateChanged: {0}",_a.gs.toString(n));this.bb();this.bu(n===1);this.bv(n===2);if(this.Y()){this.Q(!1);this.bc(!1);this.k(this.F);this.z(!0)}else if(this.Z()){this.k(_nbs.a.KJ);this.c(_nbs.a.Xg);this.b.h("Thinking")}},br:function(n){this.bx(n)},bC:function(){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.StopListening");this.b.m()},X:function(){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.Cancel");this.z(!1);if(this.b){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.Cancel: speechAction != null calling SpeechAction.Cancel()");this.b.f()}},bp:function(){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.HelpPressed");this.l=!0;this.b.f()},bq:function(n){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.OnActionCompleted");var t=this.b.t;this.b.b.x.length>0&&(this.N=!0);this.bd(null);this.Q(!1);if(!$a(t)){_js.Trace.logInfo(_a.a.bk,"SpeechInputViewModel.OnActionCompleted: Error:{0}",t.message);if(!_a.W.m(t)||this.l){this.Q(!0);this.bA(t);this.bc(_a.W.n(t))}}this.z(this.bj())},bb:function(){this.c("");this.k("");this.P(null);this.N=!1;this.C(!0)},bB:function(){this.o(new _js.f);this.w=new _ff.f(this.M(),_u.R.Hh);this.w.b(!0);this.h.a(this.w);this.f=new _ff.f(this.bn(),_nbs.a.Vu);this.f.b(!0);this.h.a(this.f);this.d=new _ff.f(this.i,_bcs.D.A);this.d.b(!0);this.h.a(this.d);this.e=new _ff.f(this.i,_wss.i.O);this.e.b(!0);this.h.a(this.e)}};_d.cH=function(n,t,i,r,u,f,e){this.g=Function.createDelegate(this,this.n);this.e=n;this.f=t;this.h=i;this.l=r;this.j=u;this.k=f;this.i=e};_d.cH.prototype={l:null,j:null,k:null,e:null,f:null,h:null,d:null,i:null,b:function(n,t,i){var r=n.IsArchive.toString()==="true";var e=new _y.H(this.e,this.f,null,null);var f=new _d.bz(this.e,this.f,this.h,this.l,this.j,this.k,this.i,n.FilterContacts.toString()==="1",n.IsConsumer.toString()==="1");this.d=new _d.bT(f,e);if(r&&!_g.b.a.nameToId("archiverecoverableitemsdeletions"))this.m();else{var u=r?_g.q.a("archiverecoverableitemsdeletions"):_g.q.a("recoverableitemsdeletions");this.d.a.cv(u,null);this.d.a.U(0)}return this.d},a:function(n,t,i){throw Error.notImplemented("Creating from context is not supported");},c:function(n,t,i){var r={};r.IsArchive=n;r.FilterContacts=t?1:0;r.IsConsumer=i?1:0;this.e.t(IDumpsterPopOutViewModelFactory,null,r,_bc.c.d())},m:function(){var t="archiverecoverableitemsdeletions";var n=new _h.bP("GetFolderAction_DumpsterPopOutViewModelFactory_"+t,!1);n.d=new _h.bM;n.c=[new _g.C(t)];n.z(this.g);OwaApplication.a.a(n)},n:function(n){var t=n;t.K(this.g);if(t.t){this.d.a.dh(11);return}this.d.a.cv(t.d.x[0],null);this.d.a.U(0)}};_d.bk=function(n,t,i,r,u,f,e,o){this.f=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.J);this.B=Function.createDelegate(this,this.P);this.A=Function.createDelegate(this,this.N);this.C=Function.createDelegate(this,this.R);this.z=Function.createDelegate(this,this.M);_d.bk.initializeBase(this);_a.b.a(n,"message");this.d=n;this.i=t;this.q=f;this.n=i;this.e=r;this.x=u;this.v=e;this.m=o;this.h=new _C(this.z,_a.a.cg);this.k=new _C(this.C,_a.a.cg);this.r=new _C(this.A,_a.a.cg);this.t=new _C(this.B,_a.a.cg);this.p=new _C(this.y,_a.a.cg);this.m=_a.UserAgent.getInstance();this.g=this.D(!0);this.j=this.D(!1);this.g||(this.o=this.h);this.j||(this.w=this.k);this.I();this.d.apcl("LastVerbExecuted",this.f);this.d.q().apcl("IsUndecidedApprovalRequest",this.f)};_d.bk.prototype={d:null,e:null,v:null,q:null,n:null,h:null,k:null,r:null,t:null,o:null,w:null,p:null,x:null,i:!1,m:null,g:null,j:null,l:!1,G:null,F:!1,S:function(n){if(n!==this.l){this.l=n;this.dQ("ShowApproveRejectButtons")}return n},L:function(){return this.m.g().d()},a:function(n){this.G=n;return n},b:function(n){this.F=n;return n},c:function(){this.d.rpcl("LastVerbExecuted",this.f);this.d.q().rpcl("IsUndecidedApprovalRequest",this.f)},I:function(){this.S(!!this.d.q()&&this.d.q().e()&&this.d.y()!==1&&this.d.y()!==2)},Q:function(n,t){this.I()},D:function(n){var i=n?0:1;if(this.d.bl.VotingInformation&&this.d.bl.VotingInformation.UserOptions&&this.d.bl.VotingInformation.UserOptions.length>=i&&this.d.bl.VotingInformation.UserOptions[i].SendPrompt==="Send")return null;var t=[new _fm.d(_u.W.S,null,n?this.r:this.t),new _fm.d(_u.W.w,null,n?this.h:this.k)];this.e.a()==="TouchNarrow"&&Array.add(t,new _fm.d(_nbs.a.nc,null,this.p));return new _fm.f(t)},M:function(){this.H(!0)},R:function(){this.H(!1)},H:function(n){if(!this.i){var t=new _c.v(this.d,null,n,1);this.n.a(t);this.K()}},N:function(){this.E(!0)},P:function(){this.E(!1)},E:function(n){if(!this.i){var t=this.v.a(!1,!1);t.e(n?9:10);t.k(!0);t.o(this.e.a()==="Mouse"?1:2);t.N(this.d);this.q().a(t)}},J:function(){},K:function(){switch(this.e.a()){case"TouchNarrow":this.x.c();break;case"TouchWide":break;case"Mouse":if(!this.e.c()){var n=window.self;_js.g.a().c(_a.a.w,"ApprovalRequestHeaderViewModel.PopOutClose",n.$$d_close||(n.$$d_close=Function.createDelegate(n,n.close)))}break}}};_d.bQ=function(n,t,i,r,u){this.d=n;this.e=t;this.b=i;this.c=r;this.f=u};_d.bQ.prototype={d:null,e:null,b:null,c:null,f:null,a:function(n,t,i){t||(t=_y.bf.a);return new _d.bk(n,i,this.b,this.d,this.e,t,this.c,this.f)}};_d.bT=function(n,t){this.f=Function.createDelegate(this,this.k);this.g=Function.createDelegate(this,this.l);_d.bT.initializeBase(this);this.a=n;var u=this;this.e=new _C(function(){u.a.fJ()},_a.a.bS);var f=this;this.d=new _C(function(){f.a.fI()},_a.a.bS);var i=this;this.a.apcl("SelectedItemsCount",function(n,t){i.m(i.a.dq.x.length>0)});var r=this;this.a.apcl("CurrentTableLoaded",function(n,t){r.dQ("DumpsterDescription")});this.n(new _y.h("Mouse"));this.b.F(!1);this.b.bG(!0);this.b.G(1);this.b.w(!0);this.b.ca=!1;this.b.fd(t);this.b.bj(new _C(this.g,_a.a.bS));this.b.cJ(new _C(this.f,_a.a.bS))};_d.bT.prototype={e:null,d:null,a:null,b:null,c:!1,m:function(n){if(this.c===n)return n;this.c=n;this.dQ("AreActionCommandsEnabled");return n},h:function(){return this.a.bS?String.format(_nbs.a.IM,this.a.dn.g()):_nbs.a.kN},n:function(n){if(this.b!==n){this.b=n;this.dQ("SearchVM")}return n},l:function(){if(!_js.d.a(this.b.bt)&&this.b.bt.trim().length>0){this.b.cm(!0);this.a.D(this.b,!0)}},k:function(){_a.l.u("VM.FindMail.Search");this.b.cH();if(this.a.dr){this.a.cs(!0);var n=this;_js.g.a().c(_a.a.bS,"LoadItemsOnCancelSearch",function(){n.a.U(0)})}}};_d.bz=function(n,t,i,r,u,f,e,o,s){this.eR=Function.createDelegate(this,this.hD);this.eS=Function.createDelegate(this,this.hG);_d.bz.initializeBase(this,[n,t,i,u,r,f,null,null,null,null,null,null,e,null,null,null]);this.bS=o;this.cD=s;this.iO();this.t(new _h.C("DateTimeReceived","Descending"));this.ih=this.gI()};_d.bz.prototype={cD:!1,bS:!1,hD:function(n,t){var i=this;this.fH(n,function(){i.fo("HardDelete",i.m());_a.l.b("VM.MailUsage.PurgeFromDumpster")})},hG:function(n,t){var i=this;this.fH(n,function(){for(var e=i.dq,f=[],s=[],o=[],r=[],n=null,t=0;t<e.x.length;t++){var u=e.x[t];switch(u.bl.ItemClass){case"IPM.Appointment":n=f;break;case"IPM.DistList":case"IPM.Contact":n=r;break;case"IPM.Task":n=o;break;case"IPM.Note":default:n=s;break}Array.add(n,u)}i.dG(s,_g.q.a("inbox"));i.dG(f,_g.q.a("calendar"));i.dG(o,_g.q.a("tasks"));i.dG(r,_g.q.a("contacts"));_a.l.b("VM.MailUsage.RecoverFromDumpster")})},fJ:function(){if(this.dq.x.length){var t=this.bS&&this.cD?[_nbs.a.Sk]:[_nbs.a.ZC,_nbs.a.jF,_nbs.a.HD,_nbs.a.Y,_nbs.a.BA];var n=new _a.o(t,1,this.eS,1,!1,_u.P.T,_u.R.fU,_nbs.a.Wf);this.dH.a(_a.o,n)}},fI:function(){if(this.dq.x.length){var n=new _a.o([_nbs.a.mf],1,this.eR,1,!1,_u.P.T,_u.R.fU,_nbs.a.lH);this.dH.a(_a.o,n)}},hm:function(n,t){this.dQ("SelectedItemsCount")},iO:function(){var n=[];var i=this;Array.add(n,new _fm.d(_nbs.a.YE,null,new _C(function(){i.fJ()},_a.a.bS)));var t=this;Array.add(n,new _fm.d(_nbs.a.Wv,null,new _C(function(){t.fI()},_a.a.bS)));this.dg(new _fm.f(n))},im:function(){return!1},fH:function(n,t){if(n&&!(this.dq.x.length<=0)){var i=this.ej(this.m());t();this.dK(null);this.dK(i);this.em()}},dG:function(n,t){if(!(n.length<=0)){var i=new _h.bh(n,t.bl.FolderId,0);OwaApplication.a.a(i)}},gI:function(){if(this.cD){var t=this.bS?new _g.cA:new _g.fN;var n=this.bS?new _g.cA:new _g.fN;var i=this.bS?new _g.lg:new _g.mH;t=this.fD(t,"IPM.Contact");n=this.fD(n,"IPM.DistList");i.Items=[t,n];return new _g.cm(i)}return null},fD:function(n,t){n.Item=new _g.e("ItemClass");var r;var u=(r=new _g.ch,r.Value=t,r);var i;n.FieldURIOrConstant=(i=new _g.cj,i.Item=u,i);return n}};_d.cK=function(){};_d.cK.prototype={a:function(n){return new _y.n(n)}};_d.cc=function(n){this.b=n};_d.cc.prototype={b:null,a:function(n){if(n){if(_h.bL.isInstanceOfType(n)){var i=n;var t=_h.a.a(i.c);if(!t||!t.b)return}_h.dy.isInstanceOfType(n)&&this.c(n.p())}},c:function(n){switch(n){case"ErrorAccessDenied":case"ErrorMoveCopyFailed":case"ErrorCannotDeleteObject":case"ErrorFolderSavePropertyError":case"ErrorApplyConversationActionFailed":this.d();return;case"ErrorFolderExists":this.e();return}},e:function(){var n=new _a.o([_u.R.dL],0,null);this.b.a(_a.o,n)},d:function(){var n=new _a.o([_u.R.Bq],0,null,0,!1,null,null,_u.R.ST);this.b.a(_a.o,n)}};_d.cd=function(n,t){this.f=Function.createDelegate(this,this.g);this.e=Function.createDelegate(this,this.h);_d.cd.initializeBase(this);this.a=new _d.N(n);this.c=t};_d.cd.prototype={b:null,c:null,a:null,d:function(){this.b||this.i();return this.b},j:function(n){if(this.b!==n){this.b=n;this.dQ("DialogViewModel")}return n},i:function(){var n=new _bc.j;n.k(_nbs.a.Uv);n.m(this);var u=this;var f=new _C(this.e,_a.a.o,this.a,"Persona",function(){return!!u.a.a});var t=new _C(this.f,_a.a.o);n.t(t);var r=new _ff.f(f,_nbs.a.Dl);var i=new _ff.f(t,_u.R.fU);n.h.a(r);n.h.a(i);this.j(n)},h:function(){if(this.a.a){var n=new _g.mc;n.DisplayName=this.a.a.a().c();n.PrimarySmtpAddress=this.a.a.a().a().EmailAddress;n.DistinguishedUser="None";this.g();this.c(n)}},g:function(){this.d().g(!1);this.a.c()}};_d.r=function(n,t){this.V=Function.createDelegate(this,this.bn);this.W=Function.createDelegate(this,this.bp);this.R=Function.createDelegate(this,this.ba);this.U=Function.createDelegate(this,this.bm);this.S=Function.createDelegate(this,this.bk);this.T=Function.createDelegate(this,this.bl);_d.r.initializeBase(this);this.m(this);this.B(!0);this.H=t;this.P=new _C(this.T,_d.r.a);this.K=new _C(this.S,_d.r.a);this.Q=new _C(this.U,_d.r.a);this.d=new _js.f;this.N=new _y.t;this.E=new _d.cd(n,this.R);var r=new _ff.f(this.P,_nbs.a.TG);var i=new _ff.f(this.i,_nbs.a.Oo);this.o(new _js.f);this.h.a(r);this.h.a(i);this.k(_nbs.a.da)};_d.r.$$cctor=function(){_d.r.b=["PermissionLevel","ReadAccess","DeleteAccess","CanCreateItems","CanCreateSubfolders","EditOwn","EditAll","IsFolderOwner","IsFolderContact","IsFolderVisible"]};_d.r.prototype={H:null,P:null,K:null,Q:null,E:null,F:null,d:null,f:null,c:null,N:null,M:null,z:!1,n:!1,w:!1,C:!1,y:function(){this.F||(this.F=new _bc.b);return this.F},bi:function(){if($a(this.f)){this.f=new _js.f;this.f.a("Owner");this.f.a("PublishingEditor");this.f.a("Editor");this.f.a("PublishingAuthor");this.f.a("Author");this.f.a("NoneditingAuthor");this.f.a("Reviewer");this.f.a("Contributor");this.f.a("None")}return this.f},G:function(n){if(this.c===n)return n;this.c=n;this.dQ("SelectedItem");this.Z();return n},bh:function(){return this.c.a()},bD:function(n){if(this.c.a()!==n){this.c.g(n);this.e(!0);this.c.x();this.dQ("PermissionLevel");this.Z()}return n},bj:function(){return this.c.r()},bE:function(n){if(this.c.r()!==n){this.c.n(n);this.e(!0);this.l();this.dQ("ReadAccess")}return n},bc:function(){return this.c.p()},bt:function(n){if(this.c.p()!==n){this.c.k(n);this.e(!0);this.l();this.dQ("DeleteAccess")}return n},br:function(n){if(this.c.bl.CanCreateItems!==n){this.c.h(n);this.e(!0);this.l();this.dQ("CanCreateItems")}return n},bs:function(n){if(this.c.bl.CanCreateSubFolders!==n){this.c.j(n);this.e(!0);this.l();this.dQ("CanCreateSubfolders")}return n},be:function(){return this.c.f()==="Owned"||this.c.f()==="All"},bv:function(n){if(n){if(this.c.f()==="None"){this.c.c("Owned");this.e(!0);this.l();this.dU("EditOwn","EditAll")}}else if(this.c.f()==="None"){this.e(!0);this.l();this.dU("EditOwn","EditAll")}else this.c.f()==="All"&&this.dQ("EditOwn");this.L();return n},bx:function(n){if(this.w!==n){this.w=n;this.dQ("EditOwnEnabled")}return n},bd:function(){return this.c.f()==="All"},bu:function(n){if(n){(this.c.f()==="None"||this.c.f()==="Owned")&&this.c.c("All");this.e(!0);this.l();this.dU("EditOwn","EditAll")}else if(this.c.f()==="All"){this.e(!0);this.c.c("None");this.l();this.dU("EditOwn","EditAll")}this.L();return n},bB:function(n){if(this.c.bl.IsFolderOwner!==n){this.c.m(n);this.e(!0);this.l();this.dQ("IsFolderOwner")}return n},bf:function(){return this.c.q()},bz:function(n){if(this.c.q()!==n){this.c.b(n);this.e(!0);this.l();this.dQ("IsFolderContact")}return n},bA:function(n){if(this.C!==n){this.C=n;this.dQ("IsFolderContactEnabled")}return n},bC:function(n){if(this.c.bl.IsFolderVisible!==n){this.c.e(n);this.e(!0);this.l();this.dQ("IsFolderVisible")}return n},by:function(n){if(this.d!==n){this.d=n;this.dQ("FolderPermissionList")}return n},a:function(){return this},e:function(n){if(this.z!==n){this.z=n;this.dQ("IsDIrty")}return n},b:function(n,t){this.M=n;this.k(String.format(_nbs.a.da,n.bl.DisplayName));this.d.f();this.d.p(t.e().f());this.G(this.d.x[0]);this.e(!1);this.n=!1;this.g(!0)},ba:function(n){var r=this;var i=this.d.h(function(t){return t.A(n)});if(i!==this.d.x.length){this.y().a(0,String.format(_nbs.a.gu,n.DisplayName),null);return}var t=_g.I.c.o();t.s(n);this.d.a(t);this.e(!0);this.G(this.d.x[this.d.x.length-1])},bq:function(){var n=this.d.k(this.c);if(n!==-1){if(this.Y(this.c.bl.UserId)){this.y().a(0,_nbs.a.SA,null);return}var i=n===this.d.x.length-1?n-1:n;this.d.m(this.c,!0);this.e(!0);var t=this.d.x[i];this.G(t)}},l:function(){var n=this.c.y();if(n!==this.c.a()){this.c.g(n);this.dQ("PermissionLevel")}},bl:function(){if(!this.n)if(this.z){this.bF();this.n=!0}else this.X()},bF:function(){var n=new _h.ff;n.a=new _g.dF;n.a.f(new(_a.ge.$$(_g.I,_g.eM)));for(var t=0;t<this.d.x.length;t++){var r=this.d.x[t];var i=r.o();i.s(this.bb(r.bl.UserId));n.a.e().e(i)}n.c=this.M;n.z(this.W);n.v(this.V);this.H.a(n)},bb:function(n){var t=new _g.mc;t.DistinguishedUser=n.DistinguishedUser;t.ExternalUserIdentity=n.ExternalUserIdentity;t.PrimarySmtpAddress=n.PrimarySmtpAddress;t.SID=n.SID;return t},bk:function(){this.E.d().g(!0)},bm:function(){this.bq()},Z:function(){if(this.c){for(var n=0;n<_d.r.b.length;n++)this.dQ(_d.r.b[n]);this.L()}},L:function(){if(this.c){this.bx(this.c.f()!=="All");this.bA(!this.Y(this.c.bl.UserId))}},Y:function(n){return n.DistinguishedUser==="Anonymous"||n.DistinguishedUser==="Default"},bp:function(n){this.n=!1;n.t||this.X()},X:function(){this.d.f();this.e(!1);this.i.a()},bn:function(n){this.n=!1;var t=n.c.bl.DisplayName;this.y().a(0,String.format(_nbs.a.Ee,t),null)}};_d.br=function(n,t,i,r){this.q=Function.createDelegate(this,this.C);this.n=Function.createDelegate(this,this.z);this.o=Function.createDelegate(this,this.A);this.p=Function.createDelegate(this,this.B);_d.br.initializeBase(this);_a.b.a(n,"message");_a.b.a(i,"personaCardFacade");this.j=t;this.e=n;this.m=i;this.f=!0;this.g=!1;if(r){var u=this;r.a(function(n){u.l=n;u.y()})}};_d.br.prototype={m:null,e:null,j:null,k:null,f:!1,g:!1,h:null,l:null,i:null,t:null,r:!1,D:function(n){if(this.h!==n){this.h=n;this.dQ("ProcessMembershipCommand")}return n},b:function(){return new Array(0)},c:function(){},w:function(n){if(this.f!==n){this.f=n;this.dQ("HideProcessMembershipButton")}return n},v:function(n){if(this.i!==n){this.i=n;this.dQ("ErrorMessage")}return n},x:function(n){if(this.g!==n){this.g=n;this.dQ("IsLoading")}return n},a:function(n){this.t=n;return n},d:function(n){this.r=n;return n},y:function(){if(!this.h){var n=this.l.a(this.e.bl.ItemId);n.w(this.p);n.v(this.o);n.z(this.n);this.x(!0);this.j.a(n);this.D(new _C(this.q,_d.br.a))}},z:function(n){this.x(!1)},A:function(n){this.w(!0);this.v(_nbs.a.Ga)},B:function(n){var t=n;this.k=_pc.a.c(t.c().GroupPersona,2);this.v("");this.w(!t.c().IsOwner||this.e.bl.From.Mailbox.EmailAddress===_g.a.a().c().bl.UserEmailAddress)},C:function(){var t=_pc.a.b(this.e.bl.From.Mailbox);var n=new _d.bH;n.k().b=[t];this.m.m(this.k,n)}};_d.bA=function(n,t){this.m=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.y);this.q=Function.createDelegate(this,this.z);this.o=Function.createDelegate(this,this.r);this.l=Function.createDelegate(this,this.v);_d.bA.initializeBase(this);this.g=new _d.N(n);this.h=t};_d.bA.prototype={f:null,j:null,h:null,g:null,i:null,k:null,a:function(){if(!this.f){this.f=new _bc.j;this.f.k(_nbs.a.mc);this.f.m(this);var u=this;var r=new _C(this.l,_a.a.o,this.g,"Persona",function(){return!!u.g.a});var n=new _C(this.o,_a.a.o);this.f.t(n);var t=new _ff.f(r,_nbs.a.ad);var i=new _ff.f(n,_u.R.fU);this.f.h.a(t);this.f.h.a(i)}return this.f},b:function(){this.j||(this.j=new _bc.b);return this.j},d:function(n){this.i=n;return n},e:function(n){this.k=n;return n},c:function(n){if(n){var t=new _c.bN(n);t.w(this.q);t.v(this.p);this.h.a(t)}},v:function(){if(this.g.a){var t=this.g.a.a().c();var i=this.g.a.a().a().EmailAddress;var n=new _c.bp(t,i);n.w(this.n);n.v(this.m);this.h.a(n);this.r()}},r:function(){this.a().g(!1);this.g.c()},w:function(n){this.t()},x:function(n){if(this.i){var t=n;this.i(t.a,t.c)}},y:function(n){this.t()},t:function(){this.b().a(0,_u.R.ST,null,!1,null,null,_nbs.a.Yy)},z:function(n){if(this.k){var t=n;this.k(t.a)}}};_d.bd=function(){this.$$d_showFeedback=Function.createDelegate(this,this.showFeedback);_d.bd.initializeBase(this,[owaShell,displayName,eventAggregator,flightedFeatureManager,userAgent]);this.bc(!1);this.K(!0);this.bb(!1);this.set_owaFeedbackViewModel(owaFeedbackViewModel);this.flightedFeatureManager=flightedFeatureManager;this.l=userAgent;this.domWindow=domWindow;this.a=new _C(this.$$d_showFeedback,_d.bd.a)};_d.bd.prototype={a:null,l:null,k:function(){return null},o:function(){return null},h:function(){return{}},bE:function(){var n=[_y.f.b(new _C(this.m,_d.bd.a))];return _y.i.a(this,n,null)},W:function(){var n=new _ms.b;n.h(this.w);if(this.l.a()){n.e(2);n.k(2);n.g(new _ms.a(_fm.a.a,_fm.a.a,new _C(this.z,_d.bd.a),_ops.b.BA));n.i.a(!0)}else{n.e(1);n.f(new _ms.a(_y.b.a(),_y.b.a(),new _C(this.m,_d.bd.a),""))}return n}};_d.w=function(n,t,i,r,u,f,e){this.R=Function.createDelegate(this,this.bK);this.N=Function.createDelegate(this,this.by);this.Q=Function.createDelegate(this,this.bA);this.P=Function.createDelegate(this,this.bz);_d.w.initializeBase(this,[n,t,i,f,e]);this.bc(!1);this.K(!0);this.bb(!1);this.S=f;this.a=e;this.l=u;this.D=new _C(this.P,_a.a.d);this.E=new _C(this.Q,_a.a.d);this.C=new _C(this.N,_a.a.d);this.M=new _C(this.R,_a.a.d);this.bx()&&r&&(this.p=r.a)};_d.w.b=function(n,t,i,r,u,f,e){_a.b.b(n,"owaShell");return new _d.w(n,t,i,r,u,f,e)};_d.w.prototype={p:null,l:null,a:null,C:null,E:null,M:null,D:null,S:null,bx:function(){return _g.a.a().c().bl.IsBposUser},be:function(){return this.a.c()?null:this.p?this.p.I().bl.Url:"http://go.microsoft.com/fwlink/p/?LinkId=260597"},bg:function(){return this.a.c()?"http://go.microsoft.com/fwlink/?LinkId=301830":null},bf:function(){return this.a.c()?"http://go.microsoft.com/fwlink/?LinkId=392424":null},bw:function(){return this.a.a()&&this.a.c()?"http://go.microsoft.com/fwlink/?LinkId=299664":null},Y:function(n){n.b(!1);n.c(!0)},bE:function(){var n=[_y.f.b(new _C(this.m,_d.w.a))];return _y.i.a(this,n,null)},W:function(){var n=new _ms.b;n.h(this.w);if(this.a.a()){n.e(2);n.k(2);n.g(new _ms.a(_fm.a.a,_fm.a.a,new _C(this.z,_d.w.a),_ops.b.BA));n.i.a(!0)}else{n.e(1);n.f(new _ms.a(_y.b.a(),_y.b.a(),new _C(this.m,_d.w.a),""))}return n},k:function(){return null},o:function(){return null},h:function(){return{}},bz:function(){this.l.a(this.be(),null,null)},bA:function(){this.l.a(this.bf(),null,null)},by:function(){this.l.a(this.bg(),null,null)},bK:function(){this.l.a(this.bw(),null,null)}};_d.F=function(n,t,i,r,u){this.bx=Function.createDelegate(this,this.bK);this.by=Function.createDelegate(this,this.bL);_d.F.initializeBase(this,[n,t,i,r,u]);this.a=new _c.x;this.bd(this.a);this.bz=r;this.bA=u;var f=new _js.f;f.a(new _ff.f(new _C(this.by,_d.F.a),_u.P.b,null));f.a(new _ff.f(new _C(this.bx,_d.F.a),_bcs.D.A,null));this.bN(f)};_d.F.b=function(n,t,i,r,u){_a.b.b(n,"owaShell");return new _d.F(n,t,i,r,u)};_d.F.prototype={bA:null,l:!1,D:!1,E:0,C:null,p:null,a:null,be:!1,N:null,M:!1,bz:null,bM:function(n){if(this.be!==n){this.be=n;this.dQ("IsLoadingFinished")}return n},bw:function(n){if(this.l===n)return n;this.l=n;this.dQ("IsOofOn");return n},P:function(n){if(this.D===n)return n;this.D=n;this.dQ("EnableExternalReply");return n},R:function(n){if(this.E===n)return n;this.E=n;this.dQ("ReplyToExternalPeopleType");return n},bg:function(n){if(this.C===n)return n;this.C=n;this.dQ("EditorInternalReplyMessage");return n},bf:function(n){if(this.p===n)return n;this.p=n;this.dQ("EditorExternalReplyMessage");return n},bN:function(n){if(n!==this.N){this.N=n;this.dQ("OverwriteScheduleConfirmDialogButtonData")}return n},Q:function(n){if(n!==this.M){this.M=n;this.dQ("IsOverwriteScheduleConfirmDialogShown")}return n},bF:function(){return this.a.o&&!this.A()?_nbs.a.JR:_d.x.prototype.bF.call(this)},B:function(){return"Oof"},x:function(){this.bw(!1);this.bg("");this.bf("");this.bt();_d.x.prototype.x.call(this)},b:function(n){this.a.o?n&&!this.A()?this.S():this.Q(!0):this.S()},k:function(){return new _c.U(this.a)},o:function(){return new _c.Y(this.a)},h:function(){var n={};n.IsOofOn=!0;n.EnableExternalReply=!0;n.ReplyToExternalPeopleType=!0;n.EditorInternalReplyMessage=!0;n.EditorExternalReplyMessage=!0;return n},e:function(n){switch(this.a.k){case 2:this.P(!0);this.R(2);break;case 1:this.P(!0);this.R(1);break;default:this.P(!1);this.R(2);break}this.bw(this.a.n);this.bg(this.a.m);this.bf(this.a.l);this.bM(!0);_d.x.prototype.e.call(this,n)},g:function(n){this.r(this.l);_d.x.prototype.g.call(this,n)},F:function(n){return n?_nbs.a.NW:_nbs.a.Qr},bL:function(){this.Q(!1);this.S()},bK:function(){this.Q(!1)},S:function(){this.a.b(this.l);this.D?this.a.d(this.E):this.a.d(0);this.a.f(this.C);this.a.e(this.p);_d.x.prototype.b.call(this,!1);this.a.g(!1)}};_d.O=function(n,t,i,r,u,f){this.N=Function.createDelegate(this,this.be);this.P=Function.createDelegate(this,this.bf);_d.O.initializeBase(this,[n,t,r,u,f]);this.a=new _c.bq;this.bd(this.a);this.Q=u;this.S=f;var o=new _js.f;o.a(new _ff.f(new _C(this.P,_d.O.a),_u.P.b,null));o.a(new _ff.f(new _C(this.N,_d.O.a),_bcs.D.A,null));this.p=i;var e=this.k();e.w(this.U);e.v(this.T);OwaApplication.a.a(e);this.bw(o)};_d.O.b=function(n,t,i,r,u,f){_a.b.b(n,"owaShell");return new _d.O(n,t,i.g(),r,u,f)};_d.O.prototype={S:null,l:!1,a:null,E:!1,D:null,C:!1,p:null,Q:null,R:function(n){if(this.l===n)return n;this.l=n;this.dQ("IsSyncContactsToDeviceEnabled");return n},bg:function(n){if(this.E!==n){this.E=n;this.dQ("IsLoadingFinished")}return n},bw:function(n){if(n!==this.D){this.D=n;this.dQ("OverwriteScheduleConfirmDialogButtonData")}return n},M:function(n){if(n!==this.C){this.C=n;this.dQ("IsOverwriteScheduleConfirmDialogShown")}return n},B:function(){return null},ca:function(){return _nbs.a.LX},x:function(){this.l=!1;this.bt();_d.x.prototype.x.call(this)},b:function(n){this.a.b(this.l);_d.x.prototype.b.call(this,n)},k:function(){return new _c.bx(this.a,this.p)},o:function(){return new _c.bU(this.a,this.p)},h:function(){var n={};n.IsSyncContactsToDeviceEnabled=!0;return n},e:function(n){this.R(this.a.a);this.r(this.l);this.bg(!0);_d.x.prototype.e.call(this,n)},g:function(n){this.r(this.a.a);_d.x.prototype.g.call(this,n)},F:function(n){return n?_nbs.a.NW:_nbs.a.Qr},Y:function(n){this.r(this.l);n.b(!1);n.c(!0)},bf:function(){this.M(!1);this.b(!1)},be:function(){this.M(!1)}};_d.cL=function(n,t,i){_d.cL.initializeBase(this);_a.b.b(n,"saveAndNavigateAwayCommand");_a.b.b(t,"dontSaveAndNavigateAwayCommand");_a.b.b(i,"cancelCommand");this.g=n;this.e=t;this.d=i};_d.cL.prototype={g:null,e:null,d:null,a:null,b:!1,h:function(n){if(n!==this.a){this.a=n;this.bj("CloseConfirmDialogButtonData")}return n},c:function(n){if(n!==this.b){this.b=n;this.bj("IsCloseConfirmDialogShown")}return n},j:function(){this.i();this.c(!0)},f:function(){this.c(!1)},i:function(){if($a(this.a)){var n=new _js.f;n.a(new _ff.f(this.g,_u.P.b,null));n.a(new _ff.f(this.e,_u.R.IE,null));n.a(new _ff.f(this.d,_bcs.D.A,null));this.h(n)}}};_d.x=function(n,t,i,r,u){this.bh=Function.createDelegate(this,this.ct);this.bi=Function.createDelegate(this,this.cu);this.bB=Function.createDelegate(this,this.cB);this.bC=Function.createDelegate(this,this.g);this.bR=Function.createDelegate(this,this.bq);this.bS=Function.createDelegate(this,this.cw);this.bO=Function.createDelegate(this,this.cp);this.bP=Function.createDelegate(this,this.cq);this.bT=Function.createDelegate(this,this.cI);this.T=Function.createDelegate(this,this.cv);this.U=Function.createDelegate(this,this.e);this.z=Function.createDelegate(this,this.bH);this.m=Function.createDelegate(this,this.bD);_d.x.initializeBase(this);_a.b.b(n,"owaShell");this.d=n;this.w=t;this.H=i;this.I=r;this.bJ=u;this.t=new _d.cL(new _C(this.bT,_d.x.a),new _C(this.bP,_d.x.a),new _C(this.bO,_d.x.a));this.ce=new _y.bA;this.bp=new _bc.b;this.O(this.bS);if(this.d.a()==="TouchNarrow")if(this.I.a().b().Enabled)this.dy(this.W());else{this.ds(this.bE());this.bW(this.bR)}this.bI=new _C(this.z,_d.x.a)};_d.x.b=function(n,t){if(!$a(n.d))for(var h=n.d,w=h.length,f=0;f<w;++f){var y=h[f];y.a().c(!t)}if(!$a(n.e))for(var s=n.e,v=s.length,i=0;i<v;++i){var p=s[i];p.a().c(!t)}if(!$a(n.c))for(var o=n.c,b=o.length,r=0;r<b;++r){var c=o[r];c.a().c(!t)}$a(n.j)||n.j.a().c(!t);if(!$a(n.a))for(var e=n.a,a=e.length,u=0;u<a;++u){var l=e[u];l.a().c(!t)}};_d.x.prototype={d:null,t:null,w:null,bJ:null,V:null,G:null,cf:null,bv:null,c:null,y:null,cc:null,J:!1,bG:!1,bl:!1,X:!1,bk:!1,ce:null,bI:null,bp:null,H:null,bj:null,I:null,bU:function(n){this.dV("OnBack",n)},cE:function(n){this.dW("OnBack",n)},bV:function(n){this.dV("OnBusy",n)},bs:function(n){this.dW("OnBusy",n)},bW:function(n){this.dV("SetActionSuccess",n)},cG:function(n){this.dW("SetActionSuccess",n)},cn:function(n){this.dV("SetActionFailure",n)},cF:function(n){this.dW("SetActionFailure",n)},co:function(n){this.dV("ValidationOnSaveFailed",n)},cH:function(n){this.dW("ValidationOnSaveFailed",n)},bF:function(){return _nbs.a.Qm},ca:function(){return _bms.E.BA},B:function(){return null},L:function(n){this.bv=n;this.dQ("Summary");return n},r:function(n){this.cf=n;this.L(this.F(n));this.dQ("SummaryRaw");return n},bm:function(){return 1},q:function(){return null},bn:function(){return!0},n:function(){return this.V},f:function(n){this.V=n;return n},bY:function(){return this.bk},A:function(){return this.d.a()==="TouchNarrow"},cr:function(){return this.d.a()==="TouchWide"||this.I.a().b().Enabled?!0:!1},bc:function(n){this.J=n;this.dX("OnBusy");return n},K:function(n){this.bG=n;this.dQ("IsLoadSucceeded");return n},bb:function(n){this.bl=n;this.dQ("IsLoadFailed");return n},bu:function(n){this.X=n;this.dX("OnBusy");return n},bX:function(){return this.J?_u.R.EN:this.X?_nbs.a.LR:""},bZ:function(){return this.J||this.X},cb:function(){return this.A()?this.bZ():!1},j:function(){return 1},bd:function(n){this.cc=n;return n},cw:function(n,t){if(!$a(this.G)&&!$a(this.G[t])){this.bk=!0;this.G[t]=!0}},bt:function(){this.bk=!1},cD:function(){this.d.d(this)},bH:function(){this.b(!1)},b:function(n){if(!this.X&&!this.bl){if(!$a(this.y)){this.y.N(this.bC);this.y.M(this.bB)}this.y=this.o();this.y.w(this.bC);this.y.v(this.bB);this.bu(!0);OwaApplication.a.a(this.y)}},x:function(){if(!$a(this.c)){this.c.K(this.bi);this.c.N(this.U);this.c.M(this.T)}this.A()&&this.bV(this.bh);this.c=this.k();if(this.c){this.c.z(this.bi);this.c.w(this.U);this.c.v(this.T);this.K(!1);this.bb(!1);this.bc(!0);OwaApplication.a.a(this.c)}},Y:function(n){},cd:function(){this.J&&this.cs();this.dX("OnBack")},cs:function(){if(!$a(this.c)){this.c.K(this.bi);this.c.N(this.U);this.c.M(this.T)}this.A()&&this.bs(this.bh);this.K(!1);this.bb(!1);this.bc(!1)},e:function(n){this.G=this.h();this.bc(!1);this.K(!0);this.bb(!1);this.dX("GetActionSuccess")},cv:function(n){this.G=this.h();this.bc(!1);this.K(!1);this.bb(!0);this.dX("GetActionFailure")},g:function(n){this.bu(!1);this.bt();this.d.a()==="TouchNarrow"&&this.bq();this.dX("SetActionSuccess")},cB:function(n){this.bu(!1);var t=this;this.cJ(this.ca(),function(n,i){t.dX("SetActionFailure")})},cC:function(){this.bu(!1);this.dX("ValidationOnSaveFailed")},cJ:function(n,t){this.bp.a(0,n,t,!1,null,null,_nbs.a.Zi)},F:function(n){return n},cu:function(n){this.bt()},bE:function(){this.bj=new _y.f(_y.b.A(),_y.b.B(),_u.P.g,new _C(this.m,_d.x.a),null,_u.R.Ih).i();var n=[new _y.f(_y.b.n(),_y.b.o(),_u.P.L,new _C(this.z,_d.x.a),null,_u.R.Xz),this.bj];return _y.i.a(this,n,null)},W:function(){var n=new _ms.b;n.h(this.w);if(this.bJ.a()){n.e(2);n.f(new _ms.a(_fm.a.a,_fm.a.a,new _C(this.m,_d.x.a),_u.R.ZZ));n.g(new _ms.a(_fm.a.a,_fm.a.a,new _C(this.z,_d.x.a),_ops.b.BA));n.i.a(!0)}else{n.e(1);n.f(new _ms.a(_y.b.a(),_y.b.a(),new _C(this.m,_d.x.a),""));n.g(new _ms.a(_y.b.e(),_y.b.e(),new _C(this.z,_d.x.a),""))}return n},bD:function(){this.bY()?this.t.j():this.bq()},cI:function(){this.t.f();this.bH()},cq:function(){this.t.f();this.bq()},cp:function(){this.t.f()},bq:function(){this.A()&&this.bs(this.bh);this.cd();$a(this.V)||this.V()},ct:function(){this.I.a().b().Enabled||_d.x.b(this.dp,this.cb());this.J&&!this.I.a().b().Enabled&&this.bj.a().c(!0);this.dQ("BusyText");this.dQ("ShowActivityIndicator")}};_d.P=function(n,t,i){this.e=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.o);this.d=Function.createDelegate(this,this.m);_d.P.initializeBase(this);_a.b.a(t,"listViewItemsFactory");this.i=t;this.g=n;this.h=i};_d.P.prototype={c:null,b:null,g:null,i:null,h:!1,a:function(){return this.dS(_d.P.a)},j:function(n){this.dR(_d.P.a,n);return n},k:function(n,t){_a.b.b(n,"onSelectItemChangedHandler");this.bm(t?1:0);this.F(n);this.l()},p:function(){if(this.q.x.length>0&&!this.q.x[0].d){for(var n=0;n<this.q.x.length;n++){this.q.x[n].j(!0);this.q.x[n].c(!1);this.q.x[n].b(!1)}if(!$a(this.b)){this.b.K(this.d);this.b.N(this.f);this.b.M(this.e)}this.c=new _c.bI;this.b=new _c.bC(this.c);this.b.z(this.d);this.b.w(this.f);this.b.v(this.e);OwaApplication.a.a(this.b)}},cw:function(n){return null},m:function(n){for(var t=0;t<this.q.x.length;t++){var i=this.q.x[t];i.j(!1)}},o:function(n){for(var i=0;i<this.q.x.length;i++){var t=this.q.x[i];if(!$a(t.a().B())){var r=this.c.a[t.a().B()];t.a().r(r)}t.b(!1);t.c(!0)}},n:function(n){for(var i=0;i<this.q.x.length;i++){var t=this.q.x[i];t.b(!0);t.c(!1);t.a().Y(t)}},l:function(){for(var t=this.i.a(this.g),n=0;n<t.d.length;n++)this.q.a(t.d[n])}};_d.y=function(n,t){_d.y.initializeBase(this);_a.b.a(n,"text");_a.b.a(t,"optionPageCreator");this.i=n;this.h=t};_d.y.prototype={i:null,h:null,e:null,d:!1,g:!1,f:!1,a:function(){this.e||(this.e=this.h());return this.e},j:function(n){this.d=n;this.dQ("IsLoadingSummary");return n},c:function(n){this.g=n;this.dQ("IsSummaryLoadSucceeded");return n},b:function(n){this.f=n;this.dQ("IsSummaryLoadFailed");return n}};_d.cg=function(n,t,i){this.K=Function.createDelegate(this,this.B);_d.cg.initializeBase(this);this.z=n;this.A=i;this.a=new _d.P(this.z,t,this.L());this.a.k(this.K,!1)};_d.cg.prototype={a:null,z:null,A:null,j:function(){return 1},L:function(){return this.A.a().b().Enabled?!0:!1},cx:function(){_y.hJ.prototype.cx.call(this);this.a.A();this.a.p()}};_d.t=function(n,t,i,r,u,f){this.h=Function.createDelegate(this,this.R);this.r=Function.createDelegate(this,this.U);this.d=Function.createDelegate(this,this.x);this.C=Function.createDelegate(this,this.Q);this.D=Function.createDelegate(this,this.S);_d.t.initializeBase(this,[n,t,f]);this.y=u;this.G=f;this.c=i;this.g=r;this.e=!1;this.M();this.I().e(this.a)};_d.t.prototype={o:null,p:null,k:null,m:0,b:null,l:null,c:null,e:!1,g:null,G:null,y:null,H:function(){$a(this.k)&&(this.k=new _C(this.D,_d.t.a));return this.k},w:function(){this.p||(this.p=new _y.D);return this.p},I:function(){this.o||(this.o=new _y.D);return this.o},P:function(){return $a(this.a.a())?!1:this.a.a().a().bZ()},N:function(){return $a(this.a.a())?"":this.a.a().a().bX()},t:function(){return!this.c.b(this.c.a())||!this.c.a().a().e()},L:function(){return!0},cz:function(){_y.hJ.prototype.cz.call(this);if(this.g){this.g.b(!0);this.g.a(!0,null,null,null,null)}},cx:function(){_d.cg.prototype.cx.call(this);this.a.t(this.a.q.x[0])},bm:function(){return this.y.a()?1:4},q:function(){return this.C},n:function(){return this.l},f:function(n){this.l=n;return n},bn:function(){return!0},Q:function(n,t){_js.Trace.logInfo(_d.t.a,"HandlePopupPanelClosing with reason = {0}",t);if(!t){this.E();return!0}return!1},j:function(){return this.t()?_d.cg.prototype.j.call(this):0},B:function(n,t){_js.Trace.logInfo(_d.t.a,"OnSelectedOptionChanged {0}",t);var r=n;if(!$a(this.a.r())){this.b=r.r();this.m=0;if($a(this.a.a()))this.x();else if(this.a.a()!==this.a.r()){var i=this.a.a().a();this.F(i)}}},E:function(){_js.Trace.logInfo(_d.t.a,"CloseOptionPagePopup");this.m=1;this.b=this.a.r();var n=this.b.a();this.F(n)},M:function(){if(this.t()){this.ds(_y.i.a(this,null,null));this.dp.H(!0);this.dp.g(new _y.f(_y.b.d(),_y.b.d(),_u.P.L,this.H()),0)}},S:function(){this.e=!0;this.E()},F:function(n){if(n.bY()){_js.Trace.logInfo(_d.t.a,"Found the options vm dirty so saving before exit.");this.T()}else{_js.Trace.logInfo(_d.t.a,"Navigating away without saving.");this.x()}},T:function(){var n=this.a.a().a();n.bW(this.d);n.cn(this.d);n.co(this.r);n.b(!0)},U:function(){this.J(!1);this.a.t(this.a.a())},x:function(){_js.Trace.logInfo(_d.t.a,"NavigateAway");this.J(!0);this.a.j(this.b);switch(this.m){case 1:this.a.j(null);this.a.t(null);$a(this.b)&&this.b.a().bs(this.h);this.b=null;this.l();this.c.b(this.c.a())&&this.c.a().a().e()&&this.e&&this.c.a().K();this.e=!1;break;case 0:this.w().a()!==this.b.a()&&this.w().e(this.b.a());this.b.a().bV(this.h);this.b.a().x();break;default:break}},R:function(){_js.Trace.logInfo(_d.t.a,"OnBusy");this.dQ("BusyText");this.dQ("IsBusy")},J:function(n){if(!$a(this.a.a())){n&&this.a.a().a().cd();this.a.a().a().cG(this.d);this.a.a().a().cF(this.d);this.a.a().a().bs(this.h);this.a.a().a().cH(this.r)}}};_d.cf=function(n,t,i,r){this.b=Function.createDelegate(this,this.f);_d.cf.initializeBase(this,[n,t,i]);this.d=i;this.c=r;i&&i.a().b().Enabled?this.dy(this.e()):this.ds(_y.i.b(this))};_d.cf.prototype={c:null,d:null,f:function(){this.a.r().a().cE(this.b);this.a.t(null)},B:function(n,t){var r=n;if(r.r()){var u=r.r();var i=u.a();i.bU(this.b);i.cD();i.x()}},e:function(){var n=new _ms.b;n.h(_ops.b.TG);if(this.c.a()){n.e(2);n.k(2);n.g(new _ms.a(_fm.a.a,_fm.a.a,this.dz,_ops.b.BA));n.i.a(!0)}else{n.e(1);n.f(new _ms.a(_y.b.a(),_y.b.a(),this.dz,""))}return n}};_d.T=function(n,t,i,r,u){this.M=Function.createDelegate(this,this.S);this.C=-1;_d.T.initializeBase(this,[n,t,i,r,u]);this.l=new _c.dp;this.bd(this.l);this.bU(this.M);this.N=r;this.R=u};_d.T.a=function(n,t,i,r,u){_a.b.b(n,"owaShell");return new _d.T(n,t,i,r,u)};_d.T.prototype={R:null,a:null,p:null,E:!1,l:null,N:null,B:function(){return"TimeZone"},be:function(n){this.a=n;this.dQ("TimeZoneList");return n},P:function(n){this.D(this.a.k(n));if(this.p===n)return n;this.p=n;this.dQ("CurrentTimeZone");return n},D:function(n){this.C=n;this.dQ("CurrentTimeZoneIndex");return n},Q:function(n){this.E=n;this.dQ("TimeZoneReloaded");return n},k:function(){return new _c.bG(this.l)},o:function(){return new _c.bY(this.l,this.p.c)},h:function(){var n={};n.CurrentTimeZone=!0;return n},e:function(n){this.K(!0);if($a(this.a)||!this.a.x.length){for(var u=new _js.f,r=this.l.a,f=r.length,i=0;i<f;++i){var e=r[i];u.a(new _d.bv(e))}this.be(u)}for(var t=0;t<this.a.x.length;t++)if(this.a.x[t].c===this.l.b){this.P(this.a.x[t]);this.Q(!0)}_d.x.prototype.e.call(this,n)},g:function(n){this.r(this.p.d);_d.x.prototype.g.call(this,n);var t=new _y.cI(1);this.H.a(_y.cI,t)},S:function(){this.D(-1);this.Q(!1)}};_d.bv=function(n){_d.bv.initializeBase(this);_a.b.a(n,"TimeZoneEntry");this.d=n.Name;this.b=n.Name;var i=new RegExp(_d.bv.a,"g");var t=i.exec(n.Name);if(t&&t.length>0){this.a=t[0];this.b=n.Name.replace(this.a,"").trim();this.a.indexOf("GMT")!==-1&&(this.a=this.a.replace("GMT","UTC"))}this.c=n.Value};_d.bv.prototype={b:null,d:null,a:null,c:null};_d.bc=function(n,t,i,r,u){this.P=Function.createDelegate(this,this.by);_d.bc.initializeBase(this,[n,t,i,r,u]);this.a=new _g.io;this.bd(this.a);this.Q=r;this.bx=u};_d.bc.a=function(n,t,i,r,u){_a.b.b(n,"owaShell");return new _d.bc(n,t,i,r,u)};_d.bc.prototype={bx:null,p:!1,C:!1,l:null,D:null,a:null,N:0,E:null,Q:null,be:function(n){if(this.p===n)return n;this.p=n;this.dQ("IsSignatureOn");return n},bg:function(n){if(this.C===n)return n;this.C=n;this.dQ("UseDesktopSignature");return n},S:function(n){if(this.l===n)return n;this.l=n;this.dQ("EditorSignatureMessage");return n},bz:function(n){if(this.D===n)return n;this.D=n;this.dQ("EditorDesktopSignatureMessage");return n},bf:function(n){if(this.N===n)return n;this.N=n;this.bg(n===1?!0:!1);this.dQ("SelectedSignatureType");return n},B:function(){return"Signature"},M:function(){return _a.UserAgent.getInstance().c()},b:function(n){this.a.a(this.p);this.a.b(this.l);this.a.c(this.C);_d.x.prototype.b.call(this,n)},R:function(n){if(this.M()){var t=_a.bb.a();var i=t.b("MOWA.IsSignatureChanged")==="true"?!0:!1;var f=i?Boolean.parse(t.b("MOWA.AutoAddSignature")):!0;var u=i?t.b("MOWA.SignatureText"):_c.s.a(_a.UserAgent.getInstance());var r=i?Boolean.parse(t.b("MOWA.UseDesktopSignature")):!1;f?this.bw(r,u):this.L(_nbs.a.my)}else n.AutoAddSignature?this.bw(n.UseDesktopSignature,n.SignatureText):this.L(_nbs.a.my);return this.bv},Y:function(n){if(this.M()){this.R(null);n.b(!1);n.c(!0)}},k:function(){return this.M()?new _c.s(this.a):new _c.bz(this.a)},o:function(){return this.M()?new _c.bW(this.a):new _c.bV(this.a)},h:function(){var n={};n.IsSignatureOn=!0;n.UseDesktopSignature=!0;n.EditorSignatureMessage=!0;n.SelectedSignatureType=!0;return n},e:function(n){this.be(this.a.bl.AutoAddSignature);this.bg(this.a.bl.UseDesktopSignature);this.S(this.a.bl.SignatureText);this.bz(this.a.bl.DesktopSignatureText);this.bf(this.a.bl.UseDesktopSignature?1:2);_d.x.prototype.e.call(this,n)},g:function(n){this.L(this.p?this.C?this.D:this.l:_nbs.a.my);var t=_g.a.a().a();t.ce(this.C);t.bO(this.p);t.cc(this.l);_d.x.prototype.g.call(this,n)},F:function(n){var t=n;return this.R(t)},by:function(n){this.L(this.E.a.UserOptions.SignatureText)},bw:function(n,t){if(n){this.E=new _h.bQ;this.E.w(this.P);OwaApplication.a.a(this.E)}else this.L(t)}};_d.A=function(n,t,i,r,u,f,e,o){this.be=Function.createDelegate(this,this.ck);this.S=Function.createDelegate(this,this.cj);this.bf=Function.createDelegate(this,this.bx);_d.A.initializeBase(this,[n,t,i,r,u]);_a.b.a(n,"owaShell shouldn't be null");_a.b.a(i,"eventAggregator shouldn't be null");_a.b.a(f,"syncFoldersProcessorLazy shouldn't be null");_a.b.a(e,"conductor shouldn't be null");_a.b.a(o,"taskRunner shouldn't be null");this.bg=r;this.bz=u;this.Q=f;this.C=i;this.M=e;this.R=o;this.cl();this.ci()};_d.A.prototype={C:null,Q:null,M:null,R:null,bz:null,p:0,l:null,a:null,P:!1,D:!1,bg:null,N:function(n){if(this.P!==n){this.P=n;this.dQ("SettingChanged")}return n},by:function(n){if(n!==this.D){this.D=n;this.dQ("UserSelected")}return n},ch:function(){var n;switch(this.p){case 1:n=_nbs.a.TQ;break;case 2:n=_nbs.a.IH;break;case 3:n=_nbs.a.WR;break;case 4:n=_nbs.a.Io;break;case 5:n=_nbs.a.XF;break;default:throw Error.create("MaxSyncFolders can't be bigger than 5");}return String.format(_nbs.a.mo,n)},bK:function(){return this.a&&this.a.length>=1?this.a[0]:null},bL:function(){return this.a&&this.a.length>=2?this.a[1]:null},bM:function(){return this.a&&this.a.length>=3?this.a[2]:null},bN:function(){return this.a&&this.a.length>=4?this.a[3]:null},cg:function(){return this.a&&this.a.length>=5?this.a[4]:null},x:function(){this.E();_d.x.prototype.x.call(this)},b:function(n){_js.Trace.logInfo(_d.A.a,"Save isSavedFromDirty={0}",n);this.bx();_d.x.prototype.b.call(this,n)},E:function(){if(this.l){this.by(this.l.a());var n=0;if(this.l.a()){var u=this.l.c();var t=u.i();var r=0;if(t){r=t.length>this.p?this.p:t.length;for(;n<r;n++){var i=_h.a.a(new _g.n(t[n]));if(i){this.a[n].d(_g.q.b(i));this.a[n].c(t[n])}else{_js.Trace.logWarning(_d.A.a,"Can't find folder based on FolderId {0}",t[n]);this.a[n].d("");this.a[n].c("")}}}this.bw(n)}else this.bw(n)}},k:function(){return new _c.bi},o:function(){return new _c.bj(this.bf)},h:function(){var n={};n.SettingChanged=!0;n.UserSelected=!0;return n},ci:function(){var n=this;this.Q.a(function(t){n.l=t;n.bA();n.E()})},cl:function(){_h.h.a||_h.h.j(this.d.a());this.p=5>=_h.h.a?_h.h.a:5},bA:function(){_js.Trace.logInfo(_d.A.a,"Initialize folder controllers with maxSyncFolders={0}",this.p);this.a=new Array(0);for(var i=0;i<this.p;i++)Array.add(this.a,new _d.bW("","",new _d.C(this.C,this.R,this.d),this.d,this.S,this.M));for(var r=this.a,u=r.length,n=0;n<u;++n){var f=r[n];f.apcl("FolderId",this.be)}for(var t=1;t<=this.p;t++)this.dQ(String.format("FolderController{0}",t))},bw:function(n){for(;n<this.p;n++){this.a[n].d("");this.a[n].c("")}},ck:function(n,t){this.N(!1);this.N(!0);var f=n.b;if(f!=="")for(var e=0,u=this.a,s=u.length,i=0;i<s;++i){var r=u[i];f===r.b&&e++;if(e>1){var o=new _a.o([String.format(_nbs.a.Cw,r.e)],0,null,0,!1,_bcs.D.D,null,_nbs.a.VE);this.C.a(_a.o,o);r.g.a();this.N(!1);break}}},cj:function(n){_js.Trace.logInfo(_d.A.a,"IsFolderAllowedToSync");if(this.l.f(n))return!0;else{var t;t=_h.h.m(n)?_nbs.a.YJ:_nbs.a.Rl;var i=new _a.o([t],0,null,0,!1,_bcs.D.D,null,_nbs.a.Re);this.C.a(_a.o,i);return!1}},bx:function(){_js.Trace.logInfo(_d.A.a,"SaveOfflineFolders");if(this.l){this.l.g(this.D);if(this.l.a()){for(var i=this.l.c(),t=new Array(0),n=0;n<this.p;n++)_js.d.a(this.a[n].b)||Array.add(t,this.a[n].b);_js.Trace.logInfo(_d.A.a,"Setting MailFolderIds={0}",t);i.j(t)}}}};_d.bl=function(n,t,i,r,u){this.l=Function.createDelegate(this,this.p);_d.bl.initializeBase(this);this.a=n;this.h=t;this.g=r;this.i=i;u&&!$a(n.h())&&n.h().b()>0&&this.k(n.h().i(0).bl.Value)};_d.bl.prototype={i:null,g:null,a:null,h:null,c:!1,b:!1,e:null,m:"GroupCard",f:function(n){if(this.b!==n){this.b=n;this.dQ("IsNotesAvailable")}return n},j:function(n){if(this.c!==n){this.c=n;this.dQ("IsNotesLoaded")}return n},k:function(n){this.e=n;this.dQ("Notes");this.f(!_js.d.a(this.e));this.j(!0);return n},n:function(){var n;switch(this.i.a()){case"TouchNarrow":n=51200;break;case"TouchWide":case"Mouse":default:n=512e3;break}return n},d:function(n){if(this.a.f()&&this.a.f().Id&&(!this.c||n)){this.f(!1);this.j(!1);var t=_rpc.p.a(this.a.f().Id,this.n(),this.a.bc(),this.m);this.a.G()&&(t.J=this.a.t().a);t.z(this.l);t.c=this.h.a;this.g.a(t)}},p:function(n){var t=n;if(t.a&&t.a.h()&&t.a.h().b()>0){this.a.bh(t.a.h());this.k(t.a.h().i(0).bl.Value);this.o()}else this.a.h()&&this.a.h().b()?this.f(!0):this.f(!1);this.j(!0)},o:function(){for(var t=this.a.h().b(),n=0;n<t;n++)this.a.h().i(n).bl.IsTruncated&&_pc.b.f(_a.a.v,"TruncatedNotesShown","Contact #"+n)}};_d.cY=function(n){this.t=n};_d.cY.prototype={t:null,a:function(){return this.t.a()},f:function(){return""},b:function(){return this.t.b()},s:function(n){return n},l:function(){return null},m:function(){return!1},i:function(){return new Array(0)},e:function(n){return n},r:function(n){return n},d:function(){return!0},g:function(){return!0},c:function(n){return n},h:function(){return this.t.g()},k:function(){return this.t.m()},n:function(n){return n?this.a().cM():this.a().c()},p:function(n){},q:function(n){},o:function(n){},j:function(n){}};_d.bn=function(n){_d.bn.initializeBase(this,[n])};_d.bn.prototype={i:function(){return this.t.cc},e:function(n){this.t.cc=n;return n},r:function(n){this.t.cD=n;return n},s:function(n){this.t.dd(n);return n},c:function(n){this.t.be=n;return n}};_d.Z=function(n,t,i,r){this.a=n;this.d=t;this.b=i;this.c=r};_d.Z.prototype={d:null,a:null,b:null,c:null,e:function(n,t,i,r){return new _d.i(n,t,i,this.a,this.d,r,this.b,this.c)},f:function(n,t){return new _cpc.c(n,t,this.a,this.b)}};_d.i=function(n,t,i,r,u,f,e,o){this.bo=Function.createDelegate(this,this.bS);this.bw=Function.createDelegate(this,this.bR);this.bn=Function.createDelegate(this,this.bQ);this.bm=Function.createDelegate(this,this.bP);this.bl=Function.createDelegate(this,this.bE);_d.i.initializeBase(this);this.K=!0;this.J=!0;this.bh=f;this.N=r;this.bq=u;this.bg=o;this.bi=t;this.C=i;this.bc=n;this.D=this.bD(n,e);this.bf=n.b();this.H=!0;this.Y=!0;this.G=!0;this.F=!0;this.bY(_nbs.a.Ve);this.bX(_nbs.a.jp)};_d.i.prototype={bq:null,N:null,bg:null,bh:null,D:null,bf:0,bi:0,C:null,E:!1,K:!1,J:!1,Q:null,P:null,bd:0,be:null,U:null,R:null,Z:null,ba:null,I:!1,L:!1,bb:null,X:!1,V:!1,W:!1,H:!1,Y:!1,M:!1,F:!1,bj:!1,bc:null,T:null,S:null,bk:!1,bv:null,G:!1,bA:function(n){this.dV("PopoutClicked",n)},w:function(n){this.dV("PivotOptionClicked",n)},v:function(n){this.dV("EditClicked",n)},z:function(n){this.dW("EditClicked",n)},bB:function(n){this.dV("ToggleClicked",n)},bx:function(n){this.dV("AddMembersClicked",n)},bT:function(n){this.dW("AddMembersClicked",n)},by:function(n){this.dV("JoinClicked",n)},bU:function(n){this.dW("JoinClicked",n)},bz:function(n){this.dV("LeaveClicked",n)},bV:function(n){this.dW("LeaveClicked",n)},r:function(n){this.bc=n;this.D&&this.D.I(n);return n},bW:function(n){if(this.Q!==n){this.Q=n;this.dQ("ActivityStatusViewModel")}return n},t:function(n){if(this.bj!==n){this.bj=n;this.dQ("ShowExpandButton")}return n},bH:function(){return this.C.f||this.I||!this.C.a||this.C.a===9||this.C.a===1},i:function(n){if(this.X!==n){this.X=n;this.dQ("HideEditButton")}return n},ca:function(n){if(this.G!==n){this.G=n;this.dQ("HideAddMembersButton")}return n},br:function(){return!this.E&&this.C.h},bN:function(){return this.br()&&!this.bs()?"PersonaView.PresenceDisplayPictureTwoLinesDetailsConverged":"PersonaView.PresenceDisplayPictureThreeLinesDetails"},bX:function(n){if(this.S!==n){this.S=n;this.dQ("EditButtonText")}return n},bY:function(n){if(this.T!==n){this.T=n;this.dQ("EditButtonToolTip")}return n},x:function(){this.U||(this.U=new _C(this.bl,_d.i.a));return this.U},bF:function(){this.R||(this.R=new _C(this.bm,_d.i.a));return this.R},bp:null,A:function(n){this.bp=n;return n},bL:function(){this.Z||(this.Z=new _C(this.bn,_d.i.a));return this.Z},bu:function(){this.be||(this.be=new _C(this.bo,_d.i.a));return this.be},a:function(){return this.D?!!this.D.F():!1},j:function(){return this.D},bs:function(){return this.N.a()!=="Mouse"},bO:function(){return this.bf===4?_nbs.a.ga:_nbs.a.ao},d:function(){return this.ba},B:function(n){this.ba=n;this.dQ("MenuAddContactsViewModelPropertyName");return n},f:function(n){if(this.bb!==n){this.bb=n;this.dQ("MenuAffordanceViewModel")}return n},c:function(){return this.P},g:function(n){if(this.P!==n){this.P=n;this.dQ("PivotOptions")}return n},k:function(){return this.bd},b:function(n){this.bd=n;this.dQ("PivotSelectedOptionIndex");this.dZ("PivotOptionClicked",n);return n},l:function(n){if(this.I!==n){this.I=n;this.D&&this.D.Z(n);this.dU("IsCardLoading","HideManagementActions")}return n},bG:function(){return this.L||this.V},h:function(n){if(this.V!==n){this.V=n;this.dQ("HideAddContactsMenu")}return n},e:function(n){if(this.W!==n){this.W=n;this.dQ("HideAffordanceMenu")}return n},cb:function(n){if(this.H!==n){this.H=n;this.dQ("HideJoinButton")}return n},cc:function(n){if(this.Y!==n){this.Y=n;this.dQ("HideLeaveButton")}return n},bZ:function(n){if(this.F!==n){this.F=n;this.dQ("HideActivityStatusViewModel")}return n},n:function(n){if(this.K!==n){this.K=n;this.dZ("ToggleClicked",n);this.dU("IsExpanded","ShowPersonCardExpandToggleButton")}return n},bM:function(){return this.bs()?this.bt():this.C.h||this.J||!this.C.a},bK:function(){return!this.C.a&&!this.E},bJ:function(){return this.C.a===2&&!this.E},m:function(n){if(this.J!==n){this.J=n;this.dQ("IsExpandable")}return n},bt:function(){return this.E&&this.N.a()==="TouchWide"},bI:function(){return this.E&&this.N.a()==="Mouse"},o:function(n){this.E=n;this.eb("IsHoverCard","IsTouchWideHover","IsMouseHover");return n},p:function(n){if(this.L!==n){this.L=n;this.dQ("IsLoading")}return n},y:function(){return this.M},q:function(n){if(this.M!==n){this.M=n;this.dQ("ShowPopoutControl")}return n},cd:function(n){this.bk=n;this.dQ("ShowIndicator");return n},bD:function(n,t){if(this.C.a===9)return null;var r=this.bC(n);r&&this.C.c&&r.be(!0);var u=_pe.c.a;var i=this.bc.b();(i===4||i===5||i===2)&&(u=_pe.c.e);return t.c(n,u,!1,8,!0,r,!1,this.C.a)},bC:function(n){return this.bg.j(n,this.bi,this.bh,this.C)},bS:function(){this.dX("PopoutClicked")},bE:function(){this.dX("EditClicked")},bQ:function(){this.dX("JoinClicked")},bP:function(){this.dX("AddMembersClicked")},bR:function(){this.dX("LeaveClicked")}};_d.bb=function(n,t,i){this.f=Function.createDelegate(this,this.l);_d.bb.initializeBase(this);_a.b.b(n,"personaViewModelFactory");this.b=this.g(t,n);this.c=i;this.a=!1};_d.bb.prototype={c:null,b:null,d:null,a:!1,e:function(){return!!this.c&&_d.G.isInstanceOfType(this.c)&&this.c.bC()},h:function(){return this.e()?"ms-bg-color-neutralTertiaryAlt":""},i:function(){return this.e()?"ms-bg-color-themeTertiary":""},k:function(n){if(this.a!==n){this.a=n;this.dQ("IsDeleted")}return n},j:function(){this.d||(this.d=new _C(this.f,_a.a.cn));return this.d},l:function(){this.k(!this.a);this.c.d(this)},g:function(n,t){var i=t.a(n,_pe.c.a,!1,4);var r=[1];i.l(1,r,"");i.g(!0);return i}};_d.bp=function(n,t){this.b=n;this.d=t};_d.bp.prototype={b:null,d:null,c:null,a:function(n,t,i){return new _d.U(i,this.b,this.d,this.c,n,t)}};_d.bD=function(n,t,i,r){_d.bD.initializeBase(this,[n,0,t,4]);this.a=i;this.b=r};_d.bD.prototype={a:null,b:!1,d:function(){return this.b?60:50},bq:function(){return this},cB:function(n){return _pc.a.isInstanceOfType(n)?this.c(n):n},bp:function(n){return _d.bb.isInstanceOfType(n)?n.b.a():n},bR:function(n){var t=n;t&&t.dispose()},dm:function(n){var u=n;var r=u.b;var t=r.bD;var i=r.bJ;_js.d.a(i)||(t+=" "+i);return t},c:function(n){return new _d.bb(this.L,n,this.a)}};_d.bY=function(){};_d.bY.prototype={a:null,b:function(n,t,i){return new _d.bD(n,this.a,t,i)}};_d.bC=function(){};_d.bC.prototype={a:null,b:function(n){return new _d.H(n,this.a)}};_d.cJ=function(n,t){_d.cJ.initializeBase(this);this.a=n;this.c=t;this.e()};_d.cJ.prototype={d:null,b:null,a:null,c:null,h:function(n){if(this.d!==n){this.d=n;this.dQ("GroupNameField")}return n},i:function(n){if(this.b!==n){this.b=n;this.dQ("Notes")}return n},f:function(){return!!this.c&&this.c.a().d().Enabled},g:function(){return!!this.c&&this.c.a().j().Enabled},e:function(){this.h(null);this.i(null);if(this.a.b()){this.a.e(this.a.a().bu());this.j();this.k()}},l:function(){var n=[];n=_d.n.c(this.d,n,!1);n=_d.n.c(this.b,n,!1);return n},n:function(){this.m()},j:function(){var n;var i,t;var r=(t=_d.n.a(String,this.a.a().bF(),"",this.a,i={val:n}),n=i.val,t);n&&_js.d.a(n.a())&&n.f(this.a.a().c());$a(this.a.a().bF())&&this.a.a().cE(r);this.h(new _d.c(this.a,n,"PersonaDisplayNames",_nbs.a.ex,!0,!1,this.g(),this.f()))},k:function(){var t;var n=new _g.w;n.b("");n.c("Text");var r,i;var u=(i=_d.n.a(_g.w,this.a.a().h(),n,this.a,r={val:t}),t=r.val,i);$a(this.a.a().h())&&this.a.a().bh(u);this.i(new _d.c(this.a,t,"PersonaBodies",_nbs.a.Up,!0,!1,this.g(),this.f()))},m:function(){this.a.a().cE(_d.n.d(String,this.a.a().bF(),!0));this.a.a().bh(_d.n.d(_g.w,this.a.a().h(),!0))}};_d.cZ=function(n){this.E=Function.createDelegate(this,this.bt);this.C=Function.createDelegate(this,this.bs);_d.cZ.initializeBase(this);this.f=n;this.o=this.f.h().a()==="TouchNarrow"&&!this.f.d()};_d.cZ.prototype={f:null,o:!1,cw:function(n){throw Error.notImplemented();},bs:function(n){var t=n.d.a();this.f.q(t)},bt:function(n){var t=n.d.a();if(!_js.d.b(t)){var i=t.trimStart().toLowerCase();i.startsWith("http://")||i.startsWith("https://")||(t="http://"+t);this.f.p(t)}}};_d.cB=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.bO=Function.createDelegate(this,this.cd);this.bN=Function.createDelegate(this,this.cc);this.bL=Function.createDelegate(this,this.ca);this.bM=Function.createDelegate(this,this.cb);this.bK=Function.createDelegate(this,this.bY);this.bJ=Function.createDelegate(this,this.bX);_d.cB.initializeBase(this);this.bs=t;this.bI=r;this.bF=u;this.bC=f;this.bD=e;this.bG=o;this.bv=c;this.bz=s;this.bH=h;this.bq=l;this.bB=a;this.bk=this.bs.a()==="Mouse";this.bT(n);if(this.bs.a()==="Mouse"){var v=this;i.a(function(n){v.bj=n.a();v.bW()})}};_d.cB.prototype={bG:null,bC:null,bz:null,bD:null,bF:null,bs:null,bI:null,bH:0,bq:null,bk:!1,bj:null,by:null,bx:null,bA:!1,bv:null,bw:null,bu:null,bt:!1,bi:null,bn:null,bo:null,bm:null,bl:null,br:null,bp:null,bB:null,I:function(){return this.bq.b&&this.bq.i},H:function(){return this.bB.f()},J:function(){return this.bB.e()},g:function(n){this.dV("ActionClicked",n)},bh:function(n){this.by=n;return n},bg:function(n){this.bx=n;return n},bf:function(n){if(this.bA!==n){this.bA=n;this.dQ("HidePersonaActions")}return n},C:function(){return this.bA?!0:this.bt},be:function(n){if(this.bt!==n){this.bt=n;this.bV();this.dQ("HidePersonaActions")}return n},bT:function(n){this.bi=n;this.bV();return n},bP:function(){return this.bn?this.bn.b:null},bQ:function(){return this.bo?this.bo.b:null},b:function(){return this.bn?this.bn.d:null},d:function(){return this.br?this.br.d:null},n:function(){return null},bc:function(){return null},L:function(){return this.bm?this.bm.d:null},c:function(){return this.bo?this.bo.d:null},W:function(){return this.bl?this.bl.d:null},i:function(){return this.bp?this.bp.d:null},v:function(){return this.bn.c},D:function(){return this.br.c},m:function(){return null},Z:function(){return null},M:function(){return this.bm.c},w:function(){return this.bo.c},X:function(){return this.bl.c},B:function(){return!this.bi.d()||!this.bi.d().length||!this.bP()||!this.bP().length},S:function(){return!!this.bx||this.B()||!this.bI.bl.Calendar||!this.bQ()||!this.bQ().length},A:function(){return!this.bp||!this.bp.b||!this.bp.b.length},N:function(){return this.bs.a()!=="TouchNarrow"||!this.bm||!this.bm.b||!this.bm.b.length},Y:function(){return _a.UserAgent.getInstance().H.c().a===2||this.bi.b()!==1||this.N()||!this.bl||!this.bl.b||!this.bl.b.length},f:function(){return this.by?!1:this.bR()?!0:!this.bi.K()||!this.bi.K().b()?!0:!this.bj||!this.bj.b()||!this.bj.a()||!this.bj.a().b()||!this.bj.a().a(this.bi.g())},o:function(){return!0},bd:function(){return!0},q:function(){return _d.g.v()},r:function(){return _d.g.x()},t:function(){return _d.g.y()},p:function(){return _d.g.w()},bb:function(){return _d.g.A()},ba:function(){return _d.g.z()},Q:function(){return this.bk?_d.g.p():_d.g.d()},R:function(){return this.bk?_d.g.c():_d.g.q()},P:function(){return this.bk?_d.g.c():_d.g.d()},U:function(){return this.bk?_d.g.t():_d.g.h()},V:function(){return this.bk?_d.g.g():_d.g.u()},T:function(){return this.bk?_d.g.g():_d.g.h()},y:function(){return this.bk?_d.g.n():_d.g.b()},z:function(){return this.bk?_d.g.a():_d.g.o()},x:function(){return this.bk?_d.g.a():_d.g.b()},F:function(){return this.bk?_d.g.r():_d.g.f()},G:function(){return this.bk?_d.g.e():_d.g.s()},E:function(){return this.bk?_d.g.e():_d.g.f()},bZ:function(){this.bw||(this.bw=this.bi.bJ());return this.bw},K:function(){return this.bs.a()==="TouchNarrow"&&!this.B()&&!this.S()&&!this.N()&&!this.Y()&&!this.A()},l:function(n){this.bT(n)},h:function(n){this.bE();if(!$a(this.bx)){this.bx(n.EmailAddress);return}var t=this.bG.a(!1,!0);t.o(0);t.e(0);t.r(new _js.f);this.bU(n);t.h().a(n);this.bv||(this.bv=new _y.bf);this.bv.a(t)},bY:function(n){this.bE();var u=_a.d.b(_a.a.b,"CreateItemFromPersonaCard");_pc.b.a(1,this.bq.a,this.bi.b());var t=new _bc.p;t.b(_a.v.d(_a.c.a()));t.c(36e5);t.e(!0);t.i("Busy");this.bU(n);var i=new _js.f;var r=_g.t.a(n);i.a(r);t.h(i);var f=this;this.bD.a(function(n){var i=n.c(t);n.e(null,null,_bc.c.b(),i,!1);_a.d.a(u)})},j:function(n){this.bE();if(!$a(this.by)){this.by(n);return}if(this.bj){var t=this;this.bj.c(function(){if(t.bj.b()){var i=t.bj.d().a(t.bi,n);t.bC.a(i)}})}},k:function(n){var t=_js.d.b(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.bz.a(String.format("tel:{0}",encodeURIComponent(t)),null,null)},e:function(n,t){this.dQ("IMNotAvailable")},bV:function(){if(!this.bH){if(this.bt){this.bn&&this.bn.a();this.bo&&this.bo.a();this.br&&this.br.a();this.bm&&this.bm.a();this.bl&&this.bl.a();this.bp&&this.bp.a();return}this.bn||(this.bn=new(_d.ck.$$(_g.d))(this.bJ));this.bo||(this.bo=new(_d.ck.$$(_g.d))(this.bK));this.br||(this.br=new(_d.ck.$$(String))(this.bM));if(this.bi.d()&&this.bi.d().length>0){var i=_d.ci.$$(_g.d).b(this.bi);this.bn.f(i);this.bo.f(i)}else{this.bn.a();this.bo.a()}this.bW();if(this.bi.bo()){this.bp||(this.bp=new(_d.ck.$$(_g.y))(this.bL));if(this.bi.b()===4||this.bi.b()===3||this.bi.b()===1){var t=[new(_d.ci.$$(_g.y))(this.bZ().x[0],"")];t&&t.length>0&&this.bp.f(t)}else this.bp.a();this.dU("DirectionsActionCommand","DirectionsNotAvailable")}if(this.bs.a()==="TouchNarrow"){this.bm||(this.bm=new(_d.ck.$$(_g.k))(this.bN));this.bl||(this.bl=new(_d.ck.$$(_g.k))(this.bO));var n=_d.ci.$$(_g.k).d(this.bi);if(n&&n.length>0){this.bm.f(n);this.bi.b()!==4?this.bl.f(n):this.bl.a()}else{this.bm.a();this.bl.a()}this.dY(["SendSmsActionCommand","PhoneCallActionCommand","SendSmsActionMenuViewModel","PhoneCallActionMenuViewModel","PhonesNotAvailable","SmsNotAvailable","IsFiveIconsOnTnarrow"])}}},bW:function(){var t=this.bj&&this.bj.a()&&!_js.d.b(this.bj.a().c())?this.bj.a().c().trim().toLowerCase():"";var n=_d.ci.$$(String).c(this.bi,t);if(n&&n.length>0){var i=this;this.br.f(n,function(n,t,i){return new _pe.n(n,t,i)})}else this.br.a();this.dY(["IMActionCommand","IMActionMenuViewModel","IMNotAvailable"])},ca:function(n){if(this.bi.b()===4||this.bi.b()===3||this.bi.b()===1){var i=this;this.bS(function(n){n.a()},this.bw.x[0])}else{var t=this;this.bS(function(n){n.a()},n)}_pc.b.a(5,this.bq.a,this.bi.b())},bS:function(n,t){if(this.bu)n(this.bu);else{var i=this;this.bF.a(function(r){i.bu=r.a(t,!0);i.dQ("LocationMapViewModel");n(i.bu)})}},bR:function(){return this.bs.a()!=="Mouse"},bX:function(n){this.h(n);_pc.b.a(0,this.bq.a,this.bi.b())},cc:function(n){this.k(n);_pc.b.a(3,this.bq.a,this.bi.b())},cb:function(n){this.j(n);_pc.b.a(2,this.bq.a,this.bi.b())},cd:function(n){var t=_js.d.b(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.bz.a(String.format("sms:{0}",encodeURIComponent(t)),null,null);_pc.b.a(4,this.bq.a,this.bi.b())},bU:function(n){this.bi.b()===2&&n.MailboxType==="Mailbox"&&(n.MailboxType="PublicDL");this.bi.g()&&(n.SipUri=this.bi.g())},bE:function(){this.bR()||this.dX("ActionClicked")}};_d.bm=function(n,t,i,r,u,f,e,o,s){this.g=n;this.a=t;this.b=i;this.e=r;this.c=u;this.f=f;this.h=e;this.d=o;this.i=s};_d.bm.prototype={d:null,g:null,a:null,b:null,e:null,c:null,h:null,f:null,i:null,j:function(n,t,i,r){return new _d.cB(n,this.g,this.b,this.h,this.e,this.a,this.c,this.f,this.d,t,i,r,this.i)}};_d.cM=function(n,t,i,r,u){_d.cM.initializeBase(this,[n,i,r,u]);this.f=t};_d.cM.prototype={f:null,bM:!1,bp:!1,E:!1,L:!1,C:!1,bL:null,bK:null,bJ:null,bS:function(){this.n.f();this.o.f();var f=this.d.a()==="TouchNarrow";var n=new _ph.K;n.g=_h.a.b("msgfolderroot");for(var r=null,u=new _ph.d(this.d,this.f,null,n,_nbs.a.XM,f,!0,!1,null,!1,null),i=null,e=new _ph.d(this.d,this.f,null,n,_nbs.a.Ex,!0,!0,!1,null,!1,null),o=0;o<this.q.x.length;o++){var t=this.q.x[o];if(t.a===1){r=new _ph.d(this.d,this.f,t,n,null,f,!0,!1,null,!1,null);this.n.a(t);continue}if(t.a>=1e3)if(t.a===1e3){i||(i=new _ph.d(this.d,this.f,null,n,_nbs.a.Xn,!0,!0,!1,null,!1,null));this.cB()&&i.c.a(new _ph.d(this.d,this.f,t,n,null,!0,!0,!1,null,!1,null))}else this.dw(t,n,this.d)&&e.c.a(new _ph.d(this.d,this.f,t,n,null,!0,!0,!1,null,!1,null));else if(t.d()){r.c.a(new _ph.d(this.d,this.f,t,n,null,f,!0,!1,null,!1,null));this.n.a(t)}else{u.c.a(new _ph.d(this.d,this.f,t,n,null,f,!0,!1,null,!1,null));this.o.a(t)}}if(!$a(r)&&!this.bp){n.j(r);n.d.a(r);r.g(!1);r.d(!0);n.k(u);r.c.a(u);r.c.d(this.bN);u.c.d(this.bO);u.g(!0)}if(!$a(i)&&!this.bM){n.d.a(i);if(this.cB()){i.c.a(e);e.g(!0)}else{this.bL&&i.c.a(this.bL);this.bJ&&i.c.a(this.bJ);this.bK&&i.c.a(this.bK)}this.dv(i)}this.ca(n);this.di(!this.o.x.length)},cB:function(){return!(this.E||this.L||this.C)},dw:function(n,t,i){if((this.E||this.C)&&n.b.h===1002){this.bL=new _ph.d(i,this.f,n,t,null,!0,!0,!1,null,!1,null);return!1}if(this.E&&!this.C&&n.b.h===1004){this.bJ=new _ph.d(i,this.f,n,t,null,!0,!0,!1,null,!1,null);return!1}if((this.L||this.C)&&n.b.h===1003){this.bK=new _ph.d(i,this.f,n,t,null,!0,!0,!1,null,!1,null);return!1}return this.E||this.L||this.C?!1:!0},dv:function(n){this.bp&&n.l&&this.t(n.c.x[0].b)}};_d.bq=function(n,t,i){this.b=n;this.a=t;this.d=i};_d.bq.prototype={b:null,a:null,c:null,d:null,e:function(n,t,i,r){return new _d.be(this.b,this.c,n,t,i,r,this.a,this.d)}};_d.cb=function(n,t,i,r){this.d=n;this.c=t;this.b=i;this.e=r};_d.cb.prototype={d:null,c:null,b:null,e:null,a:function(n){return new _d.W(this.d,this.c,n,this.b,this.e)}};_d.Y=function(n,t,i,r){this.N=Function.createDelegate(this,this.T);this.x=-1;_d.Y.initializeBase(this);this.P=n;this.w=new _js.f;this.L=t;this.D=i.a().k().Enabled;this.H=r;this.G=2};_d.Y.prototype={P:null,H:null,w:null,L:null,A:null,I:!1,J:!1,z:!1,E:!1,R:0,K:null,y:null,B:null,C:null,D:!1,G:0,t:function(){if(this.D){for(var n=0;n<this.w.x.length;n++)if(this.w.x[n].t())return!0;return!1}return!!this.y&&this.y.t()},k:function(){return this.J},M:function(n){if(this.J!==n){this.J=n;this.bj("IsSuggestionPopulationInProgress");this.Q(!n)}return n},g:function(){return this.z},F:function(n){if(this.z!==n){this.z=n;this.bj("IsModuleLinkSelected")}return n},j:function(){return this.E},Q:function(n){if(this.E!==n){this.E=n;this.bj("IsPeopleModuleSuggestionVisible");if(this.z&&!n){this.F(!1);this.d(-1)}}return n},a:function(){return this.x},d:function(n){if(this.x!==n){this.x=n;this.bj("ItemHighlightedIndex");if(this.x>=0&&this.x<this.w.x.length){this.y=this.w.x[this.x];this.D||this.y.f(!0)}}return n},b:function(){return this.w},n:function(n){return n},v:function(){return this.B},o:function(n){this.B=n;return n},c:function(){return this.C},e:function(n){if(this.C!==n){var t=null;n&&(t=_a.d.b(_d.Y.a,"SelectContactFromSuggestion"));this.C=n;this.bj("SelectedItem");this.S();_a.d.a(t)}return n},h:function(){return this.K},i:function(n){if(this.K!==n){this.K=n;this.S()}return n},r:function(n){this.G=n;return n},s:function(){this.y=null;this.A=null;this.w.f();this.d(-1);this.M(!1);this.Q(!1);this.F(!1);this.I=!1},f:function(){if(!_js.d.a(this.B)&&this.I)if(this.B.trim().length>=4&&this.w.x.length<5){var n=_a.d.b(_d.Y.a,"SearchPeopleSuggestionsOnServer");this.A=_fp.a.d(this.B,_g.q.a("directory"),null,_fp.a.c(0,5),null,null,_fp.a.a,null,4,!1,!1);this.A.S=n;this.A.z(this.N);OwaApplication.a.a(this.A)}else this.M(!1)},l:function(n){this.y&&this.y.f(!1);var t=1;(n||this.E)&&(t=0);this.z&&this.F(!1);this.x<this.w.x.length-t&&this.d(this.x+1);this.x===this.w.x.length&&this.E&&this.F(!0);return this.x<this.w.x.length||this.z},m:function(n){this.y&&this.y.f(!1);var t=n?1:0;this.z&&this.F(!1);this.x>=t&&this.d(this.x-1);return this.x>=0},p:function(){var i=_a.d.b(_d.Y.a,"ShowPeopleSuggestions");var t=this.B.trim().length;this.w.f();this.d(-1);if(this.P.a()==="Mouse"){this.I=!0;var u=[1];var r=_fp.c.d(this.B,5,0,null);var n=this;Array.forEach(r,function(t){var i=n.L.e(t,_pe.c.a,!1,n.G);i.l(1,u,"");i.b(!n.D);i.cg(n.H.a(i));i.bE.a(1);n.w.a(i)});this.w.x.length<5&&t>=this.R&&t>=4?this.M(!0):this.Q(!0)}_a.d.a(i)},q:function(){for(var n=0;n<this.w.x.length;n++)this.w.x[n].t()&&this.w.x[n].f(!1)},T:function(n){n.K(this.N);var i=n.S;i&&(i.j=_js.d.c("sq:{0}",this.A===n));if(this.A!==n){_a.d.a(i);return}if(this.w.x.length<5&&$a(n.t)){for(var o=n.a(),h=[1],s=this.w.x.length,u=0;u<o.x.length&&this.w.x.length<5;u++){for(var e=o.x[u],f=!0,r=0;r<s;r++)if(_pc.a.g(e,this.w.x[r].bA)){f=!1;break}if(f){var t=this.L.e(e,_pe.c.a,!1,this.G);t.l(1,h,"");this.D||t.b(!0);t.cg(this.H.a(t));t.bE.a(1);this.w.a(t)}}this.z&&this.d(this.w.x.length)}else n.t&&(i.k=n.D());this.M(!1);_a.d.a(i)},S:function(){for(var n=0;n<this.w.x.length&&this.C;n++)if(this.C===this.w.x[n]){this.F(!1);this.y=this.C;this.d(n);break}}};_d.h=function(n,t,i,r){this.E=Function.createDelegate(this,this.M);_d.h.initializeBase(this);this.g=i;this.g&&(this.o=r);this.e=-1;this.b=n;this.bq(t);this.d=!1};_d.h.c=function(n,t,i){var f="";if(i.length)if(n&&n.b()){for(var h={},v=n.b(),c=0;c<v;c++){var s=n.c(c);if(s.b())for(var a=s.b().length,e=0;e<a;e++){var u=t.s(s.b()[e]);!u||!u.g()||u.a()in h||(h[u.a()]=1)}else return""}for(var y=i.length,o=0;o<y;o++){var l=i[o].a();if(!(l in h)){f=l;break}}}else f=i[0].a();else{t.e()||t.cC(new _js.f);var r=new _bc.d;r.n(!0);r.k("Outlook");r.h(t.e().b().toString());r.m(!1);f=r.a();t.e().a(r)}return f};_d.h.a=function(n,t,i){var u=i.i().length;var f=_d.h.c(t,i.a(),i.i());if(!u){var r=i.a().e().c(0);i.r(r.a());i.e([r])}return f};_d.h.prototype={b:null,d:!1,e:0,m:null,n:null,j:null,h:null,k:null,K:function(){return this.d&&this.q.x.length>0},f:function(){this.j||(this.j=new _fm.f(this.a()));return this.j},J:function(){if(this.y()){var n=this.q.x[0];return n.X()}return null},y:function(){if(this.b.b())return!0;if(this.q.x.length!==1||this.b.d()&&this.b.k().k)return!1;var n=this.q.x[0];return n.G()},g:!1,o:!1,a:function(){this.h||(this.h=[]);return this.h},x:function(n){this.h=n;this.p();return n},c:function(){this.m||(this.m={});return this.m},i:function(){this.n||(this.n={});return this.n},L:function(){var n=this.w;this.d&&(n+=_nbs.a.JE);n+=".";return n},l:function(n,t,i){if(this.b.b()){_a.b.j(t,"profileFields");var s=!1;var r=this;var h=new(_d.h.d.$$(n))(this.b,i,t,function(n,t,u){var h=r.b.b()===2||r.b.b()===3;r.b.b()===1&&r.d&&(h=!0);var f=new _d.c(r.b,t,n.a,n.f,h,!1,r.g,r.o);var c=r.b.b()===1;var e;e=r.g?"PersonaYomiCompanyNames":"PersonaAssistantNames";f.bd(!(c&&n.a===e));var o=n.a==="PersonaYomiLastNames"||n.a==="PersonaYomiFirstNames";o||r.d&&n.a!=="PersonaTitles"||f.K(!0);if(o&&!s){f.K(!0);s=!0}i===_nbs.a.ez&&r.b.b()===2&&f.K(!1);r.q.a(f);if(!u.e()){r.N(u.d);r.p()}});if(h.e()){var u=this.a().length;var o=this;var e=new _fm.d(i,null,new _C(function(){h.f();o.k&&o.k()},_d.h.b));if(this.w===_nbs.a.GZ&&i!==_nbs.a.dc&&i!==_nbs.a.FS&&i!==_nbs.a.RX){var f=null;if(this.e===-1){var c=[];f=new _fm.k(_nbs.a.OX,null,new _fm.f(c));this.a()[u]=f;this.e=u;this.c()[_nbs.a.OX]=u}else f=this.a()[this.e];this.i()[i]=f.h.h.x.length;f.h.h.a(e)}else{this.a()[u]=e;this.c()[i]=u}this.p()}}},C:function(){this.dU("IsClickable","ClickCommand")},H:function(){this.a().length>0&&this.a()[0].i.a()},cw:function(n){throw Error.notImplemented();},M:function(){var i=this;var u=function(n){i.f().j(!1);i.f().h.f();n&&n.a();i.dQ("CanDisplayAddFieldMenu")};var t=this;var n=function(n){t.g&&t.a()[0].j!==_nbs.a.by?t.k=function(){u(null)}:u(n)};if(this.a().length>0)if(this.w===_nbs.a.GZ)if(this.a().length===1)if(this.a()[0].j===_nbs.a.OX){var r=this.a()[0];if(r.h.h.x.length===1){n(r.h.h.x[0].i);n=null}else this.f().j(!0)}else{n(this.a()[0].i);n=null}else this.f().j(!0);else if(this.a().length===1){n(this.a()[0].i);n=null}else this.f().j(!0)},p:function(){this.f().h.f();this.f().h.p(this.a())},P:function(n){var i=-1;var t=null;if(n in this.c()||n in this.i())if(n===_nbs.a.dc||n===_nbs.a.FS||n===_nbs.a.RX){i=this.c()[n];--this.e;this.x(this.v(this.a(),i,this.c()))}else{t=this.a()[this.e];i=this.i()[n];t.h.h.n(i);for(var f=0,e=t.h.h.x.length,r=0;r<e;r++){var u=t.h.h.x[r];u.j in this.i()&&(this.i()[u.j]=f);f++}t.h.h.x.length||this.x(this.v(this.a(),this.e,this.c()))}},v:function(n,t,i){for(var e=[],u=0,o=n.length,r=0;r<o;r++)if(n[r]&&r!==t){var f=n[r];f.j in i&&(i[f.j]=u);e[u]=f;u++}return e},N:function(n){if(this.w===_nbs.a.GZ){this.P(n);return}var t=-1;if(n in this.c()){t=this.c()[n];this.x(this.v(this.a(),t,this.c()))}}};_d.h.d=function(n,t,i,r){this.b=n;this.d=t;this.a=i;this.c=r};_d.h.d.$$=function(n){var t="d"+"$"+n.getName().replace(/\./g,"_");if(!_d.h[t]){var r=_d.h[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.h.d.apply(this,t)};r.registerClass("_d.h."+t);var e={"_d.h.d":{T:n}};r.prototype.$$gta=e;var f=_d.h.d.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d.h[t]};_d.h.d.prototype={b:null,a:null,c:null,d:null,e:function(){for(var i=this.a.length,n=0;n<i;n++){var t=_d.h.a(this.$$gta["_d.h.d"].T,this.a[n].b(),this.b);if(!_js.d.a(t))return!0}return!1},f:function(){var i=null;var r=!1;var t=0;var e=this.a.length;for(t=0;t<e;t++){var n=this.a[t];r||n.a!=="PersonaTitles"||(r=!0);var u=_d.h.a(this.$$gta["_d.h.d"].T,n.b(),this.b);if(!_js.d.a(u)){this.b.s(!1);if(!n.b()){var f=n.j(this.b.a());n.h(f)}i=n.i(n.k(),[u]);if(i)this.c(this.a[t],i,this);else throw Error.invalidOperation("Trying to add field when no new field can be added");if(!(r||n.a==="PersonaYomiLastNames"||n.a==="PersonaYomiFirstNames"))break}}}};_d.n=function(){this.M=Function.createDelegate(this,this.bP);this.L=Function.createDelegate(this,this.bN);this.$$d_onFilterEnterKeyCommand=Function.createDelegate(this,this.onFilterEnterKeyCommand);_d.n.resolveInheritance();this.a=this.dx;_d.n.initializeBase(this,[personaCard]);this.g=isConvergedView;this.g&&(this.h=isConsumerUser);this.bi=fieldsListPosition;this.b()};_d.n.c=function(n,t,i){if(!n)return t;var r=n.bg(i);r&&(t=t.concat.apply(t,r));return t};_d.n.a=function(n,t,i,r,u){if($a(i))throw Error.argumentNull("defaultValue");if(!r.a().cL(t,u)){var f=_d.h.a(n,t,r);t||(t=new(_bc.S.$$(n)));t.g(i,f);u.val=t.c(0)}return t};_d.n.d=function(n,t,i){if(!t)return null;for(var u=new(_bc.S.$$(n)),e=t.b(),f=0;f<e;++f){var r=t.c(f);_d.c.a(r.a())||(i?u.k(r.a(),r.b()):u.j(r.a(),r.b()))}return u.b()?u:null};_d.n.e=function(n,t){if(!t)return!1;var r=t.length;if(!r)return!1;for(var u=new(_bc.S.$$(n)),i=0;i<r;i++)u.n(t[i].b());return _d.n.b(u)};_d.n.b=function(n){if(!n)return!1;for(var f={},e=n.b(),t=0;t<e;t++)for(var u=n.c(t).b(),s=u.length,i=0;i<s;i++)f[u[i]]=!0;for(var h=_ff.m.a(f),r=0;r<e;r++){var o=n.c(r);if(o.b().length!==h)return!0}return!1};_d.n.prototype={bi:0,i:null,v:null,K:null,m:null,y:null,p:null,c:function(){return this.m},e:function(){return this.y},d:function(){return this.p},g:!1,h:!1,b:function(){this.q.f();this.i=[];this.f.b()&&this.f.e(this.f.a().bu());switch(this.bi){case 0:this.bb();this.R();this.be();this.Z();break;case 1:_g.a.a().c().bl.UserCulture==="ja-JP"&&this.bK();this.bg();this.br(this.f.a().n());this.bh();this.bf();this.bd();this.ba();break;case 2:this.f.b()?this.bx():this.bc();break;case 3:this.bb();this.bv();this.R();this.be();this.h||this.Z();this.bg();this.br(this.f.a().n());this.h?this.bJ():this.bh();this.bf();this.bd();this.ba();break}this.q.p(this.i)},cB:function(n){return n},bp:function(n){return n},bR:function(n){var t=n;t&&t.dispose()},dm:function(n){for(var i=n,r=i.L(),t=0;t<i.q.x.length;t++){var u=i.q.x[t];r+=u.bq()}return r},bB:function(n,t){if(!n.d||!n.d.a())return!1;if(_g.o.a(n.d.a())){t?n.J(this.L):n.q(this.L);return!0}if(_g.dr.a(n.d.a())&&this.o){t?n.J(this.C):n.q(this.C);return!0}if(n.g==="PersonaPersonalHomePages"||n.g==="PersonaBusinessHomePages"){var r=n.d.b()[0];var i=this.f.a().s(r);n.M&&r!==_pecs.d.a&&i.b()!=="Facebook"&&i.b()!=="LinkedIn"||(t?n.J(this.E):n.q(this.E));return!0}n.g==="PersonaImAddresses"&&(t?n.J(this.M):this.f.g()||t||n.q(this.M));return!1},H:function(n,t,i,r,u,f,e){return this.N(t,i,r,u,f,e,!1)},N:function(n,t,i,r,u,f,e){if(!r)return!1;var v=r.b();if(!v)return!1;var p=!this.f.b()&&(u||!f);var s=!1;var a=!n;var h=null;var y="";if(!a){h=new Array(0);y=t}for(var c=0;c<v;++c){var l=r.c(c);if(this.f.a().cK(l)){var o=new _d.c(this.f,l,i,y,p,e,this.g,this.h);this.f.b()!==3||i!=="PersonaEmails1"||_js.d.a(o.j.EmailAddress)||(o.R=!0);if(_g.p.isInstanceOfType(l.a())){if(_js.d.b(o.l)&&_js.d.b(o.m)&&_js.d.b(o.n))continue}else if(_js.d.b(o.e))continue;s=this.f.d()?!1:this.bB(o,!1);if(a){n=new _d.h(this.f,t,this.g,this.h);n.d=o.Z();n.q.a(o);this.i[this.i.length]=n;s&&n.C()}else Array.add(h,o);this.bQ(i,o)}}if(!a&&h.length>0){n.q.p(h);s&&n.C()}return!0},bQ:function(n,t){switch(n){case"PersonaGivenNames":this.m=this.m||t;break;case"PersonaMiddleNames":this.y=this.y||t;break;case"PersonaSurnames":this.p=this.p||t;break}},j:function(n,t,i,r,u){for(var o=!1,h=_d.n.e(n,i),s=i.length,e=0;e<s;e++){var f=i[e];o=this.H(n,t,f.f,f.a,f.b(),u,h)||o}this.f.b()&&t&&t.l(n,i,r);return o},bb:function(){if(this.f.b()){var n=this.f.a();var r;var o,s;var a=(s=_d.n.a(String,n.I(),"",this.f,o={val:r}),r=o.val,s);n.I()||n.by(a);this.m=new _d.c(this.f,r,"PersonaGivenNames",this.g?_nbs.a.dA:_nbs.a.Kv,!0,!1,this.g,this.h);this.m.K(!0);if(!this.g){var t;var h,u;var l=(u=_d.n.a(String,n.w(),"",this.f,h={val:t}),t=h.val,u);n.w()||n.bA(l);this.y=new _d.c(this.f,t,"PersonaMiddleNames",_nbs.a.ih,!0,!1,this.g,this.h)}var i;var e,f;var c=(f=_d.n.a(String,n.F(),"",this.f,e={val:i}),i=e.val,f);n.F()||n.bC(c);this.p=new _d.c(this.f,i,"PersonaSurnames",this.g?_nbs.a.Tc:_nbs.a.DH,!0,!1,this.g,this.h);this.g||this.eb("FirstName","MiddleName","LastName")}},k:function(n,t,i,r,u){u||(u=t);this.j(String,n,[new _d.u(t,i,r)],u,!1)},bK:function(){var n=null;if(this.f.b()){n=new _d.h(this.f,_nbs.a.ja,this.g,this.h);this.i[this.i.length]=n}var t=this.f.a();this.j(String,n,[new _d.u(_nbs.a.Sj,"PersonaYomiCompanyNames",t.r())],_nbs.a.Sj,!1);this.j(String,n,[new _d.u(_nbs.a.DH,"PersonaYomiLastNames",t.ba())],_nbs.a.DH,!1);this.j(String,n,[new _d.u(_nbs.a.Kv,"PersonaYomiFirstNames",t.Z())],_nbs.a.Kv,!1)},bv:function(){var n=new _d.h(this.f,_nbs.a.eE,this.g,this.h);this.i[this.i.length]=n;var t=this.f.a();var o=this;var r=function(){n.q.a(o.m)};var s=this;var u=function(){n.q.a(s.p)};var e=this;var i=function(){e.k(n,_nbs.a.iu,"PersonaMiddleNames",t.w(),_nbs.a.iu)};if(_g.a.a().c().bl.UserCulture==="ja-JP"){u();r();i()}else if(this.f.b()===2){r();u();i()}else{r();i();u()}this.k(n,_nbs.a.le,"PersonaDisplayNamePrefixes",t.bE(),_nbs.a.le);this.k(n,_nbs.a.Ug,"PersonaGenerations",t.bn(),_nbs.a.Ug);var h=this;var f=function(){var i=new _d.u(_nbs.a.gW,"PersonaYomiFirstNames",t.Z());var n=new _d.u(_nbs.a.FJ,"PersonaYomiLastNames",t.ba());return _g.a.a().c().bl.UserCulture==="ja-JP"?[n,i]:[i,n]};this.j(String,n,f(),_nbs.a.fw,!1)},R:function(){var t=null;var u=this.f.b();var i;if(u){t=new _d.h(this.f,_nbs.a.ez,this.g,this.h);this.i[this.i.length]=t;i=""}else i=String.format(_nbs.a.dK,_nbs.a.ez);var r=[];if(u){var o=this.f.a();var n=null;n=this.h?[_nbs.a.Hy,_nbs.a.WE,_nbs.a.cH]:this.g?[_nbs.a.ez,_nbs.a.YC,_nbs.a.JX]:[_nbs.a.at,_nbs.a.gZ,_nbs.a.Rx];var f=this.h?[_nbs.a.Hy,_nbs.a.WE,_nbs.a.cH]:[_nbs.a.ez,_nbs.a.YC,_nbs.a.JX];this.bA(t,n,f,o);this.g||this.f.b()!==2||t.H()}else{var e=this.bM();r[r.length]=new _d.I(this.f.d()?_nbs.a.ez:i,"PersonaEmailAddress",e,this.f.a())}},bA:function(n,t,i,r){var o=this;var u=function(t,i,u,f,e){var s=[new _d.I(i,u,f,r)];o.j(_g.d,n,s,e,!0)};if(this.g){var e=new _g.d;this.J(_g.d,n,r.j(),e,"PersonaEmails1",t[0]);u(n,t[1],"PersonaEmails2",r.o(),i[1]);u(n,t[2],"PersonaEmails3",r.p(),i[2])}else{var f=[new _d.I(t[0],"PersonaEmails1",r.j(),r),new _d.I(t[1],"PersonaEmails2",r.o(),r),new _d.I(t[2],"PersonaEmails3",r.p(),r)];this.j(_g.d,n,f,_nbs.a.ez,!0)}},bM:function(){var t=this.f.a();var n=new(_bc.S.$$(_g.d));this.x(t.j(),n);this.x(t.o(),n);this.x(t.p(),n);return n},x:function(n,t){if(n)for(var u=n.b(),i=0;i<u;i++){var r=n.c(i);t.k(r.a(),r.b())}},P:function(n,t){var i=new(_bc.S.$$(_g.k));this.x(n,i);this.x(t,i);return i},Z:function(){var t=null;var i=this.f.b();var u=this.f.a();if(i){t=new _d.h(this.f,_nbs.a.bX,this.g,this.h);this.i[this.i.length]=t}var n=_nbs.a.bX;i&&!this.g?n=_nbs.a.CZ:this.f.g()||(n=String.format(_nbs.a.dK,_nbs.a.bX));var r=[new _d.u(n,"PersonaImAddresses",u.K())];this.j(String,t,r,_nbs.a.bX,!0)},be:function(){var f=null;var n=this.f.a();var i=!this.f.b();if(!i){f=new _d.h(this.f,_nbs.a.GZ,this.g,this.h);this.i[this.i.length]=f}var r=this.o?_nbs.a.Oe:"{0}";var t=[];var e=this;var y=function(){if(i){var s=e.P(n.k(),n.v());t[t.length]=new _d.q(String.format(r,_nbs.a.dc),"PersonaBusinessPhoneNumbers",s)}else{var h=new _d.q(e.g?_nbs.a.dc:_nbs.a.WF,"PersonaBusinessPhoneNumbers",n.k());var u=new _d.q(e.g?_nbs.a.UH:_nbs.a.Jx,"PersonaBusinessPhoneNumbers2",n.v());if(e.g&&!e.h){var o=new _g.k("","Business");e.J(_g.k,f,n.k(),o,"PersonaBusinessPhoneNumbers",_nbs.a.dc);t=[u]}else t=[h,u]}e.j(_g.k,f,t,_nbs.a.dc,!1)};var s=this;var p=function(){t=[];if(i){var u=s.P(n.A(),n.B());t[t.length]=new _d.q(String.format(r,_nbs.a.FS),"PersonaHomePhones",u)}else t=[new _d.q(s.g?_nbs.a.FS:_nbs.a.Go,"PersonaHomePhones",n.A()),new _d.q(s.g?_nbs.a.gE:_nbs.a.CT,"PersonaHomePhones2",n.B())];s.j(_g.k,f,t,_nbs.a.FS,!1)};var o=this;var v=function(){t=[];if(i){var s=o.P(n.q(),n.D());t[t.length]=new _d.q(String.format(r,_nbs.a.RX),"PersonaMobilePhones",s)}else{var h=new _d.q(o.g?_nbs.a.RX:_nbs.a.Hi,"PersonaMobilePhones",n.q());var u=new _d.q(o.g?_nbs.a.Vt:_nbs.a.SO,"PersonaCarPhones",n.D());if(o.h){var e=new _g.k("","Mobile");o.J(_g.k,f,n.q(),e,"PersonaMobilePhones",_nbs.a.RX);t=[u]}else t=[h,u]}o.j(_g.k,f,t,_nbs.a.RX,!1)};var ot=this;var u=function(n,t,i,r){ot.j(_g.k,f,[new _d.q(n,t,i)],r,!1)};var st=this;var et=function(){var t=st.g?_nbs.a.OX:_nbs.a.JP;u(i?String.format(r,_nbs.a.OX):t,"PersonaOtherTelephones",n.T(),_nbs.a.OX)};var ut=this;var h=function(){var t=ut.g?_nbs.a.fX:_nbs.a.WF;u(i?String.format(r,_nbs.a.fX):t,"PersonaWorkFaxes",n.Y(),_nbs.a.fX)};var ft=this;var l=function(){var t=ft.g?_nbs.a.eA:_nbs.a.Lt;u(i?String.format(r,_nbs.a.eA):t,"PersonaHomeFaxes",n.Q(),_nbs.a.eA)};var at=this;var vt=function(){var t=at.g?_nbs.a.Tt:_nbs.a.Lm;u(i?String.format(r,_nbs.a.Tt):t,"PersonaOtherFaxes",n.S(),_nbs.a.Tt)};var lt=this;var c=function(){var t=lt.g?_nbs.a.ZK:_nbs.a.RS;u(i?String.format(r,_nbs.a.ZK):t,"PersonaOrganizationMainPhones",n.R(),_nbs.a.ZK)};var ht=this;var ct=function(){var t=ht.g?_nbs.a.jZ:_nbs.a.ZN;u(i?String.format(r,_nbs.a.jZ):t,"PersonaAssistantPhoneNumbers",n.N(),_nbs.a.jZ)};var k=this;var w=function(){var t=k.g?_nbs.a.OF:_nbs.a.eC;u(i?String.format(r,_nbs.a.OF):t,"PersonaCallbackPhones",n.P(),_nbs.a.OF)};var b=this;var a=function(){var t=b.g?_nbs.a.QX:_nbs.a.WI;u(i?String.format(r,_nbs.a.QX):t,"PersonaPagers",n.U(),_nbs.a.QX)};var d=this;var it=function(){var t=d.g?_nbs.a.We:_nbs.a.lD;u(i?String.format(r,_nbs.a.We):t,"PersonaRadioPhones",n.V(),_nbs.a.We)};var rt=this;var tt=function(){var t=rt.g?_nbs.a.Na:_nbs.a.bv;u(i?String.format(r,_nbs.a.Na):t,"PersonaTelexNumbers",n.W(),_nbs.a.Na)};var g=this;var nt=function(){var t=g.g?_nbs.a.QF:_nbs.a.NM;u(i?String.format(r,_nbs.a.QF):t,"PersonaTTYTDDPhoneNumbers",n.X(),_nbs.a.QF)};if(this.h){v();p();y();a();c();h();l()}else{y();p();v();et();a();h();l();vt();c();ct();w();it();tt();nt()}},bf:function(){this.f.b()?this.bz():this.by()},by:function(){var n=this.f.a();this.H(_g.p,null,_nbs.a.BH,"PhysicalAddresses",n.H(),!1,_d.n.b(n.H()));this.H(_g.p,null,_nbs.a.Vb,"PhysicalAddresses",n.J(),!1,_d.n.b(n.J()));this.H(_g.p,null,_nbs.a.jG,"PhysicalAddresses",n.L(),!1,_d.n.b(n.L()))},bz:function(){var n=new _d.h(this.f,_nbs.a.Rs,this.g,this.h);this.i[this.i.length]=n;var t=this.f.a();var u=this;var i=function(){u.j(_g.p,n,[new _d.ba(_nbs.a.RQ,"PersonaBusinessAddresses",t.H())],_nbs.a.RQ,!1)};var f=this;var r=function(){f.j(_g.p,n,[new _d.ba(_nbs.a.EY,"PersonaHomeAddresses",t.J())],_nbs.a.EY,!1)};if(this.h){r();i()}else{i();r()}this.j(_g.p,n,[new _d.ba(_nbs.a.kA,"PersonaOtherAddresses",t.L())],_nbs.a.kA,!1)},bd:function(){var n=null;var i=this.f.a();var t=!this.f.b();if(!t){n=new _d.h(this.f,_nbs.a.YZ,this.g,this.h);this.i[this.i.length]=n}var u=this;var w=function(){var i=t||u.g?_nbs.a.Qq:_nbs.a.EJ;u.k(n,i,"PersonaBusinessHomePages",u.K,_nbs.a.Qq)};var b=this;var p=function(){var r=t||b.g?_nbs.a.i:_nbs.a.Qw;b.k(n,r,"PersonaSchools",i.bG(),_nbs.a.i)};var v=this;var tt=function(){var r=t||v.g?_nbs.a.QZ:_nbs.a.MD;v.k(n,r,"PersonaNicknames",i.br(),_nbs.a.QZ)};var y=this;var g=function(){var r=t||y.g?_nbs.a.Mo:_nbs.a.BT;y.k(n,r,"PersonaPersonalHomePages",i.bf(),_nbs.a.Mo)};var d=this;var nt=function(){var r=t||d.g?_nbs.a.Qi:_nbs.a.Su;d.k(n,r,"PersonaProfessions",i.bs(),_nbs.a.Qi)};var r=this;var o=function(){var u=r.g?_nbs.a.fR:_nbs.a.Id;var t=r.g?_nbs.a.fR:_nbs.a.Wa;r.k(n,u,"PersonaSpouseNames",i.bg(),t)};var rt=this;var it=function(){t&&rt.j(Array,n,[new _d.cS(_nbs.a.ml,"PersonaChildren",i.bm())],_nbs.a.ml,!1)};var f=this;var e=function(){var r=t||f.g?_nbs.a.VG:_nbs.a.Ov;f.k(n,r,"PersonaHobbies",i.bp(),_nbs.a.VG)};var l=this;var a=function(){var r=t||l.g?_nbs.a.mK:_nbs.a.Wm;l.j(_a.c,n,[new _d.cm(r,"PersonaWeddingAnniversariesLocal",i.bt())],_nbs.a.mK,!1)};var s=this;var h=function(){var r=t||s.g?_nbs.a.Z:_nbs.a.GV;s.j(_a.c,n,[new _d.cm(r,"PersonaBirthdaysLocal",i.be())],_nbs.a.Z,!1)};var c=this;var k=function(){var r=t||c.g?_nbs.a.TV:_nbs.a.Jd;c.k(n,r,"PersonaLocations",i.bq(),_nbs.a.TV)};if(this.g){tt();g();o();if(!this.h){p();e();k();w()}h();a()}else{w();p();g();nt();o();it();e();a();h();k()}},ba:function(){var i=this.v.b();if(i>0&&!this.f.b()&&this.f.a().b()===1){var u=new _d.h(this.f,_nbs.a.mY,this.g,this.h);this.i[this.i.length]=u;for(var t=0;t<i;t++){var r=this.v.c(t);var n=new(_bc.S.$$(String));n.g(r.a().toString(),r.b()[0]);this.N(u,null,"PersonaBusinessHomePages",n,!0,_d.n.b(n),!0)}}},bg:function(){if(!this.f.b()&&this.f.a().b()===1&&!_js.d.a(this.f.f())){var i=this.f.a().cy();if(!_js.d.a(i)){var r=_js.d.c("{0}/?user={1}",this.f.f(),encodeURIComponent(i));var n=new(_bc.S.$$(String));n.g(r,_pecs.d.a);var t=new _d.h(this.f,_nbs.a.CK,this.g,this.h);this.i[this.i.length]=t;this.N(t,null,"PersonaBusinessHomePages",n,!0,!1,!0)}}},br:function(n){var f=this.f.a();this.v=new(_bc.S.$$(String));this.K=new(_bc.S.$$(String));var t=[];if(n)for(var y=n.b(),h=0;h<y;h++)for(var r=n.c(h),a=r.b().length,o=0;o<a;o++)for(var l=f.e(),v=l.b(),e=0;e<v;++e){var i=l.c(e);if(i.a()===r.b()[o])switch(i.b()){case"Facebook":case"LinkedIn":this.v.g(r.a().toString(),i.a());t[t.length]=i.b();break;default:this.K.g(r.a().toString(),i.a());break}}if(f.cA()>0)for(var c=f.cz(),p=c.length,s=0;s<p;s++){var u=c[s];if(!Array.contains(t,u.c())){this.v.g(u.c(),u.a());t[t.length]=u.c()}}},bc:function(){var n=null;var f=this.f.a();n=new _d.h(this.f,_nbs.a.km,this.g,this.h);this.i[this.i.length]=n;var r=f.h();if(r)for(var u=r.b(),o=u===1,s=f.e(),t=0;t<u;t++){var i=r.c(t);if(!_js.d.b(i.a().bl.Value)){var e=new _d.c(this.f,i,"PersonaBodies",this.f.b()?_nbs.a.ZD:"",o,!1,this.g,this.h);var h=this;s.h(function(n){if(n.a()===i.b()[0]){e.z(n.c());return!0}else return!1});n.q.a(e)}}return n},bx:function(){var n=this.bc();var e=this.f.a();var f=e.h();var o=this.g?_nbs.a.Le:_nbs.a.ZD;if(this.f.b()&&n)if(f&&n.q.x.length>0){for(var u=new(_bc.S.$$(_g.w)),l=f.b(),c=e.e(),t=0;t<l;t++)for(var i=f.c(t),a=i.b().length,r=0;r<a;r++){var v=this;c.h(function(n){if(n.a()===i.b()[r]&&n.b()==="Outlook"){var t=new _g.w;t.c("Text");t.b(i.a().bl.Value);u.g(t,n.a());return!0}else return!1})}if(u.b()>0){var h=[new _d.cl(o,"PersonaBodies",u)];n.l(_g.w,h,_nbs.a.km)}}else{var s=[new _d.cl(o,"PersonaBodies",null)];n.l(_g.w,s,_nbs.a.km)}},J:function(n,t,i,r,u,f){var o;var h,s;var c=(s=_d.n.a(n,i,r,this.f,h={val:o}),o=h.val,s);i||(i=c);var l=u==="PersonaEmails1"||u==="PersonaEmails2"||u==="PersonaEmails3";var e=new _d.c(this.f,o,u,f,l,!1,this.g,this.h);this.f.b()!==3||u!=="PersonaEmails1"||_js.d.a(e.j.EmailAddress)||(e.R=!0);t.q.a(e)},bJ:function(){var n=new _d.h(this.f,_nbs.a.by,this.g,this.h);this.i[this.i.length]=n;var t=this.f.a();this.k(n,_nbs.a.cB,"PersonaTitles",t.l(),_nbs.a.cB);this.J(String,n,t.m(),"","PersonaCompanyNames",_nbs.a.Sj);this.k(n,_nbs.a.Mp,"PersonaYomiCompanyNames",t.r(),_nbs.a.Mp)},bh:function(){var n=!1;var i=this.f.a();var t=new _d.h(this.f,_nbs.a.by,this.g,this.h);t.d=!0;var v=!1;var u=this.f.b();if(u!==2){if(!i.e()||!i.e().b())return;for(var f=null,d=",",y,w,g=(w=this.bO(y={val:f}),f=y.val,w),k=f.length,o=0;o<k;o++){var b=f[o];if(_js.d.a(b))v=!0;else{var nt=g.a[b];var r=nt.split(d);var e,h,a,l,s,c;if(this.g){e=_nbs.a.cB;h=_nbs.a.OO;a=_nbs.a.cC;l=_nbs.a.cx;s=_nbs.a.UI;c=_nbs.a.gb}else{e=_nbs.a.lI;h=_nbs.a.MT;a=_nbs.a.Sj;l=_nbs.a.gL;s=_nbs.a.VA;c=_nbs.a.KE}n=this.l(t,i.l(),r,"PersonaTitles",e,!0)||n;n=this.l(t,i.z(),r,"PersonaDepartments",h,!0)||n;n=this.l(t,i.m(),r,"PersonaCompanyNames",a,!0)||n;n=this.l(t,i.E(),r,"PersonaOfficeLocations",l,!0)||n;n=this.l(t,i.C(),r,"PersonaManagers",s,!0)||n;n=this.l(t,i.y(),r,"PersonaAssistantNames",c,!0)||n;this.g&&(n=this.l(t,i.r(),r,"PersonaYomiCompanyNames",_nbs.a.Mp,!0)||n);var p=t.q.x.length;p>0&&t.q.x[p-1].bd(!1)}}(u===1||u===3)&&v&&(n=this.Q(t))}else n=this.Q(t);(!u&&n||u)&&(this.i[this.i.length]=t)},bO:function(n){n.val=[];for(var u=_a.L.a(),i=this.f.a(),s=i.e().b(),e=0;e<s;++e){var t=i.e().c(e);var r=new Sys.StringBuilder;if(!i.s(t.a()).f()){r.append(this.n(i.l(),t.a()));r.append(this.n(i.z(),t.a()));r.append(this.n(i.m(),t.a()));r.append(this.n(i.E(),t.a()));r.append(this.n(i.C(),t.a()));r.append(this.n(i.y(),t.a()));this.g&&r.append(this.n(i.r(),t.a()));var f=r.toString().toLowerCase();if(u.c(f)){var o;u.b(o=f,u.a[o]+","+t.a())}else{u.b(f,t.a());n.val[e]=f}}}return u},n:function(n,t){var r="";var i=n?this.bo(n,t):null;i&&i.a()&&(r=i.a().toString());return r},l:function(n,t,i,r,u,f){var c=this.bu(n,t,i,r,u,f);var h=this.f.b();if(!c&&(h===1||h===3)){for(var s=!1,l=i.length,e=0;e<l;e++){var o=i[e];if(this.f.a().s(o).g()||this.bL(t,o)){s=!0;break}}s&&this.bw(n,t,i,r,u,f);return!1}return!0},bL:function(n,t){if(!n)return!1;for(var o=n.b(),i=0;i<o;++i){var f=n.c(i);if(f)for(var u=f.b(),s=u.length,r=0;r<s;r++){var e=u[r];if(e===t)return!0}}return!1},bu:function(n,t,i,r,u,f){if(!t||!t.b())return!1;var s=this.bo(t,i[0]);if(!s)return!1;var o=new _g.u(s.a().toString());o.Attributions=i;var e=new _d.c(this.f,new _bc.H(o),r,u,f,!1,this.g,this.h);e.bb(i.join(","));n.q.a(e);return!0},bw:function(n,t,i,r,u,f){if(!t){var e=this.f.a();switch(r){case"PersonaTitles":t=e.bi(new(_bc.S.$$(String)));break;case"PersonaDepartments":t=e.bx(new(_bc.S.$$(String)));break;case"PersonaCompanyNames":t=e.bw(new(_bc.S.$$(String)));break;case"PersonaOfficeLocations":t=e.bB(new(_bc.S.$$(String)));break;case"PersonaManagers":t=e.bz(new(_bc.S.$$(String)));break;case"PersonaAssistantNames":t=e.bv(new(_bc.S.$$(String)));break;case"PersonaYomiCompanyNames":t=e.bH(new(_bc.S.$$(String)));break}}t.j("",i);var s=t.c(t.b()-1);var o=new _d.c(this.f,s,r,u,f,!1,this.g,this.h);o.bb(i.join(","));n.q.a(o)},Q:function(n){var t=this.f.a();var r=this.f.b();var i=[new _d.u(_nbs.a.lI,"PersonaTitles",t.l()),new _d.u(_nbs.a.MT,"PersonaDepartments",t.z()),new _d.u(_nbs.a.Sj,"PersonaCompanyNames",t.m()),new _d.u(_nbs.a.gL,"PersonaOfficeLocations",t.E()),new _d.u(_nbs.a.VA,"PersonaManagers",t.C()),new _d.u(_nbs.a.KE,"PersonaAssistantNames",t.y())];this.g&&(i=i.concat.call(i,new _d.u(_nbs.a.FE,"PersonaYomiCompanyNames",t.r())));r===2||r===3?this.j(String,n,i,_nbs.a.by,!1):n.l(String,i,_nbs.a.by);return!0},bo:function(n,t){for(var f=null,o=n.b(),u=0;u<o;++u){var i=n.c(u);if(i)for(var e=i.b(),s=e.length,r=0;r<s;r++)if(e[r]===t){f=i;break}}return f},bN:function(n){var t=n.d.a();this.f.j(t)},bP:function(n){var t=n.d.a();this.f.o(t)}};_d.c=function(n,t,i,r,u,f,e,o){this.bf=Function.createDelegate(this,this.bx);this.be=Function.createDelegate(this,this.bw);this.T=Function.createDelegate(this,this.bs);this.V=Function.createDelegate(this,this.by);this.U=Function.createDelegate(this,this.bv);this.B=new _js.r;_d.c.initializeBase(this);this.p=e;this.p&&(this.F=o);this.f=n;this.d=t;this.g=i;this.o=r;this.t="";this.x=u;this.M=f;this.ba();this.f.b()&&this.C()||this.x?this.z(""):this.z(_d.c.d(this.d,this.f.a(),this.t))};_d.c.d=function(n,t,i){var f=null;var u="";var e=null;if(!n||!n.b()||!n.b().length)return u;e=new(_a.eJ.$$(String));for(var s=i.split(","),o=0,h=n.b().length;o<h;++o){f=t.s(n.b()[o]);if(f&&!f.f()&&(_js.d.a(i)||_d.c.f(f.a(),s))){var r=f.c();_js.d.b(r)&&(r=_u.R.bX);if(e.f(r))continue;_js.d.a(u)||(u+=_nbs.a.SP);u+=r;e.b(r)}}return u};_d.c.a=function(n){return n?String.isInstanceOfType(n)?_js.d.a(n):Array.isInstanceOfType(n)?!n.length:_g.o.a(n)?_g.o.d(n)||_js.d.a(n.RoutingType)?_js.d.a(n.OriginalDisplayName):_js.d.a(n.EmailAddress):_g.dr.a(n)?_js.d.a(n.Number):_g.p.isInstanceOfType(n)?_js.d.a(n.b())&&!n.z().a.c():_g.w.isInstanceOfType(n)?_js.d.a(n.bl.Value):!1:!0};_d.c.e=function(){return _a.n.a()in _a.x.a};_d.c.f=function(n,t){for(var r=t,f=r.length,i=0;i<f;++i){var u=r[i];if(u===n)return!0}return!1};_d.c.b=function(n,t,i,r){var o=n.bu();if(!t&&(!o||!o.length))return null;var f=[];var c={};var u=0;if(t)for(var e=0;e<t.b();++e)if(n.bl(t.c(e).b())){f[u]=new _g.bv(new _g.e(r));f[u].OldValue=t.c(e).a();f[u].NewValue=i;for(var s=0;s<t.c(e).b().length;s++)c[t.c(e).b()[s]]="1";u++}if(!_js.d.a(i))for(var h=0;h<o.length;h++)if(!c[o[h].a()]){f[u]=new _g.bv(new _g.e(r));f[u].OldValue="";f[u].NewValue=i;break}return f};_d.c.prototype={f:null,d:null,o:null,g:"FolderId",M:!1,k:null,t:null,r:null,x:!1,R:!1,h:null,i:null,W:null,e:null,l:null,m:null,n:null,v:null,y:null,j:null,A:null,I:null,H:null,L:!1,N:null,P:null,q:function(n){this.B.b(n)},J:function(n){this.B.c(n)},b:function(){return this.o},bn:function(){return _a.UserAgent.getInstance().D},bm:function(){return _a.UserAgent.getInstance().E},p:!1,F:!1,S:function(n){if(!this.F){this.i=n;this.f.c(!0)}return n},C:function(){return!!this.f.b()&&this.f.a().bl(this.d.b())&&!this.bt()},G:function(){return this.B.e()},bp:function(){return this.f.m()&&this.f.a().d()&&this.f.a().d().length>1&&_g.o.a(this.d.a())&&_g.o.b(this.d.a(),this.f.l())?!0:!1},K:function(n){if(this.L!==n){this.L=n;this.dQ("SetFocusOnActive")}return n},Z:function(){return this.g==="PersonaTitles"||this.g==="PersonaDepartments"||this.g==="PersonaCompanyNames"||this.g==="PersonaManagers"||this.g==="PersonaOfficeLocations"||this.g==="PersonaAssistantNames"||this.g==="PersonaYomiCompanyNames"},bj:function(){return this.h===_g.p&&this.w()&&!_js.d.a(this.l)&&_js.d.a(this.m)&&_js.d.a(this.n)},bl:function(){return this.h===_g.p&&this.w()&&!_js.d.a(this.l)&&!_js.d.a(this.m)&&_js.d.a(this.n)},bk:function(){return this.h===_g.p&&this.w()&&!_js.d.a(this.l)&&!_js.d.a(this.m)&&!_js.d.a(this.n)},a:function(){return this.e},c:function(n){this.e=n;this.f.c(!0);return n},bz:function(n){this.j=n;this.f.c(!0);return n},z:function(n){if(this.r!==n){this.r=n;this.dQ("AttributionDisplayString")}return n},bb:function(n){if(this.t!==n){this.t=n;this.w()||this.z(_d.c.d(this.d,this.f.a(),n))}return n},w:function(){return this.x||_js.d.a(this.r)},bd:function(n){if(this.x!==n){this.x=n;n?this.z(""):this.z(_d.c.d(this.d,this.f.a(),this.t))}return n},X:function(){this.G()?this.A||(this.A=new _C(this.U,_d.c.c)):this.A=null;return this.A},bo:function(){this.I||(this.I=new _C(this.V,_d.c.c));return this.I},Y:function(){this.H||(this.H=new _C(this.T,_d.c.c));return this.H},bc:function(n){this.P=n;this.dQ("EditorCallContext");return n},bq:function(){var n="";if(this.h!==_g.p)n+=_js.d.b(this.o)?" "+this.e:_js.d.c(_nbs.a.gF," "+this.o,this.e);else for(var r=this.y.q(),u=r.length,t=0;t<u;++t){var i=r[t];_js.d.b(i)||(n+=" "+i)}this.G()&&(n+=" "+_nbs.a.Uf);n+=".";this.w()||(n=_js.d.c(_nbs.a.KA,n,this.r+"."));return n},bg:function(n){if(!this.C()||!this.bu())return null;var t="";var i="";if(this.h===_a.c){_d.c.a(this.v)||(t=this.v.f().D());_d.c.a(this.d.a())||(i=this.E().f().D())}else if(this.h===_g.p){t=this.y.p();i=n?_g.cC.b:this.d.a().p()}else if(this.h===_g.d)return this.bh();else if(this.h===String&&this.g==="PersonaBodies"){t=this.e;_js.d.a(this.d.a().bl.Value)||(i=this.E());_js.d.a(t)&&(t=" ")}else{t=this.e;_d.c.a(this.d.a())||(i=this.E())}if(this.g==="PersonaGivenNames")return _d.c.b(this.f.a(),this.f.a().I(),t,this.g);else if(this.g==="PersonaMiddleNames")return _d.c.b(this.f.a(),this.f.a().w(),t,this.g);else if(this.g==="PersonaSurnames")return _d.c.b(this.f.a(),this.f.a().F(),t,this.g);else{var r=new _g.bv(new _g.e(this.g));r.OldValue=i;r.NewValue=t;return[r]}},bv:function(){this.B.a(this)},by:function(){this.f.c(!0)},bA:function(n){this.d.f(n);this.ba();this.dQ("StringDisplayValue")},bw:function(){if(!this.F&&!this.p){if(!this.k){this.k=new _g.d;this.k.EmailAddress=this.e;this.k.Name=this.i}var n=!1;if(_js.d.a(this.e)){this.S("");n=!0}else{var i=this.d.a();if(_js.d.a(this.i)||this.i===this.D(_g.o.c(i))||this.i===this.D(this.k.EmailAddress)){var t=this.D(this.e);if(t!==this.i){this.S(t);n=!0}}}if(n){this.k.EmailAddress=this.e;this.k.Name=this.i;this.dQ("EmailDisplayAs")}}},bx:function(){if(_js.d.a(this.i)&&!_js.d.a(this.e)&&!this.p){this.S(this.D(this.e));this.dQ("EmailDisplayAs")}},D:function(n){if(_js.d.b(n))return"";if(!this.C())return n;var t=this.f.n(_d.c.e());return _js.d.a(t)?_js.d.c("({0})",n):_js.d.c("{0} ({1})",t,n)},bt:function(){return _g.w.isInstanceOfType(this.d.a())?this.d.a().bl.IsTruncated:!1},bu:function(){var t=this.E();var n=this.br();if(_d.c.a(t)&&_d.c.a(n))return!1;else if(this.f.b()===3)return!0;else if(_d.c.a(t)!==_d.c.a(n))return!0;else{if(this.h===_g.p){var o=t.b();var e=n.b();return o!==e}if(this.h===_g.d){var h=_g.o.c(t);var s=n.EmailAddress;var r=t.Name;var i=n.Name;return h!==s||r!==i}if(this.h===_a.c){var f=t;var u=n;return!f.bd(u)}return t!==n}},br:function(){if(this.h===_a.c)return this.v;if(this.h===_g.p)return this.y;if(this.h===_g.d){var n=new _g.d;n.Name=this.i;n.RoutingType=this.d.a().RoutingType;_g.o.d(this.d.a())||_js.d.a(n.RoutingType)?n.OriginalDisplayName=this.e:n.EmailAddress=this.e;return this.bz(n)}if(this.g==="PersonaBodies"){this.Y()&&this.Y().a();return this.e}return this.e},bh:function(){var r=_g.o.c(this.j);var i=this.d.a().EmailAddress;var e=this.d.a().OriginalDisplayName;var u=_g.o.c(this.j);var n=this.j.Name;var f=this.d.a().Name;n===i&&(n=r);var t=[];switch(this.g){case"PersonaEmails1":t=this.Q(i,r,f,n,e,u,"PersonaEmails1","PersonaEmails1OriginalDisplayNames","PersonaEmails1DisplayNames");break;case"PersonaEmails2":t=this.Q(i,r,f,n,e,u,"PersonaEmails2","PersonaEmails2OriginalDisplayNames","PersonaEmails2DisplayNames");break;case"PersonaEmails3":t=this.Q(i,r,f,n,e,u,"PersonaEmails3","PersonaEmails3OriginalDisplayNames","PersonaEmails3DisplayNames");break}return t},Q:function(n,t,i,r,u,f,e,o,s){var c=[];var h=0;if(this.f.b()===3||n!==t){c[h]=new _g.bv(new _g.e(e));c[h].OldValue=n||null;c[h].NewValue=t||null;++h;c[h]=new _g.bv(new _g.e(o));c[h].OldValue=u||null;c[h].NewValue=f||null;++h}if(this.f.b()===3||i!==r){c[h]=new _g.bv(new _g.e(s));c[h].OldValue=i||null;c[h].NewValue=r||null}return c},ba:function(){var n=this.E();if(String.isInstanceOfType(n)){this.e=n;this.h=String}else if(this.g==="PersonaBirthdaysLocal"||this.g==="PersonaWeddingAnniversariesLocal"){this.h=_a.c;if(!_d.c.a(n)){this.v=n;this.e=this.v.e()!==1604||this.C()?n.a(1):n.a(8)}}else if(_g.p.isInstanceOfType(n)){this.y=this.bi(n);var t=this.y.q();this.l=t.length>0?t[0]:null;this.m=t.length>1?t[1]:null;this.n=t.length>2?t[2]:null;this.h=_g.p}else if(_g.o.a(n)){this.j=n;this.bB();this.h=_g.d;this.W=n.OriginalDisplayName}else if(_g.w.isInstanceOfType(n)){this.e=n.bl.Value;this.h=String}},E:function(){if(_g.o.a(this.d.a()))return this.d.a();else if(_g.dr.a(this.d.a()))return this.d.a().Number;else if(_g.p.isInstanceOfType(this.d.a()))return this.d.a();else if(_g.w.isInstanceOfType(this.d.a()))return this.d.a().bl.Value;else if(this.g==="PersonaBirthdaysLocal"||this.g==="PersonaWeddingAnniversariesLocal"){_d.c.a(this.d.a())||(this.N=this.d.a());return this.N}else return this.g==="PersonaBusinessHomePages"&&this.M?this.d.b()&&this.d.b().length>0?this.d.b()[0]===_pecs.d.a?this.d.a():this.f.a().s(this.d.b()[0]).c():"":Array.isInstanceOfType(this.d.a())?this.d.a().join(", "):this.d.a()?this.d.a():""},bi:function(n){var t=_g.p.a();t.g(n.bl.Street);t.j(n.bl.City);t.o(n.bl.State);t.n(n.bl.PostalCode);t.k(n.bl.Country);return t},bB:function(){this.e=null;this.i=null;var n=_g.o.c(this.j);if(_js.d.b(n)){this.i="";this.e="";return}switch(this.f.b()){case 2:case 3:case 1:this.i=_js.d.a(this.j.Name)?this.D(this.j.EmailAddress):this.j.Name;break}this.e=n},bs:function(){this.bc(new _cmc.b(!1))}};_d.cm=function(n,t,i){_d.cm.initializeBase(this,[n,t,i])};_d.cm.prototype={j:function(n){switch(this.a){case"PersonaWeddingAnniversariesLocal":n.cs(new(_bc.S.$$(_a.c)));return n.bt();case"PersonaBirthdaysLocal":n.bM(new(_bc.S.$$(_a.c)));return n.be();default:throw this.e();}},k:function(){return null}};_d.I=function(n,t,i,r){_d.I.initializeBase(this,[n,t,i]);this.g=r};_d.I.prototype={g:null,c:null,b:function(){if($a(this.c)&&!$a(_d.cn.prototype.b.call(this))){this.c=new(_bc.S.$$(_g.d));for(var n=0;n<_d.cn.prototype.b.call(this).b();++n)this.g.bl(_d.cn.prototype.b.call(this).c(n).b())?this.c.k(_d.cn.prototype.b.call(this).i(n),_d.cn.prototype.b.call(this).c(n).b()):this.c.j(_d.cn.prototype.b.call(this).i(n),_d.cn.prototype.b.call(this).c(n).b())}return this.c},h:function(n){this.c=null;_d.cn.prototype.h.call(this,n);return n},j:function(n){switch(this.a){case"PersonaEmails1":n.bT(new(_bc.S.$$(_g.d)));return n.j();case"PersonaEmails2":n.bU(new(_bc.S.$$(_g.d)));return n.o();case"PersonaEmails3":n.bV(new(_bc.S.$$(_g.d)));return n.p();default:throw this.e();}},i:function(n,t){_d.cn.prototype.b.call(this).j(n,t);this.c=null;return _d.cn.prototype.b.call(this).c(_d.cn.prototype.b.call(this).b()-1)},k:function(){var n=new _g.d;n.EmailAddress="";n.RoutingType="SMTP";return n}};_d.cl=function(n,t,i){_d.cl.initializeBase(this,[n,t,i])};_d.cl.prototype={j:function(n){switch(this.a){case"PersonaBodies":n.bh(new(_bc.S.$$(_g.w)));return n.h();default:throw this.e();}},k:function(){var n=new _g.w;n.b("");n.c("Text");return n}};_d.q=function(n,t,i){_d.q.initializeBase(this,[n,t,i])};_d.q.prototype={j:function(n){switch(this.a){case"PersonaBusinessPhoneNumbers":n.bP(new(_bc.S.$$(_g.k)));return n.k();case"PersonaBusinessPhoneNumbers2":n.bQ(new(_bc.S.$$(_g.k)));return n.v();case"PersonaHomePhones":n.ca(new(_bc.S.$$(_g.k)));return n.A();case"PersonaHomePhones2":n.cb(new(_bc.S.$$(_g.k)));return n.B();case"PersonaMobilePhones":n.ce(new(_bc.S.$$(_g.k)));return n.q();case"PersonaCarPhones":n.cf(new(_bc.S.$$(_g.k)));return n.D();case"PersonaOtherTelephones":n.ck(new(_bc.S.$$(_g.k)));return n.T();case"PersonaWorkFaxes":n.ct(new(_bc.S.$$(_g.k)));return n.Y();case"PersonaHomeFaxes":n.bZ(new(_bc.S.$$(_g.k)));return n.Q();case"PersonaOtherFaxes":n.cj(new(_bc.S.$$(_g.k)));return n.S();case"PersonaOrganizationMainPhones":n.ch(new(_bc.S.$$(_g.k)));return n.R();case"PersonaAssistantPhoneNumbers":n.bL(new(_bc.S.$$(_g.k)));return n.N();case"PersonaCallbackPhones":n.bR(new(_bc.S.$$(_g.k)));return n.P();case"PersonaPagers":n.cl(new(_bc.S.$$(_g.k)));return n.U();case"PersonaRadioPhones":n.co(new(_bc.S.$$(_g.k)));return n.V();case"PersonaTelexNumbers":n.cq(new(_bc.S.$$(_g.k)));return n.W();case"PersonaTTYTDDPhoneNumbers":n.cr(new(_bc.S.$$(_g.k)));return n.X();default:throw this.e();}},k:function(){return new _g.k("","Mobile")}};_d.ba=function(n,t,i){_d.ba.initializeBase(this,[n,t,i])};_d.ba.prototype={j:function(n){switch(this.a){case"PersonaBusinessAddresses":n.bN(new(_bc.S.$$(_g.p)));return n.H();case"PersonaHomeAddresses":n.bY(new(_bc.S.$$(_g.p)));return n.J();case"PersonaOtherAddresses":n.ci(new(_bc.S.$$(_g.p)));return n.L();default:throw this.e();}},k:function(){var n=new _g.p;n.g("");return n}};_d.cn=function(n,t,i){this.f=n;this.a=t;this.d=i};_d.cn.$$=function(n){var t="cn"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.cn.apply(this,t)};r.registerClass("_d."+t);var e={"_d.cn":{T:n}};r.prototype.$$gta=e;var f=_d.cn.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.cn.prototype={f:null,a:"FolderId",d:null,b:function(){return this.d},h:function(n){this.d=n;return n},i:function(n,t){this.d.j(n,t);return this.d.c(this.d.b()-1)},e:function(){return Error.invalidOperation(String.format("Property '{0}' is not supported for {1} fields: ",this.a,this.$$gta["_d.cn"].T.getName()))}};_d.cS=function(n,t,i){_d.cS.initializeBase(this,[n,t,i])};_d.cS.prototype={j:function(n){switch(this.a){case"PersonaChildren":n.bS(new(_bc.S.$$(Array)));return n.bm();default:throw this.e();}},k:function(){return new Array(0)}};_d.u=function(n,t,i){_d.u.initializeBase(this,[n,t,i])};_d.u.prototype={j:function(n){switch(this.a){case"PersonaYomiCompanyNames":n.bH(new(_bc.S.$$(String)));return n.r();case"PersonaYomiLastNames":n.cv(new(_bc.S.$$(String)));return n.ba();case"PersonaYomiFirstNames":n.cu(new(_bc.S.$$(String)));return n.Z();case"PersonaImAddresses":n.cc(new(_bc.S.$$(String)));return n.K();case"PersonaBusinessHomePages":n.bO(new(_bc.S.$$(String)));return n.n();case"PersonaSchools":n.cF(new(_bc.S.$$(String)));return n.bG();case"PersonaPersonalHomePages":n.cm(new(_bc.S.$$(String)));return n.bf();case"PersonaProfessions":n.cn(new(_bc.S.$$(String)));return n.bs();case"PersonaSpouseNames":n.cp(new(_bc.S.$$(String)));return n.bg();case"PersonaHobbies":n.bX(new(_bc.S.$$(String)));return n.bp();case"PersonaOfficeLocations":n.bB(new(_bc.S.$$(String)));return n.E();case"PersonaTitles":n.bi(new(_bc.S.$$(String)));return n.l();case"PersonaDepartments":n.bx(new(_bc.S.$$(String)));return n.z();case"PersonaCompanyNames":n.bw(new(_bc.S.$$(String)));return n.m();case"PersonaManagers":n.bz(new(_bc.S.$$(String)));return n.C();case"PersonaAssistantNames":n.bv(new(_bc.S.$$(String)));return n.y();case"PersonaLocations":n.cd(new(_bc.S.$$(String)));return n.bq();case"PersonaGenerations":n.bW(new(_bc.S.$$(String)));return n.bn();case"PersonaDisplayNamePrefixes":n.cD(new(_bc.S.$$(String)));return n.bE();case"PersonaNicknames":n.cg(new(_bc.S.$$(String)));return n.br();case"PersonaGivenNames":n.by(new(_bc.S.$$(String)));return n.I();case"PersonaMiddleNames":n.bA(new(_bc.S.$$(String)));return n.w();case"PersonaSurnames":n.bC(new(_bc.S.$$(String)));return n.F();default:throw this.e();}},k:function(){return""}};_d.co=function(n){_d.co.initializeBase(this,[n])};_d.co.prototype={l:function(){return this.t.cb},m:function(){return this.t.o},g:function(){return this.t.dF()},d:function(){return this.t.dh()},p:function(n){this.t.eh(n)},q:function(n){if(this.t.c()){this.t.c().c().k(n);_pc.b.a(11,this.k().a,this.a().b())}},o:function(n){if(this.t.c()){this.t.c().c().j(n);_pc.b.a(12,this.k().a,this.a().b())}},j:function(n){if(this.t.c()){this.t.c().c().h(n);_pc.b.a(10,this.k().a,this.a().b())}}};_d.Q=function(n){this.e=Function.createDelegate(this,this.h);_d.Q.initializeBase(this);this.d=n;this.c=new _C(this.e,_d.Q.a);this.a=new _js.f};_d.Q.prototype={d:null,a:null,c:null,b:null,i:function(n){if(this.b!==n){this.b=n;this.dQ("TotalResultsInRecipientCache")}return n},cx:function(){this.a.f();for(var t=_fp.a.b(),n=0;n<t.bl.x.length;n++)this.a.a(this.f(t.bl.x[n]));this.i(String.format(_nbs.a.nC,t.bl.x.length))},cz:function(){},cy:function(){},cA:function(){},f:function(n){var t=this.d.m(n,_pe.c.a,!1,8,0);var i=[1];t.l(1,i,"");t.ex();return t},h:function(){console.log(this.g("\r\n"))},g:function(n){var t=new Sys.StringBuilder;t.append("Name,Main Email,Secondary Email"+n);for(var u=0;u<this.a.x.length;u++){var i=this.a.x[u];t.append("Name: "+i.bD+",");t.append("Email: "+i.bJ);if(!$a(i.bC))for(var r=0;r<i.bC.x.length;r++){t.append(",");var f=i.bC.x[r];t.append("Email "+(r+1).toString()+": "+f.EmailAddress)}t.append(n)}return t.toString()}};_d.bx=function(n){n.a(new _h.dl(!0))};_d.bJ=function(n){var t=new _pc.g;n.a(t)};_d.bP=function(n,t){if(t==="Mouse"){var i=this;n.e(function(n){n.a(_d.m,"TaskReadingPaneContext")})}};_d.by=function(n,t,i){this.l=Function.createDelegate(this,this.n);_d.by.initializeBase(this,[n,t,i]);this.e=new _d.cT};_d.by.prototype={e:null,i:null,w:function(n){if(this.i!==n){this.i=n;this.bj("FilterByButtonLabel")}return n},s:function(){this.r(new _fm.f(new Array(0)));this.x();this.m();this.c.h.a(new _fm.j);this.v();this.k();this.c.h.a(new _fm.j);this.t();this.bj("SortByContextMenu")},m:function(){this.w(this.e.a.b)},x:function(){this.c.h.a(new _fm.n(_u.R.Fx));for(var t=0;t<this.e.b.x.length;t++){var n=this.e.b.x[t];var i=new(_a.gH.$$(_d.bh))(n,this.l);this.c.h.a(new _fm.h(n.b,null,new _C(i.a,_d.S.a),n.c,!1,null,null,"ViewFilter_"+n.a))}},n:function(n,t){if(this.e.a.a===n.a){this.f("ViewFilter_"+n.a,!0);return}this.f("ViewFilter_"+this.e.a.a,!1);this.e.c(n);this.f("ViewFilter_"+n.a,!0);this.h.b(this.y(this.e.a.a));this.m()},y:function(n){switch(n){case"TaskActive":return 1;case"TaskOverdue":return 2;case"TaskCompleted":return 3;default:return 0}}};_d.R=function(){this.r=Function.createDelegate(this,this.v);this.o=Function.createDelegate(this,this.y);this.p=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.A);_d.R.initializeBase(this);this.h=new _bc.b;this.c=new _js.f;this.c.a(new _ff.f(new _C(this.q,_d.R.a),_nbs.a.aD));this.c.a(new _ff.f(new _C(this.p,_d.R.a),_nbs.a.bT));this.c.a(new _ff.f(new _C(this.o,_d.R.a),_bcs.D.A))};_d.R.prototype={j:null,c:null,i:!1,h:null,m:null,e:null,b:null,d:null,a:0,g:null,f:null,n:0,k:function(n){if(this.i!==n){this.i=n;this.dQ("RecurrenceDeletionDialogIsShow")}return n},C:function(n){if(this.j!==n){this.j=n;this.dQ("RecurrenceDialogMessage")}return n},l:function(n,t,i,r){if(!this.a){if(this.B(n)){_a.M.a(_u.R.Xx,1);return}this.e=n;this.m=t;this.g=i;this.f=r;var o=n.x.length;if(o){var u=0;if(n.x.length===1){var e=n.x[0];_pc.a.isInstanceOfType(e)?u=4:_g.F.isInstanceOfType(e)||(u=2)}else for(var f=0;f<o;f++){var s=n.x[f];_g.F.isInstanceOfType(s)||(u=8)}if(u&&(u&_g.a.a().a().C())===u){this.D(u);return}this.v(!0,!1)}}},B:function(n){for(var t=0;t<n.x.length;t++){var i=n.x[t];if(_g.F.isInstanceOfType(i)&&i.s())return!0}return!1},D:function(n){var t="";n===2?t=_nbs.a.gN:n===4?t=_nbs.a.ai:n===8&&(t=_nbs.a.dX);this.n=n;this.h.a(2,t,this.r,!0,_bcs.D.C,_bcs.D.J,_u.R.Cb)},v:function(n,t){if(t){var i;(i=_g.a.a().a()).S(i.C()&~this.n);_h.g.a(_g.a.a().a().v,OwaApplication.a)}if(n){this.b=[];this.d=[];this.a=0;this.x()}},x:function(){while(this.a<this.e.x.length){var n=this.e.x[this.a];if(_g.F.isInstanceOfType(n)&&n.M()){this.C(String.format(_nbs.a.OJ,n.bl.Subject));this.k(!0);return}Array.add(this.b,n.bl.ItemId);this.a++}this.b.length>0&&this.w(this.b,0,!this.d.length);this.d.length>0&&this.w(this.d,1,!0);this.a=0},A:function(){this.t(this.d)},z:function(){this.t(this.b)},t:function(n){var t=this.e.x[this.a];Array.add(n,t.bl.ItemId);this.k(!1);this.a++;this.x()},y:function(){this.k(!1)},w:function(n,t,i){var r=new _h.bg(n,"MoveToDeletedItems",0);r.o=t;r.d=this.m;r.p=1;if(i){var u=this;r.z(function(n){$a(u.f)||u.f()})}OwaApplication.a.a(r);i&&($a(this.g)||this.g())}};_d.bM=function(n,t,i,r){this.d=new _fm.i(t,_nbs.a.IE,_d.g.l(),0,null,null,!1,!1);this.c=new _fm.i(i,_u.R.YW,null,0,null,null,!1,!1);this.f=new _fm.i(n,_nbs.a.VI,_d.g.C(),0,null,null,!1,!1);this.e=new _fm.i(r,null,_d.g.B(),0,null,null,!0,!1)};_d.bM.prototype={f:null,d:null,c:null,e:null,b:null,a:null,g:function(n,t){_js.Trace.logInfo(_d.bM.a,"Initializing task edit commanding bar");if(!this.a){this.a=new _fm.p;this.a.X=!0;this.a.Y=!0;this.a.a(this.f);this.a.a(this.d);this.b=n;this.a.a(this.b);this.a.a(this.c);this.a.a(this.e)}this.b.a(!t);return this.a}};_d.bh=function(n,t){_d.bh.initializeBase(this);_a.b.a(n,"contextMenuDisplayName");_a.b.a(t,"viewFilter");this.b=n;this.a=t};_d.bh.prototype={a:"All",b:null,c:!1,d:function(n){if(this.c!==n){this.c=n;this.dQ("IsSelected")}return n}};_d.cT=function(){_d.cT.initializeBase(this);this.b=new _js.f;this.d();this.c(this.b.x[1])};_d.cT.prototype={b:null,a:null,c:function(n){_a.b.a(n,"filterOption");this.a&&this.a.a!==n.a&&this.a.d(!1);this.a=n;this.a.d(!0)},d:function(){this.b.a(new _d.bh(_nbs.a.Rd,"All"));this.b.a(new _d.bh(_nbs.a.cL,"TaskActive"));this.b.a(new _d.bh(_nbs.a.fc,"TaskOverdue"));this.b.a(new _d.bh(_nbs.a.eS,"TaskCompleted"))}};_d.bu=function(n,t){this.e=Function.createDelegate(this,this.w);_d.bu.initializeBase(this);this.m(this);this.B(!0);this.a=new _d.bN(n,t,!1,!0);this.a.f();this.a.apcl("SelectedTreeNode",this.e)};_d.bu.prototype={a:null,d:null,b:null,c:null,f:function(){return this.a.c()?this.d?!_g.s.b(this.d,this.a.c().bl.FolderId)&&this.a.c().a()!=="todosearch":!1:!1},y:function(n,t,i,r){var e=this,f=this;var u=new _C(function(){n.a();e.g(!1)},_d.bu.a,this,"CanExecuteAction",function(){return f.f()});this.o(new _js.f);this.h.a(this.l(u,i));this.h.a(this.n());this.k(t);this.d=r;this.dQ("CanExecuteAction");this.a.f();this.g(!0)},w:function(n,t){this.dQ("CanExecuteAction")},n:function(){this.c||(this.c=new _ff.f(this.i,_u.R.fU));return this.c},l:function(n,t){this.b?this.b.a!==n&&this.b.f(n):this.b=new _ff.f(n,t);return this.b}};_d.cU=function(n,t){_d.cU.initializeBase(this,[n]);this.e(!!t&&t.a().e().Enabled)};_d.cU.prototype={c:!1,l:function(){return this.c},e:function(n){this.c=n;return n},v:function(){return!0},w:function(){return!1}};_d.bi=function(n){_d.bi.initializeBase(this);_a.b.a(n,"parentTaskFolderPicker");this.b=new _js.f;this.d=n;this.z=n.h};_d.bi.prototype={q:null,m:null,k:null,B:null,t:null,C:0,b:null,o:!1,E:!1,y:!1,A:null,z:null,a:!1,r:null,d:null,x:!1,h:function(n){if(n!==this.y){this.y=n;this.dQ("IsEdit")}return n},V:function(){return this.b.x.length>0},p:function(n){if(this.o!==n){this.o=n;this.dQ("IsSelected")}return n},N:function(n){if(n!==this.E){this.E=n;this.dQ("DisableSelection")}return n},g:function(n){if(n!==this.C){this.C=n;this.dQ("TreeNodeMode")}return n},P:function(n){if(n!==this.A){this.A=n;this.dQ("NewNodeViewModel")}return n},X:function(n){if(n!==this.t){this.t=n;this.dQ("CreateCommand")}return n},bb:function(n){if(n!==this.B){this.B=n;this.dQ("RenameCommand")}return n},Y:function(n){if(n!==this.k){this.k=n;this.dQ("DeleteTaskFolderPromptCommand")}return n},Z:function(n){if(n!==this.m){this.m=n;this.dQ("InitiateRenameTaskFolderCommand")}return n},W:function(n){if(n!==this.q){this.q=n;this.dQ("CancelRenameCommand")}return n},ba:function(n){if(n!==this.x){this.x=n;this.dQ("IsCollapsed")}return n},F:function(n){this.z.a(0,n,null,!1,null,null,_nbs.a.jV)}};_d.bN=function(n,t,i,r){this.m=Function.createDelegate(this,this.n);this.q=_g.q.a("tasks").bl.FolderId;_d.bN.initializeBase(this);this.g=r;this.l=i;this.h=new _bc.b;this.d=t;this.b=n;this.b.m(this.m);this.f()};_d.bN.prototype={h:null,g:!1,l:!1,d:null,e:null,a:null,k:null,o:null,b:null,p:function(n){if(this.a!==n){this.a=n;this.dQ("SelectedTreeNode")}return n},c:function(){if(!this.a||!this.b.b)return null;var n=this.a;return this.b.j(n.f.bl.TaskFolderId)},r:function(n){if(n!==this.k){this.k=n;this.dQ("RootTreeNode")}return n},f:function(){this.b.b&&this.n(this.b)},n:function(n){for(var i=null,e=null,c=n.c,o=new _d.cU(this,this.d),t,f,r,u,s=0;s<c.x.length;s++){t=c.x[s];if(!$a(t)){f=new _d.bj(t,this,this.d);if(!$a(t.a())){for(var h=0;h<t.a().b();h++){u=t.a().a(h);r=new _d.B(u,f,this,this.d);if(u.b()===1){e=r;if(this.l)i=r;else continue}u.bl.TaskFolderId.Id!==this.q.Id||this.l||(i=r);f.b.a(r)}o.b.a(f)}}}if(!o.b.x.length)throw Error.invalidOperation("Unable to get task folders");if(!i&&e){o.b.x[0].b.r(0,e);i=e}if($a(i))throw Error.argumentNull("Couldn't get default task folder");this.r(o);this.e=i;this.e.p(!0)}};_d.B=function(n,t,i,r){this.H=Function.createDelegate(this,this.bf);this.G=Function.createDelegate(this,this.be);this.J=Function.createDelegate(this,this.bk);this.I=Function.createDelegate(this,this.bj);this.Q=Function.createDelegate(this,this.bc);this.U=Function.createDelegate(this,this.bi);this.R=Function.createDelegate(this,this.bd);this.S=Function.createDelegate(this,this.bg);this.T=Function.createDelegate(this,this.bh);_d.B.initializeBase(this,[i]);this.f=n;this.e=t;this.c=n.bl.FolderName;this.bl(!!r&&r.a().e().Enabled);this.g(1);this.Z(new _C(this.T,_d.B.a));this.Y(new _C(this.S,_d.B.a));this.L=new _C(this.R,_d.B.a);if(n.b()){this.m.c(!1);this.k.c(!1)}this.bb(new _C(this.U,_d.B.a));this.W(new _C(this.Q,_d.B.a));this.d.g||(this.r=new _fm.f([new _fm.d(_u.R.af,null,this.m),new _fm.d(_u.R.WR,null,this.k)]))};_d.B.prototype={j:null,i:null,L:null,n:0,f:null,c:null,e:null,M:!1,D:function(n){if(n!==this.c){this.c=n;this.dQ("FolderName")}return n},K:!1,l:function(){return this.K},bl:function(n){this.K=n;return n},v:function(){return!1},w:function(){return!1},bh:function(){if(!this.a){this.P(this);this.h(!0);this.g(4)}},bc:function(){this.h(!1);this.D(this.f.bl.FolderName);this.g(1)},bi:function(){if(_js.d.b(this.c)){this.D(this.f.bl.FolderName);this.h(!1);return}if(this.c.trim()===this.f.bl.FolderName){this.h(!1);return}if(!$a(this.j)){this.j.M(this.I);this.j.N(this.J);this.j=null}var n=this.j=new _c.bO(this.f,this.c,this.d.b);n.v(this.I);n.w(this.J);this.a=!0;OwaApplication.a.a(n);this.h(!1)},bk:function(n){this.a=!1},bj:function(n){this.a=!1;this.D(this.f.bl.FolderName);this.F(this.j.t.message)},bg:function(){var n=this;this.z.a(1,String.format(_u.R.Nz,this.c),function(t,i){t&&n.L.a()},!1,null,null,_u.R.MR)},bd:function(){if(!this.a){if(!$a(this.i)){this.i.M(this.G);this.i.N(this.H);this.i=null}var n=this.i=new _c.bu(this.f,this.e.f,this.d.b);n.v(this.G);n.w(this.H);this.a=!0;this.e.a=!0;OwaApplication.a.a(n);this.M=this.o;this.p(!1);this.n=this.e.b.k(this);this.n>=0&&this.e.b.n(this.n)}},bf:function(n){this.e.a=!1;this.a=!1;this.M&&this.d.e.p(!0)},be:function(n){this.n>=0&&this.e.b.r(this.n,this);this.e.a=!1;this.a=!1;this.F(this.i.t.message)}};_d.bj=function(n,t,i){this.i=Function.createDelegate(this,this.L);this.j=Function.createDelegate(this,this.M);this.I=Function.createDelegate(this,this.Q);this.H=Function.createDelegate(this,this.K);_d.bj.initializeBase(this,[t]);this.f=n;this.G=n.bl.GroupName;this.D=i;this.R(!!i&&i.a().e().Enabled);this.X(new _C(this.H,_d.bj.a));var r=new _C(this.I,_d.bj.a);this.N(!0);this.g(1);if(!this.d.g){this.J=new _fm.d(null,_d.g.k(),r);this.r=new _fm.f([new _fm.d(_u.R.bW,null,r)])}};_d.bj.prototype={f:null,D:null,J:null,e:null,c:null,G:null,n:!1,l:function(){return this.n},R:function(n){this.n=n;return n},v:function(){return!0},w:function(){return!0},Q:function(){if(!this.a){if(!$a(this.c)){this.c.N(this.j);this.c.M(this.i);this.c=null}this.c=new _c.bt(this.f,this.d.b);this.c.w(this.j);this.c.v(this.i);var n=new _d.B(this.c.a,this,this.d,this.D);n.h(!0);n.N(!0);this.P(this.e=n);this.g(3)}},K:function(){if(!_js.d.b(this.e.c)){this.e.h(!1);this.e.g(2);this.c.g(this.e.c);this.a=!0;OwaApplication.a.a(this.c);this.b.a(this.e)}},L:function(n){this.b.m(this.e,!0);this.a=!1;this.F(this.c.e)},M:function(n){this.e.g(1);this.a=!1}};_d.cV=function(){_d.cV.initializeBase(this,[displayName,order])};_d.K=function(n,t,i,r,u,f,e,o,s){this.fI=Function.createDelegate(this,this.hD);this.fJ=Function.createDelegate(this,this.hG);this.fH=Function.createDelegate(this,this.gI);_d.K.initializeBase(this,[n,t,i,r,u,f,e,null,null,null,null,null,o,null,null,null]);this.bS=new _C(this.fH,_d.K.a);this.fD=new _C(this.fJ,_d.K.a);this.dG=new _d.R;this.eR=!!s&&s.a().f().Enabled;this.eS=!!s&&s.a().e().Enabled};_d.K.prototype={bS:null,fD:null,cD:null,dG:null,cG:function(){return!0},eR:!1,eS:!1,gg:function(n,t,i){if((n&1)==1)throw Error.notImplemented();var f=new _c.dn(this.h(),this.ei,this.dw);var e=this;var r=_h.d.b(f,_h.i.a(),function(n){return new _c.bl(n)});var u=new _h.o(0,this.ft());u.c=1;r.Y(u,null,null,null);this.el=!1;return r},im:function(){return!1},fY:function(n){this.K(!0);var i=new _y.ct(!1);var t=new _y.bu;switch(this.dw.a){case"TaskStartDate":var e=this;return new _y.bR(i,function(n){if(_g.F.isInstanceOfType(n)&&n.m())return n.m();else if(n.bu())return n.bu().c();return null},n,null,!0);case"TaskDueDate":var o=this;return new _y.bR(i,function(n){if(_g.F.isInstanceOfType(n)&&n.e())return n.e();else if(n.bu())return n.bu().b();return null},n,null,!0);case"ItemClass":var s=this,r=this;return new _y.bp(t,function(n){return n.bl.ItemClass},function(n){return $a(n)?"":n.startsWith("IPM.Note")?_nbs.a.BR:n.startsWith("IPM.Task")?_nbs.a.UM:_nbs.a.fS},_u.R.dg);case"TaskStatus":var u=this,f=this;return new _y.bp(t,function(n){if(_g.F.isInstanceOfType(n))return n.h();else if(n.bu())return n.bu().e()?"Completed":"NotStarted";return null},function(n){var t=new _d.cF;return t.a(n,!0)},_u.R.dg);default:return _lv.g.prototype.fY.call(this,n)}},fo:function(n,t){var r=this.ej(t);var u=!!r;var i=this;this.dG.l(this.dq,this.h(),function(){if(u){i.dK(null);i.dK(r)}i.em()},null)},fv:function(n,t){if(!$a(this.dJ)){if(!_g.s.b(this.dn.d(),this.dJ)){var i=n;if(i&&i.length>0){var u=this.ej(i);var r=new _h.bh(i,this.dJ,0);this.dK(null);this.dK(u);OwaApplication.a.a(r)}}this.em()}},hz:function(){if(this.dA)if(_g.F.isInstanceOfType(this.dA)){var n=this.dA;var t=n.h()==="Completed"?"Today":"MarkComplete";this.fB(t,[n],0)}else _lv.a.prototype.hz.call(this)},fB:function(n,t,i){if(t){var h=t.length;if(!h)return;for(var e=[],o=[],s=0;s<h;s++){var r=t[s];if(_g.F.isInstanceOfType(r)){if(r.s()){_a.M.a(_u.R.Xx,1);return}Array.add(e,r)}else Array.add(o,r)}if(e.length>0){var u=new _c.bw(n,this.h(),this.er());u.f(e);this.gS=u;u.z(this.fI);OwaApplication.a.a(u)}if(o.length){var f=new _h.bA(n,this.h());f.f(o);f.e=this.er();this.gS=f;OwaApplication.a.a(f);this.eY()}else this.eY()}},gX:function(){return"Sort by"},fX:function(n){return n.c(this)},iN:function(){_lv.a.prototype.iN.call(this);var n=this;this.eh.apcl("IsShown",function(t,i){if(n.eh.i&&n.dA){var r=n.eh.h.x[n.eh.h.x.length-1];r.c(_g.F.isInstanceOfType(n.dA))}})},gI:function(){var n=this.m();n&&this.fB("MarkComplete",n,0)},hG:function(){var n=this.m();n&&this.fB("Today",n,0)},hD:function(n){$a(this.cD)||this.cD.d()}};_d.bO=function(n,t,i,r,u,f,e,o,s){this.h=n;this.i=t;this.a=i;this.e=r;this.g=u;this.f=f;this.b=e;this.d=o;this.c=s};_d.bO.prototype={h:null,i:null,a:null,g:null,e:null,f:null,b:null,d:null,c:null,j:function(){return new _d.K(this.h,this.i,this.a,this.e,this.g,this.f,this.b,this.d,this.c)}};_d.L=function(n,t,i){_d.L.initializeBase(this);this.g(!1);this.h=t;this.f=i;this.c=!!i&&i.a().e().Enabled};_d.L.prototype={f:null,d:0,b:!1,e:null,a:null,h:null,k:function(){return this.b?_u.R.Nq:_u.R.Nt},g:function(n){if(this.b!==n){this.b=n;this.dU("IsExpanded","FolderPaneExpandCollapseButtonLabel")}this.m(this.b?this.c?_d.L.c:_d.L.b:_d.L.a);return n},c:!1,m:function(n){if(this.d!==n){this.d=n;this.dQ("Width")}return n},l:function(){this.a=new _d.bN(this.h,this.f,!0,!1);this.a.f()}};_d.cW=function(){_d.cW.initializeBase(this,[!1])};_d.cW.prototype={g:function(n){var t=this.d.m;return new _h.C(t,this.f)},w:function(){this.c.a(new _d.M(_nbs.a.Yl,_nbs.a.RI,_u.R.Vk,_u.R.VP,"Ascending",11,"TaskDueDate",!0));this.c.a(new _d.M(_nbs.a.gP,_nbs.a.Rt,_u.R.Vk,_u.R.VP,"Ascending",10,"TaskStartDate",!0));this.c.a(new _d.M(_nbs.a.v,_nbs.a.mR,_nbs.a.Lb,_nbs.a.kh,"Ascending",12,"TaskStatus",!0));this.c.a(new _d.M(_u.R.Vo,_u.R.Jo,_u.R.LX,_u.R.Wn,"Ascending",8,"Subject",!0));this.c.a(new _d.M(_u.R.bG,_u.R.Sn,_u.R.IP,_u.R.ON,"Descending",4,"HasAttachments",!0));this.c.a(new _d.M(_u.R.MT,_u.R.Wd,_u.R.Yn,_u.R.WO,"Descending",5,"Importance",!0));this.c.a(new _d.M(_u.R.RH,_u.R.Dv,_u.R.Qu,_u.R.aF,"Ascending",6,"ItemClass",!0))}};_d.cX=function(n,t){this.b=n;this.c=!!t&&t.a().e().Enabled};_d.cX.prototype={b:null,c:!1,a:function(n,t){return this.c?new _d.by(this.b,n,t):new _d.S(this.b,n,t)}};_d.M=function(n,t,i,r,u,f,e,o){_d.M.initializeBase(this,[n,t,i,r,u,f,e,e,o]);this.m=e};_d.M.prototype={m:"FolderId"};_d.m=function(){_d.m.initializeBase(this)};_d.m.prototype={b:function(){return this.dS(_d.m.c)},j:function(n){this.dR(_d.m.c,n);return n},c:function(){return this.dS(_d.m.d)},e:function(n){this.dR(_d.m.d,n);return n},g:function(){return this.dS(_d.m.a)},h:function(n){this.dR(_d.m.a,n);return n},d:function(){return this.dS(_d.m.f)},f:function(n){this.dR(_d.m.f,n);return n},a:function(){return this.dS(_d.m.b)},i:function(n){this.dR(_d.m.b,n);return n},V:function(){return this.c()?null:[this.d()]},bP:function(){return null},br:function(){return null},cv:function(){return this.dS(_d.m.e)},bQ:function(n){this.dR(_d.m.e,n);return n}};_d.k=function(n,t,i,r,u,f){this.ca=Function.createDelegate(this,this.cO);this.by=Function.createDelegate(this,this.cN);this.bz=Function.createDelegate(this,this.cP);this.bP=Function.createDelegate(this,this.ce);this.bb=Function.createDelegate(this,this.cK);this.bx=Function.createDelegate(this,this.cJ);this.bY=Function.createDelegate(this,this.cL);this.bZ=Function.createDelegate(this,this.cM);this.bw=Function.createDelegate(this,this.cI);this.cc=Function.createDelegate(this,this.bs);this.bT=Function.createDelegate(this,this.cp);this.bW=Function.createDelegate(this,this.cD);this.bR=Function.createDelegate(this,this.cn);this.bU=Function.createDelegate(this,this.cr);this.bX=Function.createDelegate(this,this.cH);this.bO=Function.createDelegate(this,this.cm);this.cb=Function.createDelegate(this,this.cQ);this.bS=Function.createDelegate(this,this.co);this.cd=Function.createDelegate(this,this.bK);this.bV=Function.createDelegate(this,this.cs);this.k=this.c;_d.k.initializeBase(this);this.C=n;this.K=t;this.bf=i||null;this.bC=r;this.bi=u;this.bg=f;this.bF=new _C(this.bV,_d.k.a);this.X=new _C(this.cd,_d.k.a);this.P=new _C(this.bS,_d.k.a);this.W=new _C(this.cb,_d.k.a);this.bc=new _C(this.bO,_d.k.a);this.bq=new _C(this.bX,_d.k.a);this.be=new _C(this.bU,_d.k.a);this.bD=new _C(this.bR,_d.k.a);this.G=new _C(this.bW,_d.k.a);this.bE=new _d.bM(this.X,this.bc,this.P,this.W);this.H=new _bc.b;this.Y=new _d.R;this.B()&&this.cj();this.C.k(this.bT);this.C.i(this.cc);this.bB=!!u&&u.a().e().Enabled;this.bA=!!u&&u.a().f().Enabled};_d.k.prototype={bf:null,bi:null,bg:null,C:null,K:null,A:null,y:!1,bl:!1,w:null,x:null,V:!1,bk:!0,z:!1,bv:!1,U:!1,bF:null,X:null,P:null,W:null,bc:null,bq:null,be:null,bD:null,bI:null,E:null,I:null,F:null,H:null,G:null,bj:null,L:null,R:null,D:null,Y:null,bN:null,bJ:null,S:!1,bp:!1,T:!1,N:null,bC:null,bh:null,bG:null,bE:null,l:function(n){this.dV("NewTaskClosed",n)},m:function(n){this.dV("TaskDelete",n)},o:function(n){this.dV("TaskEditing",n)},ci:function(){return this.K.f()},cg:function(){return this.w?this.w.c:null},bt:function(n){if(this.T!==n){this.T=n;this.dQ("IsSaving")}return n},M:function(n){if(this.V!==n){this.V=n;this.dU("Loading","HideTaskForm")}return n},cl:function(n){if(this.bk!==n){this.bk=n;this.dQ("HideTaskForm")}return n},cv:function(){return this.V||!this.bk},b:function(){return this.z},J:function(n){if(this.z!==n){this.z=n;this.dQ("IsEditMode");this.ea("TaskEditing",this,n);if(this.z){this.bl&&this.bs();this.w&&(this.bN=new _a.ev(this.w))}}return n},g:function(n){if(this.y!==n){this.y=n;this.dQ("IsNewTask");if(this.y){this.x=null;this.ck();this.J(!0)}}return n},bM:function(n){if(this.U!==n){this.U=n;this.dQ("IsShowDetails");this.bs()}return n},cu:function(){return this.C.a()!=="Mouse"},a:function(n){if(this.x!==n){_a.k.b(_d.k.a,"TasksOpen.ItemOpen");this.x&&this.x.remove_onCacheOperation(this.bw);this.x=n;this.dQ("CurrentTask");this.x&&this.x.add_onCacheOperation(this.bw);this.g(!1);this.ck()}return n},bu:function(n){if(this.w!==n){this.w=n;this.dQ("TaskViewModel");this.dQ("IsReadOnly")}return n},bL:function(n){this.bG=n;this.dQ("EditorCallContext");return n},cf:function(){if(!this.bj){var n=this;this.bj=new _C(function(){n.bL(new _cmc.A)},_d.k.a)}return this.bj},cC:function(){if(!this.E){this.E=new _js.f;this.E.a("NotStarted");this.E.a("InProgress");this.E.a("Completed");this.E.a("WaitingOnOthers");this.E.a("Deferred")}return this.E},cB:function(){if(!this.I){this.I=new _js.f;this.I.a("High");this.I.a("Normal");this.I.a("Low")}return this.I},ct:function(){if(!this.F){this.F=new _js.f;this.F.a(0);this.F.a(1);this.F.a(2);this.F.a(3)}return this.F},B:function(){return!this.C.c()},d:function(n){if(this.S!==n){this.S=n;this.dQ("IsDiscoveryMode");this.dQ("IsReadOnly")}return n},e:function(n){if(this.bp!==n){this.bp=n;this.dQ("IsItemAttachment");this.dQ("IsReadOnly")}return n},bH:function(){var n=!1;this.w&&this.w.a&&this.w.a.s()&&(n=!0);return this.S||n||this.bp},cw:function(){return!this.B()&&this.bA},n:function(){return this.A},f:function(n){this.A=n;return n},bn:function(){return!1},cR:function(n){if(this.D!==n){this.D=n;this.dQ("ComposeRecurrenceViewModel")}return n},bm:function(){return 1},q:function(){return null},ch:function(){if(this.z){this.G&&this.G.a();return this.bN.c.length>0||this.w.i.b()!==this.w.a.r()||this.w.j.b()!==this.w.a.y()||!_g.bH.a(this.w.p.b(),this.w.a.F())||this.w.d.bq()||this.w.l}else return!1},h:function(n){this.bJ=n;return n},bB:!1,bA:!1,c:function(n){if(!this.H.j)if(this.ch()){var t=this;this.H.a(2,_nbs.a.Nh,function(i,r){if(i){t.B()&&(t.bv=!0);t.Q()}n&&n(i)},!1,_u.R.YW,_nbs.a.dW,_nbs.a.ER)}else if(n){this.z&&this.Q();n(!0)}},t:function(n){this.bI=n;this.cj()},r:function(){var n=new _c.i(500,[this.x.bl.ItemId],0,this.S);n.w(this.bZ);n.v(this.bY);this.M(!0);OwaApplication.a.a(n)},cx:function(){_y.hJ.prototype.cx.call(this);this.bl=!0;this.y&&this.bs()},cy:function(){_y.hJ.prototype.cy.call(this);this.bl=!1},p:function(n){return this.bE.g(n,this.y)},cE:function(){var n={};if(this.x.bv()&&this.x.bv().b()>0){var t=this.x.bv().f();n["Tasks reading pane item categories"]=t}return n},ck:function(){this.M(!1);this.J(!1);this.y?this.bd():this.x?!this.x.v()&&this.x.bC()&&this.x.bC().bl.Value?this.bd():this.r():this.bu(null)},cI:function(n,t){var i=t;i.a!=="NeedsUpdate"||this.z||this.r()},cL:function(n){this.M(!1);this.cl(!1);var t=[_nbs.a.lP,n.t.message];_a.M.b(t,0,this.A)},cM:function(n){var t=n;if(this.x&&t.e.length===1&&t.e[0].Id===this.x.bl.ItemId.Id){var i=_h.e.a().a(this.x.bl.ItemId.Id);this.x=i;this.x.p(!1);this.bd();this.M(!1);this.cl(!0)}},bd:function(){this.bu(new _d.cv(this.x,this.bC,this.C,!1));this.bM(this.w.T());this.w.apcl("DueDate",this.bx);this.w.apcl("Status",this.bx);this.w.apcl("ReminderIsSet",this.bb);this.w.apcl("ReminderDueBy",this.bb);this.w.apcl("IsPrivate",this.bb);this.cG();this.y?_a.k.a("TasksCompose.New"):_a.k.a("TasksOpen.ItemOpen")},cK:function(n,t){this.bH()||this.z||this.bK()},cJ:function(n,t){this.w.Z()},cF:function(){this.N=new _y.ci(this.ci(),this.bP,this.bD,this.bI)},cn:function(){this.ce(null,null,!0,null)},cD:function(){this.bL(new _cmc.b(!1))},ce:function(n,t,i,r){var f=_g.bs.a(this.x.bv(),i,t?t.bl.Name:null,n?n.bl.Name:null);if(f){var u=new _h.ci([f],null,null);u.f([this.x]);OwaApplication.a.a(u)}},cs:function(){this.J(!0)},bK:function(){if(this.w.bd())if(this.T){_js.Trace.logInfo(_d.k.a,"TaskReadingPaneViewModel.SaveTask has been called while a save operation is in progress. Ignoring...");return}else this.bt(!0);else{this.H.a(0,this.w.k,null);return}this.G&&this.G.a();this.y&&!this.w.l?this.cq():this.cT(this.w.l)},cq:function(){var i=this.w.U();var t=new _c.R(i,this.bJ);var n=this;t.w(function(i){n.bu(null);n.J(!1);n.g(!1);n.bt(!1);n.M(!0);n.B()?n.A&&n.A():n.ea("NewTaskClosed",n,t.a)});t.v(this.bz);OwaApplication.a.a(t)},cT:function(n){var r=this.w.U();var i=new _c.bm(r);var t=this;i.w(function(i){t.J(!1);t.bt(!1);t.M(!0);if(t.B()){t.x&&_h.d.a(t.x,"NeedsUpdate",t.x.v(),!0,function(n,t){n.p(t)});t.A&&t.A()}else if(n){var r=t.w?t.w.a.bl.ItemId:null;t.ea("NewTaskClosed",t,r)}else t.r()});i.v(this.bz);OwaApplication.a.a(i)},cP:function(n){var t=n;if(t&&t.t){this.cg().e(this.w.V());var i=_y.t.c(t.t,41,51,63,700,88,89,42,41);this.cg().a(i);this.bt(!1)}},co:function(){var n=this;this.c(function(t){t&&n.Q()})},Q:function(n){this.J(!1);if(this.w&&this.w.l&&!n){var t=new _js.f;t.a(this.w.a);this.Y.l(t,null,null,null)}if(this.y){this.bu(null);this.ea("NewTaskClosed",this,null)}else this.bd();this.g(!1);this.B()&&this.A&&this.A()},cQ:function(){if(this.w.d.g()){this.H.a(0,_nbs.a.Ig,null);return}var t={};this.y||(t.ItemID=this.x.bl.ItemId);var n=new _d.m;n.f(this.x);n.j(this.z);n.e(this.y);if(this.z){this.G&&this.G.a();n.h(this.w.bm());n.i(this.w.l);if(n.a()){n.e(!1);n.f(this.w.a)}}this.C.g(ITaskReadingPaneViewModelPopOutFactory,null,t,_bc.c.a(),n,!1);this.Q(!0)},cm:function(){if(this.bi&&this.bi.a().v().Enabled&&this.K&&this.K.p()&&this.K.p().AttachmentDataProviderAvailable){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_js.Trace.logInfo(_a.a.k,"Opening OWA's file picker from calendar compose");this.cS(n)}else{_js.Trace.logInfo(_a.a.a,"Opening OS's file picker");this.w.d.e(!1,null,null)}},cS:function(n){if(this.bg){var t=this;this.bg.a(function(i){t.bh=i;if(t.bh){var r=t.C;t.bh.a(t.w.d,n,!0,r.w||(r.w=Function.createDelegate(r,r.d)),null,!1)}})}},cH:function(){this.w.C(_a.c.a().f());this.bK()},cj:function(){this.cF();this.L=new _fm.f([new _fm.d(_u.R.WR,null,this.be),this.N.c()]);this.B()||this.L.h.a(new _fm.d(_u.R.NX,null,this.W));this.R=new _fm.f([new _fm.d(_u.R.WR,null,this.be),this.N.c(),new _fm.d(_nbs.a.Vy,null,this.bq)]);this.L.apcl("IsShown",this.by);this.R.apcl("IsShown",this.by)},cN:function(n,t){(this.L.i||this.R.i)&&this.N.a(this.cE(),1)},cr:function(){if(!this.bH())if(this.B()){var n=new _js.f;n.a(this.x);this.Y.l(n,this.x.bl.ParentFolderId,null,this.A)}else this.ea("TaskDelete",this,this.x)},cG:function(){this.cR(new _cm.l(this.w.p,this.K.a().x(),new _bc.b,this.C));this.D.apcl("RecurrenceSelected",this.ca);this.D.g(!1)},cO:function(n,t){this.D.d&&!_cc.D.isInstanceOfType(this.D.d)&&this.D.g(!0)},cp:function(n){if(!this.bv&&this.ch()){n.a(_nbs.a.Nh);!this.B()&&this.bf&&this.bf.a(_y.s,new _y.s(3,null))}else this.bv=!1},bs:function(){this.cf()&&this.cf().a()}};_d.ct=function(n,t,i,r,u,f){this.f=n;this.g=t;this.c=i;this.b=r;this.e=u;this.d=f};_d.ct.prototype={f:null,g:null,c:null,b:null,e:null,d:null,a:function(){return new _d.k(this.f,this.g,this.c,this.b,this.e,this.d)}};_d.cu=function(n,t,i,r,u,f){this.g=n;this.h=t;this.d=i;this.c=r;this.f=u;this.e=f};_d.cu.prototype={g:null,h:null,d:null,c:null,f:null,e:null,b:function(n,t,i){var f=n.ItemID;var r=new _d.k(this.g,this.h,this.d,this.c,this.f,this.e);if($a(f))r.g(!0);else{var o=new _g.g(f);var u=new _g.F;u.bL(o);_h.e.a().b(f,u);r.a(u)}var e=n.DiscoveryMode;!$a(e)&&Boolean.parse(e)&&r.d(!0);return r},a:function(n,t,i){var u=n;var r=new _d.k(this.g,this.h,this.d,this.c,this.f,this.e);var f=this;r.apcl("TaskViewModel",function(n,t){if(u.b()&&r.w){r.J(u.b());r.w.bl(u.g());r.w.l=u.a();r.bM(r.w.T())}});r.a(u.d());r.g(u.c());return r}};_d.cv=function(n,t,i,r){this.N=Function.createDelegate(this,this.bi);this.L=Function.createDelegate(this,this.bg);this.P=Function.createDelegate(this,this.bj);this.K=Function.createDelegate(this,this.bf);this.M=Function.createDelegate(this,this.bh);this.Q=Function.createDelegate(this,this.bk);this.J=Function.createDelegate(this,this.be);_d.cv.initializeBase(this);this.G=i;this.A=r;this.a=n?n:_d.cv.a();this.ba(this.a);this.bq(new _y.t);this.Z();this.x=new _a.ev(this.a);if(t){var u=this;t.a(function(n){if(r)u.H(n.a(u.a.bl.ItemId,u.a.U()?u.a.U().c:new _js.f,!1,!0,null,!0,u.c,null));else{u.F=n.a(u.a.bl.ItemId,u.a.U()?u.a.U().c:new _js.f,!0,!0,null,!0,null,null);u.H(n.d(u.a.bl.ItemId,u.a.U()?u.a.U().c:new _js.f,!1,3,!0,null,!0,new _y.t,null))}u.d.p(u.J)})}this.apcl("Status",this.Q);this.apcl("PercentComplete",this.M);this.apcl("CompleteDate",this.K);this.apcl("StartDate",this.P);this.apcl("DueDate",this.L);this.apcl("ReminderIsSet",this.N)};_d.cv.a=function(){var n=new _g.F;n.dr("Normal");n.cl(new _g.w(new _g.G("Text","")));return n};_d.cv.prototype={G:null,A:!1,l:!1,t:null,n:null,r:null,w:null,m:null,q:!1,v:!1,e:null,g:null,o:"Low",h:"NotStarted",f:null,R:null,b:null,a:null,j:null,i:null,y:null,E:null,c:null,F:null,d:null,p:null,k:null,S:null,B:null,x:null,bv:function(n){if(this.y!==n){this.y=n;this.dQ("Subject")}return n},bq:function(n){if(this.c!==n){this.c=n;this.dQ("InfoBarViewModel")}return n},X:function(n){if(!_a.c.c(this.b,n)){this.b=n;this.dQ("DueDate")}return n},Y:function(n){if(!_a.c.c(this.f,n)){this.f=n;this.dQ("StartDate")}return n},z:function(n){if(this.h!==n){this.h=n;this.dQ("Status")}return n},bp:function(n){if(this.o!==n){this.o=n;this.dQ("Importance")}return n},C:function(n){if(!_a.c.c(this.g,n)){this.g=n;this.dQ("CompleteDate")}return n},I:function(n){if(this.e!==n){this.e=n;this.dQ("PercentComplete")}return n},br:function(n){if(this.v!==n){this.v=n;this.dQ("IsPrivate")}return n},bu:function(n){if(this.q!==n){this.q=n;this.dQ("ReminderIsSet")}return n},D:function(n){if(!_a.c.c(this.m,n)){this.m=n;this.dQ("ReminderDueBy")}return n},bs:function(n){if(this.w!==n){this.w=n;this.dQ("Mileage")}return n},bn:function(n){if(this.r!==n){this.r=n;this.dQ("BillingInformation")}return n},bo:function(n){if(this.n!==n){this.n=n;this.dQ("Companies")}return n},W:function(n){if(this.t!==n){this.t=n;this.dQ("Body")}return n},bt:function(n){this.B!==n&&(this.B=n);return n},T:function(){return!!this.f||this.h!=="NotStarted"||this.o!=="Normal"||!!this.g||_a.bH.a(this.e)>0||this.v||this.q||!!this.m||this.j.b()>0||this.i.b()>0||!_js.d.a(this.w)||!_js.d.a(this.r)||!_js.d.a(this.n)||!!this.p.b()},bd:function(){var t=!0;if(this.d.g()){this.k=_nbs.a.Ig;return!1}if(_js.d.b(this.y)){this.k=_nbs.a.hm;return!1}if(this.b&&this.f&&this.f.b(this.b)>0){this.k=_nbs.a.RJ;return!1}var n=_a.bH.a(this.e);if(isNaN(n)||n<0||n>100){this.k=_nbs.a.Oq;return!1}if(isNaN(_a.bH.a(this.j.a))||_a.bH.a(this.j.a)<0){this.k=_nbs.a.Nk;return!1}if(isNaN(_a.bH.a(this.i.a))||_a.bH.a(this.i.a)<0){this.k=_nbs.a.gs;return!1}if(this.j.b()>1525252319){this.k=_nbs.a.HG;return!1}if(this.i.b()>1525252319){this.k=_nbs.a.XS;return!1}return t},U:function(){this.bb(this.a);return this.x},H:function(n){if(this.d!==n){this.d=n;this.dQ("EditAttachmentWellViewModel")}return n},bm:function(){var n=this.a.K();this.bb(n);return n},bl:function(n){this.ba(n)},V:function(){this.E||(this.E=[41,42,51,63,700,88,89,10020,10030,10040,10050,10060,10070,10080,10010]);return this.E},Z:function(){this.c.e(this.V());if(!this.A){this.a.s()&&this.c.a(10010);if(this.h==="Completed")this.c.a(10080,this.g.a(1));else if(this.b){var t=_a.ct.a(_a.c.a().f(),this.b.f()).a/864e5;var n=Math.floor(t);n?n===1?this.c.a(10040):n>1&&n<15?this.c.a(10050,n.toString()):n===-1?this.c.a(10030):n<-1&&n>-15?this.c.a(10070,Math.abs(n).toString()):n<-14&&this.c.a(10060):this.c.a(10020)}}},ba:function(n){this.y=n.bl.Subject;this.R=n.L()?n.L().v():null;this.b=n.e()?n.e().v():null;this.f=n.m()?n.m().v():null;this.h=n.h();this.o=n.bB();this.g=n.g()?n.g().v():null;this.e=n.bl.PercentComplete?n.bl.PercentComplete:"0";isNaN(_a.bH.a(this.e))&&(this.e="0");this.v=n.bH()==="Private";this.q=n.bl.ReminderIsSet;this.m=n.eI()?n.eI().v():null;this.w=n.bl.Mileage;this.r=n.bl.BillingInformation;this.bt(n.B());var t=n.z()?n.z().bl.Value:"";_js.d.a(t)&&!this.A&&(t="<html><head></head></html>");if(this.A){var u;var f,e;e=_a.u.g(t,f={val:u}),u=f.val,e;t=u.trim()}this.W(t);var r=new Sys.StringBuilder;if(!$a(n.f()))for(var i=0;i<n.f().b();i++){r.append(n.f().a(i));i!==n.f().b()-1&&r.append(" ")}this.n=r.toString();this.j=new _d.bw(n.y());this.i=new _d.bw(n.r());this.p=new _cc.cm(n.K(),new _g.Qv,_a.c.a(),null)},bb:function(n){n.bR(this.y);_a.c.c(n.e(),this.b)||n.R(this.b);_a.c.c(n.m(),this.f)||n.V(this.f);n.h()!==this.h&&n.q(this.h);n.bB()!==this.o&&n.dr(this.o);_a.c.c(n.g(),this.g)||n.E(this.g);n.bl.PercentComplete!==this.e&&n.J(this.e);var r=this.v?"Private":"Normal";n.bH()!==r&&n.cN(r);n.cM(this.q);_a.c.c(n.eI(),this.m)||n.iv(this.m);n.T(this.w);n.P(this.r);n.bh(this.B);if(n.z()&&n.z().bl.Value!==this.t){var i;i=this.G.a()!=="Mouse"?new _g.G("Text",this.t):new _g.G("HTML",this.t);var u=new _g.w(i);n.cl(u)}var t=new(_a.gd.$$(String));_js.d.a(this.n)||t.e(this.n);this.bc(n.f(),t)||n.bc(t);n.y()!==this.j.b()&&n.W(this.j.b());n.r()!==this.i.b()&&n.N(this.i.b());n.h()!=="Completed"&&this.x.b("CompleteDate");if(this.x.a("CompleteDate")){this.x.b("Status");this.x.b("PercentComplete")}_g.bH.a(n.F(),this.p.b())||n.bk(this.p.b())},bc:function(n,t){if(n)if(t){if(n.b()!==t.b())return!1}else return!n.b();else return!t||!t.b();for(var i=0;i<n.b();i++)if(n.a(i)!==t.a(i))return!1;return!0},bk:function(n,t){if(this.h==="Completed"){this.g||this.C(_a.c.a().f());this.I("100")}else{this.C(null);(this.h==="NotStarted"||_a.bH.a(this.e)===100)&&this.I("0")}},bh:function(n,t){var i=_a.bH.a(this.e);i?i>0&&i<100?this.z("InProgress"):i===100&&this.z("Completed"):this.z("NotStarted")},bf:function(n,t){this.g?this.z("Completed"):this.z("NotStarted")},bj:function(n,t){this.f&&(!this.b||this.b.b(this.f)<0)&&this.X(this.f)},bg:function(n,t){this.b||this.Y(null)},bi:function(n,t){if(this.q&&!this.m){var i=_a.c.a();this.b?this.b.k(i)<=0?this.D(new _a.c(i.e(),i.d(),i.i(),8,0,0)):this.D(new _a.c(this.b.e(),this.b.d(),this.b.i(),8,0,0)):this.D(new _a.c(i.e(),i.d(),i.i(),8,0,0).c(1))}},be:function(){if($a(this.a.bl.ItemId)){var i=new _a.ev(this.a);var t=new _c.R(i,this.S);var n=this;t.z(function(i){n.a.bL(t.a);n.l=!0;$a(n.d)||n.d.d(n.a.bl.ItemId,n.a.U()?n.a.U().c:new _js.f,null)});OwaApplication.a.a(t)}else this.l&&($a(this.d)||this.d.d(this.a.bl.ItemId,this.a.U().c,null))}};_d.bw=function(n){_d.bw.initializeBase(this);this.d(n)};_d.bw.prototype={c:0,a:null,e:function(n){if(this.a!==n){this.a=n;this.bj("WorkAmount")}return n},f:function(n){if(this.c!==n){this.c=n;this.bj("WorkUnit")}return n},b:function(){var n=_a.bH.a(this.a);switch(this.c){case 1:n*=60;break;case 2:n*=480;break;case 3:n*=2400;break}return Math.floor(n)},toLocaleString:function(){var n=new _d.bS;var t=_a.bH.a(this.a)===1?n.a(this.c,1):n.a(this.c,2);return String.format(_nbs.a.Oh,this.a,t)},bd:function(n){if(!n||!_d.bw.isInstanceOfType(n))return!1;var t=n;return this.b()===t.b()},d:function(n){this.a=n.toString();this.c=0;if(n){if(n>0){for(var r=[1,60,480,2400],f=[10,4],t=0;t<r.length-1&&n>=r[t+1];)t++;while(t>0){for(var i=0;i<f.length;i++)for(var u=1;u<=f[i];u++)if(!(n%(r[t]*u/f[i]))){this.a=(n/r[t]).toString();this.c=t;return}t--}}}else this.c=1}};_d.f=function(n){this.i=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.w);this.h=Function.createDelegate(this,this.r);this.n=Function.createDelegate(this,this.H);this.k=Function.createDelegate(this,this.F);this.m=Function.createDelegate(this,this.p);this.l=Function.createDelegate(this,this.G);_d.f.initializeBase(this);this.e=n;this.K(new _C(this.l,_d.f.a));this.L(new _C(this.m,_d.f.a));this.J(new _C(this.k,_d.f.a));this.c=new _bc.b;this.q(_g.a.a().c().bl.PlayOnPhoneDialString);this.f()};_d.f.prototype={a:null,e:null,c:null,C:function(){return this.dS(_d.f.h)},K:function(n){this.dR(_d.f.h,n);return n},D:function(){return this.dS(_d.f.i)},L:function(n){this.dR(_d.f.i,n);return n},B:function(){return this.dS(_d.f.f)},J:function(n){this.dR(_d.f.f,n);return n},x:function(){return this.dS(_d.f.b)},g:function(n){this.dR(_d.f.b,n);return n},y:function(){return this.dS(_d.f.d)},d:function(n){this.dR(_d.f.d,n);return n},A:function(){return this.dS(_d.f.g)},I:function(n){this.dR(_d.f.g,n);return n},o:function(){return this.dS(_d.f.c)},q:function(n){this.dR(_d.f.c,n);return n},z:function(){return this.dS(_d.f.e)},b:function(n){this.dR(_d.f.e,n);return n},t:function(){$a(this.a)||this.p()},H:function(n){if(n.EventType!=="Reload"){var t=n;this.b(this.E(t.callState));(t.callState==="Disconnected"||t.callState==="Idle")&&this.f()}},M:function(){var n=new _g.be;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.a;var t=new _h.J(n);t.l(_d.f.a,"PlayOnPhoneNotification",this.n,1)},N:function(){var n=new _g.be;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.a;var t=new _h.J(n);t.t()},G:function(){this.b(_nbs.a.dt);var n=new _c.bJ(this.e.bl.ItemId.Id,this.o());this.d(!0);n.w(this.h);n.v(this.j);OwaApplication.a.a(n)},p:function(){var n=new _c.bK(this.a);this.b(_nbs.a.JZ);n.z(this.i);OwaApplication.a.a(n)},F:function(){this.I(!0)},r:function(n){this.a=n.d.PhoneCallId.Id;this.g(!1);this.M()},w:function(n){var i=n;var t=_nbs.a.cY;if(i.A&&i.A.Body){var r=i.A.Body.ResponseCode;switch(r){case"ErrorInvalidId":case"ErrorInvalidIdMalformed":t=_nbs.a.gp;break;case"ErrorPhoneNumberNotDialable":t=_nbs.a.FO;break;case"ErrorIPGatewayNotFound":t=_nbs.a.JS;break;case"ErrorInvalidPhoneNumber":case"ErrorInvalidSIPUri":t=_nbs.a.gI;break}}this.b("");this.c.a(0,t,null);this.g(!0);this.d(!1)},E:function(n){switch(n){case"Idle":case"Disconnected":return"";case"Connecting":return _nbs.a.dt;case"Connected":return _nbs.a.XU;default:throw Error.invalidOperation("Invalid Call State.");}},v:function(n){this.f()},f:function(){if(!$a(this.a)){this.N();this.a=""}this.g(!0);this.b("");this.d(!1)}};_d.s=function(n,t,i){_d.s.initializeBase(this);_a.b.b(t,"nativeBridge");this.w(n);this.f=!1;this.m=_g.a.a().c().bl.IsRequireProtectedPlayOnPhone;this.i=t;this.j=i;this.x(new _d.f(n));this.A()};_d.s.prototype={m:!1,i:null,j:null,f:!1,n:!1,g:null,r:null,q:!1,e:function(){return this.dS(_d.s.a)},w:function(n){this.dR(_d.s.a,n);return n},v:function(){return this.dS(_d.s.c)},z:function(n){this.dR(_d.s.c,n);return n},o:function(){return this.dS(_d.s.b)},x:function(n){this.dR(_d.s.b,n);return n},l:function(){var n=!1;this.k()&&this.f&&!this.h()&&(this.t()||this.i.b(this.i.o()))&&(n=!0);return n},p:function(){return!this.h()&&this.k()&&!this.l()&&_a.UserAgent.getInstance().bi},b:function(){return this.g},k:function(){return _g.h.s(this.e().bl.ItemClass)},y:function(n){this.n=n;this.dQ("SignalCleanup");return n},h:function(){return this.m&&_g.h.g(this.e().bl.ItemClass)},a:function(n){this.r=n;return n},d:function(n){this.q=n;return n},t:function(){return _a.UserAgent.getInstance().X},c:function(){this.y(!0);this.o().t()},A:function(){if(this.e().U())for(var t=0;t<this.e().U().b();t++){var n=this.e().U().a(t);if(n.bl.Name===this.e().p()){if(!this.h()){var i=this.j.a(n.bl.AttachmentId,!1,null);this.z(new _d.cw(n,i,this.e().bl.ItemId.Id));this.f=_g.h.g(this.e().bl.ItemClass)?!0:n.bl.ContentType==="audio/mp3"?!0:!1}if(this.l()||this.p()){this.g=new Array(1);this.g[0]=n.bl.AttachmentId.Id}break}}}};_d.cx=function(n,t){this.c=n;this.b=t};_d.cx.prototype={c:null,b:null,a:function(n){return new _d.s(n,this.c,this.b)}};_d.bI=function(n){this.c=n};_d.bI.prototype={c:null,a:function(n,t,i){return new _d.j(n,t,i,this.c,_g.a.a().c().bl.UserEmailAddress,!0,!1)},b:function(n,t,i,r){return new _d.j(t,i,r,this.c,n,!1,!0)}};_d.bH=function(){};_d.bH.prototype={t:null,n:!1,o:null,m:!1,p:!1,q:!1,s:null,r:0,l:null,b:function(){return this.n},h:function(n){this.n=n;return n},c:function(){return this.o},f:function(){return this.m},d:function(){return this.p},e:function(){return this.q},a:function(){return this.s},j:function(n){this.s=n;return n},g:function(){return this.r},i:function(n){this.r=n;return n},k:function(){this.l||(this.l=new _d.cN);return this.l}};_d.bs=function(n,t,i,r,u,f,e,o,s,h){this.ck=Function.createDelegate(this,this.ca);this.cn=Function.createDelegate(this,this.bl);this.cm=Function.createDelegate(this,this.bI);this.cl=Function.createDelegate(this,this.cF);this.co=Function.createDelegate(this,this.dc);this.bS=Function.createDelegate(this,this.cP);_d.bs.resolveInheritance();this.C=this.n;_d.bs.initializeBase(this,[n,t,i,r,u,f,e,o,s,h]);_a.b.g(t,0,"mode");this.bq.k(this.bS);this.bJ=this.bu===1||this.bu===3?!0:!1};_d.bs.prototype={bc:null,bL:null,bH:null,bh:null,bk:!1,be:!1,bi:null,bj:!1,cc:null,cD:null,bJ:!1,Q:function(n){this.dV("EditCompleted",n)},W:function(n){this.dW("EditCompleted",n)},t:function(){return this.bc.f()},R:function(){return this.bc.e()},j:function(){return this.bq.a()!=="Mouse"?1:0},dw:function(){return this.bk},Y:function(n){if(this.bk!==n){this.bk=n;this.dQ("IsDiscardChangesDialogShown")}return n},cG:function(){if(!this.bh){this.bh=new _js.f;this.bh.a(new _ff.f(new _C(this.co,_d.bs.a),_u.P.b,null));this.bh.a(new _ff.f(new _C(this.cl,_d.bs.a),_u.R.IE,null));this.bh.a(new _ff.f(new _C(this.cm,_d.bs.a),_bcs.D.A,null))}return this.bh},cX:function(){return this.bc.g},c:function(){return this.bc.d},cu:function(){return _d.bf.prototype.cu.call(this)&&this.bu!==2},cY:function(){this.bL||(this.bL=new _y.f(_y.b.n(),_y.b.o(),_nbs.a.VI,this.t()));return this.bL},cQ:function(){this.bH||(this.bH=_y.f.a(_nbs.a.mO,this.R()));return this.bH},T:function(){return this.be},w:function(n){this.be=n;return n},U:function(){return this.bi},S:function(){return this.bj},dd:function(n){this.bJ=n;this.dQ("IsEnteringEditMode");return n},e:function(){this.db();this.c()&&this.c().Y(!0);_d.bf.prototype.e.call(this)},V:function(n){if(this.c()){this.c().X(n.c());this.c().o(n.e())}this.bc.m(n.d());var t=_js.e.s(_a.a.v,2,"SetParentFolderId");if(this.bu===3||this.bu===2)if(n.a()){this.bi=n.a();this.bj=n.b()}else{this.bi=_g.q.a("contacts").bl.FolderId;this.bj=!0}_js.e.e(t)},B:function(n){_d.bf.prototype.B.call(this,n);var t=n;this.bc.m(t.n());this.bi=t.a();this.bj=t.m()},cZ:function(n,t,i,r,u,f){if(this.bc.b){this.bc.a(!1);if(i){var s=this.cH(u);this.h().a(0,s,null);var e=null;switch(r){case 2:e=_a.k.c("SaveGroup");break;case 1:e=_a.k.c("SaveContact");break}if(e){e.k=f;e.n=i.message;_a.d.a(e)}}else if(t){var o=_pc.a.c(t,r===1?3:2);this.bK(o)}else r===2?this.bK(null):n&&this.h().a(0,_nbs.a.Yp,null)}},L:function(){this.ca()},cb:function(n){this.bK(n)},da:function(n,t){var i=n;if(i){var r=!!i.C&&!!i.C.response&&i.C.response.responseKind===-2;this.cZ(r,i.A,i.t,t,Object.getType(i)===_pc.d,i.D())}},bw:function(){this.be=!1},ca:function(){this.de()||this.cE()},bK:function(n){this.dZ("EditCompleted",n)},bE:function(){},bO:function(n,t){n.val=[this.cY(),this.cQ()];t.val=null},bA:function(){var n=new _ms.b;this.bu===2&&n.h(_nbs.a.ZU);if(_a.UserAgent.getInstance().a()){n.e(2);n.f(new _ms.a(_fm.a.a,_fm.a.a,this.R(),_u.P.J));n.g(new _ms.a(_fm.a.a,_fm.a.a,this.t(),_nbs.a.Fx));n.i.a(!0)}else{n.e(1);n.f(new _ms.a(_y.b.a(),_y.b.a(),this.R(),""));n.g(new _ms.a(_y.b.e(),_y.b.e(),this.t(),""))}return n},cH:function(n){return n?_nbs.a.aI:_nbs.a.WO},cw:function(n,t){if(this.bc.b)return!0;if(this.be){this.ca();return!0}else{this.dispose();return!1}},dT:function(){this.bq.n(this.bS);_a.jV.prototype.dT.call(this)},cP:function(n){this.be&&n.a(_nbs.a.Xx)},dc:function(){this.bc.a(!0);this.bI();this.bl()},cF:function(){this.bI();this.cE()},bI:function(){this.Y(!1)},cE:function(){this.by();this.bK(null)},de:function(){if(this.be){this.Y(!0);return!0}return!1},db:function(){this.bc=this.bY.f(this.bp,this.bu);this.bc.w(this.cn);this.bc.t(this.ck);this.bc.v(this.cp)}};_d.G=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.H=Function.createDelegate(this,this.ch);this.X=Function.createDelegate(this,this.bP);this.G=Function.createDelegate(this,this.cd);this.F=Function.createDelegate(this,this.bR);_d.G.initializeBase(this,[n,t,i,r,u,o,s,h,c,l]);_a.b.d(this.bF(),"ComposeGroupCard is only supported for PDLs. Specified persona is not a PDL.");_a.b.d(this.bq.a()==="Mouse","ComposeGroupCard is only supported for Mouse Layout.");this.D=f;this.J=e;this.I=l;this.E=!!l&&l.a().M().Enabled;this.z=a};_d.G.prototype={D:null,J:null,I:null,p:null,k:null,x:null,y:null,o:null,r:null,l:null,E:!1,z:null,bd:function(n){if(this.y!==n){this.y=n;this.dQ("CurrentMembersCountLabel")}return n},ce:function(n){if(this.k!==n){this.k=n;this.dQ("EditableMembers")}return n},cf:function(n){this.o=n;this.dQ("GroupCardProfileFieldsListViewModel");return n},cg:function(n){this.r=n;this.dQ("PickerViewModel");return n},bb:function(n){if(this.l!==n){this.l&&this.l.rpcl("IsNotesLoaded",this.F);this.l=n;this.l&&this.l.apcl("IsNotesLoaded",this.F);this.dQ("CardNotesViewModel")}return n},bF:function(){return!!this.bp.a()&&this.bp.a().RoutingType==="MAPIPDL"},V:function(n){_d.bs.prototype.V.call(this,n);this.bb(new _d.bl(this.bp,this.bs,this.bq,this.bt,n.m));this.bu===1&&this.l.d();this.bg();this.bN()},d:function(n){if(n){n.a?this.p.a(n):this.p.m(n,!0);this.be=!0}},bl:function(){_a.l.g("VM.GroupCard.Save");var n=[];var i=this.o.l();n=n.concat.apply(n,i);this.bf();this.x&&this.x.length>0&&(n=n.concat.apply(n,this.x));var r=this.r.q();n=n.concat.apply(n,r);if(n&&n.length>0){_a.k.b(_a.a.q,"SaveGroup",!0);if(this.bG())return;var t;if(this.bu===1)t=new _pc.f(this.bp.f(),n,_bc.e.toString(2),this.bp.bc());else{if(!this.bi)throw Error.argumentNull("parentFolderId","Can't create group when parent folder is undefined");t=new _pc.d(this.bp.f(),n,new _g.R(this.bi),_bc.e.toString(2),this.bj)}this.bp.G()&&(t.J=this.bp.t().a);t.w(this.G);t.v(this.G);this.bt.a(t)}else{this.be=!1;this.bc.a(!1);this.R().a()}},by:function(){this.o&&this.o.n();this.be=!1},bw:function(){_d.bs.prototype.bw.call(this);this.bb(new _d.bl(this.bp,this.bs,this.bq,this.bt));this.l.d();this.o&&this.o.e();this.r&&this.r.z()},cH:function(n){return n?_nbs.a.FK:_nbs.a.Wd},bE:function(){this.bu===1&&this.bx()},bG:function(){if(_js.d.b(this.o.d.e)){_a.M.a(_nbs.a.ag,0);this.bc.a(!1);return!0}return!1},bg:function(){this.cf(new _d.cJ(new _d.bn(this),this.I));if(this.D){var n=null;this.bu===1&&(n=this.bp.a().ItemId);this.cg(this.D.a(n,new _d.bn(this),this.bC()?"":_nbs.a.cA));this.r.C(this.bu===1);this.r.h=this.bC()}this.p=new _js.f},bx:function(){this.p?this.p.f():this.p=new _js.f;this.x=[];if(this.k){if(this.k.q){this.k.q.rpcl("TableSize",this.H);this.k.q.bl.f()}}else{this.ce(this.J.b(this.bq,this,this.bC()));this.k.apcl(_ph.b.c,this.X)}var n=_c.A.a(this.bp,_ph.u.a(this.bq),this.E);this.k.X(new _c.V(n,null,this.bp.t(),this.E));this.bd(String.format(_nbs.a.Ho,0));this.k.q.apcl("TableSize",this.H);this.k.P()},ch:function(n,t){this.bd(String.format(_nbs.a.Ho,this.k.q.br))},bf:function(){if(this.p)for(var t=0;t<this.p.x.length;t++){var n=this.p.x[t];if(n&&n.a){var e=n.b.a();var u=_d.U.a(e);var i=new _g.bv(new _g.e("PersonaMembers"));i.DeleteMemberFromPDL=u;var f=[i];var r;this.x=(r=this.x).concat.apply(r,f)}}},bP:function(n,t){this.dQ("IsEditableMembersListLoading")},cd:function(n){this.da(n,2);if(!n.t&&this.z){var i=_pc.f.isInstanceOfType(n)?n.e:n.d;var t=n;this.z.a(_ph.M,new _ph.M(i,t.A.PersonaId))}},bR:function(n,t){this.l.c&&this.l.b&&this.o.b&&this.o.b.bA(this.bp.h().i(0))}};_d.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.cn=Function.createDelegate(this,this.dv);this.ch=Function.createDelegate(this,this.du);this.co=Function.createDelegate(this,this.dw);this.cJ=Function.createDelegate(this,this.dx);this.cK=Function.createDelegate(this,this.dy);_d.d.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.cj=e;this.J=l;this.ck=!!l&&l.a().c().Enabled;this.cm=a;this.bL=!!l&&l.a().M().Enabled;this.bs.h=this.ci();this.cl=v;this.bK()};_d.d.d=function(n){return!n.a()||_js.d.a(n.a().EmailAddress)?"":n.a().EmailAddress};_d.d.prototype={ck:!1,bL:!1,cm:null,by:null,d:null,cj:null,G:null,J:null,cl:null,cO:function(n){if(this.G!==n){this.G=n;this.dQ("CardNotesViewModel")}return n},bP:function(){return this.bs.g?!0:this.bp.bK()||!this.bx()},cM:function(){return this.bb()===this.ds()},cN:function(){return this.bb()===1},bS:function(){return this.bb()===this.dt()},dp:function(){return this.bK()?"PersonaSelectedItemView":"ReadGroupCardView.MemberPersonaView"},dr:function(){return _js.d.c(_nbs.a.ap,this.bp.a().Name)},r:function(){var n=_d.E.prototype.r.call(this);n.m=this.G.b;return n},dq:function(){return new _C(this.cK,_a.a.ch)},dm:function(){return!this.bK()||!this.d.q||!this.d.q.br},bK:function(){return this.ci()&&this.bs.a===2&&this.J.a().bK().Enabled},ci:function(){return!this.o&&!this.bD()&&!!this.J&&this.J.a().j().Enabled},cL:function(){return this.bx()&&this.bs.a===6&&!!this.J&&this.J.a().j().Enabled&&this.J.a().d().Enabled},cF:function(){return this.bs.d?!1:!this.bp.bK()&&this.bx()},bI:function(){return this.bs.l?!1:this.cF()},dn:function(){return!!this.bp.a()&&this.bp.a().RoutingType.toUpperCase()==="SMTP"},bx:function(){return!!this.bp.a()&&this.bp.a().RoutingType.toUpperCase()==="MAPIPDL"},dg:function(){return this.ck?_nbs.a.Xt:_nbs.a.Wn},e:function(){_d.E.prototype.e.call(this);this.cO(new _d.bl(this.bp,this.bs,this.bq,this.bt));this.d=new _ph.u(this.bq,0,this.cm,this.bK()?9:4);this.d.bM(this.cJ);this.d.apcl(_ph.b.c,this.co);var n=_d.d.d(this.bp);this.c().e(2,n,0);this.bN()},di:function(){this.bS()&&this.G.d()},bR:function(){if(this.cL())return null;var t=_nbs.a.OZ;var i=_nbs.a.gk;var n=_nbs.a.YF;return this.bx()?[new _ff.h(t,null),new _ff.h(n,null)]:[new _ff.h(t,null),new _ff.h(i,null),new _ff.h(n,null)]},ce:function(){return this.cN()?24:this.bS()?21:this.cM()?25:100},bw:function(){_d.E.prototype.bw.call(this);this.cO(new _d.bl(this.bp,this.bs,this.bq,this.bt));var n=_d.d.d(this.bp);this.c().e(2,n,0)},dj:function(){return!0},bJ:function(){this.dY([_d.d.a,_d.d.c,_d.d.b]);this.bS()&&this.G.d()},bE:function(){if(this.bp.a()&&this.bp.a().ItemId||this.bp.f()){var n=_c.A.a(this.bp,_ph.u.a(this.bq),this.bL);this.dz(n);var i=new _c.V(n,null,this.bp.t(),this.bL);this.d.X(i);this.d.P()}else if(this.bp.a()&&_a.D.a(this.bp.a().EmailAddress)){this.I(!0);var t=_fp.a.B(this.bp.a().EmailAddress,_fp.a.a);t.z(this.ch);this.bt.a(t)}},bA:function(){var t=new _ms.b;if(_a.UserAgent.getInstance().a()){var n;n=this.bs.a===2?_nbs.a.Xu:_nbs.a.bA;t.f(new _ms.a(_y.b.b(),_y.b.b(),this.bM(),n))}else t.f(new _ms.a(_y.b.a(),_y.b.a(),this.bM(),""));return t},ds:function(){return this.bx()?0:0},dt:function(){return this.bx()?1:2},dx:function(n,t){var i=n;if(i&&i.r){this.de(i.r);this.d.g(null)}},du:function(n){var t=n;($a(this.bp.a())||$a(this.bp.a().ItemId))&&$a(this.bp.f())&&this.I(!1);if($a(t.t)&&t.e.x.length>0){$a(this.c())||this.c().o(!0);var i=t.e.x[0];this.cB(i)}t.K(this.ch)},dz:function(n){var t=new _pc.h(n.f,n.c,n.d,n.h,1,this.bL);if(this.c().a().G()){t.J=this.c().a().t().a;t.d=this.c().a().t().c}this.I(!0);t.z(this.cn);this.bt.a(t)},dv:function(n){var t=n;this.I(!1);if(!t.t){var r=_js.e.s(_a.a.ch,2,"SetGroupMembers");this.cP();var i;this.dk(t.n,i={val:this.by}),this.by=i.val;this.dn()&&this.G.k(t.m);t.h&&this.bp.de(t.h);this.bx()&&this.bb()===1&&this.G.d();this.c().e(1,t.j,0);_js.e.e(r);this.ek();this.J.a().b().Enabled&&this.bq.a()==="TouchNarrow"?this.cW(this.bA()):this.cC();this.dY([_d.d.f,_d.d.g,_d.d.a,_d.d.c,_d.d.b])}_a.k.a("OpenContact");this.dX("PersonaInCompletedState")},dk:function(n,t){t.val=null;if(!$a(n)&&n.length>0){t.val=new _js.f;for(var i=0;i<n.length;i++)t.val.a(this.cQ(n[i]))}},cQ:function(n){var t=this.cj.b(n);t.b(this.cD);return t},dw:function(n,t){this.eb("IsMembersListLoading",_d.d.e,_d.d.h)},cP:function(){if(!$a(this.by)){this.by.f();this.by=null}},dy:function(){this.cl.a(this.bp.a())}};_d.cN=function(){};_d.cN.prototype={b:null,c:null,a:!1};_d.U=function(n,t,i,r,u,f){this.m=Function.createDelegate(this,this.y);this.l=Function.createDelegate(this,this.x);_d.U.initializeBase(this);_a.b.b(t,"findRecipientViewModelFactory");_a.b.b(i,"recipientWellViewModelFactory");_a.b.b(r,"personaViewModelFactory");_a.b.b(f,"groupCard");this.i=t;this.f=r;this.j=u;this.e=f;this.b=this.D(n);this.A(i.g(_pe.c.a));this.a.a().d(this.l)};_d.U.b=function(n){return!!n.a()&&n.a().MailboxType==="Mailbox"};_d.U.a=function(n){var t=n.a();t.RoutingType==="MAPIPDL"&&(t.EmailAddress="");t.ItemId&&(t.ItemId.ChangeKey=null);return t};_d.U.prototype={b:null,i:null,f:null,j:null,e:null,a:null,c:null,d:!1,k:null,g:!1,A:function(n){this.a=n;this.dQ("MembersRecipientWellViewModel");return n},h:!1,B:function(n){if(this.c!==n){this.c=n;this.dU("NewlyAddedMembersCountLabel","IsNewlyAddedMembersLabelShown")}return n},o:function(){return this.k||(this.k=new _bc.b)},n:function(){return!!this.a&&!!this.a.a()&&this.a.a().x.length>0},C:function(n){this.g=n;this.dQ("ShowCompactList");return n},D:function(n){var i=_fp.a.f;this.d=!1;var r=null;if(this.e.a().b()===5){i=_fp.a.J;this.d=!0;r=_d.U.b}var t=this.i.a(i,_fp.a.b(),!1,"PersonaDetailedView",this.d,r,this.f,0);_fp.d.a(t);t.T();t.N(n);t.bo("PersonaDetailedView");t.q(this.m);return t},z:function(){this.a.a().f()},w:function(){return this.h?_nbs.a.Ed:_nbs.a.Ms},q:function(){var n=[];if(this.a&&this.a.a())for(var t=0;t<this.a.a().x.length;t++){var u=this.a.a().x[t];if(u){var r=u.i.a();if(r){var e=_d.U.a(r);var i=new _g.bv(new _g.e("PersonaMembers"));i.AddMemberToPDL=e;var f=[i];n=n.concat.apply(n,f)}}}return n},y:function(n,t){var i=n.h();if(!$a(i)){this.p(i);this.e.c(!0)}},p:function(n){var i=n.y();if(!this.d||i.MailboxType==="Mailbox"){if(!this.r(i)){var t=_pc.a.b(i);t.df(n.bA.b());t.de(n.bA.f());var r=this.v(t);r.ca=!0;this.a.o(r,3)}}else this.o().a(0,_nbs.a.Qh,null)},r:function(n){var t=n.ItemId;return t&&n.MailboxType==="PrivateDL"&&t===this.j?!0:this.t(n)},t:function(n){if(n){if(!$a(n.ItemId)&&!$a(n.ItemId.Id)){for(var e=n.ItemId.Id.toLowerCase(),u=0;u<this.a.c().x.length;u++){var t=this.a.c().x[u];if(t&&!$a(t.ItemId)&&!$a(t.ItemId.Id)&&t.ItemId.Id.toLowerCase()===e)return!0}return!1}if(n.EmailAddress)for(var f=n.EmailAddress.toLowerCase(),r=0;r<this.a.c().x.length;r++){var i=this.a.c().x[r];if(i&&i.EmailAddress&&i.EmailAddress.toLowerCase()===f)return!0}}return!1},v:function(n){var t=this.f.e(n,this.a.p(),!0,4);var i=[1];t.l(1,i,"");return t},x:function(n,t){this.B(String.format(_nbs.a.Gi,this.a.a().x.length))}};_d.H=function(n,t){this.d=Function.createDelegate(this,this.f);_d.H.initializeBase(this);$a(n)&&Error.argumentNull("persona");_a.b.a(t,"personaViewModelFactory");this.c=n;this.a=this.e(t)};_d.H.prototype={c:null,a:null,b:function(n){this.dV("PersonaClicked",n)},f:function(){this.dZ("PersonaClicked",this.c)},e:function(n){var t=null;t=n.e(this.c,_pe.c.a,!1,4);t.w(!0);t.b(!0);t.bw(new _C(this.d,_a.a.v));t.bv(t.cd);return t}};_d.ci=function(n,t){this.a=this.$$gta["_d.ci"].T===Number||Type.isEnum(this.$$gta["_d.ci"].T)?0:this.$$gta["_d.ci"].T===Boolean?!1:null;this.a=n;this.b=t};_d.ci.$$=function(n){var i="ci"+"$"+n.getName().replace(/\./g,"_");if(!_d[i]){var t=_d[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.ci.apply(this,t)};t.registerClass("_d."+i);var e={"_d.ci":{T:n}};t.prototype.$$gta=e;var f=_d.ci.prototype;for(var u in f){var r={key:u,value:f[u]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.b=function(n){var r=null;var f=new _ff.e;if($a(n.d())||!n.d().length)return null;r=[];for(var t=0,e=0,o=n.d().length;t<o;++t){var u=!$a(n.d()[t])&&n.d()[t].RoutingType==="MAPIPDL";if(!$a(n.d()[t])&&(u||!_js.d.a(n.d()[t].EmailAddress))){var i=_g.o.d(n.d()[t])?n.d()[t].OriginalDisplayName:n.d()[t].EmailAddress;if(!u&&(_js.d.b(i)||f.g(i.toLowerCase())))continue;r[e++]=new(_d.ci.$$(_g.d))(n.d()[t],i);n.d()[t].RoutingType!=="MAPIPDL"&&f.c(i.toLowerCase())}}return r};t.c=function(n,t){var h=new _ff.e;var u=n.K();if($a(u)||!u.b())return null;for(var s=[],o=0,c=0,l=u.b();o<l;++o){var f=u.c(o);if(!$a(f)&&!$a(f.a())){var e=f.a();if(!_js.d.a(t)&&e.trim().toLowerCase()===t)continue;var r=e.trimStart();var i=r.toLowerCase();if(i.startsWith("sip:")){r=i.substr(4).trimStart();i=r.toLowerCase()}if(h.m(i)<0){h.c(i);s[c]=new(_d.ci.$$(String))(e,r);c++}}}return s};t.d=function(n){var i=[];t.a(n.k(),_nbs.a.dc,n,i);t.a(n.v(),_nbs.a.dc,n,i);t.a(n.q(),_nbs.a.RX,n,i);t.a(n.D(),_nbs.a.RX,n,i);t.a(n.A(),_nbs.a.FS,n,i);t.a(n.B(),_nbs.a.FS,n,i);t.a(n.T(),_nbs.a.OX,n,i);t.a(n.Y(),_nbs.a.fX,n,i);t.a(n.Q(),_nbs.a.eA,n,i);t.a(n.S(),_nbs.a.Tt,n,i);t.a(n.R(),_nbs.a.ZK,n,i);t.a(n.N(),_nbs.a.jZ,n,i);t.a(n.P(),_nbs.a.OF,n,i);t.a(n.U(),_nbs.a.QX,n,i);t.a(n.V(),_nbs.a.We,n,i);t.a(n.W(),_nbs.a.Na,n,i);t.a(n.X(),_nbs.a.QF,n,i);return i};t.a=function(n,t,i,r){if(!$a(n)&&n.b())for(var e=0,s=r.length,h=n.b();e<h;++e){var u=n.c(e);if(!$a(u)&&!$a(u.a())){var o=u.a();if(!_js.d.b(o.Number)){var f=h>1?_d.c.d(u,i,""):"";f=_js.d.a(f)?"":String.format(" {0}",f);var c=String.format("{0} [{1}{2}]",o.Number,t,f);r[s]=new(_d.ci.$$(_g.k))(o,c);s++}}}}}return _d[i]};_d.ci.prototype={b:null};_d.X=function(n,t,i,r,u,f,e,o){this.N=Function.createDelegate(this,this.bg);this.Q=Function.createDelegate(this,this.bx);this.P=Function.createDelegate(this,this.bw);_d.X.initializeBase(this,[n,t,i,r,u]);this.p=f;this.E=e;this.D=o;this.C=r;this.M=u;this.d.a()==="TouchNarrow"&&(this.C.a().b().Enabled?this.dy(this.W()):this.ds(this.bf()))};_d.X.a=function(n,t,i,r,u,f,e,o){return new _d.X(n,t,i,r,u,f,e,o)};_d.X.prototype={p:null,E:null,M:null,l:null,D:null,C:null,R:function(){return this.a().a()?new _C(this.P,_a.a.cf):null},a:function(){if(!this.l){this.l=new _d.bI(this.D).a(this.d,this.p,this.E);this.l.b(this.Q)}return this.l},be:function(){return this.d.a()==="TouchWide"},S:function(){return this.a().k()},cy:function(){_y.hJ.prototype.cy.call(this);this.a().h()},bf:function(){var n;n=this.a().a()?[this.a().c(),this.a().e(),_y.f.a(_nbs.a.mO,new _C(this.N,_a.a.cf))]:[_y.f.b(new _C(this.m,_a.a.cf))];return _y.i.a(this,n,null)},W:function(){var n=new _ms.b;n.h(this.w);if(this.M.a()){n.e(2);n.f(new _ms.a(_fm.a.a,_fm.a.a,new _C(this.m,_a.a.cf),_u.R.ZZ));if(this.a().a()){n.g(new _ms.a(_fm.a.a,_fm.a.a,this.a().d(),_ops.b.BA));n.i.a(!0)}}else{n.e(1);n.f(new _ms.a(_y.b.a(),_y.b.a(),new _C(this.m,_a.a.cf),""));this.a().a()&&n.g(new _ms.a(_y.b.e(),_y.b.e(),this.a().d(),""))}return n},k:function(){return null},o:function(){return null},h:function(){return{}},bw:function(){this.d.d(this.a())},bx:function(){this.d.a()==="TouchNarrow"?this.bD():this.dQ("ImageSource")},bg:function(){this.a().m()||this.bD()}};_d.cj=function(n,t,i,r,u,f,e,o,s,h){this.R=Function.createDelegate(this,this.bA);_d.cj.initializeBase(this,[n,t,i,r,u,e,o,s,h]);this.S=f};_d.cj.prototype={S:!1,bc:function(n,t){var i=n.b(2,_bc.f.a,t,!1,!1);var r=i.v();r?r.d(!1):i.apcl("FindRecipientViewModel",this.R);return i},K:function(){this.h().bh();_ph.f.prototype.K.call(this)},M:function(n){this.S||this.h().t.f();_ph.f.prototype.M.call(this,n)},bA:function(n,t){var i=n;var r=i.v();r.d(!1);i.rpcl("FindRecipientViewModel",this.R)}};_d.cO=function(n,t,i,r){this.m=Function.createDelegate(this,this.o);this.n=Function.createDelegate(this,this.p);_d.cO.initializeBase(this,[n,t,i,r]);this.h=new _d.bt(_nbs.a.Zw,this.n,this)};_d.cO.prototype={h:null,b:function(){return 0},p:function(){this.a(!0);var n=new _pcm.d(this.c().f(),this.c().e().c(0).e());n.z(this.m);OwaApplication.a.a(n)},o:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.BM);else{var i=t.d;this.d();this.g(i)}this.a(!1)}};_d.bt=function(n,t,i){var r=this;_d.bt.initializeBase(this,[t,_a.a.cB,i,_d.D.b,function(){return!i.e}]);this.g=n};_d.bt.prototype={g:null};_d.D=function(n,t,i,r){_d.D.initializeBase(this);_a.b.b(n,"personaGetter");_a.b.b(t,"updatePersona");_a.b.b(i,"closeLinkPersonaCard");_a.b.b(r,"showErrorMessage");this.j=n;this.l=t;this.i=i;this.k=r};_d.D.a=function(n){var i=n.cz();var t;switch(i.length){case 0:t="";break;case 1:t=i[0].c();break;default:t=String.format(_nbs.a.Fr,i.length);break}return t};_d.D.d=function(n,t){t.val=n[_d.D.c];return!$a(t.val)};_d.D.prototype={l:null,i:null,k:null,j:null,e:!1,a:function(n){if(this.e!==n){this.e=n;this.bj(_d.D.b)}return n},c:function(){return this.j()},g:function(n){this.l(n)},d:function(){this.i()},f:function(n,t){var f=t;var i;var u,r;(r=_d.D.d(n,u={val:i}),i=u.val,r)&&(_g.bm.a(i)||(f=_nbs.a.TK));this.k(f)}};_d.V=function(n,t,i,r,u,f,e){this.g=Function.createDelegate(this,this.z);this.e=Function.createDelegate(this,this.q);_d.V.initializeBase(this);_a.b.b(n,"owaShell");_a.b.b(i,"parentSummaryCardViewModel");_a.b.b(u,"persona");_a.b.b(f,"onLinkActionCompleted");this.b=n;this.o=t;this.c=new _C(this.e,_d.V.a);this.n=new _pe.d(u,2,!1,this.b,e,8);this.k=new _pe.d(u,8,!1,this.b,e);this.k.e(1,_d.D.a(u),0);this.d=this.r(u);this.d.d(u);this.h=new _bc.b;var s=this;var o=function(n){s.h.a(0,n,null)};r?r===1?this.a=new _d.cP(i.k,this.g,f,this.e,o):r===2&&(this.a=new _d.cR(i.k,this.g,f,this.e,o)):this.a=new _d.cO(this.g,f,this.e,o);this.f=i;this.ds(this.p())};_d.V.prototype={b:null,o:null,a:null,c:null,n:null,k:null,d:null,h:null,f:null,y:function(){return this.b.a()==="Mouse"},t:function(){return!this.a.b()},x:function(){return this.a.b()===1},w:function(){return this.a.b()===2},r:function(n){var t=new _bc.o;t.a=9;if(this.b.a()!=="TouchNarrow"){t.m=!0;t.d=!0}t.c=!0;t.e=!0;return this.o.c(t,0,null)},q:function(){if(_d.V.isInstanceOfType(this.f.br().a())){this.d.dispose();this.f.bu();this.f.br().c()}},z:function(){return this.d.K.a()}};_d.be=function(n,t,i,r,u,f,e,o){_d.be.initializeBase(this,[n,t,i,r,u,f,e]);this.l=e;this.m=o};_d.be.prototype={l:null,m:null,j:function(){return this.b.a()==="TouchWide"?1:this.b.a()==="TouchNarrow"?2:0},p:function(){if(this.b.a()==="TouchWide"){var t=new Array(1);t[0]=_y.f.a(_u.R.YW,this.c);return _y.i.a(this,t,null)}else if(this.b.a()==="TouchNarrow")if(this.l.e().a().b().Enabled)this.dy(this.m.a(this.c));else{var n=_y.i.a(this);n.i(this.c);return n}return null}};_d.cP=function(n,t,i,r,u){this.q=Function.createDelegate(this,this.v);this.p=Function.createDelegate(this,this.t);this.r=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.s);_d.cP.initializeBase(this,[t,i,r,u]);_a.b.b(n,"originalPersona");this.h=n;this.m=new _d.bt(_nbs.a.SS,this.o,this);this.n=new _d.bt(_nbs.a.Yx,this.r,this)};_d.cP.prototype={h:null,m:null,n:null,b:function(){return 1},s:function(){this.a(!0);var n=new _pcm.a(this.h.f(),this.c().f());n.z(this.p);OwaApplication.a.a(n)},t:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.Vh);else{var i=t.a;this.d();this.g(i)}this.a(!1)},w:function(){this.a(!0);var n=new _pcm.f(this.h.f(),this.c().f());n.z(this.q);OwaApplication.a.a(n)},v:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.Xo);else{var i=t.d;this.d();this.g(i)}this.a(!1)}};_d.cQ=function(){this.f=Function.createDelegate(this,this.j);_d.cQ.initializeBase(this);this.g()};_d.cQ.prototype={b:0,c:null,a:null,e:null,h:function(){switch(this.b){case 0:case 1:return _u.R.UU;case 2:return _nbs.a.hg;case 3:return _nbs.a.VM;case 4:return _nbs.a.QS;default:throw Error.invalidOperation("LinkSuggestionIdsViewModel are in an unknown status: "+this.b);}},g:function(){this.d(0,null,null,null)},i:function(n){_a.b.b(n,"newPersonaId");if(!this.b||n!==this.c){this.d(1,n,null,null);var t=new _pcm.b(n);t.z(this.f);OwaApplication.a.a(t)}},j:function(n){var t=n;_ff.g.b(t.c,this.c)&&(t.t?this.k(this.c,t.t):this.l(this.c,t.a))},l:function(n,t){_a.b.b(n,"personaId");var i=$a(t)||!t.length?3:2;this.d(i,n,t,null)},k:function(n,t){_a.b.b(n,"personaId");this.d(4,n,null,t)},d:function(n,t,i,r){var u=!1;if(this.b!==n){this.b=n;u=!!(u|!0)}if(this.c!==t){this.c=t;u=!!(u|!0)}if(this.a!==i){this.a=i;u=!!(u|!0)}if(this.e!==r){this.e=r;u=!!(u|!0)}u&&this.dU("LinkSuggestionIdsStatusText","LinkSuggestionsAvailable")}};_d.cQ.a=function(){};_d.cQ.a.prototype={NotRetrieved:0,Retrieving:1,Available:2,NotAvailable:3,FailedToRetrieve:4};_d.cQ.a.registerEnum("_d.cQ.a",!1);_d.p=function(n,t,i,r,u){this.M=Function.createDelegate(this,this.bz);this.bb=Function.createDelegate(this,this.bA);this.m=Function.createDelegate(this,this.bB);this.bd=Function.createDelegate(this,this.bK);this.W=Function.createDelegate(this,this.be);this.Y=Function.createDelegate(this,this.bv);this.N=Function.createDelegate(this,this.bD);this.P=Function.createDelegate(this,this.bE);this.L=Function.createDelegate(this,this.by);this.bc=Function.createDelegate(this,this.bC);this.X=Function.createDelegate(this,this.bf);_d.p.initializeBase(this);_a.b.b(n,"owaShell");_a.b.b(t,"linkPersonaCardViewModelFactory");_a.b.b(i,"persona");this.d=n;this.T=t;this.B=r;this.p=new _C(this.X,_d.p.a);this.G=new _bc.b;this.r=new _js.f;this.bp(!0);this.e=new _d.cQ;this.e.apcl("LinkSuggestionsAvailable",this.bc);this.g=new _js.f;this.l=new _js.f;this.b(i);r.e().a().b().Enabled&&n.a()==="TouchNarrow"&&u?this.dy(u.a(this.dz)):this.ds(this.bg());this.A("");this.Q=new _C(this.L,_d.p.a);this.V=new _C(this.P,_d.p.a);this.U=new _C(this.N,_d.p.a)};_d.p.prototype={d:null,T:null,p:null,Q:null,V:null,U:null,G:null,e:null,B:null,k:null,H:null,C:null,I:null,r:null,g:null,l:null,J:!1,K:null,E:!1,D:null,h:null,F:null,t:null,S:null,x:null,z:null,y:null,bq:function(n){this.dV("SearchCompletedWithResults",n)},bF:function(n){this.dW("SearchCompletedWithResults",n)},bG:function(n){if(this.H!==n){this.H=n;this.dQ(_d.p.b)}return n},bH:function(n){if(this.C!==n){this.C=n;this.dQ(_d.p.c)}return n},bw:function(){this.F||(this.F=new _C(this.Y,_d.p.a));return this.F},bx:function(){return this.d.a()==="Mouse"},c:function(){if(!this.h){this.h=new _y.h(this.d.a());this.h.bG(!1);this.h.F(!1);this.h.N(_nbs.a.Dh);this.h.cJ(new _C(this.W,_d.p.a));this.h.bj(new _C(this.bd,_d.p.a));var n=this;this.h.apcl("IsExpanded",function(t,i){n.h.bB||n.c().k(!1)})}return this.h},bj:function(n){if(this.x!==n){this.x=n;this.dQ("SelectedComponentItem");this.d.a()==="TouchNarrow"&&n&&this.w(this.o(0,n.bA,this.m))}return n},bl:function(n){if(this.z!==n){this.z=n;this.dQ("SelectedSuggestionItem");this.d.a()==="TouchNarrow"&&n&&this.w(this.o(1,n.bA,this.m))}return n},bk:function(n){if(this.y!==n){this.y=n;this.dQ("SelectedSearchItem");this.d.a()==="TouchNarrow"&&n&&this.w(this.o(2,n.bA,this.m))}return n},bp:function(n){if(this.J!==n){this.J=n;this.dQ(_d.p.d)}return n},bI:function(n){if(this.K!==n){this.K=n;this.dQ(_d.p.e)}return n},A:function(n){this.S=n;this.dQ("CurrentSearchPeopleMessage");return n},bm:function(){return 0},q:function(){return null},n:function(){return this.D},f:function(n){this.D=n;return n},bn:function(){return!0},b:function(n){_a.b.b(n,"newPersona");this.bi(n);this.bh()},a:function(){this.d.d(this)},bu:function(){this.bj(null);this.bl(null);this.bk(null)},bB:function(n){_a.b.b(n,"newPersona");this.bi(n);this.bh()},bh:function(){this.e.g();this.e.i(this.k.f())},bf:function(){$a(this.D)||_d.V.isInstanceOfType(this.br().a())?this.br().c():this.D()},bi:function(n){if(this.k!==n||!this.E){this.E=!0;this.k=n;this.bG(new _pe.d(n,2,!1,this.d,this.B,8));this.bH(new _pe.d(n,4,!1,this.d,this.B));this.bs();this.bI(String.format(_nbs.a.Xd,this.C.bD));this.be()}},bs:function(){this.I=new _pcm.c(this.k,!1);this.r.f();for(var n=0;n<this.I.b.length;n++){var t=this.I.b[n];this.r.a(this.R(t,_d.D.a(t),this.L))}this.bp(this.r.x.length===1)},bC:function(n,t){this.bt()},bt:function(){if(this.e.b!==1){var o=!1;if($a(this.e.a))this.g.f();else{for(var n=0;n<this.g.x.length;n++){for(var a=this.g.x[n],v=a.bA.f(),s=!1,i=0;i<this.e.a.length;i++){var c=this.e.a[i];if(_ff.g.b(c,v)){s=!0;break}}if(!s){this.g.n(n);n--}}for(var t=0;t<this.e.a.length;t++){for(var f=this.e.a[t],u=!0,r=0;r<this.g.x.length;r++){var l=this.g.x[r];var h=l.bA.f();if(_ff.g.b(f,h)){u=!1;break}}if(u){o=!0;var e=_pc.e.a(f);e.z(this.bb);OwaApplication.a.a(e)}}}o||_a.k.a("PersonCard.ContactLinking")}},bA:function(n){var r=n;if(r.t){if(this.E){this.G.a(0,_nbs.a.QS,null);this.bf();this.E=!1}return}var e=!1;if(!$a(this.e.a)&&this.e.a.length>0)for(var u=0;u<this.e.a.length;u++){var s=this.e.a[u];if(_ff.g.b(s,r.c)){e=!0;break}}if(e){for(var i=r.a,f=this.R(i,_d.D.a(i),this.P),t=0;t<this.g.x.length;t++){var o=this.g.x[t];if(_ff.g.b(o.bA.f(),i.f())){this.g.n(t);this.g.r(t,f);return}}this.g.a(f)}this.e.a.length===this.g.x.length&&_a.k.a("PersonCard.ContactLinking")},bK:function(){if(!_js.d.b(this.c().bt)){var n=_fp.a.I(this.c().bt);this.t=n;this.t.z(this.M);this.A(_bcs.D.H);this.l.f();OwaApplication.a.a(this.t)}},bz:function(n){if($a(n.t)&&$a(n.a()))throw Error.invalidOperation("The response is not processed correctly!");n===this.t&&this.bJ(n);n.K(this.M)},bJ:function(n){if($a(n.t)){var r=n.a();this.l.f();for(var t=0;t<r.x.length;t++){var i=r.x[t];_ff.g.b(i.f(),this.k.f())||this.l.a(this.R(i,"",this.N))}if(this.l.x.length){this.A("");this.dX("SearchCompletedWithResults")}else this.A(_nbs.a.Qs)}else this.A(_nbs.a.Fs)},bv:function(){this.c().bz(!0);this.c().k(!0)},be:function(){this.A("");this.l.f();this.c().bz(!1);this.c().g("");this.c().k(!1);this.t=null},R:function(n,t,i){var r=new _pe.d(n,10,!1,this.d,this.B,4,null,!0);r.e(1,t,0);r.bv(new _C(i,_d.p.a));r.b(!0);return r},by:function(){this.x&&this.d.a()!=="TouchNarrow"&&this.w(this.o(0,this.x.bA,this.m))},bE:function(){this.z&&this.d.a()!=="TouchNarrow"&&this.w(this.o(1,this.z.bA,this.m))},bD:function(){this.y&&this.d.a()!=="TouchNarrow"&&this.w(this.o(2,this.y.bA,this.m))},w:function(n){this.br().d(n)}};_d.W=function(n,t,i,r,u){_d.W.initializeBase(this,[n,t,i,r,u])};_d.W.prototype={j:function(){return this.d.a()==="TouchWide"?1:this.d.a()==="TouchNarrow"?2:0},o:function(n,t,i){return this.T.e(this,n,t,i)},bg:function(){if(this.d.a()==="TouchWide"){var n=new Array(1);n[0]=_y.f.a(_u.R.YW,this.p);return _y.i.a(this,n,null)}else if(this.d.a()==="TouchNarrow")return _y.i.b(this);return null}};_d.cR=function(n,t,i,r,u){this.o=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.p);_d.cR.initializeBase(this,[t,i,r,u]);_a.b.b(n,"originalPersona");this.m=n;this.h=new _d.bt(_nbs.a.SS,this.n,this)};_d.cR.prototype={m:null,h:null,b:function(){return 2},p:function(){this.a(!0);var n=new _pcm.e(this.m.f(),this.c().f());n.z(this.o);OwaApplication.a.a(n)},q:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.eF);else{var i=t.d;this.d();this.g(i)}this.a(!1)}};_d.de=function(n,t,i,r,u,f,e,o,s,h,c){this.ck=Function.createDelegate(this,this.cM);_d.de.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.bS=e};_d.de.prototype={bS:null,bL:-1,J:null,bK:null,ch:null,by:null,bx:null,cn:function(){if(!this.J&&this.d()){var n=this;this.bS.a(function(t){n.J=t.a(n.d().x[0],!0);n.dQ("LocationMapViewModel")})}return this.J},d:function(){this.bK||(this.bK=this.bp.bJ());return this.bK},cL:function(){this.d()&&(this.ch=this.d().x[0].x());return this.ch},cm:function(){return this.bL===-1?!1:this.bb()===this.bL},cl:function(){return!this.bD()&&this.bs.a===2||this.bF()},e:function(){_d.E.prototype.e.call(this);this.bx=new _C(this.ck,_a.a.ba);this.bx.c(!this.dh()&&!this.cl());this.by="";(!this.bG()||this.bs.a===2||!this.bs.a)&&!this.bH()&&this.bq.a()!=="TouchNarrow"||(this.by="mapErrorMessage")},bJ:function(){this.dQ("IsMapPivotSelected")},cM:function(){this.bD()?this.d()&&this.cn().b():this.dG().a()}};_d.ck=function(n){this.m=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.o);this.l=Function.createDelegate(this,this.p);_d.ck.$$(this.$$gta["_d.ck"].T).initializeBase(this);this.g=n};_d.ck.$$=function(n){var i="ck"+"$"+n.getName().replace(/\./g,"_");if(!_d[i]){var t=_d[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.ck.apply(this,t)};var e=_a.by;t.registerClass("_d."+i,e);var o={"_d.ck":{T:n}};t.prototype.$$gta=o;var f=_d.ck.prototype;for(var u in f){var r={key:u,value:f[u]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.b=function(n,t,i){return new _fm.d(n,null,i,!0)};t.a=_a.a.v}return _d[i]};_d.ck.prototype={d:null,c:null,e:null,b:null,g:null,h:function(n){if(n!==this.d){this.d=n;this.dQ("ActionCommand")}return n},i:function(n){if(n!==this.c){this.c=n;$a(n)||this.c.apcl("IsShown",this.l);this.dQ("SelectActionItemMenuViewModel")}return n},f:function(n,t){t||(t=_d.ck.$$(this.$$gta["_d.ck"].T).b);if($a(n)||!n.length)this.a();else if(n.length===1){this.e=null;this.i(null);this.h(new _C(this.k,_d.ck.$$(this.$$gta["_d.ck"].T).a))}else{var r=n.length;this.e=new Array(r);for(var i=0;i<r;++i){var u=new(_a.gH.$$(_d.ci.$$(this.$$gta["_d.ck"].T)))(n[i],this.j);this.e[i]=t(n[i].b,n[i].a,new _C(u.a,_d.ck.$$(this.$$gta["_d.ck"].T).a))}this.i(new _fm.f(this.e));this.h(new _C(this.m,_d.ck.$$(this.$$gta["_d.ck"].T).a))}this.b=n},a:function(){if(!$a(this.e))for(var t=this.e,r=t.length,n=0;n<r;++n){var i=t[n];i.dispose()}this.e=null;this.i(null);this.h(null);this.b=null},dT:function(){this.a();_a.jV.prototype.dT.call(this)},q:function(){this.c.j(!0)},n:function(n){this.g(n.a)},o:function(){this.n(this.b[0])},p:function(n,t){_d.E.b=this.c.i}};_d.bf=function(n,t,i,r,u,f,e,o,s,h){this.cR=Function.createDelegate(this,this.L);this.cS=Function.createDelegate(this,this.cw);this.cp=Function.createDelegate(this,this.M);_d.bf.initializeBase(this);this.bp=n;this.cs=f;this.bY=o;this.bq=r;this.bt=u;this.bs=i;this.bu=t;this.ct=e;this.bX=s;this.bB=h};_d.bf.prototype={bY:null,bq:null,ct:null,bt:null,bu:0,bs:null,bX:null,bB:null,cs:!1,bW:null,bp:null,cq:null,bv:null,bz:null,bV:!1,bT:null,bU:!1,cv:!1,bZ:null,K:function(n){this.dV("ClosePopup",n)},N:function(n){this.dW("ClosePopup",n)},bC:function(){return!!this.bB&&this.bB.a().j().Enabled},m:function(){return this.bs},i:function(){return this.bz},cU:function(n){if(this.bz!==n){this.bz=n;this.dQ("ApplicationBarViewModel")}return n},bo:function(){return null},v:function(){return this.bZ},cW:function(n){if(this.bZ!==n){this.bZ=n;this.dQ("TopAppBarViewModel")}return n},j:function(){return 2},h:function(){this.bW||(this.bW=new _bc.b);return this.bW},cT:function(){return this.bp.b()},a:function(){return this.bp},cB:function(n){this.bp&&n.cI(this.bp.t());this.bp=n;this.bw();this.bN();this.dQ(_d.bf.b);return n},b:function(){return this.bu},A:function(){return this.bV},P:function(n){this.bV!==n&&(this.bV=n);this.dQ("IsVisible");return n},Z:function(){return null},bQ:function(){return null},bD:function(){return this.bq.a()!=="Mouse"},g:function(){return this.bq},bm:function(){return 0},q:function(){return this.cS},br:function(){return this.cq},ba:function(n){this.cq=n;return n},n:function(){return this.bv},f:function(n){this.bv=n;return n},bn:function(){return!0},bM:function(){this.bT||(this.bT=new _C(this.cR,_d.bf.a));return this.bT},dl:function(){return this.bU},cV:function(n){if(n!==this.bU){this.bU=n;this.dQ("IsTransitionedIn")}return n},cu:function(){return!this.cs},e:function(){if(this.cv){var n="Initialize should be called on any given instance only once.";_js.Trace.logError(_d.bf.a,n)}this.cv=!0;this.bB&&this.bB.a().b().Enabled&&this.bq.a()==="TouchNarrow"?this.cW(this.bA()):this.bq.a()!=="Mouse"&&this.cU(this.cr())},B:function(n){this.cU(null)},M:function(){this.bX.o()},cz:function(){},cx:function(){this.P(!0);this.cV(!0)},cA:function(){this.P(!1);this.cV(!1)},cy:function(){},bN:function(){this.cu()&&this.bE()},cr:function(){_js.Trace.logInfo(_a.a.v,"PersonaCardViewModelBase::CreateApplicationBarViewModel - Layout: {0}",this.bq.a());var t;var n;var r,i;this.bO(r={val:t},i={val:n}),t=r.val,n=i.val;return _y.i.a(this,t,n)},cC:function(){if(this.bz){var t;var n;var r,i;this.bO(r={val:t},i={val:n}),t=r.val,n=i.val;this.bz.b(t);this.bz.f(n);this.dQ("ApplicationBarViewModel")}}};_d.E=function(n,t,i,r,u,f,e,o,s,h){this.cZ=Function.createDelegate(this,this.dD);this.da=Function.createDelegate(this,this.dE);this.dd=Function.createDelegate(this,this.el);this.dc=Function.createDelegate(this,this.ei);this.cX=Function.createDelegate(this,this.dA);this.cY=Function.createDelegate(this,this.dB);this.db=Function.createDelegate(this,this.dJ);this.cE=Function.createDelegate(this,this.dC);this.cD=Function.createDelegate(this,this.de);_d.E.resolveInheritance();this.bc=this.cT;this.p=this.bM;_d.E.initializeBase(this,[n,0,t,r,u,e,o,s,h,null]);this.H=f;this.cI=i;this.cg=!0;this.o=!1;this.x(!0)};_d.E.prototype={cI:null,l:null,ca:null,cc:null,cH:!1,o:!1,H:null,cb:null,cg:!1,cf:!1,T:function(n){this.dV("OrganizationHierarchyForCardLoaded",n)},bh:function(n){this.dW("OrganizationHierarchyForCardLoaded",n)},Q:function(n){this.dV("AddToContactsClicked",n)},be:function(n){this.dW("AddToContactsClicked",n)},R:function(n){this.dV("DeleteSucceeded",n)},bf:function(n){this.dW("DeleteSucceeded",n)},S:function(n){this.dV("OnBack",n)},bg:function(n){this.dW("OnBack",n)},y:function(n){this.dV("PersonaInCompletedState",n)},F:function(n){this.dW("PersonaInCompletedState",n)},E:function(){return null},t:function(){return null},W:function(){return this.c().c().c()},X:function(){return this.c().c().d()},V:function(){return this.c().c().b()},z:function(){this.cc||(this.cc=new _C(this.cE,_d.E.a));return this.cc},dG:function(){return this.l.bu()},j:function(){switch(this.bq.a()){case"TouchWide":return 1;case"TouchNarrow":return 2;default:return 0}},r:function(){var n=new _d.bH;n.o=this.c().C();n.q=!0;n.p=this.bF();return n},k:function(){return this.l},bF:function(){return this.l.y()},c:function(){return this.l.j()},Y:function(){return this.bs.e?!0:this.cH},x:function(n){this.cH=n;this.l&&this.l.n(n);this.o&&(_d.E.c=n);this.dY(["IsExpanded","IsHoverCardExpanded"]);return n},bk:function(n){this.o=n;if(this.l){this.l.t(n);this.l.o(n)}this.dQ("IsHoverCard");return n},C:function(){return this.bG()&&this.Y()?!0:!1},bH:function(){return this.o&&this.bq.a()==="TouchWide"},D:function(){return this.o&&this.bq.a()!=="Mouse"},bb:function(){return this.l.k()},dF:function(){return this.c()?this.c().c().f():!0},bj:function(n){if(this.cb!==n){this.cb=n;this.dQ("DefaultEmailAddress")}return n},bG:function(){return this.bs.e?!1:this.cg},w:function(n){this.cg=n;this.ee();this.dY(["IsExpandable","IsHoverCardExpanded"]);return n},cd:function(){return this.cf},I:function(n){if(this.cf!==n){this.cf=n;this.dY(["IsCardLoading","HidePersonaActions","HideNameControlForMouse"]);this.ed()}return n},dh:function(){return this.bs.c||this.cd()?!0:!1},df:function(){this.ca||(this.ca=_y.f.a(_nbs.a.m,this.bM()));return this.ca},dg:function(){return _nbs.a.jr},cF:function(){return!1},bl:function(n){this.l.b(n)},e:function(){this.dO();!this.bD()&&this.c()&&this.c().c().g(this.db);this.cG();this.dL();this.l.b(0);_d.bf.prototype.e.call(this)},B:function(n){var t=n;_d.bf.prototype.B.call(this,t);this.w(t.p());this.l.b(t.q());this.l.q(t.n())},dC:function(){if(!this.dj()){this.h().a(0,_nbs.a.Ew,null);return}if(!this.cF()){this.h().a(0,String.format(_nbs.a.dV,this.c().d()),null);return}this.h().b(2,this.dI(),this.cY,!1,_u.R.WR,_u.R.fU,this.dg())},bd:function(n){this.c()&&this.c().o(!0);this.cB(n);this.cC();this.cG();this.di()},L:function(){if(!this.bF()){this.dX("ClosePopup");this.bv&&this.bv()}},ee:function(){this.l.m(this.bG());this.cG()},eh:function(n){try{this.ct.a(n,null,null);_pc.b.a(14,this.bs.a,this.bp.b())}catch(t){_js.Trace.logException(_d.E.a,t,"Failed to open URL")}},U:function(){if(this.H&&this.bq.a()==="Mouse"){var n=this;this.H.c(function(){if(!n.ec&&n.H.b()&&n.c()){var t=n.c().c();n.H.a().apcl("SignInState",t.a||(t.a=Function.createDelegate(t,t.e)))}})}},bi:function(){if(this.H&&this.bq.a()==="Mouse"){var n=this;this.H.c(function(){if(n.H.b()&&n.c()){var t=n.c().c();n.H.a().rpcl("SignInState",t.a||(t.a=Function.createDelegate(t,t.e)))}})}},bw:function(){this.l.i(this.bP());this.l.e(!this.bI());this.l.r(this.bp)},di:function(){},ed:function(){this.l.l(this.cd())},cw:function(n,t){this.bF()||this.dX("ClosePopup");return!1},de:function(n){if(n.b()!==2&&!n.f()){n.dj(1);n=this.ej(n)}this.bX.d(n)},dL:function(){this.l.g(this.bR())},ek:function(){var n=this.bR();this.dK(n)&&this.l.g(n)},cr:function(){var n=_d.bf.prototype.cr.call(this);this.bq.a()==="TouchNarrow"&&n.i(new _C(this.cX,_d.E.a));return n},bO:function(n,t){n.val=[];t.val=null;this.bH()&&(n.val[n.val.length]=this.df())},cG:function(){this.l.f(new _fm.f(this.dH()))},dH:function(){var n=[];this.bI()&&(n[n.length]=new _fm.d(_u.R.WR,null,new _C(this.cE,_d.E.a)));return n},dj:function(){return this.bp.i()===3},dJ:function(){this.bD()||this.dX("ClosePopup")},dO:function(){this.l=this.bY.e(this.bp,this.bu,this.bs,this.cI);this.l.i(this.bP());this.l.h(!0);this.l.e(!this.bI());this.l.w(this.dc);this.l.bB(this.dd);this.l.bA(this.cp)},ei:function(n){this.dQ("PivotSelectedOptionIndex");this.bJ();this.dP()},dK:function(n){return!this.l.c()&&!n?!1:this.l.c()&&n?this.l.c().length!==n.length:!0},dP:function(){var n=this.ce();_pc.b.g(n,this.bs.a,this.cT())},dI:function(){return this.bp.cB()?[String.format(_nbs.a.mu,this.c().d()),_nbs.a.IP]:this.bp.G()?[String.format(_nbs.a.mw,this.c().d())]:[String.format(_nbs.a.mu,this.c().d())]},dB:function(n,t){if(n){var i=new _rpc.A(this.bp.f(),this.bp.bc(),"GroupCard",this.bp.t());i.w(this.da);i.v(this.cZ);i.d=this.bs.a;this.bt.a(i);this.bv&&this.bv()}},dE:function(n){var t=n.g;_a.b.a(t,"personaId");this.ea("DeleteSucceeded",this,t)},dD:function(n){n.t&&this.h().a(0,String.format(_nbs.a.dV,this.c().d()),null)},el:function(n){this.x(n);_pc.b.a(31,this.bs.a,this.cT())},dA:function(){this.dX("OnBack");if(this.bv){this.dX("ClosePopup");this.bv()}},ej:function(n){var t=new _bc.d;t.n(!0);t.k("Outlook");t.m(!1);n.e()||n.cC(new _js.f);if(n.cX()){t.h(n.e().b().toString());n.e().a(t);n.j()&&n.j().g(n.j().i(0),n.e().b().toString())}else for(var u=n.e().b(),i=0;i<u;i++){var r=n.e().c(i);if(r.b()==="GAL"){t.h(i.toString());n.e().o(i,t);break}}if(n.a()){n.bT(new(_bc.S.$$(_g.d)));n.j().g(n.a(),(n.e().b()-1).toString())}return n}};_d.j=function(n,t,i,r,u,f,e){this.bj=Function.createDelegate(this,this.bP);this.bs=Function.createDelegate(this,this.bV);this.B=Function.createDelegate(this,this.cd);this.C=Function.createDelegate(this,this.ce);this.V=Function.createDelegate(this,this.bY);this.U=Function.createDelegate(this,this.bx);this.bk=Function.createDelegate(this,this.be);this.bi=Function.createDelegate(this,this.bO);this.bw=Function.createDelegate(this,this.cc);this.bl=Function.createDelegate(this,this.bH);this.bq=Function.createDelegate(this,this.bU);this.bh=Function.createDelegate(this,this.M);this.bv=Function.createDelegate(this,this.bI);this.bt=Function.createDelegate(this,this.bW);this.bu=Function.createDelegate(this,this.bX);this.bp=Function.createDelegate(this,this.bT);_d.j.initializeBase(this);if(_js.d.a(u))throw Error.argumentNull("emailAddress");this.Q=n;this.x=t;this.o=i;this.bf=r;this.ds(this.bN());this.Y=u.toLocaleLowerCase();this.A=_d.j.b(u);this.K=f;this.X=e;this.S(this.A)};_d.j.b=function(n){n=n.toLowerCase();var t=String.format("service.svc/s/GetUserPhoto?email={0}",encodeURIComponent(n));t+="&size="+String.format("HR{0}x{1}",240,240);return t};_d.j.prototype={Q:null,x:null,o:null,A:null,z:null,H:null,P:null,E:null,p:0,w:!1,t:0,F:null,Y:null,K:!1,X:!1,R:null,L:null,N:null,y:null,J:!1,D:!1,bf:null,b:function(n){this.dV("UploadPhotoClosed",n)},g:function(n){this.dW("UploadPhotoClosed",n)},bM:function(n){this.dV("UploadPhotoSucceeded",n)},cb:function(n){this.dW("UploadPhotoSucceeded",n)},bL:function(n){this.dV("UploadPhotoFailed",n)},ca:function(n){this.dW("UploadPhotoFailed",n)},a:function(){return this.X||_g.a.a().e().bl.SetPhoto&&this.bE()},bd:function(){return this.Q.a()==="Mouse"},bF:function(){return this.Q.a()==="TouchNarrow"},I:function(){this.P||(this.P=new _bc.b);return this.P},bC:function(){return!this.bc()&&_a.UserAgent.getInstance().J&&(!this.o.b(this.o.d())||!this.o.d().a().c())?!0:!1},T:function(n){if(this.J!==n){this.J=n;this.dQ("IsDiscardChangesDialogShown")}return n},r:function(n){if(this.w!==n){this.w=n;this.dQ("IsWorking")}return n},bR:function(){return this.bD()&&_g.a.a().e().bl.SetPhoto?new _C(this.bp,_d.j.a):null},bG:function(){return this.bE()&&_g.a.a().e().bl.SetPhoto?new _C(this.bu,_d.j.a):null},bK:function(n){this.E=n;this.dQ("OpenPhotoPickerCommand");return n},by:function(){return new _C(this.bt,_d.j.a)},bJ:function(n){this.H=n;this.dQ("Files");return n},j:function(){return this.bd()?0:1},d:function(){this.R||(this.R=new _C(this.bv,_d.j.a));return this.R},bB:function(){this.L||(this.L=new _C(this.bh,_d.j.a));return this.L},bb:function(){this.N||(this.N=new _C(this.bq,_d.j.a));return this.N},c:function(){return new _y.f(_y.b.n(),_y.b.o(),_nbs.a.VI,this.d())},e:function(){return new _y.f(_y.b.f(),_y.b.g(),_u.R.Ve,this.bb())},bm:function(){return this.bd()?2:0},q:function(){return this.bl},W:null,n:function(){return this.W},f:function(n){this.W=n;return n},bn:function(){return!0},l:function(){return this.p===1||this.p===2},bg:function(n){if(this.p!==n){this.p=n;this.dQ("CurrentState")}return n},bz:function(){return _y.f.a(_nbs.a.mO,this.bB())},bc:function(){return this.K&&this.o.b(this.o.d())&&this.o.d().a().f()},bD:function(){return this.K&&this.o.b(this.o.d())&&this.o.d().a().e()},bE:function(){return this.bc()||this.bD()||_a.UserAgent.getInstance().J},k:function(){return this.z},S:function(n){this.z=n!==""?n+String.format("&sc={0}",+new Date):n;this.dQ("ImageSource");return n},bA:function(){if(!this.y){this.y=new _js.f;this.y.a(new _ff.f(new _C(this.bw,_d.j.a),_u.P.b,null));this.y.a(new _ff.f(new _C(this.bi,_d.j.a),_u.R.IE,null));this.y.a(new _ff.f(new _C(this.bk,_d.j.a),_bcs.D.A,null))}return this.y},cy:function(){_y.hJ.prototype.cy.call(this);this.h()},h:function(){this.bg(0);this.t=0;this.r(!1);this.S(this.A);this.F=this.z;this.D=!1},bN:function(){var n;n=this.a()?[this.c(),this.e(),this.bz()]:[this.bz()];return _y.i.a(this,n,null)},bX:function(){if(this.bc()){_js.Trace.logInfo(_d.j.a,"Call to get photo from gallery");this.o.d().c(!1,this.U,this.V);return}if(this.o.b(this.o.d())&&this.o.d().a().c()){_js.Trace.logInfo(_d.j.a,"Call to native file picker");var t=this,n=this;this.o.d().d(!1,"*",1,function(n){n.length>0&&t.bx(n[0])},function(t){n.bS(t)});return}_a.UserAgent.getInstance().J&&this.E&&this.E.a()},G:function(n,t,i){return new _phu.a(n,t,i,this.Y,!this.K)},bT:function(){_js.Trace.logInfo(_d.j.a,"Call to get photo from camera");this.o.d().b(!1,this.U,this.V)},bW:function(){this.bZ(this.H.b(0))},bx:function(n){var t=this.G(1,null,n);t.w(this.C);t.v(this.B);this.t=1;this.F=this.A+"&isPreview=true";this.r(!0);this.x.a(t)},bZ:function(n){var t=new _at.s;t.a(n,this.bs,this.bj,_d.j.a,!1)},bV:function(n,t,i,r){var u=this.G(1,n,null);u.w(this.C);u.v(this.B);this.t=1;this.F=this.A+"&isPreview=true";this.r(!0);this.x.a(u)},ce:function(n){this.r(!1);this.S(this.F);this.bg(this.t);if(this.t===3){this.D=!0;this.dX("UploadPhotoClosed");this.dX("UploadPhotoSucceeded");this.M();this.bf.bc()}},cd:function(n){this.r(!1);var t=n.t.message;_js.d.a(t)&&(t=_nbs.a.DN);this.I().a(0,t,null);this.t===3&&this.dX("UploadPhotoFailed")},bI:function(){if(!this.w)switch(this.p){case 0:this.M();break;case 1:var t=this.G(0,"",null);t.w(this.C);t.v(this.B);this.t=3;this.r(!0);this.x.a(t);break;case 2:var n=this.G(2,"",null);n.w(this.C);n.v(this.B);this.t=3;this.r(!0);this.x.a(n);break}},m:function(){return this.bH(null,2)},bU:function(){if(!this.w)switch(this.p){case 0:this.S("");this.bg(2);break;case 1:var n=this.G(3,"",null);n.w(this.C);n.v(this.B);this.t=0;this.F=this.A;this.r(!0);this.x.a(n);break;case 2:break}},bH:function(n,t){if(this.w)return!0;if(this.D)return!1;if(this.p){this.T(!0);return!0}return!1},bS:function(n){var t=null;switch(n){case 1:t=_nbs.a.Xe;break;case 0:t=_nbs.a.HF;break;default:break}_js.d.a(t)||this.I().a(0,t,null)},bY:function(n){_js.Trace.logError(_d.j.a,n.message)},bP:function(){this.I().a(0,"Error when reading the file",null)},M:function(){this.br()&&this.br().a()===this&&this.dL()},cc:function(){this.D=!0;this.be();this.bI()},bO:function(){this.D=!0;this.be();this.M();this.bF()&&this.dX("UploadPhotoClosed")},be:function(){this.T(!1)}};_d.cD=function(){};_d.cD.prototype={singular:1,plural:2};_d.cD.registerEnum("_d.cD",!1);_d.cC=function(){};_d.cC.prototype={a:function(n,t){var u=new Sys.StringBuilder;var e="{0}; ";if($a(n))return"";if(!_js.f.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.f,"Value must be an ObservableCollection");if(!n.x.length)return"";for(var f=n,i=null,r=0;r<f.x.length;r++){i=f.x[r];i.b()||u.append(_js.d.c(e,i.a().bl.Name))}return u.toString()},b:function(n,t){throw Error.notImplemented();}};_d.bS=function(){};_d.bS.prototype={a:function(n,t){var i="";if(Number.isInstanceOfType(n)){var r=_js.l.c(_d.cD,t.toString());switch(n){case 0:i=r===1?_nbs.a.Rn:_nbs.a.HT;break;case 1:i=r===1?_nbs.a.IK:_nbs.a.UO;break;case 2:i=r===1?_nbs.a.Gg:_nbs.a.Jb;break;case 3:i=r===1?_nbs.a.Hl:_nbs.a.Kk;break}}return i},b:function(n,t){throw Error.notImplemented();}};_d.cE=function(){};_d.cE.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.mH;break;case"Personal":i=_nbs.a.Sz;break;case"Private":i=_nbs.a.Kx;break;case"Confidential":i=_nbs.a.r;break;default:i=_nbs.a.mH;break}return i},b:function(n,t){throw Error.notImplemented();}};_d.cF=function(){};_d.cF.prototype={a:function(n,t){if($a(n))return"";else{var i=t?t:!1;switch(n){case"NotStarted":return i?_u.R.Bf:_u.R.Pt;case"InProgress":return i?_u.R.QJ:_u.R.RN;case"Completed":return i?_u.R.FL:_u.R.SQ;case"Deferred":return i?_u.R.FR:_u.R.Lk;case"WaitingOnOthers":return i?_u.R.fV:_u.R.OE;default:return""}}},b:function(n,t){throw Error.notImplemented();}};_d.cG=function(){};_d.cG.prototype={a:function(n,t){var i=n;return i?i.toLocaleString():""},b:function(n,t){throw Error.notImplemented();}};_d.v=function(n,t,i,r){_d.v.initializeBase(this);this.f=n;this.j=t;this.m=i?i:_d.g.j();this.i=r?r:_d.g.i()};_d.v.prototype={j:!1,m:null,i:null,f:0,n:3e3,e:!1,p:!1,c:!1,b:null,k:null,d:function(n){if(this.b!==n){this.b=n;this.dU("ActionMessage","HideDefaultMessage")}return n},h:function(n){this.e=n;n&&this.a(!1);this.dU("HideDefaultMessage","ShowNotification");return n},t:function(n){this.p=n;this.v(n?this.m:this.i);this.dQ("ActivitySucceeded");return n},v:function(n){this.k=n;this.dQ("NotificationIcon");return n},a:function(n){this.c=n;n&&this.h(!1);this.dQ("IsInProgress");return n},r:function(){return this.e||!this.b},q:function(n,t){this.h(!0);this.t(n);this.d(t)},l:function(n){this.h(!1);this.a(!1);this.d(n)},o:function(n){if(this.n>0){var t=this;_js.g.a().a(_a.a.dv,"ActivityStatusViewModelTimer",function(){t.g();n&&n()},this.n)}else{this.g();n()}},g:function(){this.d(null);this.h(!1);this.a(!1)}};_d.l=function(n,t){this.k=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.r);_d.l.initializeBase(this);this.g=n;this.h=t};_d.l.prototype={g:null,b:null,a:null,h:null,c:!1,d:!1,o:function(){return this.d&&_d.l.b},f:function(n){if(this.d!==n){this.d=n;this.dQ("IsEnabled")}return n},i:function(n){if(this.c!==n){this.c=n;this.dQ("IsLoading")}return n},j:function(n){if(this.b!==n){this.b=n;this.dQ("SelectedCulture")}return n},t:function(n){if(_d.l.b!==n){_d.l.b=n;this.dQ("IsInitialized")}return n},m:function(){if(_d.l.b){this.e(_g.a.a().c().bl.UserCulture);this.f(!0)}else{this.i(!0);this.e(_g.a.a().c().bl.UserCulture);this.p()}},n:function(n){if(!_d.l.b){var t;this.a=(t=new _g.dP,t.LCID=n,t);return}var r=this;var i=_d.l.a.h(function(t){return t.LCID===n});i<_d.l.a.x.length&&this.j(_d.l.a.x[i])},e:function(n){if(!_d.l.b){var t;this.a=(t=new _g.dP,t.Name=n,t);return}var r=this;var i=_d.l.a.h(function(t){return t.Name===n});i<_d.l.a.x.length&&this.j(_d.l.a.x[i])},p:function(){var n=new _c.bD;n.w(this.l);n.v(this.k);this.g.a(n)},q:function(n){this.i(!1)},r:function(n){_d.l.a=new _js.f;for(var i=n.c,t=0;t<i.length;t++)_d.l.a.a(i[t]);this.t(!0);this.i(!1);if(this.a){_js.d.a(this.a.Name)?this.a.LCID>0&&this.n(this.a.LCID):this.e(this.a.Name);this.a=null}this.f(!0)}};_d.z=function(n,t){_d.z.initializeBase(this);this.l=n;this.r=t};_d.z.prototype={l:null,r:null,n:null,o:null,e:null,g:!1,k:null,f:null,h:null,q:null,m:null,a:function(){return this.e},w:function(n){if(n===this.e)return n;this.e=n;this.dQ(_d.z.a);return n},b:function(n){this.m=n;return n},p:function(n){if(n===this.h)return n;this.h=n;this.dQ(_d.z.b);return n},t:function(n){if(n===this.k)return n;this.k=n;this.dQ(_d.z.c);return n},j:function(){return this.l.a()==="TouchNarrow"?_y.hJ.prototype.j.call(this):0},cx:function(){_js.Trace.logInfo(_a.a.I,"UIRPVM ->PostTransitionIn");_y.hJ.prototype.cx.call(this)},cy:function(){_y.hJ.prototype.cy.call(this);this.m&&this.m.E(!1)},c:function(n,t){this.n=n;this.o=t},d:function(n,t){if($a(n))throw Error.argumentNull("item");if(n!==this.e){this.w(n);this.g=t;var i=this.e.gx();this.f=_h.a.a(i);$a(this.f)?this.t(_u.R.Mz):this.t(String.format(_nbs.a.k,this.f.bl.DisplayName));this.e.bw()?this.e.bw()===3&&this.g?this.p(_nbs.a.BP):this.p(_nbs.a.Bg):this.p(_nbs.a.Yh);this.x()}},x:function(){if(this.l.a()==="TouchNarrow"){var n=_y.i.a(this);n.i(new _C(this.hE,_a.a.I));this.ds(n)}}};_d.di=function(){};_d.di.registerInterface("_d.di");_d.S=function(n,t,i){this.o=Function.createDelegate(this,this.A);this.p=Function.createDelegate(this,this.B);_d.S.initializeBase(this);this.q=n;this.h=t;this.g=i};_d.S.prototype={q:null,j:null,c:null,d:null,h:null,g:null,a:function(){return this.c},r:function(n){if(this.c!==n){this.c=n;this.bj("SortByContextMenu")}return n},z:function(n){if(this.j!==n){this.j=n;this.bj("SortByButtonLabel")}return n},b:function(n){this.d=new _d.cW;this.d.h=n.b;this.d.m(n.d);this.d.n(n.e);this.s();this.g.t(this.d.g(!1))},s:function(){this.r(new _fm.f(new Array(0)));this.v();this.c.h.a(new _fm.j);this.t();this.k();this.bj("SortByContextMenu")},k:function(){this.z(String.format(_u.R.XM,_u.R.Rc,this.d.d.e()))},B:function(n){if(this.d.d.a()===n.i){this.f("ColumnId_"+n.i,!0);return}this.f("ColumnId_"+this.d.d.a(),!1);this.d.t(n);this.f("ColumnId_"+n.i,!0);this.C();this.g.t(this.d.g(!1));this.g.U(4);this.h.a(this.d);this.k()},f:function(n,t){for(var i=0;i<this.c.h.x.length;i++)if(_fm.h.isInstanceOfType(this.c.h.x[i])&&this.c.h.x[i].l===n){this.c.h.x[i].a(t);this.c.h.x[i].h(t);break}},v:function(){this.c.h.a(new _fm.n(_u.R.Yp));for(var t=0;t<this.d.c.x.length;t++){var n=this.d.c.x[t];if(n.j){var i=new(_a.gH.$$(_d.M))(n,this.p);this.c.h.a(new _fm.h(n.l,null,new _C(i.a,_d.S.a),n.k,!1,null,null,"ColumnId_"+n.i))}}},t:function(){this.c.h.a(new _fm.n(_u.R.OF));for(var t=0;t<this.d.e.x.length;t++){var n=this.d.e.x[t];var i=new(_a.gH.$$(_d.cV))(n,this.o);this.c.h.a(new _fm.h(n.b,null,new _C(i.a,_d.S.a),n.a===this.d.f,!1,null,null,"Order_"+n.a))}},C:function(){for(var n=0;n<this.c.h.x.length;n++)if(_fm.n.isInstanceOfType(this.c.h.x[n])&&this.c.h.x[n].h===_u.R.OF){this.c.h.x[n+1].y("Order_"+this.d.e.x[0].a);this.c.h.x[n+1].k(this.d.e.x[0].b);this.c.h.x[n+1].h(!0);this.c.h.x[n+1].a(!0);this.c.h.x[n+2].y("Order_"+this.d.e.x[1].a);this.c.h.x[n+2].k(this.d.e.x[1].b);this.c.h.x[n+2].h(!1);this.c.h.x[n+2].a(!1);break}},A:function(n){if(n.a===this.d.f){this.f("Order_"+n.a,!0);return}this.f("Order_"+this.d.f,!1);this.f("Order_"+n.a,!0);this.d.k(n.a);this.g.t(this.d.g(!1));this.h.a(this.d);this.g.U(4)}};_d.cw=function(n,t,i){this.a=n;this.b=t;this.c=i};_d.cw.prototype={a:null,b:null,c:null};CoreViewModelsComponent.registerClass("CoreViewModelsComponent",null,_a.iR);_d.bV.registerClass("_d.bV",_a.by);_d.bB.registerClass("_d.bB",_a.by);_d.ce.registerClass("_d.ce",null,IModernGroupMembershipRequestHeaderViewModelFactory);_d.cz.registerClass("_d.cz",_a.ca);_d.cq.registerClass("_d.cq",null,ISendFailureNotificationProviderViewModel);_d.cr.registerClass("_d.cr",null,ISendNotificationProviderViewModel);_d.cy.registerClass("_d.cy",_js.x,IUserOofNotificationProvider);_d.bX.registerClass("_d.bX",null,IGroupCardViewModelFactory);_d.e.registerClass("_d.e",_cm.bw);_d.ch.registerClass("_d.ch",null,IOwaOptionPeoplePickerViewModelFactory,_bc.bd);_d.N.registerClass("_d.N",_a.by);_d.bW.registerClass("_d.bW",_a.by);_d.C.registerClass("_d.C",_a.jV,IFolderPickerContainer);_d.bU.registerClass("_d.bU",null,_y.eY,_js.s);_d.bZ.registerClass("_d.bZ",null,IModuleHelpProvider);_d.bG.registerClass("_d.bG",_a.by,IOpenAnotherMailboxViewModel);_d.bF.registerClass("_d.bF",null,IOfflineHelpProvider);_d.J.registerClass("_d.J",_a.by);_d.bK.registerClass("_d.bK",_a.by);_d.bL.registerClass("_d.bL",_a.by);_d.bg.registerClass("_d.bg",_y.hJ);_d.dh.registerClass("_d.dh",_a.by);_d.cA.registerClass("_d.cA",_d.dh);_d.b.registerClass("_d.b",_bc.j,_bc.bI);_d.bk.registerClass("_d.bk",_a.by,_y.hc);_d.bQ.registerClass("_d.bQ",null,IApprovalRequestHeaderViewModelFactory);_d.bT.registerClass("_d.bT",_y.hJ);_d.bz.registerClass("_d.bz",_lv.g);_d.cK.registerClass("_d.cK",null,IItemReadingPaneContextFactory);_d.cc.registerClass("_d.cc",null,IMailErrorHandler);_d.cd.registerClass("_d.cd",_a.by);_d.r.registerClass("_d.r",_bc.j,IMailFolderPermissionsDialogViewModel);_d.br.registerClass("_d.br",_a.by,_y.hr);_d.bA.registerClass("_d.bA",_a.by,IExtendedSharedFolderViewModel);_d.x.registerClass("_d.x",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable);_d.bd.registerClass("_d.bd",_d.x);_d.w.registerClass("_d.w",_d.x);_d.F.registerClass("_d.F",_d.x);_d.O.registerClass("_d.O",_d.x);_d.cL.registerClass("_d.cL",_js.x);_d.y.registerClass("_d.y",_a.by);_d.P.registerClass("_d.P",_bc.U.$$(_d.y));_d.cg.registerClass("_d.cg",_y.hJ,IOptionsViewModel);_d.t.registerClass("_d.t",_d.cg,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable);_d.cf.registerClass("_d.cf",_d.cg);_d.T.registerClass("_d.T",_d.x);_d.bv.registerClass("_d.bv",_a.by);_d.bc.registerClass("_d.bc",_d.x);_d.A.registerClass("_d.A",_d.x);_d.bl.registerClass("_d.bl",_a.by);_d.cY.registerClass("_d.cY",null,_d.db);_d.bn.registerClass("_d.bn",_d.cY);_d.Z.registerClass("_d.Z");_d.i.registerClass("_d.i",_a.by,_bc.bN);_d.bb.registerClass("_d.bb",_a.by);_d.bp.registerClass("_d.bp");_d.bD.registerClass("_d.bD",_ph.u,_ff.w);_d.bY.registerClass("_d.bY");_d.bC.registerClass("_d.bC");_d.cJ.registerClass("_d.cJ",_a.by);_d.c.registerClass("_d.c",_a.by,_bc.bL);_d.h.registerClass("_d.h",_bc.U.$$(_d.c));_d.cZ.registerClass("_d.cZ",_bc.U.$$(_d.h));_d.cB.registerClass("_d.cB",_a.by,_bc.n);_d.bm.registerClass("_d.bm");_d.cM.registerClass("_d.cM",_ph.g);_d.bq.registerClass("_d.bq");_d.cb.registerClass("_d.cb",null,ILinkSummaryCardViewModelFactory);_d.Y.registerClass("_d.Y",_js.x,IPeopleSearchSuggestionAdaptorViewModel,_y.hu,_js.z);_d.n.registerClass("_d.n",_d.cZ,_ff.w,_bc.bK);_d.cm.registerClass("_d.cm",_d.cn.$$(_a.c));_d.I.registerClass("_d.I",_d.cn.$$(_g.d));_d.cl.registerClass("_d.cl",_d.cn.$$(_g.w));_d.q.registerClass("_d.q",_d.cn.$$(_g.k));_d.ba.registerClass("_d.ba",_d.cn.$$(_g.p));_d.cS.registerClass("_d.cS",_d.cn.$$(Array));_d.u.registerClass("_d.u",_d.cn.$$(String));_d.co.registerClass("_d.co",_d.cY);_d.Q.registerClass("_d.Q",_a.by,_y.be);_d.bx.registerClass("_d.bx");_d.bJ.registerClass("_d.bJ");_d.bP.registerClass("_d.bP");_d.S.registerClass("_d.S",_js.x,_d.di);_d.by.registerClass("_d.by",_d.S);_d.R.registerClass("_d.R",_a.by);_d.bh.registerClass("_d.bh",_a.by);_d.cT.registerClass("_d.cT",_a.by);_d.bu.registerClass("_d.bu",_bc.j);_d.bi.registerClass("_d.bi",_a.by);_d.cU.registerClass("_d.cU",_d.bi);_d.bN.registerClass("_d.bN",_y.hJ);_d.B.registerClass("_d.B",_d.bi);_d.bj.registerClass("_d.bj",_d.bi);_d.cV.registerClass("_d.cV",_lv.v);_d.K.registerClass("_d.K",_lv.g);_d.bO.registerClass("_d.bO");_d.L.registerClass("_d.L",_y.hJ);_d.cW.registerClass("_d.cW",_lv.l);_d.M.registerClass("_d.M",_lv.k);_d.m.registerClass("_d.m",_a.ea,_bc.bM);_d.k.registerClass("_d.k",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable,_d.dd,_y.cT);_d.ct.registerClass("_d.ct",null,ITaskReadingPaneViewModelFactory);_d.cu.registerClass("_d.cu",null,ITaskReadingPaneViewModelPopOutFactory,_bc.bd);_d.cv.registerClass("_d.cv",_a.by);_d.bw.registerClass("_d.bw",_js.x,_js.s);_d.f.registerClass("_d.f",_a.by);_d.s.registerClass("_d.s",_a.by,_y.hr);_d.cx.registerClass("_d.cx",null,IUMMessagePostHeaderViewModelFactory);_d.bI.registerClass("_d.bI",null,IUploadPhotoViewModelFactory);_d.bf.registerClass("_d.bf",_a.by,_bc.T,_js.z,Sys.IDisposable,_y.A,_bc.t,_a.jO,_y.dq,_bc.i,_bc.q,_y.be);_d.bs.registerClass("_d.bs",_d.bf,_y.cC,_y.hq,_bc.T,_js.z,Sys.IDisposable);_d.G.registerClass("_d.G",_d.bs,_d.dc);_d.E.registerClass("_d.E",_d.bf,_y.cC,_bc.I,_bc.T,_js.z,Sys.IDisposable);_d.d.registerClass("_d.d",_d.E);_d.U.registerClass("_d.U",_a.by);_d.H.registerClass("_d.H",_y.hJ);_d.X.registerClass("_d.X",_d.x);_d.cj.registerClass("_d.cj",_ph.f);_d.D.registerClass("_d.D",_js.x);_d.cO.registerClass("_d.cO",_d.D);_d.bt.registerClass("_d.bt",_C);_d.V.registerClass("_d.V",_y.hJ);_d.be.registerClass("_d.be",_d.V,_y.cC);_d.cP.registerClass("_d.cP",_d.D);_d.cQ.registerClass("_d.cQ",_a.by);_d.p.registerClass("_d.p",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable,_pc.x);_d.W.registerClass("_d.W",_d.p,_y.cC);_d.cR.registerClass("_d.cR",_d.D);_d.de.registerClass("_d.de",_d.E);_d.j.registerClass("_d.j",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable,_y.hH);_d.cC.registerClass("_d.cC",null,_js.S);_d.bS.registerClass("_d.bS",null,_js.S);_d.cE.registerClass("_d.cE",null,_js.S);_d.cG.registerClass("_d.cG",null,_js.S);_d.v.registerClass("_d.v",_a.by);_d.l.registerClass("_d.l",_a.by);_d.z.registerClass("_d.z",_y.hJ,IUnsupportedItemReadingPaneViewModel);_d.cw.registerClass("_d.cw");CoreViewModelsComponent.$$cctor();_d.e.a=null;_d.e.b=null;_d.C.a=_a.a.o;_d.bg.a=_a.a.x;_d.b.a=new _H("IsVisible",Boolean,_d.b,!1);_d.b.c=new _H("IsError",Boolean,_d.b,!1,null,_d.b.l);_d.b.j=new _H("IsRetriable",Boolean,_d.b,!1);_d.b.d=new _H("IsListening",Boolean,_d.b,!1,null,_d.b.m);_d.b.e=new _H("IsThinking",Boolean,_d.b,!1,null,_d.b.n);_d.b.f=new _H("SpeechLevel",Number,_d.b,0);_d.b.h=new _H("StateDescription",String,_d.b,"");_d.b.b=new _H("AdditionalInformation",_js.f,_d.b);_d.b.k=new _H("NoResultsAvailableText",String,_d.b,_nbs.a.PV);_d.b.g=new _H("StartListeningCommand",_js.u,_d.b);_d.b.i=new _H("StopListeningCommand",_js.u,_d.b);_d.r.a=_a.a.o;_d.r.b=null;_d.r.$$cctor();_d.br.a=_a.a.dk;_d.bd.a=_a.a.d;_d.w.a=_a.a.d;_d.F.a=_a.a.d;_d.O.a=_a.a.d;_d.x.a=_a.a.d;_d.P.a=new _H("LastSelectedItem",_d.y,_d.P,null,null,null);_d.t.a=_a.a.d;_d.bv.a="\\((?:UTC|GMT)[\\s\\d\\+\\-:]*\\)";_d.A.a=_a.a.cq;_d.i.a=_a.a.v;_d.Y.a=_a.a.F;_d.h.b=_a.a.v;_d.c.c=_a.a.v;_d.Q.a=_a.a.be;_d.R.a=_a.a.bz;_d.bM.a=_a.a.bz;_d.bu.a=_a.a.bz;_d.B.a=_a.a.bz;_d.bj.a=_a.a.bz;_d.K.a=_a.a.fb;_d.L.b=175;_d.L.a=47;_d.L.c=200;_d.m.f=new _H("Task",_g.F,_d.m);_d.m.a=new _H("EditedTask",_g.F,_d.m);_d.m.d=new _H("IsNewTask",Boolean,_d.m);_d.m.c=new _H("IsEditMode",Boolean,_d.m);_d.m.b=new _H("IsDraft",Boolean,_d.m);_d.m.e=new _H("PopoutPerfContext",_a.bN,_d.m);_d.k.a=_a.a.bz;_d.f.a=_a.a.eH;_d.f.b=new _H("CanDial",Boolean,_d.f,!0);_d.f.g=new _H("PlayOnPhoneActive",Boolean,_d.f,!1);_d.f.c=new _H("DialString",String,_d.f,"");_d.f.e=new _H("MessageText",String,_d.f,"");_d.f.h=new _H("PlayOnPhoneCommand",_js.u,_d.f);_d.f.i=new _H("PlayOnPhoneDisconnectCommand",_js.u,_d.f);_d.f.f=new _H("PlayOnPhoneActiveCommand",_js.u,_d.f);_d.f.d=new _H("IsPhoneCallActive",Boolean,_d.f,!1);_d.s.a=new _H("Item",_g.de,_d.s);_d.s.c=new _H("Source",_d.cw,_d.s,null);_d.s.b=new _H("PlayOnPhoneViewModel",_d.f,_d.s);_d.bs.a=_a.a.v;_d.d.f="Members";_d.d.g="Owners";_d.d.e="HideSendEmail";_d.d.h="SendEmailToGroupAriaLabel";_d.d.c="IsGroupOwnersPivotSelected";_d.d.a="IsGroupMembersPivotSelected";_d.d.b="IsGroupNotesPivotSelected";_d.D.b="LinkingActionInProgress";_d.D.c="ErrorCode";_d.V.a=_a.a.cB;_d.p.c="HeaderTextViewModel";_d.p.b="HeaderImageViewModel";_d.p.d="SingleComponent";_d.p.e="SingleComponentText";_d.p.a=_a.a.cB;_d.bf.b="Persona";_d.bf.a=_a.a.v;_d.E.a=_a.a.v;_d.E.c=!1;_d.E.b=!1;_d.j.a=_a.a.cf;_d.l.a=null;_d.l.b=!1;_d.z.a="CurrentItem";_d.z.b="ItemNotSupported";_d.z.c="MoveButtonText";_d.S.a=_a.a.bz;
window.scriptsLoaded['microsoft.owa.core.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
