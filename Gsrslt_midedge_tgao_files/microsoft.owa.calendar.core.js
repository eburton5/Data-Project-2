try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.core.js'] = (new Date()).getTime();
Type.registerNamespace("_cc");_cc.cN=function(n,t,i){_cc.cN.initializeBase(this);this.a=n;this.h=n.H();this.d=t;this.g=i};_cc.cN.prototype={a:null,g:null,d:null,h:!1,c:function(){return!0},s:function(n){var i=new _g.Am(this.x);i.shouldPrecedeOfflineSyncActions=this.c();i.explicitLogonUser=this.g;var t=new _g.iZ;t.CalendarId=new _g.R(_g.s.a(this.a.bl.ParentFolderId));t.EventId=_g.g.a(_h.T.a(this.a));var r=new _g.mS(this.y());r.Body=t;n.i(r,i,this.f,this.e)},E:function(){_a.dg.prototype.E.call(this);var n=this.d;n&&(this.h?n.i(this.a.bl.InstanceKey):n.J(this.a.bl.ItemId))}};_cc.df=function(){};_cc.df.registerInterface("_cc.df");_cc.U=function(n,t,i,r){this.h=Function.createDelegate(this,this.g);this.c=n;this.e=t;this.d=i;this.b=r};_cc.U.prototype={c:null,b:null,e:null,d:null,a:null,f:null,g:function(){this.a&&(this.a.l!==this?this.a.R(this):this.a.n&&this.a.R(null))}};_cc.cO=function(n,t,i,r,u,f){_cc.cO.initializeBase(this,[n,t,null,f]);this.D=n;this.U(r);this.R(u);this.E=i};_cc.cO.prototype={D:null,l:null,E:null,L:!0,n:!0,F:!1,R:function(n){if(this.l!==n){this.l&&!this.F&&this.l.f.h(!1);this.l=n;this.l&&!this.F&&this.l.f.h(!0);this.bj("CurrentOption");this.T();this.E&&(this.l?this.E(this.l.d):this.E(null));this.F&&(this.l=null)}return n},S:function(n){if(this.L===n)return n;this.L=n;this.T();return n},U:function(n){for(var u=n.length,r=new Array(u),i=0;i<u;i++){var t=n[i];t.a=this;r[i]=new _fm.h(t.c,t.e,new _C(t.h,_a.a.B),this.l===t,!1,null,t.b,t.d);r[i].F(!1);t.f=r[i]}this.A(new _fm.f(r))},T:function(){!this.L||$a(this.l)||_js.d.b(this.l.c)?this.k(this.D):_js.d.b(this.D)?this.k(this.l.c):this.k(String.format("{0}: {1}",this.D,this.l.c))}};_cc.P=function(n,t){_cc.P.initializeBase(this);if(n)this.d=new _C(n,_cc.P.a);else{var r=this;var i=function(){};this.d=new _C(i,_cc.P.a)}this.c(t)};_cc.P.prototype={d:null,e:!1,a:function(){return this.d},b:function(){return this.e},c:function(n){this.e=n;this.bj("ShowPopOutControl");return n}};var ICalendarMiniatureQueryTableFactory=function(){};ICalendarMiniatureQueryTableFactory.registerInterface("ICalendarMiniatureQueryTableFactory");function CalendarCoreComponent(){}CalendarCoreComponent.$$cctor=function(){_a.p.a().a(CalendarCoreComponent)};CalendarCoreComponent.prototype={a:function(n,t,i){_cc.c.o(i.e(),i.a());var r=n.a(_a.h);var k=this;n.b(_cc.a,function(){return new _cc.a(n.a(_a.h),n.a(_g.f))}).a();var d=this;n.b(CalendarsCache,function(){return new CalendarsCache(n.c(IBirthdayCalendarFactory),n.a(_cc.bJ),n.a(_a.h),n.a(_g.f),n.a(_a.q))}).b(ICalendarsCache).b(_cc.h).a().c(_g.i.g);var b=this;n.b(_cc.Z,function(){return new _cc.Z(n.a(_g.f),n.a(_a.q))}).b(_cc.bJ).a();var p=this;n.b(_cc.bH,function(){return new _cc.bH(n.a(_a.q))}).a();var w=this;n.b(_cc.V,function(){return new _cc.V(10,n.a(CalendarsCache),n.a(_cc.bM),r.a().c().Enabled?n.d(IModernGroupCalendarsProvider):null,n.a(_js.k),n.a(_ff.c),n.a(_cc.a))}).a().b(_cc.u);var it=this;n.b(_cc.bM,function(){return new _cc.bM(i.a(),i.d()==="AnonymousCalendar",n.a(_g.f),n.a(_a.q))}).a();var rt=this;n.b(_cc.bI,function(){return new _cc.cs}).a();var tt=this;n.b(_cc.w,function(){return new _cc.w(n.a(_a.h),n.a(_cc.u).a(),n.a(_cc.bH),n.a(CalendarsCache),n.a(_cc.bI))}).a();var g=this;n.b(_cc.bt,function(){return new _cc.bt(n.a(_y.a),n.c(IComposeCalendarItemViewModelFactory))}).a();var nt=this;n.b(ICalendarPrefetcher,function(){return OwaApplication.b?null:new _cc.cx(n.a(CalendarsCache),n.a(_cc.bI),n.a(_ff.a),i.b())}).a();var y=this;n.b(_cc.j,function(){return new _cc.j(n.a(_y.a))}).a();var o=this;n.b(_cc.bV,function(){var t=r.a().bY().Enabled&&!n.a(_h.m).a();return new _cc.bV(n.a(_a.q),n.a(_y.a),n.d(IMailComposeContextFactory),n.f(_cc.bw),n.a(_cc.w),n.a(_ff.c),n.a(_cc.j),t)}).a();var s=this;n.b(_cc.bn,function(){return new _cc.bn(n.a(_ff.c))}).b(_cc.g).a();var e=this;n.b(_cc.K,function(){return new _cc.K(n.a(_y.cV),n.a(_cc.bx),n.f(_cc.bV),n.a(_a.e),n.f(_cc.bU),n.f(_cc.bw),n.a(_g.cs),n.a(_a.Z))}).a();var u=this;n.b(_cc.bU,function(){return new _cc.bU(n.d(IComposeCalendarItemViewModelFactory),n.d(IComposeBookingItemViewModelFactory),n.c(ICalendarItemDetailsViewModelFactory),n.c(IBirthdayFactory),n.a(_y.a),n.a(CalendarsCache),n.a(_cc.g))}).a();var f=this;n.b(_cc.bw,function(){return new _cc.bw(n.d(IMailComposeViewModelFactory),n.a(_y.a))}).b(ICalendarMailComposeConductorFactory).a();var a=this;n.b(_cc.bx,function(){return new _cc.bx(n.a(IInferenceTracker),n.a(_a.q),n.a(_y.a),n.a(_g.cs),n.a(_a.e),n.f(IProposeNewTimeManager),_cc.B.a(n.a(_a.h)),n.a(_cc.w))}).b(IMeetingResponseViewModelFactory).a();var v=this;n.b(_cc.bz,function(){return new _cc.bz(n.a(_ff.c),n.a(_a.h),n.a(_y.a).a())}).a();var l=this;n.b(_cc.bi,function(){return new _cc.bi(n.a(_y.a),n.a(CalendarsCache),n.a(_a.q))}).a();var h=this;n.b(IMeetingResponseEditorViewModel,function(){return new MeetingResponseEditorViewModel}).a();var c=this;n.b(_cc.bW,function(){return r.a().G().Enabled?new _cc.bW(n.f(ICalendarsCache),n.f(_cc.u),n.a(_ff.c)):null}).a()},b:function(){return[new _a.B(_cc.bz,2,9),new _a.B(_cc.bW,2,1)]}};_cc.bz=function(n,t,i){var r=this;_cc.bZ.$$(_g.cV).a=function(t){(_cc.bD.isInstanceOfType(t)||_cc.bE.isInstanceOfType(t)||_cc.bK.isInstanceOfType(t)||_cc.bL.isInstanceOfType(t)||_cc.bF.isInstanceOfType(t)||_cc.bG.isInstanceOfType(t)||_cc.bN.isInstanceOfType(t))&&n.a(_h.ca,new _h.ca)}};_cc.da=function(){};_cc.da.registerInterface("_cc.da");var IWeatherLocationProvider=function(){};IWeatherLocationProvider.registerInterface("IWeatherLocationProvider");var IWeatherProvider=function(){};IWeatherProvider.registerInterface("IWeatherProvider");_cc.db=function(){};_cc.db.registerInterface("_cc.db");var ICalendarItemViewModel=function(){};ICalendarItemViewModel.registerInterface("ICalendarItemViewModel");_cc.T=function(){};_cc.T.prototype={none:0,flight:1,package:2,personalEvent:3,flightLayover:4,preFlight:5};_cc.T.registerEnum("_cc.T",!1);var IWeatherControllerViewModel=function(){};IWeatherControllerViewModel.registerInterface("IWeatherControllerViewModel");_cc.cI=function(n,t){this.e=Function.createDelegate(this,this.f);this.c=t;this.d=n};_cc.cI.prototype={c:null,d:null,b:function(){return!0},a:function(n,t,i,r){return new _C(this.e,_a.a.bc)},f:function(){var n=this;this.c.a(function(t){t.f(n.d.e.cs)})}};_cc.bd=function(n,t,i,r){this.t=Function.createDelegate(this,this.I);this.p=Function.createDelegate(this,this.m);this.o=Function.createDelegate(this,this.x);this.r=Function.createDelegate(this,this.F);this.q=Function.createDelegate(this,this.y);_cc.bd.initializeBase(this);this.n=n;this.e=t;this.a=i;this.l=r;this.f=new _C(this.q,_cc.bd.a);this.d=new _C(this.r,_cc.bd.a,this.a,"CalendarEntry",this.o)};_cc.bd.prototype={f:null,d:null,n:!1,a:null,e:null,l:null,k:null,c:null,h:null,v:function(n){this.dV("CategoriesChanged",n)},w:function(n){this.dW("CategoriesChanged",n)},H:function(n){if(this.c!==n){this.c=n;this.dQ("CategoryManagementDialog")}return n},A:function(){return this.a.bv()},b:function(){this.k||(this.k=new _y.ci(this.e,this.p,this.f,this.d));return this.k},B:function(){if(this.h)return this.h;this.h=new _ff.e;if(this.e&&this.j()){var t=this.e.e();var r=this.a.bv()?this.a.bv().f():new Array(0);r.sort(_cc.c.d);for(var e=t.length,f=r.length,n=0,i=0;n<e;n++){var u=!1;if(i<f&&t[n].bl.Name===r[i]){u=!0;i++}this.h.c(this.z(t[n].bl.Name,u))}}return this.h},i:function(){return this.j()?this.b().c():null},j:function(){return!this.a.bE()},g:function(){this.b().a(this.D(),1)},m:function(n,t,i,r){var e=this.a.bv();var o=n?n.bl.Name:null;var u=t?t.bl.Name:null;var f=_g.bs.a(e,i,u,o);this.a.dH(f);this.dX("CategoriesChanged")},I:function(n,t,i){var r=new _h.bS(n,t,i,this.C());var u=this;r.w(function(){var n=r.a;u.e.c(n);u.dQ("MasterCategories")});r.v(_cc.j.a);this.l.a(r)},C:function(){return _g.i.a(this.a)},D:function(){var n={};if(this.a.bv()&&this.a.bv().b()>0){var t=this.a.bv().f();n["Compose Form Item Categories"]=t}return n},y:function(){this.m(null,null,!0,null)},x:function(){var n=this.a.e();return this.n&&(_g.D.isInstanceOfType(n)&&!n.bl.IsReadOnly||this.a.bI())?!0:!1},F:function(){this.E();this.c.G()},E:function(){this.c||this.H(new _y.U(this.e,this.t))},z:function(n,t){var f=this;var r=new _y.g("dummy",new _C(function(){},_cc.bd.a));var u=this;var i=new _y.g(n,new _C(function(){u.G(r)},_cc.bd.a));r=i;i.z();i.x(t);return i},G:function(n){var i=null;var t=null;if(n.w()){i=new _g.bA;i.e(n.b)}else{t=new _g.bA;t.e(n.b)}this.m(i,t,!1,null)}};_cc.bi=function(n,t,i){this.d=n;this.a=t;this.b=i};_cc.bi.prototype={d:null,a:null,b:null,c:function(n){if(!this.a.p){_js.Trace.logError(_a.a.Q,"Make sure that calendarcache is loaded before creating CalendarCategoryViewModel");return null}var t=this.a.f(n.bl.ParentFolderId);return t?new _cc.bd(this.d.c(),t,n,this.b):null}};_cc.cX=function(n,t){this.c=Function.createDelegate(this,this.x);this.a=n;this.l=t||null;this.g()};_cc.cX.prototype={a:null,l:null,e:null,x:function(n,t){this.f()},f:function(){this.a.e(this.e);this.d()},h:function(n,t){if(_cc.c.c(n)){var u=0;var f=1;var i=new Array(2);i[u]=4600;i[f]=6200;var r=new Array(2);r[u]=1100;r[f]=2200;var e=t?i:r;n.H()?this.a.a(e[f]):this.a.a(e[u])}},t:function(n,t){n.P()&&t&&!n.A()&&this.a.a(1400)},s:function(n){if(n.N()){var i=_u.c.Bf;var t=_u.c.Bf;if(n.I()){t=n.I().a(5);i=n.I().a(0)}this.a.a(1200,t,i)}},q:function(n){n.P()||n.N()||_cc.c.c(n)||(n.R()==="NoResponseReceived"||n.R()==="Unknown")&&(n.A()||this.a.a(1300))},r:function(n,t){if(!n.bl.IsOrganizer&&n.fn()){var f=_js.d.b(n.bl.AppointmentReplyName)||t.bl.UserDisplayName===n.bl.AppointmentReplyName;var e=n.fn().a(5);var o=n.fn().a(0);var i=null;i=f?[e,o]:[n.bl.AppointmentReplyName,e,o];var u=this.v(n.R(),f);if(u!==-1){var r;(r=this.a).a.apply(r,[u].concat(i))}}},u:function(n,t){var r=this;var i=function(){r.w(n)};this.m(t,i,_u.c.Dc)},m:function(n,t,i){this.a.t=!0;if(n.d.length===1){var r=n.d[0];var f=new _cc.bk;var u=f.a(r.a,null);t?this.a.d(6701,[r.b,u],i,t):this.a.a(6701,r.b,u)}else n.d.length>1&&this.a.d(6702,null,i,t)},w:function(n){var t=new _y.I;t.b(n);this.l.a(t)},v:function(n,t){var i=-1;switch(n){case"Accept":i=t?1600:1700;break;case"Tentative":i=t?1800:1900;break;case"Decline":i=t?2e3:2100;break;default:break}return i}};_cc.v=function(){};_cc.v.e=function(n,t){var u=n;var r=t;var i=u.l().b(r.l());return i?i:_cc.v.b(u,r)};_cc.v.a=function(n,t){return _cc.v.b(n,t)};_cc.v.b=function(n,t){var i=t.h()-n.h();if(i)return i;i=_cc.v.c(t)-_cc.v.c(n);if(i)return i;i=n.a().g(t.a());if(i)return i;i=(n.e()&&n.e().e()?0:1)-(t.e()&&t.e().e()?0:1);if(i)return i;i=_cc.v.d(n.k())-_cc.v.d(t.k());if(i)return i;i=t.b().g(n.b());return i?i:_cc.v.f(n,t)};_cc.v.f=function(n,t){return n.m()?t.m()?n.m().localeCompare(t.m()):-1:t.m()?1:0};_cc.v.d=function(n){switch(n){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}};_cc.v.c=function(n){var t=n.b().g(n.a());return t>864e5?Math.ceil(t/864e5):1};_cc.bu=function(){};_cc.bu.prototype={a:0,c:!1,b:!1,f:function(){this.a=1;return this},g:function(){this.a=2;return this},e:function(){this.c=!0;return this},d:function(){this.b=!0;return this}};_cc.bT=function(n,t,i,r,u,f){_cc.bT.initializeBase(this);this.e=n;this.c=r;this.h=i;this.f=t;this.g=u;this.d=f};_cc.bT.prototype={f:null,h:null,e:null,c:null,g:null,d:null,b:function(){return this.j()||this.k()},j:function(){return this.c.d.h()},n:function(){return this.c.d.h()&&this.l()},k:function(){return this.c.d.bi()},o:function(){return this.c.d.bi()&&this.l()},l:function(){return this.c.c.bE()},a:function(n,t,i,r){var e=null;var f=null;var u=null;r=r||new _cc.bu;switch(n){case 1:var s=this;e=function(){s.f.a(function(n){s.r(n,t,i,r.a)})};f="CanOpenItemInRead";var l=this;u=function(){return l.k()};if(t){f="CanOpenSeriesInRead";var a=this;u=function(){return a.o()}}break;case 0:var o=this;e=function(){o.h.a(function(n){o.q(n,t,i,r.c,r.b)})};f="CanOpenItemInCompose";var c=this;u=function(){return c.j()};if(t){f="CanOpenSeriesInCompose";var h=this;u=function(){return h.n()}}break}return new _C(e,_cc.bT.a,this,f,u)},v:function(){this.d.b(null);_a.y.endPT("OpenCalendarItemOnReadingPane")},t:function(){this.d.c();this.d.b(null)},r:function(n,t,i,r){_a.y.stPT(_a.a.k,"OpenCalendarItemOnReadingPane",3);t?this.d.a(_a.a.k,_cc.x.b("OpenCalendarSeriesItemOnReadingPane"),!0,null):this.d.a(_a.a.k,_cc.x.b("OpenCalendarItemOnReadingPane"),!0,null);var o=this.m(t);var s=this.i();var e=this;var u=function(n){$a(r)||n.g(r);e.v()};var f=n.d(o.a,null,!0,!0,u);this.d.f();this.e.f(f,s,!1);i&&i()},i:function(){if(this.e.c()){var n=this.e.p();return ICalendarItemDetailsViewModel.isInstanceOfType(n.a())||IComposeCalendarItemViewModel.isInstanceOfType(n.a())?1:0}else return 1},q:function(n,t,i,r,u){t?this.d.a(_a.a.k,_cc.x.b("OpenCalendarSeriesItemOnComposeForm"),!0,null):this.d.a(_a.a.k,_cc.x.b("OpenCalendarItemOnComposeForm"),!0,null);var o=this.m(t);var h=this.i();var c=_js.e.s(_a.a.k,2,"Setting ComposeCalendarItemVM");var s=this;var e=function(n){s.t()};var f=n.d(r?this.p():o.a,null,null,e,null);_js.e.e(c);this.d.f();u?f.g():this.e.f(f,h,!1);i&&i()},m:function(n){var t=new _y.I;n?t.n(new _h.T(this.c.c.bl.ItemId)):t.b(this.c.c.bl.ItemId);var i=this.g.b(this.c.c.bl.ParentFolderId);i&&i.bl.IsGroupMailboxCalendar&&t.f(i.bl.OwnerEmailAddress);return t},p:function(){return{ContextCalendarItemViewModel:this.c}}};_cc.bU=function(n,t,i,r,u,f,e){this.f=n;this.e=t;this.b=i;this.a=r;this.g=u;this.c=f;this.d=e};_cc.bU.prototype={g:null,f:null,e:null,b:null,c:null,d:null,a:null,h:function(n){return n.e.cs?new _cc.cI(n,this.a):new _cc.bT(this.g,this.b,_g.bw.isInstanceOfType(n.c)?this.e:this.f,n,this.c,this.d)}};_cc.t=function(n,t,i,r,u,f,e,o,s){this.Z=Function.createDelegate(this,this.bv);this.H=Function.createDelegate(this,this.bt);this.Y=Function.createDelegate(this,this.bu);this.w=Function.createDelegate(this,this.bs);this.ba=Function.createDelegate(this,this.bC);this.bc=Function.createDelegate(this,this.bH);this.bf=Function.createDelegate(this,this.bK);this.bd=Function.createDelegate(this,this.bl);this.be=Function.createDelegate(this,this.bJ);this.bb=Function.createDelegate(this,this.o);this.X=Function.createDelegate(this,this.bq);this.W=Function.createDelegate(this,this.bp);this.I=Function.createDelegate(this,this.bF);this.T=Function.createDelegate(this,this.bm);this.V=Function.createDelegate(this,this.bo);this.U=Function.createDelegate(this,this.bn);_cc.t.initializeBase(this);this.j=t;this.i=i;this.r=f;this.a=n;this.P=r;this.N=u;this.B=e;this.n=o;this.t=s;this.bE();var b=this;this.K=new _C(this.U,_cc.t.a,this,"CanAddToMyCalendar",function(){return b.k()});var w=this;this.z=new _C(this.V,_cc.t.a,this,"CanAddToMyCalendar",function(){return w.k()});var p=this;this.q=new _C(this.T,_cc.t.a,this,"CanAddToMyCalendar",function(){return p.k()});var g=this;this.b=new _C(this.I,_cc.t.a,this,"CanRemove",function(){return g.c()});var d=this;this.g=new _C(this.W,_cc.t.a,this,"CanCancel",function(){return d.e()});var k=this;this.E=new _C(this.X,_cc.t.a,this,"CanCancel",function(){return k.e()});var l=this;this.v=new _C(this.bb,_cc.t.a,this,"CanSave",function(){return l.bj()});var c=this;this.F=new _C(this.be,_cc.t.a,this,"CanSend",function(){return c.C()});var h=this;this.S=new _C(this.bd,_cc.t.a,this,"CanSend",function(){return h.C()});var y=this;this.G=new _C(this.bf,_cc.t.a,this,"CanSend",function(){return y.C()});var v=this;this.R=new _C(this.bc,_cc.t.a,this,"CanSaveDraft",function(){return v.bz()});var a=this;this.A=new _C(this.I,_cc.t.a,this,"CanDiscardDraft",function(){return a.a.m})};_cc.t.prototype={K:null,z:null,q:null,b:null,g:null,E:null,v:null,F:null,S:null,G:null,R:null,A:null,N:null,a:null,j:null,i:null,P:null,r:null,B:null,n:null,t:!1,d:null,p:function(n){this.dV("Executing",n)},bG:function(n){this.dW("Executing",n)},f:function(n){this.dV("Completed",n)},Q:function(n){this.dW("Completed",n)},k:function(){return!this.i.e()&&this.a.e.W()&&!this.a.e.bl.IsCancelled},bx:function(){return this.k()&&!this.a.e.bl.IsOrganizer},c:function(){return this.bh()&&(this.a.e.bl.IsCancelled||this.a.e.gf())},by:function(){return this.c()&&!this.a.e.dv()},e:function(){return this.a.e.ev()&&this.a.e.bG()},bj:function(){return!this.a.k()&&!this.a.c.bl.IsCancelled&&this.a.c.bl.IsOrganizer},C:function(){return this.a.k()&&this.a.c.bl.IsOrganizer},bz:function(){return this.a.c.bl.IsOrganizer},h:function(){return!this.i.e()&&this.a.c.cc()},bh:function(){return!this.i.e()&&this.a.c.co()},bi:function(){return(!this.i.e()||!_cc.t.b&&!this.a.c.cf())&&this.a.c.cR()},x:0,y:0,bA:function(){return this.N.a()},bn:function(){this.J("AddToMyCalendarFromComposeCommandingBar")},bo:function(){this.J("AddToMyCalendarFromSurfaceContextMenu")},bm:function(){this.J("AddToMyCalendarFromCalendarReadingPaneOrPeekForm")},bF:function(){var i=this.a.e;i.bl.IsSeriesCancelled&&(i=this.a.p().c);var n=_cc.x.g(i.bI());var t=new _cc.cp(i,this.D(this.a.c),_g.i.a(this.a.e));var u=this;t.v(function(t){if(n){var i=t;n.k=i.D();n.l=i.B();_a.d.a(n);n=null}_cc.j.a(t)});var r=this;t.w(function(i){if(n){var u=i;n.l=u.B();_a.d.a(n);n=null}r.l("RemoveCalendarItemAction",t)});this.j.a(t)},bp:function(){var t=this.bA();var n=this;this.P.a(function(i){var r=n.br(i);n.i.c()&&n.l("CancelCalendarItemAction",null);t.a(r)})},bq:function(){var i=this.a.e;var n=_cc.x.f(i.bI(),!0);var t=new _cc.cN(i,this.D(this.a.c),_g.i.a(i));var u=this;t.v(function(t){if(n){var i=t;n.k=i.D();n.l=i.B();_a.d.a(n);n=null}_cc.j.a(t)});var r=this;t.w(function(i){if(n){var u=i;n.l=u.B();_a.d.a(n);n=null}r.l("CancelCalendarItemAction",t)});this.j.a(t)},o:function(){this.m(!1,!1,0,!1,!1,!1,null,null)},bI:function(n,t,i){this.m(!1,!1,0,!1,!1,i,n,t)},bk:function(){this.m(!1,!1,0,!0,!1,!1,null,null)},bJ:function(){this.m(!0,!1,3,!1,!1,!1,null,null)},bl:function(){this.m(!0,!1,4,!1,!1,!1,null,null)},bK:function(){this.m(!0,!1,3,!1,!0,!1,null,null)},bH:function(){this.m(!1,!0,0,!1,!1,!1,null,null)},bO:function(){this.a.k()?this.bl():this.o()},bB:function(){return new _h.bh([this.a.c],this.a.c.bl.ParentFolderId,0)},br:function(n){var t=n.a(!0,!1);t.e(8);t.k(!0);var r=_g.i.a(this.a.e);t.df(r);r&&t.dl(!0);if(this.a.e.bS()){var i=this.a.c.cp;i&&i.a();t.N(this.a.e)}else{t.dt(!0);t.co(this.a.e.bl.ItemId);t.cl(_g.i.d(this.a.e))}return t},J:function(n){this.d=_a.d.b(_cc.t.a,n,!0);var u=new _g.iM;u.ItemId=_h.T.a(this.a.e);var f=_g.i.a(this.a.e);var r=new _cc.bX(u,f);var t=this;r.v(function(n){if(t.d){var i=n;t.d.k=i.D();t.d.l=i.B();_a.d.a(t.d);t.d=null}_cc.j.a(n)});var i=this;r.w(function(n){i.l("AddCalendarItemToMyCalendarAction",r);if(i.d){var t=n;i.d.l=t.B();_a.d.a(i.d);i.d=null}});this.j.a(r)},bw:function(n,t){var i=this.a.c;var f=n||i.bI()?2:0;if(t){i=this.a.e;var r=this.a.c;if(r.bI()){i.bV(r.e());f=0}i.bh(r.a().u(1));i.J(r.b().u(1))}else{var u=i.cp;u&&u.a()}return new _cc.n(i,f,this.D(i),_g.i.a(i))},m:function(n,t,i,r,u,f,e,o){if(n&&t)throw Error.invalidOperation("Cannot send and save as draft.");var s=new _ff.e;var c=!1;if(this.a.j()){var h=this.bw(n,t);h.bt=this.x;h.bu=this.y;s.c(h);this.M(h,c,t,!1)&&this.r.X(h)}else{if(t)throw Error.invalidOperation("Cannot save a draft of an existing calendar item.");var k=this.a.c.cp;k&&k.a();if(this.a.H()||u){var l=new _cc.H(this.a.e,this.a.c,i,this.a.e.H(),this.D(this.a.c),_g.i.a(this.a.e));l.Z=this.x;l.ba=this.y;s.c(l);this.r.Y(l)}if(this.a.I()){c=!0;var g=this.bB();s.c(g)}}if(s.d.length>0){for(var p=null,b=s.d,d=b.length,v=0;v<d;++v){var y=b[v];this.bM(y,c,t,r);if(p){var nt=this;p.w(function(n){nt.j.a(y)})}p=y}var w=s.d[0];this.bL(w,c,t,n,f);var a=s.d[s.d.length-1];this.bN(a,c,t,n,f);e&&a.w(e);o&&a.v(o);this.j.a(w)}else{this.l(this.L(f,n),null);e&&e(null)}},bL:function(n,t,i,r,u){if(this.M(n,t,i,!1)){var f=this;n.bB(function(n){f.bD(f.L(u,r),n)})}},bM:function(n,t,i,r){var u=this;n.v(function(f){if(u.M(n,t,i,!0)){_cc.n.isInstanceOfType(n)&&u.r.bv(f.a());var e;(e=u.n).d(e.a+1);u.B.a(_y.ee,new _cc.cJ(u.n.a===1,_cc.H.isInstanceOfType(n),u.ba,u.a.c.bl.Subject))}else r||_cc.j.a(f);u.l("PersistActionFailed",f)})},bN:function(n,t,i,r,u){var f=this;n.w(function(n){var e;e=i?"SaveDraftCalendarItemAction":t?"MoveCalendarItemAction":f.L(u,r);f.l(e,n)})},L:function(n,t){return n?t?"SendCalendarItemAction":"SaveCalendarItemWebExtensionAction":t?"SendCalendarItemAction":"SaveCalendarItemAction"},bD:function(n,t){this.ea("Executing",n,t)},l:function(n,t){this.ea("Completed",n,t)},M:function(n,t,i,r){if(t||i||!this.t||this.i.a()!=="Mouse"||!this.i.c())return!1;if(_cc.n.isInstanceOfType(n)){var s=n;var u=s.a();return!!u&&!u.H()&&(!r||u.cu())}if(_cc.H.isInstanceOfType(n)){var o=n;var e=o.d;var f=o.a;return!!f&&!f.H()&&!!f.z()&&!!e&&!e.H()}return!1},bC:function(){var t=(new _cc.bu).e().d();this.a.h.a(this.a.c.cc()?0:1,!1,null,t).a();var n;(n=this.n).d(n.a-1);this.n.a||this.B.a(_y.eU,null)},bE:function(){this.a.c.bf();this.a.c.apcl("RequiredAttendees",this.w);this.a.c.apcl("OptionalAttendees",this.w);this.a.c.apcl("Resources",this.w);this.a.c.apcl("IsCancelled",this.Y);this.a.c.eR(this.H);this.a.apcl("IsDraft",this.Z)},bs:function(n,t){this.a.c.eR(this.H);this.bg()},bt:function(n,t){this.bg()},bg:function(){this.dU("CanSend","CanSave")},bu:function(n,t){this.dQ("CanSave")},bv:function(n,t){this.dQ("CanDiscardDraft")},D:function(n){var i;var t=n.e();if(!t)return null;i=t.e()?_g.s.d("calendar"):n.bl.ParentFolderId;var r;r=t&&t.bl.IsGroupMailboxCalendar?new(_h.dV.$$(_cc.bQ))(i):_g.v.isInstanceOfType(t)?new(_h.dV.$$(_cc.z))(i):new(_h.dV.$$(_cc.N))(i);return _h.i.a().h(r)}};_cc.bV=function(n,t,i,r,u,f,e,o){this.a=n;this.h=t;this.b=u;this.g=i;this.f=r;this.d=f;this.c=e;this.e=o};_cc.bV.prototype={f:null,a:null,h:null,g:null,b:null,d:null,c:null,e:!1,j:function(){return this.b},l:function(){return this.d},k:function(){return this.c},m:function(){return this.f.e()},i:function(n){return new _cc.t(n,this.a,this.h,this.g,this.m(),this.j(),this.l(),this.k(),this.e)}};_cc.c=function(){};_cc.c.h=function(){return _cc.c.e==="Mouse"&&_cc.c.g()};_cc.c.a=function(){return _cc.c.e==="Mouse"&&_cc.c.g()&&_cc.c.b.a().f().Enabled&&_cc.c.b.a().cM().Enabled};_cc.c.i=function(){return!!_cc.c.b&&_cc.c.b.a().bA().Enabled};_cc.c.f=function(){return _cc.c.b.a().d().Enabled};_cc.c.n=function(){return _cc.c.a()&&_cc.c.b.a().ci().Enabled};_cc.c.m=function(){return _cc.c.g()};_cc.c.g=function(){return _cc.c.b.a().q().Enabled};_cc.c.p=function(n){return n.a().f().Enabled&&n.a().q().Enabled};_cc.c.o=function(n,t){_cc.c.b=n;_cc.c.e=t};_cc.c.c=function(n){var t;var i=n.H()&&!!n.C();t=i?_cc.e.k(n.C()):_cc.c.j(n).b;return!!t&&t.b(_a.c.a())<0};_cc.c.k=function(n){var i=n.p()?n.p().b():0;var t=n.s()?n.s().b():0;return i+t};_cc.c.j=function(n){var i;var t;if(n.n()){var r=n.f().g(n.c());i=n.c().f();t=n.f().C()||!r?n.f().f().c(1):n.f()}else{i=n.c();t=n.f()}return new _h.j(i,t)};_cc.c.l=function(n,t){var u;var r;u=n.b(t.a())>0?n:t.a();var i=n.c(1);r=i.b(t.b())<0?i:t.b();return new _h.j(u,r)};_cc.c.d=function(n,t){var r=n.toLowerCase();var i=t.toLowerCase();return r.localeCompare(i)};_cc.bj=function(n,t,i,r,u,f,e,o,s){this.E=Function.createDelegate(this,this.Q);_cc.bj.initializeBase(this);_a.b.b(n,"item");this.B=t;this.C=f;this.r=i;this.x=r;this.w=u;this.A=e;this.v=o;this.D=s;this.N(n)};_cc.bj.prototype={B:null,C:null,r:null,x:null,w:null,A:null,D:null,v:null,m:!1,l:!1,e:null,c:null,g:null,d:null,h:null,n:null,i:null,y:!1,f:null,j:function(){return!this.e.bl.ItemId&&!this.c.bl.ItemId||this.c.cu()},k:function(){return this.e.bG()||this.c.bG()},M:function(){return this.e.bG()&&this.c.bG()},S:function(n){if(this.f!==n){this.f=n;this.dQ("MeetingResponseViewModel")}return n},a:function(){return this.c},t:function(n){if(this.c!==n){this.c=n;this.K();this.o(this.c.bl.ReminderIsSet?this.c.bl.ReminderMinutesBeforeStart:-1);var t=this;this.R(new _C(this.E,_cc.bj.a,this.c,"CanJoin",function(){return t.c.cn()}));this.dQ("CalendarItem")}return n},b:function(){return this.c.bl.ReminderIsSet?this.c.bl.ReminderMinutesBeforeStart:-1},o:function(n){if(this.b()!==n){this.c.cM(n!==-1);this.c.bl.ReminderIsSet&&this.c.bl.ReminderMinutesBeforeStart!==n&&this.c.fV(n);this.dQ("ReminderSelectedValue")}return n},R:function(n){if(this.i!==n){this.i=n;this.dQ("JoinCommand")}return n},q:function(){if(this.e.bl.ParentFolderId){if(this.I())return!0}else if(!this.c.bl.ParentFolderId||!_g.b.a.doesIdEqualName(this.c.bl.ParentFolderId,"calendar"))return!0;return this.H()},H:function(){return this.e.bl.Subject!==this.c.bl.Subject||this.e.bl.IsAllDayEvent!==this.c.bl.IsAllDayEvent||!_a.c.c(this.e.a(),this.c.a())||!_a.c.c(this.e.b(),this.c.b())||this.e.k()!==this.c.k()||this.e.bl.ReminderIsSet!==this.c.bl.ReminderIsSet||this.e.bl.ReminderMinutesBeforeStart!==this.c.bl.ReminderMinutesBeforeStart||this.e.bH()!==this.c.bH()||this.e.ce()!==this.c.ce()||this.e.bl.IsResponseRequested!==this.c.bl.IsResponseRequested||!_g.bH.a(this.e.q(),this.c.q())||!_g.bH.a(this.e.C(),this.c.C())||this.G()||_g.t.b(this.e.D(),this.c.D())||_g.cc.a(this.e.bQ(),this.c.bQ())||_g.h.h(this.e.bv(),this.c.bv())||this.y?!0:this.c.gh()},G:function(){return _g.t.b(this.e.p(),this.c.p())||_g.t.b(this.e.s(),this.c.s())},T:function(n){if(this.e!==n){this.e=n;this.F()}return n},J:function(n){this.m=n;this.dQ("IsDraft");return n},z:function(){return this.c.bl.SuggestionCategory!==1&&this.c.bl.SuggestionCategory!==4},I:function(){return!!this.e.bl.ParentFolderId&&!!this.c.bl.ParentFolderId&&!_g.s.b(this.c.bl.ParentFolderId,this.e.bl.ParentFolderId)},U:function(n){this.t(n)},V:function(n){this.t(n);this.W()},p:function(){if(!this.c.bE())throw Error.invalidOperation("Cannot create partial recurring master model from a non-recurring event.");var n=this.v.c(this.e);return this.x.a(n)},W:function(){this.e.dB(this.c.bl);this.F()},L:function(){this.t(this.e.dt())},K:function(){this.P();this.h=this.w.h(this);this.g=this.B.a(this.c,null,this.A.d,null);this.n=new _cc.cm(this.c,new _g.Qu,this.c.a(),this.c.b())},P:function(){this.d=this.C.i(this)},F:function(){this.f&&this.f.dispose();this.r.a=_g.i.a(this.e);this.S(this.r.j(this.e))},N:function(n){n.bf();this.T(n);this.t(this.e.dt())},Q:function(){this.D.a(this.c.bl.JoinOnlineMeetingUrl,null,null)}};_cc.K=function(n,t,i,r,u,f,e,o){this.e=n;this.f=t;this.b=e;this.i=r;this.g=i;this.c=u;this.d=f;this.h=o};_cc.K.prototype={e:null,f:null,i:null,g:null,b:null,d:null,c:null,h:null,l:function(){return this.g.e()},k:function(){return this.d.e()},j:function(){return this.c.e()},a:function(n){return new _cc.bj(n,this.e,this.f,this,this.j(),this.l(),this.k(),this.b,this.h)}};_cc.r=function(n){_cc.r.initializeBase(this);n&&this.dN(n)};_cc.r.$$cctor=function(){_a.i.d(_cc.r,Object,function(n){return new _cc.r(n)})};_cc.r.e=function(n){var t=new _cc.r;t.d(n.c());t.a(n.f());t.c(n.C());t.b(n.H());t.eg();return t};_cc.r.prototype={L:function(){return this.dS(_cc.r.d)},d:function(n){this.dR(_cc.r.d,n);return n},K:function(){return this.dS(_cc.r.a)},a:function(n){this.dR(_cc.r.a,n);return n},bi:function(){return this.dS(_cc.r.c)},c:function(n){this.dR(_cc.r.c,n);return n},T:function(){return this.dS(_cc.r.b)},b:function(n){this.dR(_cc.r.b,n);return n}};_cc.cL=function(){};_cc.cL.a=function(n){return!!n&&n.a().bA().Enabled};_cc.bt=function(n,t){this.d=n;this.c=t};_cc.bt.prototype={d:null,c:null,b:null,a:function(n){this.b=_a.d.b(_a.a.b,_cc.x.b("OpenCalendarItemOnComposeForm"));var t=this;this.c.a(function(i){var r=i.d(n.a,null,null,function(n){if(t.b){_a.d.a(t.b);t.b=null}},null);t.d.f(r,0,!1)})}};_cc.S=function(n,t){_cc.S.initializeBase(this);this.d=n;this.f=t};_cc.S.prototype={d:null,f:null,e:!1,a:function(){return this.f},b:function(){return this.e},c:function(n){if(this.e!==n){this.e=n;this.dQ("IsHidden")}return n}};_cc.by=function(n){if($a(n))this.a={};else{if(!_cc.by.a(n))throw Error.invalidOperation("Cannot construct a UpdateCalendarItemParameters by passing a Dictionary of parameters that doesnt have an Item id and at least one more property value.");this.a=n}};_cc.by.a=function(n){return!$a(n.ItemID)&&(!$a(n.Start)||!$a(n.Duration)||!$a(n.IsAllDayEvent))};_cc.by.prototype={a:null,g:function(){if($a(this.a.ItemID))return null;var n=this.a.ItemID;return _g.g.b(n)},k:function(n){$a(n)?delete this.a.ItemID:this.a.ItemID=n.Id;return n},f:function(){return this.a.ExplicitLogonUser},i:function(n){this.a.ExplicitLogonUser=n;return n},d:function(){return this.a.Start},l:function(n){this.a.Start=n;return n},b:function(){var n=this.a.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},h:function(n){this.a.Duration=n;return n},c:function(){return $a(this.a.IsAllDayEvent)?!1:Boolean.parse(this.a.IsAllDayEvent)},j:function(n){this.a.IsAllDayEvent=n.toString();return n},e:function(n){$a(this.d())||n.bh(this.d());$a(this.b())||n.J(n.a().m(this.b()));$a(this.c())||n.E(this.c())}};_cc.B=function(){};_cc.B.a=function(n){return!n.a().d().Enabled};_cc.B.b=function(n){var i=new _ff.e;if(n.dL()){var t=n.bl.From.Mailbox;i.c(new _cc.bc(_js.d.a(t.Name)?t.EmailAddress:t.Name,new _cc.s(n.ed(),n.dP())))}return i};_cc.B.c=function(n){var t=new _ff.e;if(n.bl.IsOrganizer&&n.bl.IsMeeting){t.h(_cc.B.d(n.p()).i());t.h(_cc.B.d(n.s()).i())}return t};_cc.B.d=function(n){for(var r=new _ff.e,i=0;i<n.b();i++){var t=n.a(i);t.bl.Mailbox.MailboxType==="Mailbox"&&t.h()&&r.c(new _cc.bc(_js.d.a(t.bl.Mailbox.Name)?t.bl.Mailbox.EmailAddress:t.bl.Mailbox.Name,new _cc.s(t.f(),t.e())))}return r};var ILocationPanelViewModel=function(){};ILocationPanelViewModel.registerInterface("ILocationPanelViewModel");var ILocationPanelViewModelFactory=function(){};ILocationPanelViewModelFactory.registerInterface("ILocationPanelViewModelFactory");var ILocationWellViewModel=function(){};ILocationWellViewModel.registerInterface("ILocationWellViewModel");var ILocationWellViewModelFactory=function(){};ILocationWellViewModelFactory.registerInterface("ILocationWellViewModelFactory");var IPlacePickerViewModel=function(){};IPlacePickerViewModel.registerInterface("IPlacePickerViewModel");var IPlacePickerViewModelFactory=function(){};IPlacePickerViewModelFactory.registerInterface("IPlacePickerViewModelFactory");var ICalendarSharingPermissionsViewModelFactory=function(){};ICalendarSharingPermissionsViewModelFactory.registerInterface("ICalendarSharingPermissionsViewModelFactory");var ISubscribeCalendarViewModelFactory=function(){};ISubscribeCalendarViewModelFactory.registerInterface("ISubscribeCalendarViewModelFactory");var IBirthdayCalendarFactory=function(){};IBirthdayCalendarFactory.registerInterface("IBirthdayCalendarFactory");var IHolidaysFactory=function(){};IHolidaysFactory.registerInterface("IHolidaysFactory");var IBookingManagementFactory=function(){};IBookingManagementFactory.registerInterface("IBookingManagementFactory");_cc.cQ=function(){};_cc.cQ.registerInterface("_cc.cQ");_cc.g=function(){};_cc.g.registerInterface("_cc.g");_cc.l=function(n){this.d=n};_cc.l.prototype={d:null,b:1,c:0,a:0,e:function(n){this.c++;this.c===this.b&&n()},f:function(n,t){this.a++;if(this.a<this.b)return!1;t&&t();n&&n();this.d.a(_cc.l.a,new _cc.l.a);this.c=0;this.a=0;return!0}};_cc.l.a=function(){};_cc.o=function(){};_cc.o.d=function(n){_js.c.isInstanceOfType(n)&&_g.yB.isInstanceOfType(n.E())&&(n=n.E());var i="<null>";if(_g.bB.isInstanceOfType(n)){var t=n.e();i=t?t.a().Id:"<null>"}return String.format("\tStart: '{0}', End: '{1}', ItemId: '{2}', Calendar: '{3}', IsModel:{4}",n.a(),n.b(),_cc.o.a(n),i,_g.yA.isInstanceOfType(n))};_cc.o.a=function(n){var t=n.j();return _cc.o.e(t)};_cc.o.f=function(n,t){if(_cc.o.b){n.val="";t.val="";return}var u=_js.a.Instance;var r=u.a(CalendarsCache);n.val=r?r.bq():"<null>";var i=u.a(_cc.V);t.val=i?i.H():"<null>";_cc.o.b=!0};_cc.o.e=function(n){return!n||!n.Id?"<null>":n.Id};_cc.o.c=function(n){return!n||!n.Id?"<null>":n.Id};_cc.co=function(n,t,i,r,u,f,e){this.X=Function.createDelegate(this,this.v);this.Y=Function.createDelegate(this,this.G);this.Z=Function.createDelegate(this,this.bj);this.O=+new Date;this.C=n;this.W=u;this.U=i;this.N=r;this.H=t;this.D=f;this.E=new _a.r;this.K=e};_cc.co.prototype={U:null,N:null,W:!1,H:null,O:0,E:null,K:null,D:null,J:null,C:null,L:0,F:0,S:!1,M:0,V:0,P:0,R:0,Q:0,T:0,j:function(n){this.J=n;return n},i:function(){return this.N},B:function(n){if(!this.D){_js.Trace.logWarning(this.H,"SetExpectedAnimationCompletedCount was called for a scenario not based on animation.");return}this.D.b=n},y:function(){this.a("A",this.b())},r:function(){this.a("J",this.b())},q:function(){this.a("K",this.b())},p:function(){this.a("B",this.b())},h:function(){this.a("C",this.b())},u:function(n,t,i){if(n){this.a("D",n.getTime()-this.O);this.a("E",this.b());this.a("L",t?1:0);this.a("M",i?1:0)}},e:function(n){this.F&&n&&this.S||(this.F=+new Date);n&&(this.S=!0)},d:function(){this.L=+new Date},w:function(){if(!this.D){_js.Trace.logWarning(this.H,"AddFadeInAnimationStartMarker was called for a scenario not based on animation.");return}this.D.e(this.Z)},v:function(){this.a("I",this.b())},A:function(){if(!this.D){_js.Trace.logWarning(this.H,"MarkAnimationCompleted was called for a scenario not based on animation.");return!1}return this.D.f(this.Y,this.X)},f:function(){this.a("O",this.b())},c:function(){this.a("P",this.b())},be:function(){this.a("V",this.b())},bd:function(){this.a("W",this.b())},n:function(){this.a("X",this.b())},bc:function(){this.a("Y",this.b())},bb:function(){this.a("Z",this.b())},l:function(){this.a("Q",this.b())},k:function(n){this.a("R",this.b());n&&this.a("S",1)},g:function(){this.a("T",this.b())},o:function(){this.a("U",this.b())},bi:function(n){this.G(n)},I:function(n){this.E.a("SA",n);this.G()},m:function(n,t){t?this.M+=n:this.M=n},x:function(n,t,i,r,u){this.V=n;this.P=t;this.R=i;this.Q=r;this.T=u},t:function(){this.a("N",1)},z:function(){this.a("AD",1)},s:function(){this.a("AC",1)},bh:function(){this.G()},b:function(n){var t=n?n:+new Date;return t-this.O},a:function(n,t){if(this.E.f(n)){this.K&&this.K();return}this.E.a(n,t)},G:function(n){this.bg();var t=this.C?this.C.d():null;if(this.W&&this.C){this.C.k=n;this.C.l=this.J;this.C.j=this.E.toString();_a.d.a(this.C);this.C=null}t&&_a.y.endPT(t)},bj:function(){this.a("H",this.b())},bg:function(){this.ba();this.bf();this.E.b("SCI",this.U)},bf:function(){this.a("AB",this.M);this.a("AA",this.V);this.a("AE",this.P);this.a("AF",this.R);this.a("AG",this.Q);this.a("AH",this.T)},ba:function(){this.F&&this.a("F",this.b(this.F));this.L&&this.a("G",this.b(this.L))}};_cc.bn=function(n){this.E=Function.createDelegate(this,this.I);this.F=Function.createDelegate(this,this.J);this.G=_a.cF.b().a.toString();if(n){this.D=n;this.D.b(_y.bF,this.F);var r=this;this.D.b(_fce.Q,function(n){r.C&&r.C.be()});var u=this;this.D.b(_fce.P,function(n){u.C&&u.C.bd()});var t=this;this.D.b(_fce.O,function(n){t.C&&t.C.bc()});var i=this;this.D.b(_fce.N,function(n){i.C&&i.C.bb()})}};_cc.bn.prototype={D:null,C:null,j:function(n){this.C&&(this.C.J=n);return n},i:function(){return this.C?this.C.N:null},B:function(n){this.C&&this.C.B(n)},m:function(n,t){this.C&&this.C.m(n,t)},x:function(n,t,i,r,u){this.C&&this.C.x(n,t,i,r,u)},y:function(){this.C&&this.C.y()},p:function(){this.C&&this.C.p()},h:function(){this.C&&this.C.h()},u:function(n,t,i){this.C&&this.C.u(n,t,i)},e:function(n){this.C&&this.C.e(n)},d:function(){this.C&&this.C.d()},w:function(){this.C&&this.C.w()},r:function(){this.C&&this.C.r()},q:function(){this.C&&this.C.q()},v:function(){this.C&&this.C.v()},A:function(){this.C&&this.C.D&&this.C.A()&&this.H(!1,null);return!1},f:function(){this.C&&this.C.f()},c:function(){this.C&&this.C.c()},n:function(){this.C&&this.C.n()},l:function(){this.C&&this.C.l()},k:function(n){this.C&&this.C.k(n)},g:function(){this.C&&this.C.g()},o:function(){this.C&&this.C.o()},t:function(){this.C&&this.C.t()},z:function(){this.C&&this.C.z()},s:function(){this.C&&this.C.s()},a:function(n,t,i,r){if(this.C){this.C.I(1);this.C=null}var u=_a.d.b(n,t,!0);this.C=new _cc.co(u,n,this.G,t,i,r,this.E)},b:function(n){this.H(!0,n)},H:function(n,t){if(this.C){n?t?this.C.bi(t):this.C.bh():!this.C.C||this.C.I(2);this.C=null}},J:function(n){if(n.b.a===1&&n.a.a!==1&&this.C){this.C.I(4);this.C=null}},I:function(){if(this.C){this.C.I(3);this.C=null}}};_cc.PerfTraceCTQCustomKeys=function(){};_cc.PerfTraceCTQCustomKeys.Calendar=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.BirthdayCalendar=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.ComposeCalendarItemViewModel=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.MeetingResponseViewModel=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.MeetingFormsPerfMarkers=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSurface=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSearch=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.HolidayCalendars=function(){};_cc.x=function(){};_cc.x.b=function(n){return _cc.c.a()?"UnifiedForms_"+n:n};_cc.x.f=function(n,t){var i="";i=n?"CancelGroupCalendarItem":"CancelCalendarItem";t&&(i="Quick"+i);return _a.d.b(_a.a.b,i)};_cc.x.g=function(n){var t="";t=n?"RemoveGroupCalendarItem":"RemoveCalendarItem";return _a.d.b(_a.a.b,t)};_cc.x.d=function(){};_cc.x.d.d=function(){var n=_a.d.b(_a.a.b,"EditMeetingTimeFromTimeProposal");_a.d.a(n)};_cc.x.d.c=function(n,t,i,r,u,f){var e=new _a.r;t&&e.a("N",1);n&&e.a("K",1);var o=0;if(r.a().p()&&r.a().p().b()>0){o+=r.a().p().b();e.a("RC",r.a().p().b())}if(r.a().s()&&r.a().s().b()>0){o+=r.a().s().b();e.a("OC",r.a().s().b())}o>0&&e.a("TC",o);!$a(r.a().bl.IsAllDayEvent)&&r.a().bl.IsAllDayEvent&&e.a("A",1);r.a().D()&&r.a().D().b()>0&&e.a("R",r.a().D().b());u&&u.g()/6e4!=30&&e.a("DU",u.g()/6e4);r.b()!==15&&e.a("RM",r.b());$a(r.a().k())||r.a().k()==="Busy"||e.b("F",r.a().k());!$a(r.a().cf())&&r.a().cf()&&e.a("P",1);i&&e.b("RP",f.a().a.a.a());!$a(r.a().bl.IsOnlineMeeting)&&r.a().bl.IsOnlineMeeting&&e.a("OM",1);$a(r.a().bl.IsResponseRequested)||r.a().bl.IsResponseRequested||e.a("NR",1);return e.toString()};_cc.x.d.b=function(n,t,i,r,u,f,e,o){_a.y.stPT(_a.a.b,"PersistCalendarItemChangesPerfTrace",3);var s="";s=e?i?r==="Mouse"?u?t?"GroupCalendar_CreateRecurringEventOnPopout":"GroupCalendar_UpdateRecurringEventOnPopout":t?"GroupCalendar_CreateRecurringEventOnCompose":"GroupCalendar_UpdateRecurringEventOnCompose":f?t?"GroupCalendar_CreateRecurringEventOnQuickCompose":"GroupCalendar_UpdateRecurringEventOnQuickCompose":t?"GroupCalendar_CreateRecurringEventOnCompose":"GroupCalendar_UpdateRecurringEventOnCompose":r==="Mouse"?u?t?"GroupCalendar_CreateEventOnPopout":"GroupCalendar_UpdateEventOnPopout":t?"GroupCalendar_CreateEventOnCompose":"GroupCalendar_UpdateEventOnCompose":f?t?"GroupCalendar_CreateEventOnQuickCompose":"GroupCalendar_UpdateEventOnQuickCompose":t?"GroupCalendar_CreateEventOnCompose":"GroupCalendar_UpdateEventOnCompose":n?i?r==="Mouse"?u?t?"SendRecurringMeetingOnPopout":"UpdateRecurringMeetingOnPopout":t?"SendRecurringMeetingOnCompose":"UpdateRecurringMeetingOnCompose":f?t?"SendRecurringMeetingOnQuickCompose":"UpdateRecurringMeetingOnQuickCompose":t?"SendRecurringMeetingOnCompose":"UpdateRecurringMeetingOnCompose":r==="Mouse"?u?t?"SendMeetingOnPopout":"UpdateMeetingOnPopout":t?"SendMeetingOnCompose":"UpdateMeetingOnCompose":f?t?"SendMeetingOnQuickCompose":"UpdateMeetingOnQuickCompose":t?"SendMeetingOnCompose":"UpdateMeetingOnCompose":i?r==="Mouse"?u?t?"SaveRecurringAppointmentOnPopout":"UpdateRecurringAppointmentOnPopout":t?"SaveRecurringAppointmentOnCompose":"UpdateRecurringAppointmentOnCompose":f?t?"SaveRecurringAppointmentOnQuickCompose":"UpdateRecurringAppointmentOnQuickCompose":t?"SaveRecurringAppointmentOnCompose":"UpdateRecurringAppointmentOnCompose":r==="Mouse"?u?t?"SaveAppointmentOnPopout":"UpdateAppointmentOnPopout":t?"SaveAppointmentOnCompose":"UpdateAppointmentOnCompose":f?t?"SaveAppointmentOnQuickCompose":"UpdateAppointmentOnQuickCompose":t?"SaveAppointmentOnCompose":"UpdateAppointmentOnCompose";o&&(s="UnifiedForms_"+s);return s};_cc.x.d.a=function(n,t,i,r){if(n){n.k=t;n.l=i;n.j=r;_a.d.a(n)}_a.y.endPT("PersistCalendarItemChangesPerfTrace")};_cc.x.a=function(){};_cc.x.a.e=function(n){var t=n?"OpenSchedulingAssistantFormOnPopout":"OpenSchedulingAssistantForm";_a.k.b(_cc.x.a.b,t);return t};_cc.x.a.c=function(n){var t=n?"ApplySchedulingAssistantChangesOnPopout":"ApplySchedulingAssistantChanges";return _a.d.b(_cc.x.a.b,t)};_cc.x.a.d=function(n){var t=n?"DiscardSchedulingAssistantChangesOnPopout":"DiscardSchedulingAssistantChanges";return _a.d.b(_cc.x.a.b,t)};_cc.x.a.f=function(){return _a.d.b(_cc.x.a.b,"PopoutSchedulingAssistantForm")};_cc.x.a.a=function(n,t,i,r){if(n){n.k=t;n.l=i;n.j=r;_a.d.a(n)}};_cc.x.c=function(){};_cc.x.c.f=function(n){return n?3:0};_cc.x.c.g=function(n){return n?4:1};_cc.x.c.h=function(n){return n?5:2};_cc.x.c.c=function(n,t){var i=_cc.x.c.e(n,t);return i?_a.d.b(_cc.x.c.b,i,!0):null};_cc.x.c.a=function(n,t,i,r,u,f,e){if(n){var o=new _a.r;r?o.a("R",1):o.a("R",0);u?o.a("C",1):o.a("C",0);f?o.a("O",1):o.a("O",0);o.b("S",_cc.x.c.d.toString(e));n.k=t;n.l=i;n.j=o.toString();_a.d.a(n)}};_cc.x.c.e=function(n,t){switch(n){case"Accept":switch(t){case 0:return"AcceptMeetingOnMailReadingPane";case 1:return"AcceptMeetingOnCalendarPeek";case 2:return"AcceptMeetingOnCalendarReadingPane";case 3:return"AcceptMeetingOnCalendarContextMenu"}break;case"Tentative":switch(t){case 0:return"TentativelyAcceptMeetingOnMailReadingPane";case 1:return"TentativelyAcceptMeetingOnCalendarPeek";case 2:return"TentativelyAcceptMeetingOnCalendarReadingPane";case 3:return"TentativelyAcceptMeetingOnCalendarContextMenu"}break;case"Decline":switch(t){case 0:return"DeclineMeetingOnMailReadingPane";case 1:return"DeclineMeetingOnCalendarPeek";case 2:return"DeclineMeetingOnCalendarReadingPane";case 3:return"DeclineMeetingOnCalendarContextMenu"}break}_js.Trace.logError(_cc.x.c.b,"Expected Accept, Tentatively Accept or Decline as valid Meeting Responses. But it is {0}",n);return null};_cc.x.c.d=function(){};_cc.x.c.d.prototype={dontSendResponse:0,editBeforeSendResponse:1,sendResponseDirectly:2,dontSendResponse_MasterFromOccurrence:3,editBeforeSendResponse_MasterFromOccurrence:4,sendResponseDirectly_MasterFromOccurrence:5};_cc.x.c.d.registerEnum("_cc.x.c.d",!1);_cc.x.e=function(){};_cc.x.e.a=function(n){var t=new _a.r;var i=n.b()?n.b().a().x.length:-1;t.a("N",i);t.a("SN",n.i());t.a("D",n.g());_cc.x.e.b(n.h(),t);_cc.x.e.c(n,t);return t.toString()};_cc.x.e.b=function(n,t){var r=n||"";var i=r.match(new RegExp("\\S+","g"));t.a("W",i?i.length:0);t.a("C",r.length)};_cc.x.e.c=function(n,t){var e=-1;if(n.b()&&n.b().a().x.length>0){for(var o=n.b().a(),f=_a.c.W,r=_a.c.m,i,u=0,s=o.x.length;u<s;u++){i=o.x[u];i.a().b(f)<0&&(f=i.a());i.a().b(r)>0&&(r=i.a())}e=Math.floor(r.g(f)/864e5)}t.a("S",e)};_cc.cV=function(){};_cc.cV.registerInterface("_cc.cV");_cc.cg=function(){};_cc.cg.registerInterface("_cc.cg");_cc.cT=function(){};_cc.cT.registerInterface("_cc.cT");_cc.bI=function(){};_cc.bI.registerInterface("_cc.bI");_cc.cU=function(){};_cc.cU.registerInterface("_cc.cU");_cc.bJ=function(){};_cc.bJ.registerInterface("_cc.bJ");_cc.h=function(){};_cc.h.registerInterface("_cc.h");_cc.y=function(){};_cc.y.prototype={Disabled:0,AvailabilityOnly:1,LimitedDetails:2,FullDetails:3,Editor:4,Delegate:5};_cc.y.registerEnum("_cc.y",!1);_cc.k=function(){};_cc.k.prototype={invalid:0,Day:1,Week:2,WorkWeek:3,Month:4,Agenda:5,Miniature:6,PrefetchMonth:7,PrefetchDay:8};_cc.k.registerEnum("_cc.k",!1);var IModernGroupCalendarsProvider=function(){};IModernGroupCalendarsProvider.registerInterface("IModernGroupCalendarsProvider");_cc.u=function(){};_cc.u.registerInterface("_cc.u");_cc.cF=function(){};_cc.cF.prototype={None:0,Internal:1,Federated:2,Publishing:3,Consumer:4};_cc.cF.registerEnum("_cc.cF",!1);_cc.bZ=function(){this.a=String.format(_bms.E.b,-1);_cc.bZ.$$(this.$$gta["_cc.bZ"].T).initializeBase(this);_cc.bZ.$$(_g.cV).a&&this.z(_cc.bZ.$$(_g.cV).a)};_cc.bZ.$$=function(n){var i="bZ"+"$"+n.getName().replace(/\./g,"_");if(!_cc[i]){var t=_cc[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_cc.bZ.apply(this,t)};var h=_h.dY.$$(n);t.registerClass("_cc."+i,h);var s={"_cc.bZ":{T:n}};var e=h.prototype.$$gta;for(var c in e){var o={key:c,value:e[c]};s[o.key]=o.value}t.prototype.$$gta=s;var u=_cc.bZ.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.a=null}return _cc[i]};_cc.bZ.prototype={cz:function(n,t,i){if(!n.WasSuccessful){this.a=_h.cy.a(n.ErrorCode);i(Error.create(this.a));return}try{this.l(n)}catch(r){i(r);return}t()}};_cc.j=function(n){this.c=Function.createDelegate(this,this.e);this.b=n};_cc.j.a=function(n,t){_cc.j.c(n.t,t)};_cc.j.c=function(n,t){if(!n){_js.Trace.logError(_cc.j.b,"Action shouldn't fail without an error.");return""}var e;var o;var i=null;var w,y,v;(v=_h.U.a(n,w={val:o},y={val:i}),o=w.val,i=y.val,v)?_js.Trace.logWarning(_cc.j.b,"Offline service command rejected with the following rejection error code: {0}",_bc.C.toString(o)):i=n;var s;var u;var r="";var p,a,c,l;if(l=_cc.j.i(i,p={val:s},a={val:e},c={val:u}),s=p.val,e=a.val,u=c.val,l)if(s){r=_h.U.f(u);if(r===""){r=_u.c.d;var h=String.format("Action finished with an unknown response code: {0}. Status code {1}",u,e);i.message&&(h=h+String.format(" Server message: {0}",i.message));_js.Trace.logWarning(_cc.j.b,h)}}else r=_h.U.g(e);if(r===""){var f=String.format("Action failed with an unknown error format.");i.message&&(f=f+String.format(" Server message: {0}",i.message));_js.Trace.logError(_cc.j.b,f);return f}var k=_u.c.P;var b=[k,r];_a.M.b(b,0,t);return r};_cc.j.i=function(n,t,i,r){i.val=0;t.val=!1;r.val="NoError";if(_cc.j.h(n,i)){if(i.val>=200&&i.val<300){t.val=!0;r.val="ErrorInternalServerError"}return!0}var u=n[_cc.j.g];if(u===_g.O.dataContractName){t.val=!0;r.val=_cc.j.d(n);return!0}return!1};_cc.j.d=function(n){var t=n[_cc.j.e];if($a(t)){_js.Trace.logWarning(_cc.j.b,"Server exception doesn't contain a response code.");return"ErrorInternalServerError"}return t};_cc.j.h=function(n,t){t.val=n[_cc.j.f];return $a(t.val)?!1:!0};_cc.j.prototype={b:null,a:0,d:function(n){n===1&&n>this.a&&this.b.k(this.c);this.a=n;n||this.b.n(this.c);return n},e:function(n){n.a(_u.c.DI)}};_cc.bD=function(n,t,i){_cc.bD.initializeBase(this);_a.b.c(n,"parentGroupId");this.c=t;this.d=i};_cc.bD.prototype={c:null,d:null,s:function(n){var t=_g.v.isInstanceOfType(this.c)?this.c.bl.OwnerEmailAddress:null;n.di(this.c.bl.CalendarName,this.c.bl.ParentGroupId,t,null,this.r,this.q)},l:function(n){if(_g.D.isInstanceOfType(this.c)){this.d.g(n.NewFolderId);this.c.n(n.NewFolderId)}this.c.m(n.NewCalendarEntryId)}};_cc.bh=function(){_cc.bh.resolveInheritance();this.g=this.cA;_cc.bh.initializeBase(this)};_cc.bh.a=function(n,t){var r=n.d();var i=_a.c.u(r,t);var u=n.i()>i?i:n.i();return new _a.c(t,r,u)};_cc.bh.prototype={o:null,h:null,Q:null,a:function(){return this.Q},i:function(n){this.Q=n;return n},W:null,d:function(){return this.W},n:function(n){this.W=n;return n},S:null,f:function(){return this.S},k:function(n){this.S=n;return n},X:0,j:function(n){this.X=n;return n},Z:!1,l:function(n){this.Z=n;return n},T:!1,c:function(){return this.T},m:function(n){this.T=n;return n},Y:null,e:function(){return this.Y},s:function(n){this.o=_a.d.b(_a.a.bc,"GetBirthdayCalendarView");var u=this.h.a.j();var f=this.h.b.j();var r=new _g.oz(u,f);var t=new _g.Et(this.x);t.actionName="GetBirthdayCalendarViewAction";var i=new _g.oy(this.y(),r);n.dV(i,t,this.r,this.q)},cp:function(n){if(!n.BirthdayEvents){_a.d.a(this.o);this.o=null;return}this.Q.f();for(var e=n.BirthdayEvents.length,o=n.BirthdayEvents,u=0;u<e;u++){var t=new _g.i;var i=new _g.eh(o[u]);var h=i.c();var f=this.ba(h);if(this.h.c(f,!0,!0)){t.bh(f);t.J(t.a().c(1));t.bL(i.bl.Id);t.E(!0);t.bR(i.bl.Name);t.cs=i;t.cb(this.S);this.Q.a(t)}}var s=this.h.b.g(this.h.a)/864e5;var r=new _a.r;r.a("N",e);r.a("D",s);if(this.o){this.o.j=r.toString();_a.d.a(this.o);this.o=null}},ba:function(n){var t=_cc.bh.a(n,this.h.a.e());return this.h.c(t,!0,!0)?t:_cc.bh.a(n,this.h.b.e())}};_cc.n=function(n,t,i,r){_cc.n.initializeBase(this,[1]);_a.b.a(n,"item");this.i(n);this.j(t);this.n=_cc.n.d;n.bl.ParentFolderId&&(this.S=_g.s.c(n.bl.ParentFolderId));this.d=r;this.c=i;this.f="CreateCalendarItemAction"};_cc.n.a=function(n){if(n)for(var i=0;i<n.length;i++){var t=n[i];t.Mailbox&&t.Mailbox.ItemId&&(t.Mailbox.ItemId.ChangeKey=null)}return n};_cc.n.e=function(n){var t=new _g.P;n.bl.ItemId&&!n.cu()&&(t.ItemId=n.bl.ItemId);t.Subject=n.bl.Subject;if(n.z()){var i=n.z().a();i||(i="Text");t.Body=new _g.G(i,n.z().bl.Value)}$a(n.bH())?n.cN("Normal"):t.Sensitivity=n.bH();n.bv()&&n.bv().b()>0&&(t.Categories=n.bv().f());t.Charm=n.ce();t.ReminderIsSet=n.bl.ReminderIsSet;t.ReminderMinutesBeforeStart=n.bl.ReminderMinutesBeforeStart;t.IsResponseRequested=!!n.bl.IsResponseRequested;t.IsAllDayEvent=$a(n.bl.IsAllDayEvent)?!1:n.bl.IsAllDayEvent;n.a()&&(t.Start=n.a().j());n.b()&&(t.End=t.IsAllDayEvent?n.b().f().c(1).j():n.b().j());$a(n.k())||(t.FreeBusyType=n.k());n.p()&&n.p().b()>0&&(t.RequiredAttendees=_cc.n.a(n.p().g.o));n.s()&&n.s().b()>0&&(t.OptionalAttendees=_cc.n.a(n.s().g.o));n.D()&&n.D().b()>0&&(t.Resources=_cc.n.a(n.D().g.o));var u=_cc.n.f(n);u&&(t.Recurrence=u);var r=_g.y.d(n.q());r&&(t.Location=r);!n.bI()&&n.bQ()&&n.bQ().b()>0&&(t.InboxReminders=n.bQ().g.o);_h.l.i(t,n);return t};_cc.n.g=function(){var n=new _g.bT("IdOnly");n.AdditionalProperties=[new _g.e("InstanceKey")];return n};_cc.n.f=function(n){var i=null;var t=n;t&&t.F()&&(i=_g.bo.b(t.F()));return i};_cc.n.prototype={c:null,d:null,a:function(){return this.dS(_cc.n.b)},i:function(n){this.dR(_cc.n.b,n);return n},e:function(){return this.dS(_cc.n.c)},j:function(n){this.dR(_cc.n.c,n);return n},g:function(){var n=_h.ft.prototype.g.call(this);n.userDisplayName=_g.a.a().c().bl.UserDisplayName;n.userEmailAddress=_g.a.a().c().bl.UserEmailAddress;n.calendarFolderId=new _g.n(_g.b.a.nameToId("calendar").Id);n.explicitLogonUser=this.d;return n},k:function(){var n=_h.ft.prototype.k.call(this);n.Body.SendMeetingInvitations=_h.br.toString(this.e());return n},m:function(){return[_cc.n.e(this.a())]},cp:function(n){var i=n.Items[0];this.a().bL(i.ItemId);this.a().eK(i.InstanceKey);var t=this.c;if(t)if(this.a().C())this.a().C()&&_cc.z.isInstanceOfType(t)&&t.G();else{_g.i.e(this.a());t.t(this.a(),0,!1)}}};_cc.bE=function(n){_cc.bE.initializeBase(this);this.c=n};_cc.bE.prototype={c:null,s:function(n){n.dj(this.c.f(),null,this.r,this.q)},l:function(n){this.c.h(n.NewGroupClassId);this.c.i(n.NewGroupItemId)}};_cc.bF=function(n,t,i){_cc.bF.initializeBase(this);this.c=n;this.e=t;this.d=i};_cc.bF.prototype={c:null,e:null,d:null,s:function(n){var t=new _g.g(this.c.bl.ItemId.Id);t.ChangeKey=this.c.bl.ItemId.ChangeKey;n.ds(t,null,this.r,this.q)},l:function(n){this.d.bd(this.e,this.c)}};_cc.bG=function(n){_cc.bG.initializeBase(this);this.c=n};_cc.bG.prototype={c:null,s:function(n){n.dt(this.c.c().Id,null,this.r,this.q)},l:function(n){}};_cc.bq=function(n,t){_cc.bq.initializeBase(this,[n,[t.i],null,"FullBookingItem",1,t.g==="discoveryMailboxMode"]);this.h=t;this.g="GetBookingItem";this.d=t.h==="Text"?_h.b.M():_h.b.H();if(t.j)throw Error.argument("ExplicitLogonUser cannot be null");};_cc.bq.b=function(n,t,i,r,u,f){i=$a(i)?_cc.bq.a:i;r=$a(r)?"defaultMode":r;u=$a(u)?0:u;n=t?new _h.T(n):n;return new _cc.cc(n,i,r,u,f)};_cc.bq.prototype={h:null,j:null,c:function(){return this.j},a:function(){return this.h},y:function(){return this.R("Exchange2015")},cp:function(n){var t=new _g.bw(n.Items[0]);t.bW(2);t.bf();this.j=t}};_cc.cA=function(){_cc.cA.initializeBase(this)};_cc.cA.prototype={h:null,y:function(){return this.R("Exchange2015")},s:function(n){_cc.cd.prototype.s.call(this,n);var t=new _g.hl;t.ItemShape=_h.b.l();t.ShapeName="PartialBookingItem";t.Traversal="Shallow";var f=new _g.n(this.T.Id);f.ChangeKey=this.T.ChangeKey;t.ParentFolderIds=[f];if(_h.j.isInstanceOfType(this.Q)){var e=this.Q;var o=new _g.dg(e.a.j(),e.b.j());t.Paging=o}else throw Error.invalidOperation("Unsupported paging type");var i=new _g.bz(this.x);i.isAutomated=this.Z;i.isReload=this.X;i.actionName=this.W?"GetBookingItemsAction_"+_cc.k.toString(this.W):"GetBookingItemsAction";if(this.J)i.explicitLogonUser=this.J;else throw Error.argumentNull("ExplicitLogonUser","ExplicitLogonUser can't be null while accessing a Booking mailbox");var s=new _g.hj(this.y(),t);_js.Trace.logInfo(_a.a.k,String.format("FindItem paging: {0}",Object.getType(this.Q).getName()));this.h=i;n.d(s,i,this.r,this.q);var r=t.ItemShape?t.ItemShape.AdditionalProperties:null;var u=r?r[0]:null;_js.Trace.logWarning(_a.a.k,"GetCalendarItems: {0}, {1}",u?u.FieldURI:"<null>",JsonParser.serialize(t.ParentFolderIds))},cp:function(n){if(n.RootFolder&&n.RootFolder.Items){var i=_js.e.s(_a.a.k,2,"ProcessResponseMessages:FindItem_GetBookingItems_"+n.RootFolder.Items.length);this.S.f();for(var t=0;t<n.RootFolder.Items.length;t++)this.bh(n.RootFolder.Items[t]);_js.e.e(i)}},bh:function(n){var t=new _g.bw(n);this.S.a(t)}};_cc.cB=function(n){_cc.cB.initializeBase(this);_a.b.a(n,"requestedLinkedCalendar");this.c=n};_cc.cB.prototype={c:null,e:null,f:null,d:!1,s:function(n){var i=new _g.jT;i.FolderId=this.g(this.c);var t=new _g.EI(300);t.explicitLogonUser=this.c.bl.OwnerEmailAddress;n.p(i,t,this.r,this.q)},l:function(n){this.e=new _g.cO(n.CalendarFolder);n.MasterList&&(this.f=new _g.bs(n.MasterList));this.d=!0},P:function(n){this.A&&(this.d=this.A.ErrorCode===31);_h.dY.prototype.P.call(this,n)},g:function(n){var i;if(n.bl.IsGeneralScheduleCalendar){var t=new _g.C("calendar");t.Mailbox=new _g.d;t.Mailbox.EmailAddress=this.c.bl.OwnerEmailAddress;i=t}else i=new _g.n(this.c.a().Id);return i}};_cc.L=function(n,t){_cc.L.initializeBase(this,[n,[t.i],null,"FullCalendarItem",1,t.g==="discoveryMailboxMode"]);var i=_js.e.s(_a.a.b,2,"GetCalendarItemAction");this.h=null;this.j=t;this.g="GetCalendarItem";this.d=t.h==="Text"?_h.b.M():_h.b.H();t.g==="unblockMode"&&(this.d.BlockExternalImagesIfSenderUntrusted=!1);t.j&&(this.f.explicitLogonUser=t.j);if(_cc.c.i()){this.d=_ff.g.a(this.d);this.d.AdditionalProperties||(this.d.AdditionalProperties=[]);Array.add(this.d.AdditionalProperties,new _g.e("SuggestionCategory"));Array.add(this.d.AdditionalProperties,_g.c.V())}_js.e.e(i)};_cc.L.a=function(n,t,i,r,u,f){i=$a(i)?_cc.L.b:i;r=$a(r)?"defaultMode":r;u=$a(u)?0:u;n=t?new _h.T(n):n;return new _cc.cc(n,i,r,u,f)};_cc.L.c=function(n){if(n.bl.IsOrganizer&&n.p())if(n.bl.Organizer)for(var r=n.bl.Organizer.Mailbox.EmailAddress,f=r?r.toLowerCase():"",t=0;t<n.p().b();t++){var i=n.p().a(t).bl.Mailbox.EmailAddress;if(i&&i.toLowerCase()===f){var u=n.p().s();_js.Trace.logInfo(_a.a.k,"Normalizing the RequiredAttendees Collection.");u.m(t);n.bc(u);break}}else _js.Trace.logWarning(_a.a.k,"model.Organizer is null.")};_cc.L.prototype={j:null,h:null,c:function(){return this.h},a:function(){return this.j},cp:function(n){var i=_js.e.s(_a.a.k,2,"ProcessResponseMessage:GetCalItem");var t=new _g.i(n.Items[0]);t.bW(2);(this.j.c()==="discoveryMailboxMode"||this.j.c()==="archiveMode")&&t.ey(!0);OwaApplication.k||_cc.L.c(t);t.bf();this.h=t;_js.e.e(i)}};_cc.cc=function(n,t,i,r,u){this.i=n;this.h=t;this.g=i;this.k=r;this.f=this.l();this.j=u};_cc.cc.prototype={i:null,f:null,h:"Best",g:"defaultMode",k:0,j:null,b:function(){return this.i},d:function(){return this.h},c:function(){return this.g},a:function(){return this.f},e:function(){return this.k},l:function(){var i=_g.bK.isInstanceOfType(this.i)?_g.bK.getName():_g.g.getName();var t=$a(this.h)?"":this.h;var n=$a(this.g)?"":this.g;return String.format("{0}_{1}_{2}_{3}",this.i.Id,i,t,n)}};_cc.Q=function(){_cc.Q.initializeBase(this)};_cc.Q.$$cctor=function(){_cc.Q.a=new _g.bT("IdOnly");_cc.Q.a.AdditionalProperties=[new _g.e("ItemParentId"),new _g.e("Sensitivity"),new _g.e("AppointmentState"),new _g.e("IsCancelled"),new _g.e("HasAttachments"),new _g.e("LegacyFreeBusyStatus"),new _g.e("CalendarItemType"),new _g.e("Start"),new _g.e("End"),new _g.e("IsAllDayEvent"),new _g.e("Organizer"),new _g.e("Subject"),new _g.e("IsMeeting"),new _g.e("UID"),new _g.e("InstanceKey"),new _g.e("ItemEffectiveRights"),new _g.e("JoinOnlineMeetingUrl"),new _g.e("ConversationId"),new _g.e("CalendarIsResponseRequested"),new _g.e("Categories"),new _g.e("IsRecurring"),new _g.e("IsOrganizer"),_g.c.bb(),new _g.e("IsSeriesCancelled")]};_cc.Q.prototype={h:null,s:function(n){_cc.cd.prototype.s.call(this,n);this.T||(this.T=_g.b.a.nameToId("calendar"));var r=_cc.Q.a;if(_cc.c.a()&&_js.d.a(this.J)){r=_ff.g.a(r);Array.add(r.AdditionalProperties,new _g.e("Charm"))}if(_cc.c.i()){r=_ff.g.a(r);Array.add(r.AdditionalProperties,new _g.e("SuggestionCategory"))}var i=new _g.hl(r,"Shallow");var o=new _g.n(this.T.Id);o.ChangeKey=this.T.ChangeKey;i.ParentFolderIds=[o];if(_g.tP.isInstanceOfType(this.Q))i.Paging=this.Q;else if(_h.j.isInstanceOfType(this.Q)){var e=this.Q;var s=new _g.dg(e.a.j(),e.b.j());i.Paging=s}else throw Error.invalidOperation("Unsupported paging type");var t=new _g.bz(this.x);t.isAutomated=this.Z;t.isReload=this.X;t.actionName=this.W?"GetCalendarItemsAction_"+_cc.k.toString(this.W):"GetCalendarItemsAction";this.J&&(t.explicitLogonUser=this.J);var h=new _g.hj(this.y(),i);_js.Trace.logInfo(_a.a.k,String.format("FindItem paging: {0}",Object.getType(this.Q).getName()));this.h=t;n.d(h,t,this.r,this.q);var f=i.ItemShape?i.ItemShape.AdditionalProperties:null;var u=f?f[0]:null;_js.Trace.logWarning(_a.a.k,"GetCalendarItems: {0}, {1}",u?u.FieldURI:"<null>",JsonParser.serialize(i.ParentFolderIds))},cp:function(n){if(n.RootFolder&&n.RootFolder.Items){var i=_js.e.s(_a.a.k,2,"ProcessResponseMessages:FindItem_"+n.RootFolder.Items.length);this.S.f();for(var t=0;t<n.RootFolder.Items.length;t++)this.bh(n.RootFolder.Items[t]);_js.e.e(i)}}};_cc.cd=function(){_cc.cd.$$(this.$$gta["_cc.cd"].TResult,this.$$gta["_cc.cd"].TResponseMessage).resolveInheritance();this.g=this.cA;_cc.cd.$$(this.$$gta["_cc.cd"].TResult,this.$$gta["_cc.cd"].TResponseMessage).initializeBase(this)};_cc.cd.$$=function(n,t){var i="cd"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_cc[i]){var u=_cc[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_cc.cd.apply(this,t)};var h=_h.dk.$$(n,t);u.registerClass("_cc."+i,h,_cc.cV);var o={"_cc.cd":{TResult:n,TResponseMessage:t}};var c=h.prototype.$$gta;for(var l in c){var s={key:l,value:c[l]};o[s.key]=s.value}u.prototype.$$gta=o;var f=_cc.cd.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _cc[i]};_cc.cd.prototype={Z:!1,W:0,T:null,S:null,Q:null,X:!1,f:function(){return this.T},k:function(n){this.T=n;return n},a:function(){return this.S},i:function(n){this.S=n;return n},d:function(){return this.Q},n:function(n){this.Q=n;return n},l:function(n){this.Z=n;return n},j:function(n){this.W=n;return n},c:function(){return this.X},m:function(n){this.X=n;return n},e:function(){return this.B()},s:function(n){},bh:function(n){var t=new _g.i(n);this.S.a(t)}};_cc.cD=function(n,t,i){_cc.cD.initializeBase(this);this.e=n;this.j=t;this.h=i};_cc.cD.prototype={e:null,j:!1,h:!1,g:null,f:null,c:null,d:null,i:null,s:function(n){var t=new _g.EJ(this.x);n.q(t,this.r,this.q)},bb:function(){if(PageDataPayload.calendarFolders){this.l(PageDataPayload.calendarFolders);OwaApplication.k||(PageDataPayload.calendarFolders=null);return!0}return!1},l:function(n){var w=_js.e.s(_a.a.b,2,"ProcessResponse:GetCalendar");var i;var l;var t;var r;this.d=new _js.f;var s={};var v={};var a={};var e;this.e&&(a[this.e.toLowerCase()]=!0);for(var c=0;c<n.CalendarGroups.length;c++){i=new _cc.m;i.dN(n.CalendarGroups[c]);switch(i.d()){case 0:i.e(_u.c.Bq);break;case 1:i.e(_u.c.e);this.i=i;break;case 2:i.e(_u.c.BY);break}if(i.a())for(var f=i.a().x.length-1;f>=0;f--){t=i.a().x[f];if(t.e()){this.c=t;this.c.q(_u.c.Bg)}else if(_g.v.isInstanceOfType(t)){r=t;if(r.bl.IsOwnerEmailAddressInvalid)continue;if(r.j()){if(!this.h){i.a().n(f);continue}r.n(_g.a.a().c().bl.DefaultPublicFolderMailbox.toLowerCase())}else r.n(r.bl.OwnerEmailAddress.toLowerCase());if(this.j&&r.bl.IsGroupMailboxCalendar){i.a().m(t,!0);continue}e=r.bl.IsGeneralScheduleCalendar?r.bl.OwnerEmailAddress:r.bl.SharedFolderId.Id;if(e in a){i.a().m(t,!0);continue}a[e]=!0;var y=new _g.fu;y.FolderId=t.a();var o=new _g.cO(y);o.e(t.bl.CalendarName);var u=new _g.fD;u.CreateAssociated=u.CreateContents=u.CreateHierarchy=u.Read=u.Modify=u.ViewPrivateItems=!1;o.I(u);o.A(r.j());s[t.a().Id]=o}v[t.a().Id]=t;t.k(t.o())}this.d.a(i)}for(var h=0;h<n.CalendarFolders.length;h++){l=new _g.cO(n.CalendarFolders[h]);s[l.bl.FolderId.Id]=l}var p=s[this.c.a().Id];p.M("calendar");this.g=s;this.f=v;_js.e.e(w)}};_cc.ce=function(n){_cc.ce.initializeBase(this);_a.b.a(n,"calendarEntry can't be null");this.f=n};_cc.ce.prototype={f:null,c:null,e:0,g:0,d:!1,s:function(n){var i=new _g.oF;var t=new _g.n(this.f.a().Id);t.ChangeKey=this.f.a().ChangeKey;i.CalendarId=t;var r=new _g.EM(this.x);n.ea(i,r,this.r,this.q)},l:function(n){this.c=new _js.f;this.d=n.IsAnonymousSharingEnabled;this.g=n.CurrentDeliveryOption;this.e=n.IsAnonymousSharingEnabled?_js.l.a(_cc.y,n.AnonymousSharingMaxDetailLevel):0;for(var r=n.Recipients,u=r.length,t=0;t<u;++t){var f=r[t];var i=new _cc.d;i.dN(f);this.c.a(i)}}};_cc.M=function(n,t,i,r){_cc.M.initializeBase(this,[n]);var u=_js.e.s(_a.a.b,2,"GetExpandedCalendarItemAction");this.f(null);this.g(t);this.e=r;i&&(this.d=i);_js.e.e(u)};_cc.M.prototype={d:null,e:null,a:function(){return this.dS(_cc.M.b)},f:function(n){this.dR(_cc.M.b,n);return n},c:function(){return this.dS(_cc.M.a)},g:function(n){this.dR(_cc.M.a,n);return n},s:function(n){var i;var f=null;if(this.c().b)i=f=new _g.nV(this.c().b.j());else{i=new _g.qX;i.Start=this.c().a.a.j();i.End=this.c().a.b.j()}i.Count=this.c().c;var u=new _g.lq(this.c().Id);f?u.ExpandAroundDateOccurrenceRange=f:u.Ranges=[i];var t=_cc.Q.a;if(_cc.c.a()&&_js.d.a(this.e)){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("Charm"))}if(_cc.c.i()){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("SuggestionCategory"))}var e=new _g.dR(t);e.ItemIds[0]=u;var o=new _g.dQ(this.y(),e);var r=new _g.eC(this.x);r.clientStoreItem=1;r.actionName="GetExpandedCalendarItemAction";_js.d.a(this.e)||(r.explicitLogonUser=this.e);n.a(o,r,this.r,this.q)},cp:function(n){throw Error.notImplemented("Messages are processed in ProcessResponseMessages method.");},cq:function(n){var u=_js.e.s(_a.a.k,2,"ProcessResponseMessages:GetExpandedCalendarItemAction");if(!n.length||n[0].ResponseClass==="Error")throw Error.create("GetExpandedCalendarItemAction failed.");if(n.length>0&&n[0].ResponseClass==="Success"){var i=n[0];if(i.Items.length>1){this.f(new _js.f);for(var t=1;t<i.Items.length;t++){var r=new _g.i(i.Items[t]);r.bW(0);this.a().a(r)}}}_js.e.e(u)}};_cc.cf=function(n,t){this.bg=new(_a.eJ.$$(String));this.bf=new(_a.eJ.$$(_g.cx));_cc.cf.initializeBase(this);this.Y=n;this.bg.b(n.bl.OwnerEmailAddress);this.ba=t};_cc.cf.prototype={Y:null,ba:null,bc:null,h:function(){return this.bg},o:function(){return this.bf},s:function(n){var o=_js.e.s(_a.a.b,2,"GetSharedCalendarItemsRequest:PreProcessing");_cc.cd.prototype.s.call(this,n);var t=new _g.kt(this.y());var f=new Array(1);var e=f[0]=new _g.kL;e.Email=new _g.jA;e.Email.Address=this.Y.bl.OwnerEmailAddress;var i=new _g.jL;i.RequestedView="Detailed";var u=this.Q;i.TimeWindow=new _g.jy(_a.c.d(u.a),_a.c.d(u.b));t.Body.MailboxDataArray=f;t.Body.FreeBusyViewOptions=i;var r=new _g.wf(this.x);r.isAutomated=this.Z;r.actionName=_js.d.b(this.ba)?this.bi():this.ba;_js.e.e(o);this.bc=_js.e.s(_a.a.b,517,"GetUserAvailabilityInternalRequest");n.y(t,r,this.r,this.q);_js.Trace.logWarning(_a.a.k,"GetSharedCalendarItems: {0}",JsonParser.serialize(t.Body))},H:function(){_a.dg.prototype.H.call(this);_js.e.e(this.bc);_js.Trace.logWarning(_a.a.k,"Unable to fetch calendar data for user: "+this.Y.bl.OwnerEmailAddress)},bZ:function(n,t){var u=_h.dk.prototype.bZ.call(this,n,t);if(!u){var f=t.g[0];var i=f.Responses;if(!i||i.length!==1||!i[0].ResponseMessage)return Error.create("GetSharedCalendarItemsAction received malformed response.",n);var r=i[0].ResponseMessage;if(r.ResponseClass!=="Success"||r.ResponseCode!=="NoError"){n.responseCode=r.ResponseCode;return Error.create(r.MessageText,n)}}return u},cp:function(n){_js.e.e(this.bc);var u=_js.e.s(_a.a.k,2,"ProcessResponseMessages:GetUserAvailabilityInternal");this.S.f();var t=n.Responses[0].CalendarView;var r=t.WorkingHours;if(r)this.bf.b(new _g.cx(r));else{_js.Trace.logInfo(_a.a.k,"Unable to fetch working hours for user: "+this.Y.bl.OwnerEmailAddress);this.bf.b(null)}this.Y.C=t.FreeBusyViewType==="Detailed"?"Detailed":"FreeBusy";for(var i=0;i<t.Items.length;i++)this.bh(t.Items[i]);_js.e.e(u)},bi:function(){return String.format("{0}_{1}","GetSharedCalendarItemsAction",_cc.k.toString(this.W))}};_cc.bK=function(n,t,i){_cc.bK.initializeBase(this);_a.b.b(n,"calendarToRename");_a.b.c(t,"newCalendarName");_a.b.b(i,"calendarsCache");this.c=n;this.d=t;this.e=i};_cc.bK.prototype={c:null,d:null,e:null,s:function(n){var t=new _g.g(this.c.bl.ItemId.Id);t.ChangeKey=this.c.bl.ItemId.ChangeKey;n.fH(t,this.d,null,this.r,this.q)},l:function(n){this.c.bl.ItemId.ChangeKey=n.NewCalendarEntryId.ChangeKey;this.c.q(this.d);if(_g.D.isInstanceOfType(this.c)){var i=this.c;if(this.e.p){var t=this.e.d(i.a());if(t){t.bl.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.e(this.d)}}}}};_cc.bL=function(n,t){_cc.bL.initializeBase(this);this.c=n;this.d=t};_cc.bL.prototype={c:null,d:null,s:function(n){var t=new _g.g(this.c.c().Id);t.ChangeKey=this.c.c().ChangeKey;n.fI(t,this.d,null,this.r,this.q)},l:function(n){this.c.e(this.d);this.c.c().ChangeKey=n.NewGroupItemId.ChangeKey}};_cc.bN=function(n,t){_cc.bN.initializeBase(this);_a.b.a(n,"Calendar to modify the color of must be specified.");this.c=n;this.d=t};_cc.bN.prototype={c:null,d:0,s:function(n){var t=new _g.g(this.c.bl.ItemId.Id);t.ChangeKey=this.c.bl.ItemId.ChangeKey;n.fQ(t,this.d,null,this.r,this.q)},l:function(n){this.c.k(this.d);this.c.v(this.d);this.c.bl.ItemId.ChangeKey=n.NewCalendarEntryId.ChangeKey}};_cc.cE=function(n,t){_cc.cE.initializeBase(this);this.a=n;this.c=t};_cc.cE.prototype={a:null,c:"None",s:function(n){var u=new _g.fu;u.Charm=this.c;var e=new _g.ea(new _g.e("Charm"),u);var r=new _g.eB(_g.s.a(this.a.bl.FolderId));r.Updates=[e];var t=new _g.ed;t.FolderChanges=[r];var i=new _g.eR(this.y());i.Body=t;var f=new _g.ic(this.x);n.b(i,f,this.r,this.q)},cp:function(n){this.a.K(this.c);this.a.bl.FolderId.ChangeKey=n.Folders[0].FolderId.ChangeKey}};_cc.bO=function(n,t,i,r){_cc.bO.initializeBase(this);_a.b.a(n,"calendarEntry can't be null");this.d=n;this.c=t;this.h=i;this.i=r};_cc.bO.prototype={d:null,c:0,h:!1,i:!1,g:null,e:null,f:null,j:0,k:0,s:function(n){this.g=_js.e.s(_a.a.b,517,"SetCalendarPublishingAction:Request");var t=new _g.sa;var i=new _g.n(this.d.a().Id);i.ChangeKey=this.d.a().ChangeKey;t.CalendarId=i;t.Publish=this.c&&this.h?!0:!1;t.DetailLevel=_cc.y.toString(this.c);t.ResetUrl=this.i;var r=new _g.Mu(this.x);n.fS(t,r,this.r,this.q)},l:function(n){this.e=n.BrowseUrl;this.f=n.ICalUrl;this.j=n.CurrentDetailLevel?_js.l.a(_cc.y,n.CurrentDetailLevel):0;this.k=n.MaxDetailLevel?_js.l.a(_cc.y,n.MaxDetailLevel):0;_js.e.e(this.g)}};_cc.H=function(n,t,i,r,u,f){_cc.H.initializeBase(this,[1]);this.d=n;this.a=t;this.bh=i;this.W=r;this.k=u;this.o=f;this.l="UpdateCalendarItemAction";var e=n;e.bl.ParentFolderId&&(this.S=_g.s.c(e.bl.ParentFolderId))};_cc.H.e=function(n){if($a(n))return new _g.bJ(new _g.e("Recurrence"));var i=new _g.L(new _g.e("Recurrence"));var t=new _g.P;t.Recurrence=_g.bo.b(n);i.Item=t;return i};_cc.H.c=function(n){var i=new _g.L(new _g.e("EnhancedLocation"));var t=new _g.P;t.Location=_g.y.d(n);i.Item=t;return i};_cc.H.a=function(n,t){if(!t||!t.b())return new _g.bJ(new _g.e(n));var r=_cc.n.a(t.g.o);var u=new _g.L(new _g.e(n));var i=new _g.P;n==="RequiredAttendees"?i.RequiredAttendees=r:n==="OptionalAttendees"?i.OptionalAttendees=r:i.Resources=r;u.Item=i;return u};_cc.H.b=function(n){var r=new _g.e("Categories");if(!n||!n.b())return new _g.bJ(r);var u=n.g();var t=new _g.L(r);var i=new _g.P;i.Categories=u;t.Item=i;return t};_cc.H.d=function(n){if(!n||!n.b())return new _g.bJ(new _g.e("InboxReminders"));var i=new _g.L(new _g.e("InboxReminders"));var t=new _g.P;t.InboxReminders=n.g.o;i.Item=t;return i};_cc.H.f=function(n,t){t.val=null;if(!n||!n.b())return!1;for(var r=new _ff.e,u=0;u<n.b();u++){var h=n.a(u);var i;var s,f;if(f=_h.K.c(h,s={val:i}),i=s.val,f){var e=new _g.P;var o=new _g.L(i.ExtendedFieldURI);_h.l.c(e,i);o.Item=e;r.c(o)}}r.d.length>0&&(t.val=r.i());return r.d.length>0};_cc.H.prototype={W:!1,o:null,k:null,d:null,a:null,X:null,n:function(){_h.di.prototype.n.call(this);this.g.isReferencedItemRecurring=this.W;this.g.explicitLogonUser=this.o},cp:function(n){this.d.bL(n.Items[0].ItemId);this.a.bL(n.Items[0].ItemId);this.k&&_cc.z.isInstanceOfType(this.k)&&this.k.G()},E:function(){this.X=this.Y(this.d,this.a);_a.dg.prototype.E.call(this)},Y:function(n,t){var i=[];if(n.bl.Subject!==t.bl.Subject){var ct=new _g.L(new _g.e("Subject"));var et=new _g.P;et.Subject=t.bl.Subject;ct.Item=et;Array.add(i,ct)}if(t.gh()){var ft=new _g.L(new _g.e("Body"));var st=new _g.P;st.Body=new _g.G(t.z().a()==="HTML"?"HTML":"Text",t.z().bl.Value);ft.Item=st;Array.add(i,ft)}_g.h.h(n.bv(),t.bv())&&Array.add(i,_cc.H.b(t.bv().c));if(t.bG()&&n.bl.IsResponseRequested!==t.bl.IsResponseRequested){var ot=new _g.L(new _g.e("CalendarIsResponseRequested"));var it=new _g.P;it.IsResponseRequested=t.bl.IsResponseRequested;ot.Item=it;Array.add(i,ot)}var wt=!_a.c.c(n.a(),t.a());var bt=!_a.c.c(n.b(),t.b());var kt=n.bl.IsAllDayEvent!==t.bl.IsAllDayEvent;if(kt||wt||bt){if(t.bl.IsAllDayEvent!==undefined){var tt=new _g.L(new _g.e("IsAllDayEvent"));var ut=new _g.P;ut.IsAllDayEvent=t.bl.IsAllDayEvent;tt.Item=ut;Array.add(i,tt)}if(t.a()){var rt=new _g.L(new _g.e("StartTimeZone"));var yt=new _g.P;var ht=new _g.eQ;ht.Id=this.V();yt.StartTimeZone=ht;rt.Item=yt;Array.add(i,rt);var lt=new _g.L(new _g.e("Start"));var vt=new _g.P;vt.Start=t.a().j();lt.Item=vt;Array.add(i,lt)}if(t.b()){var at=new _g.L(new _g.e("EndTimeZone"));var p=new _g.P;var nt=new _g.eQ;nt.Id=this.V();p.EndTimeZone=nt;at.Item=p;Array.add(i,at);var c=new _g.L(new _g.e("End"));var l=new _g.P;var f;f=t.bl.IsAllDayEvent?t.b().f().c(1):t.b();l.End=f.j();c.Item=l;Array.add(i,c)}}if(n.k()!==t.k()){var a=new _g.L(new _g.e("LegacyFreeBusyStatus"));var h=new _g.P;h.FreeBusyType=t.k();a.Item=h;Array.add(i,a)}var dt=n.bl.ReminderIsSet!==t.bl.ReminderIsSet;var pt=n.bl.ReminderMinutesBeforeStart!==t.bl.ReminderMinutesBeforeStart;if(dt||pt){var e=new _g.L(new _g.e("ReminderIsSet"));var o=new _g.P;o.ReminderIsSet=t.bl.ReminderIsSet;e.Item=o;Array.add(i,e);var s=new _g.L(new _g.e("ReminderMinutesBeforeStart"));var k=new _g.P;k.ReminderMinutesBeforeStart=t.bl.ReminderMinutesBeforeStart;s.Item=k;Array.add(i,s)}if(n.bH()!==t.bH()){var b=new _g.L(new _g.e("Sensitivity"));var g=new _g.P;g.Sensitivity=t.bH();b.Item=g;Array.add(i,b)}if(n.ce()!==t.ce()){var d=new _g.L(new _g.e("Charm"));var y=new _g.P;y.Charm=t.ce();d.Item=y;Array.add(i,d)}_g.bH.a(n.q(),t.q())||Array.add(i,_cc.H.c(t.q()));_g.bH.a(n.C(),t.C())||Array.add(i,_cc.H.e(t.C()));_g.t.b(n.p(),t.p())&&Array.add(i,_cc.H.a("RequiredAttendees",t.p()));_g.t.b(n.s(),t.s())&&Array.add(i,_cc.H.a("OptionalAttendees",t.s()));_g.t.b(n.D(),t.D())&&Array.add(i,_cc.H.a("Resources",t.D()));_g.cc.a(n.bQ(),t.bQ())&&Array.add(i,_cc.H.d(t.bQ()));$a(t.df())||Array.add(i,this.Q(_g.c.E(),t.df()));$a(t.cI())||Array.add(i,this.Q(_g.c.D(),t.cI()));$a(t.dC())||Array.add(i,this.Q(_g.c.C(),t.dC()));if(t.bJ()&&t.bJ().b()>0){var u;var v,w;n.bJ()&&_h.cL.a(n.bJ().c,t.bJ().c)||(w=_cc.H.f(t.bJ(),v={val:u}),u=v.val,!w)||Array.addRange(i,u)}var r=new _g.bY;if(t.eh()===1){r.ItemId=new _g.bK(t.bl.ItemId.Id);r.ItemId.__type=_g.bK._dataContractName}else{r.ItemId=t.bl.ItemId;r.ItemId.__type=_g.g._dataContractName}r.Updates=i;return r},h:function(){return[this.X]},Q:function(n,t){var r=new _g.L(n);var i=new _g.P;i.ExtendedProperty=new Array(1);i.ExtendedProperty[0]=new _g.bp;i.ExtendedProperty[0].ExtendedFieldURI=n;i.ExtendedProperty[0].Value=t;r.Item=i;return r}};_cc.bo=function(n){this.o=Function.createDelegate(this,this.C);_cc.bo.initializeBase(this,[n,new _cc.bP(n.b().Id)]);if(!_h.t.b){var t=new _g.be;t.NotificationType="HierarchyNotification";var i=new _h.J(t);i.l(this.bm(),"HierarchyNotification",this.o,1)}};_cc.bo.a=function(n,t,i){var u=new _g.ly(n.a(),n.bl.unfoldedIndex);var r=new _g.bG("Beginning",u);r.Offset=t;r.MaxEntriesReturned=i;return r};_cc.bo.prototype={f:null,h:null,i:!1,bm:function(){return _a.a.da},t:function(){this.f=null;this.h=null;this.i=!1;this.bl.f()},W:function(n){return null},bd:function(n){return!1},bs:function(n){return new _g.i(n)},bI:function(n,t,i,r,u,f){f=this.v();if(this.h){if(this.bY===4)_h.t.prototype.bI.call(this,n,t,i,r,u,f);else if(this.i){_h.t.prototype.bI.call(this,n,t,i,!1,!1,f);var o=Math.min(this.h.a-this.e(),this.bl.x.length);o>0&&this.bl.F(0,o,f)}else{_h.t.prototype.bI.call(this,n,t,i,!1,!0,f);var e=this.bl.x.length-this.h.b;if(e>0){var s=this.bl.x.length-e;this.bl.F(s,e,f)}}this.bK(this.h.a);this.cI=-1}else _h.t.prototype.bI.call(this,n,t,i,r,u,f)},bH:function(n){if(this.f){this.bP(4);var i=_g.V.isInstanceOfType(this.f)?_cc.bo.a(this.bl.x[0],0,this.f.MaxEntriesReturned):this.f;var t=this.p(i);this.bA(t)}else this.bP(0)},dQ:function(n,t){var i=n;var u=i.a();this.bw(n,t);var r=i.a();return u.k(r)?!0:!1},bw:function(n,t){var i=n;i.dB(t)},bt:function(n,t){var u;if(_h.o.isInstanceOfType(n)){var i=n;this.h=i;this.i=i.a>this.e();u=this.D(i);var e=new _g.V("Beginning");e.Offset=i.a;e.MaxEntriesReturned=i.b;this.f=e}else if(_h.bH.isInstanceOfType(n)){var f=n;var r=new _g.bG("Beginning",f.a);r.Offset=f.b;r.MaxEntriesReturned=f.c;u=r;this.f=u;this.h=null;var o=r.Condition.Item;var s=o.FieldURIOrConstant.Item}else throw Error.argumentType("loadRowsArg");this.bP(1);return this.p(u)},bx:function(n){var t=n;this.bJ(t.h.tableSize);this.cp=_g.bG.isInstanceOfType(this.f);if(this.cp){this.bK(t.h.loadedStartIndex);this.cI=t.h.firstMatchingRowIndex}var i=t.A.Body.ResponseMessages.Items[0].RootFolder.Items;return new _cc.cC(i)},dN:function(n){var t=n;return t.p()==="ErrorCalendarSeekToConditionNotSupported"?!0:_h.t.prototype.dN.call(this,n)},D:function(n){var r;var i;var t=this.bl;if(this.i){i=0;r=t.x[t.x.length-1]}else{i=n.a-this.e();r=t.x[0]}var u=Math.abs(n.a-this.e())+1;return _cc.bo.a(r,i,u)},p:function(n){var t=new _cc.Q;t.T=_g.b.a.nameToId("calendar");t.Q=n;t.S=new _js.f;t.X=this.bY===4;return t},v:function(){return this.bY===4&&this.bl.x.length>0?4:this.cp?5:this.i?2:3},C:function(n){if(n.clientGenerated){var t=n;this.d().Id===t.folderId&&_cc.bP.a(n,this)}}};_cc.cu=function(n,t,i,r){this.a=n;var e=this;this.c=t||function(){};var f=this;this.d=i||function(){};var u=this;this.b=r||function(){}};_cc.cu.prototype={a:null,c:null,d:null,b:null,dispose:function(){this.c=null;this.d=null;this.b=null}};_cc.bp=function(n){_cc.bp.initializeBase(this,[n,new _cc.cH(n.b().Id)])};_cc.bp.prototype={bs:function(n){return new _g.eh(n)},v:function(n,t,i,r){_cc.bB.prototype.v.call(this,n,t,i,r);if(_cc.bh.isInstanceOfType(n)){var u=n;u.h=t}},E:function(){return new _cc.bh}};_cc.N=function(n,t){_cc.N.initializeBase(this,[n,t||new _cc.cG(n.b().Id)])};_cc.N.prototype={E:function(){return new _cc.Q}};_cc.bB=function(n,t){this.M=Function.createDelegate(this,this.cq);this.D=Function.createDelegate(this,this.cr);this.N=Function.createDelegate(this,this.cs);_cc.bB.initializeBase(this,[n,t]);if(t&&!_cc.bR.isInstanceOfType(t)&&!_h.t.b){this.C=t;var i=new _g.be;i.NotificationType="HierarchyNotification";this.F=new _h.J(i);this.F.l(this.bm(),"HierarchyNotification",this.N,1)}this.be(this.bl,null)};_cc.bB.b=function(n,t){var r=n;var i=t;return r.a().b(i.a())};_cc.bB.a=function(n){return new _h.j(n.a.m(1),n.b)};_cc.bB.prototype={F:null,C:null,bv:90,f:null,H:0,bi:!1,h:null,bN:function(n){this.bz("CalendarDataLoaded",n)},cA:function(n){this.bS("CalendarDataLoaded",n)},bQ:function(n){this.bz("CalendarError",n)},cB:function(n){this.bS("CalendarError",n)},bT:function(n){this.bz("CalendarNotification",n)},cD:function(n){this.bS("CalendarNotification",n)},bG:function(n){this.bz("CacheContentsChanged",n)},cz:function(n){this.bS("CacheContentsChanged",n)},bm:function(){return _a.a.Q},m:function(){return!1},by:function(n){if(n&&!this.h){this.h=new _cc.cv(this.bl);this.be(this.h.a,this.bl)}else if(!n&&this.h){this.h.dispose();this.h=null;this.be(this.bl,null)}this.h&&this.h.i(n);return n},bg:function(){return this.h?this.h.a:this.bl},bD:function(){},bE:function(){},cK:function(){this.C&&this.C.A()},cE:function(){this.C&&this.C.z(this)},bq:function(n,t){this.H=t;if(this.f&&this.f.d(n,!0)){_js.Trace.logInfo(this.bm(),"[CalendarItemsCache] Requesting items from cache. Source: {0}, date range: {1}, calendar: {2}.",_cc.k.toString(t),n,this.d().Id);this.I(!0,this.d(),n,!1,null,!0)}else{if(this.cl(n)){_js.Trace.logInfo(this.bm(),"[CalendarItemsCache] Ignoring the request because the date range is already requested. Source: {0}, date range: {1}, calendar: {2}.",_cc.k.toString(t),n,this.d().Id);return}_js.Trace.logInfo(this.bm(),"[CalendarItemsCache] Requesting items from data store. Source: {0}, date range: {1}, calendar: {2}.",_cc.k.toString(t),n,this.d().Id);this.bi=!0;this.Y(n,null,null,null)}},bs:function(n){return new _g.i(n)},p:function(){_js.Trace.logInfo(this.bm(),"[CalendarQueryItemTableBase] Clearing cache.");this.f=null;this.bl.f()},P:function(n){var t=_ff.u.a(n,_cc.bB.b,this.bl);t!==-1&&this.bl.r(t,n);return t},J:function(n){var t;var r,i;(i=this.dc(n.Id,r={val:t}),t=r.val,i)&&this.bl.n(t);return t},i:function(n,t){for(var u=!1,i=this.bl.x.length-1;i>=0;i--){var r=this.bl.x[i];if(r.bl.InstanceKey===n||t&&r.bl.InstanceKey===t){this.bl.n(i);u=!0}}return u},t:function(n,t,i){if(this.f){var r=-1;switch(t){case 0:r=this.bF(n);break;case 1:r=this.ce(n);break;default:_js.Trace.logError(this.bm(),"Unknown AddOrModifyMode value: "+t);break}if(r!==-1){var u=this.bl.x[r];u.bl.IsRecurring&&t===1?this.i(u.bl.InstanceKey,null):this.bl.n(r);if(this.f.h(n.a(),n.b())){var e=this.P(n);e===-1&&_js.Trace.logWarning(this.bm(),"Couldn't find index to insert calendar item. Id="+n.bl.ItemId.Id)}}else if(!i&&this.f.h(n.a(),n.b())){var f=this.P(n);f===-1&&_js.Trace.logWarning(this.bm(),"Couldn't find index to insert new calendar item. Id="+n.bl.ItemId.Id)}}},bF:function(n){_a.b.b(n,"calItem");var t;var u,f;if(f=this.dc(n.bl.ItemId.Id,u={val:t}),t=u.val,f)return t;var i,r;return(r=this.dc(_g.i.c(n).Id,i={val:t}),t=i.val,r)?t:-1},bf:function(n,t){var i;var f=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;var u,r;return(r=this.dc(t.Id,u={val:i}),i=u.val,r)?this.bl.x[i]:f},cg:function(n,t){_js.i.c(n,"dateRange");var f=[];var r=t?this.bg():this.bl;if(this.cj(n))for(var e=r.x.length,i=0;i<e;++i){var o=r.x[i];var u=n.i(o);if(u){if(u>0)break}else Array.add(f,r.x[i])}return f},bH:function(n){if(this.f){_js.Trace.logInfo(this.bm(),"[CalendarQueryItemTableBase] Reloading cache.");var i=this.f;if(this.bp){var r=this.bh(this.bp);i=_h.j.d(this.f,r)}var t=this.E();this.v(t,i,!0,!0);this.bA(t)}},bk:function(){!_h.t.b&&this.F&&this.F.p(this.N);if(this.bp){this.bp.dispose();this.bp=null}_h.t.prototype.bk.call(this)},bx:function(n){throw Error.invalidOperation();},de:function(n){var t=n;this.I(!1,t.f(),this.bh(n),t.c(),t.e(),!1)},bt:function(n,t){if(!_h.j.isInstanceOfType(n))throw Error.argumentType("loadRowsArg",n?Object.getType(n):null,_h.j,"loadRowsArg needs to be a DateRange object");var u=n;this.f&&_h.j.c(this.f,u)&&this.p();var r=this.ci(u);if(r){var i=this.E();this.v(i,r,!1,!1);return i}return null},dH:function(n){var i=n;var t=i.d();if(this.bp&&this.bp!==n){var r=String.format("Detected invalid action in merge rows, table [{0}], action: [{1}], date range: [{2}]. Will discard results as there is another action in progress.",this.bn.a(),n.F,t);_js.Trace.logError(this.bm(),r);return!1}this.bg().e(this.D);try{t.a.x()===1&&(t.a=t.a.m(-1));i.c()&&this.p();this.bW(i);this.cb(t)}finally{this.bg().d(this.D)}this.I(!0,i.f(),t,i.c(),i.e(),!1);return!0},v:function(n,t,i,r){n.k(this.d());this.H&&n.j(this.H);n.n(_cc.bB.a(t));var u=new _js.f;n.i(u);n.l(i);n.m(r)},be:function(n,t){if(t){t.e(this.D);t.e(this.M)}n.d(this.D);n.d(this.M)},cl:function(n){if(!this.bp)return!1;var i=this.bh(this.bp);var t=_cc.bB.a(n);return i.d(t,!0)},ce:function(n){var i=this;var t=this.bl.h(function(t){return t.bl.InstanceKey===n.bl.InstanceKey});return t<this.bl.x.length?t:-1},cj:function(n){return!!this.f&&(this.f.b.b(n.a)>=0||this.f.a.b(n.b)<=0)},cs:function(n){var t=n;t.folderId?n.clientGenerated&&n.EventType==="Reload"&&this.bX&&this.d().Id===t.folderId&&this.X():this.X()},bW:function(n){var i=n.d();_js.Trace.logInfo(this.bm(),"AddResultsToCache: Item Count: {0}",n.a().x.length);var u;var f=!0;var l=!!this.f&&_h.j.c(this.f,i);if(l){var y=String.format("CalendarItemQueryTableBase.AddResultsToCache: Disjointed range encountered when adding items, range in cache: {0}, range in action: {1}",this.f,i);_js.Trace.logError(this.bm(),y);this.p()}if(this.f)if(i.d(this.f,!1)){this.p();u=!0;f=!1}else if(this.f.d(i,!0)){_js.Trace.logInfo(this.bm(),"AddResultsToCache: Not adding items to cache because the range in cache already contains the range in action. RangeInCache: {0}, RangeInAction: {1}",this.f,i);return}else u=i.a.b(this.f.a)>=0;else{u=!0;f=!1}var r=[];if(this.f&&_h.j.a(i,this.f)){var t;if(u)for(var o=n.a().x.length-1;o>=0;o--){t=n.a().x[o];if(t.a().b(this.f.b)<0)break;this.bB(t,f)||Array.insert(r,0,t)}else for(var s,e=0,a=n.a().x.length;e<a;e++){t=n.a().x[e];if(t.a().b(this.f.a)>=0)break;s=this.f.i(t);s<0?this.bB(t,f)||Array.add(r,t):s>0&&_js.Trace.logError(this.bm(),"Unexpected item that occurs after the range in cache")}}else for(var c,h=0,v=n.a().x.length;h<v;h++){c=n.a().x[h];this.bB(c,f)||Array.add(r,c)}r.length>0&&(u?this.bl.p(r):this.bl.s(0,r));this.f=_h.j.d(i,this.f)},bB:function(n,t){return t&&(n.h()||n.a().i()!==n.b().i())&&this.ca(n)},ca:function(n){return this.bF(n)!==-1},cb:function(n){if(!n.d(this.f,!0)){var s=this.f.a.c(this.bv);if(!(this.f.b.b(s)<=0)){var h=n.a.bd(this.f.a);var r;var t=-1;var o=[];var u=0;var i;if(h){r=new _h.j(this.f.a,s);for(var e=this.bl.x.length-1;e>=0;--e){i=this.bl.x[e];if(i.a().b(r.b)<=0){t=e;break}}if(t!==-1){t=Math.min(t+1,this.bl.x.length);u=Math.max(0,this.bl.x.length-t)}}else{r=new _h.j(this.f.b.c(-this.bv),this.f.b);for(var f=0;f<this.bl.x.length-1;f++){i=this.bl.x[f];if(i.a().b(r.a)>=0){t=0;u=f;break}r.i(i)||Array.add(o,i)}}if(t!==-1&&u>0){this.bl.q(t,u);o.length>0&&this.bl.s(0,o)}this.f=r}}},ck:function(n){var t=!1;this.f&&(t=this.f.d(n,!0));return t},ci:function(n){return this.f?this.ck(n)?null:n:n},I:function(n,t,i,r,u,f){var e=n?"CalendarDataLoaded":"CalendarError";this.bR(e,this,new _cc.ca(null,t,i,r,u,null,f))},cr:function(n,t){this.bR("CalendarNotification",this,new _cc.cb(this.d(),t))},cq:function(n,t){this.cw("CacheContentsChanged")},bh:function(n){return n.d()}};_cc.cv=function(n){this.d=Function.createDelegate(this,this.h);this.b=n;this.a=new _js.f;this.a.B(this.b);this.b.d(this.d)};_cc.cv.prototype={b:null,c:null,e:null,a:null,i:function(n){if(n===this.e)return n;this.e=n;this.c=n?n.toLocaleUpperCase():null;this.f();return n},dispose:function(){if(this.a){this.b.e(this.d);this.a.f();this.a.B(this.b);this.a.dispose();this.a=null}},f:function(){for(var t=new _ff.e,n=0;n<this.b.x.length;n++)this.g(this.b.x[n],t);this.a.f();t.d.length&&this.a.p(t.d)},g:function(n,t){var i=!!n.bl.Subject&&n.bl.Subject.toLocaleUpperCase().indexOf(this.c)>-1;i&&t.c(n)},h:function(n,t){this.f()}};_cc.cw=function(n,t,i,r,u,f,e){this.b={};_cc.cw.initializeBase(this);this.j=n;this.d=i;this.h=r;this.e=u;this.i=f;this.g=e;this.c=t};_cc.cw.prototype={c:null,d:null,i:null,h:null,e:null,g:null,j:null,f:null,G:function(n){if(this.f===n)return n;var r=null;this.f||(r=_a.d.b(_a.a.k,"FilterSurfaceItems"));this.f=n;var i=this.b;for(var t in i){var f={key:t,value:i[t]};var u=f.value;u.by(n)}_a.d.a(r);return n},I:function(n,t){if(t in this.b){var i=this.b[t];this.r(i);_h.i.a().e(i);var r=this.c.b(i.d());this.l(r);delete this.b[t]}},m:function(n,t,i){if(_g.v.isInstanceOfType(n)){var r=this;this.c.bv(n.a(),function(){if(!r.c.G(n)){_js.Trace.logWarning(_a.a.Q,"Skipping RequestItems as user does not have access. ItemId:{0}",n.bl.ItemId);return}var u=r.l(n);u.bL||u.bq(t,i)})}else{var u=this.l(n);u.bq(t,i)}},y:function(n,t){var i=this.a(n);return i?i.bf(_g.i,t):null},D:function(n){this.x(n);this.B(n)},s:function(n){n.cu()&&_g.i.e(n);var t=this.a(n.e());t&&t.t(n,0,!1)},A:function(n,t){var i=this.a(n.e());i&&i.t(n,t,!0)},E:function(n){var t=this.a(n.e());t&&t.J(n.bl.ItemId)},H:function(n){var t=this.a(n);t&&t.cK()},F:function(n){var t=this.a(n);t&&t.cE()},v:function(n){var t=this.a(n);t&&t.p()},k:function(n,t){var i=this.a(n);return i?i.cg(t,!0):[]},n:function(){_js.Trace.logInfo(_a.a.Q,"CalendarItemsCache:CheckAndReloadCache");var n=!1;var i=this.b;for(var t in i){var u={key:t,value:i[t]};var r=u.value;n=r.cF()||n}return n},C:function(n){var t=this.a(n);t&&t.ba()},a:function(n){var t=n.a();return this.b[t.Id]},o:function(n){return new(_h.dV.$$(_cc.N))(n)},w:function(n){return new(_h.dV.$$(_cc.bp))(n)},p:function(n){return new(_h.dV.$$(_cc.bQ))(n)},q:function(n){return new(_h.dV.$$(_cc.z))(n)},l:function(n){var t=this.a(n);if(!t){var i=n.a();if(_g.D.isInstanceOfType(n))if(this.z(n)){var h=this.w(i);var a=this;t=_h.d.b(h,_h.i.a(),function(n){return new _cc.bp(n)})}else{var s=this.o(i);var l=this;t=_h.d.b(s,_h.i.a(),function(n){return new _cc.N(n)})}else{var u=n;if(u.bl.IsGroupMailboxCalendar){var f=this.p(i);var v=this;t=_h.d.D(f,u.bl.OwnerEmailAddress,function(n,t){return new _cc.bQ(n,t)});var e=t;e.o=n}else{var o=this.q(i);var c=this;t=_h.d.b(o,_h.i.a(),function(n){return new _cc.z(n)});var r=t;r.o=n;r.K=this.c}}this.t(t);this.b[i.Id]=t;t.cF()}return t},z:function(n){return this.j.a().B().Enabled&&n.bl.CalendarFolderType===3},B:function(n){var i=n.a().Id;if(this.b[i]){var t=this.b[i];t.p();_h.i.a().l(t);delete this.b[i];t.dispose()}},t:function(n){this.e&&n.bQ(this.e);this.d&&n.bG(this.d);n.bT(this.i);n.bN(this.h);n.Q(this.g);n.bD();n.by(this.f)},x:function(n){var t=this.a(n);this.r(t)},r:function(n){if(n){n.by(null);n.p();this.e&&n.cB(this.e);this.d&&n.cz(this.d);n.cD(this.i);n.cA(this.h);n.bb(this.g);n.bE()}}};_cc.w=function(n,t,i,r,u){this.C=Function.createDelegate(this,this.bd);this.G=Function.createDelegate(this,this.bh);this.F=Function.createDelegate(this,this.bg);this.D=Function.createDelegate(this,this.be);this.B=Function.createDelegate(this,this.bc);this.s=Function.createDelegate(this,this.bp);this.v=Function.createDelegate(this,this.br);this.t=Function.createDelegate(this,this.bq);this.p=Function.createDelegate(this,this.bi);this.r=Function.createDelegate(this,this.bm);this.q=Function.createDelegate(this,this.bl);this.H=Function.createDelegate(this,this.bn);this.E=Function.createDelegate(this,this.bf);_cc.w.initializeBase(this);_a.b.a(t,"selectedCalendars");this.y=n;this.k=0;this.m=i;this.c=r;this.f=t;this.o=u;this.Z()};_cc.w.prototype={m:null,y:null,o:null,l:null,e:null,c:null,k:0,d:null,f:null,h:!1,j:null,A:null,J:function(n){this.bz("FetchingCalendarsCompleted",n)},R:function(n){this.bS("FetchingCalendarsCompleted",n)},I:function(n){this.bz("CalendarError",n)},Q:function(n){this.bS("CalendarError",n)},w:function(n){this.bz("CalendarNotification",n)},z:function(n){this.bS("CalendarNotification",n)},T:function(n){this.bz("CalendarCacheStaleStatusChanged",n)},bu:function(n){this.bS("CalendarCacheStaleStatusChanged",n)},n:function(){return this.k},Z:function(){this.d=new _cc.cy;this.e=this.W();this.c.bh(this.E);this.m&&(this.l=this.m.b(this));this.f.d(this.H);for(var n=0,t=this.f.x.length;n<t;n++)this.d.f(this.f.x[n].a())},bs:function(n,t){this.o&&this.o.a(n,t)},S:function(n,t){this.d.m();this.h=!0;this.j=new Date;for(var i=0,r=this.f.x.length;i<r;i++)this.i(this.f.x[i],n,t)},i:function(n,t,i){_a.b.a(t,"dateRange");this.A=_js.e.s(_a.a.k,517,"RequestItems");this.f.y(n)&&this.d.f(n.a());this.e.m(n,t,i)},a:function(n){for(var i=null,t=0,r=this.f.x.length;t<r;++t){i=this.e.y(this.f.x[t],n);if(i)break}return i},K:function(n){this.e.G(n)},U:function(n){this.e.s(n)},bb:function(n,t){this.e.A(n,t)},bv:function(n){this.e.E(n)},N:function(n){return this.d.c(n)===1},bx:function(){for(var n=0,t=this.f.x.length;n<t;++n)this.e.H(this.f.x[n])},bw:function(){for(var n=0,t=this.f.x.length;n<t;++n)this.e.F(this.f.x[n])},x:function(n){this.d.g(n.a());this.e.v(n)},M:function(n,t){var r=_js.e.s(_a.a.k,2,"CacheManager_GetCachedItemsFromCalendar");var i=this.e.k(n,t);_js.e.e(r);return i},L:function(n){for(var u=_js.e.s(_a.a.k,2,"CacheManager_GetCachedItems"),r=[],t=0;t<this.f.x.length;++t){var i=this.f.x[t];this.d.c(i.a())===1&&Array.addRange(r,this.M(i,n))}_js.e.e(u);return r},P:function(n){for(var i=0;i<n.length;++i){var t=n[i];var r=this.c.d(t.bl.ParentFolderId);t.cR()&&r.bl.EffectiveRights.Read&&this.ba(300,t.bl.ItemId,_g.i.a(t))}},X:function(n){n.bB(this.q);n.v(this.r);n.z(this.p)},Y:function(n){n.bB(this.t);n.v(this.v);n.z(this.s)},g:function(n,t,i,r,u,f,e,o){return this.l.f(n,t,e,o,i,r,f,u)},ba:function(n,t,i){return this.l.f(n,t,"HTML","defaultMode",null,null,null,i,1)},V:function(){return this.e.n()},b:function(n){return this.e.a(n)},bd:function(){this.cw("CalendarCacheStaleStatusChanged")},be:function(n,t){_js.Trace.logInfo(_a.a.Q,"[CalendarCacheManager] Triggering CalendarDataLoaded. View model: {0}, date range: {1} - {2}, calendar: {3}.",t.f,t.a?t.a.a:null,t.a?t.a.b:null,t.b.Id);_js.e.e(this.A);var i=_js.e.s(_a.a.b,2,"OnCalendarDataLoaded");this.d.j(t.b);this.bR("CalendarDataLoaded",this,t);t.e=this.j;this.j=null;if(this.h||t.d){this.h=!1;this.bR("FetchingCalendarsCompleted",this,t)}else this.bt(t.b,t.a);_js.e.e(i)},bg:function(n,t){this.d.i(t.b);this.bR("CalendarError",this,t);if(this.h){this.h=!1;this.bR("FetchingCalendarsCompleted",this,new _cc.ca(null,t.b,t.a,t.d,t.c,this.j))}},W:function(){return new _cc.cw(this.y,this.c,this.B,this.D,this.F,this.G,this.C)},bl:function(n){var i=n;var t=i.a();if(t.t()!=="RecurringMaster"){t.bL(_g.i.c(t));this.U(t)}},bm:function(n){},bi:function(n){n.bY(this.q);n.M(this.r);n.K(this.p)},bq:function(n){var t=n;t.a.t()==="RecurringMaster"?t.d.dB(t.a.bl):this.bb(t.a,0)},br:function(n){this.e.C(n.d.e())},bp:function(n){n.bY(this.t);n.M(this.v);n.K(this.s)},bc:function(){var n=_js.e.s(_a.a.k,2,"OnCachedItemsChanged");++this.k;_js.e.e(n)},bh:function(n,t){this.bR("CalendarNotification",this,t)},bt:function(n,t){var i=this.M(this.c.b(n),t);this.bR("CalendarNotification",this,new _cc.cb(n,new _js.A(0,0,i,null)))},bn:function(n,t){++this.k;var i;switch(t.c){case 0:for(var u=0;u<t.a.length;++u){i=t.a[u];this.d.f(i.a())}break;case 2:for(var r=0;r<t.b.length;++r){i=t.b[r];this.d.g(i.a());this.e.D(i)}break}},bf:function(n,t){this.e.I(n.Id,t);this.d.l(n,t)}};function CalendarsCache(n,t,i,r,u){this.N=Function.createDelegate(this,this.by);this.P=Function.createDelegate(this,this.bz);this.Q=Function.createDelegate(this,this.bA);this.bI={};this.bB=new(_a.eJ.$$(_cc.cg));this.v={};this.B=new(_a.eJ.$$(Function));this.j=this.dM;this.k=this.dN;CalendarsCache.resolveInheritance();this.g=this.bK;this.n=this.i;this.h=this.o;CalendarsCache.initializeBase(this);this.T=OwaApplication.e();this.D=n;this.r=t;this.x=u;this.F=i.a().c().Enabled;this.I=i.a().ba().Enabled;this.U=i.a().M().Enabled&&!!r.c().bl.DefaultPublicFolderMailbox}CalendarsCache.$$cctor=function(){var n=new _g.eT;n.WorkDays=n.WorkHoursEndTimeInMinutes=n.WorkHoursStartTimeInMinutes=0;CalendarsCache.a=new _g.cx(n)};CalendarsCache.prototype={T:null,x:null,r:null,U:!1,D:null,M:null,C:null,q:null,E:!1,L:0,y:!1,A:null,bi:function(n){this.dV("EffectiveRightsFetchedForCalendar",n)},bD:function(n){this.dW("EffectiveRightsFetchedForCalendar",n)},bh:function(n){this.dV("CalendarEntryFolderIdChanged",n)},s:function(n){if(n!==this.y){this.y=n;this.dQ("IsWaitingForCalendarAction")}return n},c:function(){return this.q},a:function(){return this.A},be:function(n){if(this.A!==n){this.A=n;this.dQ("BirthdayCalendar")}return n},z:function(){this.M||(this.M=_cc.m.a("Searched Calendars","12B353D3-3078-4E85-875B-F905CCB65E9B"));return this.M},F:!1,I:!1,R:null,bt:function(){return this.bb().c().bl.UserEmailAddress},bb:function(){return _g.a.a()},bs:function(){return this.T},d:function(n){var t=this.K(n);return t?t.b():null},H:function(n){var t=this.v[n.toLowerCase()];return t?t.a():null},b:function(n){var t=this.K(n);return t?t.a():null},Z:function(n){var t=this.K(n);return!!t&&t.c()},G:function(n){return n.f()&&(this.Z(n.a())||_g.v.isInstanceOfType(n)&&n.bl.IsGeneralScheduleCalendar)},f:function(n){var t=this.K(n);return t?_g.D.isInstanceOfType(t.a())&&!t.a().bl.IsReadOnly?this.bb().f():t.i():null},V:function(n,t,i,r){if(!n.f()){_js.Trace.logInfo(_a.a.Q,"Trying to load configuration for invalid linked calendar");i&&i(n);r&&r(n);return}var u=this.v[n.a().Id];if(!u){_js.Trace.logError(_a.a.Q,"Entry {0} is not in the cache",n.a().Id);return}if(u.d()){u.c()&&t&&t(n);!u.c()&&i&&i(n);r&&r(n)}else this.br(n,t,i,r)},bv:function(n,t){var i=this.v[n.Id];if(i.d())t(i.b());else{var r=null;var u=this;r=function(n,u){i.rpcl(_cc.p.a.a,r);t(i.b())};i.apcl(_cc.p.a.a,r)}},e:function(n){_js.Trace.logInfo(_a.a.Q,"CalendarsCache reload requested.");n&&this.B.b(n);this.bs().a(_h.ca,new _h.ca);this.ba()},w:function(n){if(this.p){n&&n();return!0}n&&this.B.b(n);this.ba();return!1},bk:function(){var n=new _g.D;n.v(-1);return n},bm:function(){var n=new _cc.m;n.g(new(_ff.A.$$(_g.ca)));n.k(3);return n},Y:function(n,t){_a.b.f(n.c(),!0,"AddClientOnlyCalendar is only supporting client-only calendar entries");var i=this.S(n);this.J(t,n,i)},bu:function(n,t,i){_a.b.f(n.c(),!0,"InsertClientOnlyCalendar is only supporting client-only calendar entries");var r=this.S(n);this.J(t,n,r,i)},W:function(n,t){_a.b.f(n.c(),!0,"RemoveClientOnlyCalendar is only supporting client-only calendar entries");return this.bd(t,n)},bC:function(n,t,i,r){_a.b.f(n.c(),!0,"unpinnedCalendar.IsClientOnlyCalendar");_a.b.f(this.z().a().y(n),!0,"SearchedCalendars.Contains()");this.z().a().m(n,!0);n.p(this.C.b());this.C.a().a(n);var u=this;this.bf(this.C.b(),n,this.d(n.a()),t,function(t,r){_js.Trace.logWarning(_a.a.Q,"Error while trying to pin calendar with name: {0}. Error:{1} Correlation ID:{2}",n.bl.CalendarName,t,r);i&&i(t,r);u.e(null)},r)},m:function(n,t){if(!this.D){_js.Trace.logError(_a.a.Q,"Expecting birthday factory to not be null");return}this.s(!0);var i=this;this.D.a(function(r){var u=r.e();u.v(function(){_js.Trace.logInfo(_a.a.Q,"EnableBirthdayCalendar failed");t&&t()});n&&u.w(function(){n()});u.z(function(){i.s(!1)});i.x.a(u)})},l:function(n,t){if(!this.D){_js.Trace.logError(_a.a.Q,"Expecting birthday factory to not be null");return}this.s(!0);var i=this;this.D.a(function(r){var u=r.d();u.v(function(){_js.Trace.logInfo(_a.a.Q,"DisableBirthdayCalendar failed");t&&t()});n&&u.w(function(){n()});u.z(function(){i.s(!1);i.e(function(){u.A.WasSuccessful&&i.be(null)})});i.x.a(u)})},bj:function(n,t,i,r,u){t.p(n.b());var f=this.S(t);var e=this;this.bf(t.bl.ParentGroupId,t,f,function(){e.J(n,t,f);t.F(!0);i&&i()},r,u)},bE:function(n,t,i,r){var u=new _cc.bK(n,t,this);i&&u.w(i);r&&u.v(r);var f=this;u.z(function(n){f.s(!1)});this.s(!0);this.x.a(u)},bn:function(n,t,i,r){var u;if(n.j()){var f;u=(f=new _h.bF,f.a=this.d(n.a()),f)}else u=new _cc.bF(n,t,this);i&&u.w(i);r&&u.v(r);var e=this;u.z(function(){e.s(!1)});this.s(!0);this.x.a(u)},bl:function(n,t,i,r){var u=new _cc.bE(n);var e=this;u.w(function(n){e.t.a(n.c);t&&t()});if(i){var o=this;u.v(function(n){i(n.a)})}if(r){var f=this;u.z(function(n){f.s(!1);r()})}this.s(!0);this.x.a(u)},J:function(n,t,i,r){_a.b.a(n,"parentGroup");_a.b.a(t,"calendarEntry");_a.b.a(i,"calendarModel");t.p(n.b());var u=this.bc(t.a().Id);u.g(i,t);r===undefined?n.a().a(t):n.a().r(r,t)},bd:function(n,t){_a.b.a(n,"parentGroup");_a.b.a(t,"calendar");if(t.f()){delete this.v[t.a().Id];if(_g.v.isInstanceOfType(t)){var i=t;i.bl.IsGeneralScheduleCalendar&&delete this.v[i.bl.OwnerEmailAddress]}}return n.a().m(t,!0)},bF:function(n,t,i,r){var u=new _cc.bL(n,t);i&&u.w(i);r&&u.v(r);var f=this;u.z(function(n){f.s(!1)});this.s(!0);this.x.a(u)},bo:function(n,t,i){var r=new _cc.bG(n);t&&r.w(t);i&&r.v(i);var u=this;r.z(function(n){u.s(!1)});this.s(!0);this.x.a(r)},dM:function(){var n=_a.ea.prototype.dM.call(this);this.bG(n);return n},dN:function(n){_a.ea.prototype.dN.call(this,n);this.bp(n)},bq:function(){if(!this.p)return"CalendarsCache not ready.";var n="CCacheInfo: \r\n";n+="W:"+this.y+",GetCalSent:"+this.E+",PGetCal:"+(this.B?this.B.a.length.toString():"<null>")+"\r\n";n+="Dict:\r\n";if(this.v){var f=this.v;for(var o in f){var e={key:o,value:f[o]};n+="'"+e.key+"'";var r=e.value;n+=" => V:"+r.c()+" CnfRtr:"+r.d();if(r){var t=r.a();var i=r.b();i&&(n+=" M:(Id:'"+_cc.o.c(i.bl.FolderId)+"', N: '"+i.bl.DisplayName+"')");if(t){var h=!!i&&!!i.bl.FolderId&&!!t.a()&&i.bl.FolderId.Id===t.a().Id;n+=" E:(Id:'"+_cc.o.e(t.bl.ItemId)+"',";n+=" FId:'"+(h?"<same>":_cc.o.c(t.a()))+"',";n+=" D:"+t.e()+" N:'"+t.bl.CalendarName+"', G:"+t.bl.IsGroupMailboxCalendar;n+=" P:'"+t.bl.ParentGroupId+"'";if(_g.v.isInstanceOfType(t)){var u=t;n+=" Link, O:'"+u.bl.OwnerEmailAddress+"', OV:"+!u.bl.IsOwnerEmailAddressInvalid+", GS:"+u.bl.IsGeneralScheduleCalendar}else{var s=t;n+=" Local, T:"+s.g()}n+=" Clr:"+t.o()+", AClr:"+t.b+", CS:"+t.c()+")"}}else n+=" <null> entry.";n+="\r\n"}}else n+="<null>. \r\n";n+=this.r.f();return n},S:function(n){var t=new _g.cO;t.e(n.bl.CalendarName);t.I(new _g.fD);t.bl.EffectiveRights.CreateAssociated=t.bl.EffectiveRights.CreateContents=t.bl.EffectiveRights.CreateHierarchy=t.bl.EffectiveRights.Read=t.bl.EffectiveRights.Modify=t.bl.EffectiveRights.ViewPrivateItems=_g.D.isInstanceOfType(n);_g.v.isInstanceOfType(n)&&t.g(new _g.n(n.bl.OwnerEmailAddress));return t},bf:function(n,t,i,r,u,f){var e=new _cc.bD(n,t,i);if(r){var s=this;e.w(function(){r()})}if(u){var h=this;e.v(function(n){u(n.a,e.B())})}var o=this;e.z(function(){o.s(!1);f&&f()});this.s(!0);this.x.a(e)},K:function(n){return n?this.v[n.Id]:null},bc:function(n){var t=this.v[n];if(!t){t=new _cc.p;this.v[n]=t}return t},ba:function(){if(!this.E){this.E=!0;this.bg()}},bg:function(){var n=new _cc.cD(this.bt(),this.F,this.U);n.w(this.Q);n.v(this.P);n.z(this.N);this.x.a(n)},bH:function(n){var f=0;var u=0;var o=0;var s=0;var e=n.g;for(var h in e){var r={key:h,value:e[h]};var c=r.value;var t=n.f[r.key];if(t.D()){this.be(t);o++}else t.t()?u++:t.j()&&s++;var i=this.bc(r.key);i.a()&&i.a().bl.ItemId.ChangeKey===t.bl.ItemId.ChangeKey||i.g(c,t);f++}this.R=new CalendarsCache.b(f,u,o,s)},bA:function(n){var t=n;this.bH(t);var r=this;_cc.bC.c(this.t,t.d,function(n){return n.j()});this.q?this.q.bl.ItemId.ChangeKey!==t.c.bl.ItemId.ChangeKey&&this.q.G(t.c):this.q=t.c;this.C||(this.C=t.i);this.E=!1;this.X(!0);for(var i=0;i<this.B.a.length;i++)this.B.c(i)();this.B=new(_a.eJ.$$(Function))},br:function(n,t,i,r){_js.Trace.logInfo(_a.a.Q,"Loading linked calendar effective rights from server for {0} ",n);var f=new _cc.cB(n);var u=this;f.z(function(f){var e;e=f.t?u.bw(f):u.bx(f);if(!e){_js.Trace.logInfo(_a.a.Q,"Entry not found - request abandoned. Error:'{0}' Id:'{0}'",f.t,n.bl.ItemId);return}var o=e.a();!e.c()&&i?i(o):e.c()&&t&&t(o);r&&r(o)});this.x.a(f)},bw:function(n){var i=n;var r=i.c.a().Id;var t=this.v[r];if(t){_js.Trace.logInfo(_a.a.Q,"Unable to find effective rights from server for linked calendar {0}",t.a());t.n(i.d)}else _js.Trace.logWarning(_a.a.Q,"CalendarEntry {0} is not in the cache",r);return t},bx:function(n){var f=n;var u=f.e;var o=f.f;var r=f.c.a().Id;var i=u.bl.FolderId.Id;var e=u.bl.FolderId.ChangeKey;var t=this.v[r];if(!t){_js.Trace.logInfo(_a.a.Q,"Could not find a CalendarsCacheEntry with Id:{0}",r);return null}_js.Trace.logInfo(_a.a.Q,"Loaded effective rights for the linked calendar {0}",t.a());if(r!==i){t.b().bl.FolderId.Id=i;t.b().bl.FolderId.ChangeKey=e;t.a().a().Id=i;t.a().a().ChangeKey=e;this.v[i]=t;this.ea("CalendarEntryFolderIdChanged",t.a().a(),r)}t.m(u,o);r!==i&&this.ea("EffectiveRightsFetchedForCalendar",this,t.a());return t},bz:function(n){if(this.L<3){var t=this;_js.g.a().a(_a.a.Q,"GetCalendarsActionRetry",function(){t.bg()},2e3);this.L++}else{this.L=0;this.E=!1}},by:function(n){n.N(this.Q);n.M(this.P);n.K(this.N)},bG:function(n){var r={};var u=this.v;for(var t in u){var i={key:t,value:u[t]};r[i.key]=i.value.dM()}n.CalendarsCacheDictionary=r},bp:function(n){var f=n.CalendarsCacheDictionary;this.v={};var u=f;for(var r in u){var t={key:r,value:u[r]};var i=new _cc.p;i.dN(t.value);this.v[t.key]=i}}};CalendarsCache.b=function(n,t,i,r){this.b=n;this.c=t;this.a=i;this.d=r};CalendarsCache.b.prototype={b:0,c:0,a:0,d:0};_cc.p=function(){_cc.p.initializeBase(this)};_cc.p.prototype={b:function(){return this.dS(_cc.p.c)},k:function(n){this.dR(_cc.p.c,n);return n},a:function(){return this.dS(_cc.p.b)},j:function(n){this.dR(_cc.p.b,n);return n},c:function(){return this.dS(_cc.p.d)},f:function(n){this.dR(_cc.p.d,n);return n},d:function(){return this.dS(_cc.p.a)},e:function(n){this.dR(_cc.p.a,n);return n},i:function(){return this.dS(_cc.p.e)},l:function(n){this.dR(_cc.p.e,n);return n},m:function(n,t){this.l(t);this.h(n.bl.EffectiveRights,n.Q());this.e(!0)},n:function(n){this.f(n);this.e(!0)},g:function(n,t){var i=this.b()?this.b().bl.FolderId:null;var u=this.b()?this.b().bl.EffectiveRights:null;var r=this.b()?this.b().Q():null;this.j(t);this.k(n);this.f(!!(this.c()&this.a().f()));if(this.d()&&i){this.a().a().Id=i.Id;this.a().a().ChangeKey=i.ChangeKey;this.b().bl.FolderId.Id=i.Id;this.b().bl.FolderId.ChangeKey=i.ChangeKey;this.h(u,r)}},h:function(n,t){this.b().I(n);if(t&&t.b()>0)if(_g.v.isInstanceOfType(this.a())){this.b().bf(t);this.a().n(t.a(0).toLowerCase())}else _js.Trace.logError(_a.a.Q,"Expecting no replica list for non-linked calendar. {0}",this.a())}};_cc.cy=function(){this.a={};this.b=new Sys.EventHandlerList};_cc.cy.prototype={a:null,b:null,f:function(n){var t=n.Id;if(!(t in this.a)){this.a[t]=0;this.e(t)}},g:function(n){var t=n.Id;t in this.a&&delete this.a[t]},l:function(n,t){if(t in this.a){var r=n.Id;this.a[r]=this.a[t];delete this.a[t];var i=this.b.getHandler(t);if(i){this.b.addHandler(r,i);this.b.removeHandler(t,i)}}},c:function(n){var t=n.Id;!(t in this.a);return this.a[t]},j:function(n){var t=n.Id;if(t in this.a&&!this.a[t]){this.a[t]=1;this.e(t)}},i:function(n){var t=n.Id;if(t in this.a&&!this.a[t]){this.a[t]=2;this.e(t)}},m:function(){var i=this.a;for(var t in i){var n={key:t,value:i[t]};this.a[n.key]=0;this.e(n.key)}},h:function(n,t){this.b.addHandler(n.Id,t)},k:function(n,t){this.b.removeHandler(n.Id,t)},d:function(){var t=0;var i=0;var n=0;var f=this.a;for(var u in f){var r={key:u,value:f[u]};r.value===1?t++:r.value||i++;n++}return i===n&&n>0?0:t===n?3:t>0&&i>0?1:t>0?2:-1},toString:function(){var i=new Sys.StringBuilder("Calendars in CalendarStateTracker: ");var r=this.a;for(var n in r){var t={key:n,value:r[n]};var u=_js.d.c("Id = '{0}', State = {1}; ",t.key,t.value);i.append(u)}return i.toString()},e:function(n){var t=this.b.getHandler(n);t&&t(this.a[n])}};_cc.cz=function(n,t){this.e=t;this.b={};this.c=n};_cc.cz.prototype={e:null,b:null,c:null,a:null,f:function(n,t,i,r,u,f,e,o,s){var c=this.j(t);var a=c?_cc.bq.b(t,!1,i,r,s,o):_cc.L.a(t,!1,i,r,s,o);var h=new _cc.cu(a,u,f,e);if(this.g(h.a)){try{h.c(this.c.a(t));h.b(!0)}finally{h.dispose()}return null}var l=this.q(h);l||this.t(n,h,c);return h},h:function(n,t){if(this.m(n)&&!this.g(t)){this.r();this.v(n);this.a=t}},u:function(n){var t=this.i(n);n.dB(t.bl)},v:function(n){var t=this.c.a(n.bl.ItemId);t&&(_g.bw.isInstanceOfType(n)?t.gb(n.bl):t.dB(n.bl))},g:function(n){var t=this.c.a(n.b());return this.l(n)&&!!t||!!this.a&&this.k(n)&&this.a.a()===n.a()&&!!t&&t.bS()},j:function(n){var t=this.c.a(n);return _g.bw.isInstanceOfType(t)},k:function(n){return!_g.fM.isInstanceOfType(n.b())&&n.d()==="HTML"},m:function(n){return n.t()!=="RecurringMaster"&&!!n.z()&&n.z().a()==="HTML"},l:function(n){return _g.i.f(n.b())},t:function(n,t,i){var r;r=i?new _cc.bq(n,t.a):new _cc.L(n,t.a);r.I=t.a.f;var e=_js.e.s(_a.a.k,517,"GetFullItem");var o=this;r.w(function(n){var t=n;o.o(t.a(),t.c())});var u=this;r.v(function(n){var t=n;u.n(t.a(),n.t)});var f=this;r.z(function(n){var t=n;f.p(t.a());_js.e.e(e)});this.e.a(r)},d:function(n){var t=this.b[n];t||_js.Trace.logError(_a.a.Q,"AsyncResult should not be null for contextId {0}",n);return t},i:function(n){var t=n.dt();t.bc(null);t.bb(null);t.be(null);t.cl(null);t.iA(null);t.bW(0);return t},r:function(){if(this.a){var n=this.c.a(this.a.b());if(!n||n.cu()||!n.bS()){this.a=null;return}this.a.e()||this.u(n);this.a=null}},o:function(n,t){this.h(t,n);for(var r=this.d(n.a()),i=0;i<r.d.length;i++)try{r.d[i].c&&r.d[i].c(t)}catch(u){_js.Trace.logWarning(_a.a.Q,"Failed to execute one of the asyncResult.SuceedCallback for contextId {0}. Exception: {1}",n.a(),u)}},n:function(n,t){for(var r=this.d(n.a()),i=0;i<r.d.length;i++)try{r.d[i].d&&r.d[i].d(t)}catch(u){_js.Trace.logWarning(_a.a.Q,"Failed to execute one of the asyncResult.FailedCallBack for contextId {0}. Exception: {1}",n.a(),u)}},p:function(n){for(var i=this.d(n.a()),t=0;t<i.d.length;t++)try{i.d[t].b&&i.d[t].b(!1)}catch(r){_js.Trace.logWarning(_a.a.Q,"Failed to execute one of the asyncResult.CompletedCallBack for contextId {0}. Exception: {1}",n.a(),r)}this.s(n.a())},s:function(n){for(var i=this.d(n),t=0;t<i.d.length;t++){var r=i.d[t];r.dispose()}delete this.b[n]},q:function(n){var t;if(this.b[n.a.f])t=this.b[n.a.f];else{t=new _ff.e;this.b[n.a.f]=t}t.c(n);return t.d.length>1}};_cc.bH=function(n){this.a=n};_cc.bH.prototype={a:null,b:function(n){return new _cc.cz(n,this.a)}};_cc.Z=function(n,t){this.l=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.r);this.i={};this.j=new(_a.eJ.$$(_cc.cg));_cc.Z.initializeBase(this);this.n=t;this.o=n};_cc.Z.$$cctor=function(){var n=new _g.eT;n.WorkDays=n.WorkHoursEndTimeInMinutes=n.WorkHoursStartTimeInMinutes=0;_cc.Z.a=new _g.cx(n)};_cc.Z.prototype={o:null,n:null,b:function(n){this.dV("WorkingHoursUpdated",n)},d:function(n){this.dW("WorkingHoursUpdated",n)},m:!1,g:function(n){this.m=n;return n},c:function(n){var t=n;t.z(this.k);t.w(this.l);this.j.b(n)},e:function(n,t){var i=this.p(n);if(i){i.b(t.bl.WorkHoursStartTimeInMinutes);i.a(t.bl.WorkHoursEndTimeInMinutes);i.c(t.bl.WorkDays)}this.ea("WorkingHoursUpdated",n.bl.OwnerEmailAddress,null)},a:function(n){if(!n)return _cc.Z.a;if(_g.v.isInstanceOfType(n)&&!n.bl.IsGroupMailboxCalendar&&n.g()!==5){var i=n;var u=this.p(i);if(u)return u;if(!this.m){for(var r=!0,t=0;t<this.j.a.length;t++){var f=this.j.c(t);if(f.h().f(i.bl.OwnerEmailAddress)){r=!1;break}}r&&this.q(i)}return _cc.Z.a}else return this.o.a().x()},h:function(n,t){for(var i=0;i<n.a.length;i++)t.c(i)&&this.t(n.c(i),t.c(i))},f:function(){var n="WorkingHours: \r\n";if(this.i){var u=this.i;for(var i in u){var r={key:i,value:u[i]};n+="'"+r.key+"' => ";var t=r.value;n+=t?"Start: "+t.bl.WorkHoursStartTimeInMinutes+" End: "+t.bl.WorkHoursEndTimeInMinutes+" Days:"+t.bl.WorkDays:"<null>";n+="\r\n"}}else n+="<null>\r\n";return n},q:function(n){var t=new _cc.cf(n,"GetUserAvailabilityInternal_FetchWorkingHours");t.J=n.bl.OwnerEmailAddress;var i=_a.c.a().f();t.Q=new _h.j(i,i.r(30));t.S=new _js.f;this.c(t);this.n.a(t)},s:function(n){var t=n;this.h(t.h(),t.o())},r:function(n){this.j.e(n);n.K(this.k);n.N(this.l)},t:function(n,t){_js.i.b(n,"userSmtpAddress");_js.i.b(t,"workingHoursModel");if(!(n in this.i)||this.i[n]!==t){this.i[n]=t;this.ea("WorkingHoursUpdated",n,null)}},p:function(n){return this.i[n.bl.OwnerEmailAddress]}};_cc.z=function(n){_cc.z.initializeBase(this,[n,null])};_cc.z.prototype={o:null,K:null,L:null,bD:function(){_js.Trace.logInfo(this.bm(),"Starting refresh timer for shared calendar "+this.d().Id);var n=this;this.L=_js.g.a().e(this.bm(),"SharedCalendarItemQueryTable",function(){_js.Trace.logInfo(n.bm(),"Will issue a periodic refresh for shared calendar "+n.d().Id);n.X()},3e5)},bE:function(){_js.Trace.logInfo(this.bm(),"Cancelling refresh timer for shared calendar "+this.d().Id);this.L=_js.g.a().b(this.L)},G:function(){_js.Trace.logInfo(this.bm(),"Reloading shared calendar after an action. Folder ID "+this.d().Id);this.ba();this.bE();this.bD()},E:function(){var r=this.K.d(this.o.a());if(!r.bl.EffectiveRights.Read){var n=new _cc.cf(this.o);n.g(this.o.bl.OwnerEmailAddress);this.K.r.c(n);return n}if(this.o.h()){var t=new _cc.cA;t.J=this.o.bl.OwnerEmailAddress;return t}var i=new _cc.Q;i.J=this.o.bl.OwnerEmailAddress;return i}};_cc.ct=function(n){this.f=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m);this.a={};this.c={};this.d=[];this.h=n.d();this.e=n.m();this.b=new Array(9);for(var t=0;t<9;t++)this.b[t]=0};_cc.ct.prototype={h:null,e:null,b:null,c:null,a:null,d:null,j:function(n){this.n(n);this.o()},n:function(n){var t=n.x();var i=!1;if(t in this.a){this.b[this.e[this.a[t]]]--;delete this.a[t]}if(n.o()===-1)if(t in this.c)n.k(this.c[t]);else{Array.add(this.d,n);i=!0}else{delete this.c[n.x()];n.k(n.o())}if(!i){this.b[this.e[n.b]]++;this.a[t]=n.b}n.apcl("CalendarColor",this.g);n.c()&&!n.bl.IsGroupMailboxCalendar&&n.H(this.f)},i:function(n,t){var i=n.x();if(i in this.a){var r=this.e[this.a[i]];delete this.a[i];delete this.c[i];this.b[r]--}n.rpcl("CalendarColor",this.g);n.c()&&!n.bl.IsGroupMailboxCalendar&&n.E(this.f);t||n.k(n.o())},o:function(){for(var t=0;t<this.d.length;t++){var n=this.d[t];var i=n.x();n.k(this.k());this.b[this.e[n.b]]++;this.c[i]=this.a[i]=n.b}Array.clear(this.d)},m:function(n,t){var i=n;this.i(i,!0);this.j(i)},l:function(n,t){var i=n.x();if(!i){_js.Trace.logError(_a.a.b,"CalendarColorResolver: Received CacheKey change for linked calendar with ItemId=null: {0}",n.bl.CalendarName?n.bl.CalendarName:"");return}if(t in this.a&&i!==t){this.a[i]=this.a[t];delete this.a[t]}else _js.Trace.logError(_a.a.b,"Received CacheKey change event, but could not act on it. CalendarName {0}, InAssignedColorsTable:{1}, OldId:{2}, NewId:{3}",n.bl.CalendarName?n.bl.CalendarName:"",t in this.a,t,i);n.c()||n.bl.IsGroupMailboxCalendar||n.E(this.f)},k:function(){for(var t=this.b[0],i=0,n=1;n<9;n++)if(this.b[n]<t){t=this.b[n];i=this.h.a(n)}return i}};_cc.ca=function(n,t,i,r,u,f,e){this.f=n;this.b=t;this.a=i;this.d=r;this.c=u;this.e=f;this.g=e};_cc.ca.prototype={f:null,b:null,a:null,d:!1,c:null,e:null,g:!1};_cc.m=function(n){_cc.m.initializeBase(this);n&&this.dN(n)};_cc.m.$$cctor=function(){_cc.m.b.b(new(_a.fV.$$(_ff.A.$$(_g.ca)))(_g.ca));_a.i.d(_cc.m,_g.tY,function(n){return new _cc.m(n)})};_cc.m.a=function(n,t){var i=new _cc.m;i.g(new(_ff.A.$$(_g.ca)));i.e(n);i.h(t);i.i(new _g.g(t));i.c().ChangeKey="";return i};_cc.m.prototype={c:function(){return this.dS(_cc.m.f)},i:function(n){this.dR(_cc.m.f,n);return n},b:function(){return this.dS(_cc.m.c)},h:function(n){this.dR(_cc.m.c,n);return n},f:function(){return this.dS(_cc.m.d)},e:function(n){this.dR(_cc.m.d,n);return n},a:function(){return this.dS(_cc.m.b)},g:function(n){this.dR(_cc.m.b,n);return n},d:function(){return this.dS(_cc.m.e)},k:function(n){this.dR(_cc.m.e,n);return n},j:function(){return!this.c()||!this.c().ChangeKey}};_cc.cb=function(n,t){this.b=n;this.a=t};_cc.cb.prototype={b:null,a:null};_cc.d=function(n){_cc.d.initializeBase(this);n&&this.dN(n)};_cc.d.$$cctor=function(){_cc.d.a.b(new _a.bs(_cc.y));_a.i.d(_cc.d,Object,function(n){return new _cc.d(n)})};_cc.d.prototype={a:function(){return this.dS(_cc.d.c)},s:function(n){this.dR(_cc.d.c,n);return n},g:function(){return this.dS(_cc.d.l)},o:function(){return this.dS(_cc.d.d)},t:function(n){this.dR(_cc.d.d,n);return n},h:function(){return!!this.o()&&!this.r()},b:function(){return this.dS(_cc.d.b)},e:function(n){this.dR(_cc.d.b,n);return n},n:function(){return this.dS(_cc.d.h)},d:function(){return this.dS(_cc.d.f)},w:function(n){this.dR(_cc.d.f,n);return n},m:function(){return this.dS(_cc.d.e)},v:function(n){this.dR(_cc.d.e,n);return n},l:function(){return this.dS(_cc.d.k)},i:function(){return this.dS(_cc.d.g)},j:function(){return this.dS(_cc.d.j)},f:function(){return this.dS(_cc.d.i)},p:function(){return this.dS(_cc.d.m)},q:function(){return this.dS(_cc.d.n)},r:function(){return this.dS(_cc.d.o)},c:function(){return this.dS(_cc.d.a)},k:function(n){this.dR(_cc.d.a,n);return n}};_cc.cx=function(n,t,i,r){this.d=i;this.b=n;this.e=t;var u="CalPrefetch";this.c=!r.b(u)||parseInt(r.a[u],10)>0};_cc.cx.prototype={d:null,b:null,e:null,c:!1,a:function(){if(!this.c){_js.Trace.logInfo(_a.a.b,"Skipping prefetching since prefetching has been disabled via url parameters");return}var r=this.d.a();var n;var t;if(r==="TouchNarrow"){n=0;t=8}else{n=3;t=7}var i=_a.v.a(_a.c.a().f(),n);var u=new _h.j(i[0],i[1]);this.e.a(u,t);r!=="TouchNarrow"&&this.b.w()}};_cc.cS=function(){_cc.cS.initializeBase(this);this.t=new _js.f};_cc.cS.prototype={t:null,p:!1,bJ:function(n){this.dV("NotifyReadyEvent",n)},bK:function(){return this.t},i:function(){return this.p},X:function(n){if(this.p!==n){this.p=n;this.ea("NotifyReadyEvent",null,null)}return n},o:function(n){this.p?n(this):this.bJ(n)}};_cc.cC=function(n){this.d=n};_cc.cC.prototype={d:null,c:function(){return this.d},b:function(n){var t=n;return t.unfoldedIndex>0?t.ItemId.Id+"_"+t.unfoldedIndex:t.ItemId.Id}};_cc.br=function(n){this.a=n};_cc.br.prototype={a:null};_cc.V=function(n,t,i,r,u,f,e){this.y=Function.createDelegate(this,this.J);this.x=Function.createDelegate(this,this.I);_cc.V.initializeBase(this);this.q=n;this.j=t;this.l=i;this.v=f;this.i=new _js.f;this.w=u;this.p=new _cc.ct(e);this.o=r;this.j.o(this.x);if(this.o){var o=this;this.o.a(function(n){o.k=n;o.k.o(o.y)})}};_cc.V.prototype={j:null,p:null,l:null,o:null,q:0,v:null,w:null,i:null,n:null,k:null,m:!0,r:null,a:function(){return this.i},h:function(){return this.q},d:function(){return this.m},F:function(n){if(this.m!==n){this.m=n;this.dQ("CanSelectMoreCalendars")}return n},g:function(n){return this.i.y(n)},b:function(n,t,i){if(this.m&&this.E(n,t)){i||this.l.o(n);this.t();return!0}return!1},s:function(n,t){if(_js.d.a(n)){_js.Trace.logError(_cc.V.a,"smtpAddress is NULL or empty at SelectModernGroupCalendarByOwner");return null}var i=this.j.H(n);if(i)this.b(i,null,t);else{var r=_g.v.a(n,n,!0);t||this.l.d(r)}return i},e:function(n){if(this.i.m(n,!0)){this.p.i(n);this.t();this.l.q(n)}},f:function(){var n=new _js.f;var t=this;this.i.v(function(i){var r=i;t.C(r)&&n.a(r)});return n},c:function(){for(var t=this.i.x.length,n=0;n<t;n++)if(this.C(this.i.x[n]))return!0;return!1},H:function(){for(var i="SelectedCalendars:\r\n",t=0;t<this.i.x.length;t++){var n=this.i.x[t];i+="Id:'"+(n.bl.ItemId?n.bl.ItemId.Id:"<null>")+"', N:'"+n.bl.CalendarName+"', P:'"+n.bl.ParentGroupId+"'\r\n"}return i},C:function(n){var t=this.j.d(n.a());return n.f()&&t.h(n)?!0:!1},D:function(n){var t=this;this.l.n(n,function(n){if(t.i.x.length>=t.q){_js.Trace.logWarning(_a.a.cu,"RestoreCalendarsSelectionFromViewState: We attempted to re-select more than the maximum number of calendars. Was the ViewState corrupted?");t.F(!1);return!1}t.E(n,function(n){_js.Trace.logWarning(_a.a.cu,"Linked configuration failed for calendar while restoring selection. ItemId: {0}",n.bl.ItemId);t.e(n)});return!0})},I:function(n){if(this.j.p){this.i.f();this.z();var t=this.B(this.j.t.g());this.D(t);this.A()}},J:function(n){if(this.j.p){this.z();if(this.n){var t=this.B(this.n);this.D(t);this.A()}}},A:function(){if(this.j.p&&(!this.o||this.k&&this.k.i())){for(var t=new(_a.gd.$$(String)),n=0,r=this.i.x.length;n<r;n++){var i=this.i.x[n];t.e(i.bl.ItemId.Id)}this.l.k(t);this.t()}},B:function(n){for(var u=new _ff.e,t=0,e=n.length;t<e;t++)for(var r=n[t],i=0,o=r.a().x.length;i<o;i++){var f=r.a().x[i];this.j.Z(f.a())&&u.c(f)}return u},z:function(){if(this.j.p&&this.k&&!this.n){this.n=[this.k.a(),this.k.c(),this.k.d()];this.j.t.p(this.n)}},E:function(n,t){var i=this.i.k(n);if(i>-1){this.v.a(_cc.br,new _cc.br(this.i.x[i]));return!1}this.p.j(n);if(_g.v.isInstanceOfType(n)){var r=n;this.j.V(r,null,t,null)}this.G(n);return!0},G:function(n){var t=n.bl.CalendarName||"";this.j.d(n.a())&&this.j.G(n)&&this.i.a(n)},t:function(){if(this.j.q){var i=this.i.x.length;if(!i){var t=this.j.q;if(this.r)_js.Trace.logError(_cc.V.a,"Making attempt to select default calendar twice");else{var n=this;this.r=this.w.a(_cc.V.a,"SelectedCalendarsModel.CalendarPostSelectionCheck",function(){n.r=null;n.p.j(t);n.i.a(t);n.l.d(t)},0)}}this.F(i<this.q)}}};_cc.bM=function(n,t,i,r){this.c=Function.createDelegate(this,this.m);this.e=n;this.g=t;this.b=i;this.f=r;this.a=this.j()};_cc.bM.prototype={b:null,e:0,g:!1,f:null,a:null,j:function(){switch(this.e){case"Mouse":return this.b.b().by();case"TouchWide":return this.b.b().bB();default:return this.b.b().bA()}},p:function(n){switch(this.e){case"Mouse":this.b.b().bG(n);break;case"TouchWide":this.b.b().bI(n);break;default:this.b.b().bH(n);break}return n},i:function(){this.h(new(_a.gd.$$(String))(this.a.f()))},k:function(n){var i=this.a?this.a.b():0;var t=n?n.b():0;if(i!==t){this.a=n;this.h(this.a)}},o:function(n){this.a&&!this.a.j(n.bl.ItemId.Id)&&(n.c()&&!n.bl.IsGroupMailboxCalendar?n.apcl("ItemId",this.c):this.d(n))},q:function(n){this.a&&(n.c()&&!n.bl.IsGroupMailboxCalendar?n.rpcl("ItemId",this.c):this.a.q(n.bl.ItemId.Id)&&this.i())},n:function(n,t){this.a=this.j();if(this.a&&this.a.b())for(var i=0,u=this.a.b();i<u;i++){var r=this.l(n,this.a.a(i));if(r>-1&&!t(n.d[r])){_js.Trace.logWarning(_a.a.cu,"RestoreCalendarsSelectionFromViewState loop is terminated");break}}},d:function(n){if(this.a){this.a.e(n.bl.ItemId.Id);this.i()}},h:function(n){this.p(n);this.g||_h.g.b(this.b.b().c(),this.f)},m:function(n,t){var i=n;if(!i.c()){this.d(i);i.rpcl("ItemId",this.c)}},l:function(n,t){for(var i=0,u=n.d.length;i<u;i++){var r=n.d[i];if(r.bl.ItemId.Id===t)return i}return-1}};_cc.bC=function(){};_cc.bC.c=function(n,t,i){var f=_cc.bC.a(n,i);var l=_cc.bC.a(t,null);var b=l;for(var d in b){var k={key:d,value:b[d]};var u=f[k.key];var r=k.value;if(u){if(u.d===r.d)continue;if(u.b){var ut=f[u.b];var s=ut.a;var e=u.a;e.G(r.a);var h=s.a().k(e);if(u.b!==r.b){var rt=f[r.b];var et=rt.a;s.a().z(h,e);et.a().D(r.c,e,e)}else h!==r.c&&s.a().w(h,r.c,e)}else{var c=u.a;c.dN(r.a.dM());var g=n.k(c);var nt=t.k(r.a);g!==nt&&n.w(g,nt,c)}}else if(r.b){var y=f[r.b];var w=r.a;y?y.a.a().r(r.c,w):_js.Trace.logError(_a.a.Q,"Group {0} not found for calendar entry Id={1}",r.b,w.bl.ItemId.Id)}else{var ft=r.a;ft.a().v(function(n){delete l[n.bl.ItemId.Id]});n.r(r.c,r.a)}}var a=f;for(var v in a){var p={key:v,value:a[v]};if(!(p.key in l)){var o=p.value;if(o.b){var tt=f[o.b];var it=tt.a;it.a().m(o.a,!0)}else n.m(o.a,!0)}}};_cc.bC.a=function(n,t){for(var f={},u=0,o=n.x.length;u<o;u++){var i=n.x[u];if(!t||!t(i)){var h=i.c()?i.c().ChangeKey:null;f[i.b()]=new _cc.bC.b(null,u,i,h);for(var r=0,s=i.a().x.length;r<s;r++){var e=i.a().x[r];f[e.bl.ItemId.Id]=new _cc.bC.b(i.b(),r,e,e.bl.ItemId.ChangeKey)}}}return f};_cc.bC.b=function(n,t,i,r){this.b=n;this.c=t;this.a=i;this.d=r};_cc.bC.b.prototype={b:null,c:0,a:null,d:null};_cc.bX=function(n,t){_cc.bX.initializeBase(this);this.c=new _g.yY(this.x);this.c.explicitLogonUser=t;this.a=n};_cc.bX.prototype={a:null,c:null,s:function(n){this.d();n.cU(this.a,this.c,this.r,this.q)},cz:function(n,t,i){if(n.WasSuccessful)t();else{_js.Trace.logWarning(_a.a.cY,"AddEventToMyCalendar returned error code: {0}",n.ErrorCode);i(Error.create(String.format("AddEventToMyCalendar returned error: {0}",n.ErrorCode)))}},d:function(){this.a.ItemId=_g.g.a(this.a.ItemId,!1)}};_cc.cR=function(n,t){_cc.cR.initializeBase(this,[t]);this.i=n;this.a=1;this.Q=!1};_cc.cR.prototype={i:null,c:null,bT:function(n){n.Importance=this.c.bB();!$a(this.c.k())&&this.c.k().b()>0&&(n.ToRecipients=_h.p.a(this.c.k()));!$a(this.c.m())&&this.c.m().b()>0&&(n.CcRecipients=_h.p.a(this.c.m()));!$a(this.c.o())&&this.c.o().b()>0&&(n.BccRecipients=_h.p.a(this.c.o()));n.Sensitivity=this.c.bH();n.IsDeliveryReceiptRequested=this.c.bl.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.c.bl.IsReadReceiptRequested}};_cc.bA=function(n,t,i,r){_cc.bA.initializeBase(this,[_h.T.a(n),4]);this.f="CreateMeetingResponseAction";this.e=n;this.l=t;this.a=i;this.Y=_g.H.isInstanceOfType(n);this.bA=n.t();this.Q=!0;this.bm=r;var f=new(_h.dV.$$(_cc.N))(_g.s.d("calendar"));var e=this;this.j=_h.d.b(f,_h.i.a(),function(n){return new _cc.N(n)});if(this.Y){var u=this.e;this.bi=u.bl.ConversationId?u.bl.ConversationId.Id:null}};_cc.bA.prototype={l:"Unknown",Y:!1,bA:"Single",bi:null,j:null,bl:null,bn:!1,bU:null,bW:null,e:null,meetingResponseMessageId:null,bm:null,bc:null,get_meetingResponseMessageId:function(){return this.meetingResponseMessageId},bH:function(){return!$a(this.bm)},g:function(){var n=_h.p.prototype.g.call(this);n.isReferencedItemMeetingRequest=this.Y;n.referencedCalendarItemType=this.bA;n.draftsFolderId=_g.b.a.nameToId("drafts");n.outboxFolderId=_g.b.a.nameToId("outbox");n.deletedItemsFolderId=_g.b.a.nameToId("deleteditems");n.calendarFolderId=_g.b.a.nameToId("calendar");n.userDisplayName=_g.a.a().c().bl.UserDisplayName;n.userEmailAddress=_g.a.a().c().bl.UserEmailAddress;return n},m:function(){var t;switch(this.l){case"Tentative":t=new _g.gs;break;case"Accept":t=new _g.fr;break;case"Decline":t=new _g.fB;break;default:return null}$a(this.i)||(t.ReferenceItemId=_g.g.a(this.i));if(this.bH()){t.ProposedStart=_a.c.l(this.bm.c());t.ProposedEnd=_a.c.l(this.bm.f())}var n=new _g.kH;if(this.e.B()){n.Organizer=new _g.bh;n.Organizer.Mailbox=this.e.B().Mailbox}$a(this.e.c())||(n.Start=_a.c.l(this.e.c()));$a(this.e.f())||(n.End=_a.c.l(this.e.f()));n.Subject=this.e.S();n.IsResponseRequested=this.e.A();var r=this.e.bl.ConversationId;r&&(n.ConversationId=this.e.bl.ConversationId);$a(this.e.C())||(n.Recurrence=_ff.g.a(this.e.C().bl));var i=_g.y.d(this.e.r());if(!i&&this.e.r()){i=new _g.hg;i.DisplayName=this.e.r().bl.DisplayName}n.Location=i;t.AdditionalInfo=n;if(!$a(this.c)){this.bT(t);$a(this.c.z())||(t.Body=new _g.G(this.c.z().a()==="HTML"?"HTML":"Text",this.c.z().bl.Value))}return[t]},k:function(){this.ce();var n=_h.p.prototype.k.call(this);n.Body.GenerateResponseMessageOnFailure=!1;n.Body.GenerateMeetingResponseWithOldLocationIfChanged=!0;n.Body.FailResponseOnImportantUpdate=!0;return n},E:function(){_a.dg.prototype.E.call(this);this.Y&&_h.d.l(this.i,this.bi);var r=this.cd();if(!r){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because AssociatedCalendarItem was not present.");return}if(!this.j||!this.j.f){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update because query table or range in cache was not present.");return}var n=!1;if(this.bA==="RecurringMaster"){var u=this.e.M();if(!u){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because InstanceKey was not present.");return}if(this.l==="Decline")n=this.j.i(u);else if(this.l==="Accept"||this.l==="Tentative")for(var f=_a.c.a(),t=0;t<this.j.bl.x.length;t++){var i=this.j.bl.x[t];if(i.bl.InstanceKey===u&&i.du()){this.bI(i,f);n=!0}}}else{this.bl=this.j.bf(_g.i,r);if(!this.bl){_js.Trace.logInfo(_a.a.b,"CalendarItemModel for meeting response not found - ItemId: {0}",r.Id);return}if(this.l==="Accept"||this.l==="Tentative"){this.bI(this.bl);n=!0}else this.l==="Decline"&&(n=this.j.bl.m(this.bl,!0))}this.bn=n},H:function(){_a.dg.prototype.H.call(this);this.bV(!0);if(this.Y){_h.d.f(this.i,this.bi);return}var n=this.bn;this.bn=!1;n&&this.j.ba()},cp:function(n){this.bV(!1);var i=n.Items;if($a(i)||!i.length)throw Error.invalidOperation("Response Item is expected to be non-null when message is saved to drafts.");for(var f=i,e=f.length,r=0;r<e;++r){var u=f[r];if(!$a(u)){var t=_a.i.b(_g.h,u);if(_g.bC.isInstanceOfType(t))this.meetingResponseMessageId=t.bl.ItemId;else if(_g.i.isInstanceOfType(t)){this.bU=t.bl.ItemId;this.j&&_cc.z.isInstanceOfType(this.j)&&this.j.G()}else _g.H.isInstanceOfType(t)&&(this.bW=t.bl.ItemId)}}this.a||(this.d=this.meetingResponseMessageId);this.bn=!1;if(this.Y){_h.d.f(this.i,this.bi);return}},bI:function(n,t){t=t||_a.c.a();n.bP(this.l==="Accept"?"Busy":"Tentative");n.gk(t);n.eA(this.l)},cd:function(){var n;if(this.Y){var t=this.e;n=t.bl.AssociatedCalendarItemId;if(!n||!n.Id)return null}else n=this.e.g();return n},ce:function(){this.bH()&&(this.bc=_a.d.b(_a.a.b,"ProposeNewTime"))},bV:function(n){if(this.bH()&&this.bc){this.bc.k=n?_h.y.b(this):null;this.bc.l=_h.y.a(this);_a.d.a(this.bc);this.bc=null}}};_cc.cp=function(n,t,i){_cc.cp.initializeBase(this,[[_h.T.a(n)],n.dv()?"SoftDelete":"MoveToDeletedItems",1]);this.m=n.H();this.P=i;this.l=t;this.n=n;this.r=!0;this.A=n.dv()?0:2};_cc.cp.prototype={m:!1,P:null,l:null,n:null,S:function(){var n=_h.bg.prototype.S.call(this);n.isReferencedItemRecurringMaster=this.m;n.explicitLogonUser=this.P;n.actionName="DeleteCalendarItemAction";return n},E:function(){_h.bg.prototype.E.call(this);var n=this.l;n&&(this.m?n.i(this.n.bl.InstanceKey):n.J(this.n.bl.ItemId))},H:function(){_h.bg.prototype.H.call(this);var n=this.l;n&&(_cc.z.isInstanceOfType(n)?n.G():n.X())}};_cc.cq=function(n){_cc.cq.initializeBase(this,[n.g(),5]);this.a=1;this.j=n.t();this.Q=!0;this.h=n.Q();var t=n;this.e=t.bl.ConversationId?t.bl.ConversationId.Id:null;this.f="RemoveItemFromCalendarAction"};_cc.cq.prototype={j:"Single",e:null,g:function(){var n=_h.p.prototype.g.call(this);n.referencedCalendarItemType=this.j;return n},m:function(){var n=new _g.gf;this.i&&(n.ReferenceItemId=_g.g.a(this.i));return[n]},cp:function(n){_h.d.f(this.i,this.e)},E:function(){_a.dg.prototype.E.call(this);_h.d.l(this.i,this.e)},H:function(){_h.d.f(this.i,this.e)}};_cc.cr=function(n,t,i,r,u,f){_cc.cr.initializeBase(this);this.g=n;this.j=_h.T.a(this.g);this.a=t;this.o=r||"";this.p=i===1;this.h=_g.H.isInstanceOfType(n);this.A=n.t();this.i=u;f&&_g.i.isInstanceOfType(this.g)&&(this.d=f.b(this.g.e()));if(this.h){var e=this.g;this.n=e.bl.ConversationId?e.bl.ConversationId.Id:null}};_cc.cr.prototype={p:!1,a:"Unknown",h:!1,A:"Single",n:null,d:null,g:null,j:null,i:null,r:null,o:null,k:null,l:null,q:!1,c:function(){return!0},m:function(){return!$a(this.i)},s:function(n){this.X();this.h?this.W(n):this.T(n)},E:function(){_a.dg.prototype.E.call(this);this.h&&_h.d.l(this.j,this.n);var r=this.S();if(!r){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because AssociatedCalendarItem was not present.");return}if(!this.d||!this.d.f){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update because query table or range in cache was not present.");return}var n=!1;if(this.A==="RecurringMaster"){var u=this.g.M();if(!u){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because InstanceKey was not present.");return}if(this.a==="Decline")n=this.d.i(u);else if(this.a==="Accept"||this.a==="Tentative")for(var f=_a.c.a(),t=0;t<this.d.bl.x.length;t++){var i=this.d.bl.x[t];if(i.bl.InstanceKey===u&&i.du()){this.P(i,f);n=!0}}}else{this.l=this.d.bf(_g.i,r);if(!this.l){_js.Trace.logInfo(_a.a.b,"CalendarItemModel for meeting response not found - ItemId: {0}",r.Id);return}if(this.a==="Accept"||this.a==="Tentative"){this.P(this.l);n=!0}else this.a==="Decline"&&(n=this.d.bl.m(this.l,!0))}this.q=n},H:function(){_a.dg.prototype.H.call(this);this.Q(!0);if(this.h){_h.d.f(this.j,this.n);return}var n=this.q;this.q=!1;n&&this.d.ba()},P:function(n,t){t=t||_a.c.a();n.bP(this.a==="Accept"?"Busy":"Tentative");n.gk(t);n.eA(this.a)},S:function(){var n;if(this.h){var t=this.g;n=t.bl.AssociatedCalendarItemId;if(!n||!n.Id)return null}else n=this.g.g();return n},X:function(){this.m()&&(this.k=_a.d.b(_a.a.b,"ProposeNewTime"))},Q:function(n){if(this.m()){this.k.k=n?_h.y.b(this):null;this.k.l=_h.y.a(this);_a.d.a(this.k);this.k=null}},T:function(n){var i=new _g.Lw(this.x);i.shouldPrecedeOfflineSyncActions=!0;i.explicitLogonUser=this.r;var t=new _g.lt;t.CalendarId=new _g.R(_g.s.a(this.g.Q()));t.EventId=_g.g.a(this.j);t.Response=this.a;t.Notes=new _g.G("HTML",this.o);t.SendResponse=this.p;if(this.m()){t.ProposedStartTime=this.i.c().j();t.ProposedEndTime=this.i.f().j()}var r=new _g.rI(this.y());r.Body=t;n.D(r,i,this.f,this.e)},W:function(n){var i=new _g.Lz(this.x);i.shouldPrecedeOfflineSyncActions=!0;i.explicitLogonUser=this.r;var t=new _g.lu;t.MeetingMessageId=_g.g.a(this.j);t.Response=this.a;t.Notes=new _g.G("HTML",this.o);t.SendResponse=this.p;if(this.m()){t.ProposedStartTime=this.i.c().j();t.ProposedEndTime=this.i.f().j()}var r=new _g.rJ(this.y());r.Body=t;n.E(r,i,this.f,this.e)}};_cc.bY=function(n,t){_cc.bY.initializeBase(this,[n,[t.bl.ItemId],null,"None",0,!1]);this.a=t;this.d=_cc.bY.a(this.a)};_cc.bY.a=function(n){var t;t=n.H()?9:6;var r=new _g.bT("IdOnly");var i=[];t&1&&Array.add(i,new _g.e("ConflictingMeetingCount"));t&2&&Array.add(i,new _g.e("ConflictingMeetings"));t&4&&Array.add(i,new _g.e("AdjacentMeetings"));t&8&&Array.add(i,new _g.e("AdjacentMeetingCount"));r.AdditionalProperties=i;return r};_cc.bY.prototype={a:null,cp:function(n){var t=_g.h.b(n.Items[0]);this.a.eS(t.bl.ConflictingMeetingCount);this.a.eP(t.bl.AdjacentMeetingCount);this.a.eT(t.bl.ConflictingMeetings);this.a.eR(t.bl.AdjacentMeetings)}};_cc.bP=function(n){this.g=n};_cc.bP.a=function(n,t){t.bX&&t.X()};_cc.bP.prototype={g:null,b:null,a:function(){var n=new _g.be;n.NotificationType="CalendarItemNotification";n.FolderId=this.g;return n},d:function(){return _a.a.da},e:function(){return"AgendaNotificationStrategy"},c:function(){return 1},f:function(n,t){this.b||(this.b=this.h(n,t))},h:function(n,t){var i=this;return _js.g.a().a(t.bm(),"AgendaNotificationStrategy",function(){_cc.bP.a(n,t);i.b=null},1500)}};_cc.bQ=function(n,t){_cc.bQ.initializeBase(this,[n,new _cc.bR(n.b().Id,t)])};_cc.bQ.prototype={o:null,v:function(n,t,i,r){_cc.bB.prototype.v.call(this,n,t,i,r);n.g(this.o.bl.OwnerEmailAddress)}};_cc.cH=function(n){_cc.cH.initializeBase(this,[n])};_cc.cH.prototype={o:function(n,t){t.bX&&t.d().Id===n.FolderId&&t.ba()}};_cc.cG=function(n){this.h={};this.g=new _ff.e;this.l={};this.j=new _g.be;this.j.NotificationType="CalendarItemNotification";this.j.FolderId=n};_cc.cG.prototype={j:null,m:!0,i:null,a:function(){return this.j},d:function(){return _a.a.bM},e:function(){return"CalendarNotificationStrategy"},c:function(){return 1},A:function(){this.k();this.m=!1},z:function(n){this.m=!0;this.n(n)},f:function(n,t){var i=n;var u=n;if(u.clientGenerated)this.o(i,t);else{this.s(i,t);if(this.m){this.i&&this.k();var r=this;this.i=_js.g.a().a(_a.a.bM,"CalendarNotificationStrategy",function(){r.n(t)},1500)}}},o:function(n,t){if(t.bX&&t.d().Id===n.FolderId){n.Item&&!n.Item.__type&&(n.Item.__type="CalendarItem:#Exchange");this.r(n)?t.X():n.EventType==="RowDeleted"?this.u(t,n):n.Item.CalendarItemType==="RecurringMaster"?this.t(t,n):this.v(t,n)}},s:function(n,t){if(this.r(n)){this.g.f();this.g.c(n);this.k();this.n(t)}else{for(var r=this.g.d.length-1;r>=0;r--){var e=this.g.d[r].Item;var f;var u;if(n.Item.InstanceKey){u=n.Item.InstanceKey;f=e.InstanceKey}else{u=n.Item.ItemId.Id;f=e.ItemId.Id}if(u===f){this.g.j(r);break}}var s=!1;if(n.Item.InstanceKey)if(n.EventType==="RowModified"&&n.Item.CalendarItemType==="RecurringMaster")n.Item.UID&&(this.l[n.Item.InstanceKey]=n.Item.UID);else if(n.EventType==="RowDeleted"){var o=this.l[n.Item.InstanceKey];delete this.l[n.Item.InstanceKey];if(o)for(var i=this.g.d.length-1;i>=0;i--){var h=this.g.d[i].Item.UID;if(this.g.d[i].EventType==="RowAdded"&&h===o){this.g.d[i].a=n.Item.InstanceKey;s=!0;break}}}s||this.g.c(n)}},k:function(){this.i=_js.g.a().b(this.i)},r:function(n){return n.EventType==="Reload"||n.Reload},n:function(n){for(var r=this.g.d.length,t=0;t<r;t++){var i=this.g.d[t];this.o(i,n)}this.g.f();this.k()},u:function(n,t){var i=n.bs(t.Item);var o=String.format("Will handle a RowDeleted notification for instance key {0}",i.bl.InstanceKey);i.bl.InstanceKey in this.h&&delete this.h[i.bl.InstanceKey];if(i.bl.ItemId&&i.bl.ItemId.Id)if(i.t()!=="RecurringMaster"){var e=n.J(i.bl.ItemId);e!==-1}else i.bl.InstanceKey?n.i(i.bl.InstanceKey,null):n.X();else for(var r=n.bl.x.length-1;r>=0;r--){var u=n.bl.x[r];var f=u.bl.InstanceKey;if(!f){n.X();return}if(f===i.bl.InstanceKey){n.bl.n(r);if(!$a(u.t())&&u.t()==="Single")return}}},t:function(n,t){var r=t.Item;if(n.f)if(r.UID){var o=new _g.g(r.ItemId.Id);var u=new _h.T(o);u.a=n.f;var i=new _cc.M(300,u,r.InstanceKey,null);var s=this;i.w(function(i){s.y(i,n,t.a)});var f=this;i.v(function(i){f.x(i,n,t.a)});var e=this;i.z(function(n){e.w(n)});r.InstanceKey in this.h;this.h[r.InstanceKey]=i;OwaApplication.a.a(i)}else n.X()},p:function(n){return n.d in this.h&&this.h[n.d]===n},w:function(n){this.p(n)&&delete this.h[n.d]},y:function(n,t,i){if(this.p(n)&&t.bl){var e=n.c();if(!e.a.g(t.f)){t.X();return}i;t.i(n.d,i);var f=0;if(n.a())for(var r=0;r<n.a().x.length;r++){var u=n.a().x[r];f=t.P(u);if(f===-1){_js.Trace.logWarning(_a.a.bM,"Couldn't find index to insert instance of series. Id={0}. UID={1}. Reloading",u.bl.ItemId.Id,u.bl.UID);t.X();break}}}},x:function(n,t,i){if(this.p(n)){var r=n.t.responseCode;if(r==="ErrorItemNotFound"){_js.Trace.logWarning(_a.a.bM,"Action [{0}] to expand recurring series failed with item not found. Since the item isn't on the server, we will remove the series. Error: {1}",n.F,n.t);i;t.i(n.d,i)}else{_js.Trace.logWarning(_a.a.bM,"Action [{0}] to expand recurring series failed. Will reload the table. Error: {1}",n.F,n.t);t.X()}}},v:function(n,t){var i=n.bs(t.Item);i.a()||_js.Trace.logError(_a.a.bM,"Start value should not be null for a calendar notification item. CalendarItemNotification.id={0}, Subject={1}",t.id,i.bl.Subject);switch(t.EventType){case"RowAdded":n.t(i,0,!1);break;case"RowDeleted":_js.Trace.logError(_a.a.bM,"RowDeleted notifications should have been handled by the HandleRowDeletedNotification method.");break;case"RowModified":var r=!t.Item.InstanceKey||i.bE()?0:1;n.t(i,r,!1);break;default:_js.Trace.logWarning(_a.a.bM,"Unsupported notification type");break}}};_cc.bR=function(n,t){_cc.bR.initializeBase(this,[n]);this.q=t};_cc.bR.prototype={q:null,b:function(){return this.q}};_cc.cs=function(){var n=_g.s.d("calendar");this.b=new(_h.dV.$$(_cc.N))(n)};_cc.cs.prototype={b:null,a:function(n,t){var r=this;var i=_h.d.b(this.b,_h.i.a(),function(n){return new _cc.N(n)});i.bi||i.bq(n,t)}};_cc.bW=function(n,t,i){this.c=Function.createDelegate(this,this.d);this.a=n;this.b=t;i.b(_a.ed,this.c)};_cc.bW.prototype={a:null,b:null,d:function(n){var i=n.a.length;if(i>0){var t=this.a.e();var r=this;t.e(function(){for(var u=0;u<i;u++){var e=n.a[u];var f=t.b(e.bl.FolderId);f?r.b.e().b(f,null):_js.Trace.logWarning(_a.a.b,"[CalendarPublicFolderEventListener] Cannot select calendar '{0}' because it couldn't be found in the list of calendars.",e.bl.FolderId.Id)}})}}};_cc.cW=function(){};_cc.cW.registerInterface("_cc.cW");_cc.bs=function(n){this.r=n.S();this.p=new _cc.s(n.c(),n.f(),n.n());this.m=n.p()||new(_a.ge.$$(_g.t,_g.M));this.l=n.s()||new(_a.ge.$$(_g.t,_g.M));this.n=n.D()||new(_a.ge.$$(_g.t,_g.M))};_cc.bs.prototype={p:null,r:null,m:null,l:null,n:null,o:null,q:null,s:null,d:function(){return this.r},a:function(){return this.p},f:function(){return this.m},e:function(){return this.l},g:function(){return this.n},b:function(){return this.o},j:function(n){this.o=n;return n},h:function(){return this.q},k:function(n){this.q=n;return n},c:function(){return this.s},i:function(n){this.s=n;return n},t:function(n){for(var t=this.m.b()+this.l.b()+this.n.b();t>n;){if(this.l.b())this.l.m(0);else if(this.n.b())this.n.m(0);else if(this.m.b())this.m.m(0);else break;t--}}};_cc.s=function(n,t,i){_cc.s.initializeBase(this);this.bh(n);this.J(t);this.E(i)};_cc.s.$$cctor=function(){_a.i.d(_cc.s,Object,function(n){var t=new _cc.s;t.dN(n);return t})};_cc.s.prototype={c:function(){return this.dS(_cc.s.c)},bh:function(n){this.dR(_cc.s.c,n);return n},f:function(){return this.dS(_cc.s.a)},J:function(n){this.dR(_cc.s.a,n);return n},n:function(){return this.dS(_cc.s.b)},E:function(n){this.dR(_cc.s.b,n);return n}};_cc.bc=function(n,t){_cc.bc.initializeBase(this);this.b=n;this.a=t};_cc.bc.prototype={b:null,a:null};_cc.dd=function(){};_cc.dd.registerInterface("_cc.dd");_cc.de=function(){};_cc.de.registerInterface("_cc.de");var ISpeechJsonDeserializerUtils=function(){};ISpeechJsonDeserializerUtils.registerInterface("ISpeechJsonDeserializerUtils");_cc.ch=function(){};_cc.ch.registerInterface("_cc.ch");var ICalendarPickerGroupNodeViewModel=function(){};ICalendarPickerGroupNodeViewModel.registerInterface("ICalendarPickerGroupNodeViewModel");var ICalendarPickerModernGroupsProvider=function(){};ICalendarPickerModernGroupsProvider.registerInterface("ICalendarPickerModernGroupsProvider");var ICalendarPickerModernGroupsViewModel=function(){};ICalendarPickerModernGroupsViewModel.registerInterface("ICalendarPickerModernGroupsViewModel");_cc.ci=function(){};_cc.ci.registerInterface("_cc.ci");var ICalendarPickerViewModel=function(){};ICalendarPickerViewModel.registerInterface("ICalendarPickerViewModel");_cc.cj=function(n,t,i){_cc.cj.initializeBase(this,[_u.c.BA,null,n,t,i]);this.S(!1);this.n=!1;this.K("CalendarCharmPickerTemplates.CharmGridMenuItemTemplate")};_cc.X=function(n){this.c=Function.createDelegate(this,this.e);_cc.X.initializeBase(this);_a.b.b(n,"Need calendar item model for calendar item we are managing the charm for.");this.a=n;this.d()};_cc.X.prototype={a:null,b:null,d:function(){for(var t=new Array(0),i=new _cc.ba,n=0;n<_cc.X.a.length;n++)t[n]=new _cc.U(n.toString(),i.a(_cc.X.a[n],null),_cc.X.a[n],"CalendarCharmPickerTemplates.CharmMenuItemTemplate");if(this.a.fo()!=="None"){t[0].b="CalendarCharmPickerTemplates.UseCalendarCharmMenuItemTemplate";t[0].e=i.a(this.a.fo(),null)}else t[0].b="CalendarCharmPickerTemplates.NoneCharmMenuItemTemplate";this.b=new _cc.cj(this.c,t,t[Array.indexOf(_cc.X.a,this.a.ce())])},e:function(n){var t=_a.d.b(_a.a.k,"SetCalendarItemCharm");this.a.eS(n);_a.d.a(t)}};_cc.W=function(n,t,i){this.i=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.p);this.k=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.n);_cc.W.initializeBase(this);_a.b.b(n,"Need calendar model for calendar we are managing the charm for.");_a.b.b(i,"Error message handler must be specified.");this.b=n;this.f=t;this.e=this.m();this.d=i};_cc.W.prototype={b:null,f:!1,e:null,d:null,g:null,c:!1,a:null,l:function(n){if(this.c!==n){this.c=n;this.dQ("IsActionPending")}return n},m:function(){for(var t=new Array(_cc.W.a.length),i=new _cc.ba,n=0;n<_cc.W.a.length;n++)t[n]=new _cc.U(n.toString(),i.a(_cc.W.a[n],null),_cc.W.a[n],"CalendarCharmPickerTemplates.CharmMenuItemTemplate");t[0].b="CalendarCharmPickerTemplates.NoneCharmMenuItemTemplate";this.g=new _cc.cj(this.h,t,t[Array.indexOf(_cc.W.a,this.b.p())]);return t},n:function(n){if(!this.c){var i=n;this.a=_a.d.b(_a.a.b,"SetCalendarCharm");var t=new _cc.cE(this.b,i);t.w(this.k);t.v(this.j);t.z(this.i);this.l(!0);OwaApplication.a.a(t)}},p:function(n){this.e[Array.indexOf(_cc.W.a,this.b.p())].g();if(this.a){this.a.k=n?n.D():"Failed";this.a.l=_h.y.a(n);_a.d.a(this.a);this.a=null}this.d(n.t.message)},q:function(n){var t;if(this.f){var r=new(_h.dV.$$(_cc.bp))(this.b.bl.FolderId);var f=this;t=_h.d.b(r,_h.i.a(),function(n){return new _cc.bp(n)})}else{var i=new(_h.dV.$$(_cc.N))(this.b.bl.FolderId);var u=this;t=_h.d.b(i,_h.i.a(),function(n){return new _cc.N(n)})}t&&t.bX&&t.ba()},o:function(n){this.l(!1);if(this.a){this.a.l=_h.y.a(n);_a.d.a(this.a);this.a=null}}};_cc.ck=function(){};_cc.ck.prototype={a:function(n,t){switch(n){case 0:return _u.c.Cr;case 1:return _u.c.q;case 3:return _u.c.CC;case 2:return _u.c.O;case 4:return _u.c.N;case 5:return _u.c.DD;default:return""}},b:function(n,t){throw Error.notImplemented();}};_cc.ba=function(){};_cc.ba.$$cctor=function(){_cc.ba.a=new _cc.ba};_cc.ba.prototype={a:function(n,t){var i=t||!1;switch(n){case"Cat":return i?_cc.b.l():_cc.b.k();case"Dog":return i?_cc.b.v():_cc.b.u();case"Plane":return i?_cc.b.R():_cc.b.Q();case"Document1":return i?_cc.b.t():_cc.b.s();case"FirstAid":return i?_cc.b.x():_cc.b.w();case"Trophy":return i?_cc.b.bb():_cc.b.ba();case"Home":return i?_cc.b.F():_cc.b.E();case"Pill":return i?_cc.b.P():_cc.b.O();case"Luggage":return i?_cc.b.H():_cc.b.G();case"Cup":return i?_cc.b.p():_cc.b.o();case"Group":return i?_cc.b.B():_cc.b.A();case"Timer":return i?_cc.b.Z():_cc.b.Y();case"Music":return i?_cc.b.L():_cc.b.K();case"Shopping":return i?_cc.b.T():_cc.b.S();case"Car":return i?_cc.b.j():_cc.b.i();case"Star":return i?_cc.b.X():_cc.b.W();case"Document2":return i?_cc.b.r():_cc.b.q();case"Person":return i?_cc.b.N():_cc.b.M();case"Balloon":return i?_cc.b.d():_cc.b.c();case"ForkKnife":return i?_cc.b.z():_cc.b.y();case"Heart":return i?_cc.b.D():_cc.b.C();case"Soccer":return i?_cc.b.V():_cc.b.U();case"Movie":return i?_cc.b.J():_cc.b.I();case"Chart":return i?_cc.b.n():_cc.b.m();case"Books":return i?_cc.b.f():_cc.b.e();case"Cake":return i?_cc.b.h():_cc.b.g()}return null},b:function(n,t){throw Error.notImplemented();}};_cc.be=function(){};_cc.be.a=function(n,t){switch(_cc.be.b(n)){case"RecurringMaster":switch(t){case 1:return _u.c.Bx;case 3:return _u.c.DB;default:return _u.c.DL}case"Occurrence":case"Exception":switch(t){case 1:return _u.c.Y;case 3:return _u.c.Bt;default:return _u.c.Ce}default:switch(t){case 1:return _u.c.M;case 3:return _u.c.Cf;default:return _u.c.BE}}};_cc.be.b=function(n){if(_g.i.isInstanceOfType(n)){var t=n;return t.bl.IsSeriesCancelled?"RecurringMaster":t.t()}else return n.t()};_cc.be.prototype={a:function(n,t){if(!n)return"";var r=n;var i=$a(t)?2:t;return _cc.be.a(r,i)},b:function(n,t){throw Error.notImplemented();}};_cc.bk=function(){};_cc.bk.prototype={a:function(n,t){if(!n)return"";if(!_g.fc.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.fc,"Value must be an ICalendarTimeBlock");var i=n;return i.n()?_cc.R.b(i.c(),i.f()):_cc.R.a(i.c(),i.f())},b:function(n,t){throw Error.notImplemented();}};_cc.bf=function(){};_cc.bf.prototype={c:null,d:function(){this.c||(this.c=new _cc.cK);return this.c},a:function(n,t){if(!n)return"";if(!_g.ICalendarTimePeriod.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.ICalendarTimePeriod,"Value must be an ICalendarTimePeriod");var i=n;return i.T()?this.d().a(_cc.Y.a(i.bi(),i.L(),i.K()),t):_g.fc.isInstanceOfType(n)&&n.n()?_cc.R.b(i.L(),i.K()):_cc.R.a(i.L(),i.K())},b:function(n,t){throw Error.notImplemented();}};_cc.bg=function(){};_cc.bg.prototype={a:function(n,t){var i=_js.y.a(Number,n);if(i===-1)return _u.c.BW;var r=i*60;return _a.c.O(r,!1)},b:function(n,t){throw Error.notImplemented();}};_cc.cl=function(){};_cc.cl.prototype={a:function(n,t){if($a(n))return"calendarFree";var i=n;switch(i){case"NoData":case"Free":return"calendarFree";case"Busy":return"calendarBusy";case"Tentative":return"calendarTentative";case"WorkingElsewhere":return"calendarOutside";case"OOF":return!$a(t)&&t?"calendarAwayEmphasis":"calendarAway";default:return"calendarFree"}},b:function(n,t){throw Error.notImplemented();}};_cc.bl=function(){};_cc.bl.prototype={a:function(n,t){var i=n;switch(i){case"Free":return _u.c.F;case"Busy":return _u.c.X;case"Tentative":return _u.c.DO;case"WorkingElsewhere":return _u.c.l;case"OOF":return _u.c.Cg;case"NoData":return _u.c.k;default:return""}},b:function(n,t){throw Error.notImplemented();}};_cc.R=function(){};_cc.R.a=function(n,t){var r="";if(!n||!t)return r;var i=_cc.c.h()?18:0;r=n.f().bd(t.f())?String.format(_cc.c.h()?_u.c.H:_u.c.BK,n.a(5),n.a(i),t.a(i)):String.format(_u.c.Cn,n.a(5),n.a(i),t.a(5),t.a(i));return r};_cc.R.b=function(n,t){if(!n||!t)return"";var r=t.g(n);if(r<=864e5)return String.format(_u.c.V,n.a(5));var i=t.c(-1).a(5);return String.format(_u.c.CB,n.a(5),i)};_cc.R.c=function(n,t,i,r){if(!n.k(t))return String.format(_u.c.Co,n.a(3),n.a(0),t.a(0));if(i&&r&&t.b(n)===864e5)return n.a(3);if(i&&r){var u=t.m(-1).a(3);return String.format(_u.c.Bi,n.a(3),u)}return String.format(_u.c.a,n.a(3),n.a(0),t.a(3),t.a(0))};_cc.cK=function(){};_cc.cK.prototype={a:function(n,t){var r=n;var i="";r&&(i=r.o());return i},b:function(n,t){throw Error.notImplemented();}};_cc.cY=function(){};_cc.cY.registerInterface("_cc.cY");_cc.cZ=function(){};_cc.cZ.registerInterface("_cc.cZ");_cc.cJ=function(n,t,i,r){this.g=n;this.h=t;this.e=i;this.f=r};_cc.cJ.prototype={g:!1,h:!1,e:null,f:null,d:function(){return this.g},c:function(){return this.h},a:function(){return this.e},b:function(){return this.f}};_cc.bb=function(){};_cc.bb.registerInterface("_cc.bb");var ICalendarItemPeekViewModelFactory=function(){};ICalendarItemPeekViewModelFactory.registerInterface("ICalendarItemPeekViewModelFactory");_cc.I=function(n,t,i,r,u,f){this.f=Function.createDelegate(this,this.i);_cc.I.initializeBase(this);this.a=n;this.c=t;this.e=f;if(this.d()){var e=_pc.a.f(n);this.b=_cc.I.a(e,i,r);if(u&&this.a.a().a()==="Resource"){_js.Trace.logInfo(_a.a.v,"Creating ReadCard for LocationViewModel.");this.b.bt(this.f)}}};_cc.I.a=function(n,t,i,r,u,f){if(!n.gd())throw Error.invalidOperation("Cannot create persona view model for a persona that does not have a valid location identifier");var e=t.b(n,4,!1,2,!1,null,!1);var s=i.a()!=="Mouse";switch(r){case 0:e.g(!0);e.J(!0);e.b(!1);e.w(!1);break;case 1:e.g(!0);e.J(!0);e.b(!1);e.w(!s);break;case 2:default:e.g(!0);e.J(!0);e.b(!0);e.w(!s);break}if(u&&u.length>0){for(var h=new Array(u.length),o=0;o<u.length;o++)h[o]=u[o].e();_cc.I.c(e,h,f)}e.bz(0,_cc.I.b,null,2);return e};_cc.I.c=function(n,t,i){var r=[];Array.addRange(r,t);n.m()&&i&&Array.addRange(r,n.m());n.W(r)};_cc.I.prototype={e:!1,c:null,b:null,a:null,g:function(n){this.dV("OnLocationUpdated",n)},d:function(){return!this.e&&!!this.a&&this.a.j()&&(this.a.c()||this.a.a().a()==="Resource")},h:function(){return this.a===this.c},i:function(n){var t=n;if(t.bI()){this.a.a().v(t.bI().bl.Latitude);this.a.a().x(t.bI().bl.Longitude);this.a.a().C(t.bI().bl.Altitude);this.dX("OnLocationUpdated")}}};_cc.bv=function(){};_cc.bv.a=function(n){var t=new _js.f;t.a(-1);t.a(0);t.a(5);t.a(10);t.a(15);t.a(30);t.a(60);t.a(120);t.a(180);t.a(240);t.a(480);t.a(720);t.a(1440);t.a(2880);t.a(4320);t.a(10080);t.a(20160);if(n>t.x[t.x.length-1])t.a(n);else for(var i=0;i<t.x.length;i++){if(n===t.x[i])break;if(n<t.x[i]){t.r(i,n);break}}return t};var IProposeNewTimeManager=function(){};IProposeNewTimeManager.registerInterface("IProposeNewTimeManager");_cc.cM=function(n,t){_cc.cM.initializeBase(this);this.f=n;this.b=t};_cc.cM.prototype={f:null,b:null,d:null,a:function(n){_js.g.a().j(_a.a.a,_y.M.toString(n.a()));this.c=!1;if(this.b.c()){n.l()===1&&n.o(0);this.b.g(IMailComposeViewModelFactory,null,null,_bc.c.a(),n,!0)}else if(this.d){var i=this.d.a(n,null,null);this.b.f(i,1,!0)}else{var t=this;this.f.a(function(i){t.d=i;var r=t.d.a(n,null,null);t.b.f(r,1,!0)})}}};_cc.bw=function(n,t){this.d=Function.createDelegate(this,this.a);this.b=n;this.c=t};_cc.bw.prototype={b:null,c:null,a:function(n,t){return n&&t===1?n:new _cc.cM(this.b,this.c)}};function MeetingResponseEditorViewModel(){this.D=Function.createDelegate(this,this.E);this.c=this.b;this.d=this.a;MeetingResponseEditorViewModel.initializeBase(this);this.z=new _C(this.D,MeetingResponseEditorViewModel.a)}MeetingResponseEditorViewModel.prototype={z:null,C:null,x:!1,v:"Unknown",B:null,A:null,t:null,y:!1,w:null,q:function(n){this.C=n;return n},m:function(n){if(this.w!==n){this.w=n;this.dQ("EditorCallContext")}return n},b:function(){return this.x},a:function(n){if(this.x===n)return n;this.x=n;this.dQ("IsShown");n&&this.m(new _cmc.L(!1));return n},f:function(){return this.v},g:function(n){if(this.v===n)return n;this.v=n;this.dU("ResponseType","LabelText");return n},n:function(n){this.A=n;return n},j:function(){return this.t},e:function(n){if(this.t===n)return n;this.t=n;this.eb("ProposedNewTime","HideTimeProposal","LabelText");return n},k:function(){return this.y},o:function(n){if(this.y===n)return n;this.y=n;this.dQ("RespondToMasterFromOccurrence");return n},l:function(){return this.B},p:function(n){this.B=n;return n},F:function(){var n;switch(this.v){case"Accept":n=this.t?_u.W.j:_u.W.BU;break;case"Tentative":n=this.t?_u.W.D:_u.W.o;break;case"Decline":n=this.t?_u.W.e:_u.W.V;break;default:_js.Trace.logError(MeetingResponseEditorViewModel.a,"BUGBUG: You shouldn't see this.  ResponseType: "+this.v);n="";break}return n},h:function(){return 450},i:function(){return 370},r:function(){return!0},E:function(){this.e(null);this.m(new _cmc.i(""));this.a(!1)}};_cc.f=function(n,t,i,r,u,f,e,o,s,h){this.Y=Function.createDelegate(this,this.cP);this.W=Function.createDelegate(this,this.cp);this.z=Function.createDelegate(this,this.cO);this.X=Function.createDelegate(this,this.cI);this.bB=Function.createDelegate(this,this.ci);this.bR=Function.createDelegate(this,this.cS);this.bw=Function.createDelegate(this,this.ca);this.bQ=Function.createDelegate(this,this.cy);this.bz=Function.createDelegate(this,this.ce);this.bA=Function.createDelegate(this,this.ch);this.bS=Function.createDelegate(this,this.cT);this.bv=Function.createDelegate(this,this.bZ);this.bD=Function.createDelegate(this,this.ck);this.bN=Function.createDelegate(this,this.cv);this.bU=Function.createDelegate(this,this.cV);this.bP=Function.createDelegate(this,this.cx);this.by=Function.createDelegate(this,this.cc);this.bL=Function.createDelegate(this,this.ct);this.bH=Function.createDelegate(this,this.co);this.bJ=Function.createDelegate(this,this.cr);this.bF=Function.createDelegate(this,this.cm);this.bC=Function.createDelegate(this,this.cj);this.bM=Function.createDelegate(this,this.cu);this.bT=Function.createDelegate(this,this.cU);this.bO=Function.createDelegate(this,this.cw);this.bx=Function.createDelegate(this,this.cb);this.bK=Function.createDelegate(this,this.cs);this.bG=Function.createDelegate(this,this.cn);this.bI=Function.createDelegate(this,this.cq);this.bE=Function.createDelegate(this,this.cl);_cc.f.initializeBase(this);_a.b.a(n,"item");this.a=n;this.c=t;this.t=i;this.T=r;this.bd=u;this.bu=f;this.D=e;this.bp=o;this.bm=s;this.bc=h;this.k=0;this.p=!0;var nt=this;this.n=new _C(this.bE,_cc.f.a,this,"CanAccept",function(){return nt.h()});var tt=this;this.o=new _C(this.bI,_cc.f.a,this,"CanTentativelyAccept",function(){return tt.i()});var d=this;this.d=new _C(this.bG,_cc.f.a,this,"CanDecline",function(){return d.g()});if(this.j()){var g=this;this.N=new _C(this.bK,_cc.f.a,this,"CanAccept",function(){return g.h()});var it=this;this.G=new _C(this.bx,_cc.f.a,this,"CanAccept",function(){return it.h()});var ft=this;this.Q=new _C(this.bO,_cc.f.a,this,"CanTentativelyAccept",function(){return ft.i()});var et=this;this.V=new _C(this.bT,_cc.f.a,this,"CanTentativelyAccept",function(){return et.i()});var rt=this;this.y=new _C(this.bM,_cc.f.a,this,"CanDecline",function(){return rt.g()});var ut=this;this.v=new _C(this.bC,_cc.f.a,this,"CanDecline",function(){return ut.g()})}if(_g.i.isInstanceOfType(this.a)&&this.a.bE()){var a=this;this.L=new _C(this.bF,_cc.f.a,this,"CanAccept",function(){return a.h()});var v=this;this.M=new _C(this.bJ,_cc.f.a,this,"CanTentativelyAccept",function(){return v.i()});var c=this;this.x=new _C(this.bH,_cc.f.a,this,"CanDecline",function(){return c.g()});if(this.j()){var l=this;this.bg=new _C(this.bL,_cc.f.a,this,"CanAccept",function(){return l.h()});var y=this;this.Z=new _C(this.by,_cc.f.a,this,"CanAccept",function(){return y.h()});var b=this;this.bk=new _C(this.bP,_cc.f.a,this,"CanTentativelyAccept",function(){return b.i()});var k=this;this.bt=new _C(this.bU,_cc.f.a,this,"CanTentativelyAccept",function(){return k.i()});var p=this;this.P=new _C(this.bN,_cc.f.a,this,"CanDecline",function(){return p.g()});var w=this;this.K=new _C(this.bD,_cc.f.a,this,"CanDecline",function(){return w.g()})}}this.F=new _C(this.bv,_cc.f.a);this.U=new _C(this.bS,_cc.f.a);this.A=new _C(this.bA,_cc.f.a);this.bb=new _C(this.bz,_cc.f.a);this.cf();this.r=1;this.b=new MeetingResponseEditorViewModel;this.b.q(new _C(this.bQ,_cc.f.a))};_cc.f.c=function(n){switch(n){case 5:return"Accept";case 6:return"Tentative";case 7:return"Decline";default:throw Error.invalidOperation("Unable to get ResponseType from MailComposeOperation "+_y.M.toString(n));}};_cc.f.b=function(n,t,i,r,u){var f=new _cc.bA(n,t,r,u);f.c=i;return f};_cc.f.prototype={c:null,t:null,a:null,bb:null,F:null,U:null,A:null,G:null,Z:null,V:null,bt:null,v:null,K:null,N:null,bg:null,Q:null,bk:null,y:null,P:null,n:null,L:null,o:null,M:null,d:null,x:null,T:null,bd:null,bu:null,bp:!1,bm:null,b:null,bc:null,D:null,l:null,q:null,m:null,w:null,C:null,p:!1,S:!1,r:0,k:0,e:null,f:null,ba:function(n){this.dV("ActionSubmitted",n)},bY:function(n){this.dW("ActionSubmitted",n)},bV:function(n){this.dV("ResponseEditorShown",n)},cd:function(n){this.dV("ProposeNewTimeStarted",n)},cN:function(n){this.dW("ProposeNewTimeStarted",n)},cA:function(){return this.p?_u.W.h:""},cC:function(){return this.p?_u.W.i:""},cH:function(){return this.p?_u.W.W:""},B:function(){return this.h()||this.g()||this.i()},cB:function(){return this.a.W()},h:function(){return this.a.V()},g:function(){return this.a.X()},i:function(){return this.a.Z()},cR:function(n){if(this.p!==n){this.p=n;this.dY(["TentativelyAcceptLabel","AcceptLabel","DeclineLabel"])}return n},cF:function(){return this.bu.g().d()},cE:function(){return this.T.a()!=="Mouse"},cQ:function(n){if(n!==this.S){this.S=n;this.dQ("HasEventAddedToCalendar")}return n},cD:function(){return this.T.a()==="TouchNarrow"?_u.W.BR:_u.W.BA},R:function(){return this.bp&&this.a.Y()&&this.j()},j:function(){return this.a.A()},cG:function(){return!this.j()&&(_g.bk.isInstanceOfType(this.a)||_g.i.isInstanceOfType(this.a)&&!this.a.bE())},bn:function(){return _g.i.isInstanceOfType(this.a)&&this.a.bE()},bX:function(){this.ea("ActionSubmitted",this,null)},cJ:function(){this.ea("ActionSucceeded",this,null)},cM:function(){this.ea("ResponseEditorShown",this,null)},cL:function(){this.ea("ResponseEditorHidden",this,null)},cK:function(){this.ea("ProposeNewTimeStarted",this,null)},bi:function(n){this.b.e(null);this.bh(n,!1)},bj:function(n){this.b.e(null);this.bh(n,!0)},cz:function(n,t,i,r,u){return new _cc.cr(n,t,i,r,u,this.bc)},cf:function(){this.R()&&(this.C=this.cg());if(this.j())if(_g.i.isInstanceOfType(this.a)&&this.a.bE()){this.l=this.I(_u.W.f,_u.W.y,this.N,this.G,this.n,this.bg,this.Z,this.L);this.q=this.I(_u.W.BO,_u.W.BW,this.Q,this.V,this.o,this.bk,this.bt,this.M);this.m=this.I(_u.W.m,_u.W.BX,this.y,this.v,this.d,this.P,this.K,this.x);this.w=this.I(_u.W.s,_u.W.BK,this.y,this.v,this.d,this.P,this.K,this.x)}else{this.l=this.H(_u.W.x,this.N,this.G,this.n);this.q=this.H(_u.W.v,this.Q,this.V,this.o);this.m=this.H(_u.W.l,this.y,this.v,this.d);this.w=this.H(_u.W.X,this.y,this.v,this.d)}else if(_g.i.isInstanceOfType(this.a)&&this.a.bE()){this.l=this.J(_u.W.x,this.n,this.L);this.q=this.J(_u.W.v,this.o,this.M);this.m=this.J(_u.W.l,this.d,this.x);this.w=this.J(_u.W.X,this.d,this.x)}},H:function(n,t,i,r){var u=new _ff.e;u.c(new _fm.n(n));u.c(new _fm.d(_u.W.S,null,t));u.c(new _fm.d(_u.W.w,null,i));u.c(new _fm.d(_u.W.k,null,r));return new _fm.f(u.d)},cg:function(){var t=new _C(this.bw,_cc.f.a);var r=new _C(this.bR,_cc.f.a);var i=new _C(this.bB,_cc.f.a);var n=new _ff.e;n.c(new _fm.n(_u.W.BC));n.c(new _fm.d(_u.W.K,null,t));n.c(new _fm.d(_u.W.t,null,r));n.c(new _fm.d(_u.W.BT,null,i));return new _fm.f(n.d)},ca:function(){this.bq("Accept")},cS:function(){this.bq("Tentative")},ci:function(){this.bq("Decline")},bq:function(n){this.b.g(n);this.b.n(this.a);this.D.e().a(this.X);this.D.e().c(this.a,n);this.cK()},cI:function(n){this.D.e().b(this.X);this.b.e(n);this.bh(this.b.f(),!1)},I:function(n,t,i,r,u,f,e,o){var s=new _ff.e;s.c(new _fm.n(n));s.c(new _fm.d(_u.W.S,null,i));s.c(new _fm.d(_u.W.w,null,r));s.c(new _fm.d(_u.W.k,null,u));s.c(new _fm.n(t));s.c(new _fm.d(_u.W.S,null,f));s.c(new _fm.d(_u.W.w,null,e));s.c(new _fm.d(_u.W.k,null,o));return new _fm.f(s.d)},J:function(n,t,i){var r=new _ff.e;r.c(new _fm.n(n));r.c(new _fm.d(_u.W.T,null,t));r.c(new _fm.d(_u.W.Z,null,i));return new _fm.f(r.d)},ce:function(){this.f=_a.d.b(_cc.f.a,"AddToMyCalendarFromGroupInvite");_a.y.stPT(_cc.f.a,"AddToMyCalendarFromGroupInvite",3);var i=new _g.iM;i.ItemId=this.a.g();var t=new _cc.bX(i,this.bm);t.v(this.z);var n=this;t.w(function(t){n.cQ(!0);if(n.f){var i=t;n.f.l=i.B();_a.d.a(n.f);n.f=null}});var r=this;t.z(function(n){_a.y.endPT("AddToMyCalendarFromGroupInvite")});this.t.a(t)},cs:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bi("Accept")},cb:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.br("Accept")},cl:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.be("Accept")},ct:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bj("Accept")},cc:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bs("Accept")},cm:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bf("Accept")},cw:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bi("Tentative")},cU:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.br("Tentative")},cq:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.be("Tentative")},cx:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bj("Tentative")},cV:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bs("Tentative")},cr:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bf("Tentative")},cu:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bi("Decline")},cj:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.br("Decline")},cn:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.be("Decline")},cv:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bj("Decline")},ck:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bs("Decline")},co:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bf("Decline")},bh:function(n,t){this.k=_cc.x.c.g(t);this.e=_cc.x.c.c(n,this.r);_a.l.b("VM.MeetResponse.EditResponseForTouchWideAndMouseStart");this.b.g(n);this.b.o(t);this.b.d(!0);this.cM();_cc.x.c.a(this.e,"",null,this.a.A(),_g.i.isInstanceOfType(this.a),this.bn(),this.k);this.e=null},cy:function(){var n=new _cmc.b(!1);this.b.m(n);this.b.p(n.d);this.cL();this.b.d(!1);this.E(this.b.f(),this.b.k(),this.b.l(),this.b.j())},be:function(n){this.bW(n,!1)},bf:function(n){this.bW(n,!0)},bo:function(n,t,i,r,u){var f=this.a;_g.i.isInstanceOfType(f)&&n&&(f=this.bd.c(f));return this.cz(f,t,i,r,u)},bW:function(n,t){this.k=_cc.x.c.f(t);this.e=_cc.x.c.c(n,this.r);var i=this.bo(t,n,0);i.w(this.W);i.v(this.z);this.t.a(i);this.bX()},cp:function(n){var i=n;i.K(this.W);if(i.meetingResponseMessageId){var t=new _h.bg([i.meetingResponseMessageId],"HardDelete",2);t.v(this.z);t.w(this.Y);this.t.a(t)}},br:function(n){this.E(n,!1)},bs:function(n){this.E(n,!0)},E:function(n,t,i,r){this.k=_cc.x.c.h(t);this.e=_cc.x.c.c(n,this.r);var u=this.bo(t,n,1,i,r);u.v(this.z);u.w(this.Y);this.t.a(u);this.bX();_a.l.b("VM.MeetResponse.MeetingResponseEnd")},cO:function(n){var t=n.D();var i=_h.y.a(n);_js.Trace.logWarning(_cc.f.a,"MeetingResponse message failed with error: "+t);if(this.e){_cc.x.c.a(this.e,t,i,this.j(),_g.i.isInstanceOfType(this.a),this.bn(),this.k);this.e=null}if(this.f){this.f.l=i;this.f.k=t;_a.d.a(this.f);this.f=null}_cc.j.a(n)},cP:function(n){if(this.e){_cc.x.c.a(this.e,"",_h.y.a(n),this.j(),_g.i.isInstanceOfType(this.a),this.bn(),this.k);this.e=null}this.cJ()},bZ:function(){this.bl("Accept")},cT:function(){this.bl("Tentative")},ch:function(){this.bl("Decline")},bl:function(n){if(this.cG())switch(n){case"Accept":this.n.a();break;case"Tentative":this.o.a();break;case"Decline":this.d.a();break;default:throw Error.argument("Invalid meeting response argument");}}};_cc.bx=function(n,t,i,r,u,f,e,o){this.b=t;this.e=n;this.h=i;this.d=r;this.i=u;this.g=f;this.f=e;this.c=o};_cc.bx.prototype={b:null,e:null,h:null,d:null,i:null,g:null,f:!1,c:null,a:null,j:function(n){return this.k(n,this.a)},k:function(n,t){return new _cc.f(n,this.e,this.b,this.h,this.d,this.i,this.g,this.f,t,this.c)}};_cc.bS=function(){};_cc.bS.a=function(n){for(var i=new Array(n.a.length),t=0;t<n.a.length;t++)i[t]=n.c(t);return i.join(";")};_cc.D=function(){};_cc.D.registerInterface("_cc.D");_cc.C=function(n){this.h=n};_cc.C.prototype={h:0,e:function(){return _u.c.CP},c:function(n){return _cc.C.isInstanceOfType(n)&&n.h===this.h},a:function(){var n=[_u.c.U,_u.c.CM,_u.c.Bl];return this.i(n)},d:function(){var n=[_u.c.DW,_u.c.CK,_u.c.BL];return this.i(n)},b:function(){return this.h<=0?4:0},g:function(){var n=new _g.dA(new _g.fA(this.h));n.c(this.h);return n},f:function(){return new _cc.C(this.h)},i:function(n){_a.b.f(n.length,3,"Expected three daily recurrence pattern strings");var t="";switch(this.h){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=String.format(n[2],this.h);break}return t}};_cc.E=function(n,t){this.i=n;this.h=t};_cc.E.prototype={h:0,i:0,e:function(){return _u.c.DS},a:function(){var n=[_u.c.Db,_u.c.BX,_u.c.Cd];return this.j(n)},d:function(){var n=[_u.c.A,_u.c.Bd,_u.c.W];return this.j(n)},c:function(n){return _cc.E.isInstanceOfType(n)&&n.i===this.i&&n.h===this.h},b:function(){var n=0;this.i<=0?n|=4:(this.h>31||this.h<=0)&&(n|=1);return n},g:function(){return new _g.du(new _g.fp(this.i,this.h))},f:function(){return new _cc.E(this.i,this.h)},j:function(n){_a.b.f(n.length,3,"Expected three month-by-day pattern strings");var t="";switch(this.i){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=n[2];break}return String.format(t,this.h,this.i)}};_cc.F=function(n,t,i){this.h=n;this.j=t;this.i=i};_cc.F.prototype={j:"None",i:0,h:0,e:function(){return _u.c.Cj},a:function(){var n=[_u.c.S,_u.c.BC,_u.c.Dd];return this.k(n)},d:function(){var n=[_u.c.Da,_u.c.CE,_u.c.Bw];return this.k(n)},c:function(n){return _cc.F.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i&&n.j===this.j},b:function(){var n=0;this.h<=0&&(n|=4);this.i||(n|=2);this.j==="None"&&(n|=16);return n},g:function(){var n=new _g.dH;n.c(this.h);n.k(this.i);n.h(this.j);return n},f:function(){return new _cc.F(this.h,this.j,this.i)},k:function(n){_a.b.f(n.length,3,"Expected three monthly-by-week recurrence pattern strings");var t="";switch(this.h){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=n[2];break}return String.format(t,_cc.e.i(this.j),_cc.e.d(this.i),this.h)}};_cc.q=function(){};_cc.q.prototype={e:function(){return _u.c.BB},a:function(){return _u.c.BB},d:function(){return _u.c.BB},c:function(n){return _cc.q.isInstanceOfType(n)},b:function(){return 0},g:function(){return null},f:function(){return new _cc.q}};_cc.O=function(){};_cc.O.prototype={e:function(){return _u.c.Bu},a:function(){return _u.c.Bu},d:function(){return _u.c.Bu},c:function(n){return _cc.O.isInstanceOfType(n)},b:function(){return 0},g:function(){return null},f:function(){return new _cc.O}};_cc.Y=function(){};_cc.Y.b=function(n,t,i){var r=new _js.f;var u=_cc.e.h(n.q());var f=n.d();r.a(new _cc.q);r.a(new _cc.C(1));r.a(new _cc.A(1,u));t&&r.a(new _cc.A(1,t,t));r.a(new _cc.E(1,n.i()));r.a(new _cc.F(1,_cc.e.e(n),u));r.a(new _cc.G(n.i(),f));if(i.a()!=="TouchNarrow"){_cc.c.n()&&r.a(new _cc.O);r.a(_u.c.BJ)}return r};_cc.Y.d=function(n,t){t.e(n.a.g());t.f(n.n());t.g(n.h)};_cc.Y.a=function(n,t,i){if(!n)return null;var r=new _cc.bm;r.i(_cc.Y.c(n.a()));r.f(n.b().c());r.g(_cc.e.g(n.b(),r.a));r.k(t);r.j(i);r.l(n.c());return r};_cc.Y.c=function(n){var t=new _cc.q;_g.dA.isInstanceOfType(n)?t=new _cc.C(n.a()):_g.dM.isInstanceOfType(n)?t=new _cc.A(n.a(),n.f()):_g.du.isInstanceOfType(n)?t=new _cc.E(n.a(),n.f()):_g.dH.isInstanceOfType(n)?t=new _cc.F(n.a(),n.g(),n.f()):_g.dv.isInstanceOfType(n)?t=new _cc.G(n.a(),_js.l.a(_a.fh,n.bl.Month)):_g.fk.isInstanceOfType(n)&&(t=new _cc.J(n.b(),n.a(),_js.l.a(_a.fh,n.bl.Month)));return t};_cc.bm=function(n,t,i,r,u,f){_cc.bm.initializeBase(this);this.f(t||null);this.g(i||null);this.k(r||null);this.j(u||null);this.l($a(f)?null:f);this.i($a(n)?null:n)};_cc.bm.a=function(n){var t=null;n?(n&64)==64?t=_u.c.CL:(n&1)==1?t=_u.c.w:(n&2)==2?t=_u.c.CX:(n&4)==4?t=_u.c.Ci:(n&32)==32?t=_u.c.h:(n&16)==16?t=_u.c.R:(n&8)==8&&(t=_u.c.BO):t=null;return t};_cc.bm.prototype={b:null,c:null,d:null,e:null,a:null,h:null,i:function(n){if(this.a!==n){this.a=n;this.bj("RecurrencePattern")}return n},f:function(n){if(this.b!==n){this.b=n;this.bj("StartDate")}return n},g:function(n){if(this.c!==n){!$a(n)&&n.b(this.b)<0&&(n=this.b);this.c=n;this.bj("EndDate")}return n},k:function(n){if(this.d!==n){this.d=n;this.bj("StartTime")}return n},j:function(n){if(this.e!==n){!$a(n)&&n.b(this.d)<0&&(n=this.d);this.e=n;this.bj("EndTime")}return n},l:function(n){if(this.h!==n){this.h=n;this.bj("TimeZoneId")}return n},o:function(){return _cc.q.isInstanceOfType(this.a)?this.a.a():String.format(_u.c.BU,this.a.d(),this.m())},m:function(){var n="";var t="";this.d&&this.e&&(t=String.format(_u.c.CH,this.d.a(0),this.e.a(0)));n=this.c?String.format(_u.c.CO,this.b.a(5),this.c.a(5)):String.format(_u.c.Cc,this.b.a(5));return String.format(_u.c.Dg,t,n)},p:function(){return this.a.b()|this.q()},n:function(){var t;if(this.c){var n=new _g.dB;n.g(this.b);n.h(this.c);t=n}else{var i=new _g.iy;i.g(this.b);t=i}return t},q:function(){var n=0;$a(this.b)?n=8:!$a(this.c)&&this.b.b(this.c)>=0&&(n=64);return n}};_cc.e=function(){};_cc.e.e=function(n){for(var i=n.i(),t=0;i>0;){i-=7;++t}switch(t){case 0:return"None";case 1:return"First";case 2:return"Second";case 3:return"Third";case 4:return"Fourth";default:return"Last"}};_cc.e.h=function(n){var t;switch(n){case 0:t=1;break;case 1:t=2;break;case 2:t=4;break;case 3:t=8;break;case 4:t=16;break;case 5:t=32;break;case 6:t=64;break;default:t=0;break}return t};_cc.e.b=function(n){var t=[];n&1&&Array.add(t,0);n&2&&Array.add(t,1);n&4&&Array.add(t,2);n&8&&Array.add(t,3);n&16&&Array.add(t,4);n&32&&Array.add(t,5);n&64&&Array.add(t,6);return t};_cc.e.k=function(n){var r=_cc.Y.c(n.a());var i=n.b();return _cc.e.g(i,r)};_cc.e.g=function(n,t){if(_g.dB.isInstanceOfType(n))return n.f();if(!_g.gI.isInstanceOfType(n)||_cc.q.isInstanceOfType(t))return null;var r=n.a();var i=n.c();if(_cc.C.isInstanceOfType(t)){var nt=t.h*(r-1);return i.c(nt)}else if(_cc.A.isInstanceOfType(t)){var f=t.i;var v=t.h;if(!Array.contains(_cc.e.b(f),i.q())){var p=_cc.e.j(i.q(),f,0);i=i.c(_cc.e.c(i.q(),p))}var y=_cc.e.l(f);var tt=Math.floor((r-1)/y);var a=(r-1)%y;var u=v*7*tt;if(a>0){var e=_cc.e.j(i.q(),f,a);if(e<=i.q()){u+=v*7;u-=_cc.e.c(e,i.q())}else u+=_cc.e.c(i.q(),e)}return i.c(u)}else if(_cc.F.isInstanceOfType(t)){var g=t.j;var b=t.h;var d=_cc.e.b(t.i)[0];(_cc.e.e(i)>g||i.q()>d)&&(i=i.n(b));return _cc.e.f(i.n((r-1)*t.h),_cc.e.b(t.i)[0],t.j)}else if(_cc.E.isInstanceOfType(t)){var h=t.h;var l=t.i;if(i.i()>h){i=i.n(l);i=new _a.c(i.e(),i.d(),h)}return i.n((r-1)*l)}else if(_cc.J.isInstanceOfType(t)){var k=t.i;var c=t.j;var w=_cc.e.b(t.h)[0];(i.d()>c||_cc.e.e(i)>k||i.q()>w)&&(i=new _a.c(i.e()+1,c,1));return _cc.e.f(i.u(r-1),_cc.e.b(t.h)[0],t.i)}else if(_cc.G.isInstanceOfType(t)){var s=t.h;var o=t.i;(i.d()>o||i.i()>s)&&(i=new _a.c(i.e()+1,o,s));return i.u(r-1)}return null};_cc.e.j=function(n,t,i){for(var u=_cc.e.b(t),f=0,r=0;r<u.length;r++)if(n<=u[r]){f=r;if(n===u[r])break}return u[(i+f)%u.length]};_cc.e.c=function(n,t){var i=t-n;return i<0?i+7:i};_cc.e.l=function(n){for(var i=0,t=n;t;){(t&1)>0&&i++;t=t>>1}return i};_cc.e.a=function(n){switch(n){case 0:return _u.c.BI;case 1:return _u.c.DP;case 2:return _u.c.DF;case 3:return _u.c.I;case 4:return _u.c.Bo;case 5:return _u.c.Bs;case 6:return _u.c.DE;default:return""}};_cc.e.d=function(n,t){if(!$a(t)&&n===t)return _u.c.BM;if(n===62)return _u.c.DH;if(n===65)return _u.c.s;if(n===127)return _u.c.Bn;var i=_cc.e.b(n);switch(i.length){case 0:return"";case 1:return String.format(_u.c.p,_cc.e.a(i[0]));case 2:return String.format(_u.c.y,_cc.e.a(i[0]),_cc.e.a(i[1]));case 3:return String.format(_u.c.Bz,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]));case 4:return String.format(_u.c.Cl,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]));case 5:return String.format(_u.c.BP,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]),_cc.e.a(i[4]));case 6:return String.format(_u.c.C,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]),_cc.e.a(i[4]),_cc.e.a(i[5]));case 7:return String.format(_u.c.DV,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]),_cc.e.a(i[4]),_cc.e.a(i[5]),_cc.e.a(i[6]));default:return""}};_cc.e.i=function(n){switch(n){case"First":return _u.c.CI;case"Second":return _u.c.DJ;case"Third":return _u.c.z;case"Fourth":return _u.c.Cv;case"Last":return _u.c.Bp;case"None":default:return""}};_cc.e.f=function(n,t,i){if(i!=="Last"){n=new _a.c(n.e(),n.d(),1);var u=_cc.e.c(n.q(),t);var r=0;switch(i){case"First":r=1;break;case"Second":r=2;break;case"Third":r=3;break;case"Fourth":r=4;break}u+=7*(r-1);return n.c(u)}else{n=new _a.c(n.e(),n.d(),_a.c.u(n.d(),n.e()));return n.c(_cc.e.c(t,n.q())*-1)}};_cc.cm=function(n,t,i,r){this.c=Function.createDelegate(this,this.j);_cc.cm.initializeBase(this);this.d=n;this.e=t;this.b()&&this.b().a()?this.h(_cc.Y.a(this.b(),i,r)):this.h(new _cc.bm(new _cc.q,i,null,i,r,""));this.apcl("RecurrenceDataObject",this.c);this.a.apcl("StartDate",this.c);this.a.apcl("EndDate",this.c);this.a.apcl("RecurrencePattern",this.c);this.a.apcl("TimeZoneId",this.c)};_cc.cm.prototype={d:null,e:null,a:null,h:function(n){if(this.a!==n){this.a=n;this.dQ("RecurrenceDataObject")}return n},f:function(n){if(this.a.a!==n){this.a.i(n);this.dU("RecurrencePattern","RecurrenceDataObject")}return n},b:function(){return this.d.F()},g:function(n){if(this.d.F()!==n){this.d.bk(n);this.dQ("Model")}return n},i:function(){return _cc.bm.a(this.a.p())},j:function(n,t){if(_cc.q.isInstanceOfType(this.a.a)||_cc.O.isInstanceOfType(this.a.a))this.g(null);else{var i=this.e.a();_cc.Y.d(this.a,i);this.g(i)}}};_cc.A=function(n,t,i){this.h=n;this.i=t;this.j=i};_cc.A.prototype={j:0,i:0,h:0,e:function(){return _u.c.BN},a:function(){var n=[_u.c.Cq,_u.c.DK,_u.c.x];return this.k(n)},d:function(){var n=[_u.c.Bb,_u.c.o,_u.c.By];return this.k(n)},c:function(n){return _cc.A.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i},b:function(){var n=0;this.h<=0?n|=4:this.i||(n|=2);return n},g:function(){var n=new _g.dM;n.c(this.h);n.j(this.i);n.h(_a.bM.toString(_a.c.P()));return n},f:function(){return new _cc.A(this.h,this.i)},k:function(n){_a.b.f(n.length,3,"Expected three weekly recurrence pattern strings");var t="";switch(this.h){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=n[2];break}return String.format(t,_cc.e.d(this.i,this.j),this.h)}};_cc.G=function(n,t){this.h=n;this.i=t;this.j=new _ca.h};_cc.G.prototype={j:null,i:0,h:0,e:function(){return _u.c.Cy},a:function(){return this.k(_u.c.CS)},d:function(){return this.k(_u.c.DT)},c:function(n){return _cc.G.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i},b:function(){var n=0;(0>=this.h||this.h>31)&&(n|=1);return n},g:function(){return new _g.dv(new _g.fq(this.h,this.j.a(this.i,!1)))},f:function(){return new _cc.G(this.h,this.i)},k:function(n){return String.format(n,this.j.a(this.i,!0),this.h)}};_cc.J=function(n,t,i){this.i=n;this.h=t;this.j=i;this.k=new _ca.h};_cc.J.prototype={k:null,j:0,i:"None",h:0,e:function(){return _u.c.CZ},a:function(){return this.l(_u.c.Bm)},d:function(){return this.l(_u.c.J)},c:function(n){return _cc.J.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i&&n.j===this.j},b:function(){var n=0;this.h||(n|=2);this.i==="None"&&(n|=16);return n},g:function(){var n=new _g.fk;n.g(this.k.a(this.j,!1));n.h(this.h);n.c(this.i);return n},f:function(){return new _cc.J(this.i,this.h,this.j)},l:function(n){return String.format(n,_cc.e.i(this.i),_cc.e.d(this.h),this.k.a(this.j,!0))}};var ISchedulingContext=function(){};ISchedulingContext.registerInterface("ISchedulingContext");var ISchedulingViewModel=function(){};ISchedulingViewModel.registerInterface("ISchedulingViewModel");var ISchedulingViewModelFactory=function(){};ISchedulingViewModelFactory.registerInterface("ISchedulingViewModelFactory");_cc.cP=function(){};_cc.cP.a=function(n){if(_js.d.a(n.EmailAddress)){n=_ff.g.a(n,!0,!0);n.EmailAddress=n.ItemId&&!_js.d.a(n.ItemId.Id)?"@"+n.ItemId.Id:String.format("{0}{1}{2}","@",n.Name,n.MailboxType)}return n};var ICalendarPickerNodeView=function(){};ICalendarPickerNodeView.registerInterface("ICalendarPickerNodeView");var IWeatherController=function(){};IWeatherController.registerInterface("IWeatherController");_cc.dc=function(){};_cc.dc.prototype={UltraDark:0,Dark:1,Normal:2,Medium:3,Light:4,UltraLight:5};_cc.dc.registerEnum("_cc.dc",!1);_cc.b=function(){};_cc.b.k=function(){return _cc.b.a(_fm.a.bU,"ms-fcl-ns-b")};_cc.b.u=function(){return _cc.b.a(_fm.a.cc,"ms-fcl-ns-b")};_cc.b.Q=function(){return _cc.b.a(_fm.a.bF,"ms-fcl-ns-b")};_cc.b.s=function(){return _cc.b.a(_fm.a.cw,"ms-fcl-ns-b")};_cc.b.w=function(){return _cc.b.a(_fm.a.cg,"ms-fcl-ns-b")};_cc.b.ba=function(){return _cc.b.a(_fm.a.cL,"ms-fcl-ns-b")};_cc.b.E=function(){return _cc.b.a(_fm.a.cj,"ms-fcl-ns-b")};_cc.b.O=function(){return _cc.b.a(_fm.a.cy,"ms-fcl-ns-b")};_cc.b.G=function(){return _cc.b.a(_fm.a.bO,"ms-fcl-ns-b")};_cc.b.o=function(){return _cc.b.a(_fm.a.bZ,"ms-fcl-ns-b")};_cc.b.A=function(){return _cc.b.a(_fm.a.bE,"ms-fcl-ns-b")};_cc.b.Y=function(){return _cc.b.a(_fm.a.cH,"ms-fcl-ns-b")};_cc.b.K=function(){return _cc.b.a(_fm.a.cq,"ms-fcl-ns-b")};_cc.b.S=function(){return _cc.b.a(_fm.a.bL,"ms-fcl-ns-b")};_cc.b.i=function(){return _cc.b.a(_fm.a.bT,"ms-fcl-ns-b")};_cc.b.W=function(){return _cc.b.a(_fm.a.bI,"ms-fcl-ns-b")};_cc.b.q=function(){return _cc.b.a(_fm.a.ca,"ms-fcl-ns-b")};_cc.b.M=function(){return _cc.b.a(_fm.a.k,"ms-fcl-ns-b")};_cc.b.c=function(){return _cc.b.a(_fm.a.bM,"ms-fcl-ns-b")};_cc.b.y=function(){return _cc.b.a(_fm.a.cn,"ms-fcl-ns-b")};_cc.b.C=function(){return _cc.b.a(_fm.a.ci,"ms-fcl-ns-b")};_cc.b.U=function(){return _cc.b.a(_fm.a.cF,"ms-fcl-ns-b")};_cc.b.I=function(){return _cc.b.a(_fm.a.R,"ms-fcl-ns-b")};_cc.b.m=function(){return _cc.b.a(_fm.a.bV,"ms-fcl-ns-b")};_cc.b.e=function(){return _cc.b.a(_fm.a.bN,"ms-fcl-ns-b")};_cc.b.g=function(){return _cc.b.a(_fm.a.S,"ms-fcl-ns-b")};_cc.b.l=function(){return _cc.b.a(_fm.a.bU,"ms-fcl-w-b")};_cc.b.v=function(){return _cc.b.a(_fm.a.cc,"ms-fcl-w-b")};_cc.b.R=function(){return _cc.b.a(_fm.a.bF,"ms-fcl-w-b")};_cc.b.t=function(){return _cc.b.a(_fm.a.cw,"ms-fcl-w-b")};_cc.b.x=function(){return _cc.b.a(_fm.a.cg,"ms-fcl-w-b")};_cc.b.bb=function(){return _cc.b.a(_fm.a.cL,"ms-fcl-w-b")};_cc.b.F=function(){return _cc.b.a(_fm.a.cj,"ms-fcl-w-b")};_cc.b.P=function(){return _cc.b.a(_fm.a.cy,"ms-fcl-w-b")};_cc.b.H=function(){return _cc.b.a(_fm.a.bO,"ms-fcl-w-b")};_cc.b.p=function(){return _cc.b.a(_fm.a.bZ,"ms-fcl-w-b")};_cc.b.B=function(){return _cc.b.a(_fm.a.bE,"ms-fcl-w-b")};_cc.b.Z=function(){return _cc.b.a(_fm.a.cH,"ms-fcl-w-b")};_cc.b.L=function(){return _cc.b.a(_fm.a.cq,"ms-fcl-w-b")};_cc.b.T=function(){return _cc.b.a(_fm.a.bL,"ms-fcl-w-b")};_cc.b.j=function(){return _cc.b.a(_fm.a.bT,"ms-fcl-w-b")};_cc.b.X=function(){return _cc.b.a(_fm.a.bI,"ms-fcl-w-b")};_cc.b.r=function(){return _cc.b.a(_fm.a.ca,"ms-fcl-w-b")};_cc.b.N=function(){return _cc.b.a(_fm.a.k,"ms-fcl-w-b")};_cc.b.d=function(){return _cc.b.a(_fm.a.bM,"ms-fcl-w-b")};_cc.b.z=function(){return _cc.b.a(_fm.a.cn,"ms-fcl-w-b")};_cc.b.D=function(){return _cc.b.a(_fm.a.ci,"ms-fcl-w-b")};_cc.b.V=function(){return _cc.b.a(_fm.a.cF,"ms-fcl-w-b")};_cc.b.J=function(){return _cc.b.a(_fm.a.R,"ms-fcl-w-b")};_cc.b.n=function(){return _cc.b.a(_fm.a.bV,"ms-fcl-w-b")};_cc.b.f=function(){return _cc.b.a(_fm.a.bN,"ms-fcl-w-b")};_cc.b.h=function(){return _cc.b.a(_fm.a.S,"ms-fcl-w-b")};_cc.b.b=function(){return _fm.b.a(_fm.a.da,"ms-fcl-tp-b",_fm.WebfontSizes.a.f)};_cc.b.a=function(n,t){return _fm.b.a(n,t,_fm.WebfontSizes.a.a)};_cc.a=function(n,t){this.j=[["#030507","#71C2EB","#C0E9FF","#D2EFFA","#E2F5FD","#EAF8FD"],["#176002","#29CE6B","#D4FCA7","#E3F8CD","#EAF8D1","#EFFADD"],["#AF4802","#FF9D3B","#FFDEC7","#FFE7DA","#FFEDE1","#FFF3EB"],["#484848","#A3A3A3","#E2E2E2","#EBEBEB","#EEEFEF","#F4F4F4"],["#6D5803","#D1C426","#FCFAA7","#FEF9C6","#FFFBDE","#FFFDE9"],["#026350","#13CEAA","#BDF9EA","#D3FBF0","#DFFDFF","#E7FDFF"],["#960269","#ED5DBA","#FFD7F7","#FDE5F9","#FBECF8","#FCF3FA"],["#633502","#A88D7B","#F1E2C8","#F5EADA","#F6ECDE","#F9F4ED"],["#6D011D","#F25561","#FCD2D2","#FCE0E0","#FFECEB","#FFF3F3"]];this.k=[["#0D5BC3","#0D5BC3","#0078D7","#4295DD","#DDF3FE","#ECF8FE"],["#246C2B","#246C2B","#298835","#589F61","#DCF1DE","#F1F9F2"],["#BA2402","#BA2402","#D83B01","#DE6346","#FDE5D3","#FEF4ED"],["#081C5D","#081C5D","#1E3698","#3557A0","#EFEAF6","#F4F6FB"],["#F59D09","#F59D09","#FFB900","#FDC655","#FBF4CF","#FDFAE7"],["#29655E","#29655E","#0B857D","#469D97","#D4F5F2","#ECFAF9"],["#B70480","#B70480","#E40089","#E744A1","#FBE4F1","#FDF3F9"],["#760009","#760009","#A80000","#B8383E","#FADFE3","#FDF2F4"],["#88027D","#88027D","#B4009E","#C145B0","#F4E4F4","#FAF2FB"]];this.l=[["#A6D1F5","#A6D1F5","#C1E9FE","#CAECFE","#DDF3FE","#ECF8FE"],["#87D28E","#87D28E","#B3E5B8","#C3E9C7","#DCF1DE","#F1F9F2"],["#FCAB73","#FCAB73","#FDC99D","#FDD4B3","#FDE5D3","#FEF4ED"],["#C0C0C0","#C0C0C0","#D7D7D7","#DFDFDF","#EEEEEE","#F7F7F7"],["#F4D07A","#F4D07A","#F8EA92","#F9EDAC","#FBF4CF","#FDFAE7"],["#4ADACC","#4ADACC","#9FEBE3","#B5EFE9","#D4F5F2","#ECFAF9"],["#F08CC0","#F08CC0","#F6B7DA","#F7C6E1","#FBE4F1","#FDF3F9"],["#CBA287","#CBA287","#DBBBA4","#E1C9B7","#EEE2D8","#F8F4F0"],["#F88C9B","#F88C9B","#F9A7B3","#F9B9C3","#FADFE3","#FDF2F4"]];this.g=n;this.i=t;this.b=this.g.a().q().Enabled};_cc.a.prototype={g:null,i:null,b:!1,e:function(){return this.i.a().bl.UseBrightCalendarColorThemeInOwa},a:function(n,t,i,r){n.css(t,this.c(i,r))},f:function(n,t,i,r){n.css("color",this.h(t,i,r))},c:function(n,t){var i=this.j;this.g.a().q().Enabled&&(i=this.e()?this.k:this.l);return n!==-1?i[n][t]:i[_cc.a.a][t]},h:function(n,t,i){return this.b?this.i.a().bl.UseBrightCalendarColorThemeInOwa?n===4?i?"#666666":"#212121":"#FFFFFF":i?"#666666":"#212121":this.c(n,t)},d:function(){var n=new(_a.gd.$$(_g.ft));if(this.b){n.e(0);n.e(5);n.e(1);n.e(3);n.e(8);n.e(6);n.e(7);n.e(2);n.e(4)}else for(var t=0;t<9;t++){var i=t;n.e(t)}return n},m:function(){var t=new Array(9);if(this.b)for(var n=0;n<9;n++){t[n++]=0;t[n++]=2;t[n++]=7;t[n++]=3;t[n++]=8;t[n++]=1;t[n++]=5;t[n++]=6;t[n++]=4}else for(var i=0;i<9;i++)t[i]=i;return t}};_cc.i=function(n,t,i,r){_cc.i.initializeBase(this,[n]);this.o=t;this.n=i;this.p=r};_cc.i.$$cctor=function(){_cc.i.a=new _cc.cl};_cc.i.prototype={o:null,n:null,p:null,i:null,f:null,j:0,h:null,k:null,a:"NoData",m:0,g:null,e:!1,b:function(n){if(this.j!==n){this.j=n;this.d();this.bj("CalendarColor")}return n},q:function(n){if(this.k!==n){this.k=n;this.d();this.bj("Category")}return n},r:function(n){if(this.e!==n){this.e=n;this.d()}return n},c:function(n){if(this.a!==n){this.a=n;this.bj("FreeBusy");this.E()&&!this.bL&&this.d()}return n},l:function(n){if(this.g!==n){this.g=n;this.h=this.g?this.o.f(this.g):null}return n},s:function(n,t,i,r,u,f){this.j=n;this.g=t;this.k=i;this.a=r;this.m=u;this.e=f;this.d()},J:function(){this.d();_js.c.prototype.J.call(this)},R:function(){_js.c.prototype.R.call(this);this.E()?this.d():this.h=null},d:function(){if(this.S()){this.i&&this.B.removeClass(this.i);if(this.a!=="NoData"){this.i=_cc.i.a.a(this.a,!this.e);this.B.addClass(this.i)}this.f&&this.B.css(this.f,"");this.m&&(this.B[0].style.height=this.m.toString()+"%");if(this.a!=="OOF"){this.f=this.a==="Free"?"border-color":"background-color";var n;var i,t;this.h&&(t=_h.c.b(this.k,this.h,i={val:n}),n=i.val,t)?this.p.d(this.B,this.f,n,this.e?2:1):this.n.a(this.B,this.f,this.j,this.e?2:1)}}}};_cc.cn=function(n,t){_cc.cn.initializeBase(this,[n]);this.b=t};_cc.cn.prototype={b:null,a:-1,c:function(n){if(this.a!==n){this.a=n;this.bj("CalendarColor");$a(n)||this.d()}return n},d:function(){if(this.a===-1){this.B.css("background-color","");return}this.b.a(this.B,"background-color",this.a,1)}};_cc.cN.registerClass("_cc.cN",_h.fO);_cc.U.registerClass("_cc.U");_cc.cO.registerClass("_cc.cO",_fm.k);_cc.P.registerClass("_cc.P",_js.x);CalendarCoreComponent.registerClass("CalendarCoreComponent",null,_a.iR);_cc.bz.registerClass("_cc.bz");_cc.bd.registerClass("_cc.bd",_a.by);_cc.bi.registerClass("_cc.bi");_cc.cX.registerClass("_cc.cX");_cc.bT.registerClass("_cc.bT",_a.by,_cc.db);_cc.bU.registerClass("_cc.bU");_cc.t.registerClass("_cc.t",_a.by);_cc.bV.registerClass("_cc.bV");_cc.bj.registerClass("_cc.bj",_a.by,ICalendarItemViewModel);_cc.K.registerClass("_cc.K");_cc.r.registerClass("_cc.r",_a.ea,_g.ICalendarTimePeriod);_cc.bt.registerClass("_cc.bt",null,_cc.da);_cc.S.registerClass("_cc.S",_a.by,_fm.l);_cc.by.registerClass("_cc.by");_cc.l.registerClass("_cc.l");_cc.l.a.registerClass("_cc.l.a");_cc.co.registerClass("_cc.co",null,_cc.cQ);_cc.bn.registerClass("_cc.bn",null,_cc.g,_cc.cQ);_cc.PerfTraceCTQCustomKeys.registerClass("_cc.PerfTraceCTQCustomKeys");_cc.PerfTraceCTQCustomKeys.Calendar.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar");_cc.PerfTraceCTQCustomKeys.Calendar.BirthdayCalendar.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.BirthdayCalendar");_cc.PerfTraceCTQCustomKeys.Calendar.ComposeCalendarItemViewModel.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.ComposeCalendarItemViewModel");_cc.PerfTraceCTQCustomKeys.Calendar.MeetingResponseViewModel.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.MeetingResponseViewModel");_cc.PerfTraceCTQCustomKeys.Calendar.MeetingFormsPerfMarkers.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.MeetingFormsPerfMarkers");_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSurface.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSurface");_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSearch.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSearch");_cc.PerfTraceCTQCustomKeys.Calendar.HolidayCalendars.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.HolidayCalendars");_cc.j.registerClass("_cc.j");_cc.bD.registerClass("_cc.bD",_cc.bZ.$$(_g.fs));_cc.bh.registerClass("_cc.bh",_h.dk.$$(_g.uU,_g.Eu),_cc.cV);_cc.n.registerClass("_cc.n",_h.ft);_cc.bE.registerClass("_cc.bE",_cc.bZ.$$(_g.mR));_cc.bF.registerClass("_cc.bF",_cc.bZ.$$(_g.cV));_cc.bG.registerClass("_cc.bG",_cc.bZ.$$(_g.cV));_cc.bq.registerClass("_cc.bq",_h.cA,_h.fi);_cc.cA.registerClass("_cc.cA",_cc.cd.$$(_g.hk,_g.oe));_cc.cB.registerClass("_cc.cB",_cc.bZ.$$(_g.va));_cc.L.registerClass("_cc.L",_h.cA,_h.fi);_cc.Q.registerClass("_cc.Q",_cc.cd.$$(_g.hk,_g.oe));_cc.cD.registerClass("_cc.cD",_cc.bZ.$$(_g.jU));_cc.ce.registerClass("_cc.ce",_cc.bZ.$$(_g.vc));_cc.M.registerClass("_cc.M",_h.dk.$$(_g.hp,_g.kG));_cc.cf.registerClass("_cc.cf",_cc.cd.$$(_g.wg,_g.Hy),_cc.cg);_cc.bK.registerClass("_cc.bK",_cc.bZ.$$(_g.fs));_cc.bL.registerClass("_cc.bL",_cc.bZ.$$(_g.mR));_cc.bN.registerClass("_cc.bN",_cc.bZ.$$(_g.tX));_cc.cE.registerClass("_cc.cE",_h.dk.$$(_g.yk,_g.on));_cc.bO.registerClass("_cc.bO",_cc.bZ.$$(_g.xr));_cc.H.registerClass("_cc.H",_h.di);_cc.bo.registerClass("_cc.bo",_h.t);_cc.cu.registerClass("_cc.cu",null,Sys.IDisposable);_cc.bB.registerClass("_cc.bB",_h.t);_cc.bp.registerClass("_cc.bp",_cc.bB);_cc.N.registerClass("_cc.N",_cc.bB);_cc.cv.registerClass("_cc.cv",null,Sys.IDisposable);_cc.cw.registerClass("_cc.cw",_js.x);_cc.w.registerClass("_cc.w",_js.x,_cc.cU,_cc.cT);_cc.cS.registerClass("_cc.cS",_a.jV,_g.Wl);CalendarsCache.registerClass("CalendarsCache",_cc.cS,ICalendarsCache,_js.z,_h.eC,_cc.h);CalendarsCache.b.registerClass("CalendarsCache.b");_cc.p.registerClass("_cc.p",_a.jV);_cc.bH.registerClass("_cc.bH");_cc.Z.registerClass("_cc.Z",_a.jV,_cc.bJ);_cc.z.registerClass("_cc.z",_cc.bB);_cc.ca.registerClass("_cc.ca");_cc.m.registerClass("_cc.m",_a.bR);_cc.cb.registerClass("_cc.cb");_cc.d.registerClass("_cc.d",_a.bR);_cc.br.registerClass("_cc.br");_cc.V.registerClass("_cc.V",_a.jV,_cc.u,_js.z);_cc.bM.registerClass("_cc.bM");_cc.bC.b.registerClass("_cc.bC.b");_cc.bX.registerClass("_cc.bX",_h.dY.$$(_g.cV));_cc.cR.registerClass("_cc.cR",_h.p);_cc.bA.registerClass("_cc.bA",_cc.cR);_cc.cp.registerClass("_cc.cp",_h.bg);_cc.cq.registerClass("_cc.cq",_cc.cR);_cc.cr.registerClass("_cc.cr",_h.fO);_cc.bY.registerClass("_cc.bY",_h.cA);_cc.bP.registerClass("_cc.bP",null,_h.eZ);_cc.bQ.registerClass("_cc.bQ",_cc.N);_cc.cG.registerClass("_cc.cG",null,_h.eZ);_cc.cH.registerClass("_cc.cH",_cc.cG);_cc.bR.registerClass("_cc.bR",_cc.cG,_h.dR,_h.eZ);_cc.bW.registerClass("_cc.bW");_cc.s.registerClass("_cc.s",_a.ea,_g.fc);_cc.bc.registerClass("_cc.bc",_a.bR);_cc.cj.registerClass("_cc.cj",_cc.cO);_cc.X.registerClass("_cc.X",_a.by);_cc.W.registerClass("_cc.W",_a.by);_cc.ck.registerClass("_cc.ck",null,_js.S);_cc.be.registerClass("_cc.be",null,_js.S);_cc.bk.registerClass("_cc.bk",null,_js.S);_cc.bf.registerClass("_cc.bf",null,_js.S);_cc.bg.registerClass("_cc.bg",null,_js.S);_cc.bl.registerClass("_cc.bl",null,_js.S);_cc.I.registerClass("_cc.I",_a.by,ILocationViewModel);_cc.cM.registerClass("_cc.cM",_y.bf);_cc.bw.registerClass("_cc.bw",null,ICalendarMailComposeConductorFactory);MeetingResponseEditorViewModel.registerClass("MeetingResponseEditorViewModel",_a.by,_y.fF,_a.jO,_js.z,Sys.IDisposable,IMeetingResponseEditorViewModel);_cc.f.registerClass("_cc.f",_a.by,IMeetingResponseViewModel);_cc.bx.registerClass("_cc.bx",null,IMeetingResponseViewModelFactory);_cc.C.registerClass("_cc.C",null,_cc.D,_y.fG);_cc.E.registerClass("_cc.E",null,_cc.D,_y.fG);_cc.F.registerClass("_cc.F",null,_cc.D,_y.fG);_cc.q.registerClass("_cc.q",null,_cc.D,_y.fG);_cc.O.registerClass("_cc.O",null,_cc.D,_y.fG);_cc.bm.registerClass("_cc.bm",_js.x);_cc.cm.registerClass("_cc.cm",_a.by);_cc.A.registerClass("_cc.A",null,_cc.D,_y.fG);_cc.G.registerClass("_cc.G",null,_cc.D,_y.fG);_cc.J.registerClass("_cc.J",null,_cc.D,_y.fG);_cc.a.registerClass("_cc.a");_cc.i.registerClass("_cc.i",_js.c);_cc.cn.registerClass("_cc.cn",_js.c);_cc.P.a=_a.a.w;CalendarCoreComponent.$$cctor();_cc.bd.a=_a.a.b;_cc.bT.a=_a.a.k;_cc.t.a=_a.a.k;_cc.t.b=!1;_cc.c.b=null;_cc.c.e=0;_cc.bj.a=_a.a.b;_cc.r.c=new _H("Recurrence",_g.bo,_cc.r);_cc.r.b=new _H("IsRecurringMaster",Boolean,_cc.r);_cc.r.d=new _H("Start",_a.c,_cc.r);_cc.r.a=new _H("End",_a.c,_cc.r);_cc.r.f=new _H("IsAllDayEventProperty",Boolean,_cc.r);_cc.r.$$cctor();this.b=!1;_cc.x.a.b=_a.a.s;_cc.x.c.b=_a.a.cC;_cc.j.b=_a.a.dE;_cc.j.f="ErrorCode";_cc.j.g="__type";_cc.j.e="responseCode";_cc.n.b=new _H("Item",_g.i,_cc.n);_cc.n.c=new _H("SendMeetingInvitations",_h.br,_cc.n);_cc.n.d=_cc.n.g();_cc.bq.a="HTML";_cc.L.b="HTML";_cc.Q.a=null;_cc.Q.$$cctor();_cc.M.a=new _H("Id",_h.T,_cc.M);_cc.M.b=new _H("CalendarItemCollection",_js.f,_cc.M);CalendarsCache.a=null;CalendarsCache.$$cctor();_cc.p.b=new _H("CalendarEntryModel",_g.ca,_cc.p);_cc.p.c=new _H("CalendarModel",_g.cO,_cc.p);_cc.p.e=new _H("MasterCategoryList",_g.bs,_cc.p);_cc.p.a=new _H("IsCalendarFolderConfigurationRetrieved",Boolean,_cc.p);_cc.p.d=new _H("IsValid",Boolean,_cc.p,!0);_cc.Z.a=null;_cc.Z.$$cctor();_cc.m.f=new _H("ItemId",_g.g,_cc.m);_cc.m.c=new _H("GroupId",String,_cc.m);_cc.m.d=new _H("GroupName",String,_cc.m);_cc.m.e=new _H("GroupType",_g.Af,_cc.m);_cc.m.b=new _H("Calendars",_ff.A.$$(_g.ca),_cc.m);_cc.m.$$cctor();_cc.d.p=new _H("Active",Boolean,_cc.d);_cc.d.g=new _H("BrowseUrl",String,_cc.d);_cc.d.j=new _H("ICalUrl",String,_cc.d);_cc.d.h=new _H("DisplayName",String,_cc.d);_cc.d.c=new _H("EmailAddress",_g.d,_cc.d);_cc.d.l=new _H("IsInsideOrganization",Boolean,_cc.d);_cc.d.b=new _H("CurrentDetailLevel",_cc.y,_cc.d,0);_cc.d.a=new _H("AllowedDetailLevels",_js.f,_cc.d);_cc.d.d=new _H("HandlerType",_cc.cF,_cc.d,0);_cc.d.k=new _H("ID",String,_cc.d);_cc.d.e=new _H("Id",String,_cc.d);_cc.d.i=new _H("FromPermissionsTable",Boolean,_cc.d);_cc.d.n=new _H("PermissionLevel",String,_cc.d,"FreeBusy");_cc.d.o=new _H("ReadOnly",Boolean,_cc.d);_cc.d.f=new _H("ViewPrivateAppointments",Boolean,_cc.d);_cc.d.m=new _H("IsSharingWithThisRecipientDisabled",Boolean,_cc.d);_cc.d.$$cctor();_cc.V.a=_a.a.cu;_cc.s.c=new _H("Start",_a.c,_cc.s);_cc.s.a=new _H("End",_a.c,_cc.s);_cc.s.b=new _H("IsAllDayEvent",Boolean,_cc.s);_cc.s.$$cctor();_cc.X.a=Object.keys(_g.ub.prototype);_cc.W.a=Object.keys(_g.ub.prototype);this.a=null;_cc.ba.$$cctor();_cc.I.b=[7,0];MeetingResponseEditorViewModel.a=_a.a.cC;_cc.f.a=_a.a.cC;_cc.a.a=0;_cc.i.a=null;_cc.i.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.core.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.core.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
