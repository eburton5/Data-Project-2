try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.desktop.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_i");_i.b=function(){};_i.b.h=function(){return _fm.e.a("conversations_showdeleted.png")};_i.b.b=function(){return _fm.e.a("conversations_hidedeleted.png")};_i.b.c=function(){return _fm.e.a("conversations_newestontop.png")};_i.b.d=function(){return _fm.e.a("conversations_oldestontop.png")};_i.b.e=function(){return _fm.e.a("readingpane_off.png")};_i.b.f=function(){return _fm.e.a("readingpane_onbottom.png")};_i.b.g=function(){return _fm.e.a("readingpane_onright.png")};_i.b.a=function(){return _fm.b.a(_fm.a.J,_fm.WebfontSizes.a.b,"owa-color-neutral-yellow")};_i.a=function(n,t,i,r,u){this.bs=Function.createDelegate(this,this.cE);this.bt=Function.createDelegate(this,this.cF);this.bp=Function.createDelegate(this,this.cC);this.bq=Function.createDelegate(this,this.cD);this.bl=Function.createDelegate(this,this.cv);this.bo=Function.createDelegate(this,this.cw);this.X=Function.createDelegate(this,this.cB);_i.a.initializeBase(this,[n]);this.a=t;this.cK(this.cm());this.k=i;this.H=r;this.J=!!u&&u.a().g().Enabled;this.bc=!!u&&u.a().l().Enabled||u.a().m().Enabled};_i.a.prototype={J:!1,bc:!1,a:null,p:!1,l:!1,r:!1,z:null,L:1,A:0,e:0,K:null,x:!1,o:0,bb:0,v:0,y:0,t:0,w:0,h:0,F:null,i:0,M:null,b:null,I:0,Y:null,k:null,d:!1,H:null,j:!1,Z:!1,m:!1,bm:function(){return 3},bv:function(){return this.a.e().bl.ReportJunkEmailEnabled},be:function(n){if(n!==this.o){this.o=n;this.dQ("ReportJunkOption")}return n},cK:function(n){if(this.z!==n){this.z=n;this.dQ("PivotOptions")}return n},bK:function(n){if(this.A!==n){this.A=n;this.cG();this.dQ("PivotSelectedOptionIndex")}return n},cL:function(n){if(this.L!==n){this.L=n;this.dQ("SelectedPivot")}return n},bI:function(n){if(n!==this.v){this.v=n;this.dQ("ListViewMessageFormat")}return n},bC:function(n){this.y=n;this.dQ("AutoSelectFirstMessage");return n},bD:function(n){if(n!==this.h){this.h=n;this.dQ("ConversationOrder")}this.cM(n);return n},bE:function(n){if(n!==this.F){this.F=n;this.dQ("ConversationOrderImage")}return n},bF:function(n){if(n!==this.i){this.i=n;this.dQ("HideDeletedItemsOption")}this.cP(n);return n},bM:function(n){if(n!==this.M){this.M=n;this.dQ("ShowOrHideDeletedItemsImage")}return n},bH:function(n){if(n!==this.t){this.t=n;this.dQ("ListViewClutterOption")}return n},bJ:function(n){if(n!==this.w){this.w=n;this.dQ("ListViewPreviewOption")}return n},bL:function(n){if(n!==this.e){this.e=n;this.dQ("ReadingPanePositionOption")}this.cN(n);return n},bd:function(n){if(n!==this.K){this.K=n;this.dQ("ReadingPanePositionImage")}return n},bB:function(n){this.x=n;this.dQ("ApplyRPPositionToAllFolders");return n},bG:function(n){if(n!==this.j){this.j=n;this.dQ("IsOptimizedForAccessibility")}return n},ci:function(){var n=this;return function(t){n.d||n.cs()}},ce:function(){var n=this;return function(t){n.d||n.co()}},cj:function(){var n=this;return function(t){n.d||n.ct()}},ck:function(){var n=this;return function(t){n.d||n.cu()}},cg:function(){var n=this;return function(t){n.d||n.cq()}},ch:function(){var n=this;return function(t){n.d||n.cr()}},cf:function(){var n=this;return function(t){n.d||n.cp()}},cJ:function(n){if(this.m!==n){this.m=n;this.dQ("OwaLightEnabled");this.dQ("OwaLightOptionDescription")}return n},cl:function(){return this.m?_nbs.a.BW:_nbs.a.jk},ca:function(n){n&&this.bK(2)},bj:function(){this.d=!0;this.cc();this.b=this.G();this.I=this.e;this.Y=this.a.b().h;this.Z=this.j;this.bb=this.o;this.l=!1;this.p=!1;this.r=!1;this.c(1);this.g=!1;this.d=!1},bZ:function(){var n=this.cd();var i=null;var r=null;this.c(3);if(this.x){this.a.a().Q(this.e);var f=this.a.b().h;for(var u in f){var t={key:u,value:f[u]};if(t.value.c!==3){t.value.k(3);this.a.b().j(t.value)}}i=_h.g.e(this.a.b().c(),OwaApplication.a,this.X,this.bl);_a.l.b(this.bw())}else if(this.I!==this.e){i=_h.g.e(this.a.b().c(),OwaApplication.a,this.X,this.bo);this.l=!0;_a.l.b(this.bw())}if(n){n.w(this.bq);n.v(this.bp);this.B.a(n);this.p=!0}this.m&&!n&&this.j!==this.a.a().bl.IsOptimizedForAccessibility&&(r=this.bA());this.bb!==this.o&&this.cO(this.o);n||i||r||this.N()},C:function(){this.by();this.bx();this.bz();SettingsPanelViewModelBase.prototype.C.call(this)},cD:function(n){var t=this.G();if(this.b.ConversationSortOrder!==t.ConversationSortOrder||this.b.HideDeletedItems!==t.HideDeletedItems){this.a.a().be(this.h);this.a.a().bw(this.i===1);this.k.a(_y.dN,new _y.dN);this.k.a(_h.bv,new _h.bv(9))}this.J&&!this.a.e().bl.PredictedActions&&t.ShowInferenceUiElements&&this.a.e().a(!0);this.p=!1;this.m&&this.j!==this.a.a().bl.IsOptimizedForAccessibility&&this.bA();this.N()},cB:function(n){this.l=!1;this.N()},cF:function(n){this.r=!1;this.N()},cC:function(n){this.p=!1;this.c(5);this.by()},cw:function(n){this.l=!1;this.c(5);this.bx()},cv:function(n){this.l=!1;this.c(5);this.cI()},cE:function(n){this.r=!1;this.c(5);this.bz()},N:function(){var n=!this.p&&!this.l&&!this.r;if(n){this.c(4);this.g=!0;this.n()&&this.n()()}},cm:function(){var n=[];Array.add(n,new _ff.h(_nbs.a.HI,1));Array.add(n,new _ff.h(_nbs.a.OM,2));Array.add(n,new _ff.h(_nbs.a.hi,0));this.bv()&&Array.add(n,new _ff.h(_nbs.a.HB,5));Array.add(n,new _ff.h(_nbs.a.Ct,4));return n},cG:function(){this.cL(this.z[this.A].a)},cn:function(n){if(this.b.ShowInferenceUiElements!==n.ShowInferenceUiElements){if(this.a.a().bl.ShowInferenceUiElements)this.H.t();else{this.H.s(2);this.cH()}return!0}return this.b.ShowSenderOnTopInListView!==n.ShowSenderOnTopInListView?!0:this.b.ShowPreviewTextInListView!==n.ShowPreviewTextInListView?!0:this.b.ConversationSortOrder!==n.ConversationSortOrder?!0:this.b.HideDeletedItems!==n.HideDeletedItems?!0:this.b.GlobalReadingPanePosition!==n.GlobalReadingPanePosition?!0:this.b.ShowFirstMessageOnSignIn!==n.ShowFirstMessageOnSignIn?!0:!1},G:function(){var n=new _g.fO;n.ShowInferenceUiElements=!this.t;n.ShowSenderOnTopInListView=!this.v;n.ShowFirstMessageOnSignIn=!this.y;n.ShowPreviewTextInListView=!this.w;n.ConversationSortOrder=this.h;n.HideDeletedItems=this.i===1;n.GlobalReadingPanePosition=this.x?this.e:this.a.a().bl.GlobalReadingPanePosition;return n},cb:function(n){this.a.a().T(n.ShowInferenceUiElements);this.a.a().V(n.ShowSenderOnTopInListView);this.a.a().U(n.ShowPreviewTextInListView);this.a.a().be(n.ConversationSortOrder);this.a.a().bw(n.HideDeletedItems);this.a.a().bC(n.ShowFirstMessageOnSignIn);this.a.a().Q(n.GlobalReadingPanePosition)},cc:function(){this.bH(this.a.a().bl.ShowInferenceUiElements?0:1);this.bI(this.a.a().bl.ShowSenderOnTopInListView?0:1);this.bC(this.a.a().bl.ShowReadingPaneOnFirstLoad?0:1);this.bJ(this.a.a().bl.ShowPreviewTextInListView?0:1);this.bL(_y.e.b(this.bV(),this.a));this.bB(this.bc?!0:!1);(this.a.a().n()==="ChronologicalNewestOnTop"||this.a.a().n()==="ChronologicalNewestOnBottom")&&this.bD(this.a.a().n());this.bF(this.a.a().bl.HideDeletedItems?1:0);this.bG(this.a.a().bl.IsOptimizedForAccessibility);this.cJ(this.a.e().bl.OWALightEnabled);this.a.a().bl.CheckForReportJunkDialog?this.be(this.a.a().bl.ReportJunkSelected?1:2):this.be(0)},cO:function(n){switch(n){case 0:this.a.a().j(!1);break;case 1:this.a.a().k(!0);this.a.a().j(!0);break;case 2:this.a.a().k(!1);this.a.a().j(!0);break}_h.g.a(this.a.a().v,OwaApplication.a)},cN:function(n){switch(n){case 2:this.bd(_i.b.f());break;case 0:this.bd(_i.b.e());break;case 1:this.bd(_i.b.g());break}},cM:function(n){switch(n){case"ChronologicalNewestOnBottom":this.bE(_i.b.d());break;case"ChronologicalNewestOnTop":this.bE(_i.b.c());break}},cP:function(n){switch(n){case 1:this.bM(_i.b.b());break;case 0:this.bM(_i.b.h());break}},cs:function(){this.a.a().V(!this.v)},co:function(){this.a.a().bC(!this.y)},ct:function(){this.a.a().U(!this.w)},cu:function(){this.bu(this.e)},bu:function(n){var t=this.a.b().g(this.bV());t.k(n);this.a.b().j(t)},cd:function(){var n=this.G();return this.cn(n)?new _c.bX(n):null},cq:function(){this.k.a(_y.bx,new _y.bx(this.h,this.i===1))},cr:function(){this.k.a(_y.bx,new _y.bx(this.h,this.i===1))},cp:function(){this.a.a().T(!this.t)},cH:function(){this.a.a().bh(!1);this.a.a().bk(!1);this.a.a().bi(!1);this.a.a().bu(!1);this.a.a().bj(!1);this.a.a().bv(!1);this.a.a().z(this.a.a().y()&-2);this.a.a().z(this.a.a().y()&-3);_h.g.a(this.a.a().v,OwaApplication.a)},by:function(){this.cb(this.b);var n=this.G();(this.b.ConversationSortOrder!==n.ConversationSortOrder||this.b.HideDeletedItems!==n.HideDeletedItems)&&this.k.a(_y.bx,new _y.bx(this.b.ConversationSortOrder,this.b.HideDeletedItems))},bx:function(){this.bu(this.I)},cI:function(){var i=this.Y;for(var r in i){var n={key:r,value:i[r]};var t=this.a.b().h[n.key];t.k(n.value.c);this.a.b().j(t)}},bz:function(){this.a.a().R(this.Z)},bA:function(){this.a.a().R(this.j);var n=_h.g.e(this.a.a().v,OwaApplication.a,this.bt,this.bs);this.r=!0;return n},bw:function(){var n=null;switch(this.e){case 0:n="VM.MailUsage.SetReadingPaneOff";break;case 1:n="VM.MailUsage.SetReadingPaneRight";break;case 2:n="VM.MailUsage.SetReadingPaneBottom";break}return n}};_i.e=function(n,t,i,r,u){this.z=Function.createDelegate(this,this.P);this.y=Function.createDelegate(this,this.o);this.x=Function.createDelegate(this,this.H);this.A=Function.createDelegate(this,this.Q);_i.e.initializeBase(this);_a.b.b(n,"eventAggregator");_a.b.b(t,"offlineBootStrapper");_a.b.b(i,"userAgent");_a.b.b(r,"bookmarker");this.c=n;this.j=t;this.l=i;this.g=r;this.w=u;this.t=new _C(this.A,_a.a.C);this.m=new _C(this.x,_a.a.C);this.B=new _C(this.y,_a.a.C);this.r=new _C(this.z,_a.a.C);this.a=1;this.b=0;this.d=!1;this.e=!1;this.E(!0)};_i.e.prototype={l:null,g:null,c:null,j:null,w:null,h:null,p:null,B:null,m:null,r:null,t:null,a:0,b:0,d:!1,e:!1,k:!1,i:!1,E:function(n){if(this.i!==n){this.i=n;this.dQ("IsProvisioning")}return n},K:function(){return this.l.b()},J:function(){return this.l.h()?_nbs.a.bu:_nbs.a.mk},L:function(){return this.k?_nbs.a.Gb:_nbs.a.IX},F:function(n){if(this.e!==n){this.e=n;this.dQ("ShowAbortProvisionInfo")}return n},v:function(n){if(this.d!==n){this.d=n;this.dQ("HideNextButton")}return n},R:function(n){if(this.b!==n){this.b=n;this.dQ("ComputerPrivacyMode");this.b===1?this.G():this.I()}return n},br:function(){return this.p},ba:function(n){this.p=n;return n},n:function(){return this.h},f:function(n){this.h=n;return n},bn:function(){return!1},q:function(){return null},bm:function(){return 3},D:function(n){if(this.a!==n){this.a=n;this.a===4&&this.v(!0);this.dQ("CurrentStep");this.dQ("StepInfo")}return n},M:function(){return String.format(_nbs.a.By,this.a,4)},o:function(){this.h();this.c.a(_a.cz,new _a.cz);this.E(!1)},Q:function(){_js.Trace.logInfo(_a.a.C,"OfflineSettingProvision is invoking OK");this.o()},H:function(){_js.Trace.logInfo(_a.a.C,"OfflineSettingProvision is cancelling offline provision");this.o();if(this.a>1){this.C(!1);this.j.m(_g.j.a,window.location)}},P:function(){_js.Trace.logInfo(_a.a.C,"OfflineSettingProvision is invoking next");switch(this.a){case 1:this.N();break;case 3:this.C(!1);break;default:break}this.k?this.D(4):this.D(this.a+1)},G:function(){this.v(!0);this.F(!0)},I:function(){this.v(!1);this.F(!1)},N:function(){var t=this,n=this;this.j.A(_g.j.a,null,!0,_js.g.a(),"Mouse",function(n){_g.j.h(n);t.c.a(_a.cM,new _a.cM(!0))},function(t){_js.Trace.logError(_a.a.h,"Failed to install offline components. {0}",t);if(n.i){n.k=!0;n.dQ("LastStepInfo")}else{var i=new _a.o([_nbs.a.Gb],1,null);n.c.a(_a.o,i)}});this.g.b(this.w)},C:function(n){this.g.a(n)}};_i.d=function(n,t,i,r,u,f,e,o,s){this.A=Function.createDelegate(this,this.I);this.z=Function.createDelegate(this,this.F);this.B=Function.createDelegate(this,this.J);_i.d.initializeBase(this);_a.b.b(n,"eventAggregator");_a.b.b(t,"offlineBootStrapper");_a.b.b(r,"userAgent");_a.b.b(u,"bookmarker");_a.b.b(i,"owaShell");this.e=n;this.c=t;this.m=r;this.o=u;this.y=f;this.k=i;this.w=e;this.x=o;this.r=s;this.v=new _C(this.B,_a.a.C);this.p=new _C(this.z,_a.a.C);this.t=new _C(this.A,_a.a.C)};_i.d.prototype={k:null,e:null,c:null,m:null,o:null,y:null,x:null,w:null,r:null,i:null,h:null,j:0,b:0,v:null,p:null,t:null,a:null,d:null,l:0,g:0,br:function(){return this.h},ba:function(n){this.h=n;return n},n:function(){return this.i},f:function(n){this.i=n;return n},bn:function(){return!1},q:function(){return null},bm:function(){return 3},E:function(n){if(this.b!==n){this.b=n;this.dQ("CurrentOfflinEnabledStatus");this.dQ("ShowOptOutWarningInfo")}return n},G:function(){return!this.b&&this.c.r()>0},L:function(n){if(n!==this.a){this.a=n;this.dQ("OfflineFoldersViewModel")}return n},M:function(n){if(this.d!==n){this.d=n;this.dQ("PivotOptions")}return n},N:function(n){if(this.g!==n){this.g=n;this.K();this.dQ("PivotSelectedOptionIndex")}return n},P:function(n){if(this.l!==n){this.l=n;this.dQ("SelectedPivot")}return n},C:function(){this.i()},H:function(){var n=[];Array.add(n,new _ff.h(_nbs.a.PG,0));Array.add(n,new _ff.h(_nbs.a.MY,1));return n},K:function(){this.P(this.d[this.g].a)},I:function(){this.j=this.c.e.b()?1:0;this.E(this.j);if(this.c.e.a()){this.a||this.L(new _d.A(this.k,_nbs.a.MY,this.e,this.r,this.m,this.w,this.h,this.x));this.a.E();this.d||this.M(this.H())}},J:function(){_js.Trace.logInfo(_a.a.C,"OfflineSettings Invoking OK");this.C();if(this.b!==this.j)if(this.b===1){var n=new _i.e(this.e,this.c,this.m,this.o,this.y);this.k.d(n)}else this.c.m(_g.j.a,window.location);else this.D();this.a&&this.a.bH()},F:function(){this.C();this.a&&this.a.E();this.D()},D:function(){this.e.a(_a.cz,new _a.cz)}};function SettingsPanelFactory(n,t,i,r,u,f,e,o,s){this.g=n;this.f=t;this.e=i;this.m=r;this.j=u;this.h=o;this.i=s;this.k=f;this.l=e}SettingsPanelFactory.prototype={g:null,f:null,e:null,m:null,j:null,k:null,l:null,h:null,i:null,d:function(){return new _i.c(this.g,this.f,this.e)},a:function(){return new _i.a(this.g,this.f,this.e,this.j,this.h)},b:function(n,t,i,r){return new _i.d(this.e,n,t,this.m,i,r,this.k,this.l,this.h)},c:function(){return new _i.f(this.f,this.i)}};function SettingsPanelViewModelBase(n){this.bQ=Function.createDelegate(this,this.cR);this.bR=Function.createDelegate(this,this.cS);this.bS=Function.createDelegate(this,this.cT);this.bP=Function.createDelegate(this,this.bj);this.bN=Function.createDelegate(this,this.C);this.bT=Function.createDelegate(this,this.bZ);this.bO=Function.createDelegate(this,this.cQ);SettingsPanelViewModelBase.initializeBase(this);this.B=n;this.bf=new _C(this.bO,_a.a.h);this.bk=new _C(this.bT,_a.a.h);this.P=new _C(this.bN,_a.a.h);this.S=new _C(this.bP,_a.a.h)}SettingsPanelViewModelBase.prototype={B:null,bh:null,bg:null,bf:null,bk:null,P:null,S:null,bi:null,bW:!1,T:0,g:!1,E:null,D:null,Q:null,R:null,cU:function(){return this.S},bV:function(){return this.bi},U:function(n){this.bi=n;return n},V:function(n){this.bW=n;this.ca(n);return n},c:function(n){if(this.T!==n){this.T=n;this.dQ("Status")}return n},bm:function(){return 2},q:function(){return this.bS},br:function(){return this.bh},ba:function(n){this.bh=n;return n},n:function(){return this.bg},f:function(n){this.bg=n;return n},bn:function(){return!1},W:function(n){this.E=n;return n},cz:function(){},cx:function(){if(this.E){_a.d.a(this.E);this.E=null}},cA:function(){},cy:function(){if(this.D){_a.d.a(this.D);this.D=null}},bU:function(){return null},bY:function(n){},C:function(){this.g=!0;this.n()&&this.n()()},bX:function(n){},ca:function(n){},bZ:function(){var n=this.bU();if(n){this.c(3);n.w(this.bR);n.v(this.bQ);this.B.a(n)}else{this.g=!0;this.n()()}},cS:function(n){this.c(4);this.bY(n);this.g=!0;this.n()()},cR:function(n){this.c(5);this.bX(n)},cQ:function(){this.Q&&this.R&&(this.D=_a.d.b(this.Q,this.R));this.g=!0;this.n()()},cT:function(n,t){return!this.g}};_i.c=function(n,t,i){this.m=Function.createDelegate(this,this.p);this.o=Function.createDelegate(this,this.v);_i.c.resolveInheritance();this.a=this.cU;_i.c.initializeBase(this,[n]);var r=t.j().DefaultTheme;_js.d.b(r)&&(r="base");this.e=t.a().bl.ThemeStorageId;_js.d.b(this.e)&&(this.e=r);this.k=i;this.Q=_a.a.h;this.R="ThemesPanelClose"};_i.c.prototype={k:null,e:null,h:null,j:null,l:null,i:null,d:null,b:null,y:function(n){if(this.h!==n){this.h=n;this.dQ("ThemesList")}return n},w:function(n){if(this.j!==n){this.j=n;this.dQ("CssPaths")}return n},x:function(n){if(this.l!==n){this.l=n;this.dQ("ThemePath")}return n},t:function(n){if(this.i!==n){this.i=n;this.dQ("SelectedThemeId");this.k.a(_a.cT,new _a.cT(this.i))}return n},r:function(n){if(this.e!==n){this.e=n;this.dQ("SavedThemeId")}return n},bj:function(){this.d=_a.d.b(_a.a.h,"ThemesLoad");this.c(0);this.g=!1;var n=new _c.T;n.w(this.o);n.v(this.m);this.B.a(n)},bU:function(){this.b=_a.d.b(_a.a.h,"ThemesSave");return new _c.X(this.i)},bY:function(n){this.r(n.a);if(this.b){var t=new _a.r;t.b("T",n.a);this.b.l=n.B();this.b.j=t.toString();_a.d.a(this.b);this.b=null}},C:function(){SettingsPanelViewModelBase.prototype.C.call(this);this.k.a(_a.cT,new _a.cT(this.e))},bX:function(n){if(this.b){this.b.l=n.B();this.b.k=n.t?n.t.toString():"unknown";_a.d.a(this.b);this.b=null}},v:function(n){this.c(1);var r=!1;if(!$a(n)){var t=n.a;this.w(t.CssPaths);this.x(t.ThemePath);this.y(t.Themes);($a(this.h)||!this.h.length)&&this.p(n);for(var i=0;i<this.h.length;i++)if(this.h[i].FolderName===this.e){r=!0;break}}r||this.r("base");this.t(this.e);if(this.d){this.d.l=n.B();_a.d.a(this.d);this.d=null}},p:function(n){this.c(2);if(this.d){this.d.l=n.B();this.d.k=n.t?n.t.toString():"unknown";_a.d.a(this.d);this.d=null}}};_i.f=function(n,t){this.A=Function.createDelegate(this,this.G);this.B=Function.createDelegate(this,this.K);this.z=Function.createDelegate(this,this.F);this.D=Function.createDelegate(this,this.M);this.C=Function.createDelegate(this,this.L);_i.f.initializeBase(this);this.b=new _i.g;this.a=n;this.v=t;this.w=new _C(this.C,_a.a.g);this.x=new _C(this.D,_a.a.g);this.k=new _C(this.z,_a.a.g);this.r=new _C(_a.j.c,_a.a.g);this.t=new _C(this.B,_a.a.g);this.l=new _C(this.A,_a.a.g)};_i.f.prototype={a:null,v:null,w:null,x:null,k:null,r:null,t:null,l:null,e:!1,g:!1,d:!1,b:null,y:null,m:null,h:!1,i:null,p:null,I:function(){return _a.j.l()?null:_i.b.a()},J:function(){return _a.j.l()?String.format(_nbs.a.gd,_a.j.i()):String.format(_nbs.a.bx,_a.j.i())},H:function(){return _a.j.l()?_u.R.PB:_u.R.fk},br:function(){return this.p},ba:function(n){this.p=n;return n},n:function(){return this.i},f:function(n){this.i=n;return n},bn:function(){return!1},q:function(){return null},bm:function(){return 3},P:function(n){if(this.e!==n){this.e=n;this.dQ("ForceEncryptMessage")}return n},Q:function(n){if(this.g!==n){this.g=n;this.dQ("ForceSignMessage")}return n},N:function(n){if(this.d!==n){this.d=n;this.dQ("AllowUserChoiceOfSigningCertificate")}return n},c:function(n){if(this.h!==n){this.h=n;this.dQ("IsBusy")}return n},o:function(){this.i()},L:function(){this.c(!0);if(this.a.bl.SmimeAdminSettings){this.P(this.a.bl.SmimeAdminSettings.AlwaysEncrypt);this.Q(this.a.bl.SmimeAdminSettings.AlwaysSign);this.N(this.a.bl.SmimeAdminSettings.AllowUserChoiceOfSigningCertificate)}this.b.r(this.e,this.g,this.d);this.b.m(this.a.a().bl.SmimeEncrypt);this.b.p(this.a.a().bl.SmimeSign);this.b.l(!this.a.a().bl.ManuallyPickCertificate);this.b.n(this.a.a().bl.SigningCertificateSubject);this.b.o(this.a.a().bl.SigningCertificateId);this.y=this.b.q();this.c(!1)},E:function(n,t){if(n){(!this.e||t)&&this.a.a().bG(n.i());(!this.g||t)&&this.a.a().bH(n.k());if(this.d||t){this.a.a().by(!n.a);if(!n.a||t){this.a.a().bF(n.j());this.a.a().bE(n.e)}}}t&&this.a.a().v.f()},M:function(){if(!this.h){_js.Trace.logInfo(_a.a.g,"SmimeSettings Invoking OK");this.c(!0);this.E(this.b,!1);var t=this,n=this;var i=_h.g.e(this.a.a().v,OwaApplication.a,function(){t.c(!1);t.o()},function(t){n.c(!1);n.j(_nbs.a.MO);_a.j.j(t.t,"Failed to save S/MIME settings.")});if(!i){this.c(!1);this.o();return}}},F:function(){this.E(this.y,!0);this.o()},G:function(){if(!this.h){var n=this;_a.j.b.f(null,function(t){var r=JsonParser.deserialize(t);if(r.ErrorCode){n.j(_u.R.BY);return}n.c(!0);n.m=r.Data;var i=new _h.cl(200,n.m,!1);i.w(function(){if(i.A.IsValid){n.b.n(_a.j.x(i.A.Subject));n.b.o(i.A.SubjectKeyIdentifier)}else{_js.Trace.logInfo(_a.a.g,"The chosen cert can't be used for signing.");n.j(_u.R.aU)}});i.v(function(t){_a.j.j(t.t,"Unabled to verify the chosen cert.");n.j(_u.R.Ng)});i.z(function(){n.c(!1)});OwaApplication.a.a(i)})}},K:function(){this.v.a(9)},j:function(n){_a.M.a(n,0)}};_i.g=function(){_i.g.initializeBase(this)};_i.g.prototype={f:!1,g:!1,h:!1,c:!1,d:!1,b:null,e:null,a:!1,i:function(){return this.c||this.f},m:function(n){if(this.c!==n){this.c=n;this.bj("EncryptMessage")}return n},k:function(){return this.d||this.g},p:function(n){if(this.d!==n){this.d=n;this.bj("SignMessage")}return n},l:function(n){if(this.a!==n){this.a=n;this.bj("AutoChooseCert")}return n},j:function(){return _js.d.a(this.b)?_u.P.H:this.b},n:function(n){if(this.b!==n){this.b=n;this.bj("SigningCertSubject")}return n},o:function(n){if(this.e!==n){this.e=n;this.bj("SigningCertSubjectKeyId")}return n},r:function(n,t,i){this.f=n;this.g=t;this.h=i},q:function(){var n=new _i.g;n.f=this.f;n.g=this.g;n.h=this.h;n.c=this.c;n.d=this.d;n.a=this.a;n.b=this.b;n.e=this.e;return n}};function DesktopViewModelsComponent(){}DesktopViewModelsComponent.$$cctor=function(){_a.p.a().a(DesktopViewModelsComponent)};DesktopViewModelsComponent.prototype={a:function(n,t,i){var u=this;n.b(SettingsPanelFactory,function(){return new SettingsPanelFactory(n.a(_a.q),n.a(_g.a),n.a(_ff.c),n.a(_a.UserAgent),n.a(IInferenceTracker),n.c(ISyncFolderSettingProcessor),n.a(_js.k),n.a(_a.h),n.a(IModuleHelpProvider))}).b(ISettingsPanelFactory).a();var r=this;n.b(_i.c,function(){return new _i.c(n.a(_a.q),_g.a.a(),n.a(_ff.c))}).b(IThemesViewModel)},b:function(){return null}};SettingsPanelViewModelBase.registerClass("SettingsPanelViewModelBase",ISettingsPanelViewModelBase,_y.be);_i.a.registerClass("_i.a",SettingsPanelViewModelBase);_i.e.registerClass("_i.e",_a.by,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable);_i.d.registerClass("_i.d",_a.by,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable);SettingsPanelFactory.registerClass("SettingsPanelFactory",null,ISettingsPanelFactory);_i.c.registerClass("_i.c",SettingsPanelViewModelBase,IThemesViewModel,_js.z);_i.f.registerClass("_i.f",_a.by,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable);_i.g.registerClass("_i.g",_js.x);DesktopViewModelsComponent.registerClass("DesktopViewModelsComponent",null,_a.iR);DesktopViewModelsComponent.$$cctor();
window.scriptsLoaded['microsoft.owa.desktop.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.desktop.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
