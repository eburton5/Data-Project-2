try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.people.core.js'] = (new Date()).getTime();
Type.registerNamespace("_pc");_pc.m=function(){};_pc.m.prototype={ComposeForms:0,PeopleModule:1,HoverCard:2,OwaOptionPage:3,MailSearchSuggestion:4,ContactManualLinking:5,BrowseInMailbox:6,BrowseInDirectory:7,RecipientCache:8,SeekInMailbox:9,ReloadInMailbox:10,PeopleIKnow:11};_pc.m.registerEnum("_pc.m",!1);_pc.w=function(){};_pc.w.registerInterface("_pc.w");_pc.n=function(){};_pc.n.registerInterface("_pc.n");_pc.e=function(n,t,i,r){_pc.e.initializeBase(this);this.c=n;this.h=t;this.g=i;this.f=r};_pc.e.a=function(n){_a.b.a(n,"personaId");return new _pc.e(n,null,null,null)};_pc.e.b=function(n,t,i){_a.b.a(n,"personaId");return new _pc.e(n,t,null,i)};_pc.e.c=function(n){_a.b.a(n,"emailAddress");_a.b.d(_a.D.a(n.EmailAddress),"GetPersona should be called with valid emailAddress: "+n.EmailAddress);return new _pc.e(null,null,n,null)};_pc.e.prototype={c:null,g:null,h:null,a:null,d:8,e:!1,f:null,s:function(n){var i=new _g.kj;if(this.c){var r=new _g.g(this.c.Id);r.ChangeKey=this.c.ChangeKey;i.PersonaId=r;$a(this.f)||(i.ParentFolderId=new _g.R(this.f))}else i.EmailAddress=this.g;var u=new _g.pw(this.y());u.Body=i;var t=new _g.Gw(this.x);t.hasGALComponent=!_js.d.a(this.h);t.actionName=_js.d.c("{0}_{1}",this.e?"PersonaCard":"HoverCard",_bc.m.toString(this.d));t.explicitLogonUser=this.J;n.bQ(u,t,this.r,this.q)},cp:function(n){var t=_js.e.s(_a.a.cn,2,"GetPersona_ProcessResponseMessage");this.a=_pc.a.c(n.Persona,3);_js.e.e(t)}};_pc.h=function(n,t,i,r,u,f){_pc.h.initializeBase(this);_pc.h.b(n,t,i,r);this.a=n;this.f=i;this.e=t;this.c=r;this.i=u;this.k=f};_pc.h.b=function(n,t,i,r){if(!n&&(!i||_js.d.a(i.EmailAddress))&&_js.d.a(t))throw Error.argumentUndefined("itemId, emailAddress or adObjectId","At least one of the three - itemId, emailAddress or adObjectId have to be specified");_a.b.b(r,"range")};_pc.h.a=function(n){var t=null;$a(n.a())||n.G()||$a(n.a().ItemId)||_js.d.a(n.a().ItemId.Id)||(t=n.a().ItemId);t||(t=n.f());return t};_pc.h.prototype={f:null,a:null,e:null,c:null,n:null,l:null,m:null,j:null,g:0,i:0,h:null,k:!1,d:null,s:function(n){var i=new _g.V("Beginning");i.MaxEntriesReturned=this.c.b;i.Offset=this.c.a;if(this.k){var r=new _g.Fq(this.x);r.explicitLogonUser=this.J;var t;var u=(t=new _g.oY,t.ItemId=this.a?new _g.g(this.a.Id):null,t.AdObjectId=this.e,t.EmailAddress=this.f,t.Paging=i,t.ResultSet=this.i,t.ParentFolderId=new _g.R(this.d),t);n.bB(u,r,this.r,this.q)}else n.bA(this.a?new _g.g(this.a.Id):null,this.e,this.f,i,this.i,null,this.r,this.q)},cz:function(n,t,i){try{this.g=n.MembersCount;this.l=this.o(n.Members);this.n=this.o(n.Owners);this.m=n.Notes;this.j=n.Description;this.h=n.PersonaId}catch(r){i(r);return}t()},o:function(n){if(!n||!n.length)return[];for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=_pc.a.c(n[t],2);return i}};_pc.k=function(n){_pc.k.initializeBase(this,[n]);this.dI(3);n||(n=new _g.gZ);this.d(n)};_pc.k.$$cctor=function(){_a.i.d(_pc.k,_g.gZ,function(n){return new _pc.k(n)})};_pc.a=function(n,t,i){this.fW=Function.createDelegate(this,this.gX);this.cW=this.dM;_pc.a.initializeBase(this,[!0,null,i]);this.di=new _g.iA(n||new _g.bU);this.di.O(this.fW);t&&this.cG();this.gU("LastCommaFirst")};_pc.a.l=function(){if(!_pc.a.a){_pc.a.a={};_pc.a.a.PersonaId="PersonaId";_pc.a.a.PersonaTypeString="PersonaType";_pc.a.a.PersonaObjectStatusString="PersonaObjectStatus";_pc.a.a.CreationTimeString="CreationTime";_pc.a.a.IsFavorite="IsFavorite";_pc.a.a.EffectiveRights="PublicFolderEffectiveRights";_pc.a.a.DisplayName="DisplayName";_pc.a.a.FileAs="FileAs";_pc.a.a.FileAsId="FileAsId";_pc.a.a.DisplayNamePrefix="DisplayNamePrefix";_pc.a.a.GivenName="GivenName";_pc.a.a.DisplayNameFirstLast="DisplayNameFirstLast";_pc.a.a.DisplayNameFirstLastSortKey="DisplayNameFirstLastSortKey";_pc.a.a.DisplayNameFirstLastHeader="DisplayNameFirstLastHeader";_pc.a.a.DisplayNameLastFirst="DisplayNameLastFirst";_pc.a.a.DisplayNameLastFirstSortKey="DisplayNameLastFirstSortKey";_pc.a.a.DisplayNameLastFirstHeader="DisplayNameLastFirstHeader";_pc.a.a.MiddleName="MiddleName";_pc.a.a.Surname="Surname";_pc.a.a.Generation="Generation";_pc.a.a.Nickname="Nickname";_pc.a.a.Alias="Alias";_pc.a.a.YomiFirstName="YomiFirstName";_pc.a.a.YomiCompanyName="YomiCompanyName";_pc.a.a.YomiLastName="YomiLastName";_pc.a.a.Title="Title";_pc.a.a.Department="Department";_pc.a.a.CompanyName="CompanyName";_pc.a.a.CompanyNameSortKey="CompanyNameSortKey";_pc.a.a.Location="Location";_pc.a.a.EmailAddress="EmailAddress";_pc.a.a.EmailAddresses="EmailAddresses";_pc.a.a.PhoneNumber="PhoneNumber";_pc.a.a.ImAddress="ImAddress";_pc.a.a.HomeCity="HomeCity";_pc.a.a.HomeCitySortKey="HomeCitySortKey";_pc.a.a.WorkCity="WorkCity";_pc.a.a.WorkCitySortKey="WorkCitySortKey";_pc.a.a.RelevanceScore="RelevanceScore";_pc.a.a.AttributionsArray="Attributions";_pc.a.a.DisplayNamesArray="DisplayNames";_pc.a.a.FileAsesArray="FileAses";_pc.a.a.FileAsIdsArray="FileAsIds";_pc.a.a.DisplayNamePrefixesArray="DisplayNamePrefixes";_pc.a.a.GivenNamesArray="GivenNames";_pc.a.a.MiddleNamesArray="MiddleNames";_pc.a.a.SurnamesArray="Surnames";_pc.a.a.GenerationsArray="Generations";_pc.a.a.NicknamesArray="Nicknames";_pc.a.a.InitialsArray="Initials";_pc.a.a.YomiCompanyNamesArray="YomiCompanyNames";_pc.a.a.YomiFirstNamesArray="YomiFirstNames";_pc.a.a.YomiLastNamesArray="YomiLastNames";_pc.a.a.BusinessPhoneNumbersArray="BusinessPhoneNumbers";_pc.a.a.BusinessPhoneNumbers2Array="BusinessPhoneNumbers2";_pc.a.a.HomePhonesArray="HomePhones";_pc.a.a.HomePhones2Array="HomePhones2";_pc.a.a.MobilePhonesArray="MobilePhones";_pc.a.a.MobilePhones2Array="MobilePhones2";_pc.a.a.AssistantPhoneNumbersArray="AssistantPhoneNumbers";_pc.a.a.CallbackPhonesArray="CallbackPhones";_pc.a.a.CarPhonesArray="CarPhones";_pc.a.a.HomeFaxesArray="HomeFaxes";_pc.a.a.OrganizationMainPhonesArray="OrganizationMainPhones";_pc.a.a.OtherFaxesArray="OtherFaxes";_pc.a.a.OtherTelephonesArray="OtherTelephones";_pc.a.a.OtherPhones2Array="OtherPhones2";_pc.a.a.PagersArray="Pagers";_pc.a.a.RadioPhonesArray="RadioPhones";_pc.a.a.TelexNumbersArray="TelexNumbers";_pc.a.a.TTYTDDPhoneNumbersArray="TtyTddPhoneNumbers";_pc.a.a.WorkFaxesArray="WorkFaxes";_pc.a.a.Emails1Array="Emails1";_pc.a.a.Emails2Array="Emails2";_pc.a.a.Emails3Array="Emails3";_pc.a.a.BusinessHomePagesArray="BusinessHomePages";_pc.a.a.SchoolsArray="Schools";_pc.a.a.PersonalHomePagesArray="PersonalHomePages";_pc.a.a.OfficeLocationsArray="OfficeLocations";_pc.a.a.ImAddressesArray="ImAddresses";_pc.a.a.BusinessAddressesArray="BusinessAddresses";_pc.a.a.HomeAddressesArray="HomeAddresses";_pc.a.a.OtherAddressesArray="OtherAddresses";_pc.a.a.TitlesArray="Titles";_pc.a.a.DepartmentsArray="Departments";_pc.a.a.CompanyNamesArray="CompanyNames";_pc.a.a.ManagersArray="Managers";_pc.a.a.AssistantNamesArray="AssistantNames";_pc.a.a.ProfessionsArray="Professions";_pc.a.a.SpouseNamesArray="SpouseNames";_pc.a.a.ChildrenArray="Children";_pc.a.a.HobbiesArray="Hobbies";_pc.a.a.WeddingAnniversariesLocalArray="WeddingAnniversariesLocal";_pc.a.a.BirthdaysLocalArray="BirthdaysLocal";_pc.a.a.LocationsArray="Locations";_pc.a.a.ADObjectId="GALContactGuid"}return _pc.a.a};_pc.a.c=function(n,t){_a.b.b(n,"personaServiceObject");var i=new _pc.a(null,!0,null);i.dN(n);i.dj(t);return i};_pc.a.j=function(){var n=new _pc.a(null,!0,null);n.de(_h.k.f());return n};_pc.a.h=function(n,t,i,r){var u=new _pc.a(n,i,r);u.gw(t);return u};_pc.a.m=function(n){if($a(n))throw Error.argumentNull("displayName");var t=_pc.a.j();t.dj(1);t.df(1);t.cP(n);return t};_pc.a.k=function(n){if($a(n))throw Error.argumentNull("recipient");if($a(n.Mailbox))throw Error.argumentNull("recipient mailbox");var t=_h.k.a(n.Mailbox);t.dh();return _pc.a.d(t)};_pc.a.b=function(n){var t=_h.k.a(n);t.dh();return _pc.a.d(t)};_pc.a.d=function(n){if($a(n))throw Error.argumentNull("basePersona");if(_pc.a.isInstanceOfType(n))return n;var t=new _pc.a(null,!0,null);n.f()&&t.de(n.f());if(n.a()){t.cH(n.a());t.gn([t.a()]);t.bT(new(_bc.S.$$(_g.d)));t.j().g(n.a(),"0")}n.c()&&t.cP(n.c());if(n.g()){t.fs(n.g());t.cc(new(_bc.S.$$(String)));t.K().g(t.g(),"0")}t.df(n.b());t.M(n.bD());t.dj(1);return t};_pc.a.i=function(n,t){if(_js.d.a(n))throw Error.argumentNull("displayName");if(_js.d.a(t))throw Error.argumentNull("imAddress");var i=new _pc.a(null,!0,null);i.cP(n);i.fs(t);i.cc(new(_bc.S.$$(String)));i.K().g(i.g(),"0");i.dj(1);i.df(1);return i};_pc.a.n=function(n,t){if($a(n))throw Error.argumentNull("displayName");if($a(t))throw Error.argumentNull("postalAddress");var i=_pc.a.j();i.dj(1);i.df(4);i.cP(n);var r=new _bc.d;r.h("0");r.s(null);r.k("OWA");r.n(!0);r.r(!1);r.m(!1);r.q(null);i.cC(new _js.f);i.e().a(r);switch(t.s()){case"Business":i.bN(new(_bc.S.$$(_g.p)));i.H().g(t,"0");break;case"Home":i.bY(new(_bc.S.$$(_g.p)));i.J().g(t,"0");break;case"Other":default:i.ci(new(_bc.S.$$(_g.p)));i.L().g(t,"0");break}return i};_pc.a.f=function(n){var t="Contact";var u=null;var r=n.a();if(r){t=r.a();u=r.bl.LocationUri}if(t==="Contact"||t==="Resource"){var i=new _g.d;i.Name=n.bl.DisplayName;if(!_js.d.a(u)){i.MailboxType="Mailbox";i.EmailAddress=u}var e=_pc.a.b(i);e.fg(n.g());return e}else if(t==="LocationServices"||t==="PhonebookServices")return _pc.a.n(n.bl.DisplayName,n.g());var f=_pc.a.m(n.bl.DisplayName);f.df(0);return f};_pc.a.o=function(n){return!$a(n)&&!_js.d.b(n.EmailAddress)?n.EmailAddress:null};_pc.a.g=function(n,t){if(!n||!t)return!1;if(!$a(n.a())&&!$a(n.a().EmailAddress)&&!$a(t.a())&&!$a(t.a().EmailAddress)&&n.a().EmailAddress.toLocaleLowerCase()===t.a().EmailAddress.toLocaleLowerCase())return!0;if(!$a(n.d())&&!$a(t.d()))for(var u=n.d().length,f=t.d().length,i=0;i<u;i++)for(var r=0;r<f;r++)if(!$a(n.d()[i].EmailAddress)&&!$a(t.d()[r].EmailAddress)&&n.d()[i].EmailAddress.toLowerCase()===t.d()[r].EmailAddress.toLowerCase())return!0;return!1};_pc.a.e=function(n,t){if(!n||!t)return n===t?!0:!1;if(_pc.a.isInstanceOfType(n)&&_pc.a.isInstanceOfType(t)&&n.i()!==1&&t.i()!==1){if(n.f()&&t.f()&&n.f().Id===t.f().Id)return!0}else if(_pc.a.g(n,t))return!0;return!1};_pc.a.prototype={fx:null,dt:null,dO:null,dL:null,ei:null,et:null,eL:null,eh:null,ex:null,ep:null,ey:null,eR:null,eS:null,eT:null,dF:null,dG:null,em:null,en:null,eu:null,ev:null,dC:null,dH:null,el:null,eA:null,eC:null,eE:null,eD:null,eF:null,eI:null,eM:null,eO:null,eP:null,dP:null,ed:null,ee:null,dE:null,eJ:null,eG:null,ez:null,eo:null,dD:null,ek:null,eB:null,eN:null,dK:null,dJ:null,er:null,dB:null,eH:null,eK:null,dI:null,ej:null,dv:null,du:null,eq:null,fy:null,gg:!1,bo:function(){return this.b()!==4&&this.b()!==3&&this.b()!==1||!this.bI()?!1:this.fz().c()},cx:function(){return this.di.bl},i:function(){return this.gS()},dj:function(n){this.gW(n);return n},fw:function(){return this.di.dj()},fZ:function(){return this.di.ck()},gV:function(n){this.di.ck()!==n&&this.di.cY(n);return n},gP:function(){return this.di.bl.FileAs||null},gU:function(n){this.di.bl.FileAs!==n&&this.di.cV(n);return n},fX:function(){return this.di.bl.GivenName||null},gs:function(){return this.di.bl.DisplayNameFirstLastHeader||null},gt:function(){return this.di.bl.DisplayNameLastFirstHeader||null},gQ:function(){return this.di.bl.MiddleName||null},cU:function(){return this.di.bl.Surname||null},da:function(n){this.di.bl.Surname!==n&&this.di.dd(n);return n},gN:function(){return this.di.bl.Alias||null},dk:function(){return this.di.bl.Title||null},gf:function(n){this.di.bl.Title!==n&&this.di.de(n);return n},gO:function(){return this.di.bl.Department||null},dr:function(){return this.di.bl.CompanyName||null},gR:function(){return this.di.bl.PhoneNumber||null},fY:function(){return this.di.bl.HomeCity||null},gb:function(){return this.di.bl.WorkCity||null},dn:function(){return this.di.dk()},e:function(){if(!this.dt){if(!this.di.bl.AttributionsArray&&this.di.bC()){var n=this.di.bC().f();this.di.bl.AttributionsArray=n;this.di.bC().F(this.di.bl.AttributionsArray)}this.di.bl.AttributionsArray&&(this.dt=new(_a.ge.$$(_bc.d,_g.df))(this.di.bl.AttributionsArray))}return this.dt?this.dt.c:null},cC:function(n){if(n){for(var i=new Array(n.b()),t=0;t<n.b();++t)i[t]=n.c(t).w();this.di.bl.AttributionsArray=i;this.dt&&this.dt.A(i)}else{this.dt=null;this.di.bl.AttributionsArray=null}this.dQ("Attributions");return n},bF:function(){!this.dO&&this.di.bX()&&(this.dO=new(_bc.S.$$(String))(this.di.bX()));return this.dO},cE:function(n){this.dO&&(n?this.dO.d(n.a):this.dO=null);this.di.ee(n?n.a:null);return n},bE:function(){!this.dL&&this.di.bW()&&(this.dL=new(_bc.S.$$(String))(this.di.bW()));return this.dL},cD:function(n){this.dL&&(n?this.dL.d(n.a):this.dL=null);this.di.ed(n?n.a:null);return n},I:function(){!this.ei&&this.di.cc()&&(this.ei=new(_bc.S.$$(String))(this.di.cc()));return this.ei},by:function(n){this.ei&&(n?this.ei.d(n.a):this.ei=null);this.di.eo(n?n.a:null);return n},w:function(){!this.et&&this.di.cn()&&(this.et=new(_bc.S.$$(String))(this.di.cn()));return this.et},bA:function(n){this.et&&(n?this.et.d(n.a):this.et=null);this.di.eG(n?n.a:null);return n},F:function(){!this.eL&&this.di.cC()&&(this.eL=new(_bc.S.$$(String))(this.di.cC()));return this.eL},bC:function(n){this.eL&&(n?this.eL.d(n.a):this.eL=null);this.di.eZ(n?n.a:null);return n},bn:function(){!this.eh&&this.di.cb()&&(this.eh=new(_bc.S.$$(String))(this.di.cb()));return this.eh},bW:function(n){this.eh&&(n?this.eh.d(n.a):this.eh=null);this.di.em(n?n.a:null);return n},br:function(){!this.ex&&this.di.cp()&&(this.ex=new(_bc.S.$$(String))(this.di.cp()));return this.ex},cg:function(n){this.ex&&(n?this.ex.d(n.a):this.ex=null);this.di.eJ(n?n.a:null);return n},h:function(){!this.ey&&this.di.bM()&&(this.ey=new(_bc.S.$$(_g.w))(this.di.bM()));return this.ey},bh:function(n){this.ey&&(n?this.ey.d(n.a):this.ey=null);this.di.dr(n?n.a:null);return n},cS:function(){!this.ep&&this.di.cj()&&(this.ep=new(_bc.S.$$(String))(this.di.cj()));return this.ep},cY:function(n){this.ep&&(n?this.ep.d(n.a):this.ep=null);this.di.ez(n?n.a:null);return n},r:function(){!this.eR&&this.di.cL()&&(this.eR=new(_bc.S.$$(String))(this.di.cL()));return this.eR},bH:function(n){this.eR&&(n?this.eR.d(n.a):this.eR=null);this.di.fj(n?n.a:null);return n},Z:function(){!this.eS&&this.di.cM()&&(this.eS=new(_bc.S.$$(String))(this.di.cM()));return this.eS},cu:function(n){this.eS&&(n?this.eS.d(n.a):this.eS=null);this.di.fk(n?n.a:null);return n},ba:function(){!this.eT&&this.di.cN()&&(this.eT=new(_bc.S.$$(String))(this.di.cN()));return this.eT},cv:function(n){this.eT&&(n?this.eT.d(n.a):this.eT=null);this.di.fl(n?n.a:null);return n},k:function(){!this.dF&&this.di.bQ()&&(this.dF=new(_bc.S.$$(_g.k))(this.di.bQ()));return this.dF},bP:function(n){this.dF&&(n?this.dF.d(n.a):this.dF=null);this.di.dv(n?n.a:null);return n},v:function(){$a(this.dG)&&!$a(this.di.bP())&&(this.dG=new(_bc.S.$$(_g.k))(this.di.bP()));return this.dG},bQ:function(n){$a(this.dG)||(n?this.dG.d(n.a):this.dG=null);this.di.du(n?n.a:null);return n},A:function(){!this.em&&this.di.ch()&&(this.em=new(_bc.S.$$(_g.k))(this.di.ch()));return this.em},ca:function(n){this.em&&(n?this.em.d(n.a):this.em=null);this.di.ex(n?n.a:null);return n},B:function(){$a(this.en)&&!$a(this.di.cg())&&(this.en=new(_bc.S.$$(_g.k))(this.di.cg()));return this.en},cb:function(n){$a(this.en)||(n?this.en.d(n.a):this.en=null);this.di.ev(n?n.a:null);return n},q:function(){!this.eu&&this.di.co()&&(this.eu=new(_bc.S.$$(_g.k))(this.di.co()));return this.eu},ce:function(n){this.eu&&(n?this.eu.d(n.a):this.eu=null);this.di.eH(n?n.a:null);return n},D:function(){$a(this.ev)&&!$a(this.di.bS())&&(this.ev=new(_bc.S.$$(_g.k))(this.di.bS()));return this.ev},cf:function(n){$a(this.ev)||(n?this.ev.d(n.a):this.ev=null);this.di.dC(n?n.a:null);return n},N:function(){!this.dC&&this.di.bJ()&&(this.dC=new(_bc.S.$$(_g.k))(this.di.bJ()));return this.dC},bL:function(n){this.dC&&(n?this.dC.d(n.a):this.dC=null);this.di.dn(n?n.a:null);return n},P:function(){!this.dH&&this.di.bR()&&(this.dH=new(_bc.S.$$(_g.k))(this.di.bR()));return this.dH},bR:function(n){this.dH&&(n?this.dH.d(n.a):this.dH=null);this.di.dB(n?n.a:null);return n},Q:function(){!this.el&&this.di.cf()&&(this.el=new(_bc.S.$$(_g.k))(this.di.cf()));return this.el},bZ:function(n){this.el&&(n?this.el.d(n.a):this.el=null);this.di.eu(n?n.a:null);return n},R:function(){!this.eA&&this.di.cr()&&(this.eA=new(_bc.S.$$(_g.k))(this.di.cr()));return this.eA},ch:function(n){this.eA&&(n?this.eA.d(n.a):this.eA=null);this.di.eL(n?n.a:null);return n},S:function(){!this.eC&&this.di.ct()&&(this.eC=new(_bc.S.$$(_g.k))(this.di.ct()));return this.eC},cj:function(n){this.eC&&(n?this.eC.d(n.a):this.eC=null);this.di.eN(n?n.a:null);return n},T:function(){!this.eE&&this.di.cv()&&(this.eE=new(_bc.S.$$(_g.k))(this.di.cv()));return this.eE},ck:function(n){this.eE&&(n?this.eE.d(n.a):this.eE=null);this.di.eP(n?n.a:null);return n},cT:function(){$a(this.eD)&&!$a(this.di.cu())&&(this.eD=new(_bc.S.$$(_g.k))(this.di.cu()));return this.eD},cZ:function(n){$a(this.eD)||(n?this.eD.d(n.a):this.eD=null);this.di.eO(n?n.a:null);return n},U:function(){!this.eF&&this.di.cw()&&(this.eF=new(_bc.S.$$(_g.k))(this.di.cw()));return this.eF},cl:function(n){this.eF&&(n?this.eF.d(n.a):this.eF=null);this.di.eR(n?n.a:null);return n},V:function(){!this.eI&&this.di.cz()&&(this.eI=new(_bc.S.$$(_g.k))(this.di.cz()));return this.eI},co:function(n){this.eI&&(n?this.eI.d(n.a):this.eI=null);this.di.eV(n?n.a:null);return n},W:function(){!this.eM&&this.di.cD()&&(this.eM=new(_bc.S.$$(_g.k))(this.di.cD()));return this.eM},cq:function(n){this.eM&&(n?this.eM.d(n.a):this.eM=null);this.di.fa(n?n.a:null);return n},X:function(){!this.eO&&this.di.cG()&&(this.eO=new(_bc.S.$$(_g.k))(this.di.cG()));return this.eO},cr:function(n){this.eO&&(n?this.eO.d(n.a):this.eO=null);this.di.fc(n?n.a:null);return n},Y:function(){!this.eP&&this.di.cK()&&(this.eP=new(_bc.S.$$(_g.k))(this.di.cK()));return this.eP},ct:function(n){this.eP&&(n?this.eP.d(n.a):this.eP=null);this.di.fg(n?n.a:null);return n},j:function(){$a(this.dP)&&!$a(this.di.bY())&&(this.dP=new(_bc.S.$$(_g.d))(this.di.bY()));return this.dP},bT:function(n){$a(this.dP)||(n?this.dP.d(n.a):this.dP=null);this.di.ei(n?n.a:null);return n},o:function(){$a(this.ed)&&!$a(this.di.bZ())&&(this.ed=new(_bc.S.$$(_g.d))(this.di.bZ()));return this.ed},bU:function(n){$a(this.ed)||(n?this.ed.d(n.a):this.ed=null);this.di.ej(n?n.a:null);return n},p:function(){$a(this.ee)&&!$a(this.di.ca())&&(this.ee=new(_bc.S.$$(_g.d))(this.di.ca()));return this.ee},bV:function(n){$a(this.ee)||(n?this.ee.d(n.a):this.ee=null);this.di.ek(n?n.a:null);return n},n:function(){!this.dE&&this.di.bO()&&(this.dE=new(_bc.S.$$(String))(this.di.bO()));return this.dE},bO:function(n){this.dE&&(n?this.dE.d(n.a):this.dE=null);this.di.dt(n?n.a:null);return n},bG:function(){!this.eJ&&this.di.cA()&&(this.eJ=new(_bc.S.$$(String))(this.di.cA()));return this.eJ},cF:function(n){this.eJ&&(n?this.eJ.d(n.a):this.eJ=null);this.di.eX(n?n.a:null);return n},bf:function(){!this.eG&&this.di.cx()&&(this.eG=new(_bc.S.$$(String))(this.di.cx()));return this.eG},cm:function(n){this.eG&&(n?this.eG.d(n.a):this.eG=null);this.di.eS(n?n.a:null);return n},E:function(){!this.ez&&this.di.cq()&&(this.ez=new(_bc.S.$$(String))(this.di.cq()));return this.ez},bB:function(n){this.ez&&(n?this.ez.d(n.a):this.ez=null);this.di.eK(n?n.a:null);return n},K:function(){!this.eo&&this.di.ci()&&(this.eo=new(_bc.S.$$(String))(this.di.ci()));return this.eo},cc:function(n){this.eo&&(n?this.eo.d(n.a):this.eo=null);this.di.ey(n?n.a:null);return n},bI:function(){this.fx||this.fA();return this.fx},fg:function(n){this.fx=n;this.dQ("PostalAddress");return n},H:function(){!this.dD&&this.di.bN()&&(this.dD=new(_bc.S.$$(_g.p))(this.di.bN()));return this.dD},bN:function(n){this.dD&&(n?this.dD.d(n.a):this.dD=null);this.di.ds(n?n.a:null);this.fA();return n},J:function(){!this.ek&&this.di.ce()&&(this.ek=new(_bc.S.$$(_g.p))(this.di.ce()));return this.ek},bY:function(n){this.ek&&(n?this.ek.d(n.a):this.ek=null);this.di.eq(n?n.a:null);this.fA();return n},L:function(){!this.eB&&this.di.cs()&&(this.eB=new(_bc.S.$$(_g.p))(this.di.cs()));return this.eB},ci:function(n){this.eB&&(n?this.eB.d(n.a):this.eB=null);this.di.eM(n?n.a:null);this.fA();return n},l:function(){!this.eN&&this.di.cF()&&(this.eN=new(_bc.S.$$(String))(this.di.cF()));return this.eN},bi:function(n){this.eN&&(n?this.eN.d(n.a):this.eN=null);this.di.fb(n?n.a:null);return n},z:function(){!this.dK&&this.di.bV()&&(this.dK=new(_bc.S.$$(String))(this.di.bV()));return this.dK},bx:function(n){this.dK&&(n?this.dK.d(n.a):this.dK=null);this.di.dI(n?n.a:null);return n},m:function(){!this.dJ&&this.di.bU()&&(this.dJ=new(_bc.S.$$(String))(this.di.bU()));return this.dJ},bw:function(n){this.dJ&&(n?this.dJ.d(n.a):this.dJ=null);this.di.dF(n?n.a:null);return n},C:function(){!this.er&&this.di.cm()&&(this.er=new(_bc.S.$$(String))(this.di.cm()));return this.er},bz:function(n){this.er&&(n?this.er.d(n.a):this.er=null);this.di.eE(n?n.a:null);return n},y:function(){!this.dB&&this.di.bI()&&(this.dB=new(_bc.S.$$(String))(this.di.bI()));return this.dB},bv:function(n){this.dB&&(n?this.dB.d(n.a):this.dB=null);this.di.dm(n?n.a:null);return n},bs:function(){!this.eH&&this.di.cy()&&(this.eH=new(_bc.S.$$(String))(this.di.cy()));return this.eH},cn:function(n){this.eH&&(n?this.eH.d(n.a):this.eH=null);this.di.eU(n?n.a:null);return n},bg:function(){!this.eK&&this.di.cB()&&(this.eK=new(_bc.S.$$(String))(this.di.cB()));return this.eK},cp:function(n){this.eK&&(n?this.eK.d(n.a):this.eK=null);this.di.eY(n?n.a:null);return n},bm:function(){!this.dI&&this.di.bT()&&(this.dI=new(_bc.S.$$(Array))(this.di.bT()));return this.dI},bS:function(n){this.dI&&(n?this.dI.d(n.a):this.dI=null);this.di.dD(n?n.a:null);return n},bp:function(){!this.ej&&this.di.cd()&&(this.ej=new(_bc.S.$$(String))(this.di.cd()));return this.ej},bX:function(n){this.ej&&(n?this.ej.d(n.a):this.ej=null);this.di.ep(n?n.a:null);return n},bt:function(){this.dv||(this.di.cJ()?this.dv=new(_bc.S.$$(_a.c))(this.di.cJ()):this.di.cI()&&(this.dv=new(_bc.S.$$(_a.c))(this.di.cI())));return this.dv},cs:function(n){this.dv&&(n?this.dv.d(n.a):this.dv=null);this.di.fd(n?n.a:null);return n},be:function(){this.du||(this.di.bL()?this.du=new(_bc.S.$$(_a.c))(this.di.bL()):this.di.bK()&&(this.du=new(_bc.S.$$(_a.c))(this.di.bK())));return this.du},bM:function(n){this.du&&(n?this.du.d(n.a):this.du=null);this.di.dq(n?n.a:null);return n},bq:function(){!this.eq&&this.di.cl()&&(this.eq=new(_bc.S.$$(String))(this.di.cl()));return this.eq},cd:function(n){this.eq&&(n?this.eq.d(n.a):this.eq=null);this.di.eD(n?n.a:null);return n},ga:function(){!this.fy&&this.di.cE()&&(this.fy=new(_bc.S.$$(String))(this.di.cE()));return this.fy},x:function(){return $a(this.f())?"":this.di.bl.DisplayAsFavorite?"*"+this.f().Id:this.f().Id},dc:function(n){return _pc.a.e(this,n)},gZ:function(n,t){_a.b.b(n,"personaServiceObject");this.dN(n);this.dj(t)},cV:function(){var n=new _g.qo;n.PersonaId=this.f();n.DisplayName=this.c()||this.g();n.SipUri=this.g();n.FirstName=this.fX();n.LastName=this.cU();n.EmailAddress=this.a();return n},gv:function(){return new _g.g(this.f().Id)},bJ:function(){if(this.bI()){var t=this.fz();if(t.c()){var n=new _js.f;n.a(t);return n}}return null},fz:function(){if(this.gd())switch(this.b()){case 1:case 3:return _g.y.g(this.c(),this.a(),this.bI());case 4:return _g.y.f(this.c(),this.bI())}return _g.y.a(this.c())},db:function(){var n=null;if(this.gg){if(this.e()&&this.e().b()>0&&this.e().c(0)&&this.e().c(0).e()){var t=this.e().c(0).e().Id;n=_h.k.c(n,"singleSourceId",t)}}else{n=_h.k.prototype.db.call(this);_js.d.a(this.bj())||(n=_h.k.c(n,"adObjectId",this.bj()))}return n},gY:function(n,t){this.dN(n);this.gw(t)},s:function(n){if($a(this.e())||!this.e().b())return null;for(var i=0;i<this.e().b();++i){var t=this.e().c(i);if(t&&t.a()===n)return t}return null},cz:function(){var i=new Array(0);if(!$a(this.e()))for(var n=0;n<this.e().b();++n){var t=this.e().c(n);t.f()||Array.add(i,t)}return i},bu:function(){var t=this.e();var r=[];if(t)for(var u=t.b(),n=0;n<u;n++){var i=t.c(n);i.g()&&Array.add(r,i)}return r},cA:function(){return this.cz().length},gT:function(){for(var i=0,n=0;n<this.e().b();++n){var t=this.e().c(n);t.f()||t.b()==="RecipientCache"||i++}return i},cK:function(n){if($a(this.e()))return!0;if(this.e().b()===1){var t=this.e().c(0);if(t&&("RecipientCache"===t.b()||_pecs.d.a===t.b()))return!0}return this.gM(n.b())},cL:function(n,t){if(!$a(n))for(var i=0;i<n.b();++i){var r=n.c(i);if(this.bl(r.b())){t.val=r;return!0}}t.val=null;return!1},cB:function(){if(!this.e())return!1;var t=this;var n=this.e().h(function(n){switch(n.b()){case"Facebook":case"LinkedIn":return!0;case"Outlook":case"GAL":return!1;default:return!1}});return n<this.e().b()},cR:function(){if(this.e())for(var n=0;n<this.e().b();n++)if(this.e().c(n).p())return!0;return!1},cy:function(){var n="";if(this.cJ()){n=this.ge(this.j(),"GAL");n=_js.d.a(n)?this.ge(this.o(),"GAL"):n;n=_js.d.a(n)?this.ge(this.p(),"GAL"):n}return n},gu:function(){var t=null;if(this.e()&&this.e().b()>0){var i=this;var n=this.e().h(function(n){return n.b()==="GAL"});n<this.e().b()&&(t=this.e().c(n))}return t},cJ:function(){return!!this.gu()},bK:function(){if($a(this.e()))return!1;for(var n=0;n<this.e().b();++n)if(this.e().c(n).b()!=="GAL"&&this.e().c(n).b()!=="RecipientCache")return!1;return!0},cX:function(){if(!$a(this.e()))for(var n=0;n<this.e().b();++n)if(this.e().c(n).b()!=="RecipientCache")return!1;return!0},gd:function(){switch(this.b()){case 1:case 3:return!$a(_pc.a.o(this.a()));case 4:return!$a(this.bI());default:return!1}},bl:function(n){if($a(n))return!1;for(var r=n,u=r.length,t=0;t<u;++t){var f=r[t];var i=this.s(f);if(!$a(i)&&i.g())return!0}return!1},gc:function(){if(!this.gd())throw Error.invalidOperation("Cannot get location URI for a persona that does not have a valid location identifier");switch(this.b()){case 1:return this.a().EmailAddress;case 4:return this.bI().bl.LocationUri;default:throw Error.invalidOperation("Location URI is not available for this persona type");}},dN:function(n){this.di.di(n);this.dQ("PropertiesChanged")},dM:function(){return this.di.bl},fb:function(){!_h.k.prototype.fb.call(this)&&this.di&&this.di.bl.PersonaId&&_h.k.prototype.fu.call(this,this.di.bl.PersonaId);return _h.k.prototype.fb.call(this)},fu:function(n){if(_h.k.prototype.fb.call(this)!==n){var t=null;if(n){t=new _g.g(n.Id);t.ChangeKey=n.ChangeKey}_h.k.prototype.fu.call(this,n);this.di.cZ(t)}},eZ:function(){!_h.k.prototype.eZ.call(this)&&this.di.bl.EmailAddress&&_h.k.prototype.ft.call(this,this.di.bl.EmailAddress);return _h.k.prototype.eZ.call(this)},ft:function(n){if(_h.k.prototype.eZ.call(this)!==n){_h.k.prototype.ft.call(this,n);this.di.cT(n)}},fa:function(){if(!_h.k.prototype.fa.call(this)&&this.di.bw()){_h.k.prototype.fe.call(this,new Array(this.di.bw().b()));for(var n=0;n<this.di.bw().b();++n)_h.k.prototype.fa.call(this)[n]=this.di.bw().a(n)}return _h.k.prototype.fa.call(this)},fe:function(n){if(n){for(var r=new(_a.gd.$$(_g.d)),i=n,f=i.length,t=0;t<f;++t){var u=i[t];r.e(u)}_h.k.prototype.fe.call(this,n);this.di.cU(r)}else{_h.k.prototype.fe.call(this,null);this.di.cU(null)}},gj:function(){return this.di.bl.DisplayName||null},go:function(n){this.di.bl.DisplayName!==n&&this.di.cP(n)},eV:function(){var n=this.di.bl.DisplayNameFirstLast||null;_h.k.prototype.eV.call(this)||_h.k.prototype.fN.call(this,n);return n},fN:function(n){if(this.di.bl.DisplayNameFirstLast!==n){_h.k.prototype.fN.call(this,n);this.di.cQ(n)}},fn:function(){var n=this.di.bl.DisplayNamePrefix||"";_h.k.prototype.fn.call(this)||_h.k.prototype.fQ.call(this,n);return n},fQ:function(n){if(this.di.bl.DisplayNamePrefix!==n){_h.k.prototype.fQ.call(this,n);this.di.cS(n)}},fo:function(){var n=this.di.bl.Generation||"";_h.k.prototype.fo.call(this)||_h.k.prototype.fR.call(this,n);return n},fR:function(n){if(this.di.bl.Generation!==n){_h.k.prototype.fR.call(this,n);this.di.cW(n)}},eW:function(){var n=this.di.bl.DisplayNameLastFirst||"";_h.k.prototype.eW.call(this)||_h.k.prototype.fO.call(this,n);return n},fO:function(n){if(this.di.bl.DisplayNameLastFirst!==n){_h.k.prototype.fO.call(this,n);this.di.cR(n)}},fH:function(){var n=this.di.bl.YomiFirstName||"";_h.k.prototype.fH.call(this)||_h.k.prototype.fS.call(this,n);return n},fS:function(n){if(this.di.bl.YomiFirstName!==n){_h.k.prototype.fS.call(this,n);this.di.dg(n)}},fI:function(){var n=this.di.bl.YomiLastName||"";_h.k.prototype.fI.call(this)||_h.k.prototype.fT.call(this,n);return n},fT:function(n){if(this.di.bl.YomiLastName!==n){_h.k.prototype.fT.call(this,n);this.di.dh(n)}},gm:function(){return _js.d.b(this.di.bl.PersonaTypeString)?0:_js.l.a(_bc.e,this.di.bl.PersonaTypeString)},gq:function(n){this.di.bl.PersonaTypeString!==_bc.e.toString(n)&&this.di.dc(_bc.e.toString(n))},gS:function(){if(_js.d.b(this.di.bl.PersonaObjectStatusString))return 0;else{var n=_js.l.a(_bc.y,this.di.bl.PersonaObjectStatusString);var t=$a(n)||!n;return n}},gW:function(n){this.di.bl.PersonaObjectStatusString!==_bc.y.toString(n)&&this.di.db(_bc.y.toString(n))},gk:function(){return this.di&&this.di.bl.ImAddress?this.di.bl.ImAddress:null},gp:function(n){this.di.bl.ImAddress!==n&&this.di.cX(n)},gl:function(){return this.di?this.di.cH():0},gr:function(n){this.di&&this.di.cH()!==n&&this.di.df(n)},fB:function(n,t){var i=null;i=this.b()===4?this.gL(n,t):_h.k.prototype.fB.call(this,n,t);return i},dT:function(){this.di.u(this.fW);_h.k.prototype.dT.call(this)},gX:function(n,t){t in _pc.a.l()&&this.dQ(_pc.a.l()[t])},ge:function(n,t){if(n)for(var r=0;r<n.b();r++)for(var f=n.c(r),u=f.b(),s=u.length,i=0;i<s;++i){var o=u[i];var e=this.s(o);if(e.b()===t)return f.a().EmailAddress}return""},fA:function(){this.J()?this.fg(this.J().m()):this.H()?this.fg(this.H().m()):this.L()?this.fg(this.L().m()):this.fg(null)},gL:function(n,t){return _pc.p.a(n,t,this.bI().bl.Latitude,this.bI().bl.Longitude)},gM:function(n){for(var r=n,f=r.length,t=0;t<f;++t){var i=r[t];if(i===_pecs.d.a)return!0;var u=this.s(i);if(!$a(u)&&!u.f())return!0}return!1},gw:function(n){n==="AllProperties"?this.dj(3):this.dj(2)}};_pc.p=function(n,t,i,r,u,f,e){var o=80;var h=900;var s=834;this.e=n<o?o:n;this.e=this.e>h?h:this.e;this.c=t<o?o:t;this.c=this.c>s?s:this.c;this.f=i;this.g=r;this.a=u;this.d=f;this.b=e;if((_js.d.a(this.a)||_js.d.a(this.d)||_js.d.a(this.b))&&_g.a.a()&&_g.a.a().m()&&_g.a.a().c()&&_g.a.a().bl.PolicySettings&&_g.a.a().bl.PolicySettings.PlacesEnabled){this.a=_g.a.a().m().bl.StaticMapUrl;this.d=_g.a.a().m().bl.MapControlKey;this.b=_g.a.a().c().bl.UserCulture}};_pc.p.a=function(n,t,i,r){var u=new _pc.p(n,t,i,r);return u.j()};_pc.p.prototype={e:0,c:0,f:0,g:0,a:null,d:null,b:null,h:null,j:function(){!_js.d.a(this.h)||_js.d.a(this.a)||_js.d.a(this.d)||_js.d.a(this.b)||isNaN(this.f)||isNaN(this.g)||(this.h=this.i());return this.h},i:function(){return String.format(this.a+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",this.f,this.g,this.e,this.c,this.d,this.b)}};function PeopleCoreComponent(){}PeopleCoreComponent.$$cctor=function(){_a.p.a().a(PeopleCoreComponent)};PeopleCoreComponent.prototype={a:function(n,t,i){n.e(_pc.q).a().b(IUpdatePersonaActionFactory);n.e(_pc.t).a().b(ICreatePersonaResponseProcessorFactory);n.e(_pc.u).a().b(IDeletePersonaResponseProcessorFactory);n.e(_pc.v).a().b(IUpdatePersonaResponseProcessorFactory)},b:function(){return[]}};_pc.c=function(){_pc.c.initializeBase(this)};_pc.c.prototype={h:0,p:null,K:!1,S:function(n){this.apcl("SortGroupPriority",n)},L:function(n){this.h=n;this.dQ("SortGroupPriority");return n},T:function(n){this.p=n;this.dQ("BaseFolderId");return n},U:function(n){this.K=n;this.dQ("IsReadOnly");return n},H:function(){return this.h===3?this.bl.DisplayName:null}};_pc.d=function(n,t,i,r,u){_pc.d.initializeBase(this);_a.b.j(t,"propertyUpdates");_a.b.a(i,"parentFolder");this.d=t;this.g=r;this.f=i;this.c=null;this.a=new _g.BA(this.x);this.a.createPersonaUnderMyContactsFolder=u;if(n){this.a.personaId=new _g.g(n.Id);n.Id.startsWith("CLPID:")||(this.c=new _g.g(n.Id))}};_pc.d.prototype={d:null,g:null,e:8,c:null,f:null,a:null,s:function(n){this.a.actionName=_js.d.c("{0}_{1}","PersonaCard",_bc.m.toString(this.e));this.a.explicitLogonUser=this.J;var t=new _g.no(this.y());t.Body=new _g.js;this.h(t.Body,this.c);n.l(t,this.a,this.r,this.q)},cz:function(n,t,i){t()},h:function(n,t){n.PersonaId=t;n.PersonTypeString=this.g;n.PropertyUpdates=this.d;n.ParentFolderId=this.f}};_pc.l=function(n){this.d=n};_pc.l.prototype={d:null,c:function(){return this.d},b:function(n){var i=n;var t=i.PersonaId.Id;i.DisplayAsFavorite&&(t="*"+t);return t}};_pc.f=function(n,t,i,r){_pc.f.initializeBase(this);_a.b.j(t,"propertyUpdates");_a.b.a(n,"personaId");this.e=t;this.g=i;this.d=new _g.g(n.Id);this.c=r;this.a=new _g.PM(this.x);this.a.isOnlineOnlyCall=!1;this.a.personaId=this.d};_pc.f.prototype={e:null,g:null,f:8,d:null,a:null,c:null,cz:function(n,t,i){t()},s:function(n){this.a.actionName=_js.d.c("{0}_{1}","PersonaCard",_bc.m.toString(this.f));this.a.explicitLogonUser=this.J;var t=new _g.tl(this.y());t.Body=new _g.ma;this.h(t.Body,this.d,this.c);n.I(t,this.a,this.r,this.q)},h:function(n,t,i){n.PersonaId=t;n.PersonTypeString=this.g;n.PropertyUpdates=this.e;$a(this.c)||(n.ParentFolderId=new _g.R(this.c))}};_pc.q=function(){};_pc.q.prototype={a:function(n,t,i,r){var u=new _pc.f(n,t,i,null);u.a.isOnlineOnlyCall=r;return u}};_pc.g=function(){_pc.g.initializeBase(this)};_pc.g.prototype={s:function(n){var i=new _g.Gv(this.x);var t=new _g.pv;n.bP(t,i,this.r,this.q)},cz:function(n,t,i){_pc.g.a=n;t()}};_pc.x=function(){};_pc.x.registerInterface("_pc.x");var ILinkSummaryCardViewModelFactory=function(){};ILinkSummaryCardViewModelFactory.registerInterface("ILinkSummaryCardViewModelFactory");var IModernGroupMembershipPivotViewModelFactory=function(){};IModernGroupMembershipPivotViewModelFactory.registerInterface("IModernGroupMembershipPivotViewModelFactory");_pc.j=function(n,t,i){this.a=n;this.m=t;this.i=i};_pc.j.prototype={a:null,h:null,m:null,i:"",g:null,l:0,c:0,k:null,d:!1,q:function(n){this.a=n;this.f(null);return n},p:function(n){this.u(n);this.h=n;this.f(null);return n},b:function(){if($a(this.g)){this.d=!1;this.g=this.h&&this.h.length>0?this.o(this.h):this.o(this.m)}return this.g},f:function(n){this.d=!1;this.g=n;return n},e:function(){var t="";if(this.c===1)t=this.a.c();else{var n="";if($a(this.b()))t=this.i;else{if(_g.o.a(this.b()))n=_g.o.c(this.b());else if(_g.p.isInstanceOfType(this.b())){var i=this.b();switch(i.a()){case"PhonebookServices":case"Contact":n=this.c===2&&!_js.d.b(i.bl.Street)?i.bl.Street:i.e();break;case"LocationServices":n=this.c===2&&i.b().indexOf(this.a.c())===-1?null:i.e();break;default:n=i.e();break}}else _g.dr.a(this.b())?n=this.b().Number:String.isInstanceOfType(this.b())&&(n=this.b());this.c?this.c===2?t=this.n(n,!1):this.c===4?t=this.n(n,!0):this.c!==3||_js.d.a(this.k)||(t=String.format(this.k,n)):t=n}}_js.d.a(t)&&(t=" ");return t},r:function(n){if(!$a(this.a)){if(_pc.a.isInstanceOfType(this.a)){var t=this.a;switch(n){case 2:return t.dr();case 3:return t.gR();case 4:return t.k()?t.k().m():null;case 6:return t.A()?t.A().m():null;case 5:return t.q()?t.q().m():null;case 7:return t.bI();case 8:return t.gy();case 9:return t.cM();case 14:return t.gz();case 15:return t.gA();case 10:return t.gP();case 11:return t.E()?t.E().m():null;case 16:return t.gB();case 17:return t.dk()}}switch(n){case 0:return this.a.c();case 1:return this.a.a();case 12:return this.a.g();case 13:this.d=!0;return this.t()}}return null},j:function(n,t,i){return t===i?t:_js.d.c(n,t,i)},s:function(n,t,i){if(_g.p.isInstanceOfType(this.b())){var u=this.b();switch(u.a()){case"PhonebookServices":case"Contact":return this.j(_pecs.d.Z,this.a.c(),n);default:return n}}switch(this.l){case 11:return this.j(_pecs.d.Z,this.a.c(),n)}if(_g.o.a(this.b())){var r=this.b();return!r.RoutingType||r.RoutingType.toUpperCase()==="SMTP"?t.indexOf(n)>=0?t:this.j(i?_pecs.d.Z:_pecs.d.R,t,n):_js.d.c(_pecs.d.D,t,r.RoutingType,n)}return this.j(_pecs.d.W,t,n)},n:function(n,t){var i=this.a?this.a.c():"";if(_js.d.a(i)||_js.d.a(n))if(_js.d.a(i)){if(!_js.d.a(n))return n}else return i;else return this.s(n,i,t);return""},o:function(n){var u=null;this.l=0;if(n)for(var f=n.length,i=0;i<f;i++){var r=n[i];var t=this.r(r);if(!$a(t)&&(!String.isInstanceOfType(t)||!_js.d.b(t))){u=t;this.l=r;break}}return u},u:function(n){if(n&&n.length>10)throw Error.argument("BindingList",String.format("Binding List maximum length of {0} is exceeded",10));},t:function(){var n=this.a.bD();switch(n){case 2:return _pecs.d.h;case 3:return _pecs.d.J;case 5:return _pecs.d.e;case 4:return _pecs.d.b;case 6:return _pecs.d.U;case 1:return _pecs.d.c;case 0:default:return""}}};_pc.r=function(n,t,i,r){_pc.r.initializeBase(this,[1,"VM.PersonCard.Open"]);this.a.a=n;this.a.loc=t;this.a.h=i;this.a.t=r};_pc.r.prototype={b:function(){var n=new _a.r;n.a("a",this.a.a).a("h",this.a.h).a("loc",this.a.loc).a("t",this.a.t);return n.toString()}};_pc.b=function(){};_pc.b.a=function(n,t,i){_pc.b.d(0,n,t,i)};_pc.b.g=function(n,t,i){_pc.b.d(1,n,t,i)};_pc.b.h=function(n,t,i){_pc.b.d(n,100,t,i)};_pc.b.d=function(n,t,i,r){if(_a.l.c()){var f=new _pc.r(n,t,i,r);var u=_a.d.b(_a.a.cn,"PeopleCard");u.j=f.b();_a.d.a(u)}};_pc.b.b=function(n,t,i,r,u,f){if(_a.l.c()){var o=new _pc.s(n,t,i,r,u,f);var e=_a.d.b(_a.a.cn,"RecipientCache");e.j=o.b();_a.d.a(e)}};_pc.b.c=function(n){if(_a.l.c()){var i=new _a.r;i.a("a",n);var t=_a.d.b(_a.a.q,"CommandBarContactLinking");t.j=i.toString();_a.d.a(t)}};_pc.b.e=function(n,t,i){if(_a.l.c()){var u=new _a.r;u.a("a",n).a("mc",t).a("pc",i);var r=_a.d.b(_a.a.q,"CommandBarPDL");r.j=u.toString();_a.d.a(r)}};_pc.b.j=function(n,t){var i=new _a.r;i.a("so",n).c("ss",t);return i.toString()};_pc.b.i=function(n,t){var i=new _a.r;i.a("po",n).c("fc",t);return i.toString()};_pc.b.f=function(n,t,i){if(!_js.d.b(i)){var r=_a.d.b(n,t);r.j=i;_a.d.a(r)}};_pc.s=function(n,t,i,r,u,f){_pc.s.initializeBase(this,[1,"VM.Recipient.Cache"]);this.a.A=n;this.a.QL=t;this.a.CRL=i;this.a.SI=$a(r)?-100:r;this.a.SRS=u;this.a.CT=f};_pc.s.prototype={b:function(){var n=new _a.r;n.a("a",this.a.A).a("ql",this.a.QL).a("crl",this.a.CRL).a("si",this.a.SI).a("srs",this.a.SRS).a("ct",this.a.CT);return n.toString()}};_pc.CreatePersonaResponseProcessor=function(n,t){_pc.CreatePersonaResponseProcessor.initializeBase(this,[n,t,_pc.CreatePersonaResponseProcessor.a])};_pc.CreatePersonaResponseProcessor.prototype={g:function(){return this.a().personaId},h:function(n){_js.Trace.logInfo(_pc.CreatePersonaResponseProcessor.a,"Adding Correlation Client Id [{0}] to Server Id [{1}]",this.g().Id,n.Id);this.f.y(this.c,this.g(),n)}};_pc.i=function(n,t){_pc.i.initializeBase(this,[n,t,_pc.i.a])};_pc.i.prototype={q:function(){if(this.m()&&this.d.response.statusCode===200){if(!this.a()||!this.a().personaId||!this.a().personaId.Id){_js.Trace.logError(this.b,"Context or persona id is null.");return}this.e().t().a(this.c,this.a().personaId)}this.d.response.statusCode!==200}};_pc.o=function(n,t,i){_pc.o.$$(this.$$gta["_pc.o"].TContext).initializeBase(this,[n,t,i])};_pc.o.$$=function(n){var t="o"+"$"+n.getName().replace(/\./g,"_");if(!_pc[t]){var r=_pc[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_pc.o.apply(this,t)};var s=_h.dK.$$(n,_g.bU);r.registerClass("_pc."+t,s);var h={"_pc.o":{TContext:n}};var f=s.prototype.$$gta;for(var c in f){var o={key:c,value:f[c]};h[o.key]=o.value}r.prototype.$$gta=h;var u=_pc.o.prototype;for(var e in u){var i={key:e,value:u[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _pc[t]};_pc.o.prototype={q:function(){if(this.m()&&this.d.response.statusCode===200)if(this.g()&&this.g().Id&&this.j()&&this.j().PersonaId&&this.j().PersonaId.Id!==this.g().Id){var t=this.e().t();this.c.b().b(!1);var n=this;t.c(this.c,this.g(),function(i){if(i){i.PersonaId=n.j().PersonaId;t.b(n.c,i,0,null);t.a(n.c,n.g())}},null);this.h(this.j().PersonaId)}else _js.Trace.logWarning(this.b,"Either user context PersonaId or response was invalid")}};_pc.UpdatePersonaResponseProcessor=function(n,t){_pc.UpdatePersonaResponseProcessor.initializeBase(this,[n,t,_pc.UpdatePersonaResponseProcessor.a])};_pc.UpdatePersonaResponseProcessor.prototype={g:function(){return this.a().personaId},h:function(n){}};_pc.t=function(){};_pc.t.prototype={a:function(n,t,i){return new _pc.CreatePersonaResponseProcessor(n,t)}};_pc.u=function(){};_pc.u.prototype={a:function(n,t,i){return new _pc.i(n,t)}};_pc.v=function(){};_pc.v.prototype={a:function(n,t,i){return new _pc.UpdatePersonaResponseProcessor(n,t)}};_pc.y=function(n,t,i,r,u){this.x=Function.createDelegate(this,this.bl);this.m=Function.createDelegate(this,this.bn);this.n=Function.createDelegate(this,this.br);this.v=Function.createDelegate(this,this.U);this.w=Function.createDelegate(this,this.bg);_pc.y.initializeBase(this,[n]);this.y(u);this.p=t;this.b=i;this.i=r;this.s=new _C(this.w,_a.a.v);this.q=new _C(this.v,_a.a.v);this.a=this.b.a()==="TouchNarrow";this.G([])};_pc.y.prototype={c:null,k:null,p:null,b:null,a:!1,l:null,q:null,s:null,d:null,i:null,j:!1,r:function(){return this.a&&this.l?this.l:this},g:function(n){var t=this.E();t&&this.a&&this.t()},h:function(){this.a&&this.Q()},e:function(n){this.a&&this.o("scaleUpIn")},f:function(){},t:function(){var n=_js.e.s(_a.a.q,2,"ReadCardViewBase-HidePersonaCard");this.r().M(!0);_js.e.e(n);_js.Trace.logInfo(_a.a.v,"ReadCardViewBase::HidePersonaCard - Layout: {0}",this.b.a())},o:function(n){if(this.a)this.bd(n);else{this.t();this.bd(n)}},Q:function(){this.d&&this.d.b(!1)},bq:function(){var n=this.E();if(n){n.U();n.a()&&n.a().b()===1&&n.T(this.n);this.j=this.b.a()==="Mouse"&&!!n.c()&&n.c().bl()&&n.m().a!==6;this.j&&this.bi("mouseleave",this.mK,"ReadPersonaCardView")}},bf:function(){var n=this.E();if(n){n.bi();n.a()&&n.a().b()===1&&n.bh(this.n);this.j&&this.bs("mouseleave","ReadPersonaCardView")}},bk:function(){this.bf();_js.b.prototype.bk.call(this)},bu:function(){this.bf();_js.H.prototype.bu.call(this)},R:function(){_js.c.prototype.R.call(this);this.bq()},bF:function(){if(this.a)return _js.c.prototype.bF.call(this);var i=new _fc.g;var t=new _fc.c;t.k=this.q;t.i("ESC");t.l=!1;var n=new _fc.c;n.k=this.s;n.i("D");n.j=1;i.a([t,n]);return[i]},J:function(){_js.b.prototype.J.call(this);this.Z();this.i.apcl("Orientation",this.m)},dQ:function(n){var t=this.E();if(t){if(t.k().d()&&t.k().d().i)return;this.U()}},P:function(){_js.b.prototype.P.call(this);this.i.rpcl("Orientation",this.m)},K:function(){_js.b.prototype.K.call(this);if(this.F){this.l=this.F.a("PersonaCardContainer");this.bw();this.c=this.F.a("scrollRegionIdOrganization");this.bB();this.k=this.F.a("itemManager")}},U:function(){var n=this.E();n&&n.p().a()},bg:function(){var t=this.E();if(t&&t.c()){var n=t.c().c().i();n&&n.b&&n.a()}},bl:function(){_js.Trace.logInfo(_a.a.v,"ReadCardViewBase::OnAnimationFinished - Layout: {0}",this.b.a());this.bt()},bd:function(n){this.Q();var t=_js.e.s(_a.a.q,2,"ReadCardViewBase-MakePersonaCardVisible");this.r().M(!1);_js.e.e(t);this.d=this.p.a(n,this.r().z,this.x,!1);this.d.a();_js.Trace.logInfo(_a.a.v,"ReadCardViewBase::InternalAnimatePersonaCard - Layout: {0}",this.b.a())},Z:function(){var n=this.E();if(n&&(n.C()||n.D())){this.Y().c(0);this.Y().o(_pecs.d.f);this.Y().a(48)}},bt:function(){var n=this.E();if(n&&(n.C()||n.D())){this.Z();var t=this;_js.g.a().a(_a.a.v,"SetFocusOnHoverCard",function(){t.z.focus()},0)}},bn:function(n,t){this.bj("IsCardOrientationPortrait")},bw:function(){var t=this.F.a("personaCardPart");if(t){var n=this.E();if(n&&n.m().a===10){var i=_js.q.getInstance().D&&!_a.UserAgent.getInstance().I;t.B.addClass(i?"ie8":"notIE8")}}},bB:function(){if(this.c){var n=this.E();if(n&&n.m().a===10){var t=_js.q.getInstance().D&&!_a.UserAgent.getInstance().I;this.c.B.addClass(t?"ie8":"notIE8")}}},br:function(){if(this.c&&this.k){this.c.d(0);this.c.v(this.k.z)}}};_pc.e.registerClass("_pc.e",_h.dk.$$(_g.ki,_g.pC));_pc.h.registerClass("_pc.h",_h.dY.$$(_g.oZ));_pc.k.registerClass("_pc.k",_g.h);_pc.a.registerClass("_pc.a",_h.k,_a.eg,_bc.bF,_bc.x,_js.z);PeopleCoreComponent.registerClass("PeopleCoreComponent",null,_a.iR);_pc.c.registerClass("_pc.c",_g.q);_pc.d.registerClass("_pc.d",_h.dY.$$(_g.bU));_pc.l.registerClass("_pc.l");_pc.f.registerClass("_pc.f",_h.dY.$$(_g.bU));_pc.q.registerClass("_pc.q",null,IUpdatePersonaActionFactory);_pc.g.registerClass("_pc.g",_h.dY.$$(_g.vH));_pc.j.registerClass("_pc.j");_pc.r.registerClass("_pc.r",_a.ca);_pc.s.registerClass("_pc.s",_a.ca);_pc.CreatePersonaResponseProcessor.registerClass("_pc.CreatePersonaResponseProcessor",_pc.o.$$(_g.BA));_pc.i.registerClass("_pc.i",_h.dK.$$(_g.Cj,_pc.a));_pc.UpdatePersonaResponseProcessor.registerClass("_pc.UpdatePersonaResponseProcessor",_pc.o.$$(_g.PM));_pc.t.registerClass("_pc.t",null,ICreatePersonaResponseProcessorFactory,_h.fo);_pc.u.registerClass("_pc.u",null,IDeletePersonaResponseProcessorFactory,_h.fo);_pc.v.registerClass("_pc.v",null,IUpdatePersonaResponseProcessorFactory,_h.fo);_pc.y.registerClass("_pc.y",_js.b,_ff.n);_pc.k.$$cctor();_pc.a.a=null;PeopleCoreComponent.$$cctor();_pc.g.a=null;_pc.CreatePersonaResponseProcessor.a=_a.a.dO;_pc.i.a=_a.a.dU;_pc.UpdatePersonaResponseProcessor.a=_a.a.fj;
window.scriptsLoaded['microsoft.owa.people.core.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.people.core.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
