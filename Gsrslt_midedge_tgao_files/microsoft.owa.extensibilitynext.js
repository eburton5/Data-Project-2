try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.extensibilitynext.js'] = (new Date()).getTime();
function ExtensibilityNextComponent(){}ExtensibilityNextComponent.$$cctor=function(){_a.p.a().a(ExtensibilityNextComponent)};ExtensibilityNextComponent.prototype={a:function(n,t,i){n.e(_exn.bk).b(IExtensibilityStatistics).a();var e=this;n.b(_exn.C,function(){return new _exn.C(n.a(_g.dD),n.a(IExtensibilityStatistics),n.a(_a.h))}).a();var o=this;n.b(_exn.E,function(){return new _exn.E(n.a(_a.e),n.a(_a.h))}).a();var f=this,r=this;n.b(_exn.D,function(){var t=n.a(_g.a);return new _exn.D(t.v(),t.c().bl.UserDisplayName,t.c().bl.UserEmailAddress,t.a().bl.TimeZone,n.a(_y.a),n.d(IItemReadingPaneContextFactory),n.d(IItemReadingPaneViewModelPopOutFactory),n.d(IMailComposeContextFactory),n.d(IMailComposeActionFactory),n.a(_a.e),n.a(_a.w),n.a(_a.q),n.a(_a.t))}).a().c(function(t){t.b=n.d(ICalendarItemDetailsViewModelFactory);t.g=n.d(IMailComposeViewModelFactory);t.c=n.d(IComposeCalendarItemViewModelFactory)});var u=this;n.b(IExtensibilityViewModelFactory,function(){var t=n.a(_g.a);return new _exn.bm(n.a(_a.m),n.a(_exn.E),t.c().bl.UserCulture,i.C(),n.a(_a.w),n.a(_a.e),n.a(_y.a),n.a(_ff.c),n.a(_exn.C),n.a(_exn.D),n.a(IExtensibilityStatistics),n.a(_a.h))}).b(IExtensibilityViewModelFactory).a()},b:function(){return null}};Type.registerNamespace("_exn");_exn.P=function(n,t,i){_exn.P.initializeBase(this);this.a=n;this.d=t;this.c=i};_exn.P.prototype={a:null,d:null,c:null,s:function(n){var i=new _g.nU(this.a,this.d,this.c);var t=new _g.Dh(this.x);t.actionName="Ext_ExecuteEwsProxy";n.bc(i,t,this.r,this.q)},cz:function(n,t,i){t()}};_exn.Q=function(n,t){_exn.Q.initializeBase(this);this.a=new Array(n.length);for(var i=0;i<n.length;i++){this.a[i]=new _g.je(t);this.a[i].Id=n[i]}};_exn.Q.prototype={a:null,s:function(n){var i=new _g.jW(this.y());i.Body.TokenRequests=this.a;var t=new _g.vh(this.x);t.actionName="Ext_GetUserIdentityToken";n.s(i,t,this.r,this.q)},cp:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&_exn.m.a().e(n.Token)}};_exn.I=function(n){_exn.I.initializeBase(this);this.a=n};_exn.I.prototype={a:null,s:function(n){var i=new _g.dR(_h.b.T());i.ItemIds=[new _g.g(this.a.bl.ItemId.Id)];var t=new _g.eC(this.x);t.clientStoreItem=0;var r=new _g.dQ(this.y(),i);n.a(r,t,this.r,this.q)},cp:function(n){var t=n.Items[0];this.a.gI(t.EntityExtractionResult)}};_exn.g=function(){_exn.g.initializeBase(this)};_exn.g.prototype={c:!1,e:null,a:0,d:null,f:function(n,t){if(OwaApplication.k||OwaApplication.b){_exn.g.a=new _g.jD;_exn.g.a.Extensions=new Array(0)}else if(!this.c){this.d=new _g.oW(n,t);this.c=!0;this.e=_a.c.a();OwaApplication.a.a(this)}},s:function(n){var t=new _g.Fo(this.x);t.actionName="Ext_LoadApps";n.by(this.d,t,this.r,this.q)},cz:function(n,t,i){this.a=_a.c.a().g(this.e);_exn.g.a=n;t()}};_exn.A=function(n,t){_exn.A.initializeBase(this);if(_js.d.a(t))throw Error.argument("scope","scope can not be null or empty.");this.a=new _g.je("ScopedToken");this.a.Id=n;this.a.Scope=t};_exn.A.prototype={a:null,c:null,s:function(n){var i=new _g.jW(this.y());i.Body.TokenRequests=[this.a];var t=new _g.vh(this.x);t.actionName="Ext_GetAttachmentToken";n.s(i,t,this.r,this.q)},cp:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&(this.c=n.Token)}};_exn.J=function(n,t){_exn.J.initializeBase(this);this.a=n;this.c=t};_exn.J.prototype={a:null,c:null,s:function(n){var i=new _g.qz(this.a,this.c);var t=new _g.IA(this.x);t.actionName="Ext_LoadExtensionCustomProperties";n.ck(i,t,this.r,this.q)},cz:function(n,t,i){t()}};_exn.R=function(n,t){_exn.R.initializeBase(this);_js.i.a(n,"marketplaceAssetId");this.c=n;this.a=t};_exn.R.prototype={c:null,a:0,s:function(n){var t=new _g.rt;t.Body=new _g.ru(this.c,this.a);var i=new _g.KG(this.x);n.fu(t,i,this.r,this.q)},cz:function(n,t,i){if(null===n){i(Error.create("RegisterConsentAction failed."));return}_js.Trace.logInfo(_a.a.j,"RegisterConsent Web Service request successful.");t()}};_exn.S=function(n){_exn.S.initializeBase(this);_a.b.c(n,"input");this.a=n};_exn.S.prototype={a:null,s:function(n){var t=new _g.LG(this.x);n.cq(this.a,t,this.r,this.q)},cz:function(n,t,i){if(null===n){i(Error.create("SanitizeHtmlAction failed."));return}_js.Trace.logInfo(_a.a.j,"SanitizeHtml Web Service request successful.");t()}};_exn.T=function(n,t,i){_exn.T.initializeBase(this);this.a=n;this.c=t;this.d=i};_exn.T.prototype={a:null,c:null,d:null,s:function(n){var i=new _g.rO(this.a,this.c,this.d);var t=new _g.LI(this.x);t.actionName="Ext_SaveExtensionCustomProperties";n.cs(i,t,this.r,this.q)},cz:function(n,t,i){t()}};_exn.U=function(n,t,i){_exn.U.initializeBase(this);this.a=n;this.c=t;this.d=i};_exn.U.prototype={a:null,c:null,d:null,s:function(n){var i=new _g.rP(this.a,this.c,this.d);var t=new _g.LJ(this.x);t.actionName="Ext_SaveExtensionSettings";n.ct(i,t,this.r,this.q)},cz:function(n,t,i){t()}};_exn.m=function(){this.b={};this.a={}};_exn.m.a=function(){$a(_exn.m.b)&&(_exn.m.b=new _exn.m);return _exn.m.b};_exn.m.prototype={e:function(n){switch(n.TokenType){case"CallerIdentity":this.b[n.Id]=new _exn.m.c(n);break;case"ExtensionCallback":this.a[n.Id]=new _exn.m.c(n);break;default:var t=String.format("Error: ClientAccessTokenCache.AddToken type not supported - {0}",_js.l.b(_g.ue,n));_js.Trace.logError(_a.a.R,t);break}},d:function(n){return n in this.b&&!this.b[n].b()},c:function(n){return n in this.a&&!this.a[n].b()},g:function(n){return this.d(n)?this.b[n].a:null},f:function(n){return this.c(n)?this.a[n].a:null},i:function(){var t=this.b;for(var n in t){var i={key:n,value:t[n]};if(i.value.b())return!0}return!1},h:function(){var t=this.a;for(var n in t){var i={key:n,value:t[n]};if(i.value.b())return!0}return!1}};_exn.m.c=function(n){this.c=new Date;this.a=n};_exn.m.c.prototype={c:null,a:null,b:function(){var t=new Date;var n=t.getTime()-this.c.getTime();return n>=(this.a.TTL-15)*6e4}};_exn.bM=function(){};_exn.bf=function(){_exn.bf.initializeBase(this,[1,"VM.Extensibility.Stats"])};_exn.bf.prototype={d:function(n){this.a.ContextRetrievalTime=n;return n},c:function(n){this.a.ContextExtensionsCount=n;return n},p:function(n){this.a.MaxCountOfActiveExtensions=n;return n},b:function(n){this.a.ActivationTime=n;return n},s:function(n){this.a.TotalActivationStatistics=n;return n},r:function(n){this.a.RegExStatistics=n;return n},q:function(n){this.a.PerExtensionStatistics=n;return n},o:function(n){this.a.Interval=n;return n},l:function(n){this.a.FromHtmlStatistics=n;return n},n:function(n){this.a.InnerTextStatistics=n;return n},m:function(n){this.a.HtmlBodyLengthStatistics=n;return n},e:function(n){this.a.ConvertedBodyLengthStatistics=n;return n},i:function(n){this.a.EntityStatistics=n;return n}};_exn.C=function(n,t,i){this.c=n;this.a=t;this.b=i||null};_exn.C.prototype={c:null,a:null,b:null,e:function(n){return new _exn.l(this.c,n,this.a)},d:function(n){return new _exn.be(this.a,n,this.b)}};_exn.be=function(n,t,i){this.d=n;this.e=t;this.f=i||null};_exn.be.prototype={d:null,f:null,e:0,a:function(n,t,i){for(var y=_a.d.b(_a.a.j,"AppActivationInComposeForm",!0),p=_a.c.a(),h=new _ff.e,u=0;u<t.length;u++){var a=t[u];var r;var e,c;if(c=_exn.i.b(a,new _exn.M(this.d,this.e,!1),e={val:r}),r=e.val,c){var o=null;var w=_a.c.a();var l,s;var f=r.g?(s=r.g.b(null,r.e,l={val:o}),o=l.val,s):!1;var v=_a.c.a();f&&h.c(r);this.d.d(a.Id,v.g(w),f)}}this.d.f(_a.c.a().g(p));i(h);this.d.b();_a.d.a(y)},c:function(n){return!0},b:function(){}};_exn.l=function(n,t,i){this.g=t;this.e=i;this.f=n};_exn.l.c=function(){_exn.l.b||(_exn.l.b=["junkemail","drafts"]);return _exn.l.b};_exn.l.e=function(n){if(n.d.Type==="Preinstalled"&&!n.d.ConsentState){for(var u=!1,f=!1,r=n.d.FormSettingsList,e=r.length,t=0;t<e;++t){var i=r[t];i.SettingsType===1?u=!0:i.SettingsType||(f=!0)}if(f&&u)return!0}return!1};_exn.l.d=function(n,t){return $a(n)?!1:!$a(n.FlightResevations)&&n.FlightResevations.length>0&&t.d.Id.toLowerCase()==="dbe7be59-905f-4ab0-acee-b0107b46080c"?!0:!$a(n.ParcelDeliveries)&&n.ParcelDeliveries.length>0&&t.d.Id.toLowerCase()==="22a05a7b-2faf-4c2c-aa31-7aa58170cb97"?!0:!1};_exn.l.prototype={g:!1,e:null,d:null,f:null,a:function(n,t,i){var o=!0;this.d=new _ff.e;for(var r,u=0;u<t.length;u++){var e,f;if(f=_exn.i.b(t[u],new _exn.M(this.e,1,this.g),e={val:r}),r=e.val,f){this.d.c(r);r.g&&!r.g.h(n,r.e)&&(o=!1)}}o?this.h(n,i):this.i(n,i)},c:function(n){if(n.by()||n.bl.IsDraft)return!1;if(n.bl.ItemClass){var t=n.bl.ItemClass.toLowerCase();if(t.startsWith("report")||-1!==t.indexOf(".smime"))return!1}return n.bl.ParentFolderId&&!this.j(n.bl.ParentFolderId.Id)?!1:!0},b:function(){this.d=null},k:function(n,t,i){if($a(t)||$a(t.g)||_exn.l.e(t))return!1;var r=!1;t.e.c={};r=!!(r|t.g.b(n,t.e,i));r=!!(r|_exn.l.d(n.bl.EntityExtractionResult,t));return r},j:function(n){if(!_exn.l.a){_exn.l.a={};for(var t=0;t<_exn.l.c().length;t++){var r=_exn.l.c()[t];var i=this.f.nameToId(r);i&&(_exn.l.a[i.Id]=!0)}}return!(n in _exn.l.a)},h:function(n,t){if(this.d){var l=_a.d.b(_a.a.j,"AppActivationInReadingPane",!0);var o=new _ff.e;this.e.i(n.bl.PropertyExistence,n.bl.EntityExtractionResult);for(var c=_a.c.a(),s=null,r=0;r<this.d.d.length;r++){var i=this.d.d[r];var a=_a.c.a();var e,f;var u=(f=this.k(n,i,e={val:s}),s=e.val,f);var h=_a.c.a();if(u){o.c(i);i.t(n.bl.EntityExtractionResult)}this.e.d(i.d.Id,h.g(a),u)}this.e.f(_a.c.a().g(c));t(o);this.d=null;this.e.b();_a.d.a(l)}},i:function(n,t){var i=new _exn.I(n);var r=this;i.w(function(i){r.h(n,t)});OwaApplication.a.a(i)}};_exn.V=function(n,t,i,r){this.o=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);_exn.V.initializeBase(this,[i,r]);this.k=n;this.p=t};_exn.V.a=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_exn.V.prototype={k:null,p:null,j:null,f:function(){var n;if(!this.r()){this.i();return}var r,i,t;if(t=this.q(r={val:n},i={val:this.j}),n=r.val,this.j=i.val,t){this.j.O(this.l);this.j.H(this.o)}else{this.h(n,null);return}},t:function(n){this.j.z(this.o);if(n.k()){var i=_exn.V.a(n.L());this.h(i,null);return}var t=this.p.d(this.j);this.g(t,null)},s:function(n,t){if(t==="IsDeleted"&&this.j.y()){this.j.u(this.l);this.h(9006,null)}}};_exn.W=function(n,t,i,r){_exn.W.initializeBase(this,[n,t,i,r])};_exn.W.prototype={b:function(){return"AddFileAttachment"},c:function(){return 3},r:function(){var t=this.a.uri;var n=this.a.name;if(_js.d.a(t)||_js.d.a(n)){_js.Trace.logError(_a.a.j,"AddFileAttachment got null or empty uri or name");return!1}else if(t.length>2048||n.length>255){_js.Trace.logError(_a.a.j,"AddFileAttachment got too long uri or name");return!1}else return!0},q:function(n,t){var r=this.a.uri;var i=this.a.name;t.val=this.k.l(r,i,n);return!!t.val}};_exn.X=function(n,t,i,r){_exn.X.initializeBase(this,[n,t,i,r])};_exn.X.prototype={b:function(){return"AddItemAttachment"},c:function(){return 3},r:function(){var t=this.a.itemId;var n=this.a.name;if(_js.d.a(t)||_js.d.a(n)){_js.Trace.logError(_a.a.j,"AddItemAttachment got null or empty itemId or name");return!1}else if(t.length>200||n.length>255){_js.Trace.logError(_a.a.j,"AddItemAttachment got too long itemId or name");return!1}else return!0},q:function(n,t){var r=this.a.itemId;var u=this.a.name;var i=new _g.A;i.p(new _g.g(r));i.e(u);i.f(!1);i.h(0);t.val=this.k.m(i,n);return!!t.val}};_exn.K=function(n,t,i,r){_exn.K.initializeBase(this,[t,i]);this.k=n;this.j=r};_exn.K.prototype={j:!1,k:null,b:function(){return this.j?"SetRecipients":"AddRecipients"},c:function(){return 3},l:function(n,t){t.val=new _ff.e;if($a(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.a.j,"Add/SetRecipientsAsync null for both displayName and address");this.i();return!1}if(r&&r.length>255){_js.Trace.logError(_a.a.j,"Add/SetRecipientsAsync got displayName lengths over the limit");this.i();return!1}if(_a.D.a(f)){var i=new _g.d;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.c(i)}}if(t.val.d.length>0)return!0;else{this.h(9013,null);return!1}},f:function(){var u=this.a.recipientField;var r=this.a.recipientArray;var n;if(r.length>100){_js.Trace.logError(_a.a.j,"Add/SetRecipientsAsync got more recipients in the list than the per-call limit.");this.i();return}var t,i;if(i=this.l(r,t={val:n}),n=t.val,i){if(this.j)this.k.x(u,n);else if(!this.k.B(u,n)){this.h(9012,null);return}this.g(null,null)}}};_exn.bJ=function(n,t){this.a=n;this.m=t};_exn.bJ.prototype={a:null,m:null,d:null,e:function(n){if(!this.u(n)){_js.Trace.logError(_a.a.j,String.format("API call failing due to insufficient permission {0}",this.b()));this.i();return}this.d=_a.d.b(_a.a.j,this.b(),!0);this.f()},g:function(n,t){this.m(_exn.b.j(n));if(this.d){this.d.l=t;_a.d.a(this.d);this.d=null}},h:function(n,t){this.m(_exn.b.i(n));if(this.d){this.d.l=t;this.d.k=_exn.z.b(n);_a.d.a(this.d);this.d=null}},n:function(n,t){this.m(n);if(this.d){this.d.l=t;_a.d.a(this.d);this.d=null}},v:function(n,t,i){this.m(n);if(this.d){this.d.k=t;this.d.l=i;_a.d.a(this.d);this.d=null}},i:function(){this.m(null);if(this.d){this.d.k="NonAPI";_a.d.a(this.d);this.d=null}},u:function(n){return n===2?!0:this.c()===2?!1:n>=this.c()}};_exn.Y=function(n,t,i,r){_exn.Y.initializeBase(this,[n,t,i,r])};_exn.Y.prototype={b:function(){return"BodyPrepend"},c:function(){return 3},l:function(n){this.j.f(n,this.k===3);this.g(null,null)}};_exn.Z=function(n,t,i,r){_exn.Z.initializeBase(this,[n,t,i,r])};_exn.Z.prototype={b:function(){return"BodySetSelectedData"},c:function(){return 3},l:function(n){this.j.e(n,this.k===3);this.g(null,null)}};_exn.ba=function(n,t,i){_exn.ba.initializeBase(this,[t,i]);this.j=n};_exn.ba.prototype={j:null,b:function(){return"Close"},c:function(){return 0},f:function(){this.j.o();this.g(null,null)}};_exn.bK=function(){};_exn.bK.a=function(){};_exn.bK.a.prototype={text:0,html:3};_exn.bK.a.registerEnum("_exn.bK.a",!1);_exn.bc=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.ba=Function.createDelegate(this,this.bT);this.Y=Function.createDelegate(this,this.bR);this.bb=Function.createDelegate(this,this.bU);this.Z=Function.createDelegate(this,this.bS);_exn.bc.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.k=n};_exn.bc.prototype={k:null,r:function(){return 1},d:function(n,t){n.itemType=5;var i=this;_exn.bL.prototype.d.call(this,n,function(){t()})},o:function(n){n.h([_exn.a.a("GetTimeAsync",this.Z),_exn.a.a("SetTimeAsync",this.bb),_exn.a.a("GetLocationAsync",this.Y),_exn.a.a("SetLocationAsync",this.ba)]);_exn.bL.prototype.o.call(this,n)},bS:function(n,t){new _exn.bt(this.k,n,t).e(this.a.d.RequestedCapabilities)},bU:function(n,t){new _exn.bF(this.k,n,t).e(this.a.d.RequestedCapabilities)},bT:function(n,t){new _exn.bC(this.k,n,t).e(this.a.d.RequestedCapabilities)},bR:function(n,t){new _exn.bq(this.k,n,t).e(this.a.d.RequestedCapabilities)}};_exn.bd=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_exn.bd.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p])};_exn.bd.prototype={r:function(){return 2},d:function(n,t){var r=this.b.bl.ItemClass?this.b.bl.ItemClass.toLowerCase():"";if(_exn.w.a(r)){n.itemType=2;var i=this.b;this.Z(i,n)}var u=this;_exn.h.prototype.d.call(this,n,function(){t()})},Z:function(n,t){if(!!this.a.d.RequestedCapabilities){_exn.h.a(t,"to",n.p(),n.bl.Organizer);_exn.h.a(t,"cc",n.s(),null);_exn.h.a(t,"resources",n.D(),null);n.bl.Organizer&&_exn.h.b(t,"organizer",n.bl.Organizer)}n.q()&&(t.location=n.q().bl.DisplayName);n.a()&&(t.start=n.a().y().getTime());n.b()&&(t.end=n.b().y().getTime())}};_exn.bL=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.bp=Function.createDelegate(this,this.ci);this.bf=Function.createDelegate(this,this.bY);this.bq=Function.createDelegate(this,this.cj);this.bi=Function.createDelegate(this,this.cb);this.bj=Function.createDelegate(this,this.cc);this.bh=Function.createDelegate(this,this.ca);this.bg=Function.createDelegate(this,this.bZ);this.bn=Function.createDelegate(this,this.cg);this.bt=Function.createDelegate(this,this.cm);this.bs=Function.createDelegate(this,this.cl);this.bl=Function.createDelegate(this,this.ce);this.bu=Function.createDelegate(this,this.cn);this.bm=Function.createDelegate(this,this.cf);this.br=Function.createDelegate(this,this.ck);this.be=Function.createDelegate(this,this.bX);this.bk=Function.createDelegate(this,this.cd);this.bo=Function.createDelegate(this,this.ch);this.bc=Function.createDelegate(this,this.bV);this.bd=Function.createDelegate(this,this.bW);_exn.bL.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.b=n};_exn.bL.prototype={b:null,D:null,Q:function(){return"ComposeAppSelection"},R:function(){return"ComposeAppSelectionToProgressDone"},M:function(){this.D||(this.D=new _exn.bj(this.a.d.Id));return this.D},bW:function(n,t){new _exn.X(this.b,this.M(),n,t).e(this.a.d.RequestedCapabilities)},bV:function(n,t){new _exn.W(this.b,this.M(),n,t).e(this.a.d.RequestedCapabilities)},ch:function(n,t){new _exn.by(this.M(),n,t).e(this.a.d.RequestedCapabilities)},cd:function(n,t){new _exn.N(this.b,n,t).e(this.a.d.RequestedCapabilities)},ck:function(n,t){new _exn.K(this.b,n,t,!0).e(this.a.d.RequestedCapabilities)},bX:function(n,t){new _exn.K(this.b,n,t,!1).e(this.a.d.RequestedCapabilities)},cf:function(n,t){new _exn.bs(this.b,n,t).e(this.a.d.RequestedCapabilities)},cn:function(n,t){new _exn.bE(this.b,n,t).e(this.a.d.RequestedCapabilities)},ce:function(n,t){new _exn.br(this.b,n,t).e(this.a.d.RequestedCapabilities)},cl:function(n,t){new _exn.bD(this.b,n,t,this.f).e(this.a.d.RequestedCapabilities)},cm:function(n,t){new _exn.Z(this.b,n,t,this.f).e(this.a.d.RequestedCapabilities)},cg:function(n,t){new _exn.Y(this.b,n,t,this.f).e(this.a.d.RequestedCapabilities)},cc:function(n,t){new _exn.bp(this.b,n,t).e(this.a.d.RequestedCapabilities)},cb:function(n,t){new _exn.bo(this.b,n,t).e(this.a.d.RequestedCapabilities)},cj:function(n,t){new _exn.bB(this.b,n,t,this.f).e(this.a.d.RequestedCapabilities)},bY:function(n,t){new _exn.ba(this.b,n,t).e(this.a.d.RequestedCapabilities)},ci:function(n,t){new _exn.bA(this.b,n,t).e(this.a.d.RequestedCapabilities)},d:function(n,t){t()},o:function(n){_exn.b.prototype.o.call(this,n);n.h([_exn.a.a("AddItemAttachmentAsync",this.bd),_exn.a.a("AddFileAttachmentAsync",this.bc),_exn.a.a("RemoveAttachmentAsync",this.bo),_exn.a.a("GetRecipientsAsync",this.bk),_exn.a.a("AddRecipientsAsync",this.be),_exn.a.a("SetRecipientsAsync",this.br),_exn.a.a("GetSubjectAsync",this.bm),_exn.a.a("SetSubjectAsync",this.bu),_exn.a.a("GetSelectedDataAsync",this.bl),_exn.a.a("SetSelectedDataAsync",this.bs),_exn.a.a("BodySetSelectedDataAsync",this.bt),_exn.a.a("BodyPrependAsync",this.bn),_exn.a.a("LoadCustomProperties",this.bg),_exn.a.a("SaveCustomProperties",this.bh),_exn.a.a("GetBodyTypeAsync",this.bj),_exn.a.a("GetBodyAsync",this.bi),_exn.a.a("SetBodyAsync",this.bq),_exn.a.a("Close",this.bf),_exn.a.a("SaveAsync",this.bp)])},ca:function(n,t){new _exn.G(this.b,n,this.a.d.Id,t).e(this.a.d.RequestedCapabilities)},bZ:function(n,t){new _exn.bv(this.b,n,this.a.d.Id,this.f,t).e(this.a.d.RequestedCapabilities)}};_exn.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.bA=Function.createDelegate(this,this.ct);this.bD=Function.createDelegate(this,this.cA);this.bw=Function.createDelegate(this,this.cp);this.bv=Function.createDelegate(this,this.co);this.bx=Function.createDelegate(this,this.cq);this.bz=Function.createDelegate(this,this.cs);this.bI=Function.createDelegate(this,this.cG);this.bG=Function.createDelegate(this,this.cD);this.bF=Function.createDelegate(this,this.cC);this.bB=Function.createDelegate(this,this.cu);this.by=Function.createDelegate(this,this.cr);this.bC=Function.createDelegate(this,this.cw);this.bE=Function.createDelegate(this,this.cB);this.bH=Function.createDelegate(this,this.cF);_a.b.b(a,"nativeBridge");this.e=n;this.V=t;this.L=i;this.W=r;this.X=u;this.O=f;this.N=e;this.U=o;this.J=s;this.S=h;this.T=c;this.g=a;this.f=v;this.B=_a.bb.a()};_exn.b.h=function(){_exn.b.c||(_exn.b.c=String.format(_u.S.B,3));return _exn.b.c};_exn.b.g=function(){_exn.b.e||(_exn.b.e={wasSuccessful:!1,errorMessage:_exn.b.h()});return _exn.b.e};_exn.b.k=function(){_exn.b.d||(_exn.b.d={wasProxySuccessful:!1,errorMessage:_exn.b.h()});return _exn.b.d};_exn.b.l=function(){_exn.b.f||(_exn.b.f={error:1,errorMessage:_exn.b.h()});return _exn.b.f};_exn.b.j=function(n){return{error:0,data:n}};_exn.b.i=function(n){return{error:1,errorCode:n}};_exn.b.m=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_exn.b.prototype={L:null,W:null,X:null,e:null,V:null,w:null,H:null,a:null,K:0,y:null,J:null,f:null,O:null,N:null,U:null,S:null,T:null,s:null,t:null,l:0,i:null,F:0,v:0,x:0,z:!1,E:!1,n:null,p:null,q:null,j:null,A:!1,g:null,B:null,C:null,I:0,cz:function(n,t,i){this.a=n;this.w=t;this.H=i;this.C={};try{window.msWriteProfilerMark=this.bH}catch(r){_js.Trace.logException(_a.a.j,r,"Unable to write to Window object for MsWriteProfileMarkHandler.")}},cH:function(){try{window.msWriteProfilerMark=null}catch(n){}this.l=0},cw:function(n,t){var u=_a.c.a();var f=_js.e.s(_a.a.j,517,"GetInitialData");var i={};i.permissionLevel=this.a.d.RequestedCapabilities;i.timeZoneOffsets=this.cy();i.hostVersion=this.e.y();i.owaView=_exn.b.m(this.e.a());i.marketplaceAssetId=this.a.d.MarketplaceAssetID;i.marketplaceContentMarket=this.a.d.MarketplaceContentMarket;i.entryPointUrl=this.a.i;i.consentMetadata=this.a.d.ConsentMetadata;i.isRead=this.r()===2||this.r()===4;i.overrideWindowOpen=this.g.b(this.g.f())&&this.g.f().b().a();if(!!this.a.d.RequestedCapabilities){i.userDisplayName=this.W;i.userEmailAddress=this.X;i.userTimeZone=this.L;i.ewsUrl=this.w.EwsUrl}var r=this;this.d(i,function(){_js.e.e(f);r.I=_a.c.a().g(u);t(i);r.z=!0;r.G()})},cE:function(){if(!this.A){if(!this.j){this.j=new _ff.e;this.o(this.j)}for(var t=0;t<this.j.d.length;t++){var n=this.j.d[t];this.y.registerMethod(n.a,n.c,0,n.b)}this.g.b(this.g.f())&&this.g.f().b().a()&&this.y.unregisterMethod("ContextActivationManager_openWindowInHost");this.A=!0}},cI:function(){if(this.A&&this.j){for(var n=0;n<this.j.d.length;n++){var t=this.j.d[n];this.y.unregisterMethod(t.a)}this.A=!1}},setServiceEndPoint:function(n){this.y=n},bP:function(){this.z=!1;this.E=!1;this.F=0;this.I=0;this.v=0;this.x=0;this.s=_a.d.b(_a.a.j,this.Q(),!0);this.t=_a.d.b(_a.a.j,this.R())},G:function(){if(this.s){this.P(!1);var n=this.z?"":"Failed";this.s.k=n;this.s.j=this.bL();_a.d.a(this.s);this.s=null}},cr:function(n,t){this.n=_a.d.b(_a.a.j,"ExecuteEwsRequest",!0);var i=this.a.d;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.a.j,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_exn.b.a);this.c(this.n,"InsufficientPermission",null);return}var s=n;var e=s.body;var o=_exn.m.a();if($a(e)||this.h(e.length,_y.eS.a,"ExecuteEwsRequest")){t(_exn.b.a);this.c(this.n,"MaxRequestSizeExceeded",null);return}var r,u;if(!(u=this.u(r={val:t},_exn.b.k()),t=r.val,u)){this.c(this.n,"AsyncLimitExceeded",null);return}if(!o.c(i.Id)||o.h()){var h=this,f=this;this.bJ("ExtensionCallback",function(r){h.bM(i,n,t)},function(n){t({wasProxySuccessful:!1});f.m(f.n,n)})}else this.bM(i,n,t)},cu:function(n,t){this.q=_a.d.b(_a.a.j,"ExecuteSaveSettingsRequest",!0);var r=this.a;var c=n;var o=c[0];var s=JsonParser.serialize(o);if(this.h(s.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.c(this.q,"ApiLimitExceeded",null);return}var h,f;if(!(f=this.u(h={val:t},_exn.b.l()),t=h.val,f)){this.c(this.q,"AsyncLimitExceeded",null);return}var i=new _exn.U(r.d.Id,r.d.Version,s);var u=this;i.w(function(n){if(i.A.WasSuccessful){r.r(o);t({error:0});_a.d.a(u.q)}else{t({errorMessage:i.A.ErrorMessage,error:1});u.c(u.q,"ActionResultFailed",i.A.ErrorMessage)}});var e=this;i.v(function(n){t({errorMessage:i.t.message,error:1});e.m(e.q,n)});this.f.a(i)},cs:function(n,t){this.p=_a.d.b(_a.a.j,"ExecuteGetUserIdentityTokenRequest",!0);if(!this.a.d.RequestedCapabilities){_js.Trace.logInfo(_a.a.j,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.a.d.DisplayName);t(_exn.b.a);this.c(this.p,"InsufficientPermission",null);return}var e=_exn.m.a();var i=this.a.d.Id;if(!e.d(i)||e.i()){var o,f;if(!(f=this.u(o={val:t},_exn.b.g()),t=o.val,f)){this.c(this.p,"AsyncLimitExceeded",null);return}var r=this,u=this;this.bJ("CallerIdentity",function(n){r.bN(i,t);_a.d.a(r.p)},function(n){t({wasSuccessful:!1});u.m(u.p,n)})}else{this.bN(i,t);_a.d.a(this.p)}},cq:function(n,t){var u=_a.d.b(_a.a.j,"ExecuteDisplayNewAppointmentForm",!0);try{var f=n;var i=this.cv(f);if(!i){t(null);this.c(u,"NullComposeParameters",null);return}var r=this;this.O.a(function(n){if(r.e.a()==="Mouse"){var e=n.c(i);r.e.g(IComposeCalendarItemViewModelFactory,null,null,_bc.c.b(),e,!1)}else{var f=n.b(i.a,null,null);r.bO(f)}_a.d.a(u);t(null)})}catch(e){_a.d.g(u,e);throw e;}},co:function(n,t){var u=_a.d.b(_a.a.j,"ExecuteDisplayExistingAppointmentForm",!0);try{var e=n;var f=e.itemId;if(_js.d.a(f)){t(null);this.c(u,"NullItemId",null);return}var i=new _y.I;i.b(new _g.g(f));var r=this;this.N.a(function(n){if(r.e.a()==="Mouse")r.e.g(ICalendarItemDetailsViewModelFactory,null,i.a,_bc.c.b(),null,!1);else{var f=n.b(i.a,null,null);r.bO(f)}_a.d.a(u);t(null)})}catch(o){_a.d.g(u,o);throw o;}},cp:function(n,t){var i=_a.d.b(_a.a.j,"ExecuteDisplayExistingMessageForm",!0);try{var r=n;this.cx(r.itemId,this.bE);_a.d.a(i)}catch(u){_a.d.g(i,u);throw u;}t(null)},cA:function(n,t){if(this.g.b(this.g.f())){var i=n.launchUrl;i&&this.g.f().a(i)}t(null)},cC:function(n,t){var r=n;if(this.a.d.Origin==="Default"){var i=new _exn.bn(this.a.d.DisplayName.replace(_exn.b.b,""));i.b(r);i.c()}t(null)},cD:function(n,t){var i=n;if(this.a.d.Origin!=="Default"){t(null);return}var f=_a.a.j;var u="[{0}] {1}";var r=this.a.d.DisplayName.replace(_exn.b.b,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(f,u,r,i.Message);break;case"Error":_js.Trace.logError(f,u,r,i.Message);break;default:break}t(null)},ct:function(n,t){this.a.d.Type!=="Preinstalled"||this.a.d.ConsentState||new _exn.bx(n,t,this.f).e(2)},cG:function(n,t){var r=n;if(this.a.d.Origin!=="Default"){t(null);return}var i=this.a.d.DisplayName.replace(_exn.b.b,"")+"."+r.Name.replace(_exn.b.b,"");var u=r.Event;switch(u){case"Start":_a.k.b(_a.a.j,i);break;case"End":_a.k.a(i);break;default:break}t(null)},cy:function(){return this.V.k(this.L)},P:function(n){if(this.t){this.t.k=n?null:"Failed";this.t.j=this.bL();_a.d.a(this.t);this.t=null}},m:function(n,t){var i=t;var r=i.t?i.t.message:null;if(n){n.k=i.D();n.n=r;n.l=i.B();_a.d.a(n)}},c:function(n,t,i){if(n){n.k=t;n.n=i;_a.d.a(n)}},o:function(n){n.h([_exn.a.b("GetInitialData",this.bC),_exn.a.a("EwsRequest",this.by),_exn.a.a("saveSettingsAsync",this.bB),_exn.a.a("RecordDataPoint",this.bF),_exn.a.a("RecordTrace",this.bG),_exn.a.a("TrackCtq",this.bI),_exn.a.a("GetUserIdentityToken",this.bz),_exn.a.a("DisplayNewAppointmentForm",this.bx),_exn.a.a("DisplayExistingAppointmentForm",this.bv),_exn.a.a("DisplayExistingMessageForm",this.bw),_exn.a.a("LaunchPalUrl",this.bD),_exn.a.a("RegisterConsentAsync",this.bA)])},h:function(n,t,i){if(n>t){_js.Trace.logWarning(_a.a.j,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",i,this.a.d.DisplayName,t,n);return!0}return!1},u:function(n,t){if(this.K<3){var r=n.val;var i=this;n.val=function(n){i.K--;r(n)};this.K++;return!0}n.val(t);return!1},cF:function(n){if(!_js.d.a(n)){n===OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd?this.P(!0):n===OSF.OsfControlActivationPerfMarker.SelectionTimeout?this.P(!1):n===OSF.OsfControlActivationPerfMarker.ActivationStart&&this.F++;if(n.endsWith("Start")){n=n.substr(0,n.length-5);var i=_js.e.s(_a.a.j,517,n);this.C[n]=i}else if(n.endsWith("End")){n=n.substr(0,n.length-3);var t=this.C[n];if(t){_js.e.e(t);delete this.C[n]}}}},bN:function(n,t){var i="";_exn.m.a().d(n)&&(i=_exn.m.a().g(n).TokenValue);t({wasSuccessful:!0,token:i})},bJ:function(n,t,i){for(var f=new _ff.e,r=0;r<this.w.Extensions.length;r++){var e=this.w.Extensions[r];(n==="CallerIdentity"&&e.RequestedCapabilities>=1||n==="ExtensionCallback"&&e.RequestedCapabilities===2)&&f.c(this.w.Extensions[r].Id)}var u=new _exn.Q(f.i(),n);u.w(t);u.v(i);this.f.a(u)},bM:function(n,t,i){var s=t;var e=s.body;var u="";if(_exn.m.a().c(n.Id)){u=_exn.m.a().f(n.Id).TokenValue;var r=new _exn.P(e,u,n.Id);var o=this;r.w(function(n){i({wasProxySuccessful:r.A.WasProxySuccessful,errorMessage:r.A.ErrorMessage,statusCode:r.A.StatusCode,statusDescription:r.A.StatusDescription,body:r.A.Body});_a.d.a(o.n)});var f=this;r.v(function(n){i({wasProxySuccessful:!1,errorMessage:r.t.message,statusCode:500,statusDescription:r.t.message,body:null});f.m(f.n,r)});this.f.a(r)}else i({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})},bL:function(){if(!this.l){var r=this.B.b("ExtAppVistedUrls");var u=this.a.i.toLowerCase();this.l=_js.d.a(r)?3:-1!==r.indexOf(u)?1:2}if(!this.E&&this.z&&this.l!==1){var t=this.B.b("ExtAppVistedUrls");var i=this.a.i.toLowerCase();if(t){t.length>5e3&&(t=t.substr(i.length));t+=i}else t=i;this.B.a("ExtAppVistedUrls",t);this.E=!0}var n=new _a.r;n.a("G",this.I);n.a("S",this.l);n.a("Sc",this.r());this.v&&n.a("E",this.v);n.a("R",this.F);n.a("F",this.x);n.b("Id",this.a.d.Id);n.b("Name",this.a.d.DisplayName);return n.toString()},cB:function(n){if(n.bl.IsDraft){var i=this;this.J.a(function(t){var r=t.a(!0,!1);r.cR(n);i.U.a(function(n){i.e.g(IMailComposeViewModelFactory,function(){return n},null,_bc.c.b(),r,!1)})})}else{var t=this;this.S.a(function(i){var r=i.a(!1);r.a(n);t.T.a(function(n){t.e.g(IItemReadingPaneViewModelPopOutFactory,function(){return n},null,_bc.c.b(),r,!1)})})}},cv:function(n){var t=new _bc.p;if("requiredAttendees"in n){t.h(new _js.f);var e=n.requiredAttendees;if(this.h(e.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var f=0;f<e.length;f++)t.n().a(_g.t.c(e[f]))}if("optionalAttendees"in n){t.w(new _js.f);var o=n.optionalAttendees;if(this.h(o.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var i=0;i<o.length;i++)t.m().a(_g.t.c(o[i]))}if("start"in n&&!$a(n.start)){var v=n.start;var w=new Date(v);t.b(_a.c.bG(w))}else{var a=_a.v.d(_a.c.a());t.b(a)}if("end"in n){var p=n.end;var y=new Date(p);t.c(_a.c.bG(y).g(t.g()))}else t.c(18e5);if("subject"in n){var s=n.subject;if(this.h(s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;t.j(s)}if("body"in n){var u=n.body;if(this.h(u.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var r;r=this.e.a()==="Mouse"?new _g.G("HTML",_a.u.j(u)):new _g.G("Text",u);var l=new _g.w(r);t.o(l)}var h=_g.y.c();if("location"in n){var c=n.location;if(this.h(c.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;h.f(c)}t.l(h);return t},cx:function(n,t){var f=_h.e.a();var i=f.a(n);if($a(i)||$a(i.z()))if(!$a(i)&&i.bl.IsDraft)this.bK(n,i.cJ(),t);else{var u=this;var r=function(i){i.bl.IsDraft?u.bK(n,i.cJ(),t):t(i)};this.bQ(n,_h.b.J(),"ItemNormalizedBody",r)}else t(i)},bK:function(n,t,i){var r;r=this.e.a()==="Mouse"&&t!==1?_h.b.c():_h.b.m();this.bQ(n,r,"MailCompose",i)},bQ:function(n,t,i,r){var f=new _g.g(n);var u=new _h.cA(100,[f],t,i,0,!1);var o=this;u.w(function(t){var i=_h.e.a().a(n);r(i)});var e=this;u.v(function(n){_js.Trace.logError(_a.a.j,String.format("GetItem failed with {0}",n.t))});this.f.a(u)},bO:function(n){this.e.d(n)}};_exn.D=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.j=n;this.l=t;this.m=i;this.n=r;this.i=u;this.d=f;this.e=e;this.f=o;this.p=s;this.k=h;this.h=c;this.a=l;this.o=a};_exn.D.prototype={j:null,l:null,m:null,n:null,i:null,f:null,p:null,d:null,e:null,o:null,b:null,g:null,c:null,k:null,h:null,a:null,t:function(n){return new _exn.bi(this.i,this.j,this.n,this.l,this.m,n,this.c,this.b,this.g,this.f,this.p,this.d,this.e,this.k,this.h,this.a,this.o)},r:function(){return new _exn.bd(this.i,this.j,this.n,this.l,this.m,this.c,this.b,this.g,this.f,this.p,this.d,this.e,this.k,this.h,this.a,this.o)},s:function(n){return new _exn.bh(n,this.i,this.j,this.n,this.l,this.m,this.c,this.b,this.g,this.f,this.d,this.e,this.k,this.h,this.a)},q:function(n){return new _exn.bc(n,this.i,this.j,this.n,this.l,this.m,this.c,this.b,this.g,this.f,this.d,this.e,this.k,this.h,this.a)}};_exn.bh=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_exn.bh.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.k=n};_exn.bh.prototype={k:null,r:function(){return 3},d:function(n,t){n.itemType=4;n.conversationId=this.k.g();var i=this;_exn.bL.prototype.d.call(this,n,function(){t()})}};_exn.bi=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_exn.bi.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w])};_exn.bi.prototype={r:function(){return 4},d:function(n,t){var i=this.b.bl.ItemClass?this.b.bl.ItemClass.toLowerCase():"";if(_exn.w.b(i)){if(_g.H.isInstanceOfType(this.b)){n.itemType=3;this.bj(n)}else n.itemType=1;this.bl(n,t)}else _exn.h.prototype.d.call(this,n,t)},bl:function(n,t){var r=this.b;n.conversationId=r.bl.ConversationId?r.bl.ConversationId.Id:null;n.internetMessageId=r.bl.InternetMessageId;if(this.a.d.RequestedCapabilities)if(r.bG){this.x|=16;var i=new _h.cz(this.b.bl.ItemId);var f=this;i.v(function(){_js.Trace.logWarning(_a.a.j,"GetAllRecipients to fetch extra recipients failed "+i.t);f.x|=256});var u=this;i.z(function(){u.Z(n,t)});OwaApplication.a.a(i)}else this.Z(n,t);else _exn.h.prototype.d.call(this,n,t)},Z:function(n,t){var i=this.b;_exn.h.b(n,"from",i.bl.From);_exn.h.b(n,"sender",i.bl.Sender);_exn.h.d(n,"to",i.k());_exn.h.d(n,"cc",i.m());n.itemType===3&&this.bk(n);_exn.h.prototype.d.call(this,n,t)},bk:function(n){var t=this.b;_exn.h.a(n,"to",t.v().p(),t.v().B());_exn.h.a(n,"cc",t.v().s(),null);_exn.h.a(n,"resources",t.v().D(),null)},bj:function(n){var t=this.b;t.v().r()&&(n.location=t.v().r().bl.DisplayName);t.v().c()&&(n.start=t.v().c().y().getTime());t.v().f()&&(n.end=t.v().f().y().getTime())}};_exn.bj=function(n){this.a={};this.b=n};_exn.bj.prototype={b:null,c:0,d:function(n){var t=this.b+(+new Date).toString()+this.c.toString();this.a[t]=n;this.c++;return t},e:function(n,t){this.a[n]=t;return n},f:function(n,t){var i=this.a[n];t&&delete this.a[n];return i}};_exn.h=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.bc=Function.createDelegate(this,this.bo);this.ba=Function.createDelegate(this,this.bm);this.bb=Function.createDelegate(this,this.bn);this.bf=Function.createDelegate(this,this.br);this.be=Function.createDelegate(this,this.bq);this.bd=Function.createDelegate(this,this.bp);_exn.h.initializeBase(this,[n,t,i,r,u,e,o,s,h,l,a,v,y,p]);this.k=f;this.M=w;this.Y=c};_exn.h.b=function(n,t,i){$a(i)||(n[t]=_exn.h.f(i.Mailbox))};_exn.h.d=function(n,t,i){if(!$a(i)&&i.b()>0){for(var f=[],r=0;r<i.b()&&r<500;r++){var u=i.a(r);$a(u)||(f[r]=_exn.h.f(u))}n[t]=f}};_exn.h.a=function(n,t,i,r){var f=null;var o=0;var s=!1;if(r&&r.Mailbox){s=!0;f=new Array(0);f[o++]=_exn.h.e(r.Mailbox,"Organizer")}if(!$a(i)&&i.b()>0){f||(f=new Array(0));for(var e=0;e<i.b()&&o<500;e++){var u=i.a(e);if(u&&u.bl.Mailbox){if(s&&r.Mailbox.EmailAddress&&u.bl.Mailbox.EmailAddress&&u.bl.Mailbox.EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;f[o++]=_exn.h.e(u.bl.Mailbox,u.a())}}}n[t]=f};_exn.h.f=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_exn.h.c(n.MailboxType);return t};_exn.h.c=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_exn.h.g=function(n,t){if(!$a(t)&&t.b()>0){for(var f=[],u=0;u<t.b();u++){var i=t.c(u);var r={};if(i){r.id=i.bl.AttachmentId.Id;r.name=i.bl.Name;r.contentType=i.bl.ContentType;r.size=i.a();r.attachmentType=_g.l.isInstanceOfType(i)?0:1;r.isInline=i.b();f[u]=r}}n.attachments=f}};_exn.h.e=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_exn.h.c(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};_exn.h.prototype={k:!1,M:null,Y:null,b:null,Q:function(){return"ReadAppSelection"},R:function(){return"ReadAppSelectionToProgressDone"},bp:function(n,t){var i=_a.d.b(_a.a.j,"ExecuteGetCallbackTokenRequest",!0);if(!this.a.d.RequestedCapabilities){_js.Trace.logInfo(_a.a.j,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.a.d.DisplayName);t(_exn.b.a);this.c(i,"InsufficientPermission",this.a.d.DisplayName);return}var f,u;if(!(u=this.u(f={val:t},_exn.b.g()),t=f.val,u)){this.c(i,"AsyncLimitExceeded",null);return}var r=new _exn.A(this.a.d.Id,String.format("ParentItemId:{0}",this.b.bl.ItemId.Id));var o=this;r.w(function(n){o.bU(t,n);_a.d.a(i)});var e=this;r.v(function(n){t({wasSuccessful:!1});e.m(i,n)});OwaApplication.a.a(r)},bq:function(n,t){var r=_a.d.b(_a.a.j,"ExecuteLoadCustomPropRequest",!0);var o=n;var i=new _exn.J(this.a.d.Id,this.b.bl.ItemId.Id);var f,u;if(!(u=this.u(f={val:t},_exn.b.g()),t=f.val,u)){this.c(r,"InsufficientPermission",null);return}var s=this;i.w(function(n){t({errorMessage:i.A.ErrorMessage,wasSuccessful:i.A.WasSuccessful,customProperties:i.A.CustomProperties});_a.d.a(r)});var e=this;i.v(function(n){t({errorMessage:i.t.message,wasSuccessful:!1,customProperties:null});e.m(r,n)});OwaApplication.a.a(i)},br:function(n,t){var r=_a.d.b(_a.a.j,"ExecuteSaveCustomPropRequest",!0);var s=n;var h=s.customProperties;var e=JsonParser.serialize(h);if(this.h(e.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_exn.b.a);this.c(r,"ApiLimitExceeded",null);return}var u,f;if(!(f=this.u(u={val:t},_exn.b.g()),t=u.val,f)){this.c(r,"AsyncLimitReached",null);return}var i=new _exn.T(this.a.d.Id,this.b.bl.ItemId.Id,e);var c=this;i.w(function(n){t({errorMessage:i.A.ErrorMessage,wasSuccessful:i.A.WasSuccessful});_a.d.a(r)});var o=this;i.v(function(n){t({errorMessage:i.t.message,wasSuccessful:!1});o.m(r,n)});OwaApplication.a.a(i)},bn:function(n,t){if(!this.bS()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.h(r.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}var f=null;if(i&&"attachments"in i){var u=i.attachments;if(u.length>100){t(null);return}f=this.bg(u)}this.bi(1,r,f);t(null)},bm:function(n,t){if(!this.bR()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.h(r.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}var f=null;if(i&&"attachments"in i){var u=i.attachments;if(u.length>100){t(null);return}f=this.bg(u)}this.bi(2,r,f);t(null)},bV:function(n){var t=n.entities;if(t.Addresses){for(var y=t.Addresses,w=new Array(0),s=0;s<y.length;s++)Array.indexOf(this.i,y[s])>=0&&w.push(y[s]);t.Addresses=w}if(t.MeetingSuggestions){for(var a=t.MeetingSuggestions,b=new Array(0),o=0;o<a.length;o++)Array.indexOf(this.i,a[o].MeetingString)>=0&&b.push(a[o]);t.MeetingSuggestions=b}if(t.TaskSuggestions){for(var v=t.TaskSuggestions,p=new Array(0),e=0;e<v.length;e++)Array.indexOf(this.i,v[e].TaskString)>=0&&p.push(v[e]);t.TaskSuggestions=p}if(t.PhoneNumbers){for(var l=t.PhoneNumbers,d=new Array(0),u=0;u<l.length;u++)Array.indexOf(this.i,l[u].OriginalPhoneString)>=0&&d.push(l[u]);t.PhoneNumbers=d}if(t.Urls){for(var c=t.Urls,k=new Array(0),h=0;h<c.length;h++)Array.indexOf(this.i,c[h].Url)>=0&&k.push(c[h]);t.Urls=k}var r=n.regExMatches;if(!$a(r))for(var f=Object.keys(r),i=0;i<f.length;i++)$a(r[f[i]])||(n.regExMatches[f[i]]=this.bs(r[f[i]]))},bo:function(n,t){var u=n.coercionType;if(this.b.bC())this.bh(u,this.b.bC().bl.Value,t);else{var f=_a.d.b(_a.a.j,"ExecuteGetBodyAsyncRequest",!0);var i=new _h.R(1300,[new _g.g(this.b.bl.ItemId.Id)],_h.b.a(),"ItemNormalizedBody",0,!1);var r=this;i.w(function(n){var i=_h.e.a().a(r.b.bl.ItemId.Id);r.bh(u,i.bC().bl.Value,t);_a.d.a(f)});var e=this;i.v(function(n){t({error:1,errorCode:9020});e.m(f,n)});OwaApplication.a.a(i)}},d:function(n,t){if(this.bu())this.bT(n,t);else{this.D(n);t()}},o:function(n){_exn.b.prototype.o.call(this,n);n.h([_exn.a.a("GetCallbackToken",this.bd),_exn.a.a("LoadCustomProperties",this.be),_exn.a.a("SaveCustomProperties",this.bf),_exn.a.a("DisplayReplyForm",this.bb),_exn.a.a("DisplayReplyAllForm",this.ba),_exn.a.a("GetBodyAsync",this.bc)])},D:function(n){n.id=this.b.bl.ItemId.Id;n.itemClass=this.b.bl.ItemClass;this.b.cy()&&(n.dateTimeCreated=this.b.cy().y().getTime());this.b.I()&&(n.dateTimeModified=this.b.I().y().getTime());this.b.cq()&&(n.dateTimeSent=this.b.cq().y().getTime());$a(this.b.bl.EntityExtractionResult)||(n.entities=this.bt(this.b.bl.EntityExtractionResult));var i=this.H.e.j();i&&(n.filteredEntities=i);if(!!this.a.d.RequestedCapabilities){n.subject=this.b.bl.Subject;n.normalizedSubject=this.b.cK();var t=this.H.c;$a(t)||(n.regExMatches=JsonParser.deserialize(JsonParser.serialize(t)));_exn.h.g(n,this.b.dO())}!$a(this.i)&&this.i.length>0&&this.bV(n)},bs:function(n){for(var r=new Array(0),u=this.i,f=u.length,t=0;t<f;++t){var i=u[t];Array.indexOf(n,i)>=0&&r.push(i)}return r},bu:function(){if(this.b.bl.EntityExtractionResult)return!1;var n=this.b.bl.PropertyExistence;return n?n.ExtractedAddresses||n.ExtractedContacts||n.ExtractedEmails||n.ExtractedMeetings||n.ExtractedPhones||n.ExtractedTasks||n.ExtractedUrls:!1},bT:function(n,t){var i=new _exn.I(this.b);var u=_a.c.a();var f=this;i.w(function(i){f.v=_a.c.a().g(u);f.D(n);t()});var r=this;i.v(function(f){_js.Trace.logWarning(_a.a.j,"GetItem to fetch entities failed "+i.t);r.x|=1;r.v=_a.c.a().g(u);r.D(n);t()});OwaApplication.a.a(i)},bt:function(n){var t={};t.Addresses=_exn.f.b(n.Addresses,3,this.k);t.Urls=_exn.f.b(n.Urls,4,this.k);t.PhoneNumbers=_exn.f.b(n.PhoneNumbers,5,this.k);if(!!this.a.d.RequestedCapabilities){t.Contacts=_exn.f.b(n.Contacts,7,this.k);t.EmailAddresses=_exn.f.b(n.EmailAddresses,6,this.k);t.MeetingSuggestions=_exn.f.b(n.MeetingSuggestions,1,this.k);t.TaskSuggestions=_exn.f.b(n.TaskSuggestions,2,this.k);t.FlightReservations=n.FlightResevations;t.ParcelDeliveries=n.ParcelDeliveries}return t},bi:function(n,t,i){var r=this;this.J.a(function(u){var f=u.a(!0,!1);f.e(n);f.N(r.b);var o=f.s(!0);var e;if(n===1)e=new _g.dJ;else if(n===2)e=new _g.dI;else return;e.g(o.bl);e.C(new _g.w(new _g.G("HTML",t)));e.r(r.b.bl.ItemId);f.cS(e);r.Y.a(function(n){var t=n.b(f,e,r.M);t.a=0;t.w(function(n){_js.Trace.logInfo(_a.a.j,"Create response action succeeded");var t=n;if(t.I===f.b()){f.cW();f.o(0);f.e(4);f.D(t.d);f.cX(i);var r=new _y.bf;r.a(f)}});OwaApplication.a.a(t)})})},bR:function(){return this.b?_g.i.isInstanceOfType(this.b)?this.b.cC():!0:!1},bS:function(){return this.b?_g.i.isInstanceOfType(this.b)?this.b.ct():!0:!1},bg:function(n){for(var r=new Array(n.length),t=0;t<n.length;t++){r[t]=new Array(3);for(var i=0;i<3;i++)r[t][i]=n[t][i]}return r},bU:function(n,t){var i="";t&&_exn.A.isInstanceOfType(t)&&t.c&&(i=t.c.TokenValue);n({wasSuccessful:!0,token:i})},bh:function(n,t,i){if(n)i({error:0,data:t});else{var r;var f,u;(u=_a.u.a(t,f={val:r}),r=f.val,u)?i({error:0,data:r}):i({error:1,errorCode:9020})}}};_exn.bo=function(n,t,i){_exn.bo.initializeBase(this,[t,i]);this.j=n};_exn.bo.prototype={j:null,b:function(){return"GetBody"},c:function(){return 1},f:function(){var i=this.a;var t=i.coercionType;var n=this.j.p(t===3?_exn.bK.a.toString(3):_exn.bK.a.toString(0));this.g(n,null)}};_exn.bp=function(n,t,i){_exn.bp.initializeBase(this,[t,i]);this.j=n};_exn.bp.prototype={j:null,b:function(){return"GetBodyType"},c:function(){return 1},f:function(){var t=this.j.a();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");this.g(n,null)}};_exn.bq=function(n,t,i){_exn.bq.initializeBase(this,[t,i]);this.j=n};_exn.bq.prototype={j:null,b:function(){return"GetLocation"},c:function(){return 1},f:function(){var n=this.j.g();this.g(n,null)}};_exn.N=function(n,t,i){_exn.N.initializeBase(this,[t,i]);this.j=n};_exn.N.a=function(n){var u=[];if(!n)return u;for(var f=n.x.length>500?500:n.x.length,t=0;t<f;t++){var r=n.x[t].a();var i={};i.recipientType=_exn.h.c(r.a().MailboxType);i.address=r.a().EmailAddress||null;i.name=r.c();u[t]=i}return u};_exn.N.prototype={j:null,b:function(){return"GetRecipients"},c:function(){return 1},f:function(){var i=this.a.recipientField;var t=this.j.q(i);var n=_exn.N.a(t);this.g(n,null)}};_exn.bs=function(n,t,i){_exn.bs.initializeBase(this,[t,i]);this.j=n};_exn.bs.prototype={j:null,b:function(){return"GetSubject"},c:function(){return 1},f:function(){var n=this.j.s();this.g(n||"",null)}};_exn.br=function(n,t,i){_exn.br.initializeBase(this,[t,i]);this.j=n};_exn.br.prototype={j:null,b:function(){return"GetSelectedData"},c:function(){return 1},f:function(){var e=this.a;var n=0;var t;var s=e.coercionType;var f,r,u;var o=(u=this.j.r(s===3?_exn.bK.a.toString(3):_exn.bK.a.toString(0),f={val:t},r={val:n}),t=f.val,n=r.val,u);if(n)this.h(n,null);else{var i={};i.data=o;i.sourceProperty=t;this.g(i,null)}}};_exn.bt=function(n,t,i){_exn.bt.initializeBase(this,[t,i]);this.j=n};_exn.bt.prototype={j:null,b:function(){return"GetTime"},c:function(){return 1},f:function(){var n=null;var t=this.a.TimeProperty;t===1?n=this.j.h():t===2&&(n=this.j.d());this.g(n.y().getTime(),null)}};_exn.bv=function(n,t,i,r,u){this.o=Function.createDelegate(this,this.q);this.p=Function.createDelegate(this,this.r);_exn.bv.initializeBase(this,[t,u]);this.k=i;this.j=n;this.l=r};_exn.bv.prototype={k:null,j:null,l:null,b:function(){return"ExecuteLoadCustomPropRequestForCompose"},c:function(){return 0},f:function(){var t=this.j.b();if(t)for(var n=t.b()-1;n>=0;n--)if(_h.K.e(t.c(n),this.k)){this.n({wasSuccessful:!0,customProperties:t.c(n).bl.Value},null);return}var r=this.j.c();if(!r){this.n({wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.a;var i=new _exn.J(this.k,this.j.c());i.w(this.p);i.v(this.o);this.l.a(i)},r:function(n){var t=n;var r={wasSuccessful:t.A.WasSuccessful,customProperties:t.A.CustomProperties};if(!_js.d.a(t.A.CustomPropertyNames)){var i=this.j.b();_h.K.d(i,t.A.CustomPropertyNames)}this.n(r,n.I)},q:function(n){_js.Trace.logError(_a.a.j,"custom properties load failed with "+n.t);var t={errorMessage:n.t.message,wasSuccessful:!1,customProperties:null};this.v(t,n.t.message,n.I)}};_exn.bx=function(n,t,i){_exn.bx.initializeBase(this,[n,t]);this.j=i};_exn.bx.prototype={j:null,b:function(){return"RegisterConsent"},c:function(){return 2},f:function(){var n=this.a;var r=n.marketplaceAssetId;var i=Number.parseInvariant(n.consentState);var t=new _exn.R(r,i);this.j.a(t)}};_exn.by=function(n,t,i){this.o=Function.createDelegate(this,this.p);_exn.by.initializeBase(this,[t,i]);this.l=n};_exn.by.prototype={l:null,j:null,k:null,b:function(){return"RemoveAttachment"},c:function(){return 3},f:function(){this.k=this.a.attachmentIndex;if(this.k.length>200){_js.Trace.logError(_a.a.j,"RemoveFileAttachment got too long attachmentId");this.i();return}if(!this.k){_js.Trace.logError(_a.a.j,"RemoveAttachment got null or empty attachmentIndex");this.i();return}this.j=this.l.f(this.k,!0);if(!this.j){this.h(9008,null);return}if(this.j.y()){this.g(null,null);return}this.j.F(this.o);this.j.j().a()},p:function(n){this.j.S(this.o);if(n.k()){this.l.e(this.k,this.j);this.h(9009,null);return}this.g(null,null)}};_exn.G=function(n,t,i,r){_exn.G.initializeBase(this,[t,r]);this.k=i;this.j=n};_exn.G.prototype={k:null,j:null,b:function(){return"ExecuteSaveCustomPropRequestCompose"},c:function(){return 0},f:function(){var f=this.a;var e=f.customProperties;var u=JsonParser.serialize(e);if(u.length>2500){this.i();return}for(var r=_h.K.h(this.k,u),n=this.j.b(),i=!1,t=0;t<n.b();t++)if(_h.K.e(n.c(t),this.k)){n.o(t,r);i=!0;break}i||this.l(n,r);this.j.t();this.n(_exn.G.a,null)},l:function(n,t){n.a(t);_h.K.d(n,t.a().bl.PropertyName)}};_exn.bA=function(n,t,i){_exn.bA.initializeBase(this,[t,i]);this.j=n};_exn.bA.prototype={j:null,b:function(){return"Save"},c:function(){return 3},f:function(){var n=this,t=this;this.j.v(function(){n.g(n.j.c(),null)},function(){t.h(9021,null)})}};_exn.bB=function(n,t,i,r){_exn.bB.initializeBase(this,[n,t,i,r]);this.o=n};_exn.bB.prototype={o:null,b:function(){return"SetBody"},c:function(){return 3},l:function(n){var t=0;var i;this.o.w(n,this.k===3,i={val:t}),t=i.val;t?this.h(t,null):this.g(null,null)}};_exn.bN=function(n,t,i,r){this.q=Function.createDelegate(this,this.t);this.r=Function.createDelegate(this,this.w);_exn.bN.initializeBase(this,[t,i]);this.j=n;this.p=r};_exn.bN.prototype={j:null,p:null,k:0,f:function(){var i=this.a;var n=i.data;if(n.length>1e6){this.i();return}var u,r;if(r=this.x(i.coercionType,u={val:this.k}),this.k=u.val,r)if(this.k===3)if(_js.d.a(n))this.l("");else{var t=new _exn.S(n);t.w(this.r);t.v(this.q);this.j.A();this.p.a(t)}else this.j.a()==="HTML"?this.l(_ff.i.a(n)):this.l(n)},t:function(n){_js.Trace.logError(_a.a.j,"Sanitize html failed with "+n.t);this.h(9011,null)},w:function(n){_js.Trace.logInfo(_a.a.j,"Sanitize html succeeded.");if(this.j.a()==="HTML"){var u=n;var t=u.A;var r;this.s(r={val:t}),t=r.val;var i=this;this.j.n(function(n){n?i.h(9014,null):i.l(t)})}else this.h(2006,null)},s:function(n){n.val=n.val.trim();n.val.substr(0,5).toLowerCase()==="<div>"&&n.val.substr(n.val.length-6,6).toLowerCase()==="</div>"&&(n.val=n.val.substring(5,n.val.length-6))},x:function(n,t){var i=this.j.a();t.val=n;if(!$a(n)){if(i==="Text"&&t.val===3){this.h(2006,null);return!1}return!0}this.i();return!1}};_exn.bC=function(n,t,i){_exn.bC.initializeBase(this,[t,i]);this.j=n};_exn.bC.prototype={j:null,b:function(){return"SetLocation"},c:function(){return 3},f:function(){var n=this.a.location;if(n.length>255)this.i();else{this.j.i(n);this.g(null,null)}}};_exn.bE=function(n,t,i){_exn.bE.initializeBase(this,[t,i]);this.j=n};_exn.bE.prototype={j:null,b:function(){return"SetSubject"},c:function(){return 3},f:function(){var n=this.a.subject;if(n.length>255){this.i();return}this.j.z(n);this.g(null,null)}};_exn.bD=function(n,t,i,r){_exn.bD.initializeBase(this,[n,t,i,r]);this.o=n};_exn.bD.prototype={o:null,b:function(){return"SetSelectedData"},c:function(){return 3},l:function(n){var t;var i;this.o.y(n,this.k===3,i={val:t}),t=i.val;t?this.h(t,null):this.g(null,null)}};_exn.bF=function(n,t,i){_exn.bF.initializeBase(this,[t,i]);this.j=n};_exn.bF.prototype={j:null,b:function(){return"SetTime"},c:function(){return 3},f:function(){var i=this.a.TimeProperty;var r=this.a.time;var n=_a.c.t(new Date(r));var t=!0;i===1?this.j.j(n):i===2&&(t=this.j.k(n));t?this.g(null,null):this.h(9010,null)}};_exn.a=function(n,t,i){this.a=n;this.c=t;this.b=i};_exn.a.a=function(n,t){return new _exn.a(n,t,!1)};_exn.a.b=function(n,t){return new _exn.a(n,t,!0)};_exn.a.prototype={a:null,b:!1,c:null};_exn.bG=function(n,t){this.f=n;this.e=t};_exn.bG.prototype={f:null,e:null,c:function(){return this.f},b:function(){return this.e},a:function(){return 0},d:function(){return""}};_exn.L=function(n,t,i,r){this.l=Function.createDelegate(this,this.o);this.m=Function.createDelegate(this,this.r);_exn.L.initializeBase(this);this.d=n;this.g=t;this.k=r;if(this.g==="TouchNarrow")if(i.a().b().Enabled)this.dy(this.p());else{this.ds(_y.i.a(this));var f=this;var u=new _C(function(){f.a()},_a.a.j);this.dp.b([_y.f.a(_u.S.W,u)])}};_exn.L.prototype={k:null,g:0,b:null,d:null,e:!1,c:null,h:null,bm:function(){return 2},q:function(){return this.m},n:function(){return this.b},f:function(n){this.b=n;return n},bn:function(){return!0},j:function(){return this.g==="TouchNarrow"?1:0},r:function(n,t){if(this.e)return!1;if(this.h){this.c=n;this.h(this.l);return!0}this.o();return!1},a:function(){if(!this.e&&this.b){this.b();this.d.t(!1)}},o:function(){this.e=!0;this.c&&this.c()},p:function(){var n=new _ms.b;n.h(_u.S.G);if(this.k.a()){var i=this;n.f(new _ms.a(_y.b.b(),_y.b.b(),new _C(function(){i.a()},_a.a.j),""));n.k(3)}else{var t=this;n.f(new _ms.a(_y.b.a(),_y.b.a(),new _C(function(){t.a()},_a.a.j),""))}return n}};_exn.n=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.Q=Function.createDelegate(this,this.cz);this.bU=Function.createDelegate(this,this.cC);this.bD=Function.createDelegate(this,this.bW);this.bE=Function.createDelegate(this,this.cB);this.bS=Function.createDelegate(this,this.cy);this.bT=Function.createDelegate(this,this.cA);this.bV=Function.createDelegate(this,this.z);this.f=this.U;this.k=this.bs;_exn.n.resolveInheritance();this.w=this.cX;_exn.n.initializeBase(this,[r,t,u,f,e,o,s,h,c,l,a,y,p,w]);this.bf=_a.d.b(_a.a.j,"EnableAppsButton",!0);this.bX=v;this.bI(_u.S.G);this.bJ(!1);this.bd(!0);this.bk=i;this.be=new _C(this.bV,n);this.be.c(!1);this.bG=new _C(this.bT,n);this.bF=new _C(this.bS,n)};_exn.n.prototype={bq:null,bl:null,bp:null,bk:null,bo:!1,T:!1,bn:!1,S:!1,bb:!1,bc:!1,bj:0,be:null,bG:null,bF:null,bm:!1,bX:null,K:null,bf:null,h:function(n){this.dV("OnAppsPaneOpened",n)},o:function(n){this.dW("OnAppsPaneOpened",n)},g:function(n){this.dV("OnAppsPaneClosed",n)},n:function(n){this.dW("OnAppsPaneClosed",n)},i:function(n){this.dV("OnExtensionOpened",n)},p:function(n){this.dW("OnExtensionOpened",n)},r:function(n){this.dV("BackToList",n)},y:function(n){this.dW("BackToList",n)},x:function(){return"ShowAppsButton"},a:function(){return this.be},q:function(n){if(this.bn!==n){this.bn=n;this.dQ("ForceHideAppsButton")}return n},b:function(){return this.T},cF:function(n){if(this.T!==n){this.T=n;this.dQ("ShowAppsButton")}return n},v:function(){return this.bj},ca:function(n){if(this.bj!==n){this.bj=n;this.dQ("AppPaneSize")}return n},l:function(){return this.S},bd:function(n){if(this.S!==n){this.S=n;this.dQ("AppPaneIsHidden")}return n},m:function(){return this.H.a===1},cw:function(){return this.B.a()==="TouchNarrow"},cE:function(n){this.bq=n;if(n.a===3){var t=this.bq.c.r().extensionViewModel;this.M(t)}return n},bI:function(n){if(this.bl!==n){this.bl=n;this.dQ("AppPaneTitle")}return n},cD:function(n){if(this.bp!==n){this.bp=n;this.dQ("IconUrl")}return n},bJ:function(n){if(this.bo!==n){this.bo=n;this.dQ("HideExtensionsList")}return n},d:function(){return this.bc},cc:function(n){if(n!==this.bc){this.bc=n;this.dQ("IsXOwaExtensibilityActive")}return n},c:function(){return this.bb},cb:function(n){if(n!==this.bb){this.bb=n;this.dQ("IsOwaExtensibilityActive")}return n},U:function(){this.bZ();this.bd(!0);this.cx();this.H&&this.H.apcl("Orientation",this.bE);this.F.f();_exn.c.prototype.U.call(this)},bs:function(){this.cG();this.H&&this.H.rpcl("Orientation",this.bE);this.bR(null);this.ba(!0);this.F.f();_exn.c.prototype.bs.call(this)},M:function(n){if(n){this.bJ(!0);this.ba(!1);this.bI(n.a().DisplayName);this.cD(n.a().IconUrl);if(this.C.b(this.C.f()))if(n.a().Type!=="Preinstalled"||n.a().ConsentState){var t=this;this.C.f().c(n.b(),n.a().DisplayName,function(){t.bH(n)},this.bD)}else{var i=this;this.C.f().c(this.A.ConsentUrl,n.a().DisplayName,function(){i.bH(n)},this.bD)}else this.bH(n)}else this.C.b(this.C.f())?this.C.f().d():this.bW()},z:function(){var n=_a.d.b(_a.a.j,"ShowAppPane",!0);if(this.B.a()==="Mouse"){if(this.S){this.ca(342);this.bd(!1);this.bY(1)}}else if(this.B.a()!=="TouchNarrow"&&this.H.a)this.bd(!1);else{this.K=this.bu.c(this,this.B.a());this.K.h=this.bU;this.B.d(this.K)}this.cb(!this.cn());this.cc(this.cn());this.dX("OnAppsPaneOpened");_a.d.a(n)},e:function(n){if(!this.S){var t=null;n&&(t=_a.d.b(_a.a.j,"HideAppPane",!0));this.t(!1);this.ca(0);this.bd(!0);this.dX("OnAppsPaneClosed");this.bY(2);this.cb(!1);this.cc(!1);n&&_a.d.a(t)}},t:function(n){var t=null;n&&(t=_a.d.b(_a.a.j,"CloseComposeApp",!0));this.M(null);n&&_a.d.a(t)},j:function(){this.K&&this.K.a()},br:function(){if(this.L){this.B.a()==="Mouse"&&this.A.MarketplaceUrl&&this.ct(this.A.MarketplaceUrl);if(!$a(this.A.Extensions)&&this.A.Extensions.length){var n=this;this.L.a(null,this.A.Extensions,function(t){if(n.L&&t.d.length>0){n.F.p(t.i());n.cv(new _exn.p(n.F,n.bB));n.G.c();n.dQ("NoActiveExtensions");n.dQ("ActiveExtensionsCount");n.dQ("ExtensionBecomeActiveTestOnly")}})}}},bh:function(n){return!n},cy:function(){this.t(!0)},cB:function(n,t){if(this.B.a()==="TouchWide"){this.H.a===1?this.K&&this.K.a():this.e(!1);this.dX("OnAppsPaneClosed")}},cA:function(){this.B.a()!=="TouchWide"||this.H.a===1?this.e(!0):this.K&&this.K.a()},bH:function(n){this.dX("OnExtensionOpened");_exn.c.prototype.M.call(this,n);this.by(this.J,!0)},bW:function(){this.bz(this.J,!0);this.bI(_u.S.G);this.bJ(!1);this.dX("BackToList");_exn.c.prototype.M.call(this,null)},cx:function(){this.apcl("NoActiveExtensions",this.Q);this.apcl("MarketplaceUrl",this.Q);this.apcl("ForceHideAppsButton",this.Q);this.bm=!0},cG:function(){if(this.bm){this.rpcl("NoActiveExtensions",this.Q);this.rpcl("MarketplaceUrl",this.Q);this.rpcl("ForceHideAppsButton",this.Q);this.bm=!1}},cz:function(n,t){(t==="NoActiveExtensions"||t==="MarketplaceUrl"||t==="ForceHideAppsButton")&&this.bZ()},bY:function(n){this.bk&&this.bk(n)},cC:function(n){this.M(null);n()},bZ:function(){this.cF(!this.bn&&(!this.Z||!!this.Y));this.be.c(this.T);if(this.bf&&this.T){_a.d.a(this.bf);this.bf=null}}};_exn.O=function(n,t,i,r){this.b=n;this.a=t;this.c=i;this.d=r;_js.d.a(r)&&this.e()};_exn.O.prototype={b:0,a:0,c:null,d:null,f:function(n){Array.contains(this.c,n)||Array.add(this.c,n)},e:function(){this.d=String.format("ident_{0}_{1}",this.b,this.a)}};_exn.z=function(){};_exn.z.b=function(n){var i=n.toString();var t=_exn.z.a[i];if(!t){t=_js.l.b(_y.fB,n);_exn.z.a[i]=t}return t};_exn.p=function(n,t){this.o=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.t);_exn.p.initializeBase(this);this.y(n);this.d=t;this.C(new _C(this.n,_a.a.j));this.z(new _fm.f(new Array(0)));this.A(new _js.f)};_exn.p.prototype={g:0,a:null,b:null,e:null,d:null,h:!0,f:null,i:null,j:null,l:!1,r:function(n){this.dV("OnFocusRequested",n)},v:function(n){this.dW("OnFocusRequested",n)},A:function(n){if(this.b!==n){this.b=n;this.dQ("ExtensionsTabList")}return n},q:function(n){if(this.h!==n){this.h=n;this.dQ(_exn.p.b)}return n},k:function(n){if(this.f!==n){this.f=n;$a(n)||this.dQ(_exn.p.a)}return n},z:function(n){if(this.e!==n){this.e=n;this.dQ("ExtensionsContextMenuViewModel")}return n},y:function(n){if(this.a!==n){this.a=n;this.dQ("ActiveExtensions")}return n},B:function(n){this.i=n;if(n.a===3){var t=this.i.c.r().extensionViewModel;this.m(t)}return n},C:function(n){if(this.j!==n){this.j=n;this.dQ("PopulateMenuItemsCommand")}return n},w:function(){this.ea("OnFocusRequested",this,null)},m:function(n){if($a(n)||this.f===n){if(this.l)return;this.d.g=null;this.d.a();this.c()}else{this.d.g=n;this.d.a();this.k(n)}},c:function(){this.f=null;this.dQ(_exn.p.a)},t:function(){if(!(this.g<1)){var n=0;var i=this.a.x.length;var e=!1;var t=this.f;var r=this.g;this.b.f();while(n<r&&n<i){var o=this.a.x[n];var u=n+1===r||n+1===i;($a(t)||o.d.Id===t.d.Id)&&(e=!0);var f=u&&!e?t:this.a.x[n];this.b.a(f);f.o(u&&i<=r);n++}this.k(t);this.p();this.dQ("ExtensionsTabList")}},x:function(n){n.o(!1);this.b.n(this.b.x.length-1);this.b.a(n);this.d.g=n;this.d.a();this.k(n);this.p()},p:function(){var i=this.a.x.length;if(i>this.g){var t=0;this.e.h.f();while(t<i){var n=this.a.x[t];if(this.b.k(n)<0){var r=new _fm.d(n.d.DisplayName,null,new _exn.F(this.o,n),!0);this.e.h.a(r)}t++}this.q(!1)}else{this.e.h.f();this.q(!0)}}};_exn.u=function(n,t,i,r,u){this.t=Function.createDelegate(this,this.y);this.w=Function.createDelegate(this,this.z);this.x=Function.createDelegate(this,this.D);_exn.u.initializeBase(this);this.a=n;this.h=r;this.A(u);this.r=i;if(r!=="Mouse")if(this.h==="TouchNarrow"&&t.a().b().Enabled)this.dy(this.C());else{this.ds(_y.i.a(this));var l=this;var c=new _C(function(){l.k()},_a.a.j);this.dp.b([_y.f.a(_u.S.W,c)]);if(this.g&&n.a()&&n.a().x.length>0){var a=0;var s=new Array(n.a().x.length-1);this.c=new Array(n.a().x.length);for(var f=0;f<n.a().x.length;f++){this.c[f]=this.B(f);n.f()!==n.a().x[f]?s[a++]=this.c[f]:this.m=f}this.dp.f(s)}}if(r==="TouchWide"&&i.n())if(_g.i.isInstanceOfType(this.a.b()))this.p(this.a.b().z().bl.Value);else if(this.a.b().bC()&&this.a.b().bC().bl.Value)this.p(this.a.b().bC().bl.Value);else{var e=_ff.g.a(_h.b.J());e.MaximumBodySize=0;e.MaximumRecipientsToReturn=0;var o=new _h.R(100,[this.a.b().bl.ItemId],e,"ItemNormalizedBody",0,!1);var h=this;o.w(function(n){h.p(h.a.b().bC().bl.Value)});OwaApplication.a.a(o)}};_exn.u.prototype={h:0,r:null,b:null,a:null,d:null,o:null,g:!1,e:!1,l:null,m:0,c:null,p:function(n){this.o=n;this.dQ("ItemBodyValue");return n},A:function(n){if(this.g!==n){this.g=n;this.dQ("IsContextual")}return n},bm:function(){return 4},q:function(){return this.x},n:function(){return this.b},f:function(n){this.b=n;return n},bn:function(){return!0},j:function(){return this.h!=="Mouse"?1:0},D:function(n,t){if(this.e)return!1;if(this.d){this.l=n;this.d(this.w);return!0}this.z();return!1},k:function(){this.e||(this.h==="TouchNarrow"?this.d?this.d(this.t):this.y():this.b&&this.b())},E:function(n){this.dp.x(this.c[this.m]);this.dp.A(this.c[n]);this.m=n;this.a.m(this.a.a().x[n])},B:function(n){var r=this.a.a().x[n];var i=this;var t=new _C(function(){i.E(n)},_a.a.j);return new _y.g(r.a().DisplayName,t)},y:function(){this.e=!0;this.b&&this.b()},z:function(){this.e=!0;this.l&&this.l()},C:function(){var n=new _ms.b;n.h(_u.S.G);if(this.r.a()){var i=this;n.f(new _ms.a(_y.b.b(),_y.b.b(),new _C(function(){i.k()},_a.a.j),""));n.k(3)}else{var t=this;n.f(new _ms.a(_y.b.a(),_y.b.a(),new _C(function(){t.k()},_a.a.j),""))}return n}};_exn.E=function(n,t){this.b=n;this.a=t};_exn.E.prototype={b:null,a:null,d:function(n,t,i){return new _exn.u(n,this.a,this.b,t,i)},c:function(n,t){return new _exn.L(n,t,this.a,this.b)}};_exn.bk=function(){this.t=Function.createDelegate(this,this.u);this.s=_a.c.m;this.m=[];this.o={};this.p={}};_exn.bk.prototype={v:100,r:6e5,l:null,k:null,j:null,n:null,e:function(n,t){if(!this.q()){this.j||(this.j=new _exn.bk.b);if(!this.j.b){this.j.b=[];this.j.a=[]}Array.add(this.j.b,n);Array.add(this.j.a,t)}},h:function(n){this.p[n]=$a(this.p[n])?1:this.p[n]+1},d:function(n,t,i){i&&(this.o[n]=$a(this.o[n])?1:this.o[n]+1);if(!this.q()){this.j||(this.j=new _exn.bk.b);this.j.e=t;this.j.c=i;this.j.d=n;this.l||(this.l=new _exn.bk.a);Array.add(this.l.a,this.j);this.j=null}},i:function(n,t){if(!this.q()){this.n||(this.n=new _exn.bk.d);this.n.k(n,t)}},f:function(n){if(!this.q()){this.l||(this.l=new _exn.bk.a);this.l.b=n;Array.add(this.m,this.l);this.l=null}},g:function(n,t,i,r){if(!this.q()){this.k||(this.k=new _exn.bk.c);this.k.c.b(n,null);this.k.d.b(r,null);this.k.b.b(i,null);this.k.a.b(t,null)}},b:function(){var n=_a.c.a();if(n.g(this.s)>=this.r){_a.l.a.d(this.t);this.w();this.s=n}},w:function(){this.m=[];this.o={};this.p={};this.l=null;this.j=null;this.k=null;this.n=null},c:function(n){var t=new Sys.StringBuilder;if($a(_exn.g.a))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.u().k(n));n&&t.append("</TABLE>")}return new _a.bT("Pending Extensibility Statistics",t.toString())},u:function(){var l=_exn.g.a.Extensions.length;var n=new _exn.bf;n.d(_exn.g.b);n.c(l);if(this.m.length>0){for(var e=0,h=new _exn.r,i={},c=new _exn.r,r=0;r<this.m.length;r++){var u=this.m[r];h.b(u.b,null);for(var f=0,s=0;s<u.a.length;s++){var t=u.a[s];var o=t.d;t.c&&f++;$a(i[o])&&(i[o]=new _exn.r);i[o].b(t.e,null);t.f(c)}f>e&&(e=f)}n.p(e);n.b(this.m.length);n.s(h.a());n.q(this.x(i));n.r(c.a());n.o(this.r/1e3);if(this.k){n.l(this.k.b.a());n.n(this.k.d.a());n.m(this.k.c.a());n.e(this.k.a.a())}this.n&&n.i(this.n.j())}return n},x:function(n){for(var t=new Sys.StringBuilder,r=0;r<_exn.g.a.Extensions.length;r++){var i=_exn.g.a.Extensions[r];var f=$a(this.o[i.Id])?0:this.o[i.Id];var u=$a(this.p[i.Id])?0:this.p[i.Id];t.append("[");t.append(i.Id);t.append(",");t.append(i.DisplayName);t.append(";");t.append(n[i.Id]?n[i.Id].a():"");t.append(";");t.append(f.toString());t.append(",");t.append(u.toString());t.append("]")}return t.toString()},q:function(){return this.m.length>=this.v||!_js.Trace.c}};_exn.bk.a=function(){this.a=[]};_exn.bk.a.prototype={b:0};_exn.bk.c=function(){this.b=new _exn.r;this.d=new _exn.r;this.c=new _exn.r;this.a=new _exn.r};_exn.bk.b=function(){};_exn.bk.b.prototype={d:null,b:null,a:null,e:0,c:!1,f:function(n){if(this.a)for(var t=0;t<this.a.length;t++)n.b(this.a[t],this.b[t])}};_exn.bk.d=function(){};_exn.bk.d.prototype={c:0,d:0,e:0,f:0,g:0,h:0,i:0,a:null,k:function(n,t){this.a=null;var i=!t;if(n){var r=new _ff.e;if(n.ExtractedAddresses&&(i||!t.Addresses)){this.b(3);this.c++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.b(7);this.d++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.b(6);this.e++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.b(1);this.f++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.b(5);this.g++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.b(2);this.h++}if(n.ExtractedUrls&&(i||!t.Urls)){this.b(4);this.i++}}},j:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.c,this.d,this.e,this.f,this.g,this.h,this.i));if(this.a){n.append("MissingOnLastMessage:");for(var t=0;t<this.a.d.length;t++){n.append(_g.wt.toString(this.a.d[t]));n.append(",")}}return n.toString()},b:function(n){this.a||(this.a=new _ff.e);this.a.c(n)}};_exn.bl=function(n){this.i=n};_exn.bl.prototype={i:null,d:null,b:function(n,t,i){this.d=_js.g.a().a(i,this.i,n,t)},a:function(){this.d&&(this.d=_js.g.a().b(this.d))}};_exn.j=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.bF=Function.createDelegate(this,this.bY);this.bm=Function.createDelegate(this,this.bI);this.bn=Function.createDelegate(this,this.bJ);this.bG=Function.createDelegate(this,this.bZ);this.bE=Function.createDelegate(this,this.bX);this.m=this.cp;this.h=this.U;this.c=this.bs;_exn.j.resolveInheritance();this.d=this.cY;this.e=this.cn;_exn.j.initializeBase(this,[n,t,i,r,u,f,o,s,h,c,l,a,v,y]);this.bf=e;this.w={};this.y={};this.Q={};this.T=!1;this.t=new _js.f;this.t.d(this.bE);this.bq=new _exn.F(this.ci,null);this.cc(new _exn.bw);this.bD=["img","a","style"];this.v=new _exn.bg(this.bD,this.cK(),this.bG)};_exn.j.prototype={bd:null,v:null,bD:null,p:null,t:null,S:null,bf:!1,q:null,x:null,y:null,w:null,Q:null,T:!1,r:!1,z:null,bc:null,bb:null,K:null,bq:null,bj:null,be:null,b:function(){return this.q},bk:function(n){if(this.q!==n){this.q=n;this.bT()}return n},k:function(){return this.Q},f:function(){return this.K},cw:function(n){if(this.K!==n){this.K=n;this.dQ("SelectedContextualExtension")}return n},a:function(){return this.t},bS:function(n){if(this.z!==n){this.z=n;n&&this.cb($(this.z.target));this.dQ("LastContextualTermClickedEvent")}return n},bl:function(n){if(this.T!==n){this.T=n;this.dQ("ShowContextualCard")}return n},cc:function(n){if(this.bj!==n){this.bj=n;this.dQ("ReadExtensibilityPeekViewModel")}return n},cb:function(n){if(this.bc!==n){this.bc=n;this.dQ("AnchorElement")}return n},bp:function(){return this.r?this.K:this.J},cy:function(n){this.S=n.g();this.bk(this.S)},n:function(n){this.S=n;this.bk(n)},M:function(n){this.bU(!1,n)},cp:function(n){this.bU(!0,n)},g:function(n){this.bk(n?n.g():null)},o:function(n){this.bo(n.g())},i:function(n){this.p=n;this.U()},j:function(n){this.cy(n);this.U()},U:function(){if(this.R.B()){if(this.bf)for(var n=0;this.p&&n<this.p.x.length;n++)this.p.x[n].v()||this.p.x[n].bH(this);_exn.c.prototype.U.call(this)}},bs:function(){_exn.c.prototype.bs.call(this);this.bl(!1);this.bS(null);this.x&&this.x.k()},bZ:function(n){if(n.type!=="keydown"||n.which===13){this.bl(!1);var i=n.data.Item;this.bb=n.data.Terms;this.cx(i);this.bk(i);var t=this.D.a.x[0];this.cU(t.k);this.bS(n);this.D.m(t);this.bl(!0);this.D.w()}},l:function(n,t){this.be=_a.d.b(_a.a.j,"ExtensibilityHighlighting",!0);this.v.m(n.B.get(0),this.Q[t.bl.ItemId.Id],t);this.be.j=this.bW();_a.d.a(this.be)},br:function(){this.bf?this.bH(0):this.bo(this.S)},bh:function(n){return"Mouse"!==this.B.a()||!n},bU:function(n,t){var r=n?this.K:this.J;t&&r===t||this.E.G();if(t){this.E.bP();if(!this.W){var i=_js.e.s(_a.a.j,2,"ContextActivationManager");this.by(this.J,!1);this.cu(this.cl("15.01"));this.bz(this.J,!1);_js.e.e(i)}this.cm(t);this.E.i=this.bb}else this.bK();this.E.b=this.q;if(n){this.cs(this.bh(t));this.cw(t)}else{this.ba(this.bh(t));this.bR(t)}this.r||this.cz(n)},bW:function(){var n=new _a.r;n.a("M",this.v.c);n.a("P",this.v.d);n.c("O",this.v.b);n.a("C",this.v.e);return n.toString()},ca:function(n){return this.B.a()==="Mouse"?Object.getType(n)===_g.r||Object.getType(n)===_g.i:(this.B.a()==="TouchNarrow"||this.B.a()==="TouchWide")&&(Object.getType(n)===_g.r||Object.getType(n)===_g.i)?!0:!1},bo:function(n){if(this.L&&this.A&&this.L.c(n)&&!$a(this.A.Extensions)&&this.A.Extensions.length){this.ct(this.B.a()==="Mouse"?this.A.MarketplaceUrl:null);var t=this;this.L.a(n,this.A.Extensions,function(i){if(t.L){t.w[n.bl.ItemId.Id]=new Array(0);t.y[n.bl.ItemId.Id]=new Array(0);var u=[];if(i.d.length>0){for(var e=0;e<i.d.length;e++){var r=i.d[e];if(r.g.l()&&t.ca(n)){t.y[n.bl.ItemId.Id]=t.y[n.bl.ItemId.Id].concat(r);for(var f=0;f<r.h.length;f++)Array.indexOf(u,r.h[f])<0&&(u=u.concat(r.h))}else t.w[n.bl.ItemId.Id]=t.w[n.bl.ItemId.Id].concat(r)}t.Q[n.bl.ItemId.Id]=u;n===t.q&&t.bT();t.dQ("HighlightedTerms")}}})}},bT:function(){this.F.f();this.ba(!0);if(this.q&&this.w[this.q.bl.ItemId.Id]){var r=this.w[this.q.bl.ItemId.Id];var f=2147483647;var n=null;this.F.p(r);this.cv(new _exn.p(this.F,this.bB));this.G.c();this.dQ("ActiveExtensions");for(var e=r,o=e.length,t=0;t<o;++t){var u=e[t];var i=u.d.AutoLaunchPriority;if(i>=0&&i<f){n=u;f=i}}n&&this.G.m(n)}this.dQ("ExtensionBecomeActiveTestOnly");this.dQ("ActiveExtensionsCount")},cx:function(n){this.t.f();for(var i=this.y[n.bl.ItemId.Id],t=0;t<i.length;t++)for(var r=0;r<i[t].h.length;r++)if(Array.indexOf(this.bb,i[t].h[r])>=0){this.t.a(i[t]);break}this.cT(new _exn.p(this.t,this.bq));this.D.l=!0;this.D.c();this.dQ("ActiveContextualExtensions");this.dQ("ExtensionBecomeActiveTestOnly");this.dQ("ActiveExtensionsCount")},bH:function(n){if(this.p&&!(n>=this.p.x.length)){this.p.x[n].bQ()&&this.bo(this.p.x[n].g());var t=this;_js.g.a().c(_a.a.X,"ConversationReadingPane:ActivateExtensibilityForNextItemPart",function(){t.bH(++n)})}},bJ:function(){this.by(this.bp(),!0);this.bV()},cz:function(n){if("Mouse"!==this.B.a()){this.r=n;var t=this.bp();t&&(this.C.b(this.C.f())?t.a().Type!=="Preinstalled"||t.a().ConsentState?this.C.f().c(t.b(),t.a().DisplayName,this.bn,this.bm):this.C.f().c(this.A.ConsentUrl,t.a().DisplayName,this.bn,this.bm):this.bJ())}},bV:function(){this.x=this.bu.d(this,this.B.a(),this.r);this.x.A(this.r);this.x.d=this.bF;this.B.d(this.x)},bY:function(n){this.r=!1;this.G&&this.G.c();this.D&&this.D.c();this.bd=n;this.bz(this.bp(),!0);this.r=!1;this.C.b(this.C.f())?this.C.f().d():this.bI()},bI:function(){this.bd&&this.bd()},bX:function(n,t){t.c&&t.c!==2||this.dQ("ActiveContextualExtensionsCount")}};_exn.bw=function(){_exn.bw.initializeBase(this);this.d=new _y.D};_exn.bw.prototype={d:null,c:!1,b:function(){return this.c},a:function(n){if(this.c===n)return n;this.c=n;this.dQ("IsShown");return n},h:function(){return 486},i:function(){return 570},r:function(){return!0}};_exn.c=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.cd=Function.createDelegate(this,this.cI);this.ch=Function.createDelegate(this,this.cP);this.cg=Function.createDelegate(this,this.cO);this.ce=Function.createDelegate(this,this.co);this.bg=Function.createDelegate(this,this.cM);this.ck=Function.createDelegate(this,this.cQ);this.cj=Function.createDelegate(this,this.M);this.cf=Function.createDelegate(this,this.cN);this.ci=Function.createDelegate(this,this.cp);_exn.c.initializeBase(this);this.Z=!0;this.P=n;this.H=t;this.C=i;this.R=r;this.B=u;this.bC=new _y.bS;this.F=new _js.f;this.F.d(this.cf);this.bQ=_exn.c.f(s);this.bB=new _exn.F(this.cj,null);this.bP=new _C(this.ck,_a.a.j);this.bA=e;this.bO=o;this.bt=h;this.bL=c;this.L=l;this.E=a;this.bu=f;this.X=v};_exn.c.d=function(n){_exn.c.a||(_exn.c.a=new Sys.EventHandlerList);_exn.c.a.addHandler("OnGetExtensibilityContextCompleted",n)};_exn.c.e=function(n){_exn.c.a&&_exn.c.a.removeHandler("OnGetExtensibilityContextCompleted",n)};_exn.c.b=function(n,t){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",t);n.appendChild(i)};_exn.c.f=function(n){return n?n.replace("osfruntime_strings.js",""):""};_exn.c.prototype={B:null,R:null,bL:null,L:null,bu:null,P:null,bP:null,bC:null,C:null,bQ:null,E:null,A:null,V:null,N:null,G:null,W:null,bi:!1,bx:!0,bw:!0,bA:!1,bO:!1,Z:!1,Y:null,bB:null,bt:null,I:null,X:null,bN:!1,J:null,F:null,D:null,bv:0,H:null,cJ:function(){switch(this.B.a()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},bR:function(n){if(this.J!==n){$a(n)||this.bL.h(n.a().Id);this.J=n;this.dQ("SelectedExtension")}return n},cY:function(){return this.Z},cV:function(n){if(n!==this.Z){this.Z=n;this.dQ("NoActiveExtensions")}return n},cn:function(){return!!this.X&&this.X.a().e().Enabled},cK:function(){return"contextualExtensionHighlight ms-font-color-themePrimary ms-border-color-themePrimary"},cX:function(){return this.A},cL:function(){return this.A?this.A.IsInOrgMarketplaceRole:!1},cv:function(n){this.G!==n&&(this.G=n);this.dQ("OverflowMenuViewModel");return n},cT:function(n){this.D!==n&&(this.D=n);this.dQ("ContextualOverflowMenuViewModel");return n},cU:function(n){if(this.bv!==n){this.bv=n;this.dQ("ExtensionHeight")}return n},cu:function(n){if(this.W!==n){this.W=n;this.dQ("OsfContextActivationManager")}return n},ba:function(n){if(this.bx!==n){this.bx=n;this.dQ("HideExtensionContainer")}return n},cs:function(n){if(this.bw!==n){this.bw=n;this.dQ("HideContextualExtensionContainer")}return n},ct:function(n){this.Y=n;this.dQ("MarketplaceUrl");return n},M:function(n){n&&this.J===n||this.E.G();if(n){this.E.bP();if(!this.W){var t=_js.e.s(_a.a.j,2,"ContextActivationManager");this.by(n,!1);this.cu(this.cl("15.01"));this.bz(n,!1);_js.e.e(t)}this.cm(n);n.c(this.A.ConsentUrl)}else this.bK();this.ba(this.bh(n));this.bR(n)},cp:function(n){},bs:function(){_exn.c.e(this.bg);this.bN=!1;this.E.G();this.bK();this.G&&this.G.c();if(this.D){this.D.c();this.D=null}this.G=null;this.cs(!0);this.ba(!0);this.L.b();this.cH()},U:function(){this.bN=!0;if(_a.cd.c()){_a.cd.d();_exn.c.c=!1;_exn.c.d(this.bg);this.bM()}else if($a(this.A)&&$a(_exn.g.a)){_exn.c.d(this.bg);this.bM()}else{$a(this.A)&&!$a(_exn.g.a)&&(this.A=_exn.g.a);this.br()}},cO:function(n){if(this.bA&&this.N){this.N.l();this.N=null}this.cS(n);if(this.I){var t=null;_exn.g.isInstanceOfType(n)&&n.C&&(t=n.C.correlationId);this.I.l=t;_a.d.a(this.I);this.I=null}},cm:function(n){this.E.cz(n,this.A,n.e);this.E.cE()},by:function(n,t){this.cq(n,t)&&this.bt.a(_a.cj,new _a.cj(!0,"Extensibility"))},bz:function(n,t){this.cq(n,t)&&this.bt.a(_a.cj,new _a.cj(!1,"Extensibility"))},cl:function(n){var i=new OSF.ContextActivationManager({appName:64,appVersion:n,clientMode:1,appUILocale:this.P,dataLocale:"",hostControl:this.E,localizedScriptsUrl:this.bQ,lcid:this.P,docUrl:""});var t={frameBorder:"0"};this.R.a()&&this.R.c()&&(t.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(t);return i},cN:function(n,t){if(!t.c||t.c===2){this.cV(!this.F.x.length);this.dQ("ActiveExtensionsCount")}},bK:function(){this.E.cH();this.E.cI()},cq:function(n,t){return!this.R.p()&&!this.R.s()?!1:!t||n&&n.a().Type==="Default"?!0:!1},cQ:function(){if(this.Y){var n=_a.d.b(_a.a.j,"GetMoreApps",!0);this.bC.e(this.Y);this.cW();_a.d.a(n)}},cR:function(){var n=document.getElementsByTagName("head")[0];_exn.c.b(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js");_exn.c.b(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.P.toLowerCase()+"/office_strings.js");_exn.c.b(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.P.toLowerCase()+"/outlook_strings.js");_exn.c.b(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/office_strings.js");_exn.c.b(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/outlook_strings.js");_exn.c.b(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/outlook-web-16.00.js")},bM:function(){if((!_exn.c.c||this.bi)&&!this.bO){this.I=_a.d.b(_a.a.j,"GetListOfApps",!0);_exn.c.c=!0;this.co();if(this.bA){this.N=new _exn.bz(3,3e4,this.ce,_a.a.j,"GetExtensibilityContext");this.N.n()}}},co:function(){var n=new _exn.g;n.w(this.cg);n.v(this.ch);n.f(this.cJ(),this.P)},cP:function(n){if(this.N&&this.N.f&&this.I){var t=null;_exn.g.isInstanceOfType(n)&&n.C&&(t=n.C.correlationId);this.I.l=t;this.I.k=n.D();_a.d.a(this.I);this.I=null}},cH:function(){this.V&&this.V.a()},cW:function(){if(!this.V){this.V=new _exn.bl("CheckNewApp");this.cr()}},cr:function(){this.V.b(this.cd,5e3,_a.a.j)},cI:function(){if(_a.cd.c()){_a.cd.d();this.bi=!0;this.bM()}this.cr()},cS:function(n){if(_exn.c.a){var t=_exn.c.a.getHandler("OnGetExtensibilityContextCompleted");$a(t)||t(n)}},cM:function(n){_exn.c.e(this.bg);if(this.A){if(this.bi){this.bi=!1;_exn.g.b=n.a}}else{_exn.g.b=n.a;this.A=_exn.g.a;(this.B.a()==="Mouse"||this.X&&this.X.a().bO().Enabled)&&this.cR();this.br()}}};_exn.bm=function(n,t,i,r,u,f,e,o,s,h,c,l){this.h=n;this.j=t;this.q=i;this.n=r;this.m=u;this.p=f;this.o=e;this.i=o;this.f=s;this.g=h;this.k=c;this.l=l};_exn.bm.prototype={q:null,n:null,m:null,p:null,o:null,j:null,i:null,f:null,g:null,k:null,h:null,l:null,a:function(n){return this.r(n,this.f.e(n),this.g.t(n))},e:function(){return this.r(!1,this.f.e(!1),this.g.r())},d:function(n,t){return new _exn.n(_a.a.a,this.h,t,this.q,this.m,this.p,this.o,this.j,!0,_a.cm.a(),this.n,this.i,this.k,null,this.f.d(2),this.g.s(n),this.l)},c:function(n,t){return new _exn.n(_a.a.b,this.h,t,this.q,this.m,this.p,this.o,this.j,!0,_a.cm.a(),this.n,this.i,this.k,null,this.f.d(3),this.g.q(n),this.l)},b:function(n,t){return new _exn.bG(n,t)},r:function(n,t,i){return new _exn.j(this.q,this.h,this.m,this.p,this.o,this.j,n,!0,_a.cm.a(),this.n,this.i,this.k,t,i,this.l)}};_exn.bn=function(n){_exn.bn.initializeBase(this,[1,"VM.Extensibility."+n])};_exn.bn.prototype={c:function(){_a.l.a.a(this)},b:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};this.a[t.key]=t.value}}};_exn.F=function(n,t){this.j=Function.createDelegate(this,this.m);_exn.F.initializeBase(this);this.c(!0);this.f(this.j);this.h=n;this.g=t;this.l=_a.a.j};_exn.F.prototype={h:null,g:null,m:function(){this.h(this.g)}};_exn.i=function(n,t){this.f=Function.createDelegate(this,this.n);this.h=[];_exn.i.initializeBase(this);this.d=n;this.e=t;this.g=_exn.B.b(n.Rule,this.e)};_exn.i.b=function(n,t,i){i.val=null;var f=new _exn.i(n,t);var u=null;var r=0;var s,o,e;if(e=_exn.i.c(n,t.a,s={val:u},o={val:r}),u=s.val,r=o.val,e){f.i=u;f.k=r;i.val=f;return!0}return!1};_exn.i.c=function(n,t,i,r){i.val=null;r.val=0;var e;if(t===1)e=0;else if(t===2||t===3)e=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,u=0;u<s;++u){var f=o[u];if(f.SettingsType===e){i.val=f.SourceLocation;if(n.Type==="Default"){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=f.RequestedHeight;return!0}}return!1};_exn.i.prototype={i:null,k:0,d:null,g:null,e:null,m:!1,j:null,a:function(){return this.d},q:function(){return _js.d.b(this.d.Settings)?{}:JsonParser.deserialize(this.d.Settings)},r:function(n){this.d.Settings=n?JsonParser.serialize(n):"";return n},p:function(){if(!_js.d.b(this.j))return this.j;this.j=_exn.i.a?_js.d.b(this.d.HighResolutionIconUrl)?this.d.IconUrl:this.d.HighResolutionIconUrl:_js.d.b(this.d.IconUrl)?this.d.HighResolutionIconUrl:this.d.IconUrl;return this.j},b:function(){return this.i},l:null,c:function(n){this.l=n;return n},o:function(n){if(n!==this.m){this.m=n;this.dQ("IsLastExtension")}return n},t:function(n){var e=this.e.h;var c=this.e.c;Array.clear(this.h);if(!this.d.DisableEntityHighlighting){var t={};var o=c;for(var f in o)for(var h={key:f,value:o[f]},u=h.value,i=0;i<u.length;i++)this.n(u[i],null,t);for(var r=0;r<e.length;r++){var s=e[r];switch(s){case 3:_exn.f.a(n.Addresses,"Address",t,this.f);break;case 6:_exn.f.a(n.EmailAddresses,"EmailAddress",t,this.f);break;case 4:_exn.f.a(n.Urls,"Url",t,this.f);break;case 1:_exn.f.a(n.MeetingSuggestions,"MeetingString",t,this.f);break;case 2:_exn.f.a(n.TaskSuggestions,"TaskString",t,this.f);break;case 5:_exn.f.a(n.PhoneNumbers,"OriginalPhoneString",t,this.f);break;case 7:_exn.f.a(n.Contacts,"ContactString",t,this.f);break}}this.e.e.i(t,this.f)}},n:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.h,n);r[n]=!0}}};_exn.bg=function(n,t,i){this.j=Function.createDelegate(this,this.r);this.k=Function.createDelegate(this,this.s);this.c=0;this.d=0;this.a=n;this.b=!1;this.f=t;this.i=i;for(var r=0;r<this.a.length;r++)this.a[r]=this.a[r].toUpperCase()};_exn.bg.prototype={a:null,g:null,h:null,i:null,f:null,c:0,d:0,b:!1,e:0,m:function(n,t,i){var r=[];this.h=i;this.c=0;this.d=0;this.b=!1;t||(t=new Array(0));this.e=t.length;this.g=_a.c.a();var e=this.p(n,t);var f;this.l(n,e,f={val:r}),r=f.val;for(var u=0;u<r.length;u++){this.d++;$("."+r[u],n).each(this.k)}},l:function(n,t,i){if(_a.c.a().g(this.g)>=100){t[0]&&!t[0].b&&Array.add(i.val,t[0].d);this.b=!0;return}for(var u=n.childNodes[0],f=0,o=0,h=0,r=t[0];u;){o=u.nodeType!==8?u.textContent.length:0;for(var e=[];r&&r.b>=f&&r.b<=f+o;)if(r.a<=f+o){r.b=r.b-f;r.a=r.a-f;Array.add(e,r);r=t[++h]}else{var c=new _exn.O(r.b-f,o,r.c,r.d);Array.add(e,c);r.b=f+o;break}if(e.length){if(Array.indexOf(this.a,u.nodeName.toUpperCase())!==-1)for(var s=0;s<e.length;s++)Array.add(i.val,e[s].d);u.nodeType===3?this.o(u,e):this.l(u,e,i)}f+=o;u=u.nextSibling}},o:function(n,t){for(var r=0,u=0;u<t.length;u++){var i=t[u];var s=n.textContent.substring(0,i.b-r);var f=n.textContent.substring(i.b-r,i.a-r);var c=n.textContent.substring(i.a-r,n.textContent.length);if(!$.trim(f).length)return;var h=String.format('<span tabindex="0" role="button" class="{0} {1}">{2}</span>',this.f,i.d,f);var o;n.parentNode.insertBefore(document.createTextNode(s),n);o=n.parentNode.insertBefore($(h)[0],n);n.textContent=c;var e={};e.Item=this.h;e.Terms=t[u].c;$(o).bind("touchstart click keydown",e,this.i);r+=s.length+f.length}},s:function(n,t){$(t).unbind("touchstart click keydown");var i=t;if(i.previousSibling&&i.previousSibling.nodeType===3&&i.nextSibling&&i.nextSibling.nodeType===3){i.previousSibling.textContent+=i.textContent;i.previousSibling.textContent+=i.nextSibling.textContent;i.parentNode.removeChild(i.nextSibling);i.parentNode.removeChild(i)}else if(i.previousSibling&&i.previousSibling.nodeType===3){i.previousSibling.textContent+=i.textContent;i.parentNode.removeChild(i)}else if(i.nextSibling&&i.nextSibling.nodeType===3){i.nextSibling.textContent+=i.textContent;i.parentNode.removeChild(i)}else{i.parentNode.insertBefore(document.createTextNode(i.textContent),i);i.parentNode.removeChild(i)}},p:function(n,t){for(var e=[],i=null,o=n.textContent,f=0;t&&f<t.length;f++){i=o.match(this.n(t[f]));if(!i){this.c++;continue}for(var r=0;r<i.length;r++)for(var u=-1;(u=o.indexOf(i[r],u))!==-1;){Array.add(e,new _exn.O(u,u+i[r].length,[t[f]]));u+=i[r].length}}this.q(e);return e},n:function(n){n=n.replace(new RegExp("[.*+?^${}()|[\\]\\\\]","g"),"\\$&");return new RegExp(n.replace(new RegExp("\\s+","g"),"\\s*"))},q:function(n){n.sort(this.j);for(var t=n.length;t--;)if(n[t-1]&&n[t-1].a>n[t].b){n[t-1].a<n[t].a&&(n[t-1].a=n[t].a);for(var i=0;i<n[t].c.length;i++)n[t-1].f(n[t].c[i]);n[t-1].e();n.splice(t,1)}},r:function(n,t){var r=n;var i=t;if(r.b<i.b)return-1;else if(r.b>i.b)return 1;if(r.a<i.a)return-1;else if(r.a>i.a)return 1;return 0}};_exn.bz=function(n,t,i,r,u){this.j=Function.createDelegate(this,this.m);_exn.bz.initializeBase(this,[u]);this.e=n;this.g=t;this.k=i;this.h=r};_exn.bz.prototype={e:0,g:0,c:1,k:null,f:!1,h:null,n:function(){_js.Trace.logInfo(_a.a.j,"RetryTimer.Start");this.f=!1;this.b(this.j,this.g,this.h)},l:function(){_js.Trace.logInfo(_a.a.j,"RetryTimer.End");this.f=!0;this.c=this.e;this.a()},m:function(){_js.Trace.logInfo(_a.a.j,"RetryTimer.Callback: count {0}",this.c);this.k();if(this.c<this.e){this.c++;this.b(this.j,this.g,this.h)}else{_js.Trace.logInfo(_a.a.j,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.c,this.e);this.l()}}};_exn.B=function(){};_exn.B.b=function(n,t){var i=_exn.B.a(n,t);if(!$a(i)){t.f>7&&i.g("Number of custom pattern rules exceeds the limit of "+7+".");t.g>15&&i.g("Number of rules exceeds the limit of "+15+".");if(i.i)return i}return null};_exn.B.a=function(n,t){return $a(n)?null:(t.g=t.g+1)>15?null:n.Type==="Collection"?new _exn.bb(n,t):n.Type==="ItemIs"?new _exn.w(n):n.Type==="ItemHasKnownEntity"?new _exn.f(n):n.Type==="ItemHasRegularExpressionMatch"?new _exn.v(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _exn.bu:null};_exn.B.prototype={i:!0,l:function(){return this.f()===3},h:function(n,t){return!0},f:function(){return 0},g:function(n){_js.Trace.logError(_a.a.j,n);this.i=!1}};_exn.bb=function(n,t){_exn.bb.initializeBase(this);if($a(n.Mode)){this.g("Collection rule with no required 'mode' attribute found.");return}if($a(n.Rules)||!n.Rules.length){this.g("Collection rule with no required 'rule' attribute found.");return}this.c="And"===n.Mode;this.a=new _js.f;for(var i=0;i<n.Rules.length;i++){var r=_exn.B.a(n.Rules[i],t);$a(r)||this.a.a(r)}};_exn.bb.prototype={c:!1,a:null,b:function(n,t,i){for(var r=this.c,u=0;u<this.a.x.length;u++){var f=this.a.x[u];r=this.c?!!(r&f.b(n,t,i)):!!(r|f.b(n,t,i))}return r},h:function(n,t){for(var i=0;i<this.a.x.length;i++){var r=this.a.x[i];if(!r.h(n,t))return!1}return!0},f:function(){for(var i=2,r=!1,n=0;n<this.a.x.length;n++){var t=this.a.x[n].f();if(!t)return 0;t===3&&(i=3);this.c||t!==2||(r=!0)}!this.c&&r&&(i=2);return i}};_exn.M=function(n,t,i){this.h=[];this.e=new _exn.e;this.d=n;this.a=t;this.b=i};_exn.M.prototype={f:0,g:0,c:null,b:!1,d:null,a:0};_exn.e=function(){};_exn.e.c=function(n,t,i,r){if(n){var f=n;for(var u in f){var e={key:u,value:f[u]};_exn.f.a(e.value,t,i,r)}}};_exn.e.b=function(n,t,i){i&&(n[t]=i)};_exn.e.a=function(n,t,i){n.val||(n.val={});n.val[t]=i};_exn.e.prototype={a:null,b:null,c:null,d:null,e:null,f:null,g:null,j:function(){var n={};_exn.e.b(n,"Addresses",this.a);_exn.e.b(n,"Contacts",this.b);_exn.e.b(n,"EmailAddresses",this.c);_exn.e.b(n,"MeetingSuggestions",this.d);_exn.e.b(n,"PhoneNumbers",this.e);_exn.e.b(n,"TaskSuggestions",this.f);_exn.e.b(n,"Urls",this.g);return n},h:function(n,t,i){switch(n){case 3:var o;_exn.e.a(o={val:this.a},t,i),this.a=o.val;break;case 7:var s;_exn.e.a(s={val:this.b},t,i),this.b=s.val;break;case 6:var h;_exn.e.a(h={val:this.c},t,i),this.c=h.val;break;case 1:var e;_exn.e.a(e={val:this.d},t,i),this.d=e.val;break;case 5:var r;_exn.e.a(r={val:this.e},t,i),this.e=r.val;break;case 2:var u;_exn.e.a(u={val:this.f},t,i),this.f=u.val;break;case 4:var f;_exn.e.a(f={val:this.g},t,i),this.g=f.val;break;default:break}},i:function(n,t){_exn.e.c(this.a,null,n,t);_exn.e.c(this.b,"ContactString",n,t);_exn.e.c(this.c,null,n,t);_exn.e.c(this.d,"MeetingString",n,t);_exn.e.c(this.e,"OriginalPhoneString",n,t);_exn.e.c(this.f,"TaskString",n,t);_exn.e.c(this.g,"Url",n,t)}};_exn.bu=function(){_exn.bu.initializeBase(this)};_exn.bu.prototype={b:function(n,t,i){return t.a===1?n.bl.HasAttachments!==undefined&&n.bl.HasAttachments:!1}};_exn.f=function(n){this.j=Function.createDelegate(this,this.k);_exn.f.initializeBase(this);$a(n.EntityType)?this.g("ItemHasKnownEntity rule contains null entity type."):this.a=n};_exn.f.a=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_exn.f.b=function(n,t,i){if($a(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_exn.f.e(i,e,t)){f[r]=_exn.f.d(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.a.j,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.a.j,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_exn.f.e=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_exn.f.c(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_exn.f.c=function(n){return n===7||n===1||n===2};_exn.f.d=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.c.b(i.StartTime,!0).h());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.c.b(i.EndTime,!0).h());return i;default:return n}};_exn.f.prototype={a:null,e:null,d:null,h:function(n,t){return n.bl.EntityExtractionResult?!0:this.m(n.bl.PropertyExistence)?this.e?!1:t.b?!1:!_exn.f.c(this.a.EntityType):!0},b:function(n,t,i){if(!(t.a===1))return!1;this.d=null;var u=n.bl.EntityExtractionResult;if($a(u))return!1;if(this.a.RegExFilter){var f,e;if(!(e=_exn.v.a(this.a.RegExFilter,this.a.IgnoreCase,f={val:this.e}),this.e=f.val,e))return!1}var r=!1;switch(this.a.EntityType){case 3:r=this.c(t,u.Addresses,null);break;case 7:r=this.c(t,u.Contacts,"ContactString");break;case 6:r=this.c(t,u.EmailAddresses,null);break;case 1:r=this.c(t,u.MeetingSuggestions,"MeetingString");break;case 5:r=this.c(t,u.PhoneNumbers,"OriginalPhoneString");break;case 2:r=this.c(t,u.TaskSuggestions,"TaskString");break;case 4:r=this.c(t,u.Urls,null);break}return r},f:function(){return this.a.EntityType===3||this.a.EntityType===7||this.a.EntityType===1||this.a.EntityType===5||this.a.EntityType===2?3:0},c:function(n,t,i){var r=null;!$a(t)&&t.length>0&&(r=_exn.f.b(t,this.a.EntityType,n.b));if(r){if(!this.e){Array.add(n.h,this.a.EntityType);return!0}var u=_a.c.a();_exn.f.a(r,i,null,this.j);n.d.e(this.a.FilterName,_a.c.a().g(u));if(this.d){n.e.h(this.a.EntityType,this.a.FilterName,this.d);return!0}}this.e&&n.e.h(this.a.EntityType,this.a.FilterName,null);return!1},k:function(n,t,i){var r=n.match(this.e);if(r&&r.length>0){this.d||(this.d=[]);Array.add(this.d,t)}},m:function(n){return n?this.a.EntityType===3&&n.ExtractedAddresses||this.a.EntityType===7&&n.ExtractedContacts||this.a.EntityType===6&&n.ExtractedEmails||this.a.EntityType===1&&n.ExtractedMeetings||this.a.EntityType===5&&n.ExtractedPhones||this.a.EntityType===2&&n.ExtractedTasks||this.a.EntityType===4&&n.ExtractedUrls:!1}};_exn.v=function(n,t,i){_exn.v.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.a=n;t.f=t.f+1}else this.g("Invalid ItemHasRegularExpressionMatchRule rule.");this.c=i};_exn.v.a=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.a.j,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_exn.v.c=function(n){for(var t=n.length-1;t>=0;t--){var r=!1;if(t>=50||n[t].length>3072)r=!0;else for(var i=t-1;i>=0;i--)if(n[t]===n[i]){r=!0;break}r&&Array.removeAt(n,t)}return n};_exn.v.b=function(n,t){if(t){if(n.bF())return n.bF().bl.Value}else if(n.bC())return n.bC().bl.Value;else if(n.z())return n.z().bl.Value;_js.Trace.logWarning(_a.a.j,"Skipping regex eval: no body for item with Id: {0}.",n.bl.ItemId?n.bl.ItemId.Id:"'null id'");return null};_exn.v.prototype={a:null,c:null,k:16e3,d:64e3,e:5e5,b:function(n,t,i){if(!(t.a===1))return!1;var r=null;var o=this.m(n,t,i);if(o){var u;var e,f;if(!(f=_exn.v.a(this.a.RegExValue,this.a.IgnoreCase,e={val:u}),u=e.val,f))return!1;var s=_a.c.a();r=o.match(u);t.d.e(this.a.RegExName,_a.c.a().g(s));if(r&&r.length>0){r=_exn.v.c(r);if(r.length>0){t.c[this.a.RegExName]=r;return!0}}}t.c[this.a.RegExName]=new Array(0);return!1},f:function(){return this.a.PropertyName===2?3:0},m:function(n,t,i){if(this.a.PropertyName===1)return n.bl.Subject;else if(this.a.PropertyName===4){var r=null;if(_g.r.isInstanceOfType(n))n.bl.Sender&&(r=n.bl.Sender.Mailbox);else if(_g.i.isInstanceOfType(n)){var o=n.bl.Organizer;o&&(r=o.Mailbox)}if(r&&r.EmailAddress)return r.EmailAddress}else if(this.a.PropertyName===3){var s=null;n.cJ()===3&&(s=this.j(n,t.b));return s}else if(this.a.PropertyName===2){if(i.val)return i.val;var u=this.j(n,t.b);var c=_a.c.a();var f=$(u);var e=_a.c.a();f[0]&&(i.val=f[0].innerText);$a(i.val)&&(i.val=f.text());var h=_a.c.a();t.d.g(u?u.length:0,i.val?i.val.length:0,e.g(c),h.g(e));return i.val}return null},j:function(n,t){var i=_exn.v.b(n,t);if(i){if(i.length>this.e){_js.Trace.logInfo(_a.a.j,"Body size exceeds general activation size limit");i=null}if(this.c.p()||this.c.s())if(this.a.PropertyName===2){if(i.length>this.k){_js.Trace.logInfo(_a.a.j,"Body size exceeds IPhone/IPad activation size limit");i=null}}else if(this.a.PropertyName===3&&i.length>this.d){_js.Trace.logInfo(_a.a.j,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");i=i.substr(0,this.d)}}return i}};_exn.w=function(n){_exn.w.initializeBase(this);this.e=n.IncludeSubClasses;this.c=n.ItemType;this.a=n.FormType;$a(n.ItemClass)||(this.d=n.ItemClass.toLowerCase())};_exn.w.b=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_exn.w.a=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_exn.w.prototype={d:null,e:!1,c:0,a:0,b:function(n,t,i){if(t.a===1&&(this.a===2||this.a===3)){if(!$a(n.bl.ItemClass)){var r=n.bl.ItemClass.toLowerCase();if(this.c===1&&_g.r.isInstanceOfType(n)&&_exn.w.b(r)||this.c===2&&_g.i.isInstanceOfType(n)&&_exn.w.a(r)){if(!this.d)return!0;if(this.e){if(r.startsWith(this.d))return!0}else if(r===this.d)return!0}}}else if(t.a===2&&this.c===1||t.a===3&&this.c===2)return this.a===1||this.a===3;return!1},f:function(){return this.c===1||this.c===2?this.a===2||this.a===3?2:1:0}};_exn.r=function(){this.d=-1};_exn.r.prototype={e:0,f:null,g:0,c:0,h:function(){return this.c?Math.round(this.g/this.c):-1},b:function(n,t){this.c++;this.g+=n;if(n>=this.e){this.e=n;this.f=t}(this.d===-1||n<this.d)&&(this.d=n)},a:function(){if(!this.c)return"";var t=$a(this.f)?"":this.f;var n=[this.d,this.h(),this.e,t];return n.join(",")}};_exn.bH=function(){_exn.bH.initializeBase(this,[attachedElement])};_exn.s=function(n,t){this.d=Function.createDelegate(this,this.f);_exn.s.initializeBase(this,[n,t]);this.bw=!1;this.bl=!0;this.ij(!0)};_exn.s.prototype={b:null,a:!1,c:!1,e:function(){if(this.Z().b()>0){this.mk();this.eo();this.a=!1}else{this.b.X();this.a=!0}},J:function(){_fce.b.prototype.J.call(this);this.B.bind("keydown",this.d)},P:function(){this.B.unbind("keydown",this.d);_js.b.prototype.P.call(this)},K:function(){_fce.b.prototype.K.call(this);this.b=this.F.a("GetMoreAppsButton")},fH:function(){var n=_fce.b.prototype.fH.call(this);if(this.bY.a()==="Mouse"){n.Y().c(-1);n.Y().a(3);var t=this;n.B.keydown(function(i){if(i.which===13||i.which===32){t.cp(n,new _a.U(i));i.preventDefault()}})}return n},cp:function(n,t){if(this.S()){var i=n.E();t.r().extensionViewModel=i;this.cz(new _ff.r(t,3))}},dP:function(n){if(!this.c&&this.a){this.a=!1;this.b.C(-1)}else this.c=!1},f:function(n){if(this.a||this.cv()){var t=new _a.U(n);var r=this.bT(this.cv());var i=this.Z().c(r);if(this.a&&(t.a()===32||t.a()===13))this.c=!0;else if(t.a()===40){if(!this.a){this.ml();if(this.cv()===i){this.dz(null);this.dx(null);this.b.C(0);this.b.X();this.a=!0}}}else if(t.a()===38)if(this.a){this.jZ();this.b.C(-1);this.a=!1}else this.mm();else t.a()===9&&_js.g.a().a(_a.a.j,"ComposeExtensibilityMenuListView",this.oO,100)}}};_exn.x=function(n){this.f=Function.createDelegate(this,this.j);this.b=Function.createDelegate(this,this.h);this.d=Function.createDelegate(this,this.g);this.e=Function.createDelegate(this,this.i);_exn.x.initializeBase(this,[n]);this.a={}};_exn.x.prototype={a:null,c:!1,K:function(){_js.b.prototype.K.call(this);this.a.CloseButton=this.F.a("CloseButton");this.a.ComposeExtMenuListView=this.F.a("ComposeExtMenuListView");this.a.AppsBackButton=this.F.a("AppsBackButton")},J:function(){_js.b.prototype.J.call(this);this.B.bind("keydown",this.e);var n=this.E();this.apcl("DataContext",this.d);n&&this.g(null,null)},P:function(){var n=this.E();this.B.unbind("keydown",this.e);this.rpcl("DataContext",this.d);if(n&&this.c){n.o(this.b);n.y(this.b);n.p(this.f);this.c=!1}_js.b.prototype.P.call(this)},g:function(n,t){var i=this.E();i.h(this.b);i.r(this.b);i.i(this.f);this.c=!0},h:function(){this.a.ComposeExtMenuListView.e()},j:function(){this.a.AppsBackButton.X()},i:function(n){var t=new _a.U(n);if(t.a()===27){var i=this.E();i.e(!1);t.d()}}};_exn.q=function(n){_exn.q.initializeBase(this,[n])};_exn.q.prototype={a:0,b:0,d:null,g:function(n){if(this.a!==n){this.a=n;this.bj("PopupXPosition")}return n},e:function(n){if(this.b!==n){this.b=n;this.bj("PopupYPosition")}return n},c:0,h:function(n){if(n&&this.d!==n){var t=$(n.target);this.f(t,570,this.c+28)}this.d=n;return n},K:function(){_js.b.prototype.K.call(this)},J:function(){_js.b.prototype.J.call(this)},P:function(){_js.b.prototype.P.call(this)},f:function(n,t,i){var f=window.document.body.clientHeight;var r=n.offset();var u=n.height();this.g(r.left);i+r.top+u>=f&&r.top>i?this.e(r.top-(i+4)):this.e(r.top+(u+4))}};_exn.H=function(n){_exn.H.initializeBase(this,[n])};_exn.H.prototype={f:function(n){this.B.hide();this.B.prev().show()}};_exn.d=function(n,t,i){this.o=Function.createDelegate(this,this.ck);this.c=Function.createDelegate(this,this.ca);this.p=Function.createDelegate(this,this.cr);this.q=Function.createDelegate(this,this.k);this.v=Function.createDelegate(this,this.bX);this.n=Function.createDelegate(this,this.bJ);_exn.d.initializeBase(this,[n,t]);this.g=i;this.l=t;this.bw=!1;this.ij(!0);this.bl=!0};_exn.d.prototype={d:null,h:null,j:0,a:null,f:null,s:!1,t:!1,l:null,g:null,i:!1,b:null,e:!1,r:function(){return!!this.d},m:function(n){if(this.j!==n){this.j=n;this.bj("MaxTabCount");n>0&&this.bB()}return n},cH:function(n){this.f=n;this.i&&this.f&&this.bB();return n},cs:function(n){if(this.a!==n){this.a=n;this.k()}return n},k:function(){this.m(this.w(this.x(!0)))},ck:function(n){var t=new _a.U(n);if(t.a()===_ff.k.b){var r=this.cv();this.ml();var i=this.cv();if(r===i){this.dz(null);this.bQ()}}else t.a()===_ff.k.a?this.e?this.jZ():this.mm():t.a()===27&&this.r()&&this.h.z.target.focus()},dP:function(n){this.e||_fce.b.prototype.dP.call(this,n)},K:function(){_fce.b.prototype.K.call(this);this.b=this.F.a("OfficeStoreButton");var n=this;this.b.B.blur(function(t){n.e=!1;n.dP(null);n.b.C(-1)})},fH:function(){var n=_fce.b.prototype.fH.call(this);if(this.bY.a()==="Mouse"){n.Y().c(0);n.Y().a(3);var t=this;n.B.keydown(function(i){(i.which===13||i.which===32)&&t.cp(n,new _a.U(i))})}return n},J:function(){_fce.b.prototype.J.call(this);this.h=this.E();this.d=this.h.D;this.r()&&this.d.r(this.n);_js.g.a().a(this.H(),"ExtensibilityMenuListView - Trigger InternalOnActivate on delay",this.v,0)},P:function(){_js.b.prototype.P.call(this);if(this.t){if("Mouse"===this.bY.a()){this.l.j(this.q);this.g.c(_a.dO,this.p);_g.a.a().b().L(this.c);_g.a.a().b().Z(this.c)}this.r()&&this.d.v(this.n);this.B.unbind("keydown",this.o)}},cp:function(n,t){if(this.S()){var i=n.E();t.r().extensionViewModel=i;this.cz(new _ff.r(t,3))}},bQ:function(){this.b.C(0);this.e=!0;this.b.X()},w:function(n){if(!this.a)return 0;for(var r=this.a.x.length,e=-1,u=0,o=0,f=new Array(r),i=0;i<r;i++){f[i]=this.bt(this.a.x[i].d.DisplayName);this.a.x[i]===this.bd()&&(e=i)}if(e>-1){o+=f[e];u++}for(var t=0;t<r;){if(t!==e)if(o+f[t]<n){o+=f[t];u++}else break;t++}t<r&&o+46>=n&&u--;return u},bt:function(n){if(!(n in _exn.d.c)){if(!_exn.d.a||$("#extensionRuler").length<=0){_exn.d.a=document.createElement("span");_exn.d.a.id="extensionRuler";_exn.d.a.className="extensionRuler ms-fwt-r";document.body.appendChild(_exn.d.a)}var t=document.createElement("span");t.className="extensionRulerItem";t.appendChild(document.createTextNode(n));_exn.d.a.appendChild(t);_exn.d.c[n]=_exn.d.a.offsetWidth;_exn.d.a.removeChild(t)}return _exn.d.c[n]},bJ:function(){_js.g.a().a(this.H(),"ExtensibilityMenuListView - Trigger InternalOnActivate on delay",this.mc,0)},x:function(n){var r=this.bW();var i=this.B.width();if(i>0)_exn.d.b=i;else if(!_exn.d.b||n){var t=this;_exn.d.b=i;while(!$a(t)&&!$a(t.L)&&!$a(t.B)&&_exn.d.b<=0){t=t.L;_exn.d.b=t.B.width()}}return _exn.d.b-r},bW:function(){return this.s?0:this.bt(_u.S.Q)+22},ca:function(n,t){this.k()},cr:function(n){this.k()},bX:function(){if(this.S()){this.m(0);if("Mouse"===this.bY.a()){this.l.i(this.q);this.g.b(_a.dO,this.p);_g.a.a().b().E(this.c);_g.a.a().b().V(this.c)}this.m(this.w(this.x(!1)));this.B.bind("keydown",this.o);this.t=!0}},bB:function(){if(this.f){this.f.a();this.i=!1}else this.i=!0}};_exn.y=function(n){_exn.y.initializeBase(this,[n])};_exn.y.prototype={a:!1,b:!0,c:null,f:function(n){if(this.c!==n){this.c=n;this.bj("OverflowMenuViewModel")}return n},d:function(n){if(this.b!==n){this.b=n;this.bj("HideExtensionContainer")}return n},e:function(n){if(this.a!==n){this.a=n;this.bj("DisplayInCard")}return n}};_exn.k=function(){};_exn.k.c=function(){return _fm.b.b(_fm.a.o,null,["ms-fcl-nt-b"],null,null,null,null,null)};_exn.k.h=function(){return _fm.b.b(_fm.a.m,_fm.a.r,["ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle","ms-fcl-ns-b",_fm.WebfontSizes.b.e],null,null,null,null,null)};_exn.k.i=function(){return _fm.b.b(_fm.a.m,_fm.a.r,["ms-bcl-np-b ms-bg-transparent ms-icon-font-circle","ms-fcl-np-b",_fm.WebfontSizes.b.e],null,null,null,null,null)};_exn.k.j=function(){return _fm.b.b(_fm.a.m,_fm.a.r,["ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle","ms-fcl-ns-b",_fm.WebfontSizes.b.a],null,null,null,null,null)};_exn.k.k=function(){return _fm.b.b(_fm.a.m,_fm.a.r,["ms-bcl-ns-b ms-bgc-ns-b ms-icon-font-circle","ms-fcl-w-b",_fm.WebfontSizes.b.a],null,null,null,null,null)};_exn.k.e=function(){return _fm.b.b(_fm.a.c,null,["ms-fcl-ns-b"],null,null,null,null,null)};_exn.k.f=function(){return _fm.b.b(_fm.a.c,null,["ms-fcl-np-b"],null,null,null,null,null)};_exn.k.b=function(){return _fm.b.b(_fm.a.h,null,null,null,null,null,null,null)};_exn.k.d=function(){return _fm.b.b(_fm.a.cY,null,null,null,null,null,null,null)};_exn.k.a=function(){return _fm.b.b(_fm.a.o,null,null,null,null,null,null,null)};_exn.k.g=function(){return _fm.b.b(_fm.a.m,null,null,null,null,null,null,null)};_exn.o=function(n,t){_exn.o.initializeBase(this,[n]);this.h=t};_exn.o.prototype={h:null,f:!1,g:!1,c:null,a:null,e:null,d:null,b:null,l:function(n){if(n&&n!==this.c){this.c=n;this.i()}return n},n:function(n){if(this.e!==n){this.e=n;this.i()}return n},m:function(n){if(this.a===n)return n;$a(n)&&this.k();this.a=n;this.i();return n},j:function(n,t,i,r,u,f,e,o,s){this.c.displayNotification({infoType:n,id:t,title:i,description:r,buttonTxt:u,buttonCallback:f,detailView:e,displayDeactive:o,reDisplay:s})},k:function(){if(_exn.o.a>0&&!$a(this.c)&&this.b){this.c.purgeOsfControl(this.b,!1);this.b=null}},i:function(){if(!$a(this.a)&&!$a(this.c)&&!$a(this.e)&&!this.bA()){this.k();_exn.o.a++;this.b="ocii"+_exn.o.a;var a="DefaultSettings";var i=new OSF.Manifest.ExtensionSettings;i._sourceLocations[this.e]=this.a.d.Type!=="Preinstalled"||this.a.d.ConsentState?this.a.i:this.a.l;if(OSF.OsfManifestManager.hasManifest(this.a.d.Id,this.a.d.Version)){var w=OSF.OsfManifestManager.getCachedManifest(this.a.d.Id,this.a.d.Version);w._extensionSettings[a]=i}else{var v=this;var b=new OSF.Manifest.Manifest(function(n){n._id=v.a.d.Id;n._version=v.a.d.Version;n._extensionSettings={};n._displayNames={};n._extensionSettings[a]=i});OSF.OsfManifestManager.cacheManifest(this.a.d.Id,this.a.d.Version,b)}if(!this.f)if(this.h.a()==="TouchNarrow")this.B.css("height","100%");else{var t;t=this.a.k;t<32?t=32:t>450&&(t=450);this.B.css("height",t.toString()+"px")}this.c.insertOsfControl({div:this.B[0],id:this.b,marketplaceID:this.a.d.Id,marketplaceVersion:this.a.d.Version,settings:this.a.q(),store:"",storeType:OSF.StoreType.Exchange});if(_y.c.a.a()==="Mouse"){var p=this;_js.g.a().c(_a.a.j,"OsfHostContainerView.TryInsertOsfControl",function(){p.B.children()[0]&&p.B.children()[0].focus()})}if(this.a.d.Origin==="User"||this.a.d.Origin==="Organization"&&this.g){var n=this;var y=function(){n.d&&n.d.b(n.d.f())&&n.d.f().b().a()?n.d.f().a(n.a.d.EndNodeUrl):window.open(n.a.d.EndNodeUrl)};if(_js.d.b(this.a.d.AppStatus))this.a.d.LicenseType===1&&this.j(2,this.b,_u.S.U,_u.S.F,_u.S.K,y,!1,!1,!0);else{var f;var r;var e;var u;var c,l,h,o,s;(s=this.o(this.a.d.AppStatus,c={val:f},l={val:r},h={val:e},o={val:u}),f=c.val,r=l.val,e=h.val,u=o.val,s)&&this.j(1,this.b,_u.S.P,f,r,y,e,u,!0)}}}},o:function(n,t,i,r,u){t.val="";i.val="";r.val=!1;u.val=!1;switch(n){case"1.0":t.val=_u.S.O;i.val=_u.S.V;r.val=!0;u.val=!0;break;case"1.1":t.val=_u.S.H;i.val=_u.S.V;r.val=!0;u.val=!0;break;case"1.2":t.val=_u.S.M;i.val=_u.S.V;r.val=!0;u.val=!0;break;case"2.0":t.val=_u.S.N;i.val=_u.S.V;break;case"2.1":t.val=_u.S.I;i.val=_u.S.V;break;case"3.0":t.val=_u.S.L;i.val=_u.S.Z;break;case"3.1":t.val=_u.S.T;i.val=_u.S.Z;break;case"3.2":t.val=_u.S.S;i.val=_u.S.Z;break;case"3.3":t.val=_u.S.J;i.val=_u.S.Z;break;default:_js.Trace.logWarning(this.H(),String.format("The app status {0} does not have corresponding description.",n));return!1}return!0}};_exn.t=function(n){_exn.t.initializeBase(this,[n])};_exn.t.prototype={a:!1,b:!0,c:null,f:function(n){if(this.c!==n){this.c=n;this.bj("OverflowMenuViewModel")}return n},e:function(n){if(this.b!==n){this.b=n;this.bj("HideExtensionContainer")}return n},d:function(n){if(this.a!==n){this.a=n;this.bj("DisplayInCard")}return n}};_exn.bI=function(n){this.f=Function.createDelegate(this,this.j);this.b=Function.createDelegate(this,this.h);this.d=Function.createDelegate(this,this.g);this.e=Function.createDelegate(this,this.i);_exn.bI.initializeBase(this,[n]);this.a={}};_exn.bI.prototype={a:null,c:!1,K:function(){_js.b.prototype.K.call(this);this.a.CloseButton=this.F.a("CloseButton");this.a.ComposeExtMenuListView=this.F.a("ComposeExtMenuListView");this.a.AppsBackButton=this.F.a("AppsBackButton")},J:function(){_js.b.prototype.J.call(this);this.B.bind("keydown",this.e);var n=this.E();this.apcl("DataContext",this.d);n&&this.g(null,null)},P:function(){var n=this.E();this.B.unbind("keydown",this.e);this.rpcl("DataContext",this.d);if(n&&this.c){n.o(this.b);n.y(this.b);n.p(this.f);this.c=!1}_js.b.prototype.P.call(this)},g:function(n,t){var i=this.E();i.h(this.b);i.r(this.b);i.i(this.f);this.c=!0},h:function(){this.a.ComposeExtMenuListView.e()},j:function(){this.a.AppsBackButton.X()},i:function(n){var t=new _a.U(n);if(t.a()===27){var i=this.E();i.e(!1);t.d()}}};_exn._TI=function(){};_exn._TI.$$cctor=function(){var ut="ComposeAppsPane";new _A(ut,function(){_exn._TI.a[ut]===undefined&&(_exn._TI.a[ut]=[[[-1,0,["IsOwaExtensibilityActive"],[_exn._TI.bT],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0]],[[-1,0,["IsXOwaExtensibilityActive"],[_exn._TI.bU],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0]]]);var n=_exn._TI._hf.childNodes[0].cloneNode(!0);var i=new _exn.bI(n.children[1]);i.y("XComposeExtensibilityView");var t=new _exn.x(n.children[0]);t.y("ComposeExtensibilityView");return new _B(n,[t,i])},_exn.n,_exn.bH,null,!1,!1,!1,0,_exn._TI.a);var rt="ComposeExtensibilityPopupView";new _A(rt,function(){_exn._TI.a[rt]===undefined&&(_exn._TI.a[rt]=[[[-1,0,["ExtensibilityViewModel"],[_exn._TI.bc],null,"DataContext",null,_exn._TI.t,1,null,null,null],[0,0,["IsOwaExtensibilityActive"],[_exn._TI.bP],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0]],[[-1,0,["ExtensibilityViewModel"],[_exn._TI.bc],null,"DataContext",null,_exn._TI.t,1,null,null,null],[0,0,["IsXOwaExtensibilityActive"],[_exn._TI.bQ],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0]]]);var n=_exn._TI._hf.childNodes[1].cloneNode(!0);var i=new _js.b(n.children[1]);i.y("XComposeExtensibilityView");var t=new _js.b(n.children[0]);t.y("ComposeExtensibilityView");return new _B(n,[t,i])},_exn.L,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_exn._TI.a);var et="ComposeExtensibilityView._tid1";new _A(et,function(){_exn._TI.a[et]===undefined&&(_exn._TI.a[et]=[null,[[-1,4,null,null,null,"AriaLabel",null,_exn._TI.O,0,null,null,null,_u.S.A],[-1,4,null,null,null,"AriaRole",null,_exn._TI.x,0,null,null,0,7],[-1,4,null,null,null,"Text",null,_exn._TI.Z,0,null,null,null,_u.S.R],[-1,0,["MarketplaceUrl"],[_exn._TI.u],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.f(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_exn._TI.J],null,"ClickCommand",null,_exn._TI.j,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[2].cloneNode(!0);var n=new _fc.b(_B.a(t,[1,0]));n.C(-1);var i=new _fce.c(t.children[0]);return new _B(t,[i,n]).R({ListPanel:i,GetMoreAppsButton:n})},_exn.n,_exn.s,function(n){return new _exn.s(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_exn._TI.a);var ft="ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3";new _A(ft,function(){_exn._TI.a[ft]===undefined&&(_exn._TI.a[ft]=[null,[[-1,0,["DisplayName"],[_exn._TI.w],null,"Text",null,_exn._TI.i,1,null,null,null]],[[-1,0,["ProviderName"],[_exn._TI.bu],null,"Text",null,_exn._TI.i,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[3].cloneNode(!0);var i=new _b.V(n.children[2]);var r=new _b.V(n.children[1]);var t=new _js.b(n.children[0]);t.y("ComposeExtensibilityView.ExtensionIconImage");return new _B(n,[t,r,i])},_exn.i,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var it="ComposeExtensibilityView.ComposeExtensionListItemTemplate";new _A(it,function(){_exn._TI.a[it]===undefined&&(_exn._TI.a[it]=[[[-1,0,["DisplayName"],[_exn._TI.w],null,"AriaLabel",null,_exn._TI.bM,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[4].cloneNode(!0);var n=new _js.b(t.children[0]);n.y("ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3");return new _B(t,[n])},_exn.i,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_exn._TI.a);var g="ComposeExtensibilityView.ExtensionIconImage";new _A(g,function(){_exn._TI.a[g]===undefined&&(_exn._TI.a[g]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.c()]],[[-1,0,["IconUrl"],[_exn._TI.M],null,"Source",null,_exn._TI.ba,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[5].cloneNode(!0);var i=new _exn.H(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_exn.i,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_exn._TI.a);var d="ComposeExtensibilityView";new _A(d,function(){_exn._TI.a[d]===undefined&&(_exn._TI.a[d]=[[[-1,5,["SelectedExtension"],[_exn._TI.v],null,"_exn_t",null,null,0,_exn._TI.E(),null,null],[-1,5,["IsLandscape"],[_exn._TI.k],null,"_exn_q",null,null,0,null,null,null],[-1,5,["IsTouchNarrow"],[_exn._TI.U],null,"tnarrow",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_exn._TI.x,0,null,null,0,3],[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_n.a.a()],[-1,4,null,null,null,"HoveredImageId",null,_exn._TI.P,0,null,null,null,_n.a.b()],[-1,4,null,null,null,"PressedImageId",null,_exn._TI.Y,0,null,null,null,_n.a.I()],[-1,4,null,null,null,"Title",null,_exn._TI.bb,0,null,null,null,_u.S.C],[-1,0,["IsTouchNarrow"],[_exn._TI.U],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,0,["HideAppPaneCommand"],[_exn._TI.be],null,"ClickCommand",null,_exn._TI.j,1,null,null,null],[-1,5,["IsLandscape"],[_exn._TI.k],null,"_exn_r",null,null,0,_exn._TI.d(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_exn._TI.x,0,null,null,0,3],[-1,4,null,null,null,"Title",null,_exn._TI.bb,0,null,null,null,_u.S.X],[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_exn.k.h()],[-1,4,null,null,null,"HoveredImageId",null,_exn._TI.P,0,null,null,null,_exn.k.i()],[-1,0,["BackToListCommand"],[_exn._TI.T],null,"ClickCommand",null,_exn._TI.j,1,null,null,null],[-1,0,["SelectedExtension"],[_exn._TI.v],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.E(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_exn.k.j()],[-1,4,null,null,null,"PressedImageId",null,_exn._TI.Y,0,null,null,null,_exn.k.k()],[-1,0,["BackToListCommand"],[_exn._TI.T],null,"ClickCommand",null,_exn._TI.j,1,null,null,null],[-1,0,["SelectedExtension"],[_exn._TI.v],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.E(),null,!0]],[[-1,0,["AppPaneTitle"],[_exn._TI.bd],null,"Text",null,_exn._TI.i,1,null,null,null]],[[-1,5,["IsLandscape"],[_exn._TI.k],null,"_exn_s",null,null,0,_exn._TI.d(),null,null]],[[-1,0,["HideExtensionsList"],[_exn._TI.y],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,0,["ActiveExtensions"],[_exn._TI.bq],null,"DataSource",null,_exn._TI.R,1,null,null,null],[-1,0,["ListViewEventInfo"],[_exn._TI.bf],_exn._TI.bg,"EventInfo",_exn._TI.Q,_exn._TI.S,2,null,null,null]],[[-1,0,["OsfContextActivationManager"],[_exn._TI.m],null,"OsfContextActivationManager",null,_exn._TI.o,1,null,null,null],[-1,0,["HideExtensionContainer"],[_exn._TI.H],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,0,["UserCulture"],[_exn._TI.n],null,"UserCulture",null,_exn._TI.q,1,null,null,null],[-1,0,["SelectedExtension"],[_exn._TI.v],null,"SelectedExtension",null,_exn._TI.p,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_exn._TI.I],null,"IsUserInOrgMarketplaceRole",null,_exn._TI.N,1,null,null,!1],[-1,5,["IsLandscape"],[_exn._TI.k],null,"_exn_s",null,null,0,_exn._TI.d(),null,null]],[[-1,0,["WindowObjectViewModel"],[_exn._TI.L],null,"DataContext",null,_exn._TI.t,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[6].cloneNode(!0);var o=new _b.I(_B.a(n,[0,3]));var u=new _exn.o(_B.a(n,[0,2]),_js.a.Instance.a(_y.a));u.f=!0;var t=new _exn.s(_B.a(n,[0,1,0]),_js.a.Instance.a(_y.a));t.U("ComposeExtensibilityView.ComposeExtensionListItemTemplate");t.bq("_exn_p");t.y("ComposeExtensibilityView._tid1");var s=new _js.c(_B.a(n,[0,1]));var h=new _b.V(_B.a(n,[0,0,3]));var e=new _fc.b(_B.a(n,[0,0,2]));var r=new _fc.b(_B.a(n,[0,0,1]));var i=new _fc.b(_B.a(n,[0,0,0]));i.C(0);var f=new _js.c(_B.a(n,[0,0]));return new _B(n,[f,i,r,e,h,s,t,u,o]).R({CloseButton:i,AppsBackButton:r,ComposeExtMenuListView:t})},_exn.n,_exn.x,function(n){return new _exn.x(n)},!1,!1,!1,0,_exn._TI.a);var tt="ExtensibilityPopupView._tid4";new _A(tt,function(){_exn._TI.a[tt]===undefined&&(_exn._TI.a[tt]=[[[-1,0,["ExtensibilityViewModel","UserCulture"],[_exn._TI.g,_exn._TI.n],null,"UserCulture",null,_exn._TI.q,1,null,null,null],[-1,0,["ExtensibilityViewModel","OsfContextActivationManager"],[_exn._TI.g,_exn._TI.m],null,"OsfContextActivationManager",null,_exn._TI.o,1,null,null,null],[-1,0,["ExtensibilityViewModel","OverflowMenuViewModel","TabSelectedExtension"],[_exn._TI.g,_exn._TI.K,_exn._TI.l],null,"SelectedExtension",null,_exn._TI.p,1,null,null,null]],[[-1,0,["ItemBodyValue"],[_exn._TI.bV],null,"Html",null,_exn._TI.bO,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[7].cloneNode(!0);var i=new _b.n(n.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_a.iP.$$(ILinkPreviewBuilderFactory)),_js.a.Instance.a(_a.h));var t=new _exn.o(n.children[0],_js.a.Instance.a(_y.a));return new _B(n,[t,i])},_exn.u,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var nt="ExtensibilityPopupView._tid5";new _A(nt,function(){_exn._TI.a[nt]===undefined&&(_exn._TI.a[nt]=[[[-1,0,["ExtensibilityViewModel"],[_exn._TI.g],null,"DataContext",null,_exn._TI.t,1,null,null,null],[0,0,["ContextualOverflowMenuViewModel"],[_exn._TI.V],null,"OverflowMenuViewModel",null,_exn._TI.X,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[8].cloneNode(!0);var n=new _exn.y(t.children[0]);n.y("ExtensibilityView.ExtensibilityViewCommon");n.d(!1);return new _B(t,[n])},_exn.u,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var vt="ExtensibilityPopupView";new _A(vt,function(){_exn._TI.a[vt]===undefined&&(_exn._TI.a[vt]=[[[-1,0,["IsContextual"],[_exn._TI.G],null,"IsHidden",null,_exn._TI.b,1,null,null,!0]],[[-1,0,["IsContextual"],[_exn._TI.G],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0]]]);var n=_exn._TI._hf.childNodes[9].cloneNode(!0);var i=new _js.b(n.children[1]);i.y("ExtensibilityPopupView._tid5");var t=new _js.b(n.children[0]);t.y("ExtensibilityPopupView._tid4");return new _B(n,[t,i])},_exn.u,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_exn._TI.a);var at="ExtensibilityView.ExtensibilityViewCommon._tid6";new _A(at,function(){_exn._TI.a[at]===undefined&&(_exn._TI.a[at]=[[[-1,4,null,null,null,"Text",null,_exn._TI.Z,0,null,null,null,_u.S.Q],[-1,4,null,null,null,"AriaLabel",null,_exn._TI.O,0,null,null,null,_u.S.A],[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_exn.k.e()],[-1,4,null,null,null,"HoveredImageId",null,_exn._TI.P,0,null,null,null,_exn.k.f()],[-1,0,["MarketplaceUrl"],[_exn._TI.u],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.f(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_exn._TI.J],null,"ClickCommand",null,_exn._TI.j,1,null,null,null],[-1,5,["TemplatedParent","DisplayInCard"],[_exn._TI.c,_exn._TI.z],null,"_exn_A:_exn_z",null,null,1,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_exn.k.b()],[-1,1,["TemplatedParent","OverflowMenuViewModel","HideExtensionContextMenu"],[_exn._TI.c,_exn._TI.h,_exn._TI.F],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,5,["TemplatedParent","DisplayInCard"],[_exn._TI.c,_exn._TI.z],null,"_exn_A:_exn_z",null,null,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[11].cloneNode(!0);var r=new _fc.b(n.children[2]);var i=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));i.D(_E.a(["TemplatedParent","TemplatedParent","OverflowMenuViewModel","ExtensionsContextMenuViewModel"],[_exn._TI.c,_exn._TI.c,_exn._TI.h,_exn._TI.bi],null,"MenuDataContext",null,_exn._TI.bI,1)).D(_E.a(["TemplatedParent","TemplatedParent","OverflowMenuViewModel","HideExtensionContextMenu"],[_exn._TI.c,_exn._TI.c,_exn._TI.h,_exn._TI.F],null,"IsShown",null,_exn._TI.bH,1,_exn._TI.d(),null,!1));i.a=1;r.G([i]);var u=new _fce.c(n.children[1]);var t=new _fc.b(n.children[0]);t.C(-1);return new _B(n,[t,u,r]).R({OfficeStoreButton:t,ListPanel:u})},_exn.j,_exn.d,function(n){return new _exn.d(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_exn._TI.a);var pt="ExtensibilityView.ExtensibilityViewCommon";new _A(pt,function(){_exn._TI.a[pt]===undefined&&(_exn._TI.a[pt]=[[[-1,5,["DisplayInCard"],[_exn._TI.z],null,"_exn_A:_exn_z",null,null,1,null,null,null]],[[-1,1,["OverflowMenuViewModel","ExtensionsTabList"],[_exn._TI.h,_exn._TI.bj],null,"DataSource",null,_exn._TI.R,1,null,null,null],[-1,1,["OverflowMenuViewModel","TabSelectedExtension"],[_exn._TI.h,_exn._TI.l],_exn._TI.bp,"SelectedItem",_exn._TI.bJ,_exn._TI.bK,2,null,null,null],[-1,1,["OverflowMenuViewModel","MaxTabCount"],[_exn._TI.h,_exn._TI.bl],_exn._TI.bo,"MaxTabCount",_exn._TI.by,_exn._TI.bB,2,null,null,0],[-1,1,["OverflowMenuViewModel","ActiveExtensions"],[_exn._TI.h,_exn._TI.bh],null,"ActiveExtensions",null,_exn._TI.bz,1,null,null,null],[-1,1,["OverflowMenuViewModel","PopulateMenuItemsCommand"],[_exn._TI.h,_exn._TI.bm],null,"PopulateMenuItemsCommand",null,_exn._TI.bC,1,null,null,null],[-1,1,["OverflowMenuViewModel","ListViewEventInfo"],[_exn._TI.h,_exn._TI.bk],_exn._TI.bn,"EventInfo",_exn._TI.Q,_exn._TI.S,2,null,null,null],[-1,0,["MarketplaceUrl"],[_exn._TI.u],null,"IsGetMoreAppHidden",null,_exn._TI.bA,1,_exn._TI.f(),null,!1]],[[-1,1,["HideExtensionContainer"],[_exn._TI.cb],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,1,["OverflowMenuViewModel","TabSelectedExtension"],[_exn._TI.h,_exn._TI.l],null,"SelectedExtension",null,_exn._TI.p,1,null,null,null],[-1,0,["OsfContextActivationManager"],[_exn._TI.m],null,"OsfContextActivationManager",null,_exn._TI.o,1,null,null,null],[-1,0,["UserCulture"],[_exn._TI.n],null,"UserCulture",null,_exn._TI.q,1,null,null,null],[-1,0,["NativeBridge"],[_exn._TI.bt],null,"NativeBridge",null,_exn._TI.bE,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_exn._TI.I],null,"IsUserInOrgMarketplaceRole",null,_exn._TI.N,1,null,null,!1],[-1,5,["DisplayInCard"],[_exn._TI.z],null,"_exn_A:_exn_z",null,null,1,null,null,null]],[[-1,0,["WindowObjectViewModel"],[_exn._TI.L],null,"DataContext",null,_exn._TI.t,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[12].cloneNode(!0);var r=new _b.I(n.children[2]);var u=new _exn.o(n.children[1],_js.a.Instance.a(_y.a));var t=new _exn.d(_B.a(n,[0,0]),_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));t.U("ExtensibilityView.ExtensionListItemTemplate");t.bq("_exn_B");t.y("ExtensibilityView.ExtensibilityViewCommon._tid6");var i=new _js.c(n.children[0]);return new _B(n,[i,t,u,r])},_exn.j,_exn.y,function(n){return new _exn.y(n)},!1,!1,!1,0,_exn._TI.a);var yt="ExtensibilityView.ExtensionListItemTemplate._tid9";new _A(yt,function(){_exn._TI.a[yt]===undefined&&(_exn._TI.a[yt]=[[[-1,0,["DisplayName"],[_exn._TI.w],null,"Text",null,_exn._TI.i,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[13].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_exn.i,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var lt="ExtensibilityView.ExtensionListItemTemplate";new _A(lt,function(){_exn._TI.a[lt]===undefined&&(_exn._TI.a[lt]=[[[-1,5,["IsSelected"],[_exn._TI.bL],null,"ms-font-color-white ms-bg-color-themePrimary",null,null,1,null,null,null],[-1,5,["TemplatedParent","TemplatedParent","DisplayInCard"],[_exn._TI.c,_exn._TI.c,_exn._TI.z],null,"_exn_A:_exn_z",null,null,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[14].cloneNode(!0);var n=new _js.b(t.children[0]);n.y("ExtensibilityView.ExtensionListItemTemplate._tid9");return new _B(t,[n])},_exn.i,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_exn._TI.a);var st="ExtensibilityView";new _A(st,function(){_exn._TI.a[st]===undefined&&(_exn._TI.a[st]=[[[-1,0,["HideExtensionContainer"],[_exn._TI.H],null,"HideExtensionContainer",null,_exn._TI.bD,1,null,null,!1],[-1,0,["OverflowMenuViewModel"],[_exn._TI.K],null,"OverflowMenuViewModel",null,_exn._TI.X,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[15].cloneNode(!0);var n=new _exn.y(t.children[0]);n.y("ExtensibilityView.ExtensibilityViewCommon");return new _B(t,[n])},_exn.j,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_exn._TI.a);var ot="ExtensibilityCardView._tida._tidb";new _A(ot,function(){_exn._TI.a[ot]===undefined&&(_exn._TI.a[ot]=[[[-1,0,["HideContextualExtensionContainer"],[_exn._TI.bs],null,"HideExtensionContainer",null,_exn._TI.bD,1,null,null,!1],[-1,0,["ContextualOverflowMenuViewModel"],[_exn._TI.V],null,"OverflowMenuViewModel",null,_exn._TI.X,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[16].cloneNode(!0);var n=new _exn.y(t.children[0]);n.y("ExtensibilityView.ExtensibilityViewCommon");n.e(!0);return new _B(t,[n]).R({PopupContent:n})},_exn.j,_fce.k,function(n){return new _fce.k(n,_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b))},!1,!0,!1,0,_exn._TI.a);var ct="ExtensibilityCardView._tida";new _A(ct,function(){_exn._TI.a[ct]===undefined&&(_exn._TI.a[ct]=[[[-1,0,["ShowContextualCard"],[_exn._TI.bv],_exn._TI.bY,"IsShown",_exn._TI.cd,_exn._TI.ce,2,null,null,!1]]]);var i=_exn._TI._hf.childNodes[17].cloneNode(!0);var n=new _fce.k(i.children[0],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));n.e=!0;n.v("contextMenuDropShadow");var t=new _fce.E(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.b));t.D(_E.a(["TemplatedParent","PopupXPosition"],[_exn._TI.c,_exn._TI.bZ],null,"X",null,_exn._TI.cf,1,null,null,0)).D(_E.a(["TemplatedParent","PopupYPosition"],[_exn._TI.c,_exn._TI.ca],null,"Y",null,_exn._TI.cg,1,null,null,0));n.c(t);n.y("ExtensibilityCardView._tida._tidb");return new _B(i,[n])},_exn.j,_exn.q,function(n){return new _exn.q(n)},!1,!0,!1,0,_exn._TI.a);var ht="ExtensibilityCardView";new _A(ht,function(){_exn._TI.a[ht]===undefined&&(_exn._TI.a[ht]=[[[-1,0,["ExtensionHeight"],[_exn._TI.br],null,"ExtensionHeight",null,_exn._TI.bw,1,null,null,0],[-1,0,["LastContextualTermClickedEvent"],[_exn._TI.W],null,"TermClickedEvent",null,_exn._TI.bx,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[18].cloneNode(!0);var n=new _exn.q(t.children[0]);n.T(!0);n.y("ExtensibilityCardView._tida");return new _B(t,[n])},_exn.j,_js.b,function(n){return new _js.b(n)},!1,!1,!0,0,_exn._TI.a);var k="XExtensibilityView.ExtensibilityViewCommon._tidc._tidd";new _A(k,function(){_exn._TI.a[k]===undefined&&(_exn._TI.a[k]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.a()]]]);var n=_exn._TI._hf.childNodes[19].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_exn.j,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var e="XExtensibilityView.ExtensibilityViewCommon._tidc._tide._tidf";new _A(e,function(){_exn._TI.a[e]===undefined&&(_exn._TI.a[e]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.d()]]]);var n=_exn._TI._hf.childNodes[20].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_exn.j,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var f="XExtensibilityView.ExtensibilityViewCommon._tidc._tide";new _A(f,function(){_exn._TI.a[f]===undefined&&(_exn._TI.a[f]=[null]);var t=_exn._TI._hf.childNodes[18].cloneNode(!0);var n=new _js.b(t.children[0]);n.y("XExtensibilityView.ExtensibilityViewCommon._tidc._tide._tidf");return new _B(t,[n])},_exn.j,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_exn._TI.a);var s="XExtensibilityView.ExtensibilityViewCommon._tidc";new _A(s,function(){_exn._TI.a[s]===undefined&&(_exn._TI.a[s]=[null,[[-1,4,null,null,null,"AriaLabel",null,_exn._TI.O,0,null,null,null,_u.S.A],[-1,0,["MarketplaceUrl"],[_exn._TI.u],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.f(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_exn._TI.J],null,"ClickCommand",null,_exn._TI.j,1,null,null,null],[-1,5,["TemplatedParent","DisplayInCard"],[_exn._TI.c,_exn._TI.A],null,"_exn_M:_exn_L",null,null,1,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_exn.k.b()],[-1,1,["TemplatedParent","OverflowMenuViewModel","HideExtensionContextMenu"],[_exn._TI.c,_exn._TI.e,_exn._TI.F],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,5,["TemplatedParent","DisplayInCard"],[_exn._TI.c,_exn._TI.A],null,"_exn_M:_exn_L",null,null,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[21].cloneNode(!0);var u=new _fc.b(n.children[3]);var i=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));i.D(_E.a(["TemplatedParent","TemplatedParent","OverflowMenuViewModel","ExtensionsContextMenuViewModel"],[_exn._TI.c,_exn._TI.c,_exn._TI.e,_exn._TI.bi],null,"MenuDataContext",null,_exn._TI.bI,1)).D(_E.a(["TemplatedParent","TemplatedParent","OverflowMenuViewModel","HideExtensionContextMenu"],[_exn._TI.c,_exn._TI.c,_exn._TI.e,_exn._TI.F],null,"IsShown",null,_exn._TI.bH,1,_exn._TI.d(),null,!1));i.a=1;u.G([i]);var f=new _fce.c(n.children[2]);var t=new _fc.b(n.children[1]);t.C(-1);t.y("XExtensibilityView.ExtensibilityViewCommon._tidc._tide");var r=new _js.b(_B.a(n,[0,0]));r.y("XExtensibilityView.ExtensibilityViewCommon._tidc._tidd");return new _B(n,[r,t,f,u]).R({OfficeStoreButton:t,ListPanel:f})},_exn.j,_exn.d,function(n){return new _exn.d(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_exn._TI.a);var o="XExtensibilityView.ExtensibilityViewCommon";new _A(o,function(){_exn._TI.a[o]===undefined&&(_exn._TI.a[o]=[[[-1,5,["DisplayInCard"],[_exn._TI.A],null,"_exn_M:_exn_L",null,null,1,null,null,null]],[[-1,1,["OverflowMenuViewModel","ExtensionsTabList"],[_exn._TI.e,_exn._TI.bj],null,"DataSource",null,_exn._TI.R,1,null,null,null],[-1,1,["OverflowMenuViewModel","TabSelectedExtension"],[_exn._TI.e,_exn._TI.l],_exn._TI.bp,"SelectedItem",_exn._TI.bJ,_exn._TI.bK,2,null,null,null],[-1,1,["OverflowMenuViewModel","MaxTabCount"],[_exn._TI.e,_exn._TI.bl],_exn._TI.bo,"MaxTabCount",_exn._TI.by,_exn._TI.bB,2,null,null,0],[-1,1,["OverflowMenuViewModel","ActiveExtensions"],[_exn._TI.e,_exn._TI.bh],null,"ActiveExtensions",null,_exn._TI.bz,1,null,null,null],[-1,1,["OverflowMenuViewModel","PopulateMenuItemsCommand"],[_exn._TI.e,_exn._TI.bm],null,"PopulateMenuItemsCommand",null,_exn._TI.bC,1,null,null,null],[-1,1,["OverflowMenuViewModel","ListViewEventInfo"],[_exn._TI.e,_exn._TI.bk],_exn._TI.bn,"EventInfo",_exn._TI.Q,_exn._TI.S,2,null,null,null],[-1,0,["MarketplaceUrl"],[_exn._TI.u],null,"IsGetMoreAppHidden",null,_exn._TI.bA,1,_exn._TI.f(),null,!1]],[[-1,5,["OverflowMenuViewModel","TabSelectedExtension"],[_exn._TI.e,_exn._TI.l],null,"hidden",null,null,1,new _js.j([_exn._TI.f(),_exn._TI.d()],[null,null]),null,null]],[[-1,1,["HideExtensionContainer"],[_exn._TI.cc],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,1,["OverflowMenuViewModel","TabSelectedExtension"],[_exn._TI.e,_exn._TI.l],null,"SelectedExtension",null,_exn._TI.p,1,null,null,null],[-1,0,["OsfContextActivationManager"],[_exn._TI.m],null,"OsfContextActivationManager",null,_exn._TI.o,1,null,null,null],[-1,0,["UserCulture"],[_exn._TI.n],null,"UserCulture",null,_exn._TI.q,1,null,null,null],[-1,0,["NativeBridge"],[_exn._TI.bt],null,"NativeBridge",null,_exn._TI.bE,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_exn._TI.I],null,"IsUserInOrgMarketplaceRole",null,_exn._TI.N,1,null,null,!1],[-1,5,["DisplayInCard"],[_exn._TI.A],null,"_exn_M:_exn_L",null,null,1,null,null,null]],[[-1,0,["WindowObjectViewModel"],[_exn._TI.L],null,"DataContext",null,_exn._TI.t,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[22].cloneNode(!0);var u=new _b.I(n.children[3]);var f=new _exn.o(n.children[2],_js.a.Instance.a(_y.a));var r=new _js.c(n.children[1]);var t=new _exn.d(_B.a(n,[0,0]),_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));t.U("XExtensibilityView.ExtensionListItemTemplate");t.bq("_exn_N");t.y("XExtensibilityView.ExtensibilityViewCommon._tidc");var i=new _js.c(n.children[0]);return new _B(n,[i,t,r,f,u])},_exn.j,_exn.t,function(n){return new _exn.t(n)},!1,!1,!1,0,_exn._TI.a);var u="XExtensibilityView.ExtensionListItemTemplate._tidh";new _A(u,function(){_exn._TI.a[u]===undefined&&(_exn._TI.a[u]=[[[-1,0,["DisplayName"],[_exn._TI.w],null,"Text",null,_exn._TI.i,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[23].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_exn.i,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var t="XExtensibilityView.ExtensionListItemTemplate";new _A(t,function(){_exn._TI.a[t]===undefined&&(_exn._TI.a[t]=[[[-1,5,["IsSelected"],[_exn._TI.bL],null,"ms-font-color-themePrimary:ms-font-color-neutralSecondary ms-bg-color-white ms-font-color-themePrimary-hover",null,null,1,null,null,null],[-1,5,["TemplatedParent","TemplatedParent","DisplayInCard"],[_exn._TI.c,_exn._TI.c,_exn._TI.A],null,"_exn_M:_exn_L",null,null,1,null,null,null]]]);var i=_exn._TI._hf.childNodes[24].cloneNode(!0);var n=new _js.b(i.children[0]);n.y("XExtensibilityView.ExtensionListItemTemplate._tidh");return new _B(i,[n])},_exn.i,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_exn._TI.a);var n="XExtensibilityView";new _A(n,function(){_exn._TI.a[n]===undefined&&(_exn._TI.a[n]=[[[-1,0,["HideExtensionContainer"],[_exn._TI.H],null,"HideExtensionContainer",null,_exn._TI.bF,1,null,null,!1],[-1,0,["OverflowMenuViewModel"],[_exn._TI.K],null,"OverflowMenuViewModel",null,_exn._TI.bG,1,null,null,null]]]);var i=_exn._TI._hf.childNodes[25].cloneNode(!0);var t=new _exn.t(i.children[0]);t.y("XExtensibilityView.ExtensibilityViewCommon");return new _B(i,[t])},_exn.j,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_exn._TI.a);var r="XExtensibilityCardView.XExtensibilityCardContent";new _A(r,function(){_exn._TI.a[r]===undefined&&(_exn._TI.a[r]=[[[-1,0,["HideContextualExtensionContainer"],[_exn._TI.bs],null,"HideExtensionContainer",null,_exn._TI.bF,1,null,null,!1],[-1,0,["ContextualOverflowMenuViewModel"],[_exn._TI.V],null,"OverflowMenuViewModel",null,_exn._TI.bG,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[26].cloneNode(!0);var n=new _exn.t(t.children[0]);n.y("XExtensibilityView.ExtensibilityViewCommon");n.d(!0);return new _B(t,[n])},_exn.j,_exn.t,function(n){return new _exn.t(n)},!1,!1,!1,0,_exn._TI.a);var i="XExtensibilityCardView";new _A(i,function(){_exn._TI.a[i]===undefined&&(_exn._TI.a[i]=[[[-1,0,["LastContextualTermClickedEvent"],[_exn._TI.W],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.f(),null,!0],[-1,0,["ExtensionHeight"],[_exn._TI.br],null,"ExtensionHeight",null,_exn._TI.bw,1,null,null,0],[-1,0,["LastContextualTermClickedEvent"],[_exn._TI.W],null,"TermClickedEvent",null,_exn._TI.bx,1,null,null,null]]]);var r=_exn._TI._hf.childNodes[27].cloneNode(!0);var t=new _exn.q(r.children[0]);t.T(!0);var n=new _b.T(_js.a.Instance.a(_b.o),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));n.A(_E.a(["ReadExtensibilityPeekViewModel"],[_exn._TI.bX],null,"PeekDataContext",null,_exn._TI.cl,1)).A(_E.a(["ShowContextualCard"],[_exn._TI.bv],null,"IsShown",null,_exn._TI.cn,1,null,null,!1)).A(_E.a(["AnchorElement"],[_exn._TI.bW],null,"AnchorElement",null,_exn._TI.ci,1)).A(_E.b(1,null,null,null,"PeekVerticalAlign",null,_exn._TI.cm,0,null,null,0)).A(_E.b(3,null,null,null,"NotchVerticalAlign",null,_exn._TI.ck,0,null,null,0)).D(_E.a(["DataContext"],[_exn._TI.ch],null,"ContentDataContext",null,_exn._TI.cj,1));n.h(2);n.j(150);n.f("XExtensibilityCardView.XExtensibilityCardContent");t.G([n]);return new _B(r,[t])},_exn.j,_js.b,function(n){return new _js.b(n)},!1,!1,!0,0,_exn._TI.a);var p="XComposeExtensibilityView._tidj._tidk";new _A(p,function(){_exn._TI.a[p]===undefined&&(_exn._TI.a[p]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.g()]]]);var n=_exn._TI._hf.childNodes[28].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_exn.n,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var y="XComposeExtensibilityView._tidj";new _A(y,function(){_exn._TI.a[y]===undefined&&(_exn._TI.a[y]=[null,[[-1,4,null,null,null,"Text",null,_exn._TI.i,0,null,null,null,_u.S.Y]]]);var n=_exn._TI._hf.childNodes[29].cloneNode(!0);var i=new _b.V(_B.a(n,[0,1]));var t=new _js.b(_B.a(n,[0,0]));t.y("XComposeExtensibilityView._tidj._tidk");return new _B(n,[t,i])},_exn.n,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_exn._TI.a);var b="XComposeExtensibilityView._tidl";new _A(b,function(){_exn._TI.a[b]===undefined&&(_exn._TI.a[b]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.a()]]]);var n=_exn._TI._hf.childNodes[30].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_exn.n,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var w="XComposeExtensibilityView._tidm._tidn";new _A(w,function(){_exn._TI.a[w]===undefined&&(_exn._TI.a[w]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.d()]],[[-1,4,null,null,null,"Text",null,_exn._TI.i,0,null,null,null,_u.S.D]]]);var n=_exn._TI._hf.childNodes[31].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_exn.n,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_exn._TI.a);var v="XComposeExtensibilityView._tidm";new _A(v,function(){_exn._TI.a[v]===undefined&&(_exn._TI.a[v]=[null,[[-1,4,null,null,null,"AriaLabel",null,_exn._TI.O,0,null,null,null,_u.S.A],[-1,4,null,null,null,"AriaRole",null,_exn._TI.x,0,null,null,0,7],[-1,0,["MarketplaceUrl"],[_exn._TI.u],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.f(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_exn._TI.J],null,"ClickCommand",null,_exn._TI.j,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[32].cloneNode(!0);var n=new _fc.b(t.children[2]);n.C(-1);n.y("XComposeExtensibilityView._tidm._tidn");var i=new _fce.c(t.children[0]);return new _B(t,[i,n]).R({ListPanel:i,GetMoreAppsButton:n})},_exn.n,_exn.s,function(n){return new _exn.s(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_exn._TI.a);var c="XComposeExtensibilityView.XComposeExtensionListItemTemplate._tido";new _A(c,function(){_exn._TI.a[c]===undefined&&(_exn._TI.a[c]=[null,[[-1,0,["DisplayName"],[_exn._TI.w],null,"Text",null,_exn._TI.i,1,null,null,null]],[[-1,0,["ProviderName"],[_exn._TI.bu],null,"Text",null,_exn._TI.i,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[33].cloneNode(!0);var i=new _b.V(_B.a(n,[1,1]));var r=new _b.V(_B.a(n,[1,0]));var t=new _js.b(n.children[0]);t.y("XComposeExtensibilityView.ExtensionIconImage");return new _B(n,[t,r,i])},_exn.i,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_exn._TI.a);var h="XComposeExtensibilityView.XComposeExtensionListItemTemplate";new _A(h,function(){_exn._TI.a[h]===undefined&&(_exn._TI.a[h]=[[[-1,0,["DisplayName"],[_exn._TI.w],null,"AriaLabel",null,_exn._TI.bM,1,null,null,null]]]);var t=_exn._TI._hf.childNodes[34].cloneNode(!0);var n=new _js.b(t.children[0]);n.y("XComposeExtensibilityView.XComposeExtensionListItemTemplate._tido");return new _B(t,[n])},_exn.i,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_exn._TI.a);var a="XComposeExtensibilityView.ExtensionIconImage";new _A(a,function(){_exn._TI.a[a]===undefined&&(_exn._TI.a[a]=[[[-1,4,null,null,null,"Id",null,_exn._TI.s,0,null,null,null,_exn.k.c()],[-1,0,["IconUrl"],[_exn._TI.M],null,"IsHidden",null,_exn._TI.b,1,new _js.j([_exn._TI.f(),_exn._TI.d()],[null,null]),null,!0]],[[-1,0,["IconUrl"],[_exn._TI.M],null,"Source",null,_exn._TI.ba,1,null,null,null],[-1,0,["IconUrl"],[_exn._TI.M],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.f(),null,!0]]]);var n=_exn._TI._hf.childNodes[35].cloneNode(!0);var i=new _exn.H(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_exn.i,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_exn._TI.a);var l="XComposeExtensibilityView";new _A(l,function(){_exn._TI.a[l]===undefined&&(_exn._TI.a[l]=[[[-1,5,["SelectedExtension"],[_exn._TI.v],null,"_exn_o1",null,null,0,_exn._TI.E(),null,null],[-1,5,["IsLandscape"],[_exn._TI.k],null,"landscape",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_exn._TI.x,0,null,null,0,3],[-1,4,null,null,null,"ImageId",null,_exn._TI.r,0,null,null,null,_n.a.a()],[-1,4,null,null,null,"HoveredImageId",null,_exn._TI.P,0,null,null,null,_n.a.b()],[-1,4,null,null,null,"PressedImageId",null,_exn._TI.Y,0,null,null,null,_n.a.I()],[-1,4,null,null,null,"Title",null,_exn._TI.bb,0,null,null,null,_u.S.C],[-1,4,null,null,null,"Text",null,_exn._TI.Z,0,null,null,null,_u.S.E],[-1,0,["IsTouchNarrow"],[_exn._TI.U],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,0,["HideAppPaneCommand"],[_exn._TI.be],null,"ClickCommand",null,_exn._TI.j,1,null,null,null],[-1,5,["IsLandscape"],[_exn._TI.k],null,"portrait",null,null,0,_exn._TI.d(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_exn._TI.x,0,null,null,0,3],[-1,0,["HideExtensionsList"],[_exn._TI.y],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0],[-1,0,["BackToListCommand"],[_exn._TI.T],null,"ClickCommand",null,_exn._TI.j,1,null,null,null]],[[-1,0,["HideExtensionsList"],[_exn._TI.y],null,"IsHidden",null,_exn._TI.b,1,null,null,!0]],[[-1,0,["IconUrl"],[_exn._TI.bS],null,"Source",null,_exn._TI.ba,1,null,null,null],[-1,0,["HideExtensionsList"],[_exn._TI.y],null,"IsHidden",null,_exn._TI.b,1,_exn._TI.d(),null,!0]],[[-1,0,["AppPaneTitle"],[_exn._TI.bd],null,"Text",null,_exn._TI.i,1,null,null,null]],[[-1,0,["HideExtensionsList"],[_exn._TI.y],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,0,["ActiveExtensions"],[_exn._TI.bq],null,"DataSource",null,_exn._TI.R,1,null,null,null],[-1,0,["ListViewEventInfo"],[_exn._TI.bf],_exn._TI.bg,"EventInfo",_exn._TI.Q,_exn._TI.S,2,null,null,null]],[[-1,0,["OsfContextActivationManager"],[_exn._TI.m],null,"OsfContextActivationManager",null,_exn._TI.o,1,null,null,null],[-1,0,["HideExtensionContainer"],[_exn._TI.H],null,"IsHidden",null,_exn._TI.b,1,null,null,!0],[-1,0,["UserCulture"],[_exn._TI.n],null,"UserCulture",null,_exn._TI.q,1,null,null,null],[-1,0,["SelectedExtension"],[_exn._TI.v],null,"SelectedExtension",null,_exn._TI.p,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_exn._TI.I],null,"IsUserInOrgMarketplaceRole",null,_exn._TI.N,1,null,null,!1],[-1,5,["IsLandscape"],[_exn._TI.k],null,"isPortrait",null,null,0,_exn._TI.d(),null,null]],[[-1,0,["WindowObjectViewModel"],[_exn._TI.L],null,"DataContext",null,_exn._TI.t,1,null,null,null]]]);var n=_exn._TI._hf.childNodes[36].cloneNode(!0);var o=new _b.I(_B.a(n,[0,3]));var f=new _exn.o(_B.a(n,[0,2]),_js.a.Instance.a(_y.a));f.f=!0;var t=new _exn.s(_B.a(n,[0,1,0]),_js.a.Instance.a(_y.a));t.U("XComposeExtensibilityView.XComposeExtensionListItemTemplate");t.bq("menuListViewItem");t.y("XComposeExtensibilityView._tidm");var s=new _b.V(_B.a(n,[0,0,0,2,2]));var h=new _exn.H(_B.a(n,[0,0,0,2,1]));var u=new _js.b(_B.a(n,[0,0,0,2,0]));u.y("XComposeExtensibilityView._tidl");var r=new _fc.b(_B.a(n,[0,0,0,1,0]));r.y("XComposeExtensibilityView._tidj");var i=new _fc.b(_B.a(n,[0,0,0,0,0]));i.C(0);i.f("ms-font-m ms-font-weight-regular");var e=new _js.c(_B.a(n,[0,0]));return new _B(n,[e,i,r,u,h,s,t,f,o]).R({CloseButton:i,AppsBackButton:r,ComposeExtMenuListView:t})},_exn.n,_exn.x,function(n){return new _exn.x(n)},!1,!1,!1,0,_exn._TI.a)};_exn._TI.bN=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div autoid=\"_exn_0\" class='_exn_2 _exn_3'></div> <div autoid=\"_exn_1\" class='_exn_2 _exn_4'></div> </div><div> <div autoid=\"_exn_2\" class='_exn_5'></div>  <div autoid=\"_exn_3\" class='_exn_5'></div> </div><div> <div></div> <div class='_exn_m'> <button autoid=\"_exn_9\" type='button' class='_exn_n ms-font-weight-regular'></button> </div> </div><div> <div class='_exn_9'></div> <div autoid=\"_exn_b\" class='_exn_k ms-fwt-sb _exn_6'></div> <div autoid=\"_exn_c\" class='_exn_l ms-font-weight-regular _exn_6'></div> <div style=\"clear:both;\"></div> </div><div> <div autoid=\"_exn_a\" class='_exn_j'></div> </div><div> <span class='_exn_a'></span> <img autoid=\"_exn_d\" class='_exn_b'/> </div><div> <div class='_exn_f'> <div class='_exn_h'> <button autoid=\"_exn_4\" type='button' class='_exn_g'></button>  <button autoid=\"_exn_5\" type='button' class='_exn_7'></button>  <button autoid=\"_exn_6\" type='button' class='_exn_8'></button> <div autoid=\"_exn_7\" class='_exn_i ms-fwt-sl _exn_6'></div> <div style=\"clear:both;\"></div> </div> <div class='_exn_c'> <div autoid=\"_exn_8\" class='_exn_o'></div> </div> <div class='_exn_d'></div> <div class='hidden'> </div> </div>   </div><div> <div class='_exn_u ms-border-color-themeSecondary'></div> <div class='_exn_v ms-bg-color-white'></div> </div><div> <div autoid=\"_exn_e\"></div> </div><div> <div></div> <div></div> </div><div> <div class='_exn_w ms-border-color-themeSecondary'></div>  <div class='_exn_w ms-border-color-themeSecondary'></div> </div><div> <button autoid=\"_exn_h\" type='button' class='_exn_F ms-fwt-r ms-font-s ms-font-color-black-hover'></button> <div class='_exn_B'></div> <button type='button' class='_exn_E ms-font-s ms-font-color-themePrimary'></button> </div><div> <div class='_exn_C ms-bg-color-neutralLight'> <div autoid=\"_exn_g\"></div> </div> <div class='_exn_D ms-border-color-themePrimary'></div> <div class='hidden'> </div> </div><div> <span autoid=\"_exn_j\"></span> </div><div> <div autoid=\"_exn_i\" class='_exn_y ms-font-s ms-font-color-themePrimary'></div> </div><div> <div autoid=\"_exn_f\" class='_exn_x'></div>    </div><div>  <div autoid=\"_exn_k\" class='_exn_I'></div> </div><div> <div class='_exn_H ms-border-color-themePrimary'></div> </div><div> <div></div> </div><div> <span class='_exn_S ms-font-color-neutralTertiaryAlt ms-border-color-neutralLight'></span> <div class='_exn_T ms-font-color-neutralTertiaryAlt ms-border-color-neutralLight'></div> </div><div> <span></span> </div><div> <div class='inlineBlock'> <div></div> </div> <button autoid=\"_exn_n\" type='button' class='_exn_U'></button> <div class='_exn_N'></div> <button type='button' class='_exn_R ms-font-color-themeSecondary ms-bg-color-neutralLight-hover'></button> </div><div> <div class='_exn_O ms-bg-color-white'> <div autoid=\"_exn_m\" class='_exn_W'></div> </div> <div aria-hidden=\"true\" class='_exn_P ms-font-color-neutralTertiaryAlt'></div> <div class='_exn_Q ms-border-color-neutralTertiaryAlt ms-bg-color-white'></div> <div class='hidden'> </div> </div><div> <span autoid=\"_exn_p\"></span> </div><div> <div autoid=\"_exn_o\" class='_exn_K ms-font-m ms-font-weight-regular'></div> </div><div> <div autoid=\"_exn_l\" class='_exn_J'></div>    </div><div> <div autoid=\"_exn_q\" class='_exn_X'></div> </div><div> <div></div>  </div><div> <span class='_exn_k1 ms-font-color-neutralSecondary'></span> </div><div> <div class='_exn_l1'> <div></div> <div autoid=\"_exn_t\" class='_exn_m1 ms-font-color-neutralSecondary'></div> </div> </div><div> <span class='_exn_a1 ms-font-color-neutralSecondary'></span> </div><div> <span class='ms-font-color-neutralSecondary _exn_e1'></span> <span autoid=\"_exn_y\" class='_exn_g1 ms-font-color-neutralecondary ms-font-m'></span> </div><div> <div></div> <div aria-hidden=\"true\" class='_exn_f1 ms-border-color-neutralTertiaryAlt'></div> <button autoid=\"_exn_x\" type='button' class='_exn_Y ms-border-color-neutralTertiaryAlt _exn_d1'></button> </div><div> <div class='_exn_21'></div> <div class='_exn_31'> <div autoid=\"_exn_A\" class='_exn_n1 ms-font-m ms-font-color-neutralPrimary ms-font-weight-regular _exn_Z'></div> <div autoid=\"_exn_B\" class='composeAppProvider ms-font-s ms-font-color-neutralPrimary _exn_Z'></div> </div> </div><div> <div autoid=\"_exn_z\" class='_exn_c1 ms-bg-color-themeLighterAlt-hover'></div> </div><div> <span class='_exn_01'></span> <img autoid=\"_exn_C\" class='_exn_11'/> </div><div> <div class='_exn_61  ms-bg-color-white'> <div class='_exn_81'> <div class='_exn_i1 _exn_Y'> <div class='closeBar'> <button autoid=\"_exn_r\" type='button' class='_exn_71 ms-font-color-neutralSecondary'></button> </div> <div class='backButtonBar _exn_Y'> <button autoid=\"_exn_s\" type='button' class='backButton'></button> </div> <div class='titleBar _exn_Y'> <div></div> <img autoid=\"_exn_u\" class='_exn_b1'/> <div autoid=\"_exn_v\" class='_exn_91 ms-font-color-neutralPrimary ms-font-xl _exn_Z'></div> </div> </div> </div> <div class='_exn_41'> <div autoid=\"_exn_w\" class='_exn_h1'></div> </div> <div class='_exn_51'></div> <div class='hidden'> </div> </div>   </div>";_js.c.a().appendChild(n);return n};_exn._TI.bT=function(n){return n.bb};_exn._TI.bU=function(n){return n.bc};_exn._TI.bc=function(n){return n.d};_exn._TI.bP=function(n){return n.c()};_exn._TI.bQ=function(n){return n.d()};_exn._TI.u=function(n){return n.Y};_exn._TI.J=function(n){return n.bP};_exn._TI.w=function(n){return n.d.DisplayName};_exn._TI.bu=function(n){return n.d.ProviderName};_exn._TI.M=function(n){return n.p()};_exn._TI.v=function(n){return n.J};_exn._TI.k=function(n){return n.H.a===1};_exn._TI.U=function(n){return n.cw()};_exn._TI.be=function(n){return n.bG};_exn._TI.T=function(n){return n.bF};_exn._TI.bd=function(n){return n.bl};_exn._TI.y=function(n){return n.bo};_exn._TI.bq=function(n){return n.F};_exn._TI.bf=function(n){return n.bq};_exn._TI.Q=function(n){return n.dt()};_exn._TI.m=function(n){return _exn.c.isInstanceOfType(n)?n.W:null};_exn._TI.H=function(n){return n.bx};_exn._TI.n=function(n){return _exn.c.isInstanceOfType(n)?n.P:null};_exn._TI.I=function(n){return n.cL()};_exn._TI.L=function(n){return n.bC};_exn._TI.g=function(n){return n.a};_exn._TI.K=function(n){return _exn.c.isInstanceOfType(n)?n.G:null};_exn._TI.l=function(n){return n.f};_exn._TI.bV=function(n){return n.o};_exn._TI.V=function(n){return _exn.c.isInstanceOfType(n)?n.D:null};_exn._TI.G=function(n){return n.g};_exn._TI.bR=function(n){return n.f()};_exn._TI.c=function(n){return n.L};_exn._TI.z=function(n){return n.a};_exn._TI.h=function(n){return n.c};_exn._TI.F=function(n){return n.h};_exn._TI.bi=function(n){return n.e};_exn._TI.bj=function(n){return n.b};_exn._TI.bJ=function(n){return n.bd()};_exn._TI.bl=function(n){return n.g};_exn._TI.by=function(n){return n.j};_exn._TI.bh=function(n){return n.a};_exn._TI.bm=function(n){return n.j};_exn._TI.bk=function(n){return n.i};_exn._TI.bt=function(n){return n.C};_exn._TI.cb=function(n){return n.b};_exn._TI.bL=function(n){return n.f()};_exn._TI.bs=function(n){return n.bw};_exn._TI.bv=function(n){return n.T};_exn._TI.cd=function(n){return n.b()};_exn._TI.bZ=function(n){return _exn.q.isInstanceOfType(n)?n.a:null};_exn._TI.ca=function(n){return _exn.q.isInstanceOfType(n)?n.b:null};_exn._TI.br=function(n){return n.bv};_exn._TI.W=function(n){return n.z};_exn._TI.A=function(n){return n.a};_exn._TI.e=function(n){return n.c};_exn._TI.cc=function(n){return n.b};_exn._TI.bX=function(n){return n.bj};_exn._TI.bW=function(n){return n.bc};_exn._TI.ch=function(n){return n.E()};_exn._TI.bS=function(n){return n.bp};_exn._TI.b=function(n,t){n.M(t)};_exn._TI.t=function(n,t){n.ba(t)};_exn._TI.j=function(n,t){n.be(t)};_exn._TI.O=function(n,t){n.bb(t)};_exn._TI.x=function(n,t){n.I(t)};_exn._TI.Z=function(n,t){n.g(t)};_exn._TI.i=function(n,t){n.a(t)};_exn._TI.bM=function(n,t){n.bb(t)};_exn._TI.s=function(n,t){n.a(t)};_exn._TI.ba=function(n,t){n.a(t)};_exn._TI.r=function(n,t){n.i(t)};_exn._TI.P=function(n,t){n.j(t)};_exn._TI.Y=function(n,t){n.q(t)};_exn._TI.bb=function(n,t){n.by(t)};_exn._TI.R=function(n,t){n.br(t)};_exn._TI.bg=function(n,t){n.cE(t)};_exn._TI.S=function(n,t){n.cz(t)};_exn._TI.o=function(n,t){n.l(t)};_exn._TI.q=function(n,t){n.n(t)};_exn._TI.p=function(n,t){n.m(t)};_exn._TI.N=function(n,t){n.g=t};_exn._TI.bO=function(n,t){n.a(t)};_exn._TI.X=function(n,t){n.f(t)};_exn._TI.bI=function(n,t){n.d(t)};_exn._TI.bH=function(n,t){n.e(t)};_exn._TI.bA=function(n,t){n.s=t};_exn._TI.bp=function(n,t){n.k(t)};_exn._TI.bK=function(n,t){n.bf(t)};_exn._TI.bo=function(n,t){n.g=t};_exn._TI.bB=function(n,t){n.m(t)};_exn._TI.bz=function(n,t){n.cs(t)};_exn._TI.bC=function(n,t){n.cH(t)};_exn._TI.bn=function(n,t){n.B(t)};_exn._TI.bE=function(n,t){n.d=t};_exn._TI.bD=function(n,t){n.d(t)};_exn._TI.bY=function(n,t){n.bl(t)};_exn._TI.ce=function(n,t){n.a(t)};_exn._TI.cf=function(n,t){n.a(t)};_exn._TI.cg=function(n,t){n.b(t)};_exn._TI.bw=function(n,t){n.c=t};_exn._TI.bx=function(n,t){n.h(t)};_exn._TI.bF=function(n,t){n.e(t)};_exn._TI.bG=function(n,t){n.f(t)};_exn._TI.cl=function(n,t){n.m(t)};_exn._TI.cn=function(n,t){n.a(t)};_exn._TI.ci=function(n,t){n.d(t)};_exn._TI.cm=function(n,t){n.M=t};_exn._TI.ck=function(n,t){n.K=t};_exn._TI.cj=function(n,t){n.by(t)};_exn._TI.d=function(){_exn._TI.B||(_exn._TI.B=new _fc.k);return _exn._TI.B};_exn._TI.f=function(){_exn._TI.C||(_exn._TI.C=new _fc.n);return _exn._TI.C};_exn._TI.E=function(){_exn._TI.D||(_exn._TI.D=new _fc.m);return _exn._TI.D};ExtensibilityNextComponent.registerClass("ExtensibilityNextComponent",null,_a.iR);_exn.P.registerClass("_exn.P",_h.dY.$$(_g.uK));_exn.Q.registerClass("_exn.Q",_h.dk.$$(_g.vi,_g.EQ));_exn.I.registerClass("_exn.I",_h.dk.$$(_g.hp,_g.kG));_exn.g.registerClass("_exn.g",_h.dY.$$(_g.jD));_exn.A.registerClass("_exn.A",_h.dk.$$(_g.vi,_g.EQ));_exn.J.registerClass("_exn.J",_h.dY.$$(_g.ww));_exn.R.registerClass("_exn.R",_h.dY.$$(_g.wY));_exn.S.registerClass("_exn.S",_h.dY.$$(String));_exn.T.registerClass("_exn.T",_h.dY.$$(_g.xl));_exn.U.registerClass("_exn.U",_h.dY.$$(_g.xm));_exn.m.registerClass("_exn.m");_exn.m.c.registerClass("_exn.m.c");_exn.bf.registerClass("_exn.bf",_a.ca);_exn.C.registerClass("_exn.C");_exn.bJ.registerClass("_exn.bJ");_exn.V.registerClass("_exn.V",_exn.bJ);_exn.W.registerClass("_exn.W",_exn.V);_exn.X.registerClass("_exn.X",_exn.V);_exn.K.registerClass("_exn.K",_exn.bJ);_exn.bN.registerClass("_exn.bN",_exn.bJ);_exn.Y.registerClass("_exn.Y",_exn.bN);_exn.Z.registerClass("_exn.Z",_exn.bN);_exn.ba.registerClass("_exn.ba",_exn.bJ);_exn.b.registerClass("_exn.b");_exn.bL.registerClass("_exn.bL",_exn.b);_exn.bc.registerClass("_exn.bc",_exn.bL);_exn.h.registerClass("_exn.h",_exn.b);_exn.bd.registerClass("_exn.bd",_exn.h);_exn.D.registerClass("_exn.D");_exn.bh.registerClass("_exn.bh",_exn.bL);_exn.bi.registerClass("_exn.bi",_exn.h);_exn.bj.registerClass("_exn.bj");_exn.bo.registerClass("_exn.bo",_exn.bJ);_exn.bp.registerClass("_exn.bp",_exn.bJ);_exn.bq.registerClass("_exn.bq",_exn.bJ);_exn.N.registerClass("_exn.N",_exn.bJ);_exn.bs.registerClass("_exn.bs",_exn.bJ);_exn.br.registerClass("_exn.br",_exn.bJ);_exn.bt.registerClass("_exn.bt",_exn.bJ);_exn.bv.registerClass("_exn.bv",_exn.bJ);_exn.bx.registerClass("_exn.bx",_exn.bJ);_exn.by.registerClass("_exn.by",_exn.bJ);_exn.G.registerClass("_exn.G",_exn.bJ);_exn.bA.registerClass("_exn.bA",_exn.bJ);_exn.bB.registerClass("_exn.bB",_exn.bN);_exn.bC.registerClass("_exn.bC",_exn.bJ);_exn.bE.registerClass("_exn.bE",_exn.bJ);_exn.bD.registerClass("_exn.bD",_exn.bN);_exn.bF.registerClass("_exn.bF",_exn.bJ);_exn.bG.registerClass("_exn.bG",null,_y.cm,_a.fO);_exn.L.registerClass("_exn.L",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable,_y.cC);_exn.c.registerClass("_exn.c",_a.by);_exn.n.registerClass("_exn.n",_exn.c,_y.fE,_a.jO,_js.z,Sys.IDisposable);_exn.O.registerClass("_exn.O");_exn.p.registerClass("_exn.p",_a.by);_exn.u.registerClass("_exn.u",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable,_y.cC);_exn.E.registerClass("_exn.E");_exn.bk.registerClass("_exn.bk",null,IExtensibilityStatistics);_exn.bk.a.registerClass("_exn.bk.a");_exn.bk.c.registerClass("_exn.bk.c");_exn.bk.b.registerClass("_exn.bk.b");_exn.bk.d.registerClass("_exn.bk.d");_exn.bl.registerClass("_exn.bl",null,_y.gi);_exn.j.registerClass("_exn.j",_exn.c,_y.bE,_a.jO,_js.z,Sys.IDisposable);_exn.bw.registerClass("_exn.bw",_a.by,_y.fF,_a.jO,_js.z,Sys.IDisposable);_exn.bn.registerClass("_exn.bn",_a.ca);_exn.F.registerClass("_exn.F",_js.u);_exn.i.registerClass("_exn.i",_a.by,_y.gV);_exn.bz.registerClass("_exn.bz",_exn.bl);_exn.B.registerClass("_exn.B");_exn.bb.registerClass("_exn.bb",_exn.B);_exn.bu.registerClass("_exn.bu",_exn.B);_exn.f.registerClass("_exn.f",_exn.B);_exn.v.registerClass("_exn.v",_exn.B);_exn.w.registerClass("_exn.w",_exn.B);_exn.r.registerClass("_exn.r");_exn.bH.registerClass("_exn.bH",_js.c);_exn.s.registerClass("_exn.s",_fce.b);_exn.x.registerClass("_exn.x",_js.b);_exn.q.registerClass("_exn.q",_js.b);_exn.H.registerClass("_exn.H",_b.W);_exn.d.registerClass("_exn.d",_fce.b);_exn.y.registerClass("_exn.y",_js.b);_exn.o.registerClass("_exn.o",_js.c);_exn.t.registerClass("_exn.t",_js.b);_exn.bI.registerClass("_exn.bI",_js.b);_exn._TI.registerClass("_exn._TI");ExtensibilityNextComponent.$$cctor();_exn.g.a=null;_exn.g.b=0;_exn.m.b=null;_exn.l.b=null;_exn.l.a=null;_exn.b.a={wasSuccessful:!1};_exn.b.b=new RegExp(" ","g");_exn.b.c=null;_exn.b.d=null;_exn.b.f=null;_exn.b.e=null;_exn.G.a={wasSuccessful:!0};_exn.z.a={};_exn.p.b="HideExtensionContextMenu";_exn.p.a="TabSelectedExtension";_exn.c.c=!1;_exn.c.a=null;_exn.i.a=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_exn.d.b=0;_exn.d.c={};_exn.d.a=null;_exn.o.a=0;_exn._TI._hf=_exn._TI.bN();_exn._TI.B=null;_exn._TI.C=null;_exn._TI.D=null;_exn._TI.a={};_exn._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.extensibilitynext.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.extensibilitynext.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
