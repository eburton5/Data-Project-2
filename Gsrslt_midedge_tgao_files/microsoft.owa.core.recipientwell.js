try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.recipientwell.js'] = (new Date()).getTime();
function RecipientWellComponent(){}RecipientWellComponent.$$cctor=function(){_a.p.a().a(RecipientWellComponent)};RecipientWellComponent.prototype={a:function(n,t,i){var f=this;n.b(_rw.d,function(){return new _rw.d(window.document.createElement("div"),n.a(_y.a))});var e=this;n.b(_rw.h,function(){return new _rw.h(n.a(_y.a),n.a(_pe.h))}).a();var r=this;n.b(_rw.g,function(){return new _rw.g(n.a(_y.a),n.a(IBasePersonaViewModelFactory),n.c(IFindRecipientMailComposeViewModelFactory),n.a(_a.h))}).b(IRecipientWellViewModelFactory).a();var u=this;n.b(_rw.j,function(){return new _rw.j(window.document.createElement("div"),n.a(_y.a),n.a(_ff.c),n.a(_a.h))})},b:function(){return[]}};Type.registerNamespace("_rw");_rw.h=function(n,t){this.d=n;this.c=t};_rw.h.prototype={d:null,c:null,a:function(n,t,i,r,u,f,e,o,s,h){return new _rw.a(this.d.a(),n,t,i,r,u,f,this.c,e,o,s,h)},g:function(n){return new _rw.a(this.d.a(),3,n,null,4,!1,!1,this.c)}};_rw.b=function(n,t,i,r,u,f,e,o,s){this.cr=Function.createDelegate(this,this.dd);this.bK=Function.createDelegate(this,this.cW);this.cp=Function.createDelegate(this,this.cY);this.cs=Function.createDelegate(this,this.dj);this.cq=Function.createDelegate(this,this.dc);this.bN=Function.createDelegate(this,this.df);this.bM=Function.createDelegate(this,this.de);this.bP=Function.createDelegate(this,this.di);this.bL=Function.createDelegate(this,this.da);this.Y=Function.createDelegate(this,this.dh);this.bO=Function.createDelegate(this,this.dg);this.z=-1;_rw.b.initializeBase(this,[n,t,i,r,1,u,!1,f]);_a.b.b(e,"findRecipientMailComposeViewModelFactoryAsyncLazy");this.bS=e;this.bc=o;this.bR=s};_rw.b.b=function(n){var t=n.i.d();!_js.d.b(t)&&t.endsWith(";")&&(t=t.substr(0,t.length-1));return t};_rw.b.e=function(n,t){t.val=!1;if(_js.d.b(n))return null;var i="";var s="";var v="SMTP";var r=n.indexOf("[");var e=n.lastIndexOf("]");var o=n.indexOf(":");if(r>=0&&e>=0&&o>=0&&o>r&&o<e){s=n.substring(0,r);v=n.substring(r+1,o);i=n.substring(o+1,e).trim();if(_js.d.b(i))return null;t.val=!0}else{var a=n.indexOf("<");var p=n.indexOf(">");var y=n.indexOf("(");var l=n.indexOf(")");if(r>=0&&e>=0&&e>r||a>=0&&p>=0&&p>a||y>=0&&l>=0&&l>y){var f=n.match(_rw.b.f);if(f&&f.length>0){if(!_js.d.b(f[0])){var c=n.indexOf(f[0]);if(c!==-1){i=f[0];var b=i.replace(_rw.b.g,"\\$1");var k=new RegExp(String.format("\\(\\s*{0}\\s*\\)|\\<\\s*{0}\\s*\\>|\\[\\s*{0}\\s*\\]",b));var h=n.match(k);h&&h.length>0&&!_js.d.b(h[0])&&(c=n.indexOf(h[0]));s=n.substring(0,c).trimEnd()}}}else i=n}else i=n;if(_js.d.b(i))return null;i=i.trim();t.val=_a.D.a(i)}var u=new _g.d;u.MailboxType="OneOff";u.RoutingType=v.trim();u.EmailAddress=i;u.Name=_js.d.b(s)?i:s.trim();return _pc.a.b(u)};_rw.b.prototype={bS:null,bj:null,A:null,I:!1,M:null,E:null,bW:null,bX:null,H:!1,bv:!1,bw:!1,br:!1,bp:!1,bs:!1,bR:!1,N:!1,P:null,bc:null,bi:0,bQ:function(n){this.dV("BulkResolveOperationComplete",n)},bY:function(n){this.dW("BulkResolveOperationComplete",n)},cU:function(n){this.dV(_rw.b.c,n)},dk:function(n){this.dW(_rw.b.c,n)},F:function(n){if(this.A!==n){!this.A||this.z!==-1||this.v().i(this.bO);this.A=n;!this.A||this.z!==-1||this.v().p(this.bO);this.dQ("RecipientBeingEdited")}return n},v:function(){if(!this.M){var n=this;this.bS.a(function(t){n.dm(t)})}return this.M},dl:function(n){if(this.M!==n){this.M=n;this.dQ("FindRecipientViewModel")}return n},cy:function(n){if(this.I!==n){this.I=n;this.dQ("IsAnyRecipientInvalid")}return n},J:function(n){if(this.bj!==n){this.bj=n;this.dQ("TextBeingEdited")}return n},bt:function(n){if(this.H!==n){this.H=n;this.cZ(n);this.dQ("DisableActionsOnAllRecipients")}return n},cA:function(n){if(this.bv!==n){this.bv=n;this.dQ("ShouldShowHiddenRecipient")}return n},cB:function(n){if(this.bw!==n){this.bw=n;this.dQ("UpdateFindControlPopupPosition")}return n},cz:function(n){if(this.br!==n){this.br=n;this.dQ("ResetFindControlPopupPosition")}return n},cx:function(n){if(this.bp!==n){this.bp=n;this.dQ("HandleBackspaceCommandAtEndOfReadWriteWell")}return n},bu:function(n){if(this.bs!==n){this.bs=n;this.dQ("ResizeFindControl")}return n},db:function(){return _a.UserAgent.getInstance().E},bo:function(){return!!this.bc&&this.bc.a().R().Enabled},cu:function(){return!!this.bc&&this.bc.a().d().Enabled},Z:null,bh:function(){this.bT()},dp:function(){this.v()&&this.v().l(!1)},bU:function(){this.bT();this.N=!0;if(this.cu()||!this.I||OwaApplication.b){this.dZ("BulkResolveOperationComplete",!0);this.N=!1}else{this.E=new _js.f;this.v().br(new _js.f);for(var i=0,r=this.t.x.length;i<r;i++){var n=this.t.x[i];if(!n.k){this.E.a(n);var t=_rw.b.b(n);this.v().be().a(t);if(!(this.z!==-1)){this.v().bf(t);this.bt(!0);this.v().c(null);this.cw(n);this.J(t);this.F(n);this.v().p(this.Y)}}}}},bE:function(){_rw.a.prototype.bE.call(this);this.M&&this.M.b(null)},bb:function(){if(this.z!==-1){this.z=-1;this.v().D();this.bt(!1);this.v().i(this.Y);this.v().c(this.P);if(this.v().a()===this.bj)this.cA(!0);else{var n=this.v().a();_js.d.a(n)||this.bx(n)}this.J("");this.F(null);this.cA(!1);if(this.N){this.dZ("BulkResolveOperationComplete",!1);this.N=!1}}},bV:function(n){if(this.t)for(var t=0;t<this.t.x.length;t++){var i=this.t.x[t];if(i.j&&i.j.a().EmailAddress===n.EmailAddress)return!0}return!1},ba:function(n){return this.by(n)},by:function(n){var i;var u;var t=!1;if(this.ck){var o=n.EmailAddress;var r=n.Name;if(_js.d.a(o))if(_js.d.a(r))throw Error.argumentNull("Address and Name parameters are set to null in emailAddress");else if(n.RoutingType!=="MAPIPDL"){var e,f;i=(f=_rw.b.e(r,e={val:t}),t=e.val,f)}else{t=!0;i=_pc.a.b(n);_js.Trace.logInfo(_rw.b.a,"AddRecipientGivenEmail: Creating PDL with name: {0}",r)}else{t=_g.o.d(n)?!0:_a.D.a(o);i=_pc.a.b(n)}}else{t=!0;i=_pc.a.b(n)}u=this.G(i);this.C(u,this.B,t);this.cy(!!(this.I|!t));return u},bA:function(n){n.bf(this.bL);_rw.a.prototype.bA.call(this,n)},dT:function(){this.v().j(this.bP);this.v().bh(this.bM);this.v().bi(this.bN);this.F(null);this.z!==-1&&this.v().i(this.Y);_rw.a.prototype.dT.call(this)},dc:function(){if(this.t.x.length>0){this.cx(!0);this.cx(!1)}},cY:function(){var n=this.t.x.length;if(n>0){var t=this.t.x[n-1];this.S(t);this.v().E(!0)}},di:function(n,t){var i=this.v().h();if(i){this.cV();this.A||this.bq()}},cW:function(){this.z!==-1?this.bx(this.v().a()):this.v().iO()||this.cv();_pc.b.b(2,-1,-1,-1,4,1);this.A||this.bq()},cI:function(n,t){var i=n;if(i.o){this.v().c(null);this.J(_rw.b.b(i));this.F(i)}},cj:function(n){if(n.i()===1||n.i()===2){_rw.a.b(n,!0,0);n.e(0,n.d(),0)}},R:function(n,t,i){this.bo()&&(t|=8);return _rw.a.prototype.R.call(this,n,t,i)},cf:function(){this.bo()?this.y&&!this.y.c()&&this.y.h(!0):_rw.a.prototype.cf.call(this)},cg:function(n,t){_rw.a.prototype.cg.call(this,n,t);this.dr()},be:function(n,t){n.Q(this.bL);_rw.a.prototype.be.call(this,n,t)},C:function(n,t,i){if(!n)throw Error.argument("personaViewModel");if($a(n.a()))throw Error.argument("personaViewModel.BasePersona");var f=this.dq(t,i);var r=this.R(n,f,i);this.be(r,f);if(this.A){var e=this.t.k(this.A);this.S(this.t.x[e]);var u=r.i;u.g(!this.H);u.z(!this.H);u.K(!this.H);this.H&&r.M();this.t.r(e,r);this.bZ()}else this.t.a(r);this.bg();return r},dm:function(n){var t=n.a();if(this.bo()){this.P=new _C(this.cq,_rw.b.a);t.R(this.cs)}else this.P=new _C(this.cp,_rw.b.a);t.bn(new _C(this.cD,_rw.b.a));t.c(this.P);t.J(new _C(this.bK,_rw.b.a));this.cu()&&this.bo()&&t.I(new _C(this.bK,_rw.b.a));t.q(this.bP);t.Q(this.bM);t.S(this.bN);t.bm(this.D);t.bl(this.t);t.H(this.bR);this.dl(t)},bT:function(){if(this.bi>0){var t=_a.d.b(_a.a.T,"AddEmailAddressRecipient ");var n=new _a.r;n.a("rc",this.bi);t.j=n.toString();_a.d.a(t);this.bi=0}if(this.z!==-1)this.bb();else{var i=this.v().r();this.v().d(!1);this.cv();this.v().d(i);this.v().E(!1)}},de:function(n){if(!$a(n)&&n.x.length&&!$a(this.v().s())&&this.v().s().x.length){this.E=new _js.f;for(var t=0,i=n.x.length;t<i;t++)this.cX(n.x[t],this.v().s().x[t]);if(this.E.x.length>0){this.bt(!0);this.v().c(null);this.J(this.bX);this.F(this.bW);this.v().p(this.Y)}_pc.b.b(2,-1,-1,-1,4,1)}},df:function(n,t){for(var u=0,f=this.t.x.length;u<f;u++){var i=this.t.x[u];var r=i.i.a();if(i.k&&r.i()===1&&!_js.d.b(r.a().EmailAddress)&&r.a().EmailAddress.toLowerCase()===n.toLowerCase()){i.i.I(t);this.cj(i.i)}}},ct:function(n,t){t&&this.v().bs(n.a())},cV:function(){var t=this.v().h();var n=this.dn(t);n&&n.A()&&t.a().cH(n.A());var i=this.G(t.a());i.z(!0);this.C(i,this.B,!0)},dn:function(n){return _pe.k.isInstanceOfType(n)?n:null},bq:function(){this.v().eE=_js.d.b(this.v().a())?-1:this.v().a().length;this.v().b("");this.bg()},cv:function(){var i=this.v().a();if(!_js.d.b(i)){for(var t=this.v().bg(i),n=0,r=t.length;n<r;n++)this.bx(t[n]);this.bq()}},bx:function(n){var t;var u,f;var i=(f=this.v().U(n,u={val:t}),t=u.val,f);if(i){var r=this.G(i);t&&this.bi++;this.C(r,this.B,t);this.ct(r,t)}},cX:function(n,t){var r=this.G(n);var i=this.C(r,this.B,t);this.ct(r,t);this.bq();if(!t&&!OwaApplication.b){this.E.a(i);this.z!==-1||this.cw(i)}},cw:function(n){this.z=0;this.bW=n;this.bX=_rw.b.b(n)},dr:function(){for(var t=!1,i=this.t.x.length,n=0;n<i;n++){t=!this.t.x[n].k;if(t)break}this.cy(t)},bZ:function(){if(!(this.z!==-1)){this.v().c(this.P);this.J("");this.F(null);return}this.v().t(!1);var n=this.E.x[this.z];var t=n.i.d();this.E.n(this.z);if(this.z<this.E.x.length){n=this.E.x[this.z];this.J(_rw.b.b(n));this.F(n)}else{this.E=null;this.z=-1;this.v().D();this.bt(!1);this.v().c(this.P);this.v().i(this.Y);this.J("");this.F(null);if(this.N){this.dZ("BulkResolveOperationComplete",!0);this.N=!1}}},cZ:function(n){for(var r=0,u=this.t.x.length;r<u;r++){var t=this.t.x[r];var i=t.i;i.g(!n);i.z(!n);i.K(!n);n?t.M():t.J()}},dq:function(n,t){var i=n;t||(i^=1);return i},dj:function(n,t){var i=n;i.ba()&&this.bT()},dg:function(n,t){var e=n;if(!e.A()){var r=this.t.k(this.A);if(r>=0){var i=this.v().a();if(_js.d.a(i)){this.S(this.t.x[r]);this.bZ()}else if(this.A&&i===this.A.j.c()){var f=this.A.i.a();var u=this.G(f);this.C(u,this.B,this.A.k)}else this.bx(i)}}},dh:function(n,t){var u=n;if(!u.A()){var i=this.t.k(this.A);if(i>=0){var r=this.v().a();if(_js.d.a(r)){this.S(this.t.x[i]);this.bZ()}else this.v().Y()&&this.bb()}}},da:function(n){this.Z=n;var t=this.Z.b().a();var r=_js.d.a(t.bj())?_pc.h.a(t):null;var i=new _pc.h(r,t.bj(),t.a(),new _h.o(0,_rw.b.d),2,!1);i.z(this.cr);OwaApplication.a.a(i)},dd:function(n){var u=_a.k.c("ExpandDLInRecipientWell");if(n.t){this.dZ(_rw.b.c,1);u.k=n.D()}else{var h=n;if(h.g<=_rw.b.d){this.Z.g().a();for(var t,s=!1,c=h.l,l=c.length,r=0;r<l;++r){var i=c[r];if(i.a())if(i.a().RoutingType.toUpperCase()==="MAPIPDL"){t=!0;s=!0}else{var o,e;e=_rw.b.e(i.a().EmailAddress,o={val:t}),t=o.val,e}else t=!1;this.C(this.G(i),this.B,t)}if(u){var f=new _a.r;f.a("mc",n.g).c("ip",s);u.j=f.toString()}}else this.dZ(_rw.b.c,0)}_a.k.a("ExpandDLInRecipientWell")}};_rw.e=function(n,t,i){this.I=Function.createDelegate(this,this.bg);this.E=Function.createDelegate(this,this.K);this.D=Function.createDelegate(this,this.bd);this.x=Function.createDelegate(this,this.be);this.F=Function.createDelegate(this,this.S);this.G=Function.createDelegate(this,this.bb);this.H=Function.createDelegate(this,this.bc);_rw.e.initializeBase(this);this.i=n;this.i.K(!0);this.J();this.bk(i);this.L(n.a(),t,!0);if(this.q){this.i.bw(new _C(this.H,_rw.e.a));this.i.w(!0)}else this.i.p(!0);if(this.v()){this.i.b(!0);this.i.bv(this.e())}this.i.j(!this.i.T()&&!this.q&&this.v());this.A=this.i.bd().e()};_rw.e.prototype={i:null,l:null,y:null,j:null,k:!0,m:0,r:!1,B:!1,o:!1,p:!1,C:!1,q:!1,w:!1,n:null,z:null,A:null,U:function(){return this.k&&_g.o.j(this.j.a())},Z:function(){var n=this;return new _C(function(){n.N(!0)},_a.a.T)},ba:function(){var n=this;return new _C(function(){n.N(!1)},_a.a.T)},Q:function(n){this.dV("DLExpansionClicked",n)},bf:function(n){this.dW("DLExpansionClicked",n)},N:function(n){if(this.w!==n){this.w=n;this.dQ("IsSelectedOrBeingDragged")}return n},d:function(n){if(this.r!==n){this.r=n;this.dU("IsSelected","IsSelectedOrBeingDragged")}this.i.E()!==n&&this.i.n(n);return n},X:function(){return this.r||this.w},bh:function(n){if(this.B!==n){this.B=n;this.dQ("IsDeleted")}return n},c:function(){return this.o},h:function(n){if(this.o!==n){this.o=n;this.dQ("IsBeingEdited")}return n},bk:function(n){if(this.k!==n){this.k=n;this.dU("IsValid","DisplayAsValid")}return n},v:function(){return this.k&&!this.U()},V:function(){return this.v()?"":_nbs.a.OE},bi:function(n){if(this.p!==n){this.p=n;this.dU("IsMailTipsTriggered","IsMailTipsOrPolicyTipsTriggered")}return n},bj:function(n){if(this.C!==n){this.C=n;this.dU("IsTriggeredPolicyTips","IsMailTipsOrPolicyTipsTriggered")}return n},W:function(){return this.p||this.C},a:function(){return this.j},f:function(){var t;if(this.k){var n=this.j.a();if(n.RoutingType==="SMTP"){var r=n.EmailAddress;var i=n.Name;t=_js.d.b(i)?r:String.format("{0} <{1}>",n.MailboxType==="OneOff"?i:'"'+i.replace('"','\\"')+'"',r)}else t=n.RoutingType==="MAPIPDL"?n.Name:String.format("{0} [{1}:{2}]",n.Name,n.RoutingType,n.EmailAddress)}else t=this.i.d();return t},b:function(){return this.i},e:function(){this.y||(this.y=new _C(this.G,_rw.e.a));return this.y},g:function(){return this.l},bl:function(n){if(this.l!==n){this.l=n;this.dQ("RemoveRecipientCommand")}return n},T:function(){this.z||(this.z=new _C(this.F,_rw.e.a));return this.z},Y:function(){return this.i.bj()&&!!this.A&&this.A.a().cJ().Enabled},L:function(n,t,i){i||this.i.bs(n);this.j=n;if(i||this.m!==t){this.m=t;this.R()}},J:function(){this.i.apcl("IsSelected",this.x);this.i.apcl("IsPersonaCardShown",this.D)},M:function(){this.i.rpcl("IsSelected",this.x);this.i.rpcl("IsPersonaCardShown",this.D)},be:function(n,t){this.d(n.bR)},bd:function(n,t){this.i.t()&&(_rw.a.e=this)},bb:function(){var t=this;var n=function(){t.i.v();t.n=null};if(this.q){var i=this;this.n=_js.g.a().a(_rw.e.a,"RecipientViewModel.OnClick",function(){i.n&&n()},300)}else n()},bc:function(){if(this.i&&this.i.bg()){this.i.t()&&this.i.f(!1);if(this.q&&this.n){_js.g.a().b(this.n);this.n=null}this.K()}},R:function(){var n=[];if(((this.m&8)==8||OwaApplication.b&&_y.c.a.a()==="TouchNarrow")&&this.i&&this.i.a()&&this.i.a().a()){var t=this.i.a().a().EmailAddress;_js.d.b(t)||Array.add(n,new _fm.n(t))}if((this.m&4)==4&&!_y.c.a.h()){Array.add(n,new _fm.d(_u.R.VV,null,new _C(this.E,_rw.e.a),!1,null,null,null,null,null));this.q=!0}if((this.m&2)==2){this.bl(new _C(this.I,_rw.e.a));Array.add(n,new _fm.d(_u.R.Te,null,this.l));this.i.bx(this.l)}!$a(this.i.m())&&this.v()&&(this.m&1)==1&&Array.addRange(n,this.i.m());this.i.W(n)},K:function(){_a.l.b("VM.Recipient.Edit");this.h(!0)},bg:function(){this.i.rpcl("IsSelected",this.x);this.bh(!0)},S:function(){_a.k.b(_rw.e.a,"ExpandDLInRecipientWell");this.dZ("DLExpansionClicked",this)}};_rw.g=function(n,t,i,r){_rw.g.initializeBase(this,[n,t]);this.e=i;this.f=r};_rw.g.prototype={e:null,f:null,b:function(n,t,i,r,u){return new _rw.b(this.d.a(),n,t,i,r,this.c,this.e,this.f,u)}};_rw.a=function(n,t,i,r,u,f,e,o,s,h,c,l){this.cc=Function.createDelegate(this,this.dA);this.ca=Function.createDelegate(this,this.dz);this.cb=Function.createDelegate(this,this.cI);this.cC=Function.createDelegate(this,this.cf);this.bk=Function.createDelegate(this,this.cg);this.cD=Function.createDelegate(this,this.bg);this.L=_bc.f.a;_rw.a.initializeBase(this);_a.b.a(o,"personaViewModelFactory");this.bF=n;this.bn=l;this.ck=$a(f)?!1:f;this.bD=o;this.cl=s;this.ch=c;this.T=e;this.B=t;this.L=i;this.V=u;this.bC=$a(h)?r?r.b():0:h;this.r(new _js.f);this.q(new _js.f);this.D={};this.U=[];this.cH(r);r&&_js.Trace.logInfo(_a.a.T,"RecipientWellViewModel::Number of EmailAddresses passed in: {0} and Number of recipients created: {1}",r.b(),this.t.x.length);this.t.d(this.bk)};_rw.a.b=function(n,t,i){OwaApplication.b&&(t=!1);var r=n.a().a();if(r&&!_js.d.b(r.EmailAddress)&&n.a().b()===1){if(i===9){n.e(0,r,4);return}t||r.MailboxType==="Contact"?_js.d.b(r.Name)||r.Name===r.EmailAddress?n.e(0,r.EmailAddress,0):n.e(0,r.Name,0):(r.MailboxType==="OneOff"||r.MailboxType==="Unknown")&&n.e(0,r,2)}};_rw.a.g=function(n){return $a(n)||0===n.w.x.length};_rw.a.f=function(){var n=null;if(_rw.a.a>=0){n=_rw.a.c[_rw.a.a];_rw.a.c[_rw.a.a]=null;_rw.a.a-=1}return n};_rw.a.prototype={ck:!1,V:1,T:!1,bD:null,cl:!1,bC:0,bF:0,B:1,y:null,w:null,t:null,U:null,cm:0,bl:0,bH:!1,bB:null,bG:!0,bf:0,ce:!1,D:null,ch:0,bn:null,ds:function(n){this.dV("RefreshLayoutRequest",n)},dB:function(n){this.dW("RefreshLayoutRequest",n)},dw:function(){return _a.UserAgent.getInstance().G},a:function(){return this.t},r:function(n){if(this.t!==n){this.t=n;this.dQ("Recipients")}return n},dv:function(){this.bB||(this.bB=new _C(this.cC,_rw.a.d));return this.bB},c:function(){return this.w},q:function(n){if(this.w!==n){this.w=n;this.dQ("Addresses")}return n},j:function(){return this.y},m:function(n){if(this.y!==n){this.y&&this.y.d(!1);this.y=n;if(this.y){this.y.d(!0);this.du()}this.dQ("SelectedRecipient")}return n},p:function(){return this.L},ci:function(n){this.bG!==n&&(this.bG=n);return n},cK:function(n){this.cm!==n&&(this.cm=n);return n},f:function(n){if(this.bl!==n){this.bl=n;if(this.bl===2){for(var i=0,f=this.U.length;i<f;i++)this.cE(this.U[i]);Array.clear(this.U);this.cK(1)}else if(this.bl===1){if(this.t)for(var r=this.t.x.length,t=this.bf;t<r;r--){var u=this.t.x[t];$a(u)||Array.add(this.U,u);this.t.n(t)}this.cK(0)}}return n},cd:function(){return!!_y.c.a&&_y.c.a.a()==="Mouse"&&!!this.bn&&this.bn.a().bD().Enabled&&this.bn.a().e().Enabled},g:function(){return this.bH&&!this.cd()},b:function(n){if(this.bH!==n){this.bH=n;this.dQ("ShowEllipsis")}return n},e:function(){return this.ce},dx:function(){return this.cd()?"ReadOnlyRecipientViewAggregated":"ReadOnlyRecipientView"},i:function(n){if(this.t){this.bE();this.t.e(this.bk)}this.cH(n);this.t&&this.t.d(this.bk)},d:function(){if(!$a(this.t)&&this.t.x.length){if(!_rw.a.c){_rw.a.c=[];_rw.a.a=-1}for(var n=0,t=this.t.x.length;n<t&&_rw.a.a<49;n++){_rw.a.a+=1;_rw.a.c[_rw.a.a]=this.t.x[n]}this.t=null}},o:function(n,t){if(n.i()!==this.V)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");this.bm(n);var i=this.R(n,t,!0);this.be(i,t);this.t.r(0,i)},Q:function(n){if(n.i()!==this.V)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");this.bm(n);this.C(n,this.B,!0)},K:function(n,t){if(n.i()!==this.V)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");t=$a(t)?this.B:t;this.bm(n);this.C(n,t,!0)},n:function(n){var t=this.G(n);this.C(t,this.B,!0)},l:function(n){for(var i,t=0,r=this.t.x.length;t<r;t++){i=this.t.x[t];if(i.i===n){this.S(this.t.x[t]);return}}},bd:function(n){var t=this.G(n);this.C(t,this.B,!1)},bE:function(){this.t&&this.t.f();this.w&&this.w.f()},by:function(n){var r=_h.k.a(n);var i=this.T?_rw.a.f():null;var t;if(i){i.L(r,this.B,!1);t=i.i;this.bm(t);this.t.a(i)}else{t=this.G(r);this.C(t,this.B,!0)}return t},h:function(){for(var i=new _ff.e,n=0,u=this.t.x.length;n<u;n++){var t=this.t.x[n].j.a();if(!$a(t.EmailAddress))if(this.t.x[n].j.b()===5){var r=new _a.D(t.EmailAddress);_js.d.a(r.b)||i.c(r.b)}else i.c(t.EmailAddress)}return i.i()},dT:function(){this.t.e(this.bk);if(!$a(this.t)&&this.t.x.length){for(var n=0,i=this.t.x.length;n<i;n++){var t=this.t.x[n];this.bA(t)}_a.jV.prototype.dT.call(this)}},cj:function(n){if(n.i()===1||n.i()===2||OwaApplication.b){_rw.a.b(n,!1,this.ch);n.e(0,_js.d.c("{0};",n.d()),0)}},bg:function(){this.dX("RefreshLayoutRequest")},cg:function(n,t){switch(t.c){case 0:for(var r=0,e=t.a.length;r<e;r++)this.dt(t.a[r],t.d+r);break;case 2:for(var u=t.b.length-1;u>=0;u--)this.cJ(t.d+u);break;case 3:for(var i=0,o=t.b.length;i<o;i++)this.dD(t.a[i],t.d+i);break;case 4:for(var f=t.b.length-1;f>=0;f--)this.cJ(t.d+f);break;default:break}},R:function(n,t,i){return new _rw.e(n,t,i)},be:function(n,t){if(!this.T){(t&4)==4&&n.apcl("IsBeingEdited",this.cb);(t&2)==2&&n.apcl("IsDeleted",this.ca);n.apcl("IsSelected",this.cc)}},bA:function(n){var t=n.m;if(!this.T){(t&4)==4&&n.rpcl("IsBeingEdited",this.cb);(t&2)==2&&n.rpcl("IsDeleted",this.ca);n.rpcl("IsSelected",this.cc)}},dA:function(n,t){var i=n;i.r?this.m(i):this.m(null);this.bg()},dz:function(n,t){var i=n;i.B&&this.S(i)},cI:function(n,t){},G:function(n){var t=null;t=this.bD.a(n,this.L,!0,this.V);this.bm(t);return t},C:function(n,t,i){if($a(n))throw Error.argument("personaViewModel");var r=this.R(n,t,i);return this.cF(r)},cF:function(n){this.be(n,n.m);this.t.a(n);this.bg();return n},S:function(n){this.bA(n);this.t.m(n,!0);this.bg()},k:function(n){for(var r=[],t=0,e=this.t.x.length;t<e;t++){var f=this.t.x[t].j;if(!$a(f)){var u=f.a();$a(u.EmailAddress)||u.EmailAddress!==n||Array.add(r,t)}}for(var i=r.length-1;i>=0;i--)this.t.n(r[i])},cf:function(){this.y&&!this.y.c()&&this.y.b().U()},cH:function(n){if(!$a(n)){var r=n.b();switch(this.bF){case"TouchWide":this.bf=4;break;case"TouchNarrow":this.bf=2;break;default:this.bf=this.cd()?20:7;break}for(var i=this.T?this.bf:r,t=0;t<i&&t<r;t++){var e=n.c(t);$a(e)||this.cE(e)}(i<r||this.bC>i)&&(this.ce=!0);for(var u=i;u<r;u++){var f=n.c(u);$a(f)||Array.add(this.U,f)}}},bm:function(n){this.cj(n);n.z(!this.T)},cE:function(n){if(_bc.x.isInstanceOfType(n)){var u=n;this.w.a(u.a());this.n(u);this.bz(u.a())}else if(_rw.e.isInstanceOfType(n)){var i=n;this.w.a(i.j.a());this.bz(i.j.a());i.k?this.n(i.j):this.bd(i.j)}else{var t;if(_g.o.n(n))t=n.Mailbox;else if(_g.o.a(n))t=n;else throw Error.invalidOperation("Recipient is not a known type.");if(!t.Submitted||this.cl){if(_js.d.a(t.EmailAddress)){for(var f="A new zombie contact was added in the recipients",r=0;r<this.w.x.length;r++)if(this.w.x[r].Name===t.Name){f="A zombie contact was added for an existing recipient";break}_js.Trace.logError(_a.a.T,f)}this.w.a(t);this.by(t);this.bz(t)}}},dt:function(n,t){var i=this.cG(n);this.w.r(t,i);this.bz(i)},cJ:function(n){var t=this.w.x[n];this.w.n(n);this.dC(t)},dD:function(n,t){var i=this.cG(n);this.w.n(t);this.w.r(t,i)},cG:function(n){return this.dy(n)},dy:function(n){var t;var i=n.i.y();t=$a(i)?$a(n.j.a())?!$a(n.j.d())&&n.j.d().length>0?n.j.d()[0]:new _g.d:n.j.a():i;return t},bz:function(n){var i=!!n&&n.MailboxType==="PrivateDL";if(i||n&&n.EmailAddress){var t=i?n.Name:n.EmailAddress;this.D[t]=t in this.D?this.D[t]+1:1}},dC:function(n){var i=!!n&&n.MailboxType==="PrivateDL";if(i||n&&n.EmailAddress){var t=i?n.Name:n.EmailAddress;t in this.D&&this.D[t]>1?this.D[t]=this.D[t]-1:delete this.D[t]}},du:function(){_pe.c.c&&_pe.c.c!==this.y.b()&&_pe.c.c.f(!1)}};_rw.k=function(n){_rw.k.initializeBase(this,[n])};_rw.k.prototype={b:null,a:null,g:function(){return null},j:function(n){this.b&&this.b.b&&this.b.a()},h:function(n){},i:function(n){this.a&&this.a.b&&this.a.a()}};_rw.l=function(){};_rw.l.prototype={a:function(n,t){return Boolean.isInstanceOfType(n)&&n?_pe.a.F():_pe.a.E()},b:function(n,t){throw Error.notImplemented();}};_rw.j=function(n,t,i,r){this.r=Function.createDelegate(this,this.cS);_rw.j.initializeBase(this,[n,t]);this.k=i;this.l=r};_rw.j.prototype={k:null,m:null,h:null,d:null,v:!1,bQ:!1,w:!1,s:!1,t:!1,l:null,cZ:function(n){if(this.m!==n){this.m=n;this.cO(n)}return n},cT:function(n){this.h!==n&&(this.h=n);return n},dq:function(n){if(this.v!==n){this.v=n;n&&this.ds()}return n},dr:function(n){if(this.w!==n){this.w=n;n&&this.bW()}return n},dc:function(n){if(this.s!==n){this.s=n;n&&this.dC()}return n},cY:function(n){this.bQ=n;n&&this.i();return n},dd:function(n){if(this.t!==n){this.t=n;n&&this.dy()}return n},bB:function(){return!!this.l&&this.l.a().R().Enabled},W:function(){_rw.d.prototype.W.call(this);this.bY.a()!=="Mouse"&&_rw.f.isInstanceOfType(this.Q)&&this.k.b(_ff.p,this.r)},bk:function(){this.bY.a()!=="Mouse"&&_rw.f.isInstanceOfType(this.Q)&&this.k.c(_ff.p,this.r);_rw.d.prototype.bk.call(this)},bJ:function(){if(_rw.f.isInstanceOfType(this.Q)){this.bf(null);var n=this.Q.b;n.h()}},i:function(){var n=_rw.f.isInstanceOfType(this.Q);if(n&&this.Q.b.cj()){this.Q.b.bN();this.B.focus()}_rw.d.prototype.i.call(this)},ds:function(){this.d.length===1&&this.d.show()},cO:function(n){var t=this.Q;var i=t.b;if(n){var r=this.bT(n);if(r<0)return;this.d=t.a.c(r).B;this.d.hide();if(r!==this.Z().b()-1){var u=t.a.c(r+1).B[0];t.B[0].insertBefore(i.B[0],u);t.b.c(this.d.width()+10)}else t.B[0].appendChild(i.B[0]);t.c.a()===this.h&&t.c.b("");t.c.b(this.h);t.c.bk(!0)}else{this.d=null;t.B[0].appendChild(i.B[0]);t.c.b("")}var f=this;_js.g.a().c(_a.a.T,"RecipientWellView.AdjustFindControlPosition",function(){i.h();i.cl();t.c&&(n?t.c.t(!0):t.c.t(!1))})},cS:function(n){this.bW()},bW:function(){if(_rw.f.isInstanceOfType(this.Q)){var n=this;_js.g.a().c(_a.a.T,"RecipientWellView.TryUpdateTextBoxDropDownPosition",function(){n.Q.b.bQ()})}},dC:function(){if(_rw.f.isInstanceOfType(this.Q)){var n=this;_js.g.a().c(_a.a.T,"RecipientWellView.TryResetTextBoxDropDownPosition",function(){n.Q.b.ca()})}},dy:function(){if(_rw.f.isInstanceOfType(this.Q)){var n=this;_js.g.a().c(_a.a.T,"RecipientWellView.TriggerResizeFindControl",function(){n.Q.bd()})}}};_rw.i=function(n){_rw.i.initializeBase(this,[n]);this.y("ReadWriteRecipientWellView")};_rw.i.prototype={a:null,c:null,b:null,cA:function(){return this.c},bc:function(n){if(this.c!==n){this.c=n;this.bj("AriaLabelledBy")}return n},cq:function(){return this.b},bb:function(n){if(this.b!==n){this.b=n;this.bj("AriaLabel")}return n},d:function(){var n=null;if(this.a){var t=this.a.c();n=this.a.Q.a.c(t)}return n},e:function(){this.S()&&this.a&&this.a.Q.b.h()},K:function(){_js.b.prototype.K.call(this);var n=this.F;this.a=n?n.a("RecipientWell"):null}};_rw.f=function(n){this.x=Function.createDelegate(this,this.k);this.q=Function.createDelegate(this,this.bB);this.r=Function.createDelegate(this,this.F);this.s=Function.createDelegate(this,this.bJ);this.w=Function.createDelegate(this,this.Z);_rw.f.initializeBase(this,[n]);this.B.attr("tabIndex","-1");this.b=this.bt();this.b.m(new _C(this.w,_rw.f.a));this.l=_y.c.a.a()==="Mouse"?25:50;var i=this;this.B.bind("click",function(n){i.y(n)});var t=256;this.bm(t)};_rw.f.prototype={b:null,l:0,c:null,f:null,bf:function(n){if(this.c!==n){if(!$a(this.c)){this.c.rpcl("IsTextBoxFocused",this.s);this.c.rpcl("IsTypedown",this.r)}this.c=n;this.b.ba(this.c);if(!$a(this.c)){this.b.k(this.c.y());this.b.o(this.c.B());this.c.apcl("IsTextBoxFocused",this.s);this.c.apcl("IsTypedown",this.r);this.F(null,"IsTypedown")}this.bj("FindRecipientViewModelForWell")}return n},bG:function(n){this.b.ce(n);return n},bD:function(n){this.b.cd(n);return n},g:function(){if($a(this.f)){this.f=$(window.document.createElement("SPAN"));this.f.addClass("dynamicResizingElement");this.f.addClass("ms-fwt-r")}return this.f},i:function(){return this.B.width()},bd:function(){this.b.c(0);this.c&&this.k()},W:function(){_js.c.prototype.W.call(this);$(window).bind("resize",this.q);_js.g.a().a(_a.a.T,"RecipientWell.FindControl.Resize",this.x,500)},J:function(){_js.C.prototype.J.call(this);this.b.B.addClass("findControlWrapper");this.b.B.css("line-height","normal");this.b.B[0].appendChild(this.g().get(0));_y.c.a.a()!=="Mouse"&&this.Z()},j:function(n,t){_fce.c.prototype.j.call(this,n,t);if(this.E()&&this.E().bG){t.c!==2&&t.c||this.k();if(!this.c||this.c.bc()){if(!t.c||t.c===2&&!this.a.b()){var i=this;_js.g.a().c(_a.a.T,"RecipientWellPanelView.OnChildrenModified",function(){i.b.h()})}}else this.c.x(!0)}},bn:function(n,t){if(n.B.parents().length)throw Error.argument("Can't add already added control to panel");var i=this.B[0];this.b.B.width("auto");this.b.c(0);i.insertBefore(n.B[0],this.b.B[0])},bk:function(){$(window).unbind("resize",this.q);var i=this;this.B.unbind("click",function(n){i.y(n)});this.bf(null);var n=this.g().get(0);var t=this.b.B.has(n);t.length===1&&this.b.B[0].removeChild(n);this.b.dispose();_fce.c.prototype.bk.call(this)},y:function(n){var t="";if($a(window.document.selection))$a(window.getSelection)||(t=window.getSelection().toString());else{var r=window.document.selection.createRange();t=r.text}if(_js.d.a(t))if(n.target.nodeName==="SPAN"||n.target.nodeName==="IMG")this.b.bN();else if(this.bC()){var i=this;_js.g.a().c(_a.a.T,"RecipientWellPanelView.OnClickPanel",function(){i.b.h()})}else this.b.h()},bt:function(){var n=new _b.t(window.document.createElement("SPAN"));n.ba(this.c);n.y("FindRecipientView");n.M(!1);n.g(!0);n.l(0);n.p(100);n.bv();this.B[0].appendChild(n.B[0]);return n},F:function(n,t){this.b&&this.b.v!==this.c.r()&&this.b.g(this.c.r())},bJ:function(n,t){this.c.z()?this.b.bC()<this.l&&this.b.c(this.i()-30):_js.d.a(this.c.a())&&this.k()},Z:function(){if(this.c){var n=this.c.a();if(_js.d.a(n)){this.g().text("");this.k()}else{n=_ff.i.a(n);this.g().text(n);var i=this.g().innerWidth();if(i<this.b.bC())return;var t=this.i()-30;this.b.c(t)}}},k:function(){this.b.c(this.i()-this.bw()-30)},bw:function(){var n=0;if(this.a.b()>0){var t=this.a.c(this.a.b()-1).B;n=_g.a.a().c().bl.IsUserCultureRightToLeft?this.i()-t.position().left:t.position().left+t.outerWidth(!0)}return this.i()-n-30<this.l?0:n},bB:function(n){this.bd()},bC:function(){return _a.UserAgent.getInstance().O&&_y.c.a.a()!=="Mouse"}};_rw.c=function(n){_rw.c.initializeBase(this,[n])};_rw.c.prototype={b:null,a:null,cA:function(){return this.b},bc:function(n){if(this.b!==n){this.b=n;this.bj("AriaLabelledBy")}return n},cq:function(){return this.a},bb:function(n){if(this.a!==n){this.a=n;this.bj("AriaLabel")}return n}};_rw.d=function(n,t){this.n=Function.createDelegate(this,this.ca);this.o=Function.createDelegate(this,this.ck);this.x=Function.createDelegate(this,this.bX);_rw.d.initializeBase(this,[n,t]);this.cJ();this.bg(this.x)};_rw.d.a=function(n,t){if($a(window.getSelection)){if(!$a(window.document.selection)){var i=document.selection.createRange();i.moveToElementText(n.get(0));_js.g.a().c(_a.a.T,"RecipientWellView.HighLightSelectedElement",function(){i.select();t.focus()})}}else{var u=window.getSelection();var r=document.createRange();r.selectNodeContents(n.get(0));u.removeAllRanges();_js.g.a().c(_a.a.T,"RecipientWellView.HighLightSelectedElement",function(){u.addRange(r);t.focus()})}};_rw.d.prototype={b:null,f:!1,p:!1,e:!1,a:function(n){this.f!==n&&(this.f=n);return n},cH:function(n){if(this.p!==n){this.p=n;this.ij(n)}return n},j:function(n){n!==this.e&&(this.e=n);return n},c:function(){return this.Z().k(this.bd())},bB:function(){return!1},W:function(){_fce.b.prototype.W.call(this);this.bm(524288);this.B.bind("click",this.o);this.B.bind("cut",this.n)},K:function(){_fce.b.prototype.K.call(this);var n=this.F;this.b=n?n.a("ClipboardTextArea"):null},bk:function(){this.B.unbind("click",this.o);this.B.unbind("cut",this.n);try{_fce.b.prototype.bk.call(this)}catch(u){var t="UIObject.Remove threw while disposing RecipientWellView: "+u.message+u.stack;if(this.E()){var n=this.E();if(n){_rw.b.isInstanceOfType(n)&&(t+=" ReadWrite well ");if(n.t){t+=" NumRecipients:"+n.t.x.length+"[";for(var r=0;r<n.t.x.length;r++){var i=n.t.x[r];i&&i.j&&(t+=i.j.c()+",")}t+="]"}}}else t+="RecipientWellView datacontext is null";_js.Trace.logError(_a.a.T,t)}},cm:function(n){var t=n.a();if(n.c().nodeName!=="INPUT"||t===_ff.k.a)if(t===46||t===8){if(!$a(this.bd())&&!this.f){this.bt(t===46);n.b()}}else if(t===_ff.k.a){this.cs();n.b()}else if(t===_ff.k.b){this.cr();n.b()}},eU:function(){_fce.b.prototype.eU.call(this);_js.Trace.logInfo(_a.a.T,"RecipientWellView::FinishedRendering: Panel children count: {0}, data count: {1}",this.Q.a.b(),this.eW())},bJ:function(){},i:function(){this.g(this.Z().c(this.Z().b()-1))},q:function(){if(!$a(this.bC()))if(this.b){var n=this.bC().E();this.b.c(n.f()+";");this.b.B.focus().select()}else _rw.d.a(this.bC().B,this.B)},ck:function(n){if(n.target.nodeName!=="DIV"&&n.target.nodeName!=="INPUT"){this.e&&this.q();return}this.bf(null)},ca:function(n){if(this.b&&this.b.B[0]===n.target){var t=this;_js.g.a().c(_a.a.T,"RecipientWellView.OnCut",function(){t.bt(!1)})}},dP:function(n){var t=this;_js.g.a().c(_a.a.T,"RecipientWellView.OnFocusOut",function(){if(t.E()&&(!document.activeElement||!t.z.contains(document.activeElement))){var n=t.E().y;!n||n.b()&&n.b().t()||t.E().m(null)}})},cJ:function(){this.f?this.B.attr("tabIndex","0"):this.B.attr("tabIndex","-1");var n=256;this.bm(n)},bX:function(){return new _fce.d(window.document.createElement(this.hS()))},bt:function(n){if(this.bB()){var t=this.Z().k(this.bd());t&&(t+=n&&t+1<this.Z().b()?0:-1);this.Z().m(this.bd());this.Z().b()&&this.g(this.Z().c(t))}else{var i=this.Z().k(this.bd());i&&i--;this.Z().m(this.bd());this.Z().b()&&this.g(this.Z().c(i))}},cr:function(){if(this.Z().b())if(this.bd())if(this.c()<this.Z().b()-1)this.g(this.Z().c(this.c()+1));else{this.f||this.bf(null);this.bJ()}else this.g(this.Z().c(0))},cs:function(){this.Z().b()&&(this.bd()?this.c()>0?this.g(this.Z().c(this.c()-1)):this.e&&this.q():this.i())},g:function(n){this.bf(n);this.e&&this.q()}};_rw._TI=function(){};_rw._TI.$$cctor=function(){var f="ReadOnlyRecipientView";new _A(f,function(){_rw._TI.a[f]===undefined&&(_rw._TI.a[f]=[[[-1,0,["CurrentPersonaViewModel"],[_rw._TI.c],null,"DataContext",null,_rw._TI.d,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[0].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.y("PersonaView.ReadOnlyRecipientPopup");n.m=!0;return new _B(t,[n])},_rw.e,_js.b,function(n){return new _js.b(n)},!1,!1,!0,5,_rw._TI.a);var u="ReadOnlyRecipientViewAggregated";new _A(u,function(){_rw._TI.a[u]===undefined&&(_rw._TI.a[u]=[[[-1,0,["CurrentPersonaViewModel"],[_rw._TI.c],null,"DataContext",null,_rw._TI.d,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.y("PersonaView.ReadOnlyRecipientPopupAggregated");n.m=!0;return new _B(t,[n])},_rw.e,_js.b,function(n){return new _js.b(n)},!1,!1,!0,5,_rw._TI.a);var o="ReadOnlyRecipientWellExpandCollapseView._tid1";new _A(o,function(){_rw._TI.a[o]===undefined&&(_rw._TI.a[o]=[null,[[-1,5,["ShowEllipsis"],[_rw._TI.N],null,"hidden",null,null,0,_rw._TI.b(),null,null]]]);var n=_rw._TI._hf.childNodes[2].cloneNode(!0);var i=new _js.c(n.children[1]);var t=new _fce.c(n.children[0]);return new _B(n,[t,i]).R({ListPanel:t})},_rw.a,_rw.d,function(n){return new _rw.d(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_rw._TI.a);var e="ReadOnlyRecipientWellExpandCollapseView";new _A(e,function(){_rw._TI.a[e]===undefined&&(_rw._TI.a[e]=[[[-1,1,["AriaLabel"],[_rw._TI.Q],null,"AriaLabel",null,_rw._TI.bk,1,null,null,null],[-1,0,["Recipients"],[_rw._TI.j],null,"DataSource",null,_rw._TI.n,1,null,null,null],[-1,0,["ReadOnlyRecipientTemplateId"],[_rw._TI.q],null,"DataTemplateId",null,_rw._TI.r,0,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.k],_rw._TI.l,"SelectedItem",_rw._TI.m,_rw._TI.o,2,null,null,null]]]);var i=_rw._TI._hf.childNodes[3].cloneNode(!0);var n=new _rw.d(i.children[0],_js.a.Instance.a(_y.a));n.a(!0);n.bw=!0;n.bG(!1);n.bn("span");n.bq("_rw_6");n.j(!0);n.C(0);var r=new _fc.g;var t=new _fc.c;t.A(_E.a(["EnterKeyCommand"],[_rw._TI.i],null,"Command",null,_rw._TI.p,1));t.i("ENTER");r.a([t]);n.G([r]);n.y("ReadOnlyRecipientWellExpandCollapseView._tid1");return new _B(i,[n])},_rw.a,_rw.c,function(n){return new _rw.c(n)},!1,!1,!0,5,_rw._TI.a);var t="ReadOnlyRecipientWellView._tid2";new _A(t,function(){_rw._TI.a[t]===undefined&&(_rw._TI.a[t]=[null]);var i=_rw._TI._hf.childNodes[4].cloneNode(!0);var n=new _fce.c(i.children[0]);return new _B(i,[n]).R({ListPanel:n})},_rw.a,_rw.d,function(n){return new _rw.d(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_rw._TI.a);var n="ReadOnlyRecipientWellView";new _A(n,function(){_rw._TI.a[n]===undefined&&(_rw._TI.a[n]=[[[-1,0,["Recipients"],[_rw._TI.j],null,"DataSource",null,_rw._TI.n,1,null,null,null],[-1,0,["ReadOnlyRecipientTemplateId"],[_rw._TI.q],null,"DataTemplateId",null,_rw._TI.r,0,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.k],_rw._TI.l,"SelectedItem",_rw._TI.m,_rw._TI.o,2,null,null,null]]]);var r=_rw._TI._hf.childNodes[5].cloneNode(!0);var t=new _rw.d(_B.a(r,[0,0]),_js.a.Instance.a(_y.a));t.a(!0);t.bw=!0;t.bG(!0);t.bK(5);t.bn("span");t.bq("_rw_a");t.j(!0);t.C(0);var u=new _fc.g;var i=new _fc.c;i.A(_E.a(["EnterKeyCommand"],[_rw._TI.i],null,"Command",null,_rw._TI.p,1));i.i("ENTER");u.a([i]);t.G([u]);t.y("ReadOnlyRecipientWellView._tid2");return new _B(r,[t])},_rw.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_rw._TI.a);var r="ReadWriteRecipientWellView._tid4";new _A(r,function(){_rw._TI.a[r]===undefined&&(_rw._TI.a[r]=[null,[[-1,4,null,null,null,"TextSelectionType",null,_rw._TI.bl,0,null,null,0,2],[-1,1,["TemplatedParent","AriaLabelledBy"],[_rw._TI.s,_rw._TI.bj],null,"FindTextBoxAriaLabelledBy",null,_rw._TI.T,0,null,null,null],[-1,1,["TemplatedParent","AriaLabel"],[_rw._TI.s,_rw._TI.bi],null,"FindTextBoxAriaLabel",null,_rw._TI.S,0,null,null,null],[-1,0,["FindRecipientViewModel"],[_rw._TI.w],null,"FindRecipientViewModelForWell",null,_rw._TI.R,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[10].cloneNode(!0);var i=new _rw.f(t.children[1]);var n=new _fce.q(t.children[0]);n.I(0);n.N(!0);n.C(-1);return new _B(t,[n,i]).R({ClipboardTextArea:n,ListPanel:i})},_rw.b,_rw.j,function(n){return new _rw.j(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.h))},!1,!0,!1,0,_rw._TI.a);var i="ReadWriteRecipientWellView";new _A(i,function(){_rw._TI.a[i]===undefined&&(_rw._TI.a[i]=[[[-1,0,["Recipients"],[_rw._TI.j],null,"DataSource",null,_rw._TI.n,1,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.k],_rw._TI.l,"SelectedItem",_rw._TI.m,_rw._TI.o,2,null,null,null],[-1,0,["RecipientBeingEdited"],[_rw._TI.z],_rw._TI.F,"ItemBeingEdited",_rw._TI.W,_rw._TI.Z,2,null,null,null],[-1,0,["TextBeingEdited"],[_rw._TI.D],_rw._TI.G,"FindControlText",_rw._TI.V,_rw._TI.X,2,null,null,null],[-1,0,["DisableActionsOnAllRecipients"],[_rw._TI.v],null,"DisableActions",null,_rw._TI.U,1,null,null,!1],[-1,0,["ShouldShowHiddenRecipient"],[_rw._TI.C],null,"ShouldShowHiddenEditItem",null,_rw._TI.bc,1,null,null,!1],[-1,0,["UpdateFindControlPopupPosition"],[_rw._TI.E],null,"UpdateFindControlDropDownPosition",null,_rw._TI.bd,1,null,null,!1],[-1,0,["ResetFindControlPopupPosition"],[_rw._TI.A],null,"ResetFindControlDropDownPosition",null,_rw._TI.ba,1,null,null,!1],[-1,0,["HandleBackspaceCommandAtEndOfReadWriteWell"],[_rw._TI.x],null,"HandleBackspaceCommandAtEndOfWell",null,_rw._TI.Y,1,null,null,!1],[-1,0,["ResizeFindControl"],[_rw._TI.B],null,"ResizeFindControl",null,_rw._TI.bb,1,null,null,!1],[-1,5,["IsFirefox"],[_rw._TI.y],null,"_rw_k",null,null,0,_rw._TI.b(),null,null]]]);var r=_rw._TI._hf.childNodes[11].cloneNode(!0);var n=new _rw.j(r.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.h));n.a(!1);n.I(41);n.U("ReadWriteRecipientView");n.j(!0);n.bn("span");n.bq("_rw_j");var u=new _fc.g;var t=new _fc.c;t.A(_E.a(["EnterKeyCommand"],[_rw._TI.i],null,"Command",null,_rw._TI.p,1));t.i("ENTER");u.a([t]);n.G([u]);n.y("ReadWriteRecipientWellView._tid4");return new _B(r,[n]).R({RecipientWell:n})},_rw.b,_rw.i,function(n){return new _rw.i(n)},!1,!1,!1,0,_rw._TI.a)};_rw._TI.u=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_rw_2'></span> </div><div> <span class='_rw_3'></span> </div><div> <div class='_rw_4'></div> <span class='_rw_7 ms-font-weight-regular ms-font-color-black'>...</span>  </div><div> <div class='_rw_5'></div> </div><div> <div class='_rw_8'></div>  </div><div> <div> <div class='_rw_9'></div> </div> </div><div> <span class='_rw_b ms-fwt-r'> <span class='_rw_f'> <button type='button'></button> </span> <span class='_rw_d'></span> </span>  </div><div> <div class='_rw_c'></div> </div><div> <span class='_rw_g ms-font-m ms-font-color-themeDark ms-font-color-themePrimary-hover ms-bg-color-neutralLighter'> <span></span> </span> </div><div> <span class='_rw_h ms-fwt-r ms-font-color-themeDark ms-font-color-themePrimary-hover ms-bg-color-neutralLighter'> <span></span> </span> </div><div> <textarea class='_rw_l'></textarea> <div class='_rw_i'></div>  </div><div> <div autoid=\"_rw_0\" class='_rw_i'></div> </div>";_js.c.a().appendChild(n);return n};_rw._TI.c=function(n){return n.i};_rw._TI.N=function(n){return n.g()};_rw._TI.j=function(n){return n.t};_rw._TI.q=function(n){return n.dx()};_rw._TI.k=function(n){return n.y};_rw._TI.m=function(n){return n.bd()};_rw._TI.Q=function(n){return n.cq()};_rw._TI.i=function(n){return n.dv()};_rw._TI.h=function(n){return n.W()};_rw._TI.g=function(n){return n.v()};_rw._TI.J=function(n){return n.X()};_rw._TI.K=function(n){return n.Y()};_rw._TI.bf=function(n){return n.E()};_rw._TI.H=function(n){return n.T()};_rw._TI.L=function(n){return n.Z()};_rw._TI.M=function(n){return n.ba()};_rw._TI.I=function(n){return n.V()};_rw._TI.be=function(n){return n.bk()};_rw._TI.w=function(n){return n.v()};_rw._TI.s=function(n){return n.L};_rw._TI.bj=function(n){return n.cA()};_rw._TI.bi=function(n){return n.cq()};_rw._TI.z=function(n){return n.A};_rw._TI.W=function(n){return n.m};_rw._TI.D=function(n){return n.bj};_rw._TI.V=function(n){return n.h};_rw._TI.v=function(n){return n.H};_rw._TI.C=function(n){return n.bv};_rw._TI.E=function(n){return n.bw};_rw._TI.A=function(n){return n.br};_rw._TI.x=function(n){return n.bp};_rw._TI.B=function(n){return n.bs};_rw._TI.y=function(n){return n.db()};_rw._TI.d=function(n,t){n.ba(t)};_rw._TI.n=function(n,t){n.br(t)};_rw._TI.r=function(n,t){n.U(t)};_rw._TI.l=function(n,t){n.m(t)};_rw._TI.o=function(n,t){n.bf(t)};_rw._TI.bk=function(n,t){n.bb(t)};_rw._TI.p=function(n,t){n.k=t};_rw._TI.bh=function(n,t){n.i(t)};_rw._TI.bg=function(n,t){n.be(t)};_rw._TI.P=function(n,t){n.b=t};_rw._TI.O=function(n,t){n.a=t};_rw._TI.bm=function(n,t){n.by(t)};_rw._TI.R=function(n,t){n.bf(t)};_rw._TI.bl=function(n,t){n.cg(t)};_rw._TI.T=function(n,t){n.bG(t)};_rw._TI.S=function(n,t){n.bD(t)};_rw._TI.F=function(n,t){n.F(t)};_rw._TI.Z=function(n,t){n.cZ(t)};_rw._TI.G=function(n,t){n.J(t)};_rw._TI.X=function(n,t){n.cT(t)};_rw._TI.U=function(n,t){n.cH(t)};_rw._TI.bc=function(n,t){n.dq(t)};_rw._TI.bd=function(n,t){n.dr(t)};_rw._TI.ba=function(n,t){n.dc(t)};_rw._TI.Y=function(n,t){n.cY(t)};_rw._TI.bb=function(n,t){n.dd(t)};_rw._TI.b=function(){_rw._TI.f||(_rw._TI.f=new _fc.k);return _rw._TI.f};_rw._TI.t=function(){_rw._TI.e||(_rw._TI.e=new _rw.l);return _rw._TI.e};RecipientWellComponent.registerClass("RecipientWellComponent",null,_a.iR);_rw.h.registerClass("_rw.h");_rw.a.registerClass("_rw.a",_a.by,_y.fe);_rw.b.registerClass("_rw.b",_rw.a);_rw.e.registerClass("_rw.e",_a.by,_y.dr);_rw.g.registerClass("_rw.g",_rw.h,IRecipientWellViewModelFactory);_rw.k.registerClass("_rw.k",_js.b,_b.bW);_rw.l.registerClass("_rw.l",null,_js.S);_rw.d.registerClass("_rw.d",_fce.b);_rw.j.registerClass("_rw.j",_rw.d);_rw.i.registerClass("_rw.i",_js.b);_rw.f.registerClass("_rw.f",_fce.c);_rw.c.registerClass("_rw.c",_js.b);_rw._TI.registerClass("_rw._TI");RecipientWellComponent.$$cctor();_rw.b.c="ShowDLExpansionError";_rw.b.g=new RegExp("([.*+?${}/])","g");_rw.b.f=new RegExp("[\\w-\\.!#%&'=~`/\\$\\|\\?\\*\\+\\{\\}]+@[\\w-\\.]+");_rw.b.d=100;_rw.b.a=_a.a.T;_rw.e.a=_a.a.T;_rw.a.d=_a.a.T;_rw.a.c=null;_rw.a.a=-1;_rw.a.e=null;_rw.f.a=_a.a.T;_rw._TI._hf=_rw._TI.u();_rw._TI.f=null;_rw._TI.e=null;_rw._TI.a={};_rw._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.recipientwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.recipientwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
