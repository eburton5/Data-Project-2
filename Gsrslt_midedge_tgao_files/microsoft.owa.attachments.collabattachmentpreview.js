try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.attachments.collabattachmentpreview.js'] = (new Date()).getTime();
function CollabAttachmentPreviewComponent(){}CollabAttachmentPreviewComponent.$$cctor=function(){_a.p.a().a(CollabAttachmentPreviewComponent)};CollabAttachmentPreviewComponent.prototype={a:function(n,t,i){var f=this;n.b(_ad.k,function(){return new _ad.o(n.a(_y.a),n.a(_a.e),n.a(_g.a),n.a(IAttachmentDownloadUrlFactory),n.c(IMailComposeViewModelFactory),n.c(IMailComposeContextFactory),n.d(IMailComposeActionFactory),n.a(_bc.b),n.c(IDocumentAttachmentViewModelFactory),n.a(_y.ea),n.a(_y.eh),n.c(IModernGroupReadingPaneViewModelFactory),n.a(_ff.c),n.a(_a.t),n.a(_a.h),n.a(_a.q),n.d(IIntroductionControllerFactory),n.d(IImageAlbumViewModelFactory),n.a(IInferenceTracker),_at.f.b(),n.d(ICalendarItemDetailsViewModelFactory),n.d(IImportCalendarEventViewModelFactory),n.a(_y.v))});var e=this;n.b(IAttachmentViewModelPopoutFactory,function(){return new _ad.q(n.a(_ad.k))});var r=this;n.b(IAttachmentPreviewViewModelFactory,function(){var i=n.a(_y.a);var t;t=i.c()?n.a(_y.Z):i.b();return new _ad.p(i,n.a(_ad.k),t,n.a(_a.h))});var u=this;n.b(_ad.e,function(){return new _ad.e(window.document.createElement("div"),n.a(_y.a),n.a(_b.i),n.a(_b.a))})},b:function(){return[]}};Type.registerNamespace("_ad");_ad.k=function(){};_ad.k.registerInterface("_ad.k");_ad.u=function(n){_ad.u.initializeBase(this);this.c=n};_ad.u.prototype={c:null,a:0,s:function(n){var t=new _g.sV;t.AttachmentId=this.c;n.cK(t,new _g.OK(this.x),this.r,this.q)},cz:function(n,t,i){this.a=n.Result;if(this.a){_js.Trace.logWarning(_a.a.c,"SynchronizeWacAttachment returned {0}",this.a);i(Error.create("SynchronizeWacAttachment returned "+this.a))}else t()}};_ad.a=function(){_ad.a.initializeBase(this)};_ad.a.prototype={i:null,e:null,l:null,n:null,k:function(){return this.dS(_ad.a.h)},d:function(n){this.dR(_ad.a.h,n);return n},I:function(){return this.dS(_ad.a.o)},u:function(n){this.dR(_ad.a.o,n);return n},G:function(){return this.dS(_ad.a.g)},t:function(n){this.dR(_ad.a.g,n);return n},H:function(){return this.dS(_ad.a.n)},D:function(n){this.dR(_ad.a.n,n);return n},o:function(){return this.dS(_ad.a.c)},r:function(n){this.dR(_ad.a.c,n);return n},E:function(){return this.dS(_ad.a.d)},s:function(n){this.dR(_ad.a.d,n);return n},j:function(){return this.dS(_ad.a.b)},z:function(n){this.dR(_ad.a.b,n);return n},c:function(){return this.dS(_ad.a.a)},g:function(n){this.dR(_ad.a.a,n);return n},a:function(){return this.dS(_ad.a.m)},m:function(n){this.dR(_ad.a.m,n);return n},F:function(){return this.dS(_ad.a.e)},K:function(n){this.dR(_ad.a.e,n);return n},J:function(n){this.dR(_ad.a.q,n);return n},L:function(n){this.dR(_ad.a.r,n);return n},N:function(n){this.dR(_ad.a.s,n);return n},b:function(){return this.dS(_ad.a.p)},v:function(n){this.dR(_ad.a.p,n);return n},f:function(){return this.dS(_ad.a.f)},M:function(n){this.dR(_ad.a.f,n);return n},x:function(){return this.dS(_ad.a.i)},A:function(n){this.dR(_ad.a.i,n);return n},p:function(){return this.dS(_ad.a.k)},C:function(n){this.dR(_ad.a.k,n);return n},q:function(){return this.dS(_ad.a.l)},h:function(n){this.dR(_ad.a.l,n);return n},y:function(){return this.dS(_ad.a.j)},B:function(n){this.dR(_ad.a.j,n);return n},w:function(n){if(this.c()===2&&_g.l.isInstanceOfType(n)){var t=n;this.l="data:"+t.bl.ThumbnailMimeType+";base64,"+t.bl.Thumbnail}}};_ad.m=function(n){$a(n)||(this.a=n)};_ad.m.prototype={a:0,b:0,c:0,e:function(n,t){this.b=n;this.c=t},d:function(){this.a=0;this.b=0;this.c=0},toString:function(){var n=new Sys.StringBuilder("AttachmentLightBoxE2E");switch(this.a){case 1:n.append("Open");break;case 2:n.append("Update");break;case 3:n.append("Edit");break;default:break}switch(this.c){case 1:n.append("Classic");break;case 2:n.append("Cloud");break;default:break}switch(this.b){case 1:n.append("Image");break;case 2:n.append("Doc");break;case 3:n.append("SuiteExtensionsDoc");break;case 4:n.append("Media");break;default:break}return n.toString()}};_ad.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it){this.bT=Function.createDelegate(this,this.dH);this.cH=Function.createDelegate(this,this.cZ);this.cK=Function.createDelegate(this,this.ep);this.cI=Function.createDelegate(this,this.en);this.cJ=Function.createDelegate(this,this.eo);this.ct=Function.createDelegate(this,this.di);this.cG=Function.createDelegate(this,this.ei);this.cw=Function.createDelegate(this,this.dI);this.cB=Function.createDelegate(this,this.dJ);this.bR=Function.createDelegate(this,this.C);this.bO=Function.createDelegate(this,this.dg);this.bV=Function.createDelegate(this,this.dO);this.bW=Function.createDelegate(this,this.dP);this.bU=Function.createDelegate(this,this.dK);this.bX=Function.createDelegate(this,this.cq);this.bS=Function.createDelegate(this,this.dF);this.cD=Function.createDelegate(this,this.ee);this.cC=Function.createDelegate(this,this.ed);this.cv=Function.createDelegate(this,this.dG);this.cL=Function.createDelegate(this,this.eq);this.cM=Function.createDelegate(this,this.eu);this.cE=Function.createDelegate(this,this.eh);this.Q=Function.createDelegate(this,this.et);this.bP=Function.createDelegate(this,this.E);this.cs=Function.createDelegate(this,this.dh);this.cF=Function.createDelegate(this,this.cW);this.cu=Function.createDelegate(this,this.dm);this.bE=new _ff.e;_ad.b.initializeBase(this);this.b=n;this.c=t;this.bj=u;this.M=f;this.cf=e;this.ce=o;this.x=s;this.l=i;this.cr=r;this.e=c;this.a=l;this.r=a;this.bh=p;this.by=w;this.bc=v;this.F=y;this.cc=b;this.bD=k;this.G=d;this.bp=g;this.bk=nt;this.bl=tt;this.bF=it;this.bx=new _C(this.cu,_ad.b.a);this.cj=new _C(this.cF,_ad.b.a);this.bY=new _C(this.cs,_ad.b.a);this.R=new _C(this.bP,_ad.b.a);this.bZ=new _C(this.Q,_ad.b.a);this.bH=new _C(this.cE,_ad.b.a);this.bf=new _C(this.cM,_ad.b.a);this.cp=new _C(this.cL,_ad.b.a);if(y){this.p=y.a().L().Enabled;this.cd=y.a().d().Enabled}this.df(n);this.apcl("CollabStep",this.cv);this.a.i=this.p;this.a.apcl("ImageWidth",this.cC);this.a.apcl("ShowReadingPane",this.cD);this.by.b(_at.t,this.bS);this.ca=h;this.cg=this.bF.b;this.ch=this.e.l();this.e.A(1);if(this.c.x()||!this.c.p()){this.a.e(!1);this.a.f(!0);this.a.n(!0)}this.o=new _ad.m;if(this.cU(t)){this.g=new _ad.c(this.c,this.bX,this.bU,this.Q,this.c.f(),this.F,this.bD,this.G,this.A.a);var rt=_h.e.a().a(this.c.a().Id);this.T(rt,this.H);this.bb(1)}else if(this.cV(t)){this.bd=new _ad.h(this.c,this.Q,this.bW,this.c.f());this.bb(4)}else t.y()?this.bg(new _ad.d(this.b,this.c,this.x,this.M,this.G,this.bk,this.bl,this.R)):this.cQ();this.l.a()==="TouchWide"&&this.du();this.dw();this.r.a=this;this.dD()};_ad.b.prototype={cf:null,ce:null,bj:null,M:null,x:null,l:null,bc:null,F:null,by:null,p:!1,cd:!1,cc:null,bl:null,bk:null,G:null,bp:null,a:null,r:null,b:null,c:null,bx:null,cj:null,bY:null,R:null,bZ:null,bH:null,S:null,t:null,h:0,I:null,m:null,bN:null,U:null,Y:!1,J:null,A:null,d:null,bv:null,bw:null,bq:null,bi:null,cb:null,ci:null,cN:null,e:null,bF:null,bC:null,g:null,bd:null,X:!1,bf:null,bG:null,bu:null,ca:null,cr:null,L:null,bh:null,cp:null,be:null,y:null,bM:!1,z:null,bD:null,k:null,o:null,bs:!1,bt:!1,H:null,bB:null,ch:0,cg:!1,P:function(n){if(this.h!==n){this.h=n;this.dQ("CollabStep")}return n},bI:function(n){if(this.m!==n){this.m=n;this.dQ("DocumentConductor")}return n},bg:function(n){if(this.bC!==n){this.bC=n;this.dQ("IcsPreviewViewModel")}return n},bK:function(n){if(this.g!==n){this.g=n;this.dQ("ImagePreviewViewModel")}return n},bL:function(n){if(this.bd!==n){this.bd=n;this.dQ("MediaPreviewViewModel")}return n},ej:function(n){if(this.bE!==n){this.bE=n;this.dQ("ImageGallery")}return n},cT:function(){this.bN||(this.bN=new _y.D);return this.bN},bz:function(){return this.Y&&this.h===1},B:function(n){if(this.Y!==n){this.Y=n;this.dQ("IsEditable")}return n},bJ:function(n){if(this.bv!==n){this.bv=n;this.dQ("EditButtonText")}return n},ck:function(n){if(this.bw!==n){this.bw=n;this.dQ("EditButtonTitle")}return n},j:function(){return this.l.a()==="Mouse"?0:1},cS:function(){return this.a.a?this.cT():this.m},cX:function(n){this.y!==n&&(this.y=n);return n},cY:function(n){if(this.bM!==n){this.bM=n;this.dQ("ShouldShowIntroductionPeek")}return n},N:function(){if(!this.J)if(this.A.b)this.J=new _acw.h(this.b.bl.Name);else if(this.F&&this.F.a().bc().Enabled&&SuiteExtensionsControlFactory.CreateControl(this.W().replace(".",""),1)){this.J=new _acw.d(this.b.bl.Name);this.B(this.bz()||!!this.J&&this.J.a())}return this.J},dn:function(){return!this.l.c()||!!this.a.d},dq:function(){return this.a.c||this.dn()||this.c.b()===2||this.V()||this.p&&!this.a.a},bm:function(){return 1},q:function(){return null},n:function(){return this.S},f:function(n){this.S=n;return n},bn:function(){return!0},V:function(){return!!this.y&&this.y.br()},er:function(n,t,i,r){this.b=n;this.H=r;this.b&&this.cq(this.b.bl.AttachmentId);this.cX(i);this.c=t;this.c.F()&&this.L!==this.c.a()&&(this.L=this.c.a());this.df(n);if(this.cU(t)){this.K(!1);var u=new _ad.c(this.c,this.bX,this.bU,this.Q,this.c.f(),this.F,this.bD,this.G,this.A.a);this.bb(1);u.D(this.g?this.g.g:!1);u.k(this.g?this.g.h:!1);this.bK(u);this.d=null;this.bI(null);this.B(!1);this.bL(null);this.bg(null);var f=_h.e.a().a(this.c.a().Id);this.T(f,this.H)}else if(this.cV(t)){this.bL(new _ad.h(this.c,this.Q,this.bW,this.c.f()));this.bb(4);this.bg(null);this.bK(null);this.d=null;this.bI(null);this.B(!1)}else if(t.y()){this.bg(new _ad.d(this.b,this.c,this.x,this.M,this.G,this.bk,this.bl,this.R));this.bK(null);this.bL(null);this.d=null;this.bI(null);this.B(!1)}else{this.bg(null);this.bK(null);this.bL(null);this.d=null;this.cQ()}},bA:function(n,t,i){var u=_h.e.a();var r=u.a(n);$a(r)||$a(r.z())||i?this.dd(n,t,"getting item"):t(r)},em:function(n){this.ds(n.dp);for(var r=this.dp.c,f=r.length,t=0;t<f;++t){var i=r[t];if(i.b===_u.P.V){this.dp.q(i,1);break}}var u=new _y.f(_y.b.G(),_y.b.H(),_u.P.V,this.bf);this.dp.g(u,1,!0)},di:function(){var n=_a.d.b(_ad.b.a,"AttachmentLightboxCloseByBackButton");var t=this.D();this.d.A();this.de();n.j=t;_a.d.a(n)},E:function(){this.C("LightBoxClosingBeforeWacLoaded");if(!this.ec){this.cq(null);this.K(!1);this.r.e();if(this.h===3||this.h===4){var n=_a.d.b(_ad.b.a,"AttachmentLightboxCloseEdit");n.j=this.bs?"ClosedByBackButton":this.bt?"ClosedBySendingMessage":"DiscardedFromComposeForm";_a.d.a(n)}if(this.S){var t=_a.d.b(_ad.b.a,"AttachmentLightboxClose");this.S();_a.d.a(t)}}},D:function(){if(this.ec||this.a.d&&this.a.d.closed)return"";var n=new _a.r;n.a("W",this.a.b);n.a("E",this.a.c?1:0);if(this.b){n.a("S",this.b.a()/1e3);n.b("T",this.W());n.a("R",_g.m.isInstanceOfType(this.b)?1:0)}else{n.b("S","");n.b("T","");n.b("R","")}if(this.c){n.a("M",this.c.b());n.b("C",_a.dp.toString(this.c.c()))}else{n.b("M","");n.b("C","")}return n.toString()},co:function(){return this.dA()&&(!this.F||!this.F.a().bS().Enabled)||!this.A.c&&(!this.N()||Object.getType(this.N())===_acw.h)||!!this.N()&&!this.N().a()},K:function(n){this.z&&this.z.a(n)},db:function(){this.z&&this.z.b()},cm:function(n){if(this.k!==n){this.k&&this.w("PreviewChangedBeforeLoadingFinished");this.k=n}},cl:function(n){$a(this.o)?this.o=new _ad.m(n):this.o.a=n},bb:function(n){this.o.e(n,_g.m.isInstanceOfType(this.b)?2:1)},dT:function(){if(!this.ec){this.e.A(this.ch);this.bF.c(this.cg);this.a.dispose();this.a=null;this.r.dispose();this.r=null;this.by.c(_at.t,this.bS);this.e.d()&&this.e.d().b()&&this.e.d().b().dz(this.bV);this.e.dispose();this.z&&this.z.e(this.bO);_a.jV.prototype.dT.call(this)}},df:function(n){this.A=this.b?this.bp.a(this.W(),n.bl.ContentType,_y.G.f(this.l,this.cr),n.bl.IsSmimeDecoded||n.n()):new _at.E(!1,1,!1,!1,!1,!1);if(this.l.a()!=="Mouse"){this.B(!1);return}if(this.c.b()===2&&this.l.a()!=="Mouse"){this.B(!1);return}if(this.c.x()||!this.c.p()){this.B(!1);return}this.b?this.p?this.B(this.bp.b()>0):this.B(this.A.c||this.dB()):this.B(!1)},cQ:function(){if(this.bu)this.cP();else{var n=this;this.ca.a(function(t){if(t){n.bu=t;n.cP()}})}},cP:function(){if(this.b){var i=_g.m.isInstanceOfType(this.b);this.d=this.bu.a(this.b.bl.AttachmentId.Id,this.A.b,this.A.f,i,this.c.b(),this.bB,this.V(),this.N());if(this.m)this.m.d(this.d);else{var r=new _y.D;r.d(this.d);this.bI(r)}this.bz()&&!this.co()?this.db():this.K(!1);var n=this;var u=function(t){n.t=t;if(t)if(_g.m.isInstanceOfType(n.b)&&n.b.bl.ProviderType===_g.cg.toString(1)){n.bJ(_ad.B.a);n.ck(_ad.B.U)}else if(n.p){n.bJ(n.t.IsInDraft?_ad.B.d:_ad.B.m);n.ck(n.t.IsInDraft?_ad.B.e:_ad.B.B)}else if(_g.m.isInstanceOfType(n.b))n.bJ(_ad.B.I);else{n.bJ(n.t.IsInDraft?_ad.B.S:_ad.B.j);n.ck(n.t.IsInDraft?_ad.B.e:_ad.B.G)}n.P(1)};this.bb(this.N()&&Object.getType(this.N())===_acw.d?3:2);i&&this.C("NoPostMessageForCloudDoc");var t=this;this.d.G(u,function(n){t.da(n);t.w(n.j)},this.bR)}},cU:function(n){return n.c()===1||n.c()===2},cV:function(n){return n.c()===7},dm:function(){this.cl(3);this.cm(_a.d.b(_ad.b.a,"AttachmentLightBoxE2E"));this.bb(2);if(this.ec){this.w("LightBoxDisposed");return}if(this.co()){this.x.a(0,_ad.B.W);this.w("EditingNotCurrentlySupported");return}if(_g.m.isInstanceOfType(this.b)){var i;var t;var f,u,e;if(e=_ad.g.b(this.b.bl.AttachLongPathName,f={val:i},u={val:t}),i=f.val,t=u.val,e){window.open(String.format("https://onedrive.live.com/view.aspx?resid={0}&authkey={1}",i,t),"_blank");this.C("OneDriveEditNewWindow");return}}if(this.dx()){this.x.a(0,_ad.B.k);this.w("AttachmentTooLarge");return}this.K(!0);_y.j.b(_ad.b.a,"EditACopy");this.G&&this.y&&this.y.a()&&this.G.z(this.y.a(),this.W(),_g.m.isInstanceOfType(this.b));if(!this.a.a){this.a.e(!0);this.a.f(!0)}if(this.t.IsInDraft&&this.b){this.U=this.b.bl.Name;this.r.e()}else{var r=_a.d.b(_ad.b.a,"CreateACopy");this.U=this.dr(this.b.bl.Name);this.I=_g.m.isInstanceOfType(this.b)?new _ad.i(_ad.B.A,""):new _ad.i(_ad.B.g,this.U);this.m.d(this.I);this.P(2);var o=this.D();r.j=o;_a.d.a(r)}this.d.N();if(this.h===2){var n=this;_js.g.a().a(_ad.b.a,"AttachmentLightBoxViewModel:EditDocument",function(){if(n.ec){n.w("LightBoxDisposed");return}n.cO()},2e3)}else this.cO();_g.m.isInstanceOfType(this.b)&&this.C()},cO:function(){if(this.t.IsInDraft||this.r.d())this.cR();else{var n=this;this.cf.a(function(t){var i=t.a(!1,!1);i.e(2);i.k(!0);i.dv(!0);var r=new _g.bh;r.Mailbox=new _g.d;r.Mailbox.EmailAddress=n.bj.c().bl.UserEmailAddress;r.Mailbox.Name=n.bj.c().bl.UserDisplayName;r.Mailbox.MailboxType="Mailbox";r.Mailbox.RoutingType="SMTP";i.dF(r);n.bA(n.c.a().Id,function(t){i.N(t);var r;r=n.bc.a()||i.f()!=="HTML"?i.f()==="Text"?_h.b.m():_h.b.c():_h.b.K();n.ce.a(function(t){var u=t.c(i,r,n.bc);u.Q=!1;u.w(n.cB);u.v(n.cw);if(n.c.b()===2){var f=n.e.J();u.J=f?f.bl.SmtpAddress:null}n.bh.a(u)})},!1)})}},dO:function(n,t){this.E()},cR:function(){var n=this;var i=function(t){if(n.ec){n.w("LightBoxDisposed");return}n.t=t;n.h===2&&n.m.c();n.P(3);_y.j.a(null,"EditACopy","","",n.D());n.r.d()?n.d.g&&n.r.m():n.a.a&&n.cW()};var t=this;this.d.M(i,function(n){if(t.ec){t.w("LightBoxDisposed");return}_y.j.a(null,"EditACopy",t.d.h);t.da(n);t.w(n.j)},this.bR)},dI:function(n){_js.Trace.logWarning(_ad.b.a,"Create reply action failed.");var t=null;_g.X.a(n.t)&&(t=n.t.FaultMessage);this.w(n.D(),t);var i=this;this.x.a(0,t,function(n,t){i.E()})},dJ:function(n){this.be=n.d;_js.Trace.logInfo(_ad.b.a,"New draft item is "+this.be.Id);if(this.d){this.d.g=this.be.Id;this.cR()}},cW:function(){_y.j.b(_ad.b.a,"ReplyWithChanges");this.a.a||this.d.A();this.r.l()},dh:function(){_y.j.b(_ad.b.a,"GoBackToChanges");var n=this.D();this.d.H();this.l.a()==="Mouse"?this.m.c():this.r.k();this.P(3);_y.j.a(null,"GoBackToChanges","","",n)},dd:function(n,t,i){var u=new _g.g(n);var r=new _h.cA(100,[u],this.bc.a()?_h.b.c():_h.b.m(),"MailCompose",0,this.V());var e=this;r.w(function(r){var u=_h.e.a().a(n);if(u)_js.Trace.logInfo(_a.a.c,"Successfully retrieved item when {0}.",i);else{u=r.n();u?_js.Trace.logInfo(_a.a.c,"Successfully retrieved item with fallback when {0}.",i):_js.Trace.logWarning(_a.a.c,"Action succeeded but item not cached when {0}.",i)}t(u)});var f=this;r.v(function(n){_js.Trace.logWarning(_a.a.c,"Unable to retrieve item when {0}.",i)});this.bh.a(r)},dc:function(){this.I=_g.m.isInstanceOfType(this.b)?new _ad.i(_ad.B.h,""):new _ad.i(_ad.B.L,this.U);this.m.d(this.I)},eu:function(){this.bt=!0;this.dc();var n=5e3;_js.g.a().a(_a.a.c,"WaitSaveAndSend",this.cG,n)},et:function(){this.bs=!0;if(this.h===3||this.h===4){this.dc();var n=5e3;_js.g.a().a(_a.a.c,"WaitSaveAndCloseByBackButton",this.ct,n)}else this.E()},de:function(){var t=this.d.e;_js.Trace.logInfo(_ad.b.a,"Submitting sync action for attachment {0}.",t);var n=new _ad.u(t);n.w(this.cJ);n.v(this.cI);this.bh.a(n)},ei:function(){_y.j.b(_ad.b.a,"SaveAndSendChanges");var n=this.D();this.I.d(_ad.B.b);this.d.A();this.de();_y.j.a(null,"SaveAndSendChanges","","",n)},eo:function(n){_js.Trace.logInfo(_ad.b.a,"Sync action succeeded.");this.m.c();if(this.bt){this.bG.a();this.c.b()===2&&this.E()}else this.E()},en:function(n){_js.Trace.logWarning(_ad.b.a,"Sync action failed.");this.m.c();this.d.H();if(!n.A){this.x.a(0,_ad.B.P,null);return}var t=_ad.B.C;this.bs&&(t=_ad.B.M);this.x.a(0,t,null)},ed:function(n,t){this.g&&this.g.Q(this.a.b);this.p&&this.dQ("ShouldHidePopoutButton")},ee:function(n,t){if(this.g)if(this.g.a&&this.g.a.d.length>1&&(this.X||!this.a.a)){this.g.D(!0);this.g.k(!this.a.a)}else{this.g.D(!1);this.g.k(!1)}},dG:function(n,t){_js.Trace.logInfo(_ad.b.a,"Collab step changed to {0}",this.h);if(this.l.a()==="Mouse"&&!this.l.c()&&this.b)switch(this.h){case 1:window.document.title=String.format(_ad.B.V,this.b.bl.Name);break;case 2:case 3:window.document.title=String.format(_ad.B.T,this.U);break;case 4:break;default:break}else if(this.l.a()==="TouchWide"&&this.Y)switch(this.h){case 1:this.cn(this.cb);break;case 2:this.cn(null);break;case 3:this.cn(this.ci);break;default:break}this.a.m(this.h===3||this.h===4);this.dQ("ShouldHidePopoutButton");this.dQ("IsEditable")},cn:function(n){for(var r=this.dp.c,u=r.length,t=0;t<u;++t){var i=r[t];i!==this.bq&&i!==this.bi&&this.dp.q(i,1)}n&&this.dp.g(n,1,!0)},dr:function(n){return String.format(_ad.B.Y,_a.bf.b(n),this.bj.c().bl.UserDisplayName,_a.bf.a(n))},da:function(n){if(this.d===n){var t=this;this.x.a(0,this.d.h,function(n,i){t.E()})}else _js.Trace.logWarning(_ad.b.a,"The documentAttachmentViewModel from the failure callback is not the same as the current documentAttachmentViewModel. ShowError() did not display any message.")},du:function(){if(this.Y){this.cb=new _y.f(_y.b.bi(),_y.b.bj(),_u.P.F,this.bx);this.ci=new _y.f(_y.b.bY(),_y.b.bZ(),_u.R.Td,this.cj);this.cN=_y.f.b(this.bY)}var t=new _C(this.cK,_ad.b.a);this.bi=new _y.f(_y.b.cl(),_y.b.cm(),this.a.a?_ad.B.c:_ad.B.H,t);this.bq=_y.f.a(_nbs.a.Qu,this.R);var i=[this.bi,this.bq];var n=_y.i.a(this,i,null);n.G(!1);this.ds(n)},dw:function(){if(this.c.a()){if(this.c.i)this.ek(this.c.i,this.c.a());else{var n=this.c.a().Id;if(_h.e.a().d(n)){_h.e.a().e(n);var i=_h.e.a().a(n);this.cZ(i)}else this.dd(n,this.cH,"initializing reading pane")}if(this.c.b()===2){this.bB=this.e.bM().d().Id;var t=_g.N.e(this.bB);this.e.bq(t)}}},cZ:function(n){this.e.y(n);this.T(n,this.H);n.dw(this.bV)},ek:function(n,t){this.e.y(n);this.L=t;var i=_h.e.a().a(t.Id);i&&this.T(i,this.H);this.e.b()&&this.e.b().apcl(this.e.b().c(),this.bT)},dH:function(n,t){this.e.b().rpcl(this.e.b().c(),this.bT);if(this.L){var u=_h.e.a().a(this.L.Id);u&&this.T(u,this.H);for(var i=0;i<this.e.b().b().x.length;i++){var r=this.e.b().b().x[i];if(r.a()&&r.a().bl.ItemId.Id===this.L.Id){this.e.b().t(r);break}}}},T:function(n,t){var i=new _ff.e;t?this.dk(t,i):n&&this.dj(n,i);var r=i.d.length;if(r>0){this.ej(i);if(this.g){this.g.bq(this.bE);if(r>1&&this.X){this.g.D(!0);this.g.k(!this.a.a);this.p&&this.g.V()}}}},dk:function(n,t){if(n){this.X=!0;for(var r=0;r<n.length;r++){var i=new _ad.a;i.d(n[r].ImageUrl);i.n=new _at.p(n[r].ThumbnailUrl,null,150,150,!1);i.m(null);i.g(2);i.h(!0);t.c(i)}}},dj:function(n,t){this.X=!0;if(n.U()&&n.U().c&&n.U().c.b()>0)for(var h=n.U().c,f=0;f<h.b();f++){var e=h.c(f);var i=_g.Attachment.isInstanceOfType(e)?e:_g.Attachment.a(e);if(!i.b()){var u;var c,s;if(s=_y.G.c(i,c={val:u}),u=c.val,s){var r=new _ad.a;r.m(n.bl.ItemId);r.g(u);r.r(i.bl.Name);r.s(i.a());r.z(i.bl.AttachmentId);if(_g.m.isInstanceOfType(i)){this.cd?r.d(i.bl.AttachmentPreviewUrl):r.d(i.bl.AttachLongPathName);r.u(i.bl.AttachLongPathName);r.h(!0)}else{r.d(this.M.a(i.bl.AttachmentId,this.V(),_g.U.h()));r.t(this.M.a(i.bl.AttachmentId,this.V(),_g.U.a()));if(u===2&&_g.l.isInstanceOfType(i)){var o=i;var l="data:"+i.bl.ThumbnailMimeType+";base64,"+i.bl.Thumbnail;r.n=new _at.p(l,o.C(),o.A(),o.s(),!1)}r.e=this.M.a(i.bl.AttachmentId,this.V(),_g.U.g());r.w(i)}t.c(r)}else this.X=!1}}},eh:function(){if(!this.ec){_y.j.b(_ad.b.a,"AttachmentLightBoxPopOut");var i=this.D();var n={};if(this.b){var t=new _g.dj;t.AttachmentId=this.b.bl.AttachmentId;t.Name=this.b.bl.Name;n.AttachmentJson=JsonParser.serialize(t)}else n.AttachmentJson="";this.c.M(!0);n.Context=JsonParser.serialize(this.c.dM());this.l.t(IAttachmentViewModelPopoutFactory,null,n,_bc.c.c());this.E();_y.j.a(null,"AttachmentLightBoxPopOut","","",i)}},ep:function(){var t=this.a.a;var i=this.D();var r=t?"AttachmentLightboxHideReadingPane":"AttachmentLightboxShowReadingPane";var n=_a.d.b(_ad.b.a,"AttachmentLightboxHideReadingPane");this.a.e(!this.a.a);this.bi.g(this.a.a?_ad.B.c:_ad.B.H);this.a.f(!0);n.j=i;_a.d.a(n)},eq:function(){this.K(!1);this.ec||this.a.f(!0)},cq:function(n){_js.Trace.logInfo(_a.a.c,"AttachmentLightBoxViewModel.UpdateSelectedAttachment Id ={0}",n?n.Id:"null");this.y&&this.y.t(n)},dF:function(n){_js.Trace.logInfo(_a.a.c,"AttachmentLightBoxViewModel.OnAttachmentWellCreated");if(this.b&&n.a){var t=this.b.bl.AttachmentId;this.t&&(t=this.t.AttachmentId);if(n.a.t(t)){_js.Trace.logInfo(_a.a.c,"AttachmentLightBoxViewModel set AttachmentWellViewModel");this.cX(n.a)}}},dD:function(){if(_y.k.b(4)){var n=this;this.cc.a(function(t){n.z=t.a(_ad.B.N,_ad.B.K,8,null,null,4);n.cY(!0);n.z.d(n.bO)})}},dg:function(){this.cY(!1)},W:function(){return _a.bf.a(this.b.bl.Name)},dA:function(){if(!this.b)return!1;var n=this.W().toLowerCase();switch(n){case".xls":case".xlsx":case".xlsm":case".xlsb":return!0;default:return!1}},dB:function(){if(!this.b)return!1;var n=this.W().toLowerCase();switch(n){case".xls":case".doc":case".ppt":return!0;default:return!1}},dx:function(){return this.b?this.b.a()>=7340032:!1},dK:function(){this.C()},dP:function(){this.C()},C:function(n){if(this.k){this.o&&(this.k.p=this.o.toString());n&&(this.k.j=n);_a.d.a(this.k);this.k=null;this.o.d()}},w:function(n,t){if(this.k){if(this.o){if(+new Date-this.k.m.l<=3e3&&n==="PreviewChangedBeforeLoadingFinished"){this.C();return}this.k.p=this.o.toString()}this.k.k=n;this.k.n=t;_a.d.a(this.k);this.k=null;this.o.d()}},el:function(n){this.H=n;this.T(null,n)},dt:function(){this.a.e(!1);this.a.f(!0);this.g.k(!0)}};_ad.o=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){this.f=n;this.x=t;this.y=i;this.l=r;this.d=f;this.t=u;this.s=e;this.u=o;this.k=s;this.g=h;this.v=c;this.b=l;this.c=a;this.m=v;this.n=y;this.w=p;this.r=w;this.o=b;this.q=k;this.j=d;this.h=g;this.i=nt;this.p=tt};_ad.o.prototype={f:null,x:null,y:null,l:null,t:null,d:null,s:null,u:null,m:null,n:null,g:null,v:null,k:null,c:null,w:null,j:null,r:null,o:null,b:null,q:null,e:null,h:null,i:null,p:null,a:function(n,t,i,r){var u=null;switch(t.b()){case 0:u=this.g.a();break;case 1:u=this.v.b();break;case 2:if(!this.e){var f=this;this.b.d(function(){f.e=f.b.b()});this.b.a(null)}u=this.e.a();break;default:Error.invalidOperation("Unsupported reading pane: "+t.b());return null}u.bx(r);return new _ad.b(n,t,this.f,this.x,this.y,this.l,this.d,this.s,this.u,this.k,u,this.z(this.f,i),this.A(t.b()),this.m,this.n,this.w,this.c,this.r,this.o,this.q,this.j,this.h,this.i,this.p)},z:function(n,t){switch(n.a()){case"TouchWide":return new _ad.n(t);case"Mouse":return new _ad.t(t);case"TouchNarrow":default:throw Error.notImplemented("Lightbox only supports mouse and touchwide");}},A:function(n){return n===2?new _ad.r:new _ad.s(this.t,this.d,this.c)}};_ad.g=function(n,t,i,r,u,f,e){_ad.g.initializeBase(this);this.d=n;this.f=t;this.h=i;this.m=r;this.g=u;this.k=f;this.n=e?e.a().cH().Enabled:!1};_ad.g.b=function(n,t,i){t.val=null;i.val=null;if(!n||!n.startsWith("https://onedrive.live.com/"))return!1;var u;var s;var o,h;_a.A.n(n,o={val:s},h={val:u}),s=o.val,u=h.val;var c=_a.A.f(u);var f=c;for(var e in f){var r={key:e,value:f[e]};r.key==="resid"?t.val=r.value:r.key==="authkey"&&(i.val=r.value)}return!!t.val&&!!i.val};_ad.g.prototype={h:null,d:null,f:null,m:null,g:null,e:null,k:null,n:!1,l:function(n){if(this.e!==n){this.e=n;this.dQ("AttachmentLightBoxViewModel")}return n},b:function(){var t=_a.d.b(_ad.g.a,"AttachmentLightBoxE2E");if(this.g.a()&&_y.e.isInstanceOfType(this.g.a())){var i=this.g.a();if(i.g&&i.g.c()&&_y.m.isInstanceOfType(i.g.c())){var a=i.g.c();a.c().c(null,null)}}if(!this.d.Y){_js.Trace.logWarning(_ad.g.a,"Preview failed, Attachment is null.");t.k="NullAttachment";_a.d.a(t);return}if(!this.d.Y.bl.AttachmentId){_js.Trace.logWarning(_ad.g.a,"Preview failed, AttachmentId is null.");t.k="NullAttachmentId";_a.d.a(t);return}if(!this.n&&this.d.ba()===3){var u;var r;var h,s,c;if(c=_ad.g.b(this.d.bh,h={val:u},s={val:r}),u=h.val,r=s.val,c){window.open(String.format("https://onedrive.live.com/view.aspx?resid={0}&authkey={1}",u,r),"_blank");return}}if(this.a()){var f=_a.d.b(_ad.g.a,"AttachmentLightBoxUpdate");this.l(this.r());this.e.cm(t);this.e.cl(2);this.w(null,this.d.Z,null);var v=this.t();f.j=v;_a.d.a(f)}else{var e=_a.d.b(_ad.g.a,"AttachmentLightBoxPreView");var n=new _ad.a;n.g(this.d.ba());if(n.c()!==3){n.d(this.d.bQ());n.u(this.d.eF());n.t(this.d.dl());n.e=this.d.dm();n.D(this.d.dr())}n.r(this.d.Y.bl.Name);n.s(this.d.Y.a());n.C(this.p(this.f));n.h(_g.m.isInstanceOfType(this.d.Y));n.w(this.d.Y);if(this.f){n.v(this.f.b());n.A(!!this.f.a()&&this.f.a().hS())}n.B(this.d.eA());var o;this.o(this.d.Z,o={val:n}),n=o.val;this.l(this.m.a(this.d.Y,n,this.k,this.d.bs));this.e.cm(t);this.e.cl(1);this.q(n);var l=this.t();e.j=l;_a.d.a(e)}},x:function(n,t){var i=new _ad.a;i.g(2);i.d(n);i.C(this.p(this.f));i.h(!0);i.A(!1);this.f&&i.v(this.f.b());var r;this.o(t,r={val:i}),i=r.val;return i},q:function(n){var t=this;this.e.S=function(){if(t.e){t.e.dispose();var n=t.e;t.l(null);_js.g.a().a(_a.a.c,"AttachmentPreviewViewModel.DisplayLightBox.ClosePopupCommand",function(){n.dispose();n=null},5e3)}t.a()&&t.g.c()};n.p()?this.g.d(this.e):this.e.bH.a()},c:function(n,t,i){var r=this.x(n[t].ImageUrl,i);if(this.a()){this.l(this.r());this.w(r,i,n)}else{this.l(this.m.a(null,r,this.k,!1));this.e.el(n);this.q(r);this.e.a.a&&this.e.dt()}},a:function(){return this.h.c()||this.k?!!this.g.a()&&_y.bd.isInstanceOfType(this.g.a()):!!this.h.b().a()&&_y.bd.isInstanceOfType(this.h.b().a())},w:function(n,t,i){var r=this.e;if(r){var e=r.h;if(e===3||e===4){var o=_a.d.b(_ad.g.a,"AttachmentLightboxCloseEdit");o.j="LightboxUpdated";_a.d.a(o)}r.P(1);if(!n){n=new _ad.a;n.d(this.d.bQ());n.u(this.d.eF());n.t(this.d.dl());n.e=this.d.dm();n.D(this.d.dr());n.g(this.d.ba());n.r(this.d.Y.bl.Name);n.s(this.d.Y.a());n.z(this.d.Y.bl.AttachmentId);n.h(_g.m.isInstanceOfType(this.d.Y));n.w(this.d.Y);n.B(this.d.eA());var u;this.o(t,u={val:n}),n=u.val}var f=null;this.d&&(f=this.d.Y);this.e.er(f,n,t,i)}},r:function(){return this.h.c()||this.k?this.g.a():this.h.b().a()},o:function(n,t){if(n&&t.val){t.val.m(n.a());var i=n.h();if(i){if(i.c()){t.val.K(i.c().bl.ConversationId.Id);t.val.J(i.c().bl.ConversationId.ChangeKey);t.val.L(i.c().c())}t.val.i=i.c();t.val.N(i.k());t.val.v(i.b())}}},t:function(){var n=new _a.r;var t=!!this.d&&!!this.d.Z&&!!this.d.Z.c();n.a("W",t?1:0);if(this.e){if(this.e.a){n.a("Wi",this.e.a.b);n.a("E",this.e.a.c?1:0)}if(this.e.b){n.a("S",this.e.b.a());n.b("T",_a.bf.a(this.e.b.bl.Name));n.a("R",_g.m.isInstanceOfType(this.e.b)?1:0)}if(this.e.c){n.a("M",this.e.c.b());n.b("C",_a.dp.toString(this.e.c.c()))}}return n.toString()},p:function(n){if(!n)return!1;var t=n.a()?_g.x.a(n.a().bl.ItemClass):n.j();return!t||t===1||t===7}};_ad.p=function(n,t,i,r){this.e=n;this.b=t;this.c=i;this.d=r};_ad.p.prototype={e:null,b:null,c:null,d:null,a:function(n,t,i,r){return new _ad.g(n,t,this.e,this.b,i||this.c,r,this.d)}};_ad.q=function(n){this.c=n};_ad.q.prototype={c:null,b:function(n,t,i){if("AttachmentJson"in n){var f=n.AttachmentJson;var u=null;f!==""&&(u=_g.l.a(f));var r=new _ad.a;r.dN(JsonParser.deserialize(n.Context));return this.c.a(u,r,t,!1)}else if("AttachmentId"in n&&"AttachmentName"in n&&"ItemId"in n){var s=n.AttachmentId;var o=n.AttachmentName;var e=n.ItemId;return this.d(s,o,e)}else throw Error.argument(String.format("Could not instantiate AttachmentViewModelFactory. Parameters don't include key {0} or some or all of the parameters for Delve (AttachmentId, AttachmentName,ItemId). The parameters received were: {1} AttachmentJson",n.toString()));},d:function(n,t,i){if(_js.d.a(n)){_js.Trace.logInfo(_a.a.c,"RestoreDocumentsFromParameters method received null attachmentId from Delve");return null}if(_js.d.a(i)){_js.Trace.logInfo(_a.a.c,"RestoreDocumentsFromParameters method received null itemId from Delve");return null}var f=new _g.dj;var o=new _g.bI(n);var r=new _g.l(f);r.g(o);r.e(t);var e=new _g.g(i);var u=new _ad.a;u.m(e);return this.c.a(r,u,null,!1)},a:function(n,t,i){throw Error.notImplemented();}};_ad.h=function(n,t,i,r){this.h=Function.createDelegate(this,this.i);this.j=-1;_ad.h.initializeBase(this);this.k(n.H());this.d=t;this.g=r;this.e=new _C(this.h,_a.a.c);this.b=i};_ad.h.prototype={e:null,d:null,g:!1,c:null,a:!1,b:null,k:function(n){if(this.c!==n){this.c=n;this.f(!0);this.dQ("MediaUrl")}return n},f:function(n){if(this.a!==n){this.a=n;!this.a&&this.b&&this.b()}return n},i:function(){this.d()}};_ad.i=function(n,t){_ad.i.initializeBase(this);this.d(n);this.e(t);this.f(!0)};_ad.i.prototype={a:null,b:null,c:!1,d:function(n){if(this.a!==n){this.a=n;this.dQ("Message")}return n},e:function(n){if(this.b!==n){this.b=n;this.dQ("FileName")}return n},f:function(n){if(this.c!==n){this.c=n;this.dQ("IsLoading")}return n}};_ad.d=function(n,t,i,r,u,f,e,o){this.n=Function.createDelegate(this,this.J);this.z=Function.createDelegate(this,this.I);this.y=Function.createDelegate(this,this.F);this.x=Function.createDelegate(this,this.A);_ad.d.initializeBase(this);this.b=n;this.r=t;this.j=o;this.m=i;this.v=r;this.k=u;this.p=f;this.q=e;this.o=new _C(this.x,_ad.d.a);this.t=new _C(this.y,_ad.d.a);this.E()};_ad.d.prototype={q:null,p:null,k:null,v:null,m:null,r:null,o:null,t:null,j:null,b:null,e:null,c:null,f:null,a:null,i:null,l:!1,h:null,g:null,d:null,G:function(){return this.i||_nbs.a.Pq},C:function(n){if(this.i!==n){this.i=n;this.dQ("AddToCalendarCommandText")}return n},D:function(n){if(this.l!==n){this.l=n;this.dQ("IsActionExecuting")}return n},H:function(){return this.v.a(this.b.bl.AttachmentId,!1,_g.U.a())},K:function(n){if(n!==this.c){this.c&&this.c.dispose();this.c=n;this.dQ("CalendarItemDetailsViewModel")}return n},F:function(){var i=_a.d.b(_ad.d.a,"DownloadIcsAttachmentFromSxS",!0);if(this.k){var t=_g.m.isInstanceOfType(this.b);var n=_a.bf.a(this.b.bl.Name);this.k.b(this.r.a(),"Downloaded",n,t)}_a.d.a(i)},E:function(){this.h=_a.d.b(_ad.d.a,"PreviewIcs",!0);this.g=_a.d.b(_ad.d.a,"ConvertIcsToCalendarItem",!0);if(this.a)this.B();else{var t=this;this.q.a(function(n){t.a=n.a();t.B()})}if(this.e)this.w();else{var n=this;this.p.a(function(t){n.e=t;n.w()})}},B:function(){this.a.a(this.b.bl.AttachmentId.Id);this.a.g(this.z)},I:function(n,t){if(_js.d.a(n)){_a.d.a(this.g);this.f=t;this.w()}else{this.g.n=n;_a.d.a(this.g);this.h.n=n;_a.d.a(this.h);var i=this;this.m.a(2,n,function(n,t){n&&i.A()})}},w:function(){if(this.f&&this.e){this.f.z().c("HTML");var n=this;this.K(this.e.c(this.f,function(t){_a.d.a(n.h)},!0))}},A:function(){this.d=_a.d.b(_ad.d.a,"AddIcsToCalendarFromSxs",!0);this.D(!0);this.C(_nbs.a.Kb);this.a.e(this.b.bl.Name);this.a.a(this.b.bl.AttachmentId.Id);this.a.b(this.n);this.a.c()},J:function(n){this.D(!1);this.C(_nbs.a.Pq);this.a.d(this.n);if(_js.d.a(n)){_a.d.a(this.d);this.j.a()}else{this.d.n=n;_a.d.a(this.d);this.m.a(0,_nbs.a.Iv)}}};_ad.c=function(n,t,i,r,u,f,e,o,s){this.F=Function.createDelegate(this,this.bj);this.Y=Function.createDelegate(this,this.bk);this.W=Function.createDelegate(this,this.bf);this.X=Function.createDelegate(this,this.bg);this.Z=Function.createDelegate(this,this.bl);this.ba=Function.createDelegate(this,this.bm);this.m=-1;_ad.c.initializeBase(this);if(f){this.f=f.a().L().Enabled;this.p=f.a().bl().Enabled;this.L=f.a().d().Enabled}this.K=e;this.U=t;this.T(n,!0);this.bd(n.q());this.B=i;this.G=r;this.J=u;this.A=o;this.C=s;this.E=new _y.bS;this.P=new _C(this.ba,_a.a.c);this.N=new _C(this.Z,_a.a.c);this.I=new _C(this.X,_a.a.c);this.H=new _C(this.W,_a.a.c);this.M=new _C(this.Y,_a.a.c);this.h=!1};_ad.c.prototype={A:null,P:null,N:null,I:null,H:null,M:null,U:null,f:!1,E:null,i:null,a:null,o:null,v:0,b:null,x:null,z:null,y:null,g:!1,t:!1,r:!1,c:0,q:!1,j:!1,K:null,w:null,e:null,B:null,p:!1,h:!1,G:null,J:!1,l:!1,L:!1,C:0,D:function(n){if(this.g!==n){this.g=n;this.dQ("ShowPrevNextButtons")}return n},S:function(n){if(this.t!==n){this.t=n;this.dQ("ShowPrevButton")}return n},R:function(n){if(this.r!==n){this.r=n;this.dQ("ShowNextButton")}return n},V:function(){if(this.g)if(this.c)if(this.c===this.a.d.length-1){this.S(!0);this.R(!1)}else{this.S(!0);this.R(!0)}else{this.R(!0);this.S(!1)}},br:function(n){if(this.b!==n){this.n(!0);this.b=n;this.dQ("ImagePreviewUrl")}return n},bp:function(n){if(this.x!==n){this.x=n;this.dQ("ImageDownloadUrl")}return n},Q:function(n){if(this.m!==n){this.m=n;this.dQ("ReadingPaneSize")}return n},bh:function(){return!(this.L&&this.j)},bq:function(n){if(this.a!==n){this.a=n;if(this.a.d.length>1)for(var t=0;t<this.a.d.length;t++)if(this.j){if(this.a.d[t].k()===this.b){this.c=t;break}}else if(this.a.d[t].j()&&this.b.indexOf(encodeURIComponent(this.a.d[t].j().Id))!==-1||!this.a.d[t].j()&&this.a.d[t].k()===this.b){this.c=t;break}this.p&&this.be()}return n},bn:function(n){if(this.o!==n){this.o=n;this.dQ("CurrentImageAttachmentName")}return n},d:function(){if(!this.p)return null;this.e||this.bb();return this.e},bs:function(n){if(this.e!==n){this.e&&this.e.rpcl("SelectedItem",this.F);this.e=n;this.e&&this.e.apcl("SelectedItem",this.F);this.dQ("ImageStripViewModel")}return n},k:function(n){if(this.h!==n){this.h=n&&this.p?!0:!1;this.dQ("ShowFilmstrip")}return n},bj:function(n,t){this.dQ("SelectedImageInFilmstrip")},bo:function(n){if(this.v!==n){this.v=n;this.dQ("CurrentImageAttachmentSize")}return n},n:function(n){if(this.q!==n){this.q=n;this.dQ("Loading");!this.q&&this.B&&this.B()}return n},bd:function(n){if(this.j!==n){this.j=n;this.dQ("IsReferenceAttachment")}return n},bm:function(){this.bc(!1)},bl:function(){this.bc(!0)},bg:function(){if(this.A&&this.i){var t=this.i.q();var n=_a.bf.a(this.i.o());this.A.b(this.i.a(),"Download",n,t)}},bf:function(){this.G()},bk:function(){this.E.a(this.i.I(),"_blank")},bc:function(n){if(!$a(this.a)){var r=_a.d.b(_ad.c.a,n?"AttachmentLightBoxNextImage":"AttachmentLightBoxPreviousImage");var u=this.bi();var i=this.a.d.length;var t=(n?this.c+1:this.c-1)%i;t===-1&&(t=i-1);this.c=t;this.T(this.a.d[t],!0);r.j=u;_a.d.a(r);this.f&&this.V()}},T:function(n,t){this.i=n;this.bn(n.o());this.bo(n.E());this.l=this.f&&!!n.l&&!!n.e;if(this.l){this.z=n.e;this.y=n.l}else{this.z=null;this.y=null}this.br(n.k());this.bp(n.G());this.bd(n.q());this.U(n.j());t&&this.d()&&this.d().a(this.b)},bi:function(){var n=new _a.r;this.a?n.a("C",this.a.d.length):n.b("C","");n.b("T",_a.bf.a(this.o));n.a("S",this.m);return n.toString()},be:function(){if(this.d()&&this.a){this.d().c();for(var n=0;n<this.a.d.length;n++)this.d().b(this.a.d[n].o(),this.a.d[n].k(),this.a.d[n].n);this.d().a(this.b)}},bt:function(n,t){if(n!==-1){this.c=n;this.T(this.a.d[n],t)}},bb:function(){if(!this.e)if(this.w){this.bs(this.w.a());this.be()}else{var n=this;this.K.a(function(t){n.w=t;n.bb()})}}};_ad.w=function(n){_ad.w.initializeBase(this);this.d=n;this.f(!1)};_ad.w.prototype={a:!0,g:!1,b:0,c:!1,h:!1,d:null,i:!1,l:function(){return 480},e:function(n){if(this.a!==n){if(n&&this.g)return n;this.a=n;this.dQ("ShowReadingPane")}return n},n:function(n){if(this.g!==n){this.g=n;this.dQ("ShouldAlwaysHideReadingPane");this.g&&this.e(!1)}return n},m:function(n){if(this.c!==n){this.c=n;this.dQ("IsEditMode")}return n},j:function(n){if(this.b!==n){this.b=n;this.dQ("ReadingPaneWidth");this.dQ("DocumentToolbarWidth");this.dQ("ImageWidth")}return n},k:function(){return 0},f:function(n){var t;t=this.d?this.d.document.body.offsetWidth:$("body").width();this.o(t,n)},o:function(n,t){_js.Trace.logInfo(_a.a.c,"Set aspect ratio width: {0}, isUserAction",n,t);if(!t&&!this.h){var r=this.c?1366:1152;this.e(n>=r)}if(this.a){var i=Math.floor(Math.max(n/(1+1.89),this.l()));_js.Trace.logInfo(_a.a.c,"Set reading pane width: {0}; attachment view width: {1}; total width: {2}",i,n-i,n);this.j(i)}else this.j(this.i?20:0);t&&!this.h&&(this.h=!0)}};_ad.t=function(n){_ad.t.initializeBase(this,[n])};_ad.t.prototype={k:function(){return this.a?this.b:this.i?30:this.b+260}};_ad.n=function(n){_ad.n.initializeBase(this,[n])};_ad.n.prototype={l:function(){return 380}};_ad.x=function(){};_ad.x.prototype={a:null,n:!0};_ad.s=function(n,t,i){this.o=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.q);this.g=Function.createDelegate(this,this.r);_ad.s.initializeBase(this);this.j=n;this.i=t;this.h=i;i.b(_y.ef,this.g)};_ad.s.prototype={j:null,i:null,b:null,c:null,h:null,d:function(){return!!this.c},l:function(){var n=this.a.D();if(this.b){this.a.l.a()==="Mouse"?this.a.cS().d(this.b):this.a.R.a();this.a.P(4);_y.j.a(null,"ReplyWithChanges","","",n)}else this.a.bA(this.a.t.AttachmentId.RootItemId,this.f,!1)},e:function(){var n=null;n=this.a.h===1&&this.a.e.c()&&_y.m.isInstanceOfType(this.a.e.c())?this.a.e.c():this.b;n&&n.c().c(null,null)},m:function(){var n=this;this.c.c().c(function(t){n.s()},null)},k:function(){if(this.b.n()){this.b.n()();this.b=null}},s:function(){this.a.bA(this.a.d.g,this.f,!0)},r:function(n){if(this.a.d){this.a.d.g=n.a();this.c=n.b()}},q:function(n){var t=this;this.i.a(function(i){var u=t.a.D();var r=i.b(n.bl.ItemId,!1,_g.h.c(n),n.by());t.j.a(function(n){t.b=n.a(r,null,null);t.b.f(t.a.bP);if(t.n){t.a.bG=t.b.e().b();t.b.e().j(t.a.bf)}t.a.cS().d(t.b);t.a.l.a()==="TouchWide"&&t.b.z().apcl("IsAppBarSetup",t.o);t.a.P(4);_y.j.a(null,"ReplyWithChanges","","",u)})})},p:function(n,t){this.a.em(this.b)},dispose:function(){this.h.c(_y.ef,this.g)}};_ad.r=function(){_ad.r.initializeBase(this)};_ad.r.prototype={d:function(){return!1},l:function(){var n=this.a.e.bM().a();var i=_h.e.a();var r=i.a(this.a.c.a().Id);n.i(r);n.c(!0);var t=this;this.a.bA(this.a.d.g,function(i){n.k().g(i.U().c);n.k().h(t.a.be);if(t.n){t.a.bG=n.a().a();n.a().i(t.a.bf)}},!1)},e:function(){},m:function(){},k:function(){},dispose:function(){}};_ad.e=function(n,t,i,r){this.k=Function.createDelegate(this,this.p);this.i=Function.createDelegate(this,this.n);this.h=Function.createDelegate(this,this.m);this.j=Function.createDelegate(this,this.o);_ad.e.initializeBase(this,[n]);this.a=t;this.d=i;this.b=r;this.g=$(document.body)};_ad.e.prototype={a:null,d:null,b:null,g:null,c:null,f:null,e:null,n:function(){_js.Trace.logInfo(_a.a.c,"Attachment light box resized.");var n=this.E();n.a&&n.a.f(!1)},bk:function(){this.a.c()||this.l();_js.b.prototype.bk.call(this)},bO:function(){this.bE();_js.b.prototype.bO.call(this)},J:function(){_js.b.prototype.J.call(this);this.a.c()||this.q();var n=this.E();n.a&&n.a.apcl("ShowReadingPane",this.j);n.apcl("CollabStep",this.h);this.a.i(this.i);n.bz()&&!n.co()?n.db():n.K(!1)},P:function(){this.a.c()||this.l();var n=this.E();if(n){n.K(!1);n.rpcl("CollabStep",this.h);n.a&&n.a.rpcl("ShowReadingPane",this.j)}this.a.j(this.i);_js.b.prototype.P.call(this)},K:function(){_js.b.prototype.K.call(this);if(this.F){var n=this.E();this.c=this.F.a("attachmentViewElement");this.f=this.F.a("readingPaneElement");this.e=n.p?null:this.F.a("attachmentToolbarElement")}else{this.c=null;this.f=null;this.e=null}},R:function(){_js.c.prototype.R.call(this);this.E()&&this.r()},r:function(){var n=this.E();n.p?this.y(this.a.a()==="Mouse"?"AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2":"AttachmentLightBoxView.Wide.AttachmentLightboxView"):this.y(this.a.a()==="Mouse"?"AttachmentLightBoxView.AttachmentLightboxViewLegacy":"AttachmentLightBoxView.Wide.AttachmentLightboxView")},o:function(n,t){var i=this.E();if(i.a.a){this.b.c(28,this.f.B,null).a();this.b.c(28,this.c.B,null).a();this.a.a()!=="Mouse"||i.p||this.b.c(28,this.e.B,null).a()}else{this.b.c(32,this.f.B,null).a();this.b.c(27,this.c.B,null).a();this.a.a()!=="Mouse"||i.p||this.b.c(27,this.e.B,null).a()}},m:function(n,t){var i=this.E();i.h===1&&this.b.c(27,this.c.B,null).a()},q:function(){this.g.keydown(this.k)},l:function(){this.g.unbind("keydown",this.k)},p:function(n){if(n.which===117){var t=new _a.U(n);if(t.j()&&!t.n())if(t.h()&&this.d.b().b){this.d.b().d();n.preventDefault()}else if(this.d.a().b){this.d.a().d();n.preventDefault()}}}};_ad.v=function(n){_ad.v.initializeBase(this,[n]);this.B.attr("FrameBorder","1")};_ad.v.prototype={c:function(n){this.B.attr("Controls",n);return n},b:function(n){this.B.attr("Autoplay",n);return n}};_ad.l=function(){};_ad.l.a=function(){return _fm.e.a("download.png")};_ad.l.b=function(){return _fm.e.a("download_h.png")};_ad.l.c=function(){return _fm.b.a(_fm.a.b,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_ad.f=function(n,t,i,r){this.t=Function.createDelegate(this,this.ce);this.v=Function.createDelegate(this,this.cj);this.h=Function.createDelegate(this,this.cd);this.q=Function.createDelegate(this,this.bZ);this.x=Function.createDelegate(this,this.cl);this.r=Function.createDelegate(this,this.ca);this.s=Function.createDelegate(this,this.cb);this.i=Function.createDelegate(this,this.cn);this.j=Function.createDelegate(this,this.cp);this.w=Function.createDelegate(this,this.ck);this.bw=Function.createDelegate(this,this.bU);this.bB=Function.createDelegate(this,this.bV);this.bC=Function.createDelegate(this,this.bK);this.bG=Function.createDelegate(this,this.bN);_ad.f.initializeBase(this,[n]);this.f=t;this.g=i;this.Z=r;this.bg=new _C(this.bG,_a.a.c);this.bf=new _C(this.bC,_a.a.c);this.bd=new _C(this.bB,_a.a.c);this.U=new _C(this.bw,_a.a.c);this.l=!0};_ad.f.prototype={bg:null,bf:null,bd:null,U:null,p:0,f:null,g:null,b:null,e:null,d:null,l:!1,bn:!1,bt:0,Z:null,c:null,m:0,a:null,bq:!1,bQ:function(n){this.p=n;this.S()&&this.k();return n},cs:function(n){this.bn!==n&&(this.bn=n);return n},cr:function(n){if(this.l!==n){this.l=n;this.bj("HideFullscreenButton")}return n},ck:function(){this.k()},J:function(){_js.b.prototype.J.call(this);this.f&&this.f.i(this.w);this.k();this.a=this.E();!this.a.f&&this.b&&this.b.B[0].complete&&this.a.n(!1);this.a.apcl("ShowPrevNextButtons",this.j);this.a.apcl("SelectedImageInFilmstrip",this.i);if(this.b){this.b.B.bind("load",this.s);this.b.B.bind("error",this.r);this.b.B.bind("contextmenu",this.x);this.b.B.unTouch();var t=this;this.b.B.touch(function(n){t.bY(n)})}if(this.d){var i=$(_js.m.a(this.d.z).documentElement);i.bind("MSFullscreenChange webkitfullscreenchange mozfullscreenchange fullscreenchange",this.q)}if(this.a.f){this.bl();this.a.apcl("ImagePreviewUrl",this.h)}var n=this;_js.g.a().a(_a.a.c,"ImagePreview:OnActivate",function(){n.E()&&n.E().g&&(n.a.f?n.a.r?n.F.a("RightArrow").B.focus():n.a.t&&n.F.a("LeftArrow").B.focus():n.F.a("RightArrow").B.focus())},1e3)},n:function(){if(this.c){this.c.b(!1);this.c=null}},P:function(){_js.b.prototype.P.call(this);if(this.b){this.b.B.unbind("load",this.s);this.b.B.unbind("error",this.r);this.b.B.unbind("contextmenu",this.x)}if(this.d){var t=$(_js.m.a(this.d.z).documentElement);t.unbind("MSFullscreenChange webkitfullscreenchange mozfullscreenchange fullscreenchange",this.q)}if(this.F&&this.F.a("ImageAttachment")){var n=this.F.a("ImageAttachment");n.B.css("max-height","0px");n.B.css("max-width","0px")}if(this.a){this.a.rpcl("ShowPrevNextButtons",this.j);this.a.rpcl("SelectedImageInFilmstrip",this.i);this.a.rpcl("ImagePreviewUrl",this.h)}this.f&&this.f.j(this.w);this.o()},K:function(){_js.b.prototype.K.call(this);if(this.F){this.b=this.F.a("ImageAttachment");this.d=this.F.a("FullscreenContainer");this.cu()}else this.b=null},cu:function(){this.cr(!this.bT())},bT:function(){return this.bJ()?!0:!1},cp:function(n,t){this.k()},R:function(){if(this.E()){this.ct();this.a=this.E();if(this.a){this.a.apcl("ShowPrevNextButtons",this.j);this.a.apcl("SelectedImageInFilmstrip",this.i);if(this.a.f){this.bl();this.a.apcl("ImagePreviewUrl",this.h)}}}_js.c.prototype.R.call(this)},bu:function(){_js.H.prototype.bu.call(this);if(this.a){this.a.rpcl("ShowPrevNextButtons",this.j);this.a.rpcl("SelectedImageInFilmstrip",this.i);this.a.rpcl("ImagePreviewUrl",this.h)}},ct:function(){var n=this.E();n.f?this.y("ImagePreviewLightBoxV2"):this.y("ImagePreview")},br:function(n){this.Z.a(_a.o,new _a.o([n],0,null,0,!1,null,null,null))},k:function(){if(this.F){var t;t=this.d?this.d:this.F.a("ImagePanel");var r=t.B.width();var i=t.B.height();var u=.89*r;var f=.89*i;this.B.offsetParent().focus();this.B.focus();this.F.a("ImageContainer").B.css("width",r+"px");this.F.a("ImageContainer").B.css("height",i+"px");this.F.a("ImageAttachment").B.css("max-width",u+"px");this.F.a("ImageAttachment").B.css("max-height",f+"px");this.Q();var n=this.F.a("loadingIcon");if(n){n.B.css("top",(i-n.B.height())/2+"px");n.B.css(_fc.l.a(),(r-n.B.width())/2+"px")}}},Q:function(){if(this.F){var n=this.F.a("ImageAttachment").B;n.width("").height("");if(this.a&&this.a.l){var u=this.F.a("ImagePanel").B.width();var r=this.F.a("ImagePanel").B.height();var t=.89*u;var i=.89*r;n.width()/n.height()>t/i?n.width(t):n.height(i)}}},bN:function(){if(this.a.g){this.n();var n=this;this.c=this.g.c(40,this.b.B,function(){n.c=null;n.m=61;n.b.M(!0);n.a.P.a()});this.c.a()}},bK:function(){if(this.a.g){this.n();var n=this;this.c=this.g.c(60,this.b.B,function(){n.c=null;n.m=39;n.b.M(!0);n.a.N.a()});this.c.a()}},bJ:function(){if(!this.d)return null;var n=this.d.z;if(n.requestFullscreen){var r=n;return r.$$d_requestFullscreen||(r.$$d_requestFullscreen=Function.createDelegate(r,r.requestFullscreen))}else if(n.msRequestFullscreen){var u=n;return u.$$d_msRequestFullscreen||(u.$$d_msRequestFullscreen=Function.createDelegate(u,u.msRequestFullscreen))}else if(n.webkitRequestFullscreen){var t=n;return t.$$d_webkitRequestFullscreen||(t.$$d_webkitRequestFullscreen=Function.createDelegate(t,t.webkitRequestFullscreen))}else if(n.mozRequestFullScreen){var i=n;return i.$$d_mozRequestFullScreen||(i.$$d_mozRequestFullScreen=Function.createDelegate(i,i.mozRequestFullScreen))}return null},bW:function(){if(!this.d)return null;var n=_js.m.a(this.d.z);if(n.exitFullscreen){var r=n;return r.$$d_exitFullscreen||(r.$$d_exitFullscreen=Function.createDelegate(r,r.exitFullscreen))}else if(n.msExitFullscreen){var u=n;return u.$$d_msExitFullscreen||(u.$$d_msExitFullscreen=Function.createDelegate(u,u.msExitFullscreen))}else if(n.webkitExitFullscreen){var t=n;return t.$$d_webkitExitFullscreen||(t.$$d_webkitExitFullscreen=Function.createDelegate(t,t.webkitExitFullscreen))}else if(n.mozCancelFullScreen){var i=n;return i.$$d_mozCancelFullScreen||(i.$$d_mozCancelFullScreen=Function.createDelegate(i,i.mozCancelFullScreen))}return null},bX:function(){if(!this.d)return null;var n=_js.m.a(this.d.z);if(n.fullscreenElement)return n.fullscreenElement;else if(n.msFullscreenElement)return n.msFullscreenElement;else if(n.webkitFullscreenElement)return n.webkitFullscreenElement;else if(n.mozFullScreenElement)return n.mozFullScreenElement;return null},bV:function(){var n=this.bJ();n&&n()},bZ:function(n){if(this.bX()){this.bq=this.a.h;this.a.k(!0)}else this.a.k(this.bq)},bU:function(){var n=this.bW();n&&n()},cn:function(n,t){var r=this.a.d().d();if(r!==-1&&this.a.c!==r){this.n();var i=this;this.c=this.g.c(26,this.b.B,function(){i.c=null;i.m=22;i.b.M(!0);if(i.a&&i.a.d()){var n=i.a.d().e();n&&i.a.bt(r,!1)}});this.c.a()}},cb:function(n){if(this.b.bA()){this.b.M(!1);this.n();var t=this;this.c=this.g.c(this.m,this.b.B,function(){t.c=null});this.c.a()}this.a.l||this.E().n(!1);this.Q();this.k();this.a.f&&this.a.V()},ca:function(n){this.a.n(!1);if(this.a.j){_js.Trace.logInfo(_a.a.c,"Could not display the shared image attachment. The image was moved or deleted or user haven't accessed the Data Provider");this.br(_nbs.a.EM)}else{_js.Trace.logInfo(_a.a.c,"Could not display image attachment.");this.br(_nbs.a.Kz)}},cl:function(n){var t=this.E();t.C===1&&n.preventDefault()},bY:function(n){this.bt=n.pageX;var t=this;this.b.B.touchEnd(function(n){var i=n.pageX-t.bt;i<0&&t.bK();i>0&&t.bN();t.b.B.cleanupTouchEvents()})},bl:function(){if(this.b){this.o();if(this.a.l){this.b.a(this.a.y);this.e=new _fc.r(document.createElement("img"));this.e.B.bind("load",this.v);this.e.B.bind("error",this.t);this.f.a()!=="Mouse"?this.e.a(this.a.z):this.e.a(this.a.b)}else this.b.a(this.a.b);this.Q()}},cd:function(n,t){this.bl()},cj:function(n){this.a.n(!1);this.b.a(this.e.d());this.o()},ce:function(n){this.a.n(!1);_js.Trace.logInfo(_a.a.c,"Could not display image thumbnail.");this.br(_nbs.a.Kz);this.o()},o:function(){if(this.e){this.e.B.unbind("load",this.v);this.e.B.unbind("error",this.t);this.e.a("");this.e=null}}};_ad.j=function(n,t){this.b=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.f);_ad.j.initializeBase(this,[n]);this.y("MediaPreview");this.d=t};_ad.j.prototype={a:null,d:null,J:function(){_js.b.prototype.J.call(this);if(this.F){this.a=this.F.a("MediaAttachment");if(this.a){this.a.B.bind("error",this.c);this.a.B.bind("canplay",this.b)}}},P:function(){_js.b.prototype.P.call(this);if(this.a){this.a.B.unbind("error",this.c);this.a.B.unbind("canplay",this.b)}},e:function(n){this.E().f(!1)},f:function(n){_js.Trace.logInfo(_a.a.c,"Could not display media attachment.");this.g(_nbs.a.iz);this.E().f(!1)},g:function(n){this.d.a(_a.o,new _a.o([n],0,null,0,!1,null,null,null))}};_ad._TI=function(){};_ad._TI.$$cctor=function(){var tt="AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid1";new _A(tt,function(){_ad._TI.a[tt]===undefined&&(_ad._TI.a[tt]=[[[-1,4,null,null,null,"Text",null,_ad._TI.p,0,null,null,null,_nbs.a.lc],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.z()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_n.a.G()],[-1,0,["AttachmentLightBoxContext","HideClose"],[_ad._TI.bz,_ad._TI.by],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["CloseByBackButtonCommand"],[_ad._TI.bA],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.w()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_n.a.B()],[-1,0,["EditButtonText"],[_ad._TI.bB],null,"Text",null,_ad._TI.p,1,null,null,null],[-1,0,["EditButtonTitle"],[_ad._TI.bC],null,"Title",null,_ad._TI.i,1,null,null,null],[-1,0,["EditCommand"],[_ad._TI.bD],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["IsEditable"],[_ad._TI.bE],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]]]);var t=_ad._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.b(t.children[1]);var n=new _b.B(_js.a.Instance.a(_b.o),_js.a.Instance.a(_b.a),_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));n.A(_E.a(["ShouldShowIntroductionPeek"],[_ad._TI.bI],null,"IsEnabled",null,_ad._TI.bY,1,null,null,!1)).A(_E.a(["IntroductionController","IntroductionPeekContentViewModel"],[_ad._TI.I,_ad._TI.C],null,"PeekDataContext",null,_ad._TI.bX,1)).A(_E.a(["IntroductionController","IntroductionPeekContentViewModel","IsShown"],[_ad._TI.I,_ad._TI.C,_ad._TI.bl],_ad._TI.bm,"IsShown",_ad._TI.bZ,_ad._TI.ca,2,null,null,!1)).D(_E.a(["AttachedElement"],[_ad._TI.bw],null,"AnchorElement",null,_ad._TI.bW,1));n.f("IntroductionPeekContentView");n.h(2);n.z(2);n.x=!1;n.v("Top");n.t("CenterTop");n.j(10);n.s(2);i.G([n]);var r=new _fc.b(t.children[0]);return new _B(t,[r,i])},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var nt="AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid3._tid4";new _A(nt,function(){_ad._TI.a[nt]===undefined&&(_ad._TI.a[nt]=[[[-1,4,null,null,null,"TextSelectionType",null,_ad._TI.bx,0,null,null,0,2],[-1,0,["ReadingPane","ReadingPaneConductor"],[_ad._TI.ba,_ad._TI.S],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveNavigationStack",null,_ad._TI.l,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveItems",null,_ad._TI.k,1,null,null,null]]]);var t=_ad._TI._hf.childNodes[1].cloneNode(!0);var n=new _n.f(t.children[0],_js.a.Instance.a(_n.e),_js.a.Instance.a(_b.a));return new _B(t,[n]).b(n)},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var rt="AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid3._tid5";new _A(rt,function(){_ad._TI.a[rt]===undefined&&(_ad._TI.a[rt]=[[[-1,0,["SideConductor"],[_ad._TI.bb],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveNavigationStack",null,_ad._TI.l,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveItems",null,_ad._TI.k,1,null,null,null]]]);var t=_ad._TI._hf.childNodes[1].cloneNode(!0);var n=new _n.f(t.children[0],_js.a.Instance.a(_n.e),_js.a.Instance.a(_b.a));return new _B(t,[n]).b(n)},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var it="AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid3";new _A(it,function(){_ad._TI.a[it]===undefined&&(_ad._TI.a[it]=[[[-1,0,["CollabStep"],[_ad._TI.u],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.r(),4,!0]],[[-1,0,["CollabStep"],[_ad._TI.u],null,"IsHidden",null,_ad._TI.b,1,new _js.j([_ad._TI.r(),_ad._TI.g()],[4,null]),null,!0]]]);var n=_ad._TI._hf.childNodes[2].cloneNode(!0);var i=new _js.b(n.children[1]);i.y("AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid3._tid5");var t=new _js.b(n.children[0]);t.y("AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid3._tid4");return new _B(n,[t,i])},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var k="AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid6";new _A(k,function(){_ad._TI.a[k]===undefined&&(_ad._TI.a[k]=[[[-1,0,["DocumentConductor"],[_ad._TI.H],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveNavigationStack",null,_ad._TI.l,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveItems",null,_ad._TI.k,1,null,null,null]],[[-1,0,["ImagePreviewViewModel"],[_ad._TI.Y],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ReadingPaneSize"],[_ad._TI.bd],_ad._TI.be,"ReadingPaneSize",_ad._TI.bg,_ad._TI.bh,2,null,null,0],[0,0,["IsReferenceAttachment"],[_ad._TI.K],null,"ShouldShowURLInNewWindowOnError",null,_ad._TI.bV,1,null,null,!1]]]);var r=_ad._TI._hf.childNodes[2].cloneNode(!0);var n=new _ad.f(r.children[1],_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c));n.T(!0);var f=new _fc.g;var t=new _fc.c;t.D(_E.a(["ContextParent","PreviewPrevImageAttachmentCommand"],[_ad._TI.G,_ad._TI.M],null,"Command",null,_ad._TI.E,1));t.i("LEFTARROW");var i=new _fc.c;i.D(_E.a(["ContextParent","PreviewNextImageAttachmentCommand"],[_ad._TI.G,_ad._TI.L],null,"Command",null,_ad._TI.E,1));i.i("RIGHTARROW");f.a([t,i]);n.G([f]);var u=new _n.f(r.children[0],_js.a.Instance.a(_n.e),_js.a.Instance.a(_b.a));u.T(!0);return new _B(r,[u,n]).b(n)},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var b="AttachmentLightBoxView.AttachmentLightboxViewLegacy";new _A(b,function(){_ad._TI.a[b]===undefined&&(_ad._TI.a[b]=[[[-1,4,null,null,null,"AriaRole",null,_ad._TI.t,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad._TI.s,0,null,null,null,_ad.B.D]],[[-1,2,["LayoutStrategy","DocumentToolbarWidth"],[_ad._TI.h,_ad._TI.bP],null,_fce.a.b,null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_u.P.p],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.u()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_n.a.D()],[-1,0,["ShouldHidePopoutButton"],[_ad._TI.bH],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["PopoutCommand"],[_ad._TI.bG],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_y.d.c()],[-1,4,null,null,null,"CheckedImageId",null,_ad._TI.br,0,null,null,null,_y.d.b()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_y.d.e()],[-1,4,null,null,null,"HoveredCheckedImageId",null,_ad._TI.bt,0,null,null,null,_y.d.d()],[-1,4,null,null,null,"UncheckedText",null,_ad._TI.bv,0,null,null,null,_ad.B.H],[-1,4,null,null,null,"CheckedText",null,_ad._TI.bs,0,null,null,null,_ad.B.c],[-1,0,["LayoutStrategy","ShouldAlwaysHideReadingPane"],[_ad._TI.h,_ad._TI.bQ],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad._TI.h,_ad._TI.q],_ad._TI.bS,"IsChecked",_ad._TI.bq,_ad._TI.bu,2,null,null,!1],[-1,0,["ToggleShowHideReadingPaneCommand"],[_ad._TI.bJ],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],null,null,[[-1,4,null,null,null,"AriaRole",null,_ad._TI.t,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad._TI.s,0,null,null,null,_ad.B.f],[-1,2,["LayoutStrategy","ReadingPaneWidth"],[_ad._TI.h,_ad._TI.bf],_ad._TI.bR,_fce.a.b,null,null,2,null,null,null],[-1,2,["LayoutStrategy","ShowReadingPane"],[_ad._TI.h,_ad._TI.q],null,_fce.a.c,null,null,1,null,null,null],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad._TI.h,_ad._TI.q],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],null,null,null,[[-1,4,null,null,null,"AriaRole",null,_ad._TI.t,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad._TI.s,0,null,null,null,_ad.B.F]],[[-1,0,["MessageBoxViewModel"],[_ad._TI.Z],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["IsShown"],[_ad._TI.P],_ad._TI.R,"IsShown",_ad._TI.V,_ad._TI.X,2,null,null,!1],[0,0,["Title"],[_ad._TI.Q],null,"DialogTitle",null,_ad._TI.U,1,null,null,null],[0,0,["CloseCommand"],[_ad._TI.N],null,"CloseCommand",null,_ad._TI.W,1,null,null,null],[0,0,["FooterButtons"],[_ad._TI.O],null,"ButtonDataList",null,_ad._TI.T,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[3].cloneNode(!0);var y=new _n.t(n.children[2],_js.a.Instance.a(_y.c),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.b));var i=new _js.b(_B.a(n,[1,2]));i.dR(_fce.a.a,4);var a=new _b.k(_js.a.Instance.a(_b.i),_js.a.Instance.a(_a.e));a.A(_E.b(401,null,null,null,"Priority",null,_ad._TI.w,0,null,null,0));a.h(!0);i.G([a]);i.y("AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid6");i.z.parentNode.removeChild(i.z);var s=new _js.c(_B.a(n,[1,1,0,0]));s.dR(_fce.a.a,4);s.z.parentNode.removeChild(s.z);var c=new _fce.a(_B.a(n,[1,1,0]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));c.b(2);var u=new _js.c(_B.a(n,[1,1]));u.dR(_fce.a.a,1);u.dR(_fce.a.b,4);u.z.parentNode.removeChild(u.z);var t=new _js.b(_B.a(n,[1,0]));t.dR(_fce.a.a,1);var l=new _b.k(_js.a.Instance.a(_b.i),_js.a.Instance.a(_a.e));l.A(_E.b(402,null,null,null,"Priority",null,_ad._TI.w,0,null,null,0));l.h(!0);t.G([l]);t.y("AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid3");t.z.parentNode.removeChild(t.z);var f=new _fce.a(n.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));f.b(2);var r=new _js.b(_B.a(n,[0,1]));r.dR(_fce.a.a,4);r.y("AttachmentLightBoxView.AttachmentLightboxViewLegacy._tid1");r.z.parentNode.removeChild(r.z);var p=new _fc.j(_B.a(n,[0,0,1]));var v=new _fc.b(_B.a(n,[0,0,0]));var e=new _js.c(_B.a(n,[0,0]));e.dR(_fce.a.a,1);e.z.parentNode.removeChild(e.z);var o=new _fce.a(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));o.b(2);var h=new _b.k(_js.a.Instance.a(_b.i),_js.a.Instance.a(_a.e));h.A(_E.b(400,null,null,null,"Priority",null,_ad._TI.w,0,null,null,0));h.h(!0);o.G([h]);o.a.a(e);o.a.a(r);f.a.a(t);f.a.a(u);c.a.a(s);f.a.a(i);return new _B(n,[o,e,v,p,r,f,t,u,c,s,i,y]).R({attachmentToolbarElement:r,readingPaneElement:t,attachmentViewElement:i})},_ad.b,_ad.e,function(n){return new _ad.e(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.i),_js.a.Instance.a(_b.a))},!1,!1,!1,0,_ad._TI.a);var g="AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tid8._tid9";new _A(g,function(){_ad._TI.a[g]===undefined&&(_ad._TI.a[g]=[[[-1,4,null,null,null,"TextSelectionType",null,_ad._TI.bx,0,null,null,0,2],[-1,0,["ReadingPane","ReadingPaneConductor"],[_ad._TI.ba,_ad._TI.S],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveNavigationStack",null,_ad._TI.l,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveItems",null,_ad._TI.k,1,null,null,null]]]);var t=_ad._TI._hf.childNodes[1].cloneNode(!0);var n=new _n.f(t.children[0],_js.a.Instance.a(_n.e),_js.a.Instance.a(_b.a));return new _B(t,[n]).b(n)},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var d="AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tid8._tida";new _A(d,function(){_ad._TI.a[d]===undefined&&(_ad._TI.a[d]=[[[-1,0,["SideConductor"],[_ad._TI.bb],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveNavigationStack",null,_ad._TI.l,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveItems",null,_ad._TI.k,1,null,null,null]]]);var t=_ad._TI._hf.childNodes[1].cloneNode(!0);var n=new _n.f(t.children[0],_js.a.Instance.a(_n.e),_js.a.Instance.a(_b.a));return new _B(t,[n]).b(n)},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var ht="AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tid8";new _A(ht,function(){_ad._TI.a[ht]===undefined&&(_ad._TI.a[ht]=[[[-1,0,["CollabStep"],[_ad._TI.u],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.r(),4,!0]],[[-1,0,["CollabStep"],[_ad._TI.u],null,"IsHidden",null,_ad._TI.b,1,new _js.j([_ad._TI.r(),_ad._TI.g()],[4,null]),null,!0]]]);var n=_ad._TI._hf.childNodes[4].cloneNode(!0);var i=new _js.b(n.children[1]);i.y("AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tid8._tida");var t=new _js.b(n.children[0]);t.y("AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tid8._tid9");return new _B(n,[t,i])},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var st="AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tidc";new _A(st,function(){_ad._TI.a[st]===undefined&&(_ad._TI.a[st]=[[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.b],[-1,0,["AttachmentLightBoxContext","HideClose"],[_ad._TI.bz,_ad._TI.by],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["CloseByBackButtonCommand"],[_ad._TI.bA],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.f],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_fm.a.f],[-1,0,["IsEditable"],[_ad._TI.bE],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0],[-1,0,["EditButtonText"],[_ad._TI.bB],null,"Text",null,_ad._TI.p,1,null,null,null],[-1,0,["EditButtonTitle"],[_ad._TI.bC],null,"Title",null,_ad._TI.i,1,null,null,null],[-1,0,["EditCommand"],[_ad._TI.bD],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]]]);var r=_ad._TI._hf.childNodes[5].cloneNode(!0);var t=new _fc.b(r.children[1]);t.d("ms-bg-color-themePrimary");t.a("ms-bg-color-themeDark");var n=new _b.B(_js.a.Instance.a(_b.o),_js.a.Instance.a(_b.a),_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));n.A(_E.a(["ShouldShowIntroductionPeek"],[_ad._TI.bI],null,"IsEnabled",null,_ad._TI.bY,1,null,null,!1)).A(_E.a(["IntroductionController","IntroductionPeekContentViewModel"],[_ad._TI.I,_ad._TI.C],null,"PeekDataContext",null,_ad._TI.bX,1)).A(_E.a(["IntroductionController","IntroductionPeekContentViewModel","IsShown"],[_ad._TI.I,_ad._TI.C,_ad._TI.bl],_ad._TI.bm,"IsShown",_ad._TI.bZ,_ad._TI.ca,2,null,null,!1)).D(_E.a(["AttachedElement"],[_ad._TI.bw],null,"AnchorElement",null,_ad._TI.bW,1));n.f("IntroductionPeekContentView");n.h(2);n.z(2);n.x=!1;n.v("Top");n.t("CenterTop");n.j(10);n.s(2);t.G([n]);var i=new _fc.b(r.children[0]);i.d("ms-font-color-neutralSecondary");i.a("ms-font-color-themePrimary ms-bg-color-themeLight");return new _B(r,[i,t])},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var ct="AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tide";new _A(ct,function(){_ad._TI.a[ct]===undefined&&(_ad._TI.a[ct]=[[[-1,0,["DocumentConductor"],[_ad._TI.H],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveNavigationStack",null,_ad._TI.l,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad._TI.f],null,"ActiveItems",null,_ad._TI.k,1,null,null,null]]]);var t=_ad._TI._hf.childNodes[6].cloneNode(!0);var n=new _n.f(t.children[0],_js.a.Instance.a(_n.e),_js.a.Instance.a(_b.a));n.T(!0);return new _B(t,[n]).b(n)},_ad.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var ot="AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2";new _A(ot,function(){_ad._TI.a[ot]===undefined&&(_ad._TI.a[ot]=[[[-1,4,null,null,null,"AriaRole",null,_ad._TI.t,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad._TI.s,0,null,null,null,_ad.B.D]],[[-1,2,["LayoutStrategy","DocumentToolbarWidth"],[_ad._TI.h,_ad._TI.bP],null,_fce.a.b,null,null,1,null,null,null]],null,null,[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_u.P.p],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.u()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_n.a.D()],[-1,0,["ShouldHidePopoutButton"],[_ad._TI.bH],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["PopoutCommand"],[_ad._TI.bG],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_y.d.c()],[-1,4,null,null,null,"CheckedImageId",null,_ad._TI.br,0,null,null,null,_y.d.b()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_y.d.e()],[-1,4,null,null,null,"HoveredCheckedImageId",null,_ad._TI.bt,0,null,null,null,_y.d.d()],[-1,4,null,null,null,"UncheckedText",null,_ad._TI.bv,0,null,null,null,_ad.B.H],[-1,4,null,null,null,"CheckedText",null,_ad._TI.bs,0,null,null,null,_ad.B.c],[-1,0,["LayoutStrategy","ShouldAlwaysHideReadingPane"],[_ad._TI.h,_ad._TI.bQ],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad._TI.h,_ad._TI.q],_ad._TI.bS,"IsChecked",_ad._TI.bq,_ad._TI.bu,2,null,null,!1],[-1,0,["ToggleShowHideReadingPaneCommand"],[_ad._TI.bJ],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad._TI.t,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad._TI.s,0,null,null,null,_ad.B.f],[-1,2,["LayoutStrategy","ReadingPaneWidth"],[_ad._TI.h,_ad._TI.bf],_ad._TI.bR,_fce.a.b,null,null,2,null,null,null],[-1,2,["LayoutStrategy","ShowReadingPane"],[_ad._TI.h,_ad._TI.q],null,_fce.a.c,null,null,1,null,null,null],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad._TI.h,_ad._TI.q],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],null,null,null,null,[[-1,0,["IcsPreviewViewModel"],[_ad._TI.ce],null,"DataContext",null,_ad._TI.d,1,null,null,null]],[[-1,0,["ImagePreviewViewModel"],[_ad._TI.Y],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["ReadingPaneSize"],[_ad._TI.bd],_ad._TI.be,"ReadingPaneSize",_ad._TI.bg,_ad._TI.bh,2,null,null,0],[0,0,["IsReferenceAttachment"],[_ad._TI.K],null,"ShouldShowURLInNewWindowOnError",null,_ad._TI.bV,1,null,null,!1]],[[-1,0,["MediaPreviewViewModel"],[_ad._TI.bF],null,"DataContext",null,_ad._TI.d,1,null,null,null]],[[-1,0,["DocumentConductor"],[_ad._TI.H],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.bj(),null,!0]],null,[[-1,4,null,null,null,"AriaRole",null,_ad._TI.t,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad._TI.s,0,null,null,null,_ad.B.F]],[[-1,0,["MessageBoxViewModel"],[_ad._TI.Z],null,"DataContext",null,_ad._TI.d,1,null,null,null],[0,0,["IsShown"],[_ad._TI.P],_ad._TI.R,"IsShown",_ad._TI.V,_ad._TI.X,2,null,null,!1],[0,0,["Title"],[_ad._TI.Q],null,"DialogTitle",null,_ad._TI.U,1,null,null,null],[0,0,["CloseCommand"],[_ad._TI.N],null,"CloseCommand",null,_ad._TI.W,1,null,null,null],[0,0,["FooterButtons"],[_ad._TI.O],null,"ButtonDataList",null,_ad._TI.T,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[7].cloneNode(!0);var it=new _n.t(n.children[1],_js.a.Instance.a(_y.c),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.b));var o=new _js.b(_B.a(n,[0,2,3,1]));o.dR(_fce.a.a,4);o.y("AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tide");o.z.parentNode.removeChild(o.z);var t=new _js.b(_B.a(n,[0,2,3,0]));t.dR(_fce.a.a,0);t.dR(_fce.a.b,40);t.y("AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tidc");t.z.parentNode.removeChild(t.z);var l=new _fce.a(_B.a(n,[0,2,3]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));l.b(2);var y=new _ad.j(_B.a(n,[0,2,2]),_js.a.Instance.a(_ff.c));y.T(!0);var k=new _ad.f(_B.a(n,[0,2,1]),_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c));k.T(!0);var g=new _fc.g;var b=new _fc.c;b.D(_E.a(["ContextParent","PreviewPrevImageAttachmentCommand"],[_ad._TI.G,_ad._TI.M],null,"Command",null,_ad._TI.E,1));b.i("LEFTARROW");var w=new _fc.c;w.D(_E.a(["ContextParent","PreviewNextImageAttachmentCommand"],[_ad._TI.G,_ad._TI.L],null,"Command",null,_ad._TI.E,1));w.i("RIGHTARROW");g.a([b,w]);k.G([g]);var p=new _js.b(_B.a(n,[0,2,0]));p.y("IcsPreview");p.T(!0);var u=new _js.c(_B.a(n,[0,2]));u.dR(_fce.a.a,4);u.z.parentNode.removeChild(u.z);var h=new _js.c(_B.a(n,[0,1,0,0]));h.dR(_fce.a.a,4);h.z.parentNode.removeChild(h.z);var d=new _fce.a(_B.a(n,[0,1,0]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));d.b(2);var f=new _js.c(_B.a(n,[0,1]));f.dR(_fce.a.a,1);f.dR(_fce.a.b,4);f.z.parentNode.removeChild(f.z);var i=new _js.b(_B.a(n,[0,0,0,1]));i.dR(_fce.a.a,4);i.y("AttachmentLightBoxView.AttachmentLightboxViewLightBoxV2._tid8");i.z.parentNode.removeChild(i.z);var tt=new _fc.j(_B.a(n,[0,0,0,0,1]));var nt=new _fc.b(_B.a(n,[0,0,0,0,0]));var e=new _js.c(_B.a(n,[0,0,0,0]));e.dR(_fce.a.a,0);e.dR(_fce.a.b,40);e.z.parentNode.removeChild(e.z);var c=new _fce.a(_B.a(n,[0,0,0]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));c.b(2);var s=new _js.c(_B.a(n,[0,0]));s.dR(_fce.a.a,1);s.z.parentNode.removeChild(s.z);var r=new _fce.a(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));r.b(2);var v=new _b.k(_js.a.Instance.a(_b.i),_js.a.Instance.a(_a.e));v.A(_E.b(402,null,null,null,"Priority",null,_ad._TI.w,0,null,null,0));v.h(!0);r.G([v]);var a=new _b.k(_js.a.Instance.a(_b.i),_js.a.Instance.a(_a.e));a.A(_E.b(401,null,null,null,"Priority",null,_ad._TI.w,0,null,null,0));a.h(!0);r.G([a]);r.a.a(s);c.a.a(e);c.a.a(i);r.a.a(f);d.a.a(h);r.a.a(u);l.a.a(t);l.a.a(o);return new _B(n,[r,s,c,e,nt,tt,i,f,d,h,u,p,k,y,l,t,o,it]).R({readingPaneElement:i,attachmentViewElement:u}).b(y)},_ad.b,_ad.e,function(n){return new _ad.e(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.i),_js.a.Instance.a(_b.a))},!1,!1,!1,0,_ad._TI.a);var lt="AttachmentLightBoxView";new _A(lt,function(){var n=_ad._TI._hf.childNodes[8].cloneNode(!0);return new _B(n,[])},_ad.b,_ad.e,function(n){return new _ad.e(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.i),_js.a.Instance.a(_b.a))},!0,!1,!1,0,_ad._TI.a);var ut="IcsPreview._tidh._tidi";new _A(ut,function(){_ad._TI.a[ut]===undefined&&(_ad._TI.a[ut]=[[[-1,4,null,null,null,"Text",null,_ad._TI.p,0,null,null,null,_nbs.a.IY],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.dD()],[-1,0,["DownloadCommand"],[_ad._TI.cj],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[12].cloneNode(!0);var t=new _fc.b(n.children[0]);return new _B(n,[t])},_ad.d,_fc.f,function(n){return new _fc.f(n)},!1,!0,!1,0,_ad._TI.a);var ft="IcsPreview._tidh";new _A(ft,function(){_ad._TI.a[ft]===undefined&&(_ad._TI.a[ft]=[[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.a()],[-1,0,["CloseCommand"],[_ad._TI.ci],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad._TI.p,0,null,null,null,_nbs.a.Pq],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_n.a.ek()],[-1,0,["AddToCalendarCommand"],[_ad._TI.cf],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,0,["DownloadUrl"],[_ad._TI.ck],null,"Href",null,_ad._TI.F,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[13].cloneNode(!0);var t=new _fc.f(n.children[2]);t.y("IcsPreview._tidh._tidi");var r=new _fc.b(n.children[1]);var i=new _fc.b(n.children[0]);return new _B(n,[i,r,t])},_ad.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var et="IcsPreview";new _A(et,function(){_ad._TI.a[et]===undefined&&(_ad._TI.a[et]=[null,[[-1,0,["CalendarItemDetailsViewModel"],[_ad._TI.ch],null,"DataContext",null,_ad._TI.d,1,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_ad._TI.bo,0,null,null,0,1],[-1,0,["AddToCalendarCommandText"],[_ad._TI.cg],null,"BusyText",null,_ad._TI.D,1,null,null,null],[-1,0,["IsActionExecuting"],[_ad._TI.bK],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],[[-1,0,["IsActionExecuting"],[_ad._TI.bK],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]]]);var n=_ad._TI._hf.childNodes[14].cloneNode(!0);var u=new _js.b(n.children[3]);var r=new _fce.g(n.children[2],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));r.a=0;var t=new _js.b(n.children[1]);t.y("CalendarItemDetailsUnifiedView");t.T(!0);var i=new _js.b(n.children[0]);i.y("IcsPreview._tidh");return new _B(n,[i,t,r,u])},_ad.d,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_ad._TI.a);var w="ImagePreview._tidj";new _A(w,function(){_ad._TI.a[w]===undefined&&(_ad._TI.a[w]=[[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_ad.l.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_ad.l.b()],[-1,4,null,null,null,"Text",null,_ad._TI.p,0,null,null,null,_nbs.a.IY],[-1,0,["IsReferenceAttachment"],[_ad._TI.K],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["DownloadAttachmentCommand"],[_ad._TI.cm],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,5,["IsImageBlockedForDownload"],[_ad._TI.v],null,"ms-font-color-themeLight:ms-font-color-themeSecondary",null,null,0,null,null,null]]]);var n=_ad._TI._hf.childNodes[15].cloneNode(!0);var t=new _fc.b(n.children[0]);return new _B(n,[t])},_ad.c,_fc.f,function(n){return new _fc.f(n)},!1,!0,!1,0,_ad._TI.a);var f="ImagePreview._tidl";new _A(f,function(){_ad._TI.a[f]===undefined&&(_ad._TI.a[f]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[16].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var u="ImagePreview._tidm";new _A(u,function(){_ad._TI.a[u]===undefined&&(_ad._TI.a[u]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[17].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var o="ImagePreview._tidn";new _A(o,function(){_ad._TI.a[o]===undefined&&(_ad._TI.a[o]=[[[-1,0,["ImageStripViewModel"],[_ad._TI.bc],null,"DataContext",null,_ad._TI.d,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[18].cloneNode(!0);var t=new _iav.a(n.children[0],_js.a.Instance.a(_b.a));return new _B(n,[t])},_ad.c,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var e="ImagePreview";new _A(e,function(){_ad._TI.a[e]===undefined&&(_ad._TI.a[e]=[null,null,[[-1,0,["CurrentImageAttachmentName"],[_ad._TI.J],null,"Text",null,_ad._TI.o,1,null,null,null]],[[-1,0,["CurrentImageAttachmentSize"],[_ad._TI.bL],null,"Text",null,_ad._TI.o,1,new _js.j([_ad._TI.bk(),_ad._TI.bi()],[null,null]),null,null]],[[-1,0,["ImageDownloadUrl"],[_ad._TI.bM],null,"Href",null,_ad._TI.F,1,null,null,null],[-1,5,["IsImageBlockedForDownload"],[_ad._TI.v],null,"_ad_A",null,null,0,null,null,null]],[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_nbs.a.FB],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.E],[-1,1,["PreviewPrevImageAttachmentCommand"],[_ad._TI.M],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["ShowPrevNextButtons"],[_ad._TI.bO],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_nbs.a.V],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.n],[-1,1,["PreviewNextImageAttachmentCommand"],[_ad._TI.L],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["ShowPrevNextButtons"],[_ad._TI.bO],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],null,null,[[-1,4,null,null,null,"BusyText",null,_ad._TI.D,0,null,null,null,_u.R.LN],[-1,0,["Loading"],[_ad._TI.bN],null,"IsBusy",null,_ad._TI.bn,1,null,null,!1]],[[-1,0,["ImagePreviewUrl"],[_ad._TI.co],null,"Source",null,_ad._TI.cc,1,null,null,null],[-1,0,["CurrentImageAttachmentName"],[_ad._TI.J],null,"ImageName",null,_ad._TI.bp,1,null,null,null]],[[-1,0,["ImageStripViewModel"],[_ad._TI.bc],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.bj(),null,!0]]]);var n=_ad._TI._hf.childNodes[19].cloneNode(!0);var c=new _js.b(_B.a(n,[0,3,1]));c.y("ImagePreview._tidn");var o=new _b.bl(_B.a(n,[0,3,0,1]));var s=new _fce.g(_B.a(n,[0,3,0,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));var l=new _js.c(_B.a(n,[0,3,0]));var f=new _js.c(_B.a(n,[0,3]));f.dR(_fce.a.a,4);f.z.parentNode.removeChild(f.z);var t=new _fc.b(_B.a(n,[0,2]));t.d("ms-font-color-neutralSecondary");t.a("ms-font-color-neutralDark");t.dR(_fce.a.a,1);t.dR(_fce.a.b,25);t.y("ImagePreview._tidm");t.z.parentNode.removeChild(t.z);var i=new _fc.b(_B.a(n,[0,1]));i.d("ms-font-color-neutralSecondary");i.a("ms-font-color-neutralDark");i.dR(_fce.a.a,3);i.dR(_fce.a.b,25);i.y("ImagePreview._tidl");i.z.parentNode.removeChild(i.z);var h=new _fc.f(_B.a(n,[0,0,1,0]));h.y("ImagePreview._tidj");var a=new _fc.a(_B.a(n,[0,0,0,1]));var v=new _fc.a(_B.a(n,[0,0,0,0]));var u=new _js.c(_B.a(n,[0,0]));u.dR(_fce.a.a,2);u.dR(_fce.a.b,50);u.z.parentNode.removeChild(u.z);var r=new _fce.a(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));r.b(2);r.a.a(u);r.a.a(i);r.a.a(t);r.a.a(f);return new _B(n,[r,u,v,a,h,i,t,f,l,s,o,c]).R({RightArrow:t,ImagePanel:f,ImageContainer:l,loadingIcon:s,ImageAttachment:o})},_ad.c,_ad.f,function(n){return new _ad.f(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c))},!1,!1,!1,0,_ad._TI.a);var t="ImagePreviewLightBoxV2._tidp._tidq";new _A(t,function(){_ad._TI.a[t]===undefined&&(_ad._TI.a[t]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null],[-1,5,["IsImageBlockedForDownload"],[_ad._TI.v],null,"ms-font-color-neutralTertiary:ms-font-color-white",null,null,0,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad._TI.o,0,null,null,null,_ad.B.l],[-1,5,["IsImageBlockedForDownload"],[_ad._TI.v],null,"ms-font-color-neutralTertiary:ms-font-color-white",null,null,0,null,null,null]]]);var n=_ad._TI._hf.childNodes[20].cloneNode(!0);var r=new _fc.a(n.children[1]);var i=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[i,r])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var n="ImagePreviewLightBoxV2._tidp";new _A(n,function(){_ad._TI.a[n]===undefined&&(_ad._TI.a[n]=[[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_ad.B.J],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.bu],[-1,0,["IsReferenceAttachment"],[_ad._TI.K],null,"IsHidden",null,_ad._TI.b,1,null,null,!0]]]);var i=_ad._TI._hf.childNodes[21].cloneNode(!0);var t=new _fc.b(i.children[0]);t.y("ImagePreviewLightBoxV2._tidp._tidq");return new _B(i,[t])},_ad.c,_fc.f,function(n){return new _fc.f(n)},!1,!0,!1,0,_ad._TI.a);var r="ImagePreviewLightBoxV2._tidr";new _A(r,function(){_ad._TI.a[r]===undefined&&(_ad._TI.a[r]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad._TI.o,0,null,null,null,_ad.B.X]]]);var n=_ad._TI._hf.childNodes[22].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var i="ImagePreviewLightBoxV2._tids";new _A(i,function(){_ad._TI.a[i]===undefined&&(_ad._TI.a[i]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad._TI.o,0,null,null,null,_ad.B.O]]]);var n=_ad._TI._hf.childNodes[22].cloneNode(!0);var r=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,r])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var v="ImagePreviewLightBoxV2._tidu";new _A(v,function(){_ad._TI.a[v]===undefined&&(_ad._TI.a[v]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[23].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var a="ImagePreviewLightBoxV2._tidv";new _A(a,function(){_ad._TI.a[a]===undefined&&(_ad._TI.a[a]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[23].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_ad.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var p="ImagePreviewLightBoxV2._tidw";new _A(p,function(){_ad._TI.a[p]===undefined&&(_ad._TI.a[p]=[[[-1,0,["ImageStripViewModel"],[_ad._TI.bc],null,"DataContext",null,_ad._TI.d,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[24].cloneNode(!0);var t=new _iav.a(n.children[0],_js.a.Instance.a(_b.a));return new _B(n,[t])},_ad.c,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_ad._TI.a);var y="ImagePreviewLightBoxV2";new _A(y,function(){_ad._TI.a[y]===undefined&&(_ad._TI.a[y]=[null,null,[[-1,0,["ImageDownloadUrl"],[_ad._TI.bM],null,"Href",null,_ad._TI.F,1,null,null,null],[-1,5,["IsImageBlockedForDownload"],[_ad._TI.v],null,"_ad_V",null,null,0,null,null,null]],[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_ad.B.Z],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.bw],[-1,1,["HideFullscreenButton"],[_ad._TI.bU],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,1,["FullscreenCommand"],[_ad._TI.cz],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_ad.B.i],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.V],[-1,0,["ShouldHideOpenInOneDriveButton"],[_ad._TI.cq],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,0,["OpenInOneDriveCommand"],[_ad._TI.cp],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.b],[-1,0,["ClosePreviewCommand"],[_ad._TI.cl],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["HideCloseButton"],[_ad._TI.cn],null,"IsHidden",null,_ad._TI.b,1,null,null,!0]],null,[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_nbs.a.FB],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.s],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_fm.a.s],[-1,1,["PreviewPrevImageAttachmentCommand"],[_ad._TI.M],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["ShowPrevButton"],[_ad._TI.ct],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_nbs.a.V],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.q],[-1,4,null,null,null,"HoveredImageId",null,_ad._TI.j,0,null,null,null,_fm.a.q],[-1,1,["PreviewNextImageAttachmentCommand"],[_ad._TI.L],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["ShowNextButton"],[_ad._TI.cs],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],null,[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_ad.B.E],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_ad.l.c()],[-1,4,null,null,null,"Text",null,_ad._TI.p,0,null,null,null,_ad.B.E],[-1,1,["HideFullscreenButton"],[_ad._TI.bU],null,"IsHidden",null,_ad._TI.b,1,null,null,!0],[-1,1,["CloseFullscreenCommand"],[_ad._TI.cy],null,"ClickCommand",null,_ad._TI.e,1,null,null,null]],null,[[-1,4,null,null,null,"BusyText",null,_ad._TI.D,0,null,null,null,_u.R.LN],[-1,0,["Loading"],[_ad._TI.bN],null,"IsBusy",null,_ad._TI.bn,1,null,null,!1]],[[-1,0,["CurrentImageAttachmentName"],[_ad._TI.J],null,"ImageName",null,_ad._TI.bp,1,null,null,null]],[[-1,0,["CurrentImageAttachmentName"],[_ad._TI.J],null,"Text",null,_ad._TI.o,1,null,null,null]],[[-1,0,["CurrentImageAttachmentSize"],[_ad._TI.bL],null,"Text",null,_ad._TI.o,1,new _js.j([_ad._TI.bk(),_ad._TI.bi()],[null,null]),null,null]],[[-1,0,["ShowFilmstrip"],[_ad._TI.cr],null,"IsHidden",null,_ad._TI.b,1,_ad._TI.g(),null,!0]],[[-1,0,["WindowObjectViewModel"],[_ad._TI.cu],null,"DataContext",null,_ad._TI.d,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[25].cloneNode(!0);var w=new _b.I(n.children[1]);var o=new _js.b(_B.a(n,[0,1,2,2]));o.y("ImagePreviewLightBoxV2._tidw");var p=new _fc.a(_B.a(n,[0,1,2,1,1,1,1]));var k=new _fc.a(_B.a(n,[0,1,2,1,1,1,0]));var v=new _b.bl(_B.a(n,[0,1,2,1,1,0]));var l=new _fce.g(_B.a(n,[0,1,2,1,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));var a=new _js.c(_B.a(n,[0,1,2,1]));var d=new _fc.b(_B.a(n,[0,1,2,0]));var h=new _js.c(_B.a(n,[0,1,2]));var r=new _fc.b(_B.a(n,[0,1,1]));r.dR(_fce.a.a,1);r.dR(_fce.a.b,70);r.y("ImagePreviewLightBoxV2._tidv");var u=new _fc.b(_B.a(n,[0,1,0]));u.dR(_fce.a.a,3);u.dR(_fce.a.b,70);u.y("ImagePreviewLightBoxV2._tidu");var t=new _js.c(_B.a(n,[0,1]));t.dR(_fce.a.a,4);t.z.parentNode.removeChild(t.z);var b=new _fc.b(_B.a(n,[0,0,1,0]));var e=new _fc.b(_B.a(n,[0,0,0,2]));e.y("ImagePreviewLightBoxV2._tids");var s=new _fc.b(_B.a(n,[0,0,0,1]));s.y("ImagePreviewLightBoxV2._tidr");var c=new _fc.f(_B.a(n,[0,0,0,0]));c.y("ImagePreviewLightBoxV2._tidp");var i=new _js.c(_B.a(n,[0,0]));i.dR(_fce.a.a,0);i.dR(_fce.a.b,40);i.z.parentNode.removeChild(i.z);var f=new _fce.a(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));f.b(2);f.a.a(i);f.a.a(t);return new _B(n,[f,i,c,s,e,b,t,u,r,h,d,a,l,v,k,p,o,w]).R({FullscreenContainer:t,LeftArrow:u,RightArrow:r,ImagePanel:h,ImageContainer:a,loadingIcon:l,ImageAttachment:v})},_ad.c,_ad.f,function(n){return new _ad.f(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c))},!1,!1,!1,0,_ad._TI.a);var h="MediaPreview._tidy._tidz";new _A(h,function(){_ad._TI.a[h]===undefined&&(_ad._TI.a[h]=[[[-1,1,["CurrentImageId"],[_ad._TI.m],null,"Id",null,_ad._TI.n,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad._TI.o,0,null,null,null,_ad.B.l]]]);var n=_ad._TI._hf.childNodes[26].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_ad.h,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad._TI.a);var s="MediaPreview._tidy";new _A(s,function(){_ad._TI.a[s]===undefined&&(_ad._TI.a[s]=[[[-1,4,null,null,null,"Title",null,_ad._TI.i,0,null,null,null,_ad.B.J],[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.bu]]]);var t=_ad._TI._hf.childNodes[27].cloneNode(!0);var n=new _fc.b(t.children[0]);n.y("MediaPreview._tidy._tidz");return new _B(t,[n])},_ad.h,_fc.f,function(n){return new _fc.f(n)},!1,!0,!1,0,_ad._TI.a);var l="MediaPreview";new _A(l,function(){_ad._TI.a[l]===undefined&&(_ad._TI.a[l]=[null,null,[[-1,0,["MediaUrl"],[_ad._TI.bT],null,"Href",null,_ad._TI.F,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad._TI.c,0,null,null,null,_fm.a.b],[-1,0,["ClosePreviewCommand"],[_ad._TI.cv],null,"ClickCommand",null,_ad._TI.e,1,null,null,null],[-1,0,["ShouldHideCloseButton"],[_ad._TI.cw],null,"IsHidden",null,_ad._TI.b,1,null,null,!0]],null,[[-1,0,["MediaUrl"],[_ad._TI.bT],null,"Source",null,_ad._TI.cd,1,null,null,null]]]);var n=_ad._TI._hf.childNodes[28].cloneNode(!0);var u=new _ad.v(_B.a(n,[0,1,0]));u.c("controls");u.b("autoplay");var i=new _js.c(_B.a(n,[0,1]));i.dR(_fce.a.a,4);i.z.parentNode.removeChild(i.z);var e=new _fc.b(_B.a(n,[0,0,1,0]));var f=new _fc.f(_B.a(n,[0,0,0,0]));f.y("MediaPreview._tidy");var t=new _js.c(_B.a(n,[0,0]));t.dR(_fce.a.a,0);t.dR(_fce.a.b,40);t.z.parentNode.removeChild(t.z);var r=new _fce.a(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));r.b(2);r.a.a(t);r.a.a(i);return new _B(n,[r,t,f,e,i,u]).R({MediaAttachment:u})},_ad.h,_ad.j,function(n){return new _ad.j(n,_js.a.Instance.a(_ff.c))},!1,!1,!1,0,_ad._TI.a);var c="TransitionView";new _A(c,function(){_ad._TI.a[c]===undefined&&(_ad._TI.a[c]=[[[-1,4,null,null,null,"SpinnerSize",null,_ad._TI.bo,0,null,null,0,1],[-1,0,["Message"],[_ad._TI.cx],null,"BusyText",null,_ad._TI.D,1,null,null,null]]]);var t=_ad._TI._hf.childNodes[6].cloneNode(!0);var n=new _b.q(t.children[0],_js.a.Instance.a(_a.e),_js.a.Instance.a(_ff.a));n.a=0;n.Z=!1;n.b(!0);return new _B(t,[n])},_ad.i,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_ad._TI.a)};_ad._TI.cb=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button autoid=\"_ad_3\" type='button' class='_ad_6 ms-font-weight-regular ms-font-color-neutralSecondary'></button> <button autoid=\"_ad_4\" type='button' class='_ad_4 ms-font-weight-regular ms-font-color-neutralSecondary'></button> </div><div> <div class='_ad_8'></div> </div><div>  <div></div> <div></div> </div><div>  <div autoid=\"_ad_0\" class='_ad_2'>  <div> <button autoid=\"_ad_1\" type='button' class='_ad_4 ms-font-weight-regular ms-font-color-neutralSecondary _ad_7 _ad_b'></button> <button autoid=\"_ad_2\" type='button' class='_ad_4 ms-font-weight-regular ms-font-color-neutralSecondary _ad_c'></button> </div> <div></div> </div> <div class='_ad_3'> <div></div> <div> <div class='_ad_9'> <div class='_ad_a'> </div> </div> </div> <div></div> </div> <div></div> </div><div> <div></div> <div></div> </div><div> <button type='button' class='_ad_e'></button> <button type='button' class='_ad_5 ms-font-m ms-font-color-white ms-color-white'></button> </div><div> <div></div> </div><div> <div class='_ad_9'>  <div> <div class='_ad_9'> <div> <button type='button' class='_ad_4 ms-font-weight-regular ms-font-color-neutralSecondary _ad_7 _ad_b'></button> <button type='button' class='ms-font-weight-regular ms-font-color-neutralSecondary _ad_d'></button> </div> <div></div> </div> </div> <div> <div class='_ad_9'> <div class='_ad_a'> </div> </div> </div>  <div> <div></div> <div></div> <div></div> <div class='_ad_9'> <div></div> <div></div> </div> </div> </div> <div></div> </div><div> <div></div>    </div><div> <div class='_ad_h'></div> </div><div> <div class='_ad_f'> <div> <div></div> <div></div> </div> <div> <div class='_ad_g'></div> <div></div> <div></div> </div> </div> <div></div> </div><div> <div></div>  </div><div> <button type='button' class='_ad_k ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <button type='button' class='_ad_l'></button> <button type='button' class='_ad_k ms-font-weight-regular ms-font-color-neutralPrimary'></button> <a class='_ad_o'></a> </div><div> <div class='_ad_j ms-bg-color-themeLighterAlt'></div> <div class='_ad_p'></div>  <div class='_ad_n ms-font-b ms-font-weight-regular ms-font-color-neutralPrimary'></div>  <div class='_ad_m ms-bg-color-neutralTertiaryAlt'></div> </div><div> <button type='button' class='_ad_z ms-font-weight-regular ms-bg-color-white'></button> </div><div> <span class='_ad_F _ad_G'></span> </div><div> <span class='_ad_F _ad_H'></span> </div><div> <div class='_ad_s'></div> </div><div> <div class='_ad_q ms-bg-color-white'> <div class='_ad_u'> <div class='_ad_I'> <span class='_ad_w ms-font-weight-regular ms-font-color-neutralPrimary'></span> <span class='_ad_x ms-font-weight-semilight ms-font-color-neutralSecondary'></span> </div> <div class='_ad_J'> <a class='_ad_y'></a> </div> </div> <button autoid=\"_ad_5\" type='button' class='_ad_K _ad_B _ad_D'></button> <button autoid=\"_ad_6\" type='button' class='_ad_K _ad_C _ad_E'></button> <div class='_ad_r'> <div class='_ad_t'> <div class='_ad_v'></div> <img autoid=\"_ad_7\"/> </div> <div></div> </div> </div> </div><div> <span class='_ad_W'></span> <span class='ms-font-m ms-font-weight-regular'></span> </div><div> <button type='button' class='_ad_U'></button> </div><div> <span class='_ad_W ms-font-color-white'></span> <span class='ms-font-m ms-font-weight-regular ms-font-color-white'></span> </div><div> <span class='_ad_01'></span> </div><div> <div class='_ad_X'></div> </div><div> <div class='_ad_L ms-bg-color-neutralDark'> <div class='_ad_Q'> <div class='_ad_41'> <a></a> <button type='button' class='_ad_U'></button> <button type='button' class='_ad_U'></button> </div> <div class='_ad_51'> <button type='button' class='_ad_T ms-font-color-white'></button> </div> </div> <div class='ms-bg-color-neutralDark'> <button type='button' class='_ad_61 _ad_11 _ad_21 ms-font-color-white'></button> <button type='button' class='_ad_61 _ad_11 _ad_31 ms-font-color-white'></button> <div class='_ad_M'> <button type='button' class='_ad_Y _ad_S ms-font-m ms-font-weight-regular ms-font-color-white'></button> <div class='_ad_N'> <div class='_ad_R ms-font-color-white'></div> <div class='_ad_O'> <img/> <div class='_ad_P'> <span class='ms-font-size-m ms-font-weight-regular ms-font-color-neutralTertiary'></span> <span class='ms-font-size-m ms-font-weight-regular ms-font-color-neutralSecondaryAlt'></span> </div> </div> </div> <div></div> </div> </div> </div> <div class='hidden'></div> </div><div> <span class='_ad_d1'></span> <span class='ms-font-m ms-font-weight-regular ms-font-color-white'></span> </div><div> <button type='button' class='_ad_c1'></button> </div><div> <div class='_ad_71'> <div class='_ad_91'> <div class='_ad_e1'> <a></a> </div> <div class='_ad_f1'> <button type='button' class='_ad_b1 ms-font-color-white'></button> </div> </div> <div> <audio class='_ad_81'></audio> </div> </div> </div>";_js.c.a().appendChild(n);return n};_ad._TI.bz=function(n){return n.c};_ad._TI.by=function(n){return n.f()};_ad._TI.bA=function(n){return n.bZ};_ad._TI.bB=function(n){return n.bv};_ad._TI.bC=function(n){return n.bw};_ad._TI.bD=function(n){return n.bx};_ad._TI.bE=function(n){return n.bz()};_ad._TI.bI=function(n){return n.bM};_ad._TI.I=function(n){return n.z};_ad._TI.C=function(n){return n.c()};_ad._TI.bl=function(n){return n.b()};_ad._TI.bZ=function(n){return n.c()};_ad._TI.bw=function(n){return n.B};_ad._TI.ba=function(n){return n.e};_ad._TI.S=function(n){return n.i()};_ad._TI.f=function(n){return n.b()};_ad._TI.bb=function(n){return n.cT()};_ad._TI.u=function(n){return n.h};_ad._TI.H=function(n){return n.m};_ad._TI.Y=function(n){return n.g};_ad._TI.bd=function(n){return n.m};_ad._TI.bg=function(n){return n.p};_ad._TI.K=function(n){return n.j};_ad._TI.G=function(n){return n.L};_ad._TI.M=function(n){return _ad.f.isInstanceOfType(n)?n.bg:null};_ad._TI.L=function(n){return _ad.f.isInstanceOfType(n)?n.bf:null};_ad._TI.h=function(n){return n.a};_ad._TI.bP=function(n){return n.k()};_ad._TI.bH=function(n){return n.dq()};_ad._TI.bG=function(n){return n.bH};_ad._TI.bQ=function(n){return n.g};_ad._TI.q=function(n){return n.a};_ad._TI.bq=function(n){return n.p()};_ad._TI.bJ=function(n){return n.cp};_ad._TI.bf=function(n){return n.b};_ad._TI.Z=function(n){return n.x};_ad._TI.P=function(n){return n.j};_ad._TI.V=function(n){return n.b()};_ad._TI.Q=function(n){return n.p};_ad._TI.N=function(n){return n.i};_ad._TI.O=function(n){return n.h};_ad._TI.ce=function(n){return n.bC};_ad._TI.bF=function(n){return n.bd};_ad._TI.cj=function(n){return n.t};_ad._TI.ci=function(n){return n.j};_ad._TI.cf=function(n){return n.o};_ad._TI.ck=function(n){return n.H()};_ad._TI.ch=function(n){return n.c};_ad._TI.cg=function(n){return n.G()};_ad._TI.bK=function(n){return n.l};_ad._TI.cm=function(n){return n.I};_ad._TI.v=function(n){return n.C===1};_ad._TI.m=function(n){return n.s()};_ad._TI.bc=function(n){return n.d()};_ad._TI.J=function(n){return n.o};_ad._TI.bL=function(n){return n.v};_ad._TI.bM=function(n){return n.x};_ad._TI.bO=function(n){return n.g};_ad._TI.bN=function(n){return n.q};_ad._TI.co=function(n){return n.b};_ad._TI.bU=function(n){return n.l};_ad._TI.cz=function(n){return n.bd};_ad._TI.cq=function(n){return n.bh()};_ad._TI.cp=function(n){return n.M};_ad._TI.cl=function(n){return n.H};_ad._TI.cn=function(n){return n.J};_ad._TI.ct=function(n){return n.t};_ad._TI.cs=function(n){return n.r};_ad._TI.cy=function(n){return n.U};_ad._TI.cr=function(n){return n.h};_ad._TI.cu=function(n){return n.E};_ad._TI.bT=function(n){return n.c};_ad._TI.cv=function(n){return n.e};_ad._TI.cw=function(n){return n.g};_ad._TI.cx=function(n){return n.a};_ad._TI.p=function(n,t){n.g(t)};_ad._TI.b=function(n,t){n.M(t)};_ad._TI.c=function(n,t){n.i(t)};_ad._TI.j=function(n,t){n.j(t)};_ad._TI.e=function(n,t){n.be(t)};_ad._TI.i=function(n,t){n.by(t)};_ad._TI.bY=function(n,t){n.b(t)};_ad._TI.bX=function(n,t){n.m(t)};_ad._TI.bm=function(n,t){n.a(t)};_ad._TI.ca=function(n,t){n.e(t)};_ad._TI.bW=function(n,t){n.d(t)};_ad._TI.d=function(n,t){n.ba(t)};_ad._TI.bx=function(n,t){n.cg(t)};_ad._TI.l=function(n,t){n.b(t)};_ad._TI.k=function(n,t){n.c(t)};_ad._TI.be=function(n,t){n.Q(t)};_ad._TI.bh=function(n,t){n.bQ(t)};_ad._TI.bV=function(n,t){n.cs(t)};_ad._TI.E=function(n,t){n.k=t};_ad._TI.t=function(n,t){n.I(t)};_ad._TI.s=function(n,t){n.bb(t)};_ad._TI.w=function(n,t){n.m(t)};_ad._TI.br=function(n,t){n.v(t)};_ad._TI.bt=function(n,t){n.Q(t)};_ad._TI.bv=function(n,t){n.bt(t)};_ad._TI.bs=function(n,t){n.br(t)};_ad._TI.bS=function(n,t){n.e(t)};_ad._TI.bu=function(n,t){n.m(t)};_ad._TI.bR=function(n,t){n.j(t)};_ad._TI.R=function(n,t){n.g(t)};_ad._TI.X=function(n,t){n.a(t)};_ad._TI.U=function(n,t){n.k(t)};_ad._TI.W=function(n,t){n.i(t)};_ad._TI.T=function(n,t){n.j(t)};_ad._TI.F=function(n,t){n.p(t)};_ad._TI.bo=function(n,t){n.c(t)};_ad._TI.D=function(n,t){n.d(t)};_ad._TI.n=function(n,t){n.a(t)};_ad._TI.o=function(n,t){n.a(t)};_ad._TI.bn=function(n,t){n.b(t)};_ad._TI.cc=function(n,t){n.a(t)};_ad._TI.bp=function(n,t){n.g(t)};_ad._TI.cd=function(n,t){n.a(t)};_ad._TI.g=function(){_ad._TI.y||(_ad._TI.y=new _fc.k);return _ad._TI.y};_ad._TI.r=function(){_ad._TI.z||(_ad._TI.z=new _fc.o);return _ad._TI.z};_ad._TI.bj=function(){_ad._TI.A||(_ad._TI.A=new _fc.m);return _ad._TI.A};_ad._TI.bk=function(){_ad._TI.B||(_ad._TI.B=new _b.Z);return _ad._TI.B};_ad._TI.bi=function(){_ad._TI.x||(_ad._TI.x=new _at.x);return _ad._TI.x};CollabAttachmentPreviewComponent.registerClass("CollabAttachmentPreviewComponent",null,_a.iR);_ad.u.registerClass("_ad.u",_h.dY.$$(_g.xV));_ad.a.registerClass("_ad.a",_a.ea);_ad.m.registerClass("_ad.m");_ad.b.registerClass("_ad.b",_y.hJ,_bc.i,_bc.q,_bc.t,_a.jO,_js.z,Sys.IDisposable,_y.bd);_ad.g.registerClass("_ad.g",_y.hJ,_at.bh);_ad.h.registerClass("_ad.h",_a.by);_ad.i.registerClass("_ad.i",_a.by);_ad.d.registerClass("_ad.d",_a.by);_ad.c.registerClass("_ad.c",_a.by);_ad.w.registerClass("_ad.w",_a.jV);_ad.t.registerClass("_ad.t",_ad.w);_ad.n.registerClass("_ad.n",_ad.w);_ad.x.registerClass("_ad.x",null,Sys.IDisposable);_ad.s.registerClass("_ad.s",_ad.x);_ad.r.registerClass("_ad.r",_ad.x);_ad.e.registerClass("_ad.e",_js.b);_ad.v.registerClass("_ad.v",_fc.u);_ad.f.registerClass("_ad.f",_js.b);_ad.j.registerClass("_ad.j",_js.b);_ad._TI.registerClass("_ad._TI");CollabAttachmentPreviewComponent.$$cctor();_ad.a.h=new _H("ImagePreviewUrl",String,_ad.a);_ad.a.o=new _H("OpenInDataProviderUrl",String,_ad.a);_ad.a.g=new _H("ImageDownloadUrl",String,_ad.a);_ad.a.n=new _H("MediaUrl",String,_ad.a);_ad.a.a=new _H("AttachmentClass",_a.dp,_ad.a);_ad.a.m=new _H("ItemId",_g.g,_ad.a);_ad.a.c=new _H("AttachmentName",String,_ad.a);_ad.a.d=new _H("AttachmentSize",Number,_ad.a);_ad.a.b=new _H("AttachmentId",_g.bI,_ad.a);_ad.a.e=new _H("ConversationId",String,_ad.a);_ad.a.q=new _H("ConvChangeKey",String,_ad.a);_ad.a.r=new _H("ConvLmTimeKey",_a.c,_ad.a);_ad.a.s=new _H("ViewFilter",String,_ad.a);_ad.a.p=new _H("ReadingPaneType",_y.fU,_ad.a);_ad.a.f=new _H("HideClose",Boolean,_ad.a);_ad.a.i=new _H("IsEmbeddedAttachmentItem",Boolean,_ad.a);_ad.a.k=new _H("IsReadingPaneSupportedItem",Boolean,_ad.a,!0);_ad.a.l=new _H("IsReferenceAttachment",Boolean,_ad.a);_ad.a.j=new _H("IsPreviewIcsSupportedAttachment",Boolean,_ad.a);_ad.b.a=_a.a.c;_ad.g.a=_a.a.c;_ad.d.a=_a.a.c;_ad.c.a=_a.a.c;_ad._TI._hf=_ad._TI.cb();_ad._TI.y=null;_ad._TI.z=null;_ad._TI.A=null;_ad._TI.B=null;_ad._TI.x=null;_ad._TI.a={};_ad._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.attachments.collabattachmentpreview.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.attachments.collabattachmentpreview.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
