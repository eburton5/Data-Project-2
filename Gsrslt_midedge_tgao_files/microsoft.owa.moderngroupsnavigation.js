try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.moderngroupsnavigation.js'] = (new Date()).getTime();
Type.registerNamespace("_mgn");_mgn.r=function(){};_mgn.r.registerInterface("_mgn.r");_mgn.t=function(){};_mgn.t.prototype={none:0,groupHeader:1,groupReadCard:2,groupMemberList:3};_mgn.t.registerEnum("_mgn.t",!1);_mgn.u=function(n,t,i){_a.b.a(t,"sessionSettings");_a.b.a(n,"actionSubmitter");_a.b.a(i,"featureManager");this.b=n;this.f=t;this.c=i};_mgn.u.prototype={b:null,f:null,c:null,d:null,a:null,BeginGetGroup:function(n,t,i){this.a=_a.d.b(_a.a.r,"GetModernGroup",!0);_mgn.a.a(this.c)?this.k(n,t,i):this.i(n,t,i)},BeginGetGroups:function(n,t){this.d=_a.d.b(_a.a.r,"GetModernGroups",!0);_mgn.a.a(this.c)?this.l(n,t):this.j(n,t)},BeginGetHomeGroup:function(n,t){n(_g.N.a(this.f.bl.UserDisplayName,this.f.bl.UserEmailAddress))},BeginGetGroupUnseenData:function(n,t,i,r){var u=new _mgn.w(n,t);var e=this;u.w(function(){i(u.d)});var f=this;u.v(function(){r(u.t)});this.b.a(u)},l:function(n,t){var f=_mgn.a.b(this.c)?2:1;var i=new _mgn.j(f,null);var u=this;i.w(function(t){var e=t;var r=e.a;var f=e.d;n(r,f,null,!0);u.e(!0,null,i.B(),r?r.length:0,f?f.length:0)});var r=this;i.v(function(){t(i.t);r.e(!1,i.D(),i.B(),0,0)});this.b.b(i)},j:function(n,t){var i=new _mgn.v;var u=this;i.w(function(t){var r=t;var e=r.c;var f=r.d;var o=r.e;n(e,f,o,r.a);u.e(!0,null,i.B(),e?e.length:0,f?f.length:0)});var r=this;i.v(function(){t(i.t);r.e(!1,i.D(),i.B(),0,0)});this.b.b(i)},e:function(n,t,i,r,u){var e=null;var o=null;var s=null;if(n){if(r||u){var f=new _a.r;f.a("jgc",r);f.a("pgc",u);f.a("npvo",_g.a.a().a().N());f.c("npep",_g.a.a().a().bl.MailFolderPaneExpanded);o=f.toString()}}else s=t?t:"Failed";if(this.d){e=this.d;e.k=s;e.j=o;e.l=i;_a.d.a(e);this.d=null}},k:function(n,t,i){var r=new _mgn.i(n,0);var f=this;r.w(function(i){var r=i.a;var u=_g.N.a(r.DisplayName,r.SmtpAddress,r.UserGroupRelationship.IsMember,_mgn.m.a(r.AccessType));f.h(u,t,i.B(),n)});var u=this;r.v(function(t){u.g(i,t.t,t.B(),n)});this.b.b(r)},i:function(n,t,i){var r=new _mgn.h(n,1,0);var f=this;r.w(function(i){var r=i.A.Body.GeneralInfo;var u=_g.N.a(r.Name,r.SmtpAddress,r.IsMember,r.ModernGroupType);f.h(u,t,i.B(),n)});var u=this;r.v(function(t){u.g(i,t.t,t.B(),n)});this.b.b(r)},h:function(n,t,i,r){n.k(!1);n.unseenData=_g.fo.a();t(n);if(this.a){var u=this.a;u.l=i;u.o=r;_a.d.a(u);this.a=null}},g:function(n,t,i,r){n(t);if(this.a){var u=this.a;u.k=t?t.name.toString():"Failed";u.l=i;u.o=r;_a.d.a(u);this.a=null}}};_mgn.F=function(n,t){this.g=t||"";this.c=n||""};_mgn.F.prototype={c:null,g:null,f:function(){return _g.N.c(this.c)}};_mgn.c=function(n,t,i,r,u){_mgn.c.initializeBase(this,[n,t]);this.a=i;this.b=$a(r)?0:r;this.d=$a(u)?0:u};_mgn.c.prototype={a:0,b:0,d:0};_mgn.a=function(n,t,i,r,u,f,e,o,s,h){this.D=Function.createDelegate(this,this.Q);this.E=Function.createDelegate(this,this.R);this.F=Function.createDelegate(this,this.S);this.G=Function.createDelegate(this,this.T);this.H=Function.createDelegate(this,this.V);this.B=Function.createDelegate(this,this.M);this.C=Function.createDelegate(this,this.N);this.A=Function.createDelegate(this,this.L);_mgn.a.initializeBase(this);this.j=n;this.w=t;this.z=i;this.o=r;this.p=u;this.h=f;this.s=e;this.t=o;this.y=s;this.l=h;this.P();_mgn.a.a(this.l)&&this.U();this.h.b(_mgn.c,this.A);this.h.b(_y.bj,this.C);this.h.b(_mgn.f,this.B)};_mgn.a.a=function(n){return!!n&&!!n.a()&&!!n.a().r()&&n.a().r().Enabled};_mgn.a.b=function(n){return _mgn.a.a(n)&&!!n.a().ba()&&n.a().ba().Enabled};_mgn.a.c=function(){_a.k.a("ConversationDeepLink")};_mgn.a.prototype={s:null,o:null,h:null,w:null,z:null,j:null,p:null,t:null,y:null,l:null,g:null,i:null,m:null,q:!1,r:!1,n:null,d:function(n){this.bz("SelectedModernGroupChanged",n)},c:function(n){this.bz("ChangeCurrentModule",n)},a:function(){return this.i},I:function(n){if(this.i!==n){var t=!this.i||!n;this.i=n;if(this.r)return n;t?this.cc("ChangeCurrentModule",0):this.K()}return n},b:function(){return!!this.i},f:function(){return this.g},K:function(){this.bR("SelectedModernGroupChanged",this,null)},e:function(n){if(this.n){this.n(n);this.n=null;return}},P:function(){this.g=new _mgn.b(this.w,this.z,this.o,this.t,this.y,this.l);this.g.bu(this.H);this.g.bG(this.G);this.g.bE(this.F);this.g.bD(this.E);this.g.bF(this.D)},U:function(){var t=_a.d.b(_a.a.r,"GetUnifiedGroupsSettings",!0);var n=new _mgn.n;var i=this;n.w(function(n){var r=n;i.g.bB(!r.a);_a.d.a(t)});var r=this;n.v(function(n){t.k=n.D();_a.d.a(t)});this.j.a(n)},V:function(n){this.x();n&&n.e!==1?this.I(n.d):this.I(null)},S:function(n){_js.i.b(n,"group");this.J(n.bl.SmtpAddress,!0)},T:function(n){_js.i.b(n,"group");this.J(n.bl.SmtpAddress,!1)},J:function(n,t){if(_mgn.a.a(this.l)){var r=new _mgn.y(n,t);this.j.a(r)}else{var i=new _mgn.x(n,t);this.j.a(i)}},R:function(){if(!this.q){this.x();if(this.m)this.m.g();else{this.q=!0;var n=this;this.s.a(function(t){n.m=t;n.m.g();n.q=!1})}}},Q:function(){this.x();var n=this;this.k(function(){n.g.E(n.g.U)});var t=this;this.h.a(_y.s,new _y.s(2,function(){t.h.a(_y.cg,new _y.cg)},!0,!0,!0,!1,!0))},L:function(n){switch(n.a){case 2:this.g.bd(this.v(n,!0));break;case 3:var r=this;this.k(function(){r.g.bo(n.c)});break;case 9:this.g.bo(n.c);this.p.a(_a.bc.a(0));this.i=null;break;case 1:var t=this;this.k(function(){t.g.bd(t.v(n,!0));t.g.bh(n.c);t.p.a(_a.bc.b(n.c,0))});break;case 4:this.g.bP(n.c);break;case 5:var i=this;this.k(function(){var t=$a(n.b)?0:n.b;i.g.bp(i.v(n,!1));i.p.a(_a.bc.b(n.c,t))});break}},v:function(n,t){return _g.N.a(n.g,n.c,t,n.d)},x:function(){this.o.a()!=="Mouse"&&this.h.a(_y.bJ,new _y.bJ(!1))},N:function(n){if(this.o.a()==="Mouse")n.d&&this.g.bh(n.a);else{var t=this;this.k(function(){t.n=n.g;t.g.bp(_g.N.e(n.a));t.cc("ChangeCurrentModule",n.b)})}},M:function(n){n.a&&_a.k.b(_a.a.r,"ConversationDeepLink",!0);if(this.g&&this.g.A&&this.g.A.d.bl.SmtpAddress===n.b)this.h.a(_mgn.k,new _mgn.k(n.a,n.c));else{var i=this;var t=function(){i.h.a(_y.bj,new _y.bj(0,n.b,null,n.a,n.c))};this.h.a(_y.s,new _y.s(0,t,!1,!0,!0,!0,!1))}},k:function(n){try{this.r=!0;n()}finally{this.r=!1}}};function ModernGroupsNavigationComponent(){}ModernGroupsNavigationComponent.$$cctor=function(){_a.p.a().a(ModernGroupsNavigationComponent)};ModernGroupsNavigationComponent.prototype={a:function(n,t,i){var e=this;n.b(_mgn.r,function(){return new _mgn.u(n.a(_h.dg),n.a(_g.bf),n.a(_a.h))}).a();var o=this;n.b(_mgn.s,function(){return new _mgn.B(n.a(_g.bf),n.a(_y.a),n.a(_a.h))}).a();var s=this;n.b(_mgn.a,function(){return new _mgn.a(n.a(_a.q),n.a(_mgn.r),n.a(_mgn.s),n.a(_y.a),n.a(_a.bn),n.a(_ff.c),n.d(IModernGroupCardFacade),n.a(_pe.h),n.a(IInferenceTracker),n.a(_a.h))}).a();var r=this;n.b(IModernGroupsNavigationFactory,function(){return n.a(_mgn.a)}).a();var u=this;n.b(_mgn.e,function(){return new _mgn.e(n.a(IModernGroupsNavigationFactory),n.a(CalendarsCache))}).b(IModernGroupCalendarsProvider).a();var f=this;n.b(_mgn.b,function(){var t=n.a(_mgn.a);return t.g}).b(_y.cD)},b:function(){return[]}};_mgn.f=function(n,t,i){this.b=n;this.a=t;this.c=i};_mgn.f.prototype={b:null,a:null,c:null};_mgn.k=function(n,t){this.a=n;this.b=t};_mgn.k.prototype={a:null,b:null};_mgn.e=function(n,t){this.w=Function.createDelegate(this,this.L);this.r=Function.createDelegate(this,this.I);this.s=Function.createDelegate(this,this.J);this.v=Function.createDelegate(this,this.K);_mgn.e.initializeBase(this);this.q=t;this.j=n.g;this.H(_u.R.Yc,_u.R.VN,_u.R.IH,_u.R.o);this.t.p([this.A(),this.z(),this.B()]);if(this.j.C){this.F();this.X(!0)}else{var r=null;var i=this;r=function(n,t){if(i.j.b()){i.j.g("IsReady",r);i.F()}i.X(!0)};this.j.c("IsReady",r)}};_mgn.e.a=function(n,t,i,r,u){for(var e,f=0;f<n.x.length;f++){var o=i(n.x[f]);for(e=f;e<t.x.length;e++)if(o===r(t.x[e])){f!==e&&t.w(e,f,t.x[e]);break}u&&e>=t.x.length&&u(f,n.x[f])}};_mgn.e.prototype={q:null,j:null,b:function(){return this.j},l:null,a:function(){return this.l},k:null,c:function(){return this.k},m:null,d:function(){return this.m},x:null,e:function(){return this.x},f:function(n){return n.b()==="CA77EDED-A62C-4D6F-B4C6-55449CBDA8C2"||n.b()==="6151B1C8-E005-4366-B4E2-2DBED40129CA"||n.b()==="78A5C2BE-C0BF-438B-9AF7-9C7EFA4340AF"||n.b()==="51978C8F-D6FE-48C6-9ADE-BBE39E935963"},A:function(){return this.l.a()},z:function(){return this.k.a()},B:function(){return this.m.a()},H:function(n,t,i,r){var e=_cc.m.a(n,"CA77EDED-A62C-4D6F-B4C6-55449CBDA8C2");this.x=e;var o=_cc.m.a(t,"6151B1C8-E005-4366-B4E2-2DBED40129CA");this.l=o;var u=_cc.m.a(i,"78A5C2BE-C0BF-438B-9AF7-9C7EFA4340AF");this.k=u;var f=_cc.m.a(r,"51978C8F-D6FE-48C6-9ADE-BBE39E935963");this.m=f},g:function(n){this.j.q(n)},h:function(n){this.j.v(n)},dT:function(){this.E();this.j.g("GroupsMoveInProgress",this.v);_a.jV.prototype.dT.call(this)},F:function(){this.n(this.l,0,this.j.z.g());this.n(this.k,0,this.j.x.g());this.n(this.m,0,this.j.y.g());this.D();this.j.c("GroupsMoveInProgress",this.v)},K:function(n,t){if(this.j.n())this.E();else{this.D();this.M()}},M:function(){var f=this;var n=function(n){return n.a()};var e=this;var t=function(n){return n.bl.ItemId.Id};var r=this;_mgn.e.a(this.j.z,this.A(),n,t,function(i,u){r.G(u,[r.z()],r.l,i,t,n)});var i=this;_mgn.e.a(this.j.x,this.z(),n,t,function(r,u){i.G(u,[i.A(),i.B()],i.k,r,t,n)});var u=this;_mgn.e.a(this.j.y,this.B(),n,t,function(n,t){u.n(u.m,n,[t])});this.y(this.l,this.j.z.x.length);this.y(this.k,this.j.x.x.length);this.y(this.m,this.j.y.x.length)},y:function(n,t){for(var i=t,r=n.a().x.length;i<r;i++)this.q.W(n.a().x[i],n)},G:function(n,t,i,r,u,f){for(var o,e,h=0,c=t.length;h<c;h++){e=t[h];var l=this;o=e.k(n,function(n,t){return f(n)===u(t)});if(o>=0){var s=e.x[o];e.z(o,s);i.a().D(r,s,s);return}}this.n(i,r,[n])},D:function(){this.j.z.d(this.s);this.j.x.d(this.r);this.j.y.d(this.w)},E:function(){this.j.z.e(this.s);this.j.x.e(this.r);this.j.y.e(this.w)},J:function(n,t){this.C(this.l,t)},I:function(n,t){this.C(this.k,t)},L:function(n,t){this.C(this.m,t)},C:function(n,t){switch(t.c){case 0:this.n(n,t.d,t.a);break;case 2:for(var i=0,u=t.b.length;i<u;i++){var r=n.a().x[t.d];this.q.W(r,n)}break;default:break}},n:function(n,t,i){for(var u,r=0,e=i.length;r<e;r++){u=i[r];var f=_g.v.a(u.d.bl.DisplayName,u.a(),!0);this.q.bu(f,n,t+r)}}};_mgn.q=function(){};_mgn.q.prototype={a:function(n,t){var i=n;return i>0?i>99?_u.R.OQ:i.toString():""},b:function(n,t){throw Error.notImplemented();}};_mgn.m=function(){};_mgn.m.a=function(n){switch(n){case 1:return 1;case 3:return 3;case 2:return 2}return 0};_mgn.i=function(n,t){_mgn.i.initializeBase(this,[n]);this.c=t};_mgn.i.prototype={c:0,a:null,d:function(){var n="OWA_GetUnifiedGroupDetailsAction-GI";_mgn.d.a().c(this.i.Value)&&(n=n+"-"+"NewGroup");return n},s:function(n){var t=new _g.Hi(this.x);t.explicitLogonUser=this.i.Value;t.actionName=this.d();var i=new _g.qa(this.y(),new _g.qb(this.i));i.Body.ResponseShape=this.c;n.ca(i,t,this.r,this.q)},cz:function(n,t,i){var r=n;r.Body&&r.Body.ResponseCode==="NoError"&&r.Body.GroupDetails||i(Error.create("GetUnifiedGroupDetailsAction: group details could not be retrieved."));this.a=r.Body.GroupDetails;t()}};_mgn.j=function(n,t){_mgn.j.initializeBase(this);this.e=n;this.c=t};_mgn.j.prototype={e:0,c:null,a:null,d:null,s:function(n){var u=new _g.HK(this.x);u.actionName=_mgn.j.a;var f=new _g.qh(this.y());f.Body=new _g.ku;if(_js.d.b(this.c))u.actionName+=":AU";else{f.Body.UserSmtpAddress=this.c;u.actionName+=":SU"}var e=null;switch(this.e){case 1:var t=new _g.hM;t.FilterType=1;t.SortType=3;t.SortDirection="Descending";var i=new _g.hM;i.FilterType=2;i.SortType=2;i.SortDirection="Descending";e=[t,i];break;case 2:var r=new _g.hM;r.FilterType=0;r.SortType=4;r.SortDirection="Descending";e=[r];break}e&&(f.Body.RequestedGroupsSets=e);n.cd(f,u,this.r,this.q)},cz:function(n,t,i){n.Body&&n.Body.GroupsSets&&n.Body.GroupsSets.length||i(Error.create("GetUserUnifiedGroupsAction: groups could not be retrieved."));for(var f=n.Body.GroupsSets,e=f.length,r=0;r<e;++r){var u=f[r];switch(u.FilterType){case 1:this.d=this.f(u.Groups);break;case 2:default:this.a=this.f(u.Groups);break}}t()},f:function(n){if(!n)return new Array(0);for(var i=new Array(n.length),t=0;t<n.length;t++){i[t]=_g.N.a(n[t].DisplayName,n[t].SmtpAddress,!0,_mgn.m.a(n[t].AccessType));i[t].k(n[t].IsFavorite)}return i}};_mgn.d=function(){this.a={}};_mgn.d.a=function(){_mgn.d.b||(_mgn.d.b=new _mgn.d);return _mgn.d.b};_mgn.d.prototype={a:null,c:function(n){n=n.toLowerCase();if(n in this.a){if(this.d(n)){delete this.a[n];return!1}return!0}return!1},b:function(n){this.a[n.toLowerCase()]=_a.c.get_utcNow()},d:function(n){var t=_a.c.get_utcNow().g(this.a[n.toLowerCase()]);return t>9e5}};_mgn.y=function(n,t){_mgn.y.initializeBase(this,[n]);this.c=t};_mgn.y.prototype={c:!1,a:null,d:function(){return this.c?"PinModernGroup":"UnpinModernGroup"},s:function(n){var t=new _g.Np(this.x);t.actionName=this.c?"PinGroupAction":"UnpinGroupAction";this.a=_a.d.b(_a.a.r,this.d(),!0);var i=new _g.sy(this.y(),new _g.sz(this.i,this.c));n.cF(i,t,this.r,this.q)},cz:function(n,t,i){t();if(this.a){var r=this.a;r.l=this.B();r.o=this.i.Value;_a.d.a(r);this.a=null}},P:function(n){var i=OwaApplication.i().a(n);_js.d.a(i)&&(i="Failed");_h.dY.prototype.P.call(this,n);if(this.a){var t=this.a;t.k=n.name.toString();t.n=i;t.l=this.B();t.o=this.i.Value;_a.d.a(t);this.a=null}}};_mgn.D=function(n,t){_mgn.D.initializeBase(this);_a.b.c(n,"groupIdentity");this.i=new _g.ib;this.i.Type=0;$a(t)||(this.i.Type=t);this.i.Value=n};_mgn.D.prototype={i:null};_mgn.h=function(n,t,i){_mgn.h.initializeBase(this);_mgn.h.b(n);this.k=n;this.j=t;this.n=i};_mgn.h.b=function(n){if(!n)throw Error.argumentUndefined("smtpAddress","smtpAddress must be specified");};_mgn.h.prototype={k:null,j:0,n:0,Q:function(){var n="GetModernGroup";(this.j&1)==1&&(n=n+"-"+_mgn.h.a);(this.j&2)==2&&(n=n+"-"+"ME");(this.j&4)==4&&(n=n+"-"+"OW");(this.j&8)==8&&(n=n+"-"+"ER");_mgn.d.a().c(this.k)&&(n=n+"-"+"NewGroup");return n},s:function(n){var t=new _g.Gd(this.x);t.explicitLogonUser=this.k;t.actionName=this.Q();var r=this.m();var i=new _g.kg(this.y(),r);n.bH(i,t,this.r,this.q)},cz:function(n,t,i){n.Body.GeneralInfo||n.Body.MembersInfo||n.Body.OwnerList||n.Body.ExternalResources||_js.Trace.logWarning(_a.a.m,"Modern group response is missing general info, members info, external resources, and owner list. RequestedResultSet= {0}",this.j);try{this.o(n,t)}catch(r){i(r)}},m:function(){var n=new _g.po(this.k,this.j);n.MembersPageRequest=new _g.V("Beginning");n.MembersPageRequest.Offset=0;n.MembersPageRequest.MaxEntriesReturned=100;n.MemberSortOrder=this.n;return n},o:function(n,t){t()}};_mgn.v=function(){_mgn.v.initializeBase(this)};_mgn.v.prototype={c:null,d:null,e:null,a:!1,s:function(n){var t=new _g.Gg(this.x);n.bI(t,this.r,this.q)},cz:function(n,t,i){this.c=_g.N.d(n.Body.JoinedGroups);this.d=_g.N.d(n.Body.PinnedGroups);this.e=_g.N.d(n.Body.RecommendedGroups,!0);this.a=$a(n.Body.IsModernGroupsAddressListPresent)?!0:n.Body.IsModernGroupsAddressListPresent;t()}};_mgn.w=function(n,t){_mgn.w.initializeBase(this);_a.b.c(n,"groupMailbox");this.c=n;this.a=t};_mgn.w.prototype={c:null,d:null,a:null,s:function(n){var t=new _g.Gi(this.x);t.explicitLogonUser=this.c;t.actionName=this.a;var i=new _g.pp(this.y());i.Body=new _g.kh;n.bJ(i,t,this.r,this.q)},cz:function(n,t,i){try{this.d=n.Body.UnseenData;t()}catch(r){i(r)}}};_mgn.n=function(){_mgn.n.initializeBase(this)};_mgn.n.prototype={a:!1,s:function(n){var t=new _g.Hq(this.x);t.actionName=_mgn.n.a;n.cc(new _g.qe(this.y()),t,this.r,this.q)},cz:function(n,t,i){var r=n;if(!r||!r.Body){i(Error.create("Unified group settings could not be retrieved"));return}this.a=r.Body.IsUnifiedGroupsAddressListPresent;t()}};_mgn.C=function(){_mgn.C.initializeBase(this)};_mgn.C.prototype={Group:null,IsMember:null,IsPinned:null};_mgn.x=function(n,t){_mgn.x.initializeBase(this);_a.b.c(n,"smtpAddress");this.d=n;this.c=t};_mgn.x.prototype={d:null,c:!1,a:null,e:function(){return this.c?"PinModernGroup":"UnpinModernGroup"},s:function(n){var t=new _g.Nb(this.x);t.actionName=this.c?"PinGroupAction":"UnpinGroupAction";this.a=_a.d.b(_a.a.r,this.e(),!0);n.cB(this.d,this.c,t,this.r,this.q)},cz:function(n,t,i){t();if(this.a){var r=this.a;r.l=this.B();r.o=this.d;_a.d.a(r);this.a=null}},P:function(n){var i=OwaApplication.i().a(n);_js.d.a(i)&&(i="Failed");_h.dY.prototype.P.call(this,n);if(this.a){var t=this.a;t.k=n.name.toString();t.n=i;t.l=this.B();t.o=this.d;_a.d.a(t);this.a=null}}};_mgn.E=function(){_mgn.E.initializeBase(this)};_mgn.E.prototype={UnseenData:null};_mgn.G=function(){};_mgn.G.registerInterface("_mgn.G");_mgn.H=function(){};_mgn.H.registerInterface("_mgn.H");_mgn.I=function(){};_mgn.I.registerInterface("_mgn.I");_mgn.s=function(){};_mgn.s.registerInterface("_mgn.s");_mgn.z=function(){};_mgn.z.prototype={e:0,b:null,a:function(){return"Exchange:GroupAssociation"},c:null,d:null};_mgn.A=function(){};_mgn.A.prototype={d:null,c:0,a:function(){return"Exchange:GroupUnseenItem"},b:null};_mgn.B=function(n,t,i){this.d=_a.L.a();_a.b.a(n,"sessionSettings");this.g=n;this.f=t;this.e=i};_mgn.B.prototype={g:null,f:null,e:null,b:function(){return!!this.e&&this.e.a().cj().Enabled},a:function(n,t){var i=null;if(Array.contains(n,"Exchange:GroupUnseenItem")){var r=t;i=this.i(r.c());var f=this;i.l(_a.a.p,"UnseenItemNotification",function(n){var i=n;var t=new _mgn.A;t.d=i.UnseenData;t.c=i.EventType;t.b=i.reason;r.l(t)},0)}else if(Array.contains(n,"Exchange:GroupAssociation")){var e=new _g.be;i=this.h();var u=this;i.l(_a.a.p,"GroupAssociationNotification",function(n){var r=n;if(r.Group){var i=new _mgn.z;i.b=r.Group;i.e=r.EventType;if(u.b()){i.c=r.IsMember;i.d=r.IsPinned}t.l(i)}},0)}if(i){this.d.b(i.m,i);return i.m}return""},h:function(){var n=new _g.be;n.NotificationType="GroupAssociationNotification";n.ChannelId=_a.T.a;return new _h.J(n)},i:function(n){var t=new _g.be;t.NotificationType="UnseenItemNotification";t.ChannelId=_a.T.a;var i;if(this.b()){t.MailboxId=n;i=new _h.J(t)}else{var r=this.f.a()==="TouchNarrow"||this.f.a()==="TouchWide";i=new _h.bE(t,null,null,n,this.g.bl.LogonEmailAddress,r)}return i},c:function(n){if(this.d.c(n)){this.d.a[n].t();this.d.e(n)}}};_mgn.b=function(n,t,i,r,u,f){this.bt=Function.createDelegate(this,this.K);this.Y=Function.createDelegate(this,this.bz);this.br=Function.createDelegate(this,this.bL);this.bq=Function.createDelegate(this,this.bK);this.bs=Function.createDelegate(this,this.bM);this.l=this.NotificationCallback;_mgn.b.resolveInheritance();this.c=this.apcl;this.g=this.rpcl;_mgn.b.initializeBase(this);_js.i.c(n,"groupsDataProvider");_js.i.c(t,"notificationDataProvider");_js.i.c(r,"groupViewModelFactory");_js.i.c(f,"featureManager");this.G=n;this.J=t;this.D=i;this.P=r;this.bl=u;this.be=f;var e=this,o=this;this.G.BeginGetHomeGroup(function(n){e.U=new _mgn.g(n,1,e,e.G,e.J,e.D,e.P,e.i());e.E(e.U)},function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get groups: {0}",n)});this.x=new _js.f;this.z=new _js.f;this.y=new _js.f;this.H=new _js.f;this.S=new _js.f;this.B={};this.K();this.bk=new _C(this.bs,_a.a.r);this.Q=new _C(this.bq,_a.a.r);this.R=new _C(this.br,_a.a.r);this.x.d(this.Y);this.z.d(this.Y);this.y.d(this.Y);this.H.d(this.Y);this.J.a(["Exchange:GroupAssociation"],this)};_mgn.b.prototype={be:null,S:null,x:null,z:null,y:null,H:null,G:null,J:null,D:null,P:null,bl:null,U:null,A:null,V:!1,bk:null,Q:null,R:null,L:!1,B:null,ba:!1,Z:!1,bj:!1,I:!1,bg:!1,bf:!1,bc:null,C:!1,N:!1,T:null,bb:0,M:!0,F:null,m:function(n){this.dV("GroupsCollectionChanged",n)},r:function(n){this.dW("GroupsCollectionChanged",n)},bu:function(n){this.dV("SelectedGroupChanged",n)},bG:function(n){this.dV("GroupUnpinned",n)},bE:function(n){this.dV("GroupPinned",n)},bF:function(n){this.dV("BrowseGroups",n)},bD:function(n){this.dV("CreateGroups",n)},j:function(){return this.x},k:function(){return this.z},a:function(){return this.S},bU:function(n){if(this.V!==n){this.V=n;this.dQ("IsHomeSelected")}return n},E:function(n){var t=this.A!==n;if(t){var r=!!n&&n.e===1;this.I||this.dZ("SelectedGroupChanging",this.A);this.A=n;OwaApplication.e().a(_y.ep,new _y.ep(n?n.a():null));this.dQ("SelectedGroup");this.bU(r)}if(!this.I){(t||this.D.a()!=="Mouse")&&this.dZ("SelectedGroupChanged",this.A);var u=!!n&&(n.e===2||n.e===3);if(t&&u){var i=0;this.D.a()==="Mouse"&&(i=this.S.y(n)?1:2);this.bl.M(this.A.d.bl.SmtpAddress,i,this.A.d.position,this.A.e===3)}}return n},p:function(){return!(!this.L&&this.C&&!this.N)},e:function(){return this.L},bQ:function(n){if(this.L!==n){this.L=n;this.dU("HasGroups","IsWelcomeMessageHidden");this.L&&this.bn(!1)}return n},bS:function(n){if(this.ba!==n){this.ba=n;this.dQ("HasPinnedAndUnpinnedGroups")}return n},bR:function(n){if(this.Z!==n){this.Z=n;this.dQ("HasJoinedAndVisitedGroups")}return n},bB:function(n){if(this.M!==n){this.M=n;this.dQ("HideBrowseGroups");if(!this.M&&this.F&&this.F.h.x.length===1){this.F.h.r(0,new _fm.d(_u.R.EC,null,this.Q));this.dQ("GroupsHeaderContextMenuViewModel")}}return n},bT:function(n){if(this.bj!==n){this.bj=n;this.dQ("HasRecommendedGroups")}return n},b:function(){return this.C},bC:function(n){if(this.C!==n){this.C=n;this.dU("IsReady","IsWelcomeMessageHidden");this.C&&this.bN()}return n},o:function(){return this.N},bn:function(n){if(this.N!==n){this.N=n;this.dU("InitialGroupsLoadFailed","IsWelcomeMessageHidden")}return n},d:function(){return this.R},n:function(){return this.I},W:function(n){if(this.I!==n){this.I=n;this.dQ("GroupsMoveInProgress");this.I||this.bz(null,null)}return n},bv:function(){return this.D.a()!=="Mouse"},bJ:function(){return $a(_g.a.a().e().bl.GroupCreationEnabled)?!1:!_g.a.a().e().bl.GroupCreationEnabled||this.bv()},i:function(){return _mgn.a.b(this.be)},h:function(){if(this.D.a()!=="Mouse")return null;if(!this.F){this.F=new _fm.f(null);this.M||this.F.h.a(new _fm.d(_u.R.EC,null,this.Q));this.F.h.a(new _fm.d(_u.R.Qy,null,this.R))}return this.F},t:function(){this.bb>0&&this.K()},K:function(){if(this.bg){this.bf=!0;return}this.bg=!0;if(this.T){_js.g.a().b(this.T);this.T=_js.g.a().b(this.T)}var n=this,t=this;this.G.BeginGetGroups(function(t,i,r,u){n.W(!0);var c=n.A&&!n.V?n.A.d.a():null;var e=n.B;n.B={};n.z.f();n.x.f();n.H.f();n.bi(r,e,5,n.H);n.bi(i,e,3,n.z);n.bi(t,e,2,n.x);for(var f=[],s=0;s<n.y.x.length;s++){var o=n.y.x[s];$a(n.B[o.d.a()])?n.B[o.d.a()]=o:f[f.length]=o}for(var h=0;h<f.length;h++)n.y.m(f[h],!0);_mgn.a.a(n.be)||n.bB(!u);n.bI(e);_js.d.a(c)||n.bh(c);n.X();n.W(!1);n.bn(!1);n.bb=0;n.bC(!0);n.bA()},function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get groups: {0}",n);t.bC(!0);t.L||t.bn(!0);t.bA();if(t.bb<3){t.bb++;t.T=_js.g.a().e(_a.a.r,"GroupsViewModel",t.bt,6e4)}})},bd:function(n){var t=this.B[n.a()];var i=!1;if($a(t)){t=new _mgn.g(n,2,this,this.G,this.J,this.D,this.P,this.i());this.B[n.a()]=t;i=!0}else if(t.e===4){this.bO(t);this.W(!0);var r=this.A?this.A.d.a():null;this.y.m(t,!0);t.x(2);_js.d.a(r)||r!==t.d.a()||this.bh(t.d.bl.SmtpAddress);i=!0}if(i){if(this.i())this.K();else{this.x.r(0,t);this.X()}this.W(!1)}},bO:function(n){n&&n.f&&n.f.bu()},bp:function(n){var t=this.w(n);this.E(t);return t},w:function(n){var t=this.B[n.a()];if(t)return t;t=new _mgn.g(n,4,this,this.G,this.J,this.D,this.P,this.i());this.y.r(0,t);this.B[n.a()]=t;this.X();if(this.C){this.by(n);return t}else{this.bc=n;return t}},q:function(n){this.bm(n,!0)},v:function(n){this.bm(n,!1)},bo:function(n){var i=_g.N.c(n);var t=this.B[i];if(!$a(t)){t.d.f()?this.z.m(t,!0):this.x.m(t,!0);t.dispose();delete this.B[i];this.X()}},bP:function(n){var t=this.f(n);t&&t.P()},bh:function(n){var t=this.f(n);t&&this.E(t)},f:function(n){var t=_g.N.c(n);return this.bw(t)},bw:function(n){var t=this.B[n];return $a(t)?null:t},NotificationCallback:function(n){if(n.a()==="Exchange:GroupAssociation"){var t=n;if(this.J.b()&&!$a(t.c)){t.c?this.i()?this.bx(t.b):this.bd(_g.N.g(t.b)):$a(t.b.SmtpAddress)?this.K():this.bo(t.b.SmtpAddress);$a(t.d)||this.i()||this.bm(t.b.SmtpAddress,t.d)}else switch(t.e){case"RowAdded":if(this.i())this.bx(t.b);else{var i=_g.N.g(t.b);$a(this.B[i.a()])&&this.bd(i)}break;case"RowDeleted":case"Reload":case"RowModified":this.K();break;case"SetColumnDone":case"RestrictDone":case"SortDone":case"Error":case"QueryResultChanged":throw Error.invalidOperation();}}},bx:function(n){var t=null;n&&!$a(n.SmtpAddress)&&(t=this.B[n.SmtpAddress.toLowerCase()]);t&&t.e!==4||this.K()},bi:function(n,t,i,r){if(n){for(var o=[],s=n,h=s.length,e=0;e<h;++e){var f=s[e];var u=t[f.a()];if($a(u))u=new _mgn.g(f,i,this,this.G,this.J,this.D,this.P,this.i());else{u.x(i);u.d.o(f)}if(!(f.a()in this.B)){this.B[f.a()]=u;Array.add(o,u)}}r.p(o)}},bz:function(n,t){if(!this.I){this.bQ(this.x.x.length>0||this.z.x.length>0||this.y.x.length>0);this.bS(this.x.x.length>0&&this.z.x.length>0);this.bR((this.x.x.length>0||this.z.x.length>0)&&this.y.x.length>0);this.bT(this.H.x.length>0);this.dX("GroupsCollectionChanged")}},bN:function(){if(this.bc){this.by(this.bc);this.bc=null}},bK:function(){var n=_a.d.b(_a.a.r,"ClickBrowseGroupsButton");this.dX("BrowseGroups");_a.d.a(n)},bL:function(){var n=_a.d.b(_a.a.r,"ClickCreateGroupButton");this.dX("CreateGroups");_a.d.a(n)},bM:function(){this.E(this.U)},bm:function(n,t){var e=_g.N.c(n);var i=this.B[e];if(!$a(i)&&t!==i.d.f()){var o=t?this.x:this.z;var f=t?this.z:this.x;var r=t?"GroupPinned":"GroupUnpinned";this.W(!0);try{var u=this.A===i;o.m(i,!0);f.r(0,i);i.x(t?3:2);this.dZ(r,i.d);u&&this.E(i)}finally{this.W(!1)}this.X()}},X:function(){for(var n=0,r=0;r<this.z.x.length;r++)this.z.x[r].y(n++);for(var u=0;u<this.x.x.length;u++)this.x.x[u].y(n++);for(var t=0;t<this.y.x.length;t++)this.y.x[t].y(n++);for(var i=0;i<this.H.x.length;i++)this.H.x[i].y(n++);this.bV()},bV:function(){var n=this.bH();this.S.f();this.S.p(n.g())},bH:function(){var n=new _js.f;n.p(this.z.g());if(n.x.length>=10)return n;for(var r=Math.min(10-n.x.length,this.x.x.length),i=0;i<r;i++)n.a(this.x.x[i]);if(n.x.length>=10)return n;r=Math.min(10-n.x.length,this.y.x.length);for(var t=0;t<r;t++)n.a(this.y.x[t]);return n},by:function(n){if(n.c!==1){var i=this,t=this;this.G.BeginGetGroup(n.bl.SmtpAddress,function(t){n.o(t)},function(i){if(n.c!==1){var r=t.bw(n.a());if(r&&r.e===4){_js.Trace.logWarning(_a.a.r,"BeginGetGroup failed for group {0}: {1}",n.a(),i);delete t.B[n.a()];t.y.m(r,!0);t.X()}}})}},bI:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};$a(this.B[t.key])&&t.value.dispose()}},bA:function(){this.bg=!1;if(this.bf){this.bf=!1;this.K()}}};_mgn.g=function(n,t,i,r,u,f,e,o){this.C=Function.createDelegate(this,this.K);this.B=Function.createDelegate(this,this.N);this.F=Function.createDelegate(this,this.L);this.G=Function.createDelegate(this,this.M);this.c=this.a;_mgn.g.initializeBase(this);_js.i.c(n,"group");_js.i.c(i,"groupsViewModel");_js.i.c(r,"groupsDataProvider");_js.i.c(u,"notificationProvider");this.i=f.a()==="Mouse"?49:9;this.k=r;this.s=u;this.m=i;this.d=n;this.x(t);this.d.position=65535;this.D=e;this.h=o;if(this.e!==1&&!o){this.z=new _C(this.G,_a.a.r);this.v=new _C(this.F,_a.a.r);this.A=new _fm.d(_u.R.Lh,null,this.z);this.w=new _fm.d(_u.R.Et,null,this.v);this.g=new _fm.f([this.A,this.w]);this.I()}this.d.unseenData||(this.d.unseenData=_g.fo.a());this.d.unseenData.apcl("UnseenCount",this.B);if(f.a()==="Mouse"&&t!==1){var h=_g.N.b(this.d);this.f=this.D.a(_h.k.a(h),2,!1,1);this.f.g(!0);var s=this.f.m()[0];this.f.g(!1);if(s){this.g||(this.g=new _fm.f([]));this.g.h.a(new _fm.d(_u.R.Us,null,s.i))}}};_mgn.g.prototype={d:null,f:null,D:null,v:null,z:null,h:!1,e:0,g:null,A:null,w:null,m:null,k:null,s:null,i:0,j:null,b:function(){return this.d},H:function(){return this.d.unseenData.bl.UnseenCount>0},x:function(n){if(this.e!==n){this.d.k(n===3);this.d.isMember=n===3||n===2;this.e=n;this.I();this.cf(["GroupType","CanPin","CanUnpin","CanJoin"])}return n},y:function(n){if(this.d.position!==n){this.d.position=n;this.e!==4&&this.e!==5&&this.e!==1&&(!this.E()&&this.d.position<=this.i?this.Q():this.E()&&this.d.position>this.i&&this.J())}return n},a:function(){return this.d.a()},n:function(){return!this.h&&this.e===2},p:function(){return!this.h&&this.e===3},o:function(){return!1},q:function(){return this.v},t:function(){return this.z},r:function(){return null},E:function(){return!$a(this.j)},l:function(n){_js.i.c(n,"notification");switch(n.a()){case"Exchange:GroupUnseenItem":var t=n;if(t.c==="Reload"){if(!this.H()){var i=this;this.k.BeginGetGroupUnseenData(this.d.a(),"Reload-"+t.b,this.C,function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get GroupUnseenCount: {0}",n)})}}else this.K(t.d);break;default:throw Error.notImplemented();}},P:function(){this.d.unseenData.c()},bk:function(){this.E()&&this.J();this.f&&this.f.bb();this.d&&this.d.unseenData&&this.d.unseenData.rpcl("UnseenCount",this.B);_js.x.prototype.bk.call(this)},Q:function(){var n=this;this.k.BeginGetGroupUnseenData(this.d.a(),"SubscribeForNotifications",this.C,function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get GroupUnseenCount: {0}",n)});this.j=this.s.a(["Exchange:GroupUnseenItem"],this)},K:function(n){if(n){this.d.unseenData.f(n);this.bj("HasUnseenData")}},J:function(){this.s.c(this.j);this.j=null},I:function(){if(!this.h&&this.g){this.w.c(this.e!==2);this.A.c(this.e!==3)}},M:function(){this.m.v(this.d.bl.SmtpAddress)},L:function(){this.m.q(this.d.bl.SmtpAddress)},N:function(n,t){this.bj("HasUnseenData")}};_mgn.l=function(){};_mgn.l.a=function(){return _fm.g.a("browse_groups","browse_groups","owa","ms-font-color-themePrimary")};_mgn.l.b=function(){return _fm.g.a("create_group","create_group","owa","ms-font-color-themePrimary")};_mgn.o=function(n){this.i=Function.createDelegate(this,this.m);_mgn.o.initializeBase(this,[n]);this.y("GroupsView");this.a={}};_mgn.o.prototype={d:null,c:null,b:null,e:null,a:null,g:function(){var t=this.E();if(!t)return null;var i=t.A;if(!i||t.V)return null;var n=null;switch(i.e){case 3:n=this.k()?this.k().bC():null;break;case 2:n=this.j()?this.j().bC():null;break;case 4:n=this.l()?this.l().bC():null;break}return n},f:function(){!this.d&&this.F&&(this.d=this.F.a("scrollRegionId"));return this.d},k:function(){this.c=this.h(this.c,"pinnedGroupsListViewId");return this.c},j:function(){this.b=this.h(this.b,"joinedGroupsListViewId");return this.b},l:function(){this.e=this.h(this.e,"visitedGroupsListViewId");return this.e},J:function(){_js.b.prototype.J.call(this);$a(this.g())||_js.g.a().a(this.H(),"ConversationReadingPaneView set SelectedItem - trigger scroll to selected item",this.i,0)},m:function(){if(this.S()&&!this.bL&&this.f()&&!$a(this.g())){var t=this.g();var n=t.B[0].offsetTop;var i=t.B[0].offsetHeight;if(n+i>this.f().B[0].offsetHeight){this.a.scrollTop=n;this.f().B.animate(this.a,400)}}},h:function(n,t){if(n)return n;this.F&&(n=this.F.a(t));return n}};_mgn.p=function(n){_mgn.p.initializeBase(this,[n]);this.y("GroupView");this.bm(8197)};_mgn._TI=function(){};_mgn._TI.$$cctor=function(){var l="GroupsView._tid1";new _A(l,function(){_mgn._TI.a[l]===undefined&&(_mgn._TI.a[l]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.QA]]]);var n=_mgn._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var a="GroupsView._tid2";new _A(a,function(){_mgn._TI.a[a]===undefined&&(_mgn._TI.a[a]=[[[-1,4,null,null,null,"BusyText",null,_mgn._TI.u,0,null,null,null,_u.R.KP]]]);var t=_mgn._TI._hf.childNodes[1].cloneNode(!0);var n=new _fce.g(t.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));n.a=0;n.b(!0);return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var h="GroupsView._tid3";new _A(h,function(){_mgn._TI.a[h]===undefined&&(_mgn._TI.a[h]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.NQ]]]);var n=_mgn._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var c="GroupsView._tid4";new _A(c,function(){_mgn._TI.a[c]===undefined&&(_mgn._TI.a[c]=[null]);var t=_mgn._TI._hf.childNodes[2].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.b,function(n){return new _fce.b(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var v="GroupsView._tid5";new _A(v,function(){_mgn._TI.a[v]===undefined&&(_mgn._TI.a[v]=[null]);var t=_mgn._TI._hf.childNodes[3].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.b,function(n){return new _fce.b(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var w="GroupsView._tid6";new _A(w,function(){_mgn._TI.a[w]===undefined&&(_mgn._TI.a[w]=[null]);var t=_mgn._TI._hf.childNodes[4].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.b,function(n){return new _fce.b(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var b="GroupsView._tid7._tid8";new _A(b,function(){_mgn._TI.a[b]===undefined&&(_mgn._TI.a[b]=[[[-1,4,null,null,null,"Id",null,_mgn._TI.w,0,null,null,null,_mgn.l.a()]],[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.EC]]]);var n=_mgn._TI._hf.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_mgn.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_mgn._TI.a);var y="GroupsView._tid7";new _A(y,function(){_mgn._TI.a[y]===undefined&&(_mgn._TI.a[y]=[[[-1,0,["BrowseGroupsCommand"],[_mgn._TI.n],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var t=_mgn._TI._hf.childNodes[6].cloneNode(!0);var n=new _fc.b(t.children[0]);n.y("GroupsView._tid7._tid8");return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var p="GroupsView._tid9._tida";new _A(p,function(){_mgn._TI.a[p]===undefined&&(_mgn._TI.a[p]=[[[-1,4,null,null,null,"Id",null,_mgn._TI.w,0,null,null,null,_mgn.l.b()]],[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Qy]]]);var n=_mgn._TI._hf.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_mgn.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_mgn._TI.a);var i="GroupsView._tid9";new _A(i,function(){_mgn._TI.a[i]===undefined&&(_mgn._TI.a[i]=[[[-1,0,["IsTouchLayout"],[_mgn._TI.L],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0],[-1,0,["CreateGroupCommand"],[_mgn._TI.o],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var t=_mgn._TI._hf.childNodes[7].cloneNode(!0);var n=new _fc.b(t.children[0]);n.y("GroupsView._tid9._tida");return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var r="GroupsView.GroupsPanel";new _A(r,function(){_mgn._TI.a[r]===undefined&&(_mgn._TI.a[r]=[null]);var n=_mgn._TI._hf.childNodes[8].cloneNode(!0);var t=new _mgn.o(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var n="GroupsView.GroupFunctionsTemplate._tidb";new _A(n,function(){_mgn._TI.a[n]===undefined&&(_mgn._TI.a[n]=[[[-1,4,null,null,null,"ImageId",null,_mgn._TI.s,0,null,null,null,_mgn.l.a()],[-1,4,null,null,null,"AriaLabel",null,_mgn._TI.S,0,null,null,null,_u.R.Ey],[-1,4,null,null,null,"Text",null,_mgn._TI.t,0,null,null,null,_u.R.EC],[-1,0,["BrowseGroupsCommand"],[_mgn._TI.n],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var i=_mgn._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.b(i.children[0]);t.h("_mgn_e ms-font-color-themePrimary");t.f("_mgn_f");return new _B(i,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var t="GroupsView.GroupFunctionsTemplate";new _A(t,function(){_mgn._TI.a[t]===undefined&&(_mgn._TI.a[t]=[[[-1,0,["HideBrowseGroups"],[_mgn._TI.p],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mgn._TI.s,0,null,null,null,_mgn.l.b()],[-1,4,null,null,null,"Text",null,_mgn._TI.t,0,null,null,null,_u.R.Qy],[-1,0,["IsGroupCreationDisabled"],[_mgn._TI.q],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0],[-1,0,["CreateGroupCommand"],[_mgn._TI.o],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var i=_mgn._TI._hf.childNodes[10].cloneNode(!0);var n=new _fc.b(i.children[1]);n.h("_mgn_e ms-font-color-themePrimary");n.f("_mgn_f");var r=new _js.b(i.children[0]);r.y("GroupsView.GroupFunctionsTemplate._tidb");return new _B(i,[r,n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var u="GroupsView.NoGroups._tidc";new _A(u,function(){_mgn._TI.a[u]===undefined&&(_mgn._TI.a[u]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.QA]]]);var n=_mgn._TI._hf.childNodes[11].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_y.cD,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var o="GroupsView.NoGroups._tidd";new _A(o,function(){_mgn._TI.a[o]===undefined&&(_mgn._TI.a[o]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.NQ]]]);var n=_mgn._TI._hf.childNodes[11].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_y.cD,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var s="GroupsView.NoGroups";new _A(s,function(){_mgn._TI.a[s]===undefined&&(_mgn._TI.a[s]=[[[-1,0,["IsWelcomeMessageHidden"],[_mgn._TI.B],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"BusyText",null,_mgn._TI.u,0,null,null,null,_u.R.KP],[-1,0,["IsReady"],[_mgn._TI.m],null,"IsBusy",null,_mgn._TI.T,1,_mgn._TI.d(),null,!1]],[[-1,0,["InitialGroupsLoadFailed"],[_mgn._TI.A],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]],[[-1,0,["IsReady"],[_mgn._TI.m],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]]]);var n=_mgn._TI._hf.childNodes[12].cloneNode(!0);var r=new _js.b(n.children[3]);r.y("GroupsView.GroupFunctionsTemplate");var u=new _js.b(n.children[2]);u.y("GroupsView.NoGroups._tidd");var t=new _fce.g(n.children[1],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));t.a=0;var i=new _js.b(n.children[0]);i.y("GroupsView.NoGroups._tidc");return new _B(n,[i,t,u,r])},_y.cD,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var f="GroupsView";new _A(f,function(){_mgn._TI.a[f]===undefined&&(_mgn._TI.a[f]=[null,null,[[-1,1,["DataContext","IsHomeSelected"],[_mgn._TI.x,_mgn._TI.J],null,"IsSelected",null,_mgn._TI.X,1,null,null,!1],[-1,1,["DataContext","HomeSelectedCommand"],[_mgn._TI.x,_mgn._TI.H],null,"ClickCommand",null,_mgn._TI.bb,1,null,null,null],[-1,0,["HomeGroup"],[_mgn._TI.G],null,"DataContext",null,_mgn._TI.ba,1,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Pi]],[[-1,0,["IsWelcomeMessageHidden"],[_mgn._TI.M],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["IsReady"],[_mgn._TI.K],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["InitialGroupsLoadFailed"],[_mgn._TI.I],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]],[[-1,0,["PinnedGroups"],[_mgn._TI.O],null,"DataSource",null,_mgn._TI.k,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.h],_mgn._TI.i,"SelectedItem",_mgn._TI.j,_mgn._TI.l,2,null,null,null]],[[-1,5,["HasPinnedAndUnpinnedGroups"],[_mgn._TI.F],null,"_mgn_6",null,null,0,_mgn._TI.d(),null,null]],[[-1,0,["JoinedGroups"],[_mgn._TI.N],null,"DataSource",null,_mgn._TI.k,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.h],_mgn._TI.i,"SelectedItem",_mgn._TI.j,_mgn._TI.l,2,null,null,null]],[[-1,5,["HasJoinedAndVisitedGroups"],[_mgn._TI.E],null,"_mgn_6",null,null,0,_mgn._TI.d(),null,null]],[[-1,0,["VisitedGroups"],[_mgn._TI.P],null,"DataSource",null,_mgn._TI.k,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.h],_mgn._TI.i,"SelectedItem",_mgn._TI.j,_mgn._TI.l,2,null,null,null]],null,[[-1,0,["HideBrowseGroups"],[_mgn._TI.p],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["IsGroupCreationDisabled"],[_mgn._TI.q],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0]]]);var n=_mgn._TI._hf.childNodes[13].cloneNode(!0);var p=new _js.b(_B.a(n,[0,0,10,1]));p.y("GroupsView._tid9");var w=new _js.b(_B.a(n,[0,0,10,0]));w.y("GroupsView._tid7");var a=new _js.c(_B.a(n,[0,0,10]));a.z.parentNode.removeChild(a.z);var u=new _fce.b(_B.a(n,[0,0,9]),_js.a.Instance.a(_ff.a));u.bn("div");u.U("GroupView");u.y("GroupsView._tid6");u.z.parentNode.removeChild(u.z);var l=new _js.c(_B.a(n,[0,0,8]));l.z.parentNode.removeChild(l.z);var i=new _fce.b(_B.a(n,[0,0,7]),_js.a.Instance.a(_ff.a));i.bn("div");i.U("GroupView");i.y("GroupsView._tid5");i.z.parentNode.removeChild(i.z);var v=new _js.c(_B.a(n,[0,0,6]));v.z.parentNode.removeChild(v.z);var r=new _fce.b(_B.a(n,[0,0,5]),_js.a.Instance.a(_ff.a));r.bn("div");r.U("GroupView");r.y("GroupsView._tid4");r.z.parentNode.removeChild(r.z);var e=new _js.b(_B.a(n,[0,0,4]));e.y("GroupsView._tid3");e.z.parentNode.removeChild(e.z);var s=new _js.b(_B.a(n,[0,0,3]));s.y("GroupsView._tid2");s.z.parentNode.removeChild(s.z);var o=new _js.b(_B.a(n,[0,0,2]));o.y("GroupsView._tid1");o.z.parentNode.removeChild(o.z);var b=new _fc.a(_B.a(n,[0,0,1,0]));var h=new _js.c(_B.a(n,[0,0,1]));h.z.parentNode.removeChild(h.z);var c=new _mgn.p(_B.a(n,[0,0,0]));c.z.parentNode.removeChild(c.z);var t=new _fce.c(_B.a(n,[0,0]));var y=new _fce.f(n.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));t.a.a(c);t.a.a(h);t.a.a(o);t.a.a(s);t.a.a(e);t.a.a(r);t.a.a(v);t.a.a(i);t.a.a(l);t.a.a(u);t.a.a(a);return new _B(n,[y,t,c,h,b,o,s,e,r,v,i,l,u,a,w,p]).R({scrollRegionId:y,pinnedGroupsListViewId:r,joinedGroupsListViewId:i,visitedGroupsListViewId:u})},_mgn.b,_mgn.o,function(n){return new _mgn.o(n)},!1,!1,!1,0,_mgn._TI.a);var e="GroupView";new _A(e,function(){_mgn._TI.a[e]===undefined&&(_mgn._TI.a[e]=[[[-1,5,["ShowSelected"],[_mgn._TI.v],null,"ms-bg-color-themeLighter",null,null,1,null,null,null]],[[-1,0,["Group","DisplayName"],[_mgn._TI.Q,_mgn._TI.D],null,"Text",null,_mgn._TI.c,1,null,null,null]],[[-1,1,["ShowSelected"],[_mgn._TI.v],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0],[-1,0,["UnseenData","UnseenCount"],[_mgn._TI.R,_mgn._TI.C],null,"Text",null,_mgn._TI.c,1,_mgn._TI.y(),null,null]]]);var t=_mgn._TI._hf.childNodes[14].cloneNode(!0);var u=new _fc.a(_B.a(t,[0,1,0]));var r=new _fc.a(_B.a(t,[0,0,0]));var i=new _js.c(t.children[0]);var n=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));n.A(_E.a(["ContextMenuViewModel"],[_mgn._TI.r],null,"MenuDataContext",null,_mgn._TI.W,1)).A(_E.a(["ContextMenuViewModel","IsShown"],[_mgn._TI.r,_mgn._TI.Y],_mgn._TI.Z,"IsShown",_mgn._TI.U,_mgn._TI.V,2,null,null,!1));n.a=2;n.b=5;i.G([n]);return new _B(t,[i,r,u])},_mgn.g,_mgn.p,function(n){return new _mgn.p(n)},!1,!1,!1,0,_mgn._TI.a)};_mgn._TI.z=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div><div> <div class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div><div> <div autoid=\"_mgn_1\"></div> </div><div> <div autoid=\"_mgn_2\"></div> </div><div> <div autoid=\"_mgn_3\"></div> </div><div> <span></span> <span></span> </div><div> <button autoid=\"_mgn_4\" type='button' class='_mgn_b ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <button autoid=\"_mgn_5\" type='button' class='_mgn_b ms-font-weight-regular ms-font-color-neutralPrimary _mgn_d'></button> </div><div> <div></div> </div><div> <button autoid=\"_mgn_6\" type='button' class='_mgn_c ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div>  <div></div>  <button autoid=\"_mgn_7\" type='button' class='_mgn_c ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <span class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary region'></span> </div><div>  <div class='_mgn_g'></div>  <div class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary region'></div>  <div></div>  <div class='_mgn_h'></div> </div><div> <div class='_mgn_2'> <div class='_mgn_3 ms-bg-color-white'> <div autoid=\"_mgn_0\" class='_mgn_4'></div> <div class='_mgn_5 ms-font-weight-regular ms-font-color-themePrimary'> <span></span> </div>  <div class='_mgn_7'></div>  <div class='_mgn_7'></div>  <div class='_mgn_7'></div>  <div class='_mgn_i'></div> <div class='_mgn_9 ms-border-color-themeLighter'></div>  <div class='_mgn_i'></div> <div class='_mgn_9 ms-border-color-themeLighter'></div>  <div class='_mgn_i'></div>  <div class='_mgn_a'> <div></div> <div></div> </div> </div> </div>    </div><div> <div class='_mgn_j ms-font-weight-semilight ms-font-color-neutralPrimary'> <div class='_mgn_k'><span autoid=\"_mgn_8\"></span></div> <div class='_mgn_l'> <span autoid=\"_mgn_9\"></span> </div> <div class='_mgn_m'></div>  </div> </div>";_js.c.a().appendChild(n);return n};_mgn._TI.n=function(n){return n.Q};_mgn._TI.L=function(n){return n.bv()};_mgn._TI.o=function(n){return n.R};_mgn._TI.p=function(n){return n.M};_mgn._TI.q=function(n){return n.bJ()};_mgn._TI.B=function(n){return n.p()};_mgn._TI.m=function(n){return n.b()};_mgn._TI.A=function(n){return n.o()};_mgn._TI.G=function(n){return n.U};_mgn._TI.x=function(n){return n.E()};_mgn._TI.J=function(n){return _mgn.b.isInstanceOfType(n)?n.V:null};_mgn._TI.H=function(n){return _mgn.b.isInstanceOfType(n)?n.bk:null};_mgn._TI.M=function(n){return n.p()};_mgn._TI.K=function(n){return n.C};_mgn._TI.I=function(n){return n.N};_mgn._TI.O=function(n){return n.z};_mgn._TI.h=function(n){return n.A};_mgn._TI.j=function(n){return n.bd()};_mgn._TI.F=function(n){return n.ba};_mgn._TI.N=function(n){return n.x};_mgn._TI.E=function(n){return n.Z};_mgn._TI.P=function(n){return n.y};_mgn._TI.v=function(n){return n.k()};_mgn._TI.r=function(n){return n.g};_mgn._TI.Y=function(n){return n.i};_mgn._TI.U=function(n){return n.c()};_mgn._TI.Q=function(n){return n.d};_mgn._TI.D=function(n){return n.bl.DisplayName};_mgn._TI.R=function(n){return n.d.unseenData};_mgn._TI.C=function(n){return n.bl.UnseenCount};_mgn._TI.c=function(n,t){n.a(t)};_mgn._TI.u=function(n,t){n.d(t)};_mgn._TI.w=function(n,t){n.a(t)};_mgn._TI.g=function(n,t){n.be(t)};_mgn._TI.b=function(n,t){n.M(t)};_mgn._TI.s=function(n,t){n.i(t)};_mgn._TI.S=function(n,t){n.bb(t)};_mgn._TI.t=function(n,t){n.g(t)};_mgn._TI.T=function(n,t){n.b(t)};_mgn._TI.ba=function(n,t){n.ba(t)};_mgn._TI.X=function(n,t){n.g(t)};_mgn._TI.bb=function(n,t){n.be(t)};_mgn._TI.k=function(n,t){n.br(t)};_mgn._TI.i=function(n,t){n.E(t)};_mgn._TI.l=function(n,t){n.bf(t)};_mgn._TI.W=function(n,t){n.d(t)};_mgn._TI.Z=function(n,t){n.j(t)};_mgn._TI.V=function(n,t){n.e(t)};_mgn._TI.d=function(){_mgn._TI.f||(_mgn._TI.f=new _fc.k);return _mgn._TI.f};_mgn._TI.y=function(){_mgn._TI.e||(_mgn._TI.e=new _mgn.q);return _mgn._TI.e};_mgn.F.registerClass("_mgn.F");_mgn.c.registerClass("_mgn.c",_mgn.F);_mgn.a.registerClass("_mgn.a",_js.x,IModernGroupsNavigationFactory,_y.fK);ModernGroupsNavigationComponent.registerClass("ModernGroupsNavigationComponent",null,_a.iR);_mgn.f.registerClass("_mgn.f");_mgn.k.registerClass("_mgn.k");_mgn.e.registerClass("_mgn.e",_cc.cS,IModernGroupCalendarsProvider,_g.Wl,_js.z);_mgn.q.registerClass("_mgn.q",null,_js.S);_mgn.D.registerClass("_mgn.D",_h.dY.$$(_g.QU));_mgn.i.registerClass("_mgn.i",_mgn.D);_mgn.j.registerClass("_mgn.j",_h.dY.$$(_g.wi));_mgn.y.registerClass("_mgn.y",_mgn.D);_mgn.h.registerClass("_mgn.h",_h.dY.$$(_g.pn));_mgn.v.registerClass("_mgn.v",_h.dY.$$(_g.vB));_mgn.w.registerClass("_mgn.w",_h.dY.$$(_g.vC));_mgn.n.registerClass("_mgn.n",_h.dY.$$(_g.QU));_mgn.C.registerClass("_mgn.C",_a.ir);_mgn.C.prototype.toString=_a.ir.prototype.toString;_mgn.x.registerClass("_mgn.x",_h.dY.$$(_g.xA));_mgn.E.registerClass("_mgn.E",_a.ir);_mgn.E.prototype.toString=_a.ir.prototype.toString;_mgn.b.registerClass("_mgn.b",_a.by,_mgn.I,_y.cD);_mgn.g.registerClass("_mgn.g",_js.x,_mgn.G,_mgn.I,_y.gZ,_y.fJ);_mgn.o.registerClass("_mgn.o",_js.b);_mgn.p.registerClass("_mgn.p",_fce.d);_mgn._TI.registerClass("_mgn._TI");ModernGroupsNavigationComponent.$$cctor();_mgn.j.a="OWA_GetUserUnifiedGroupsAction";_mgn.d.b=null;_mgn.h.a="GI";_mgn.n.a="OWA_GetUnifiedGroupsSettingsAction";_mgn._TI._hf=_mgn._TI.z();_mgn._TI.f=null;_mgn._TI.e=null;_mgn._TI.a={};_mgn._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.moderngroupsnavigation.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.moderngroupsnavigation.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
