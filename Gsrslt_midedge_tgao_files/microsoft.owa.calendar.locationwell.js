try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime();
function CalendarLocationWellComponent(){}CalendarLocationWellComponent.$$cctor=function(){_a.p.a().a(CalendarLocationWellComponent)};CalendarLocationWellComponent.prototype={a:function(n,t,i){var u=this,r=this;n.b(ILocationWellViewModelFactory,function(){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.c(n.a(_a.h),n.c(IPlacePickerViewModelFactory),n.a(_y.a),n.a(_a.Z),n.a(_a.z),n.a(_a.da))}).a().c(function(t){t.g=n.a(_pe.e)})},b:function(){return[]}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.initializeBase(this);n&&this.dN(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.$$cctor=function(){_a.i.d(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b,Object,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.prototype={d:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.d)},a:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.b)},c:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.c)},b:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.a)},e:function(){return this.d()?this.d():this.a()?this.a():this.c()?this.c():this.b()?this.b():""}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f=function(n){this.d=n};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.b=function(n){var i=new _pc.a(null,!0,null);i.df(4);var r;i.cP(n.e());var t;r=(t=new _g.p,t.y(n.c()==="s:localBusiness"?"Business":"Other"),t.g(n.a().d()),t.j(n.a().a()),t.o(n.a().c()),t.k(n.a().b()),t.n(null),t.m("LocationServices"),t.r(n.d()),t.v(n.b()?n.b().a():0),t.x(n.b()?n.b().b():0),t);i.bN(new(_bc.S.$$(_g.p)));i.H().g(r,"0");return i};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.prototype={a:null,b:0,d:null,c:null,f:function(){var n={};this.a.c()&&(n.ul=String.format("{0},{1},{2}",this.a.a,this.a.b,this.a.e));n.mr=this.b;n.types=this.d;n.q=this.c;n.appId="E18E19EF-764F-41A9-B53E-6E98AE19695";return n},e:function(n,t,i,r){this.c=n;this.a=i;this.b=t;var u={};u.type="GET";u.url="https://platform.bing.com/geo/autosuggest/V1/";u.data=this.f();u.dataType="jsonp";u.timeout=500;u.jsonp="cb";var f=this;u.success=function(n,t,i){var u=f.g(n);r(u)};var e=this;u.error=function(n,t,i){_js.Trace.logWarning(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.a,"Bing Autosuggest Response timed out")};$.ajax(u)},g:function(n){var i=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e(n);var t=new _ff.e;var r=this;i.a().v(function(n){t.c(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.b(n))});return t}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h.initializeBase(this);this.d=n;this.a=new _g.Cm(this.x);this.a.shouldPrecedeOfflineSyncActions=this.c();this.a.id=n.Id};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h.prototype={d:null,a:null,c:function(){return!1},s:function(n){n.ba(this.d,this.a,this.f,this.e)}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i.initializeBase(this,[n])};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i.prototype={b:function(n){var i=_js.l.a(_bc.e,n.PersonaTypeString);var t=null;switch(i){case 4:var r=n.BusinessAddressesArray;t=n.BusinessAddressesArray[0].Value.LocationUri;break;case 1:t=_pc.l.prototype.b.call(this,n);break}return t}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d=function(){};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.e=function(){var n=new(_h.dV.$$(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g))(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.b);return _h.d.b(n,_h.i.a(),function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.d=function(n){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a(n,6)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.c=function(n){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a(n,1)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a=function(n,t){var i=new _g.hm;i.Query=n;i.Sources=t;return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a(i)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g.initializeBase(this,[n,null,!0,null])};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g.prototype={bm:function(){return _a.a.eG},bx:function(n){var t=n;this.i=!0;return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i(t.A)},D:function(n){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.c("")}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.initializeBase(this);if(n){this.dN(n);this.c()==="s:PostalAddress"&&this.f(new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b(n))}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.$$cctor=function(){_a.i.d(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a,Object,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.prototype={c:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.e)},d:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.b)},a:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.a)},f:function(n){this.dR(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.a,n);return n},b:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.c)},e:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.d)||this.a().e()}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.initializeBase(this);n&&this.dN(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.$$cctor=function(){_a.i.d(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c,Object,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.prototype={a:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.a)},b:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.b)}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.initializeBase(this);n&&this.dN(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.$$cctor=function(){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.a.b(new _a.bs(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a))};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.prototype={a:function(){return this.dS(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.a)}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a=function(n,t){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a.initializeBase(this);this.e=n;this.d=t?t:new _js.f};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a.prototype={e:null,d:null,a:function(){return this.d},c:function(){return"Default"},s:function(n){var t=new _g.DA(this.x);n.bg(this.e,t,this.r,this.q)},cz:function(n,t,i){try{for(var f=new Array(n.length),u=0;u<n.length;u++){var r=new _pc.a(null,!0,null);r.dN(n[u]);if($a(r.f())){r.dj(1);r.de(_h.k.f())}else r.dj(2);f[u]=r}this.d.f();f.length>0&&this.d.p(f);t()}catch(e){i(e)}}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b=function(n,t,i,r,u,f,e,o,s,h){this.C=Function.createDelegate(this,this.V);this.H=Function.createDelegate(this,this.Y);this.D=Function.createDelegate(this,this.X);this.B=Function.createDelegate(this,this.U);this.J=Function.createDelegate(this,this.ba);this.I=Function.createDelegate(this,this.L);this.K=Function.createDelegate(this,this.S);this.r=new _a.bt;Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b.initializeBase(this,[n,t,r,u,!1,null,!1,null,e,null,i,null,0]);this.c=t;this.s=f;this.iQ("");this.z=new _C(this.K,_a.a.ba);this.t=new _C(this.I,_a.a.ba);this.v=o;this.a=!0;this.apcl("QueryString",this.J);this.A=s;this.y=h;this.p=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f("address,business,place");s&&this.N(_lws.CalLWStrings.D)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b.prototype={c:null,s:null,A:!1,t:null,z:null,b:!1,i:null,Q:!0,a:!1,y:!1,d:null,v:null,p:null,gR:function(){return!1},fI:function(){return"http://go.microsoft.com/fwlink/?LinkId=260597"},fL:function(){return!this.c.bl.x.length},gJ:function(){return this.b},x:function(n){if(this.b!==n){this.b=n;this.b&&this.bL(_lws.CalLWStrings.F);this.dQ("IsLearnMoreButtonHighlighted")}return n},gP:function(){return this.t},gQ:function(){return this.Q},gT:function(){return this.i},bb:function(n){if(this.i!==n){this.i=n;this.a&&this.bL(this.i);this.dQ("UseThisLocationString")}return n},gS:function(){return this.z},gN:function(){return this.a},j:function(n){if(this.a!==n){this.a=n;this.a&&this.bL(this.i);this.dQ("IsUseThisLocationButtonHighlighted")}return n},fJ:function(){return this.y?_lws.CalLWStrings.B:null},W:function(){return this.bD.a().bT().Enabled},bs:function(n){n&&!this.Z(n)&&this.c.bl.a(n)},fD:function(n){var t;var u,r;if(n&&(r=this.R(n,u={val:t}),t=u.val,r)){this.c.bl.n(t);var i=new _g.nF;i.Id=n.gc();var f=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h(i);this.co.a(f)}},Z:function(n){var r;var i,t;return t=this.R(n,i={val:r}),r=i.val,t},fS:function(){this.x(!1);this.bT(!1);this.bK(-1);this.bC(-1);this.j(!0)},R:function(n,t){t.val=-1;if(_pc.a.isInstanceOfType(n))for(var u=n.gc(),i=0;i<this.c.bl.x.length;i++){var r=this.c.bl.x[i];if(r.gc()===u){t.val=i;return!0}}return!1},cN:function(n){var t=new _pe.f(n,_pe.c.e,!1,this.de,this.en,8,0,null,null);t.l(1,_cc.I.b,"");if($a(n.bI()))return t;t.fx();return t},gU:function(){this.l(!1);this.bC(-1);this.bK(-1)},fX:function(){return!1},fz:function(){if(this.a)return!0;if(!this.bu.x.length&&this.bY){this.bT(!1);this.j(!0);return!0}if(!this.bX){this.bK(-1);this.bC(-1);this.j(!0);return!0}if(this.b){this.x(!1);this.bT(!0);return!0}return _fp.b.prototype.fz.call(this)},fy:function(){if(this.a){this.j(!1);if(!this.bu.x.length){this.bT(!0);return!0}this.bK(0);this.bC(0);return!0}if(this.bY&&this.fL()){this.bT(!1);this.x(!0);return!0}return this.b?!0:_fp.b.prototype.fy.call(this)},ho:function(){return!1},dA:function(){this.a?this.S():this.b?this.L():_fp.b.prototype.dA.call(this)},ha:function(){this.fW(this.cf,this.B)},bc:function(n,t){this.v.b(this.D,this.H);this.cR(!0);this.p.e(this.bt,n,this.r.a,t)},V:function(n){for(var f=new _ff.e,u=this.cf-this.d.d.length,s=this.d.d,h=s.length,t=0;t<h;++t){var i=s[t];i.bA.bI()&&i.bA.bI().bl.LocationUri&&f.c(i.bA.bI().bl.LocationUri)}for(var o=n.d,c=o.length,r=0;r<c;++r){var e=o[r];if(!u)break;if(u>0&&!f.g(e.H().i(0).bl.LocationUri)){this.d.c(this.cN(e));u--}}this.cq();this.bu.p(this.d.d);this.cR(!1);this.ds()},U:function(n){if(this.W()&&n.d.length<this.cf){this.d=n;this.bc(this.cf,this.C)}else{this.cq();this.bu.p(n.d)}},X:function(n){this.r=n},Y:function(n){},L:function(){this.s.a(this.fI(),null,null)},S:function(){this.l(!1)},ba:function(n,t){this.bb(_js.d.c(_lws.CalLWStrings.E,this.bt))}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a=function(n,t,i,r,u,f,e,o,s,h,c,l){this.H=Function.createDelegate(this,this.Z);this.I=Function.createDelegate(this,this.bb);this.J=Function.createDelegate(this,this.bc);this.L=Function.createDelegate(this,this.be);this.G=Function.createDelegate(this,this.Y);this.K=Function.createDelegate(this,this.bd);this.F=Function.createDelegate(this,this.W);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.initializeBase(this);_a.b.b(u,"owaShell");_a.b.b(s,"clientSettings");this.o=new _C(this.F,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a);this.r=new _C(this.K,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a);this.E=[new _fm.d(_lws.CalLWStrings.G,null,this.o)];this.A=i;this.B=t;this.y=r;this.m=u;this.n=f;this.t=e;this.x=o;this.w=s;this.z=h;this.q=c;this.v=l;this.V();this.bg();this.X(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.prototype={x:null,w:null,q:!1,o:null,r:null,E:null,B:null,A:null,t:null,m:null,v:!1,k:null,i:null,h:null,z:null,y:null,j:null,n:null,l:!1,U:function(n){this.dV("OnPlacePickerClosed",n)},C:function(n){if(this.k!==n){this.k=n;this.dQ("PersonaViewModel")}return n},b:function(){return this.i},Q:function(n){if(this.i!==n&&!this.i.bz(n)){this.i=n;this.dQ("Location")}return n},f:function(){return this.l},P:function(n){if(this.l!==n){this.l=n;this.dQ("IsLocationDirty")}return n},p:function(){return _g.a.a().bl.PolicySettings.PlacesEnabled},br:function(){return this.n},ba:function(n){this.n=n;return n},bd:function(){if(!this.p())throw Error.invalidOperation("Places must be enabled to use the place picker");if($a(this.k)&&!_js.d.b(this.h.bt)){this.h.l(!1);this.h.k(!1);var n=this;this.N(function(t){t.b(n.h.bt,null);n.n.d(t)})}},g:function(n){this.j?n(this.j):this.N(n)},M:function(n){this.Q(n.fz());this.D(n)},d:function(){if(this.l){if($a(this.k)){if(!$a(this.i)&&this.i.a().a()==="Resource"&&this.i.bl.DisplayName===this.h.bt)return;this.S()}else if(!$a(this.i)&&!this.h.bV){this.i.h(this.h.bt);this.dQ("Location")}this.P(!1)}},c:function(n,t){var i=n.q();if(!this.i.bz(i)){var r=i||_g.y.c();this.i=r.m();this.D(_pc.a.f(this.i));this.h.bk(!1);this.dQ("Location")}},e:function(n){!$a(n)&&n.j()&&n.a().a()!=="Resource"&&this.h.bs(_pc.a.f(n))},V:function(){this.h=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.d,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.e(),this.y,this.m,this.w,this.x,this.t,this.z,this.q,this.v);this.h.bo("PlaceDetailedView");if(this.p()){this.h.T();this.h.bG(!0)}else this.h.bG(!1);this.h.F(!1);this.h.w(!1);this.h.G(0);this.h.bq(100)},N:function(n){if(this.j){n(this.j);return}var t=this;this.A.a(function(i){t.j=i.a(9,t.B);t.j.h(t.G);t.m.a()!=="Mouse"||t.m.c()||t.j.e(function(){t.j.b(t.j.c(),t.j.a())});t.j.g(t.L);t.dQ("PlacePickerViewModel");n(t.j)})},be:function(){this.dX("OnPlacePickerClosed")},bg:function(){this.h.hk(this.o);this.h.hG(this.J);this.h.q(this.I);this.h.apcl("QueryString",this.H);if(this.p()&&this.v){this.h.he(this.r);this.h.hd(this.r)}else this.h.he(null)},Z:function(n,t){this.P(!0)},R:function(n){this.h.g(n);this.l=!1},X:function(n){this.i=n?n.m():_g.y.c();this.i.f(this.i.bl.DisplayName||"");this.D(_pc.a.f(this.i))},D:function(n){if(this.i.a().a()==="Resource"){var i=this.i.bl.DisplayName;if(!_js.d.a(this.i.bl.Annotation)){var t=new(_a.eJ.$$(String));t.b(this.i.bl.DisplayName);t.b(this.i.bl.Annotation);i=_cc.bS.a(t)}this.T(i)}else this.i.j()?this.bf(n):this.T(this.i.n())},T:function(n){this.R(n);this.C(null);this.h.bG(this.p())},bf:function(n){this.h.N(_lws.CalLWStrings.A);this.h.bG(!1);this.R(this.i.bl.Annotation||"");this.l=!1;this.C(_cc.I.a(n,this.t,this.m,1,this.E,!0))},W:function(){this.h.N(this.q?_lws.CalLWStrings.D:"");this.C(null);this.S();this.h.bk(!1)},bc:function(n,t){this.h.bP||this.d()},S:function(){this.h.bG(this.p());this.Q(_g.y.a(this.h.bt))},bb:function(n,t){$a(this.h.h())||this.M(this.h.h().a())},Y:function(n){$a(n)||this.M(n)}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.c=function(n,t,i,r,u,f){this.d=n;this.h=t;this.f=i;this.c=r;this.b=u;this.e=f};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.c.prototype={h:null,f:null,c:null,b:null,e:null,d:null,g:null,a:function(n,t,i,r,u){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a(n,t,this.h,this.d,this.f,i,this.g,this.c,this.b,this.e,r,u)}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a=function(n,t){this.m=Function.createDelegate(this,this.Q);this.r=Function.createDelegate(this,this.v);this.q=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.w);this.k=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.o);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a.initializeBase(this,[n]);this.y("LocationWellView");this.a=t;this.c=this.a.a()==="Mouse";this.p=this.a.a()!=="Mouse";this.n=this.a.a()==="Mouse"?2:0};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a.prototype={p:!1,n:0,b:null,f:null,e:null,i:null,d:null,c:!1,h:!1,a:null,g:null,bd:function(n){if(this.c!==n){this.c=n;this.bj("SingleLineMode")}return n},Z:function(n){if(this.h!==n){this.h=n;this.bj("ExpandedPortraitLayout")}return n},cA:function(){return this.g},bc:function(n){if(this.g!==n){this.g=n;this.bj("AriaLabelledBy")}return n},o:function(){var i=this.E();if(this.c&&!$a(this.F)&&!$a(i))if($a(i.k)){this.b.M(!0);this.e.B.hide()}else{this.b.M(!1);this.b.B.width(this.f.B.outerWidth()+10);this.e.B.show();var n=this.i.B.outerWidth();this.e.B.width(n);this.d.B.hide();var t=this.B.outerWidth(!0);var u=this.b.B.outerWidth();var r=t-u-n;r<258&&this.b.B.width((t-n)/2);this.d.B.show()}},K:function(){_js.b.prototype.K.call(this);this.F?this.s():this.U()},J:function(){_js.b.prototype.J.call(this);if(!_g.a.a().bl.PolicySettings.PlacesEnabled){this.a.a()==="Mouse"&&this.e.B.hide();return}if(this.c&&this.a.a()==="Mouse"){this.o();this.a.i(this.l)}if(this.a.m()&&this.E()){var n=this;_js.g.a().d(this.H(),"OnActivate",function(){n.E().apcl("PlacePickerViewModel",n.k);n.f.apcl("DataContext",n.j)})}this.a.a()==="TouchWide"&&this.L.apcl("IsInExpandedComposeLayoutInPortraitOrientation",this.q);this.d.B.keydown(this.r)},P:function(){if(this.a.m()&&this.E()&&this.E()){this.E().rpcl("PlacePickerViewModel",this.k);this.E().rpcl("PersonaViewModel",this.j)}this.c&&this.a.a()==="Mouse"&&this.a.j(this.l);_js.b.prototype.P.call(this)},bk:function(){this.S()&&this.P();_js.b.prototype.bk.call(this)},x:function(n,t){this.E().U(this.m)},w:function(n,t){this.a.a()==="Mouse"&&this.o();_js.g.a().a(_a.a.ba,"RestoreFocus",this.m,0)},v:function(n){(n.which===13||n.which===27)&&n.stopImmediatePropagation()},Q:function(){this.E().k?this.b.X():this.d.X()},t:function(n,t){this.Z(this.B.width()<600)},s:function(){this.b=this.F.a("resolvedLocation");this.f=this.F.a("personaView");this.e=this.F.a("separatorCell");this.i=this.F.a("separatorText");this.d=this.F.a("findPlaceView")},U:function(){this.b=null;this.f=null;this.e=null;this.i=null;this.d=null}};Type.registerNamespace("_lw");_lw._TI=function(){};_lw._TI.$$cctor=function(){var t="LocationWellView";new _A(t,function(){_lw._TI.a[t]===undefined&&(_lw._TI.a[t]=[[[-1,5,["SingleLineMode"],[_lw._TI.t],null,"_lw_a",null,null,1,null,null,null],[-1,5,["UseUnifiedForms"],[_lw._TI.o],null,"_lw_3",null,null,0,null,null,null],[-1,5,["ExpandedPortraitLayout"],[_lw._TI.r],null,"_lw_b",null,null,1,null,null,null]],[[-1,0,["PersonaViewModel"],[_lw._TI.e],null,"IsHidden",null,_lw._TI.i,1,_lw._TI.k(),null,!0]],[[-1,0,["PersonaViewModel"],[_lw._TI.e],null,"DataContext",null,_lw._TI.h,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_lw._TI.A,0,null,null,null,_lws.CalLWStrings.C],[-1,4,null,null,null,"ImageId",null,_lw._TI.z,0,null,null,null,_n.a.a()],[-1,1,["ShowDeleteButton"],[_lw._TI.s],null,"IsHidden",null,_lw._TI.i,1,_lw._TI.j(),null,!0],[-1,0,["DeletePlace"],[_lw._TI.d],null,"ClickCommand",null,_lw._TI.y,1,null,null,null]],null,[[-1,4,null,null,null,"FormatString",null,_lw._TI.u,0,null,null,null,_pecs.d.W]],[[-1,1,["AnchorSpacing"],[_lw._TI.p],null,"TypedownAnchorSpacing",null,_lw._TI.w,1,null,null,0],[-1,1,["AriaLabelledBy"],[_lw._TI.q],null,"AriaLabelledBy",null,_lw._TI.v,1,null,null,null],[-1,0,["FindPlaceViewModel"],[_lw._TI.n],null,"DataContext",null,_lw._TI.h,1,null,null,null],[0,5,["UseUnifiedForms"],[_lw._TI.m],null,"_lw_3",null,null,0,null,null,null]]]);var n=_lw._TI._hf.childNodes[0].cloneNode(!0);var i=new _fp.e(_B.a(n,[0,2,0]),_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));i.l(!0);i.k(!0);var c=new _b.X(_B.a(n,[0,1,0]));var h=new _fc.z(_B.a(n,[0,1]));var s=new _fc.b(_B.a(n,[0,0,1]));var l=new _fc.g;var o=new _fc.c;o.A(_E.a(["DeletePlace"],[_lw._TI.d],null,"Command",null,_lw._TI.f,1));o.i("ENTER");l.a([o]);s.G([l]);var u=new _pe.b(_B.a(n,[0,0,0]),_js.a.Instance.a(_a.m));u.y("PersonaView.LocationBasicDetailsPopup");var r=new _fc.z(_B.a(n,[0,0]));var a=new _fc.g;var e=new _fc.c;e.A(_E.a(["DeletePlace"],[_lw._TI.d],null,"Command",null,_lw._TI.f,1));e.i("DELETE");var f=new _fc.c;f.A(_E.a(["PersonaViewModel","EnterKeyCommand"],[_lw._TI.e,_lw._TI.x],null,"Command",null,_lw._TI.f,1));f.i("ENTER");a.a([e,f]);r.G([a]);var v=new _js.c(n.children[0]);return new _B(n,[v,r,u,s,h,c,i]).R({resolvedLocation:r,personaView:u,deleteButton:s,separatorCell:h,separatorText:c,findPlaceView:i}).b(i)},Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a(n,_js.a.Instance.a(_y.a))},!1,!1,!1,0,_lw._TI.a);var n="PlaceDetailedView";new _A(n,function(){_lw._TI.a[n]===undefined&&(_lw._TI.a[n]=[[[-1,5,["ShowSelectedOrIsTouched"],[_lw._TI.g],null,"ms-bg-color-themeLight",null,null,1,null,null,null]]]);var i=_lw._TI._hf.childNodes[1].cloneNode(!0);var t=new _pe.b(i.children[0],_js.a.Instance.a(_a.m));t.j("_lw_e ms-font-weight-semilight ms-font-color-neutralPrimary bidi");t.bq("_lw_f ms-font-weight-semilight ms-font-color-neutralSecondary bidi");t.y("PersonaView.DisplayPictureTwoLinesDetailsCustomStyle");return new _B(i,[t])},_pe.f,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_lw._TI.a)};_lw._TI.l=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_lw_2'> <span class='_lw_4 ms-fwt-r ms-bg-color-neutralLight'> <span class='_lw_5 ms-fwt-r ms-font-color-neutralSecondary-hover'></span> <button type='button' class='_lw_c ms-bg-color-neutralLight'></button>  </span>  <span class='_lw_6'> <span class='_lw_7 ms-font-s'></span> </span> <span class='_lw_8'> <div class='_lw_9 ms-font-s'></div> </span> </span> </div><div> <span class='_lw_d'></span> </div><div> <span class='_lw_g'></span> </div>";_js.c.a().appendChild(n);return n};_lw._TI.t=function(n){return n.c};_lw._TI.o=function(n){return n.q};_lw._TI.r=function(n){return n.h};_lw._TI.e=function(n){return n.k};_lw._TI.d=function(n){return n.o};_lw._TI.x=function(n){return n.M()};_lw._TI.s=function(n){return n.p};_lw._TI.n=function(n){return n.h};_lw._TI.p=function(n){return n.n};_lw._TI.q=function(n){return n.cA()};_lw._TI.m=function(n){return n.A};_lw._TI.g=function(n){return n.ct()};_lw._TI.i=function(n,t){n.M(t)};_lw._TI.f=function(n,t){n.k=t};_lw._TI.h=function(n,t){n.ba(t)};_lw._TI.A=function(n,t){n.by(t)};_lw._TI.y=function(n,t){n.be(t)};_lw._TI.z=function(n,t){n.i(t)};_lw._TI.u=function(n,t){n.c(t)};_lw._TI.w=function(n,t){n.o(t)};_lw._TI.v=function(n,t){n.bc(t)};_lw._TI.k=function(){_lw._TI.c||(_lw._TI.c=new _fc.m);return _lw._TI.c};_lw._TI.j=function(){_lw._TI.b||(_lw._TI.b=new _fc.k);return _lw._TI.b};CalendarLocationWellComponent.registerClass("CalendarLocationWellComponent",null,_a.iR);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b",_a.ea);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h",_h.fO);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i",_pc.l);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g",_fp.n);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a",_a.ea);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c",_a.ea);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e",_a.ea);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a",_h.dY.$$(Array),_pc.n,_pc.w);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b",_fp.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a",_a.by,_bc.t,_a.jO,_js.z,Sys.IDisposable,ILocationWellViewModel);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a",_js.b);_lw._TI.registerClass("_lw._TI");CalendarLocationWellComponent.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.d=new _H("s:streetAddress",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.b=new _H("s:addressLocality",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.e=new _H("b:addressSubregion",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.c=new _H("s:addressRegion",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.a=new _H("s:addressCountry",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.a=_a.a.dD;Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.b=new _g.n("PlaceItemQueryTable");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.e=new _H("@type",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.b=new _H("b:entityKey",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.d=new _H("s:name",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.c=new _H("s:geo",Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.a=new _H("s:address",Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.a=new _H("s:latitude",Number,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.b=new _H("s:longitude",Number,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.a=new _H("@graph",_js.f,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a=_a.a.ba;_lw._TI._hf=_lw._TI.l();_lw._TI.c=null;_lw._TI.b=null;_lw._TI.a={};_lw._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.locationwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
