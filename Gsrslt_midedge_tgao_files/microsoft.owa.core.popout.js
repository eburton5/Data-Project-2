try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.popout.js'] = (new Date()).getTime();
Type.registerNamespace("_po");_po.e=function(){};_po.e.prototype={thirdParty:1,owaUrlParameters:2,owaContext:3,unitTest:4};_po.e.registerEnum("_po.e",!1);function PopOutComponent(){}PopOutComponent.$$cctor=function(){_a.p.a().a(PopOutComponent)};PopOutComponent.prototype={a:function(n,t,i){var f=this;n.b(_po.c,function(){return new _po.c(n.a(_y.fd),i)}).b(IPopOutHelper).a();var u=this;n.b(_po.b,function(){return new _po.b(n.a(_y.a),n.a(IPopOutHelper),n.a(_a.bq),n.a(_a.h),n.a(_y.K),n.a(_ff.c),n.a(_a.z))}).b(IPopOutViewModel).a();var r=this;n.b(_po.d,function(){return new _po.d(n.c(IPopOutHelper),i.a())}).a()},b:function(){return[new _a.B(_po.d,1,17)]}};_po.d=function(n,t){if(t==="Mouse"){var i=this;n.e(function(n){n.a(_y.n,"ItemReadingPaneContext");n.a(_y.bM,"ChatPopOutContext")})}};_po.c=function(n,t){this.o={};this.j=new Array(0);this.k=n;this.m=t};_po.c.c=function(n,t){if(_po.c.a)return 4;var i=_po.c.b(n,t);return i?_y.cb.e(i)?3:2:1};_po.c.b=function(n,t){return!_js.d.b(t)&&n?n.getContext(t):null};_po.c.prototype={i:null,l:null,k:null,m:null,r:function(){if(!this.i){this.i={};this.i.ReadMessageItem=IItemReadingPaneViewModelPopOutFactory;this.i.ItemReadingPaneViewModelPopOutFactory=IItemReadingPaneViewModelPopOutFactory;this.i.Chat=IChatViewModelFactory;this.i.ItemAttachment=IItemAttachmentPopOutFactory;this.i.OwaOptionRichPeoplePickerViewModelFactory=IOwaOptionRichPeoplePickerViewModelFactory;this.i.IComposeCalendarItemViewModelFactory=IComposeCalendarItemViewModelFactory;this.i.OwaOptionPeoplePickerViewModelFactory=IOwaOptionPeoplePickerViewModelFactory;this.i.ICalendarItemDetailsViewModelFactory=ICalendarItemDetailsViewModelFactory;this.i.ISharingCalendarViewModelFactory=ISharingCalendarViewModelFactory;this.i.IMailComposeViewModelFactory=IMailComposeViewModelFactory;this.i.IMeetNowViewModelPopupFactory=IMeetNowViewModelPopupFactory;this.i.PersonaCardViewModelFactory=IPersonaCardViewModelFactory;this.i.TaskReadingPaneViewModelPopOutFactory=ITaskReadingPaneViewModelPopOutFactory;this.i.IAttachmentViewModelPopoutFactory=IAttachmentViewModelPopoutFactory;this.i.IUserDiagnosticsViewModel=IUserDiagnosticsViewModel;this.i.IDumpsterPopOutViewModelFactory=IDumpsterPopOutViewModelFactory;this.i.IBirthdayFactory=IBirthdayFactory}return this.i},n:function(){if(!this.l){_js.Trace.logInfo(_a.a.w,"Create SymbolToPopOutContextTypeMapping table");this.l={}}return this.l},c:function(n){return Type.isClass(n)&&(_a.by===n||n.inheritsFrom(_a.by)||n.implementsInterface(_bc.bd))||Type.isInterface(n)},b:function(n){var r=this.r();for(var i in r){var t={key:i,value:r[i]};var u=t.value;if(n===u)return t.key}return n.getName()},g:function(n){return this.r()[n]},f:function(n){var r=this.n();for(var i in r){var t={key:i,value:r[i]};var u=t.value;if(n===u)return t.key}this.w(n);throw Error.invalidOperation("Type "+n.toString()+" must be found in SymbolToPopOutContextTypeMappingTable");},a:function(n,t){this.p();_js.Trace.logInfo(_a.a.w,"Register popout context symbole {0} for type {1}",t,n.getName());var r=this;var i=function(){return new n};this.l[t]=n;this.o[t]=i;this.s()},v:function(n,t){this.p();var i=new _po.c.d;i.b=n;i.a=t;Array.add(this.j,i);this.s()},w:function(n){var r="";var i=this.n();for(var t in i){var f={key:t,value:i[t]};r+=f.key+";"}var u=String.format("Type {0} isn't found in SymbolToPopOutContextTypeMappingTable. Registered types: {1}. Current boot type: {2}. Current boot stage: {3}",n.getName(),r,this.m.d(),this.m.g());_js.Trace.logInfo(_a.a.w,u)},s:function(){if(this.j.length>0){for(var r=new Array(0),n=0;n<this.j.length;n++){var t=this.j[n];var i=this.o[t.b];if(i){var u=i();t.a(u)}else Array.add(r,t)}this.j=r}},p:function(){return!!this.n()},x:function(n){if(!this.c(n))throw Error.argument("The pop out control only supports creating ViewModels by passing in a IParameterizeableViewModelFactory");var t=this.k.a(n);if(!t)throw Error.argument(String.format("Could not instantiate IParameterizeableViewModelFactory {0}. The type is not registered in the IoC container.",n));return t},h:function(n,t,i,r,u,f,e){var o=null;var c=this.x(i);var s=r.wid;var h=_po.c.b(t,s);_a.Q.b=s;var a=_po.c.c(t,s);switch(a){case 4:o=this.d(c,_po.c.a,u,f);_po.c.a=null;break;case 1:o=this.e(c,r,u,f);break;case 2:this.t(n,t,s);_y.cb.a(h,this.k);o=this.e(c,r,u,f);break;case 3:this.t(n,t,s);_y.cb.a(h,this.k);var l=this;this.v(h.popOutContextSymbol,function(i){_y.cb.d(h,i);l.u(t,i);o=l.d(c,i,u,f);l.q(o,n,e)});return;default:_a.b.d(!0,"Unknown PopOutMode "+_po.e.toString(a));break}this.q(o,n,e)},q:function(n,t,i){if(!n||!n.length)throw Error.argument("The ViewModel provided in the url is not valid!");t.V(n[0],t.p());i(n)},d:function(n,t,i,r){var u;if(_bc.u.isInstanceOfType(n)){var f=n;u=f.f(t)}else u=[n.a(t,i,r)];return u},e:function(n,t,i,r){var u;if(_bc.u.isInstanceOfType(n)){var f=n;u=f.g(t)}else u=[n.b(t,i,r)];return u},u:function(n,t){if(!$a(t.V())&&t.V().length>0){n.get_mainWindowInstance()&&!n.get_mainWindowInstance().closed&&new _y.ex(n.get_mainWindowInstance(),t.V());for(var u=t.V(),f=u.length,i=0;i<f;++i){var r=u[i];_h.e.a().b(r.x(),r)}}},t:function(n,t,i){var r=this;n.x(function(){_a.Q.a(t.get_mainWindowInstance(),function(n){t.deRegisterWindow(i)})})}};_po.c.d=function(){};_po.c.d.prototype={b:null,a:null};_po.b=function(n,t,i,r,u,f,e){_po.b.initializeBase(this);this.l=n;this.g=t;this.n=i;this.i=r;this.q=u;this.p=f;this.o=e};_po.b.a=function(n,t,i){var r=n.a[i];_js.d.b(r)||(t[i]=r)};_po.b.prototype={l:null,g:null,h:null,j:null,n:null,i:null,q:null,p:null,o:null,m:null,b:function(n){this.m=n;return n},k:null,f:function(n){this.k=n;return n},a:function(n){this.j;this.j=n;return n},c:function(){if(!this.h){this.h=new _y.fT(this.q,this.p);window.popOutProjectionManager=this.h}return this.h},v:function(n,t,i,r,u){if(!this.g.c(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var e=this.m;if($a(e))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");var s=this.g.b(n);var f=null;r&&(f=this.g.f(Object.getType(r)));u=$a(u)?"_blank":u;var o=e(this,new _y.fP(s,t,i,r,f,u));this.k&&this.k(o)},d:function(n,t,i,r){this.e(n,t,i,r,null,!1,null)},e:function(n,t,i,r,u,f,e){if(!this.g.c(n))throw Error.argumentType("The parameter vmType should be ViewModel or IParameterableViewModelFactory type!");if(this.l.a()==="Mouse")this.t(n)?this.B(n,t,i,r,u,e):this.z(n,i,r,u);else{_js.Trace.logInfo(_a.a.h,"Open popout as popup in touch environment");try{this.A(t,i,u,f,n)}catch(s){var o=n?Object.getTypeName(n):"<empty>";_js.Trace.logException(_a.a.h,s,"PopOutViewModel.PopOutOrPopUpWithContext -- exception calling OpenPopUpForTouch with vmType: {0}",o);throw s;}}},r:function(n,t,i,r,u,f){var e;if($a(n))throw Error.argumentNull("factory");if($a(i))e=this.g.e(n,t,u,f);else{e=this.g.d(n,i,u,f);i.bP()&&!this.t(r)&&(window.document.title=i.bP())}return e},w:function(){return window.navigator.userAgent.indexOf("Edge/")>0?!1:this.n.b()!==1},t:function(n){return this.w()&&(this.y(n)||this.x(n))},y:function(n){return!!this.i&&this.i.a().T().Enabled&&Array.contains(_po.b.b,this.g.b(n))},x:function(n){return!!this.i&&this.i.a().bZ().Enabled&&this.g.b(n)==="IMailComposeViewModelFactory"},z:function(n,t,i,r){var u=this.o.b();_po.b.a(u,t,"flights");_po.b.a(u,t,"features");_po.b.a(u,t,"traceMessageMaxLength");_po.b.a(u,t,"traceComponents");_po.b.a(u,t,"traceLevel");_po.b.a(u,t,"perfTraceLevel");_po.b.a(u,t,"analyticsEnabled");this.v(n,t,i,r,"_blank")},B:function(n,t,i,r,u,f){if(!this.g.c(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var h=!!f;var e=null;if(h){this.h.onBeforeProjectionUnload(f);this.h.onProjectionUnload(f);e=f}else{if($a(this.j))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");e=this.j(this,r,"_blank")}if(e&&!e.closed){var c=_y.bI.b();_a.Q.b=c;var o=new _y.D;var s=this.r(t(),i,u,n,e,o);if(s.length>1)throw Error.invalidOperation("Popping up more than one view model is not currently supported for projection popout.");var l=this.h.e(s[0],e,u?u.bP():null,c,o);h&&l.m()}},A:function(n,t,i,r,u){var f=this.r(n(),t,i,u,null,null);if(f.length>1)throw Error.invalidOperation("Popping up more than one view model is not supported in touch environments. Please contact the Shell team if you have this requirement.");this.l.f(f[0],0,r)}};_po.a=function(n,t){this.g=Function.createDelegate(this,this.o);this.f=Function.createDelegate(this,this.n);_po.a.initializeBase(this,[n]);this.c=t;this.i(_bc.c.a().a);this.j(_bc.c.a().b);this.e(150);this.d(150);this.s(!1);this.t(!0);this.w(!1);this.v(!0);this.x(!0);this.Q(!1);this.r(!1);this.q(!0)};_po.a.o=function(n,t,i){i.wid=n;if(_po.a.a in i)return i[_po.a.a];else{var r="";var e=i;for(var o in e){var u={key:o,value:e[o]};r=r+"&"+encodeURIComponent(u.key)+"="+($a(u.value)?"":encodeURIComponent(u.value.toString()))}var f=window.location.pathname;if(!_js.d.b(t)){var s=r.indexOf("features")===-1&&r.indexOf("flights")===-1?"#":"?";f=f+s+"viewmodel="+t+r+"&"+"ispopout"+"=1"}return f}};_po.a.prototype={c:null,i:function(n){this.dR(_po.a.b,n);return n},j:function(n){this.dR(_po.a.n,n);return n},e:function(n){this.dR(_po.a.m,n);return n},d:function(n){this.dR(_po.a.k,n);return n},s:function(n){this.dR(_po.a.e,n);return n},t:function(n){this.dR(_po.a.f,n);return n},w:function(n){this.dR(_po.a.h,n);return n},v:function(n){this.dR(_po.a.g,n);return n},x:function(n){this.dR(_po.a.i,n);return n},Q:function(n){this.dR(_po.a.j,n);return n},r:function(n){this.dR(_po.a.d,n);return n},q:function(n){this.dR(_po.a.c,n);return n},m:function(){return this.a("height",_po.a.b)+this.a("width",_po.a.n)+this.a("top",_po.a.m)+this.a("left",_po.a.k)+this.a("menubar",_po.a.e)+this.a("resizable",_po.a.f)+this.a("status",_po.a.h)+this.a("scrollbars",_po.a.g)+this.a("titlebar",_po.a.i)+this.a("toolbar",_po.a.j)+this.a("location",_po.a.d)+this.a("directories",_po.a.c)},R:function(){_js.c.prototype.R.call(this);if(this.E()){var t=this.E();if(IPopOutViewModel.isInstanceOfType(t)){var n=this.E();n.b(this.f);n.a(this.g)}}},bk:function(){if(this.E()&&IPopOutViewModel.isInstanceOfType(this.E())){var n=this.E();n.b(null);n.a(null)}_js.b.prototype.bk.call(this)},p:function(n,t){this.k(t.popOutSize);var i=t.viewModelParams;var r=_po.a.o(n,t.viewModel,i);return this.h(r,!(_po.a.a in i),t.target)},l:function(){return _y.bI.b()},h:function(n,t,i){!n.startsWith("/")&&t&&(n="/"+n);this.U(n,t);var r=window.open(n,i,this.m());r||_js.Trace.logInfo(_a.a.w,"window.open returns null instance");return r},a:function(n,t){var i=this.dS(t);var r;r=Boolean.isInstanceOfType(i)?i?"yes":"no":i===null||i===undefined?"":i.toString();return n+"="+r+","},n:function(n,t){var s=t.viewModel;if(_js.d.b(s))throw Error.invalidOperation("The ViewModel of pop out request should not be null.");var u=this.l();var r=this.p(u,t);var i=t.context;if(!this.b(r)){var o=null;i&&i.V()&&(o=_y.ex.a(r,i.V()));if(!this.b(r)){var c=_y.cb.c(s,i,t.popOutContextSymbol);this.c.registerPopOut(u,r,o,c,!1)}if(i&&i.br()){window.popOutErrorCallbacks||(window.popOutErrorCallbacks={});var a=this;var l=function(n){i.br()(n);delete window.popOutErrorCallbacks[u]};window.popOutErrorCallbacks[u]=l}}this.b(r)&&i&&i.br()&&i.br()("PopOutBlocked");if(_po.a.l in t.viewModelParams){var f=t.viewModelParams[_po.a.l];if(f)if(this.b(r))f();else{var e=null;var h=this;e=_js.g.a().e(_a.a.w,"PopOut",function(){if(h.b(r)){e&&_js.g.a().b(e);f()}},1e3)}}return r},o:function(n,t,i){this.k(t);var u=window.location.pathname+"projection.aspx";return this.h(u,!0,i)},k:function(n){var t=n||_bc.c.a();this.i(t.a);this.j(t.b);if(t.c!==-1&&t.d!==-1){this.e(t.d);this.d(t.c)}else{this.e(150);this.d(150)}},U:function(n,t){!t},b:function(n){try{return!n||n.closed}catch(t){_js.Trace.logInfo(_a.a.w,"Exception is thrown when checking window.closed: {0}",t.message);return!0}}};_po._TI=function(){};_po._TI.$$cctor=function(){var n="Wrapper.PopOut";new _A(n,function(){_po._TI.a[n]===undefined&&(_po._TI.a[n]=[null]);var t=_po._TI._hf.childNodes[0].cloneNode(!0);var i=new _po.a(t.children[0],_js.a.Instance.a(_y.K));return new _B(t,[i])},IPopOutViewModel,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_po._TI.a)};_po._TI.b=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div></div> </div>";_js.c.a().appendChild(n);return n};PopOutComponent.registerClass("PopOutComponent",null,_a.iR);_po.d.registerClass("_po.d");_po.c.registerClass("_po.c",null,IPopOutHelper);_po.c.d.registerClass("_po.c.d");_po.b.registerClass("_po.b",_a.by,IPopOutViewModel);_po.a.registerClass("_po.a",_js.b);_po._TI.registerClass("_po._TI");PopOutComponent.$$cctor();_po.c.a=null;_po.b.b=["ReadMessageItem","ItemAttachment"];_po.a.a="AuthenticationEndpointUrl";_po.a.l="PopOutClosedCallback";_po.a.b=new _H("Height",Number,_po.a);_po.a.n=new _H("Width",Number,_po.a);_po.a.m=new _H("Top",Number,_po.a);_po.a.k=new _H("Left",Number,_po.a);_po.a.e=new _H("IsMenubarVisible",Boolean,_po.a);_po.a.f=new _H("IsResizeable",Boolean,_po.a);_po.a.h=new _H("IsStatusVisible",Boolean,_po.a);_po.a.g=new _H("IsScrollbarVisible",Boolean,_po.a);_po.a.i=new _H("IsTitlebarVisible ",Boolean,_po.a);_po.a.j=new _H("IsToolbarVisible",Boolean,_po.a);_po.a.d=new _H("IsLocationVisible",Boolean,_po.a);_po.a.c=new _H("IsDirectoriesVisible",Boolean,_po.a);_po._TI._hf=_po._TI.b();_po._TI.a={};_po._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.popout.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.popout.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
