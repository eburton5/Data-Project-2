try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.imagealbumviewer.js'] = (new Date()).getTime();
function ImageAlbumViewerComponent(){}ImageAlbumViewerComponent.$$cctor=function(){_a.p.a().a(ImageAlbumViewerComponent)};ImageAlbumViewerComponent.prototype={a:function(n,t,i){n.e(_iav.d).b(IImageAlbumViewModelFactory)},b:function(){return null}};Type.registerNamespace("_iav");_iav.c=function(n,t,i){this.c=n;this.a=t;this.b=i};_iav.c.prototype={b:null,c:null,a:null};_iav.d=function(){};_iav.d.prototype={a:function(){return new _iav.b}};_iav.b=function(){_iav.b.initializeBase(this);this.i(new _js.f)};_iav.b.prototype={f:null,g:null,e:function(){return this.g},h:function(n){if(this.g!==n){this.g=n;this.dQ("SelectedItem")}return n},i:function(n){if(this.f!==n){this.f=n;this.dQ("Images")}return n},d:function(){return this.f.k(this.g)},b:function(n,t,i){this.f.a(new _iav.c(n,t,i))},c:function(){this.f.f()},a:function(n){for(var i=this.f.x.length,t=0;t<i;t++)if(this.f.x[t].a===n){this.h(this.f.x[t]);break}}};_iav.a=function(n,t){this.l=Function.createDelegate(this,this.bC);this.m=Function.createDelegate(this,this.bJ);this.n=Function.createDelegate(this,this.bK);this.k=Function.createDelegate(this,this.bB);this.o=Function.createDelegate(this,this.c);this.bd=Function.createDelegate(this,this.bw);this.Z=Function.createDelegate(this,this.bt);this.U=Function.createDelegate(this,this.br);this.Q=Function.createDelegate(this,this.bq);_iav.a.initializeBase(this,[n]);this.y("ImageStrip");this.f=t;this.p=new _C(this.Q,_a.a.L);this.q=new _C(this.U,_a.a.L);this.t=new _C(this.Z,_a.a.L);this.v=new _C(this.bd,_a.a.L)};_iav.a.prototype={e:null,g:null,a:null,p:null,q:null,t:null,v:null,f:null,b:null,i:!1,j:!1,r:null,s:null,h:!1,d:null,bl:function(n){if(this.i!==n){this.i=n;this.bj("LeftArrowHidden")}return n},bn:function(n){if(this.j!==n){this.j=n;this.bj("RightArrowHidden")}return n},w:function(n){if(this.h!==n){this.h=n;this.bj("IsShrunken")}return n},J:function(){_js.b.prototype.J.call(this);this.bN()},K:function(){_js.b.prototype.K.call(this);if(this.F){this.a=this.F.a("ScrollRegion");this.e=this.F.a("ContainerDiv");this.g=this.F.a("BackgroundDiv");this.s=this.F.a("ScaleUpAnimationDiv").eb;this.r=this.F.a("ScaleDownAnimationDiv").eb;this.w(!0);this.a.i(this.o)}this.x();var n=this;this.d=_js.g.a().a(this.H(),"ImageStrip.OnApplyTemplate",function(){n.d=null;n.c()},1e3)},bk:function(){this.bQ();this.a.k(this.o);this.d&&(this.d=_js.g.a().b(this.d));_js.b.prototype.bk.call(this)},bN:function(){this.B.mouseenter(this.k);this.B.mouseleave(this.n)},bQ:function(){this.B.unbind("mouseenter",this.k);this.B.unbind("mouseleave",this.n)},bJ:function(n,t){var r=this.E();var i=r.f.k(r.g);i>=0&&this.bG(i)},bK:function(n){this.b&&this.b.b(!1);var t=this;this.b=this.f.a(this.r,this.g.z,function(){t.w(!0);t.b=null},!1);this.b.a();this.c()},bB:function(n){this.b&&this.b.b(!1);var t=this;this.b=this.f.a(this.s,this.g.z,function(){t.w(!1);t.b=null},!1);this.b.a();this.c()},bq:function(){this.bf(!1)},br:function(){this.bf(!0)},bg:function(){var n=this.a.z;return n.clientWidth-164},bw:function(){var n;(n=this.a).e(n.l()+this.bg())},bt:function(){var n;(n=this.a).e(n.l()-this.bg())},c:function(){var i=this.E();if(i)if(this.a){var r=!1;var n=!1;this.a.l()||(r=!0);var u=i.f.x.length*164;var t=this.a.z;t.scrollLeft+t.clientWidth>=u&&(n=!0);this.bl(r);this.bn(n)}else{this.bl(!0);this.bn(!0)}},bG:function(n){var t=this.a.z;var i=n*164;var r=i+164;i<t.scrollLeft?this.a.e(i):r>t.scrollLeft+t.clientWidth&&this.a.e(r-t.clientWidth)},bf:function(n){var t=this.E();if(t.g)t.h(t.f.x[0]);else{var i=t.f.k(t.g);n?i++:i--;i<0?i=t.f.x.length-1:i>=t.f.x.length&&(i=0);t.h(t.f.x[i])}},bu:function(){_js.H.prototype.bu.call(this);var n=this.E();if(n){n.rpcl("SelectedItem",this.m);n.rpcl("Images",this.l)}},R:function(){_js.c.prototype.R.call(this);var n=this.E();if(n){n.apcl("SelectedItem",this.m);n.apcl("Images",this.l)}this.x();this.c()},bC:function(n,t){this.x();this.c()},x:function(){if(this.e){var n=this.E();if(n&&n.f){var t=n.f.x.length*164+94+1;this.e.z.style.width=t+"px";this.e.z.style.maxWidth="100%"}}}};_iav._TI=function(){};_iav._TI.$$cctor=function(){var i="ImageStrip._tid1";new _A(i,function(){_iav._TI.a[i]===undefined&&(_iav._TI.a[i]=[[[-1,1,["CurrentImageId"],[_iav._TI.b],null,"Id",null,_iav._TI.f,1,null,null,null]]]);var n=_iav._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_iav.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_iav._TI.a);var r="ImageStrip._tid2";new _A(r,function(){_iav._TI.a[r]===undefined&&(_iav._TI.a[r]=[[[-1,1,["CurrentImageId"],[_iav._TI.b],null,"Id",null,_iav._TI.f,1,null,null,null]]]);var n=_iav._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t])},_iav.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_iav._TI.a);var n="ImageStrip.ItemTemplate";new _A(n,function(){_iav._TI.a[n]===undefined&&(_iav._TI.a[n]=[[[-1,0,["ThumbnailSize"],[_iav._TI.n],null,"ViewSize",null,_iav._TI.l,1,null,null,0],[-1,0,["ThumbnailInfo"],[_iav._TI.m],null,"AttachmentImageInfo",null,_iav._TI.k,1,null,null,null]]]);var t=_iav._TI._hf.childNodes[1].cloneNode(!0);var i=new _at.q(_B.a(t,[0,0]));return new _B(t,[i])},_iav.c,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_iav._TI.a);var t="ImageStrip";new _A(t,function(){_iav._TI.a[t]===undefined&&(_iav._TI.a[t]=[null,null,[[-1,5,["IsShrunken"],[_iav._TI.r],null,"_phu_3",null,null,1,null,null,null]],null,[[-1,4,null,null,null,"Title",null,_iav._TI.i,0,null,null,null,_nbs.a.FB],[-1,4,null,null,null,"ImageId",null,_iav._TI.d,0,null,null,null,_fm.a.E],[-1,1,["ScrollLeftCommand"],[_iav._TI.w],null,"ClickCommand",null,_iav._TI.c,1,null,null,null],[-1,1,["LeftArrowHidden"],[_iav._TI.u],null,"IsHidden",null,_iav._TI.h,1,null,null,!0]],null,[[-1,0,["Images"],[_iav._TI.o],null,"DataSource",null,_iav._TI.y,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_iav._TI.i,0,null,null,null,_nbs.a.FB],[-1,4,null,null,null,"ImageId",null,_iav._TI.d,0,null,null,null,_fm.a.n],[-1,1,["ScrollRightCommand"],[_iav._TI.x],null,"ClickCommand",null,_iav._TI.c,1,null,null,null],[-1,1,["RightArrowHidden"],[_iav._TI.v],null,"IsHidden",null,_iav._TI.h,1,null,null,!0]]]);var n=_iav._TI._hf.childNodes[3].cloneNode(!0);var u=new _fc.b(_B.a(n,[2,0,2,0]));u.d("ms-font-color-neutralSecondary");u.a("ms-font-color-neutralDark");u.y("ImageStrip._tid2");var r=new _jc.a(_B.a(n,[2,0,1,0]));var a=new _fc.g;var o=new _fc.c;o.D(_E.a(["ContextParent","KeyboardLeftCommand"],[_iav._TI.g,_iav._TI.s],null,"Command",null,_iav._TI.e,1));o.i("LEFTARROW");var e=new _fc.c;e.D(_E.a(["ContextParent","KeyboardRightCommand"],[_iav._TI.g,_iav._TI.t],null,"Command",null,_iav._TI.e,1));e.i("RIGHTARROW");a.a([o,e]);r.G([a]);r.h(function(){var t=_iav._TI._hf.childNodes[2].cloneNode(!0).childNodes[0];var n=new _js.b(t);n.y("ImageStrip.ItemTemplate");return n});var f=new _jc.b;f.A(_E.a(["SelectedItem"],[_iav._TI.p],_iav._TI.q,"SelectedItem",_iav._TI.z,_iav._TI.A,2));f.j("_phu_b");r.j(f);var l=new _fce.f(_B.a(n,[2,0,1]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));var i=new _fc.b(_B.a(n,[2,0,0,0]));i.d("ms-font-color-neutralSecondary");i.a("ms-font-color-neutralDark");i.y("ImageStrip._tid1");var v=new _js.c(_B.a(n,[2,0]));var s=new _js.c(n.children[2]);var h=new _js.c(n.children[1]);var c=new _js.c(n.children[0]);return new _B(n,[c,h,s,v,i,l,r,u]).R({ScaleUpAnimationDiv:c,ScaleDownAnimationDiv:h,BackgroundDiv:s,ContainerDiv:v,ScrollRegion:l})},_iav.b,_iav.a,function(n){return new _iav.a(n,_js.a.Instance.a(_b.a))},!1,!1,!1,0,_iav._TI.a)};_iav._TI.j=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_phu_c'></span> </div><div> <div class='_phu_a'> <img/> </div> </div><div><div class='_phu_9'></div></div><div>  <div style=\"display: none\" class='_phu_f'></div> <div style=\"display: none\" class='_phu_d'></div> <div class='_phu_2'> <div class='_phu_4'> <div class='_phu_5'> <button type='button'></button> </div> <div class='_phu_7'> <div>    </div> </div> <div class='_phu_6'> <button type='button'></button> </div> </div> </div>  </div>";_js.c.a().appendChild(n);return n};_iav._TI.b=function(n){return n.s()};_iav._TI.n=function(n){return 3};_iav._TI.m=function(n){return n.b};_iav._TI.r=function(n){return n.h};_iav._TI.w=function(n){return n.t};_iav._TI.u=function(n){return n.i};_iav._TI.o=function(n){return n.f};_iav._TI.g=function(n){return n.L};_iav._TI.s=function(n){return _iav.a.isInstanceOfType(n)?n.p:null};_iav._TI.t=function(n){return _iav.a.isInstanceOfType(n)?n.q:null};_iav._TI.p=function(n){return n.g};_iav._TI.z=function(n){return n.d};_iav._TI.x=function(n){return n.v};_iav._TI.v=function(n){return n.j};_iav._TI.f=function(n,t){n.a(t)};_iav._TI.l=function(n,t){n.k(t)};_iav._TI.k=function(n,t){n.j(t)};_iav._TI.i=function(n,t){n.by(t)};_iav._TI.d=function(n,t){n.i(t)};_iav._TI.c=function(n,t){n.be(t)};_iav._TI.h=function(n,t){n.M(t)};_iav._TI.y=function(n,t){n.m(t)};_iav._TI.e=function(n,t){n.k=t};_iav._TI.q=function(n,t){n.h(t)};_iav._TI.A=function(n,t){n.f(t)};ImageAlbumViewerComponent.registerClass("ImageAlbumViewerComponent",null,_a.iR);_iav.c.registerClass("_iav.c",null,IAlbumImage);_iav.d.registerClass("_iav.d",null,IImageAlbumViewModelFactory);_iav.b.registerClass("_iav.b",_a.by,IImageStripViewModel,_a.jO,_js.z,Sys.IDisposable);_iav.a.registerClass("_iav.a",_js.b);_iav._TI.registerClass("_iav._TI");ImageAlbumViewerComponent.$$cctor();_iav._TI._hf=_iav._TI.j();_iav._TI.a={};_iav._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.imagealbumviewer.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.imagealbumviewer.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
