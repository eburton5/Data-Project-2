try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.im.js'] = (new Date()).getTime();
Type.registerNamespace("_im");_im.n=function(n){_im.n.initializeBase(this);this.a=n};_im.n.prototype={a:null,t:function(n){this.a.d(1);n.cO(this.a.b(),null,this.r,this.q)},cz:function(n,t,i){if(n===-9){_js.Trace.logInfo(_a.a.i,"AcceptChatAction.ProcessResult: Suppressing 'ConversationEnded' error.");n=0}if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.a.d(3);_js.Trace.logInfo(_a.a.i,"AcceptChatSession web service call succeeded for chat {0}.",this.a.b());t()},G:function(){_a.de.prototype.G.call(this)}};_im.o=function(n,t){this.j=n;this.k=t};_im.o.prototype={k:null,j:null,a:function(n,t){return this.j.d(n,t)},b:function(n,t){return this.j.c(n,t)},g:function(n,t){return null},h:function(n,t){return null},i:function(n,t){return new _im.C(n,t)},f:function(n){return this.k.b(n)}};_im.u=function(n,t){_im.u.initializeBase(this);this.a=n;this.c=t};_im.u.prototype={a:null,c:null,D:function(){_a.de.prototype.D.call(this);this.c.q(this.a)},t:function(n){if(this.a.b()===-1){this.a.d(4);return}n.gv(this.a.b(),null,this.r,this.q)},cz:function(n,t,i){this.a.d(4);if(!n){i(Error.create("EndChatAction returned false."));return}t()}};_im.v=function(n){this.a=n};_im.v.prototype={a:null,b:function(n){return new _im.u(n,this.a)}};_im.w=function(n){_im.w.initializeBase(this);_a.b.j(n,"sipUris");this.a=n};_im.w.prototype={a:null,t:function(n){n.ew(this.a,null,this.r,this.q)},cz:function(n,t,i){if(n<0){i(Error.create("GetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_im.x=function(n){_im.x.initializeBase(this);this.a=n};_im.x.prototype={a:!1,c:!1,t:function(n){n.eP(this.a,null,this.r,this.q)},cz:function(n,t,i){if(n<0){if(n!==-2){_js.Trace.logInfo(_a.a.i,"Sign in failed with code {0}, will retry.",n);this.c=!0}i(Error.create("InstantMessageOperationError: "+n));return}t()}};_im.y=function(n){_im.y.initializeBase(this);this.a=n};_im.y.prototype={a:!1,t:function(n){n.eQ(this.a,null,this.r,this.q)},cz:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}t()}};_im.B=function(){_im.B.initializeBase(this)};_im.B.prototype={t:function(n){n.cl(null,this.r,this.q)},cz:function(n,t,i){if(n<0){i(Error.create("ResetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_im.C=function(n,t){_im.C.initializeBase(this);this.a=n;this.c=t};_im.C.prototype={c:null,a:null,D:function(){_a.de.prototype.D.call(this)},t:function(n){this.a.H()||this.a.d(1);var t=new _g.iT(this.c);t.ChatSessionId=this.a.b();t.Recipients=this.a.U();t.Subject=this.a.m();n.cq(t,null,this.r,this.q)},cz:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.a.o(n);this.a.d(3);t()},G:function(){$a(this.s.message)&&this.a.p(_nbs.a.OP);_a.de.prototype.G.call(this)}};_im.D=function(n,t){_im.D.initializeBase(this);_a.b.c(n,"sipUri");this.c=n;this.a=t};_im.D.prototype={c:null,a:"None",t:function(n){var t=new _g.pS;t.Presence=this.a;n.cy(t,null,this.r,this.q)},cz:function(n,t,i){var r=n;if(r){i(Error.create("SetPresenceAction failed with InstantMessageOperationError: "+r));return}t()}};_im.l=function(n,t,i,r,u){_im.l.initializeBase(this);_a.b.a(i,"participants");_a.b.g(i.w.length,0,"participants.Count");if(!$a(u)){if(i.w.length!==1)throw Error.invalidOperation("imAddress can only be used in conjunction with a single participant.");if(!$a(r))throw Error.invalidOperation("imAddress and itemOrConversation are mutually exclusive.");}this.b=n;this.a=this.f(i);_a.b.g(this.a.w.length,0,"No valid participants.");this.e=t;this.d=r;this.c=u};_im.l.prototype={b:null,e:null,a:null,d:null,c:null,D:function(){_a.de.prototype.D.call(this);if(!$a(this.e)){this.e.a(this.a,this.d,this.c);return}this.b.u(this.a,this.d,this.c)},N:function(){return 0},f:function(n){for(var u=new _js.f,f={},e=n.w.length,i=0;i<e;i++){var t=n.w[i];if(t&&this.b.a(t.g())){var r=t.g();if(!(r in f)){u.a(t);f[r]=t}}}return u}};_im.m=function(n,t){this.a=n;this.b=t};_im.m.prototype={a:null,b:null,d:function(n,t){return new _im.l(this.a,this.b,n,t,null)},c:function(n,t){var i=new _js.f;i.a(n);return new _im.l(this.a,this.b,i,null,t)}};_im.E=function(n){_im.E.initializeBase(this);_a.b.j(n,"sipUris");this.a=n};_im.E.prototype={a:null,t:function(n){n.gl(this.a,null,this.r,this.q)},cz:function(n,t,i){if(n<0){i(Error.create("SubscribeForPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_im.F=function(n){_im.F.initializeBase(this);_a.b.c(n,"sipUri");this.a=n};_im.F.prototype={a:null,t:function(n){n.gw(this.a,null,this.r,this.q)},cz:function(n,t,i){if(n<0){i(Error.create("UnsubscribeFromPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_im.p=function(n){this.b=n.a/1e3;this.a={}};_im.p.prototype={b:0,a:null,e:function(n){this.c();this.a[n.toString()]=this.d()},f:function(n){this.c();return n.toString()in this.a},d:function(){return _a.c.a()},c:function(){var s=this.d();var u=new _ff.e;var f=this.a;for(var r in f){var i={key:r,value:f[r]};var h=i.value;var c=h.A(this.b);c.c(s)<0&&u.c(i.key)}for(var t=u.i(),o=t.length,n=0;n<o;++n){var e=t[n];delete this.a[e]}}};_im.a=function(n,t,i,r,u,f,e){this.Q=Function.createDelegate(this,this.bD);this.bg=Function.createDelegate(this,this.cc);this.bh=Function.createDelegate(this,this.cd);this.bb=Function.createDelegate(this,this.bV);this.bk=Function.createDelegate(this,this.cj);this.X=Function.createDelegate(this,this.U);this.R=Function.createDelegate(this,this.bU);this.bc=Function.createDelegate(this,this.bW);this.bd=Function.createDelegate(this,this.bX);this.be=Function.createDelegate(this,this.bY);this.bf=Function.createDelegate(this,this.bZ);this.bi=Function.createDelegate(this,this.ce);this.bj=Function.createDelegate(this,this.cg);this.Z=Function.createDelegate(this,this.bS);this.ba=Function.createDelegate(this,this.bT);this.bl=Function.createDelegate(this,this.ck);this.A=new _js.f;this.C=new _js.f;this.F=new _js.f;_im.a.initializeBase(this);this.h("Initialization","unknown");this.z=t;this.bo(this.z.c);if(!n){this.h("Initialization","Disabled");return}this.B=i;this.D=!0;this.G=!1;this.M=new _im.p(_a.ct.b(30));var s=new _g.be;s.NotificationType="InstantMessageNotification";this.P=new _h.L(s,this.B,r);this.P.w(this.bl);if(u&&e){this.V=!0;_js.Trace.logInfo(_a.a.i,"ChatManager: Waiting for the pending-get activation event.");var o=this;u.b(_a.di,function(n){_js.Trace.logInfo(_a.a.i,"ChatManager: Pending-get activated.");o.N=!0;o.bC()});var h=this;u.b(_a.em,function(){h.bm()});u.b(_a.cL,this.ba);f?this.bQ(f):this.y="Disabled"}this.A.d(this.Z);this.H=this.bF(this.B)};_im.a.d=function(n,t,i){var r;var f,u;if(u=n.N(function(n){return n.b()===t},f={val:r}),r=f.val,u){i.val=r;return!0}i.val=null;return!1};_im.a.e=function(n,t,i){var r;var f,u;var e=(u=n.N(function(n){var i=n;if(i.a().w.length!==1)return!1;var r=i.a().w[0];return r.g()===t?!0:!1},f={val:r}),r=f.val,u);i.val=r;return e};_im.a.prototype={z:null,V:!1,S:null,J:null,N:!1,L:!1,W:!1,M:null,B:null,K:!1,D:!1,O:!1,y:"unknown",E:null,G:!1,P:null,H:null,bo:function(n){this.by(_im.a.a,n)},bA:function(n){this.bN(_im.a.a,n)},e:function(){return this.y},b:function(){return this.y==="SignedIn"},f:function(){this.bq("IsEnabled");return this.y!=="Disabled"},j:function(){return this.A},l:function(){return this.C},k:function(){return this.F},m:function(){return this.W},c:function(){this.bq("CurrentUserSipUri");return this.J},s:function(n){if(!this.N){_js.Trace.logInfo(_a.a.i,"Ignoring a SignIn attempt because the pending-get connection is not yet started.");return}this.D=!0;this.G=n;this.U()},t:function(n){_js.Trace.logInfo(_a.a.i,"Signing out.");var t=new _im.y(n);t.v(this.bj);t.u(this.bi);this.h("SignOut:Manual="+n,"AttemptingSignOut");this.B.a(t)},g:function(n,t,i){var f=_im.b.a(t);var e;var r,u;var o=(u=this.z.f(f,r={val:e}),e=r.val,u);this.bJ(n,f,_im.b.b(i),o)},v:function(n,t){var i=new _im.D(_im.b.a(n),t);i.v(this.bf);i.u(this.be);this.B.a(i)},h:function(n,t){t==="Error";_js.Trace.logInfo(_a.a.i,"SignInState: {0} Requesting change from {1} to {2}",n,this.y,t);var i=this.b();if(this.y!==t){this.y=t;this.bt(_im.a.b);this.b()!==i&&this.bt(_im.a.c)}},w:function(n,t){_js.Trace.logInfo(_a.a.i,"Setting current user SIP URI to {0}",t);this.J=t},r:function(){if(this.y==="SignedIn"){_js.Trace.logInfo(_a.a.i,"ResetPresence");var n=new _im.B;n.v(this.bd);n.u(this.bc);this.B.a(n)}},u:function(n,t,i){_js.Trace.logInfo(_a.a.i,"Starting chat.");_a.b.b(n,"basePersonaParticipants");_a.b.g(n.w.length,0,"basePersonaParticipants.Count");$a(i)||_a.b.f(n.w.length,1,"When imAddress is specified, participant count must be 1.");for(var u=new _js.f,w=n.w.length,o=0;o<w;o++){var y=n.w[o];var p=_pc.a.d(y);u.a(p)}var r=null;if(u.w.length===1){var e=u.w[0];var f=null;$a(i)?$a(e.g())||(f=e.g()):f=i;if(!$a(f)){var h,s;s=_im.a.e(this.A,f,h={val:r}),r=h.val,s}var c=e.d();if(!_js.d.b(f)&&!_js.d.b(c)){var v=_im.b.a(f);this.z.d("StartChat (single participant)",v,c,e.dj,!0)}}else{var l=this;u.u(function(n){var t=n;var r=t.g();var i=t.d();if(!_js.d.b(r)&&!_js.d.b(i)){var u=_im.b.a(r);l.z.d("StartChat (multiple participants)",u,i,t.dj,!0)}})}if(!r){r=this.br(u,t);this.bn(r);if(!$a(i)){var a=u.w[0];r.bb(a,i)}}_g.h.isInstanceOfType(t)?r.O(t):_g.z.isInstanceOfType(t)&&r.N(t);return r},i:function(n){_js.Trace.logInfo(_a.a.i,"Accepting invitation.");this.C.m(n,!0);this.bn(n);var t=new _im.n(n);this.B.a(t)},p:function(n){_js.Trace.logInfo(_a.a.i,"Ignoring invitation.");this.C.m(n,!0);this.M.e(n.b())},q:function(n){_js.Trace.logInfo(_a.a.i,"Removing chat {0}",n.b());n.d(4);n.a().e(this.R);var i=this.A.m(n,!0);var t=this.C.m(n,!0);$a(n.c())||_h.e.a().c(n.c().Id)},bV:function(n){if(n.EventType==="Reload"){_js.Trace.logWarning(_a.a.i,"ChatManager.OnIMNotification: Received a 'Reload' notification from the OWA server, assuming server has rebooted or connection re-established");this.D=!0;this.I(!1);return}var t=n;var i=t.PayloadType;if($a(i)){_js.Trace.logWarning(_a.a.i,"ChatManager.OnIMNotification: Unexpected notification payload: {0}, {1}",n.EventType,n.toString());return}if(i==="ServiceUnavailable"){if(t.ServiceError==="ClientSignOut"){_js.Trace.logWarning(_a.a.i,"ChatManager.OnIMNotification: Service unavailable, client signed out.  {0}",t.ErrorMessage);this.h("IMNotification","SignedOut");return}_js.Trace.logWarning(_a.a.i,"ChatManager.OnIMNotification: Received a 'ServiceUnavailable' notification: {0}, {1}.",t.ServiceError,t.ErrorMessage);this.I(!1);return}if(i==="SignOn")if(t.SignOnStarted){_js.Trace.logInfo(_a.a.i,"ChatManager.OnIMNotification: Sign-on started.");return}else{_js.Trace.logInfo(_a.a.i,"ChatManager.OnIMNotification: Sign-on succeeded.");this.I(!0);this.ca();this.W=t.IsUserInUcsMode;return}if(i==="UpdateUserPresence"||i==="UserPresenceChange"||i==="QueryUserPresenceChange"){this.bI(t);return}this.z.l(t);!$a(t.Persona)&&$a(t.Persona.ImAddress)&&(t.Persona.ImAddress=t.SipUri);if(t.PayloadType==="PendingContactList"){if($a(t.PendingContacts)){_js.Trace.logWarning(_a.a.bJ,"The payload for PendingContacts is empty");return}this.bE(t.PendingContacts);return}if(t.PayloadType==="AddToBuddyList"){if($a(t.AddedContacts)){_js.Trace.logWarning(_a.a.bJ,"The payload for AddedContacts is empty");return}this.ci(t.AddedContacts)&&_js.Trace.logInfo(_a.a.bJ,"Removed already added contact from pending buddyRequests");return}if(t.PayloadType==="EmptySubscribers"){this.bH();_js.Trace.logInfo(_a.a.bJ,"Removed already added contact from pending buddyRequests after receiving emptysubscribers");return}if(!("ChatSessionId"in t)){_js.Trace.logInfo(_a.a.i,"Notification {0} not supported, no session id.",i);return}if(this.M.f(t.ChatSessionId)){_js.Trace.logInfo(_a.a.i,"ChatManager.OnIMNotification: {0} for conversation {1} was ignored.",t.PayloadType,t.ChatSessionId);return}_js.Trace.logInfo(_a.a.i,"ChatManager.OnIMNotification: {0}, Session={1}, SipUri={2}",i,t.ChatSessionId,t.SipUri);var r;var e,o,u,f;if((o=_im.a.d(this.A,t.ChatSessionId,e={val:r}),r=e.val,o)||(f=_im.a.d(this.C,t.ChatSessionId,u={val:r}),r=u.val,f)){var s=this.z.b(t.SipUri,t.DisplayName);this.ch(t,r,s);return}_js.Trace.logInfo(_a.a.i,"No matching chat found for session {0}",t.ChatSessionId);this.cl(t)},d:function(n){for(var r=n.b(),t=0;t<r;t++){var i=n.a(t);if(i&&this.a(i.SipUri))return!0}return!1},a:function(n){return _js.d.b(n)?!1:_js.d.b(this.c())?!1:n.toLowerCase()===this.c().toLowerCase()?!1:!0},n:function(n){return _im.b.b(n)},o:function(n){return _im.b.d(n)},bF:function(n){return new _im.A(n)},bG:function(){this.h("DelayInternalSignIn","AttemptingSignIn");_js.g.a().a(_a.a.i,"ChatManager.InternalSignIn",this.X,3e4)},bu:function(){this.bA(this.z.c);_js.x.prototype.bu.call(this)},cd:function(n){_js.Trace.logInfo(_a.a.i,"Sign-in action succeeded.  Awaiting notification.");this.E=_js.g.a().a(_a.a.i,"ChatManager.SignInNotificationTimeout",this.bk,1e4)},cc:function(n){_js.Trace.logInfo(_a.a.i,"Sign-in action failed.");var t=n;if(t.A===-11){_js.Trace.logInfo(_a.a.i,"Automatic sign-in rejected because the user was explicitly signed out.");this.h("Automatic Sign-In Rejected","SignedOut");return}_js.Trace.logWarning(_a.a.i,"Sign-in failed: {0}",t.s.message);this.I(!1)},cj:function(){_js.Trace.logWarning(_a.a.i,"Sign-in timeout expired.  Current sign-in state: {0}, ServiceAvailable: {1}.",this.y,this.K);this.y!=="SignedIn"&&this.I(!1)},cg:function(n){_js.Trace.logInfo(_a.a.i,"Sign-out succeeded.");this.h("SignOutSucceeded","SignedOut")},ck:function(n,t){if(!this.O){_js.Trace.logInfo(_a.a.i,"Subscribed to notifications.");this.O=!0;this.U()}},bR:function(n,t,i){if(this.y!=="Disabled"){var r=n?"SignedOut":"Disabled";if(_js.d.a(i)){_js.Trace.logInfo(_a.a.i,"The currentUserSipUri is null/empty -> Marking SignInState as disabled.");r="Disabled"}else i=_im.b.a(i);this.h("Configuration Updated",r)}this.S=t;this.w("InternalSetConfiguration",i);this.L=!0},U:function(){if(!this.O){_js.Trace.logInfo(_a.a.i,"Subscribing to notifications.");this.P.m(_a.a.i,"OnIMNotification",this.bb,1);return}_js.Trace.logInfo(_a.a.i,"Signing in. Manual: {0}, will retry: {1}",this.G,this.D);var n=new _im.x(this.G);n.v(this.bh);n.u(this.bg);this.h("InternalSignIn","AttemptingSignIn");this.B.a(n);this.E&&(this.E=_js.g.a().b(this.E))},br:function(n,t){_js.Trace.logInfo(_a.a.i,"Creating new Chat.");var i=new _h.f(!0);i.a().d(this.R);i.a().C(n);i.M(new _g.g("IM:"+Math.random().toString()));if(!t)return i;if(_g.h.isInstanceOfType(t)){i.O(t);return i}if(_g.z.isInstanceOfType(t)){i.N(t);return i}var r=_js.d.c("CreateChat: itemOrConversation type {0} is not supported.",Object.getType(t).getName());_js.Trace.logError(_a.a.i,r);throw Error.invalidOperation(r);},bn:function(n){_js.Trace.logInfo(_a.a.i,"Activating chat.");$a(n.c())||_h.e.a().b(n.c().Id,n);var t=this.bK(n);this.A.r(t,n)},ch:function(n,t,i){var u=n.PayloadType;switch(u){case"NewChatMessageToast":_js.Trace.logInfo(_a.a.i,"NewChatMessageToast received and mapped to chat {0}.",t.b());return;case"ParticipantJoined":this.z.e(n);var r;if($a(n.Persona))r=_pc.a.i(i,n.SipUri);else{r=new _pc.a(null,!0);r.dN(n.Persona)}t.W(n.SipUri,r,i);return;case"ParticipantLeft":t.X(n.SipUri,i);return;case"EndChatSession":t.t||this.C.m(t,!0);return;case"NewChatMessage":t.K(i,n.MessageContent);return;case"UserActivity":switch(n.UserActivity){case"FailedDelivery":t.p(_nbs.a.OP);return;case"Typing":t.bf(i);return;case"StoppedTyping":t.e("");return;case"TwoOrMoreTyping":t.e(_nbs.a.Oj);return;case"DeliveryTimeout":t.p(_nbs.a.Es);return;default:return}}},cl:function(n){if(n.PayloadType==="NewChatMessageToast"){this.z.e(n);var r=this.z.b(n.SipUri,n.DisplayName);var u=this.bs(n.Persona,r,n.SipUri,n.ToastMessage,n.MessageSubject,n.ChatSessionId);_js.Trace.logInfo(_a.a.i,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessageToast).",n.ChatSessionId);return!0}if(n.PayloadType==="NewChatMessage"){var t=this.z.b(n.SipUri,n.DisplayName);var i=this.bs(n.Persona,t,n.SipUri,n.MessageContent,"",n.ChatSessionId);i.K(t,n.MessageContent);_js.Trace.logInfo(_a.a.i,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessage).",n.ChatSessionId);return!0}return!1},bs:function(n,t,i,r,u,f){var o;if($a(n))o=_pc.a.i(t,i);else{o=new _pc.a(null,!0);o.dN(n)}$a(r)&&(r="");var s=new _js.f;s.a(o);var e=this.br(s,null);e.o(f);e.j=o;e.q=r;_js.d.b(u)||e.y(u);this.C.a(e);return e},bE:function(n){_a.b.b(n,"senderInfo");for(var u=n,e=u.length,r=0;r<e;++r){var t=u[r];var i=t.SipUri;_js.Trace.logInfo(_a.a.bJ,"Adding pending contact to buddy requests list",i);var f=this.bM(t.DisplayName,t.Title,i);this.bz(i,!1)||this.F.a(f)}},ci:function(n){_a.b.b(n,"senderInfo");for(var r=!1,u=n,f=u.length,t=0;t<f;++t){var e=u[t];var i=e.SipUri;_js.Trace.logInfo(_a.a.bJ,"Examining the AddToBuddyList payload for existing buddy requests",i);r=this.bz(i,!0)}return r},bH:function(){_js.Trace.logInfo(_a.a.bJ,"Received empty subscribers notification, we need to hide the pending buddy dialogue");this.F.g()},bM:function(n,t,i){_a.b.b(n,"displayName");_a.b.b(i,"buddyImAddress");var r=_pc.a.i(n,i);_js.d.a(t)||r.fZ(t);return r},bz:function(n,t){for(var i=0;i<this.F.w.length;i++){var r=this.F.w[i];if(!r.g().localeCompare(n)){if(t){_js.Trace.logInfo(_a.a.bJ,"Removing already added contact from pending buddyRequests",r.g());this.F.n(i)}return!0}}return!1},bK:function(n){var t=this;return this.A.h(function(t){return n.g.c(t.g)>=0})},I:function(n){this.E&&(this.E=_js.g.a().b(this.E));var t=this.K;this.K=n;if(n&&t){_js.Trace.logInfo(_a.a.i,"Service confirmed available.");return}else if(n&&!t){_js.Trace.logInfo(_a.a.i,"Service resumed.");return}else if(!n&&t){_js.Trace.logInfo(_a.a.i,"Service interrupted.");this.bm();this.bB();return}else if(!n&&!t){_js.Trace.logInfo(_a.a.i,"Service confirmed unavailable.");this.bB();return}_js.Trace.logError(_a.a.i,"Unexpected condition in ChatManager.SetServiceAvailability.")},ca:function(){this.h("SignedOn Succeeded","SignedIn");this.D=!0;this.G=!1},bm:function(){this.A.u(this.Q);this.C.u(this.Q);var n=this;this.A.u(function(t){t.bd(n.K)})},bB:function(){if(this.y==="AttemptingSignIn"||this.y==="SignedIn"||this.y==="Error"){if(this.D){this.D=!1;this.bG();return}this.G=!1;this.h("SignIn-GiveUp","Error")}},ce:function(n){_js.Trace.logWarning(_a.a.i,"Sign-out failed: {0}",n.s.message);this.h("SignOutFailed","SignedOut")},bX:function(n){_js.Trace.logInfo(_a.a.i,"Reset presence succeeded.")},bW:function(n){_js.Trace.logWarning(_a.a.i,"Reset presence failed: {1}",n.s.message)},bZ:function(n){var t=n;_js.Trace.logInfo(_a.a.i,"Set presence to {0} succeeded.",t.a)},bY:function(n){var t=n;_js.Trace.logWarning(_a.a.i,"Set presence to {0} failed: {1}",t.a,n.s.message)},bD:function(n){var t=n;t.o(-2);t.be()},bJ:function(n,t,i,r){var f=this.z.b(t,null);var e=new _im.g(n,t,f,i,r);var u=this.gL(_im.a.a);u&&u(e)},bI:function(n){var u=this.gL(_im.a.a);if(u){var e=n.PayloadType;if(n.PayloadType==="UpdateUserPresence"){var r=n.DisplayName;_js.d.b(r)&&(r=this.S);var s=new _im.g(e,this.J,r,_im.b.b(n.NewUserPresence),!0);u(s);return}if(!$a(n.UserPresenceChanges))for(var h=n.PayloadType!=="QueryUserPresenceChange",f=n.UserPresenceChanges,c=f.length,i=0;i<c;++i){var t=f[i];var o=new _im.g(e,t.SipUri,t.UserName,_im.b.b(t.Presence),h);u(o)}}},bU:function(n,t){switch(t.c){case 0:var f=t.a;var e=this.bx(f);this.H.i(e);break;case 2:var u=t.b;var i=this.bx(u);var r=this.bv(i);this.H.j(r);break;case 1:case 3:default:_a.b.d(!1,"Unexpected notification received: "+t.c);break}},bx:function(n){var r=new _ff.e;if(n)for(var i=n,f=i.length,t=0;t<f;++t){var u=i[t];this.bp(r,u)}return r},bv:function(n){for(var f=this.T(this.A.f()),u=new _ff.e,r=n.d,e=r.length,t=0;t<e;++t){var i=r[t];f.g(i)||u.c(i)}return u},bS:function(n,t){switch(t.c){case 0:var f=t.a;var e=this.T(f);this.H.i(e);break;case 2:var u=t.b;var i=this.T(u);var r=this.bv(i);this.H.j(r);break;case 1:case 3:default:_a.b.d(!1,"Unexpected notification received: "+t.c);break}},T:function(n){var r=new _ff.e;if(n)for(var u=n,e=u.length,t=0;t<e;++t){var o=u[t];var i=o;if(i.a()){var f=this;i.a().u(function(n){f.bp(r,n)})}}return r},bp:function(n,t){var r=t;var i=_im.b.a(r.g());i.localeCompare(this.J)&&(n.g(i)||n.c(i))},bq:function(n){this.V&&(this.y==="unknown"||!this.L)&&_js.Trace.logError(_a.a.i,"ChatManager: Do not access {0} until configuration has loaded.",n)},bC:function(){if(this.f()&&this.N&&this.L){var n=this;_js.g.a().a(_a.a.i,"ChatManager.SignIn",function(){n.s(!1)},5e3)}},bQ:function(n){var r=n.e().bl.InstantMessage;var i=n.c().bl.UserDisplayName;var t=n.c().bl.UserSipUri;this.bR(r,i,t);this.bC()},bT:function(n){if(!n.a){this.D=!1;this.I(!1)}}};_im.q=function(n,t,i,r,u,f,e){this.e=n;this.g=t;this.c=i;this.h=r;this.d=u;this.i=f;this.f=e};_im.q.prototype={e:!1,g:null,c:null,h:null,d:null,i:null,f:!1,b:null,a:function(){this.b||(this.b=new _im.a(this.e,this.g,this.c,this.h,this.d,this.i.e(),this.f));return this.b}};_im.e=function(){this.c=Function.createDelegate(this,this.m);_im.e.initializeBase(this);this.a={}};_im.e.prototype={a:null,k:function(){var t=this.a;for(var n in t){var r={key:n,value:t[n]};var i=r.value;i.d(0)}},l:function(n){this.h(n,!1)},e:function(n){this.h(n,!0)},m:function(n){this.d(n.e,n.b,n.c,n.a,n.d)},d:function(n,t,i,r,u){this.g(n,t,i,u);this.j(n,t,r,u)},b:function(n,t){var i=t;if(_js.d.b(i)&&!_js.d.b(n)){n=_im.b.a(n);var r=this.a[n];$a(r)||(i=r.a);_js.d.b(i)&&(i=_im.b.c(n))}return i},f:function(n,t){t.val=0;n=_im.b.a(n);var i=this.a[n];if($a(i))return!1;t.val=i.b;return!0},h:function(n,t){if(!_js.d.b(n.SipUri)){this.g(n.PayloadType,n.SipUri,n.DisplayName,t);if(!$a(n.NewUserPresence)){var i=_im.b.b(n.NewUserPresence);this.j(n.PayloadType,n.SipUri,i,t)}}},g:function(n,t,i,r){var u=this;this.i(n,t,r,function(n){_js.d.b(i)||n.e(i)})},j:function(n,t,i,r){var u=this;this.i(n,t,r,function(n){$a(i)||n.d(i)})},i:function(n,t,i,r){t=_im.b.a(t);var u=this.a[t];if($a(u)){if(!i)return;u=new _im.r(t);this.a[t]=u}r(u)}};_im.r=function(n){_im.r.initializeBase(this);_a.b.c(n,"sipUri");this.c=n};_im.r.prototype={c:null,a:null,b:0,e:function(n){if(this.a===n)return n;this.a=n;this.bt("DisplayName");return n},d:function(n){if(this.b===n)return n;this.b=n;this.bt("Presence");return n},toString:function(){return String.format("SipUri: {0}, DisplayName: {1}, Presence: {2}",this.c,$a(this.a)?"":this.a,this.b)}};_im.s=function(n,t,i,r){this.l=Function.createDelegate(this,this.o);this.f=n;this.m=t;this.i=i;this.h=r;this.i.d(this.l);this.h.d(this.l)};_im.s.prototype={m:null,i:null,h:null,f:!1,g:null,k:!1,n:0,c:function(n){if(n&&this.f){if(this.j()){n();return}this.g||(this.g=new Sys.EventHandlerList);this.g.addHandler("chatInitialized",n)}},a:function(){return this.j()&&this.f?this.m:null},e:function(){return this.j()&&this.f?this.i.b():null},d:function(){return this.j()&&this.f?this.h.b():null},b:function(){return this.f},j:function(){if(!this.k&&this.f){this.i.a(null);this.h.a(null)}return this.k||!this.f},o:function(){this.n++;if(this.n===2){this.k=!0;if(this.g){this.g.getHandler("chatInitialized")();this.g=null}}}};_im.t=function(n,t,i,r,u){this.e=n;this.d=t;this.g=i;this.c=r;this.f=u};_im.t.prototype={e:!1,d:null,g:null,c:null,f:0,b:null,a:function(){_a.b.f(this.f,"Mouse","ChatProviderFactory.Create - Layout");this.b||(this.b=new _im.s(this.e,this.d,this.g,this.c));return this.b}};_im.j=function(n,t,i){_im.j.initializeBase(this,[n,t,i]);_js.Trace.logInfo(_a.a.i,"PopOutPresenceManager.Ctor.")};_im.j.prototype={p:function(){return new _im.z(this.h)},q:function(n){this.o(n.b,n.a)},k:function(n){this.f.c(n)},s:function(){}};_im.z=function(n){_im.z.initializeBase(this,[n]);_js.Trace.logInfo(_a.a.i,"PopOutPresenceRequestsManager.Ctor")};_im.z.prototype={c:function(n){_a.b.c(n,"sipUri");this.d.queryPresenceInMainWindow(n)},j:function(n){_a.b.c(n,"sipUri");return!0},i:function(){}};_im.k=function(n,t,i){this.l=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.u);this.d={};_im.k.initializeBase(this);_a.b.a(n,"chatManager");_a.b.a(t,"chatParticipantCache");_a.b.a(i,"presenceCrossWindowNotifier");this.e=n;this.i=t;this.e.apcl(_im.a.b,this.n);this.e.bo(this.m);this.h=i;this.f=this.p();this.g=this.e.y;_js.Trace.logInfo(_a.a.bi,"PresenceManager.Ctor.")};_im.k.prototype={e:null,i:null,h:null,f:null,g:"unknown",j:function(){return this.e.y==="SignedIn"},c:function(n){_a.b.a(n,"persona");if(!this.e.f())return!1;_js.Trace.logInfo(_a.a.bi,"PresenceManager.TryRegisterForPresenceUpdates: Registering persona for presence updates: {0}, SIP:{1}",n.f(),n.g()||"");n.apcl("ImAddress",this.l);if(_js.d.b(n.g()))return!0;var t=_im.b.a(n.g());this.v(t,n);this.k(t);return!0},a:function(n){_a.b.a(n,"persona");_js.Trace.logInfo(_a.a.bi,"PresenceManager.TryUnregisterForPresenceUpdates: Unregistering persona for presence updates: {0}, SIP:{1}",n.f(),n.g()||"");return this.r(n,n.g())},b:function(n,t){_a.b.c(n,"sipUri");this.k(n);t.val=0;if(n in this.d){var i=this.d[n];if(i.b()>0){t.val=i.a(0).bC();return!0}}return!1},p:function(){return new _im.f(this.h)},k:function(n){if(this.j()){var t;var r,i;(i=this.i.f(n,r={val:t}),t=r.val,i)&&this.o(n,t);n!==_im.b.a(this.e.c())&&this.f.c(n)}},q:function(n){if(this.j()){this.o(n.b,n.a);this.h.updatePresenceInAllPopOutWindows(n.b,n.a)}},o:function(n,t){n=_im.b.a(n);if(!(n in this.d))return!1;for(var r=this.d[n],i=0;i<r.b();i++){var u=r.a(i);u.X(t)}return!0},s:function(){this.h.updateSignInStateInAllPopOutWindows(this.g)},D:function(){_js.Trace.logInfo(_a.a.bi,"PresenceManager.InternalDispose.");this.e.rpcl(_im.a.b,this.n);this.e.bA(this.m);this.f.dispose();this.f=null},r:function(n,t){if(!this.e.f())return!1;n.rpcl("ImAddress",this.l);if(_js.d.b(t))return!1;var i=_im.b.a(t);if(!(i in this.d))return!1;var r=this.d[i];var u=r.q(n);if(!r.b()){delete this.d[i];this.f.j(i)}return u},u:function(n,t){var a=n;var r=this.g;var y=r==="SignedIn";this.g=a.y;var s=this.j();if(y!==s)if(s){_js.Trace.logInfo(_a.a.bi,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Requesting presence for every persona active.",r,this.g);var e=this.d;for(var f in e){var c={key:f,value:e[f]};var l=c.key;this.k(l)}}else{_js.Trace.logInfo(_a.a.bi,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Resetting presence to Unknown everywhere.",r,this.g);var h=this.d;for(var o in h)for(var v={key:o,value:h[o]},u=v.value,i=0;i<u.b();i++)u.a(i).X(0);this.f.i();this.i.k()}this.s()},t:function(n,t){var i=n;var r=null;var e=this.d;for(var f in e){var u={key:f,value:e[f]};var s=u.key;var o=u.value;if(o.j(i)){r=s;break}}_js.Trace.logInfo(_a.a.bi,"PresenceManager.OnImAddressChangedForAPersona: Unregistering persona {0} for old IM Address {1}",i.f(),r);this.r(i,r);_js.Trace.logInfo(_a.a.bi,"PresenceManager.OnImAddressChangedForAPersona: Re-registering persona {0} for new IM Address {1}",i.f(),$a(i.g())?"":i.g());this.c(i)},v:function(n,t){n in this.d||(this.d[n]=new(_a.gb.$$(_bc.x)));var i=this.d[n];if(!i.j(t)){i.e(t);i.b()>1?t.X(i.a(0).bC()):this.j()||t.X(0)}}};_im.f=function(n){this.g=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.k);this.f=Function.createDelegate(this,this.l);this.a=new(_a.gb.$$(String));_im.f.initializeBase(this);_a.b.b(n,"presenceCrossWindowNotifier");this.d=n;this.a.n(this.f);_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.Ctor")};_im.f.prototype={d:null,b:null,c:function(n){_a.b.c(n,"sipUri");if(!this.a.j(n)){_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.AddOrUpdatePendingGetRequests: Queuing a presence retrieval request for sip {0}",n);this.a.e(n)}},j:function(n){_a.b.c(n,"sipUri");return this.a.q(n)},i:function(){_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.ClearAll: Clearing all pending get presence requests: {0}",this.a.b());this.a.k()},D:function(){_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.InternalDispose.");this.h()},h:function(){if(this.b){_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.CancelBatchGetPresenceRequestsTimer.");this.b=_js.g.a().b(this.b)}},m:function(){this.b=null;var t=this.a.f();var i=t.join("; ");this.a.k();var n=new _im.w(t);n.z(this.e);OwaApplication.a.a(n)},l:function(n,t){if(this.a.b()>0){if(!this.b){_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Activating timer to run after {0}ms. Current count of pending requests = {1}",_im.f.a,this.a.b());this.b=_js.g.a().a(_a.a.bi,"GetPresence",this.g,_im.f.a)}}else{_js.Trace.logInfo(_a.a.bi,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Cancelling timer. Current count of pending requests = {0}",this.a.b());this.h()}},k:function(n){var t=n;var i=t.a.join("; ");if(t.s){_js.Trace.logWarning(_a.a.bi,"PresenceRequestsManager.OnGetPresenceActionCompleted: Failed with {0} for {1} SipUris: '{2}'",t.s,this.a.b(),i);return}}};_im.A=function(n){this.h=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m);this.d=n;this.b=new _ff.e;this.c=new _ff.e;this.a=new _ff.e};_im.A.prototype={d:null,b:null,c:null,a:null,e:!1,i:function(n){for(var i=new _ff.e,f=n.d,e=f.length,r=0;r<e;++r){var t=f[r];if(this.a.g(t)){this.a.l(t);continue}this.c.g(t)||this.b.g(t)||i.g(t)||i.c(t)}if(i.d.length>0){this.b.h(i.d);var u=new _im.E(i.d);u.v(this.g);u.u(this.f);this.d.a(u)}},j:function(n){for(var i=0;i<n.d.length;i++){var t=n.d[i];if(this.b.g(t)){this.b.l(t);continue}this.a.g(t)||this.c.g(t)&&this.a.c(t)}this.k()},k:function(){if(this.a.d.length&&!this.e){this.e=!0;var t=this.a.d[0];this.a.j(0);this.c.l(t);var n=new _im.F(t);n.z(this.h);this.d.a(n)}},n:function(n){this.e=!1;this.k()},m:function(n){for(var f=n,r=f.a,u=r.length,t=0;t<u;++t){var i=r[t];this.c.g(i)||this.c.c(i);this.b.l(i)}_js.Trace.logInfo(_a.a.i,"SubscribeForPresenceUpdates: succeeded.")},l:function(n){for(var r=n,i=r.a,e=i.length,t=0;t<e;++t){var f=i[t];this.b.l(f)}var u=r.a.join(";");_js.Trace.logInfo(_a.a.i,"SubscribeForPresenceUpdates: failed to subscribe for: {0}.",u)}};_im.g=function(n,t,i,r,u){_a.b.c(n,"source");_a.b.c(t,"sipUri");this.e=n;this.b=t;this.c=i;this.a=r;this.d=u};_im.g.prototype={e:null,b:null,c:null,a:0,d:!1,toString:function(){return String.format("Source: {0}, Sip: {1}, DisplayName: {2}, Presence: {3}, IsAboutMeOrMyBuddy: {4}",this.e,this.b,$a(this.c)?"":this.c,this.a,this.d)}};_im.b=function(){};_im.b.b=function(n){switch(n){case"Away":return 3;case"BeRightBack":return 3;case"Busy":return 4;case"DoNotDisturb":return 6;case"IdleBusy":return 4;case"IdleOnline":return 2;case"None":return 0;case"Offline":return 1;case"Online":return 2;default:return 0}};_im.b.d=function(n){switch(n){case 2:return"Online";case 3:return"Away";case 5:return"IdleBusy";case 4:return"Busy";case 6:return"DoNotDisturb";case 1:return"Offline";case 0:default:return"None"}};_im.b.a=function(n){_a.b.c(n,"imAddress");var t=n.toLowerCase();t.startsWith("sip:")||(t="sip:"+t);return t};_im.b.c=function(n){_a.b.c(n,"imAddress");var t=n.toLowerCase();t.startsWith("sip:")&&(t=t.substr(4));return t};function IMComponent(){}IMComponent.$$cctor=function(){_a.p.a().a(IMComponent)};IMComponent.prototype={a:function(n,t,i){n.e(_im.e).a();var h=this;n.b(_h.dy,function(){return new _im.G(n.a(_y.L))}).a();var s=this;n.b(IChatManagerFactory,function(){var t=i.a()==="Mouse"&&!_a.cl.a();return new _im.q(t,n.a(_im.e),n.a(_a.q),null,n.a(_ff.c),n.f(_g.f),i.e())}).a();var c=this;n.b(_im.a,function(){return n.a(IChatManagerFactory).a()}).a();var a=this;n.b(IChatActionFactory,function(){var t;t=i.i()?new _im.m(n.a(_im.a),n.a(_h.dy)):new _im.m(n.a(_im.a),null);return new _im.o(t,new _im.v(n.a(_im.a)))}).a();var l=this;n.b(_im.i,function(){return new _im.i(n.a(_y.a),n.a(_rw.h),n.a(_y.L))}).b(IChatViewModelFactory);if(i.i()){var r=this;n.b(_im.j,function(){return new _im.j(n.a(_im.a),n.a(_im.e),n.a(_y.L))}).b(IPresenceManager).a()}else{var u=this;n.b(_im.k,function(){return new _im.k(n.a(_im.a),n.a(_im.e),n.a(_y.L))}).b(IPresenceManager).a()}var f=this;n.b(IChatProviderFactory,function(){return new _im.t(i.a()==="Mouse"&&!_a.cl.a(),n.a(_im.a),n.c(IPresenceManager),n.c(IChatActionFactory),i.a())}).a();var o=this;n.b(_im.h,function(){return new _im.h(i.a(),n.a(_g.a).T(),n.a(_im.a),n.a(_im.i))}).a();var e=this;n.b(ILwxViewModel,function(){return null}).a()},b:function(){return[new _a.B(_im.h,2,1),new _a.B(_im.a,2,1)]}};_im.h=function(n,t,i,r){if(n==="Mouse"&&t){var u=this;i.j().d(function(n,t){if(!t.c)for(var i=0;i<t.a.length;i++){var u=t.a[i];r.f(u)}})}};_im.c=function(n,t,i,r){this.k=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.l);this.e=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.o);_im.c.initializeBase(this);this.d=r;this.a=n;this.g=new _C(this.i,_a.a.i);this.p(i.a(1,_bc.f.a,this.a.a(),2));this.a.a().d(this.e);t.k(this.h);if(r.get_mainWindowInstance()&&!r.get_mainWindowInstance().closed){var u=this;_a.O.a(r.get_mainWindowInstance(),function(n){n.chatWindowReady(u.a.F())})}};_im.c.prototype={d:null,a:null,g:null,f:null,b:function(){return this.dS(_im.c.a)},p:function(n){this.dR(_im.c.a,n);return n},j:function(n){this.f=n;this.dQ("EditorCallContext");return n},c:function(){return this.dS(_im.c.b)},q:function(n){this.dR(_im.c.b,n);return n},n:function(n,t){switch(t.c){case 0:for(var r=0;r<t.a.length;r++){var f=t.a[r];this.b().m(f)}return;case 2:for(var i=t.b.length-1;i>=0;i--){var e=t.b[i];var o=this;var u=this.b().a().h(function(n){var t=n;return t.h.g()===e.g()});u<this.b().a().w.length&&this.b().a().n(u)}return}},o:function(){if(!_js.d.a(this.c())){this.a.bc(this.c());var n=this;_a.O.a(this.d.get_mainWindowInstance(),function(t){t.sendChatMessage(n.a.c().Id,n.c())})}},l:function(n){_js.Trace.logInfo(_a.a.i,"ChatViewModel.BeforeUnload invoked.");this.a.a().e(this.e);var t=this;_a.O.a(this.d.get_mainWindowInstance(),function(n){_js.Trace.logInfo(_a.a.i,"ChatViewModel.BeforeUnload calling into main window.");n.endChat(t.a.F())})},m:function(){this.j(new _cmc.c(!1))}};_im.i=function(n,t,i){this.c=n;this.e=t;this.d=i};_im.i.prototype={c:null,e:null,d:null,f:function(n){var r={};r.ItemID=n.I();var i=new _y.bJ;i.b(n);var t=_bc.c.e();if(n.C!==-1&&n.D!==-1){t.c=n.C;t.d=n.D}_js.Trace.logInfo(_a.a.i,"ChatViewModelFactory: Chat.BodyText: {0}",n.l());var u=this;this.c.g(IChatViewModelFactory,function(){return u},r,t,i,!1)},b:function(n,t,i){return null},a:function(n,t,i){var u=n.a();return new _im.c(u,this.c,this.e,this.d)}};_im.G=function(n){this.b=n};_im.G.prototype={b:null,a:function(n,t,i){for(var f=new Array(n.w.length),e=new Array(n.w.length),r=0;r<n.w.length;r++){var u=n.w[r];f[r]=u.d();e[r]=u.g()}var o=$a(t)?null:t.F();var s=this;_a.O.a(this.b.get_mainWindowInstance(),function(n){n.startChat(f,e,o,i)})}};_im.d=function(n){this.j=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.q);this.f=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.p);_im.d.initializeBase(this,[n]);_im.d.a++;this.e=".ChatMouseView#Handler."+_im.d.a};_im.d.prototype={e:null,b:null,c:null,d:null,a:null,n:function(){if(!this.a)return null;if(!_js.d.a(this.a.m()))return this.a.m();var t=this.a.a();var n=t.w.length;if(n)if(n===1){var i=t.w[0];return String.format(_nbs.a.MH,i.d())}else return String.format(_nbs.a.EG,n);else return null},J:function(){_js.b.prototype.J.call(this);this.d.cX(!1);this.b.d(100);this.l(null)},Q:function(){_js.c.prototype.Q.call(this);if(!this.E()){if(this.a){this.a.a().e(this.h);this.a.rpcl(_h.f.c.a,this.f)}this.a=null;return}var n=this.E();this.a=n.a;this.a.a().d(this.h);this.a.apcl(_h.f.c.a,this.f);this.a.apcl(_h.f.e.a,this.k)},K:function(){_js.b.prototype.K.call(this);if(!this.F){this.c.rpcl(_b.n.a.a,this.g);$(window).unbind(this.e);this.c=null;this.b=null;this.d=null;return}this.b=this.F.a("TranscriptScrollRegion");this.c=this.F.a("TranscriptLabel");this.d=this.F.a("Editor");this.c.apcl(_b.n.a.a,this.g);$(window).bind("resize"+this.e,this.j);this.i()},i:function(){var n=this.n();_js.d.a(n)||(window.document.title=n)},p:function(n,t){this.i()},m:function(n,t){this.i()},q:function(n,t){if(this.a.r()){var i=this.d.B.children("textarea");i.length>0&&i[0].setAttribute("disabled","true")}},o:function(n,t){var i=this.b.B;var r=i.prop("scrollHeight");i.scrollTop(r-i.height())},l:function(n){var t=$(window).height();t>=425&&this.b.B.height(251+t-425)}};_im._TI=function(){};_im._TI.$$cctor=function(){var n="ChatMouseView";new _A(n,function(){_im._TI.a[n]===undefined&&(_im._TI.a[n]=[null,[[-1,0,["ParticipantsViewModel"],[_im._TI.j],null,"DataContext",null,_im._TI.o,1,null,null,null]],null,[[-1,0,["Chat","BodyText"],[_im._TI.b,_im._TI.g],null,"Html",null,_im._TI.c,1,null,null,null]],[[-1,0,["Chat","LastMessageAriaLabel"],[_im._TI.b,_im._TI.d],null,"Text",null,_im._TI.f,1,null,null,null],[-1,0,["Chat","LastMessageAriaLabel"],[_im._TI.b,_im._TI.d],null,"AriaLabel",null,_im._TI.p,1,null,null,null]],[[-1,0,["Chat","Status"],[_im._TI.b,_im._TI.h],null,"Html",null,_im._TI.c,1,null,null,null]],[[-1,4,null,null,null,"SizingMode",null,_im._TI.w,0,null,null,0,1],[-1,4,null,null,null,"EditorAriaLabel",null,_im._TI.u,0,null,null,null,_u.R.q],[-1,0,["SendCommand"],[_im._TI.k],null,"EnterCommand",null,_im._TI.v,1,null,null,null],[-1,0,["EditorCallContext"],[_im._TI.i],_im._TI.m,"CallContext",_im._TI.q,_im._TI.s,2,null,null,null],[-1,0,["SendText"],[_im._TI.l],_im._TI.n,"Content",_im._TI.r,_im._TI.t,2,null,null,null]]]);var t=_im._TI._hf.childNodes[0].cloneNode(!0);var i=new _zz.d(_B.a(t,[0,3]),_js.a.Instance.a(_y.a),_js.a.Instance.a(_a.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_b.e));i.bn("_im_8 ms-font-weight-regular ms-font-color-black");i.dH(!0);var o=new _b.n(_B.a(t,[0,2,0]));var s=new _b.bb(_B.a(t,[0,1,1]),_js.a.Instance.a(_ff.c));var r=new _b.n(_B.a(t,[0,1,0]));var f=new _fce.f(_B.a(t,[0,1]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));var u=new _js.b(_B.a(t,[0,0,0,0]));u.y("ReadOnlyRecipientWellView");var e=new _fce.f(_B.a(t,[0,0,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));return new _B(t,[e,u,f,r,s,o,i]).R({TranscriptScrollRegion:f,TranscriptLabel:r,Editor:i})},_im.c,_im.d,function(n){return new _im.d(n)},!1,!1,!1,0,_im._TI.a)};_im._TI.e=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_im_2'> <div class='_im_3 ms-bg-color-neutralLighter'> <div class='_im_4'> <div></div> </div> </div> <div class='_im_5'> <span></span> <div></div> </div> <div class='_im_6 ms-font-weight-regular ms-font-color-neutralSecondary ms-bg-color-neutralLighter ms-border-color-neutralTertiaryAlt'> <span></span> </div> <div class='_im_7 border-color-transparent ms-border-color-neutralTertiaryAlt-hover'></div> </div> </div>";_js.c.a().appendChild(n);return n};_im._TI.j=function(n){return n.b()};_im._TI.b=function(n){return n.a};_im._TI.g=function(n){return n.l()};_im._TI.d=function(n){return n.R()};_im._TI.h=function(n){return n.s()};_im._TI.k=function(n){return n.g};_im._TI.i=function(n){return n.f};_im._TI.q=function(n){return n.ca};_im._TI.l=function(n){return n.c()};_im._TI.r=function(n){return n.bW()};_im._TI.o=function(n,t){n.ba(t)};_im._TI.c=function(n,t){n.a(t)};_im._TI.f=function(n,t){n.a(t)};_im._TI.p=function(n,t){n.bb(t)};_im._TI.v=function(n,t){n.dG(t)};_im._TI.m=function(n,t){n.j(t)};_im._TI.s=function(n,t){n.bm(t)};_im._TI.n=function(n,t){n.q(t)};_im._TI.t=function(n,t){n.ct(t)};_im._TI.w=function(n,t){n.bZ(t)};_im._TI.u=function(n,t){n.cc=t};_im.n.registerClass("_im.n",_h.dX.$$(Number));_im.u.registerClass("_im.u",_h.dX.$$(Boolean));_im.w.registerClass("_im.w",_h.dX.$$(Number));_im.x.registerClass("_im.x",_h.dX.$$(Number));_im.y.registerClass("_im.y",_h.dX.$$(Number));_im.B.registerClass("_im.B",_h.dX.$$(Number));_im.C.registerClass("_im.C",_h.dX.$$(Number));_im.D.registerClass("_im.D",_h.dX.$$(Number));_im.l.registerClass("_im.l",_a.de);_im.E.registerClass("_im.E",_h.dX.$$(Number));_im.F.registerClass("_im.F",_h.dX.$$(Number));_im.a.registerClass("_im.a",_js.x,IChatManager,_js.y);_im.e.registerClass("_im.e",_js.x);_im.r.registerClass("_im.r",_js.x);_im.k.registerClass("_im.k",_js.ba,IPresenceManager);_im.j.registerClass("_im.j",_im.k);_im.f.registerClass("_im.f",_js.ba);_im.z.registerClass("_im.z",_im.f);IMComponent.registerClass("IMComponent",null,_a.iM);_im.h.registerClass("_im.h");_im.c.registerClass("_im.c",_a.bz);_im.i.registerClass("_im.i",null,IChatViewModelFactory,_bc.bd);_im.d.registerClass("_im.d",_js.b);_im._TI.registerClass("_im._TI");_im.a.b="SignInState";_im.a.c="IsSignedIn";_im.a.a="Presence";_im.f.a=5e3;IMComponent.$$cctor();_im.c.b=new _H("SendText",String,_im.c,"");_im.c.a=new _H("ParticipantsViewModel",_rw.a,_im.c);_im.d.a=0;_im._TI._hf=_im._TI.e();_im._TI.a={};_im._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.im.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.im.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
