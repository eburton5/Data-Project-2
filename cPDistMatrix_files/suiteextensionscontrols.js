try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['suiteextensionscontrols.js'] = (new Date()).getTime();
var __extends=this.__extends||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);function r(){this.constructor=n}r.prototype=t.prototype;n.prototype=new r};function InitializeIconControls(){for(var t=document.querySelectorAll(".registerFileIcon"),u=SuiteExtensionsDataStore.GetInstance(),n=0;n<t.length;n++){var r=t[n].title.split(".");var i=r[r.length-1];var o=u.GetFileHandlerProperty("appId",i);var e=u.GetFileHandlerProperty("fileIcon",i);var f=new IconControl(i,o,e);f.Render(t[n])}}function RegisterPreviewIframe(n,t,i,r){var u=SuiteExtensionsDataStore.GetInstance();var o=u.GetFileHandlerProperty("appId",t);var h=u.GetFileHandlerProperty("previewUrl",t);var c=u.hostConfig.resourceId;var s=u.hostConfig.cultureName;var e=u.hostConfig.host;var f=new PreviewControl(t,o,h,c,s,e);f.set_httpRoot(n);f.set_itemUrl(i);return f.AppendCustomIframe(r)}var SuiteExtensionsControl=function(){function n(n,t){this.appId=t;this.fileExtension=n}n.prototype.get_appId=function(){return this.appId};n.prototype.get_fileExtension=function(){return this.fileExtension};return n}();var IconControl=function(n){__extends(t,n);function t(t,i,r){n.call(this,t,i);this.dataStore=SuiteExtensionsDataStore.GetInstance();this.iconUrl=r}t.prototype.Render=function(n){if(this.iconUrl!=null&&this.iconUrl!=""){var t=n;if(t!=null){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartUsingDocIconFromApp");t.setAttribute("src",this.iconUrl);t.setAttribute("width","16");t.setAttribute("height","16");if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessUsingDocIconFromApp");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingDocIconFromApp",!1,"App Icon loaded using file extension definition")}}}};return t}(SuiteExtensionsControl);var OpenControl=function(n){__extends(t,n);function t(t,i,r,u,f,e){n.call(this,t,i);this.dataStore=SuiteExtensionsDataStore.GetInstance();this.openUrl=r;this.resourceId=u;this.cultureName=f;this.host=e}t.prototype.set_httpRoot=function(n){this.httpRoot=n};t.prototype.set_itemUrl=function(n){this.itemUrl=n};t.prototype.Render=function(n,t,i,r){if(n!=null&&this.openUrl!=null&&this.openUrl!=""){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartCallingOpenFormPost");var u=document.createElement("form");u.action=this.openUrl;u.method="POST";u.style.visibility="Hidden";u.appendChild(this.NewFormInput("fileget",i));u.appendChild(this.NewFormInput("fileput",t));u.appendChild(this.NewFormInput("fileid",r));u.appendChild(this.NewFormInput("resourceid",this.resourceId));u.appendChild(this.NewFormInput("culturename",this.cultureName));u.appendChild(this.NewFormInput("client",this.host));var f=document.createElement("input");f.type="submit";u.appendChild(f);if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessCallingOpenFormPost");this.dataStore.hostConfig.logging.WriteDebugLog("FED_CallingOpenFormPost",!1,"FED app is installed as custom open url is not empty. Clicked open to open the file from app using file extension definition.")}n.appendChild(u);u.submit()}};t.prototype.NewFormInput=function(n,t){var i=document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;return i};t.prototype.UpdateElement=function(n){if(this.openUrl!=null&&this.openUrl!=""){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartUpdateOpenUrl");n.setAttribute("href",this.GetRedirectUrl());if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessUpdateOpenUrl");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingOpenUrl",!1,"FED app is installed as custom open url is not empty. Clicked open to open the file from app using file extension definition.")}}};t.prototype.GetRedirectUrl=function(){var n;if(this.dataStore.hostConfig.host=="SharePoint"){var t="/_layouts/15/online/cloudappsredirect.aspx?extensiontype=files";n=this.httpRoot+t+"&appurl="+this.openUrl+"&appid="+this.get_appId()+"&itemurl="+this.itemUrl}return n};return t}(SuiteExtensionsControl);var PreviewControl=function(n){__extends(t,n);function t(t,i,r,u,f,e){n.call(this,t,i);this.dataStore=SuiteExtensionsDataStore.GetInstance();this.previewUrl=r;this.resourceId=u;this.cultureName=f;this.host=e}t.prototype.set_httpRoot=function(n){this.httpRoot=n};t.prototype.set_itemUrl=function(n){this.itemUrl=n};t.prototype.Render=function(n,t,i,r){if(n!=null&&this.previewUrl!=null&&this.previewUrl!=""){var u=document.createElement("iframe");u.style.width="100%";u.style.height="100%";u.style.borderWidth="0px";n.appendChild(u);this.GetIframeContent(u,t,i,r);return n}return null};t.prototype.GetIframeContent=function(n,t,i,r){var o={};var f=n.contentDocument;f.body==null&&f.write("<body></body>");this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartCallingPreviewIframePost");var u=document.createElement("form");u.action=this.previewUrl;u.method="POST";u.style.visibility="Hidden";u.appendChild(this.NewFormInput("fileget",i));u.appendChild(this.NewFormInput("fileput",t));u.appendChild(this.NewFormInput("fileid",r));u.appendChild(this.NewFormInput("resourceid",this.resourceId));u.appendChild(this.NewFormInput("culturename",this.cultureName));u.appendChild(this.NewFormInput("client",this.host));var e=document.createElement("input");e.type="submit";u.appendChild(e);if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessCallingPreviewIframePost");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingPreviewUrl",!1,"Clicked preview to preview the file from app using file extension definition")}f.body.appendChild(u);n.contentDocument.getElementsByTagName("form")[0].submit()};t.prototype.NewFormInput=function(n,t){var i=document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;return i};t.prototype.AppendCustomIframe=function(n){if(this.previewUrl!=null&&this.previewUrl!=""){this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.logging.WriteStart("FED_StartCallingCustomPreviewIframe");var t=document.createElement("iframe");t.setAttribute("width","350");t.setAttribute("height","250");t.setAttribute("src",this.GetIframeSourceUrl());if(this.dataStore.hostConfig!=null){this.dataStore.hostConfig.logging.WriteSuccess("FED_SuccessCallingCustomPreviewIframe");this.dataStore.hostConfig.logging.WriteDebugLog("FED_UsingCustomPreviewUrl",!1,"FED app is installed as custom preview url is not empty. Clicked preview to preview the file from app using file extension definition")}n.appendChild(t)}return n};t.prototype.GetIframeSourceUrl=function(){var n;if(this.dataStore.hostConfig!=null&&this.dataStore.hostConfig.host=="SharePoint"){var t="/_layouts/15/online/cloudappsredirect.aspx?extensiontype=files";n=this.httpRoot+t+"&appurl="+this.previewUrl+"&appid="+this.get_appId()+"&itemurl="+this.itemUrl}return n};return t}(SuiteExtensionsControl);
window.scriptsLoaded['suiteextensionscontrols.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['suiteextensionscontrols.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
