try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.moderngroupsnavigation.js'] = (new Date()).getTime();
Type.registerNamespace("_mgn");_mgn.s=function(){};_mgn.s.registerInterface("_mgn.s");_mgn.u=function(){};_mgn.u.prototype={none:0,groupHeader:1,groupReadCard:2,groupMemberList:3};_mgn.u.registerEnum("_mgn.u",!1);_mgn.v=function(n,t,i){_a.b.a(t,"sessionSettings");_a.b.a(n,"actionSubmitter");_a.b.a(i,"featureManager");this.b=n;this.f=t;this.c=i};_mgn.v.prototype={b:null,f:null,c:null,d:null,a:null,BeginGetGroup:function(n,t,i){this.a=_a.d.b(_a.a.r,"GetModernGroup",!0);_mgn.a.a(this.c)?this.k(n,t,i):this.i(n,t,i)},BeginGetGroups:function(n,t){this.d=_a.d.b(_a.a.r,"GetModernGroups",!0);_mgn.a.a(this.c)?this.l(n,t):this.j(n,t)},BeginGetHomeGroup:function(n,t){n(_g.N.a(this.f.bl.UserDisplayName,this.f.bl.UserEmailAddress))},BeginGetGroupUnseenData:function(n,t,i,r){var u=new _mgn.x(n,t);var e=this;u.v(function(){i(u.d)});var f=this;u.u(function(){r(u.s)});this.b.a(u)},l:function(n,t){var f=_mgn.a.b(this.c)?2:1;var i=new _mgn.k(f,null);var u=this;i.v(function(t){var e=t;var r=e.a;var f=e.d;n(r,f,null,!0);u.e(!0,null,i.C(),r?r.length:0,f?f.length:0)});var r=this;i.u(function(){t(i.s);r.e(!1,i.F(),i.C(),0,0)});this.b.b(i)},j:function(n,t){var i=new _mgn.w;var u=this;i.v(function(t){var r=t;var e=r.c;var f=r.d;var o=r.e;n(e,f,o,r.a);u.e(!0,null,i.C(),e?e.length:0,f?f.length:0)});var r=this;i.u(function(){t(i.s);r.e(!1,i.F(),i.C(),0,0)});this.b.b(i)},e:function(n,t,i,r,u){var e=null;var o=null;var s=null;if(n){if(r||u){var f=new _a.u;f.a("jgc",r);f.a("pgc",u);f.a("npvo",_g.a.a().a().N());f.c("npep",_g.a.a().a().bl.MailFolderPaneExpanded);o=f.toString()}}else s=t?t:"Failed";if(this.d){e=this.d;e.k=s;e.j=o;e.l=i;_a.d.a(e);this.d=null}},k:function(n,t,i){var r=new _mgn.j(n,0);var f=this;r.v(function(i){var r=i.a;var u=_g.N.a(r.DisplayName,r.SmtpAddress,r.UserGroupRelationship.IsMember,_mgn.n.a(r.AccessType));f.h(u,t,i.C(),n)});var u=this;r.u(function(t){u.g(i,t.s,t.C(),n)});this.b.b(r)},i:function(n,t,i){var r=new _mgn.i(n,1,0);var f=this;r.v(function(i){var r=i.A.Body.GeneralInfo;var u=_g.N.a(r.Name,r.SmtpAddress,r.IsMember,r.ModernGroupType);f.h(u,t,i.C(),n)});var u=this;r.u(function(t){u.g(i,t.s,t.C(),n)});this.b.b(r)},h:function(n,t,i,r){n.k(!1);n.unseenData=_g.fl.a();t(n);if(this.a){var u=this.a;u.l=i;u.o=r;_a.d.a(u);this.a=null}},g:function(n,t,i,r){n(t);if(this.a){var u=this.a;u.k=t?t.message:"Failed";u.l=i;u.o=r;_a.d.a(u);this.a=null}}};_mgn.F=function(n,t){this.h=t||"";this.c=n||""};_mgn.F.prototype={c:null,h:null,f:function(){return _g.N.c(this.c)}};_mgn.c=function(n,t,i,r,u){_mgn.c.initializeBase(this,[n,t]);this.a=i;this.b=$a(r)?0:r;this.d=$a(u)?0:u};_mgn.c.prototype={a:0,b:0,d:0};_mgn.a=function(n,t,i,r,u,f,e,o,s,h){this.D=Function.createDelegate(this,this.P);this.E=Function.createDelegate(this,this.Q);this.F=Function.createDelegate(this,this.R);this.G=Function.createDelegate(this,this.S);this.H=Function.createDelegate(this,this.U);this.B=Function.createDelegate(this,this.M);this.C=Function.createDelegate(this,this.N);this.A=Function.createDelegate(this,this.L);_mgn.a.initializeBase(this);this.j=n;this.v=t;this.z=i;this.o=r;this.p=u;this.h=f;this.s=e;this.t=o;this.y=s;this.l=h;this.O();_mgn.a.a(this.l)&&this.T();this.h.b(_mgn.c,this.A);this.h.b(_y.bj,this.C);this.h.b(_mgn.g,this.B)};_mgn.a.a=function(n){return!!n&&!!n.a()&&!!n.a().n()&&n.a().n().Enabled};_mgn.a.b=function(n){return _mgn.a.a(n)&&!!n.a().X()&&n.a().X().Enabled};_mgn.a.c=function(){_a.k.a("ConversationDeepLink")};_mgn.a.prototype={s:null,o:null,h:null,v:null,z:null,j:null,p:null,t:null,y:null,l:null,g:null,i:null,m:null,q:!1,r:!1,n:null,d:function(n){this.by("SelectedModernGroupChanged",n)},c:function(n){this.by("ChangeCurrentModule",n)},a:function(){return this.i},I:function(n){if(this.i!==n){var t=!this.i||!n;this.i=n;if(this.r)return n;t?this.cb("ChangeCurrentModule",0):this.K()}return n},b:function(){return!!this.i},f:function(){return this.g},K:function(){this.bO("SelectedModernGroupChanged",this,null)},e:function(n){if(this.n){this.n(n);this.n=null;return}},O:function(){this.g=new _mgn.b(this.v,this.z,this.o,this.t,this.y,this.l);this.g.bu(this.H);this.g.bG(this.G);this.g.bE(this.F);this.g.bD(this.E);this.g.bF(this.D)},T:function(){var t=_a.d.b(_a.a.r,"GetUnifiedGroupsSettings",!0);var n=new _mgn.o;var i=this;n.v(function(n){var r=n;i.g.bB(!r.a);_a.d.a(t)});var r=this;n.u(function(n){t.k="Failed";_a.d.a(t)});this.j.a(n)},U:function(n){this.w();n&&n.e!==1?this.I(n.d):this.I(null)},R:function(n){_js.i.b(n,"group");this.J(n.bl.SmtpAddress,!0)},S:function(n){_js.i.b(n,"group");this.J(n.bl.SmtpAddress,!1)},J:function(n,t){if(_mgn.a.a(this.l)){var r=new _mgn.z(n,t);this.j.a(r)}else{var i=new _mgn.y(n,t);this.j.a(i)}},Q:function(){if(!this.q){this.w();if(this.m)this.m.g();else{this.q=!0;var n=this;this.s.a(function(t){n.m=t;n.m.g();n.q=!1})}}},P:function(){this.w();var n=this;this.k(function(){n.g.E(n.g.T)});var t=this;this.h.a(_y.s,new _y.s(2,function(){t.h.a(_y.cf,new _y.cf)},!0,!0,!0,!1,!0))},L:function(n){switch(n.a){case 2:this.g.bd(this.u(n,!0));break;case 3:var r=this;this.k(function(){r.g.bo(n.c)});break;case 9:this.g.bo(n.c);this.p.a(_a.bc.a(0));this.i=null;break;case 1:var t=this;this.k(function(){t.g.bd(t.u(n,!0));t.g.bh(n.c);t.p.a(_a.bc.b(n.c,0))});break;case 4:this.g.bP(n.c);break;case 5:var i=this;this.k(function(){var t=$a(n.b)?0:n.b;i.g.bp(i.u(n,!1));i.p.a(_a.bc.b(n.c,t))});break}},u:function(n,t){return _g.N.a(n.h,n.c,t,n.d)},w:function(){this.o.a()!=="Mouse"&&this.h.a(_y.bG,new _y.bG(!1))},N:function(n){if(this.o.a()==="Mouse")n.d&&this.g.bh(n.a);else{var t=this;this.k(function(){t.n=n.g;t.g.bp(_g.N.e(n.a));t.cb("ChangeCurrentModule",n.b)})}},M:function(n){n.a&&_a.k.b(_a.a.r,"ConversationDeepLink",!0);if(this.g&&this.g.A&&this.g.A.d.bl.SmtpAddress===n.b)this.h.a(_mgn.l,new _mgn.l(n.a,n.c));else{var i=this;var t=function(){i.h.a(_y.bj,new _y.bj(0,n.b,null,n.a,n.c))};this.h.a(_y.s,new _y.s(0,t,!1,!0,!0,!0,!1))}},k:function(n){try{this.r=!0;n()}finally{this.r=!1}}};function ModernGroupsNavigationComponent(){}ModernGroupsNavigationComponent.$$cctor=function(){_a.p.a().a(ModernGroupsNavigationComponent)};ModernGroupsNavigationComponent.prototype={a:function(n,t,i){var e=this;n.b(_mgn.s,function(){return new _mgn.v(n.a(_h.de),n.a(_g.bb),n.a(_a.h))}).a();var o=this;n.b(_mgn.t,function(){return new _mgn.C(n.a(_g.bb),n.a(_y.a),n.a(_a.h))}).a();var s=this;n.b(_mgn.a,function(){return new _mgn.a(n.a(_a.q),n.a(_mgn.s),n.a(_mgn.t),n.a(_y.a),n.a(_a.bn),n.a(_ff.c),n.d(IModernGroupCardFacade),n.a(_pe.h),n.a(IInferenceTracker),n.a(_a.h))}).a();var r=this;n.b(IModernGroupsNavigationFactory,function(){return n.a(_mgn.a)}).a();var u=this;n.b(_mgn.f,function(){var t=n.a(CalendarsCache);t.bL(_u.R.YP,_u.R.VF,_u.R.Hz,_u.R.o);return new _mgn.f(n.a(IModernGroupsNavigationFactory),t)}).b(IModernGroupCalendarsProvider).a();var f=this;n.b(_mgn.b,function(){var t=n.a(_mgn.a);return t.g}).b(_y.cC)},b:function(){return[]}};_mgn.g=function(n,t,i){this.b=n;this.a=t;this.c=i};_mgn.g.prototype={b:null,a:null,c:null};_mgn.l=function(n,t){this.a=n;this.b=t};_mgn.l.prototype={a:null,b:null};_mgn.f=function(n,t){this.l=Function.createDelegate(this,this.C);this.g=Function.createDelegate(this,this.z);this.j=Function.createDelegate(this,this.A);this.k=Function.createDelegate(this,this.B);_mgn.f.resolveInheritance();this.o=this.h;_mgn.f.initializeBase(this);this.e=t;this.d=n.g;this.s.p([this.q(),this.n(),this.r()]);if(this.d.C){this.w();this.bj(!0)}else{var r=null;var i=this;r=function(n,t){if(i.d.b()){i.d.g("IsReady",r);i.w()}i.bj(!0)};this.d.c("IsReady",r)}};_mgn.f.a=function(n,t,i,r,u){for(var e,f=0;f<n.w.length;f++){var o=i(n.w[f]);for(e=f;e<t.w.length;e++)if(o===r(t.w[e])){f!==e&&t.v(e,f,t.w[e]);break}u&&e>=t.w.length&&u(f,n.w[f])}};_mgn.f.prototype={e:null,d:null,a:function(){return this.d},q:function(){return this.e.u.a()},n:function(){return this.e.v.a()},r:function(){return this.e.A.a()},b:function(n){this.d.q(n)},c:function(n){this.d.u(n)},dT:function(){this.v();this.d.g("GroupsMoveInProgress",this.k);_a.jX.prototype.dT.call(this)},w:function(){this.f(this.e.u,0,this.d.z.f());this.f(this.e.v,0,this.d.w.f());this.f(this.e.A,0,this.d.y.f());this.u();this.d.c("GroupsMoveInProgress",this.k)},B:function(n,t){if(this.d.n())this.v();else{this.u();this.D()}},D:function(){var f=this;var n=function(n){return n.a()};var e=this;var t=function(n){return n.bl.ItemId.Id};var r=this;_mgn.f.a(this.d.z,this.q(),n,t,function(i,u){r.y(u,[r.n()],r.e.u,i,t,n)});var i=this;_mgn.f.a(this.d.w,this.n(),n,t,function(r,u){i.y(u,[i.q(),i.r()],i.e.v,r,t,n)});var u=this;_mgn.f.a(this.d.y,this.r(),n,t,function(n,t){u.f(u.e.A,n,[t])});this.m(this.e.u,this.d.z.w.length);this.m(this.e.v,this.d.w.w.length);this.m(this.e.A,this.d.y.w.length)},m:function(n,t){for(var i=t,r=n.a().w.length;i<r;i++)this.e.bi(n.a().w[i],n)},y:function(n,t,i,r,u,f){for(var o,e,h=0,c=t.length;h<c;h++){e=t[h];var l=this;o=e.k(n,function(n,t){return f(n)===u(t)});if(o>=0){var s=e.w[o];e.z(o,s);i.a().D(r,s,s);return}}this.f(i,r,[n])},u:function(){this.d.z.d(this.j);this.d.w.d(this.g);this.d.y.d(this.l)},v:function(){this.d.z.e(this.j);this.d.w.e(this.g);this.d.y.e(this.l)},A:function(n,t){this.t(this.e.u,t)},z:function(n,t){this.t(this.e.v,t)},C:function(n,t){this.t(this.e.A,t)},t:function(n,t){switch(t.c){case 0:this.f(n,t.d,t.a);break;case 2:for(var i=0,u=t.b.length;i<u;i++){var r=n.a().w[t.d];this.e.bi(r,n)}break;default:break}},f:function(n,t,i){for(var u,r=0,e=i.length;r<e;r++){u=i[r];var f=_g.w.a(u.d.bl.DisplayName,u.a(),!0);this.e.bM(f,n,t+r)}}};_mgn.r=function(){};_mgn.r.prototype={a:function(n,t){var i=n;return i>0?i>99?_u.R.OJ:i.toString():""},b:function(n,t){throw Error.notImplemented();}};_mgn.n=function(){};_mgn.n.a=function(n){switch(n){case 1:return 1;case 3:return 3;case 2:return 2}return 0};_mgn.j=function(n,t){_mgn.j.initializeBase(this,[n]);this.c=t};_mgn.j.prototype={c:0,a:null,d:function(){var n="OWA_GetUnifiedGroupDetailsAction-GI";_mgn.e.a().c(this.i.Value)&&(n=n+"-"+"NewGroup");return n},t:function(n){var i=new _g.FY(this.w);i.explicitLogonUser=this.i.Value;i.actionName=this.d();var t=new _g.pD;t.Header=_mgn.d.a();t.Body=new _g.pE;t.Body.GroupIdentity=this.i;t.Body.ResponseShape=this.c;n.bX(t,i,this.r,this.q)},cz:function(n,t,i){var r=n;r.Body&&r.Body.ResponseCode==="NoError"&&r.Body.GroupDetails||i(Error.create("GetUnifiedGroupDetailsAction: group details could not be retrieved."));this.a=r.Body.GroupDetails;t()}};_mgn.k=function(n,t){_mgn.k.initializeBase(this);this.e=n;this.c=t};_mgn.k.prototype={e:0,c:null,a:null,d:null,t:function(n){var e=new _g.Gx(this.w);e.actionName=_mgn.k.a;var t=new _g.pJ;t.Header=_mgn.d.a();t.Body=new _g.kg;_js.d.b(this.c)||(t.Body.UserSmtpAddress=this.c);var f=null;switch(this.e){case 1:var u=new _g.hG;u.FilterType=1;u.SortType=3;u.SortDirection="Descending";var i=new _g.hG;i.FilterType=2;i.SortType=2;i.SortDirection="Descending";f=[u,i];break;case 2:var r=new _g.hG;r.FilterType=0;r.SortType=4;r.SortDirection="Descending";f=[r];break}f&&(t.Body.RequestedGroupsSets=f);n.ca(t,e,this.r,this.q)},cz:function(n,t,i){n.Body&&n.Body.GroupsSets&&n.Body.GroupsSets.length||i(Error.create("GetUserUnifiedGroupsAction: groups could not be retrieved."));for(var f=n.Body.GroupsSets,e=f.length,r=0;r<e;++r){var u=f[r];switch(u.FilterType){case 1:this.d=this.f(u.Groups);break;case 2:default:this.a=this.f(u.Groups);break}}t()},f:function(n){if(!n)return new Array(0);for(var i=new Array(n.length),t=0;t<n.length;t++){i[t]=_g.N.a(n[t].DisplayName,n[t].SmtpAddress,!0,_mgn.n.a(n[t].AccessType));i[t].k(n[t].IsFavorite)}return i}};_mgn.e=function(){this.a={}};_mgn.e.a=function(){_mgn.e.b||(_mgn.e.b=new _mgn.e);return _mgn.e.b};_mgn.e.prototype={a:null,c:function(n){n=n.toLowerCase();if(n in this.a){if(this.d(n)){delete this.a[n];return!1}return!0}return!1},b:function(n){this.a[n.toLowerCase()]=_a.c.get_utcNow()},d:function(n){var t=_a.c.get_utcNow().g(this.a[n.toLowerCase()]);return t>9e5}};_mgn.z=function(n,t){_mgn.z.initializeBase(this,[n]);this.c=t};_mgn.z.prototype={c:!1,a:null,d:function(){return this.c?"PinModernGroup":"UnpinModernGroup"},t:function(n){var i=new _g.LF(this.w);i.actionName=this.c?"PinGroupAction":"UnpinGroupAction";this.a=_a.d.b(_a.a.r,this.d(),!0);var t=new _g.rY;t.Header=_mgn.d.a();t.Body=new _g.rZ;t.Body.IsFavoriteUnifiedGroup=this.c;t.Body.GroupIdentity=this.i;n.cB(t,i,this.r,this.q)},cz:function(n,t,i){t();if(this.a){var r=this.a;r.l=this.C();r.o=this.i.Value;_a.d.a(r);this.a=null}},O:function(n){var i=OwaApplication.h().a(n);_js.d.a(i)&&(i="Failed");_h.dX.prototype.O.call(this,n);if(this.a){var t=this.a;t.k=i;t.l=this.C();t.o=this.i.Value;_a.d.a(t);this.a=null}}};_mgn.d=function(n,t){_mgn.d.initializeBase(this);_a.b.c(n,"groupIdentity");this.i=new _g.hU;this.i.Type=0;$a(t)||(this.i.Type=t);this.i.Value=n};_mgn.d.a=function(){var n=new _g.dQ;n.RequestServerVersion="Exchange2013";n.TimeZoneContext=new _g.gp;n.TimeZoneContext.TimeZoneDefinition=new _g.eb;return n};_mgn.d.prototype={i:null};_mgn.i=function(n,t,i){_mgn.i.initializeBase(this);_mgn.i.b(n);this.l=n;this.j=t;this.n=i};_mgn.i.b=function(n){if(!n)throw Error.argumentUndefined("smtpAddress","smtpAddress must be specified");};_mgn.i.prototype={l:null,j:0,n:0,P:function(){var n="GetModernGroup";(this.j&1)==1&&(n=n+"-"+_mgn.i.a);(this.j&2)==2&&(n=n+"-"+"ME");(this.j&4)==4&&(n=n+"-"+"OW");(this.j&8)==8&&(n=n+"-"+"ER");_mgn.e.a().c(this.l)&&(n=n+"-"+"NewGroup");return n},t:function(n){var t=new _g.EU(this.w);t.explicitLogonUser=this.l;t.actionName=this.P();var r=this.m();var i=new _g.jR(this.y(),r);n.bF(i,t,this.r,this.q)},cz:function(n,t,i){n.Body.GeneralInfo||n.Body.MembersInfo||n.Body.OwnerList||n.Body.ExternalResources||_js.Trace.logWarning(_a.a.l,"Modern group response is missing general info, members info, external resources, and owner list. RequestedResultSet= {0}",this.j);try{this.o(n,t)}catch(r){i(r)}},m:function(){var n=new _g.oU(this.l,this.j);n.MembersPageRequest=new _g.V("Beginning");n.MembersPageRequest.Offset=0;n.MembersPageRequest.MaxEntriesReturned=100;n.MemberSortOrder=this.n;return n},o:function(n,t){t()}};_mgn.w=function(){_mgn.w.initializeBase(this)};_mgn.w.prototype={c:null,d:null,e:null,a:!1,t:function(n){var t=new _g.EX(this.w);n.bG(t,this.r,this.q)},cz:function(n,t,i){this.c=_g.N.d(n.Body.JoinedGroups);this.d=_g.N.d(n.Body.PinnedGroups);this.e=_g.N.d(n.Body.RecommendedGroups,!0);this.a=$a(n.Body.IsModernGroupsAddressListPresent)?!0:n.Body.IsModernGroupsAddressListPresent;t()}};_mgn.x=function(n,t){_mgn.x.initializeBase(this);_a.b.c(n,"groupMailbox");this.c=n;this.a=t};_mgn.x.prototype={c:null,d:null,a:null,t:function(n){var t=new _g.EZ(this.w);t.explicitLogonUser=this.c;t.actionName=this.a;var i=new _g.oV(this.y());i.Body=new _g.jS;n.bH(i,t,this.r,this.q)},cz:function(n,t,i){try{this.d=n.Body.UnseenData;t()}catch(r){i(r)}}};_mgn.o=function(){_mgn.o.initializeBase(this)};_mgn.o.prototype={a:!1,t:function(n){var i=new _g.Gg(this.w);i.actionName=_mgn.o.a;var t=new _g.pH;t.Header=_mgn.d.a();t.Body=new _g.ke;n.bZ(t,i,this.r,this.q)},cz:function(n,t,i){var r=n;if(!r||!r.Body){i(Error.create("Unified group settings could not be retrieved"));return}this.a=r.Body.IsUnifiedGroupsAddressListPresent;t()}};_mgn.D=function(){_mgn.D.initializeBase(this)};_mgn.D.prototype={Group:null,IsMember:null,IsPinned:null};_mgn.y=function(n,t){_mgn.y.initializeBase(this);_a.b.c(n,"smtpAddress");this.d=n;this.c=t};_mgn.y.prototype={d:null,c:!1,a:null,e:function(){return this.c?"PinModernGroup":"UnpinModernGroup"},t:function(n){var t=new _g.Lr(this.w);t.actionName=this.c?"PinGroupAction":"UnpinGroupAction";this.a=_a.d.b(_a.a.r,this.e(),!0);n.cx(this.d,this.c,t,this.r,this.q)},cz:function(n,t,i){t();if(this.a){var r=this.a;r.l=this.C();r.o=this.d;_a.d.a(r);this.a=null}},O:function(n){var i=OwaApplication.h().a(n);_js.d.a(i)&&(i="Failed");_h.dX.prototype.O.call(this,n);if(this.a){var t=this.a;t.k=i;t.l=this.C();t.o=this.d;_a.d.a(t);this.a=null}}};_mgn.E=function(){_mgn.E.initializeBase(this)};_mgn.E.prototype={UnseenData:null};_mgn.G=function(){};_mgn.G.registerInterface("_mgn.G");_mgn.H=function(){};_mgn.H.registerInterface("_mgn.H");_mgn.I=function(){};_mgn.I.registerInterface("_mgn.I");_mgn.t=function(){};_mgn.t.registerInterface("_mgn.t");_mgn.A=function(){};_mgn.A.prototype={e:0,b:null,a:function(){return"Exchange:GroupAssociation"},c:null,d:null};_mgn.B=function(){};_mgn.B.prototype={d:null,c:0,a:function(){return"Exchange:GroupUnseenItem"},b:null};_mgn.C=function(n,t,i){this.d=_a.P.a();_a.b.a(n,"sessionSettings");this.g=n;this.f=t;this.e=i};_mgn.C.prototype={g:null,f:null,e:null,b:function(){return!!this.e&&this.e.a().ca().Enabled},a:function(n,t){var i=null;if(Array.contains(n,"Exchange:GroupUnseenItem")){var r=t;i=this.i(r.c());var f=this;i.m(_a.a.p,"UnseenItemNotification",function(n){var i=n;var t=new _mgn.B;t.d=i.UnseenData;t.c=i.EventType;t.b=i.reason;r.l(t)},0)}else if(Array.contains(n,"Exchange:GroupAssociation")){var e=new _g.be;i=this.h();var u=this;i.m(_a.a.p,"GroupAssociationNotification",function(n){var r=n;if(r.Group){var i=new _mgn.A;i.b=r.Group;i.e=r.EventType;if(u.b()){i.c=r.IsMember;i.d=r.IsPinned}t.l(i)}},0)}if(i){this.d.b(i.l,i);return i.l}return""},h:function(){var n=new _g.be;n.NotificationType="GroupAssociationNotification";n.ChannelId=_a.T.a;return new _h.L(n)},i:function(n){var t=new _g.be;t.NotificationType="UnseenItemNotification";t.ChannelId=_a.T.a;var i;if(this.b()){t.MailboxId=n;i=new _h.L(t)}else{var r=this.f.a()==="TouchNarrow"||this.f.a()==="TouchWide";i=new _h.bD(t,null,null,n,this.g.bl.LogonEmailAddress,r)}return i},c:function(n){if(this.d.c(n)){this.d.a[n].t();this.d.e(n)}}};_mgn.b=function(n,t,i,r,u,f){this.bt=Function.createDelegate(this,this.K);this.X=Function.createDelegate(this,this.bz);this.br=Function.createDelegate(this,this.bL);this.bq=Function.createDelegate(this,this.bK);this.bs=Function.createDelegate(this,this.bM);this.l=this.NotificationCallback;_mgn.b.resolveInheritance();this.c=this.apcl;this.g=this.rpcl;_mgn.b.initializeBase(this);_js.i.c(n,"groupsDataProvider");_js.i.c(t,"notificationDataProvider");_js.i.c(r,"groupViewModelFactory");_js.i.c(f,"featureManager");this.G=n;this.J=t;this.D=i;this.O=r;this.bl=u;this.be=f;var e=this,o=this;this.G.BeginGetHomeGroup(function(n){e.T=new _mgn.h(n,1,e,e.G,e.J,e.D,e.O,e.i());e.E(e.T)},function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get groups: {0}",n)});this.w=new _js.f;this.z=new _js.f;this.y=new _js.f;this.H=new _js.f;this.R=new _js.f;this.B={};this.K();this.bk=new _C(this.bs,_a.a.r);this.P=new _C(this.bq,_a.a.r);this.Q=new _C(this.br,_a.a.r);this.w.d(this.X);this.z.d(this.X);this.y.d(this.X);this.H.d(this.X);this.J.a(["Exchange:GroupAssociation"],this)};_mgn.b.prototype={be:null,R:null,w:null,z:null,y:null,H:null,G:null,J:null,D:null,O:null,bl:null,T:null,A:null,U:!1,bk:null,P:null,Q:null,L:!1,B:null,ba:!1,Z:!1,bj:!1,I:!1,bg:!1,bf:!1,bc:null,C:!1,N:!1,S:null,bb:0,M:!0,F:null,m:function(n){this.dV("GroupsCollectionChanged",n)},r:function(n){this.dW("GroupsCollectionChanged",n)},bu:function(n){this.dV("SelectedGroupChanged",n)},bG:function(n){this.dV("GroupUnpinned",n)},bE:function(n){this.dV("GroupPinned",n)},bF:function(n){this.dV("BrowseGroups",n)},bD:function(n){this.dV("CreateGroups",n)},j:function(){return this.w},k:function(){return this.z},a:function(){return this.R},bU:function(n){if(this.U!==n){this.U=n;this.dQ("IsHomeSelected")}return n},E:function(n){var t=this.A!==n;if(t){var r=!!n&&n.e===1;this.I||this.dZ("SelectedGroupChanging",this.A);this.A=n;OwaApplication.e().a(_y.eh,new _y.eh(n?n.a():null));this.dQ("SelectedGroup");this.bU(r)}if(!this.I){(t||this.D.a()!=="Mouse")&&this.dZ("SelectedGroupChanged",this.A);var u=!!n&&(n.e===2||n.e===3);if(t&&u){var i=0;this.D.a()==="Mouse"&&(i=this.R.y(n)?1:2);this.bl.M(this.A.d.bl.SmtpAddress,i,this.A.d.position,this.A.e===3)}}return n},p:function(){return!(!this.L&&this.C&&!this.N)},e:function(){return this.L},bQ:function(n){if(this.L!==n){this.L=n;this.dU("HasGroups","IsWelcomeMessageHidden");this.L&&this.bn(!1)}return n},bS:function(n){if(this.ba!==n){this.ba=n;this.dQ("HasPinnedAndUnpinnedGroups")}return n},bR:function(n){if(this.Z!==n){this.Z=n;this.dQ("HasJoinedAndVisitedGroups")}return n},bB:function(n){if(this.M!==n){this.M=n;this.dQ("HideBrowseGroups");if(!this.M&&this.F&&this.F.h.w.length===1){this.F.h.r(0,new _fm.d(_u.R.Dw,null,this.P));this.dQ("GroupsHeaderContextMenuViewModel")}}return n},bT:function(n){if(this.bj!==n){this.bj=n;this.dQ("HasRecommendedGroups")}return n},b:function(){return this.C},bC:function(n){if(this.C!==n){this.C=n;this.dU("IsReady","IsWelcomeMessageHidden");this.C&&this.bN()}return n},o:function(){return this.N},bn:function(n){if(this.N!==n){this.N=n;this.dU("InitialGroupsLoadFailed","IsWelcomeMessageHidden")}return n},d:function(){return this.Q},n:function(){return this.I},V:function(n){if(this.I!==n){this.I=n;this.dQ("GroupsMoveInProgress");this.I||this.bz(null,null)}return n},bv:function(){return this.D.a()!=="Mouse"},bJ:function(){return $a(_g.a.a().e().bl.GroupCreationEnabled)?!1:!_g.a.a().e().bl.GroupCreationEnabled||this.bv()},i:function(){return _mgn.a.b(this.be)},h:function(){if(this.D.a()!=="Mouse")return null;if(!this.F){this.F=new _fm.f(null);this.M||this.F.h.a(new _fm.d(_u.R.Dw,null,this.P));this.F.h.a(new _fm.d(_u.R.Qp,null,this.Q))}return this.F},t:function(){this.bb>0&&this.K()},K:function(){if(this.bg){this.bf=!0;return}this.bg=!0;if(this.S){_js.g.a().b(this.S);this.S=_js.g.a().b(this.S)}var n=this,t=this;this.G.BeginGetGroups(function(t,i,r,u){n.V(!0);var c=n.A&&!n.U?n.A.d.a():null;var e=n.B;n.B={};n.z.g();n.w.g();n.H.g();n.bi(r,e,5,n.H);n.bi(i,e,3,n.z);n.bi(t,e,2,n.w);for(var f=[],s=0;s<n.y.w.length;s++){var o=n.y.w[s];$a(n.B[o.d.a()])?n.B[o.d.a()]=o:f[f.length]=o}for(var h=0;h<f.length;h++)n.y.m(f[h],!0);_mgn.a.a(n.be)||n.bB(!u);n.bI(e);_js.d.a(c)||n.bh(c);n.W();n.V(!1);n.bn(!1);n.bb=0;n.bC(!0);n.bA()},function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get groups: {0}",n);t.bC(!0);t.L||t.bn(!0);t.bA();if(t.bb<3){t.bb++;t.S=_js.g.a().e(_a.a.r,"GroupsViewModel",t.bt,6e4)}})},bd:function(n){var t=this.B[n.a()];var i=!1;if($a(t)){t=new _mgn.h(n,2,this,this.G,this.J,this.D,this.O,this.i());this.B[n.a()]=t;i=!0}else if(t.e===4){this.bO(t);this.V(!0);var r=this.A?this.A.d.a():null;this.y.m(t,!0);t.w(2);_js.d.a(r)||r!==t.d.a()||this.bh(t.d.bl.SmtpAddress);i=!0}if(i){if(this.i())this.K();else{this.w.r(0,t);this.W()}this.V(!1)}},bO:function(n){n&&n.f&&n.f.br()},bp:function(n){var t=this.v(n);this.E(t);return t},v:function(n){var t=this.B[n.a()];if(t)return t;t=new _mgn.h(n,4,this,this.G,this.J,this.D,this.O,this.i());this.y.r(0,t);this.B[n.a()]=t;this.W();if(this.C){this.by(n);return t}else{this.bc=n;return t}},q:function(n){this.bm(n,!0)},u:function(n){this.bm(n,!1)},bo:function(n){var i=_g.N.c(n);var t=this.B[i];if(!$a(t)){t.d.f()?this.z.m(t,!0):this.w.m(t,!0);t.dispose();delete this.B[i];this.W()}},bP:function(n){var t=this.f(n);t&&t.O()},bh:function(n){var t=this.f(n);t&&this.E(t)},f:function(n){var t=_g.N.c(n);return this.bw(t)},bw:function(n){var t=this.B[n];return $a(t)?null:t},NotificationCallback:function(n){if(n.a()==="Exchange:GroupAssociation"){var t=n;if(this.J.b()&&!$a(t.c)){t.c?this.i()?this.bx(t.b):this.bd(_g.N.g(t.b)):$a(t.b.SmtpAddress)?this.K():this.bo(t.b.SmtpAddress);$a(t.d)||this.i()||this.bm(t.b.SmtpAddress,t.d)}else switch(t.e){case"RowAdded":if(this.i())this.bx(t.b);else{var i=_g.N.g(t.b);$a(this.B[i.a()])&&this.bd(i)}break;case"RowDeleted":case"Reload":case"RowModified":this.K();break;case"SetColumnDone":case"RestrictDone":case"SortDone":case"Error":case"QueryResultChanged":throw Error.invalidOperation();}}},bx:function(n){var t=null;n&&!$a(n.SmtpAddress)&&(t=this.B[n.SmtpAddress.toLowerCase()]);t&&t.e!==4||this.K()},bi:function(n,t,i,r){if(n){for(var o=[],s=n,h=s.length,e=0;e<h;++e){var f=s[e];var u=t[f.a()];if($a(u))u=new _mgn.h(f,i,this,this.G,this.J,this.D,this.O,this.i());else{u.w(i);u.d.o(f)}if(!(f.a()in this.B)){this.B[f.a()]=u;Array.add(o,u)}}r.p(o)}},bz:function(n,t){if(!this.I){this.bQ(this.w.w.length>0||this.z.w.length>0||this.y.w.length>0);this.bS(this.w.w.length>0&&this.z.w.length>0);this.bR((this.w.w.length>0||this.z.w.length>0)&&this.y.w.length>0);this.bT(this.H.w.length>0);this.dX("GroupsCollectionChanged")}},bN:function(){if(this.bc){this.by(this.bc);this.bc=null}},bK:function(){var n=_a.d.b(_a.a.r,"ClickBrowseGroupsButton");this.dX("BrowseGroups");_a.d.a(n)},bL:function(){var n=_a.d.b(_a.a.r,"ClickCreateGroupButton");this.dX("CreateGroups");_a.d.a(n)},bM:function(){this.E(this.T)},bm:function(n,t){var e=_g.N.c(n);var i=this.B[e];if(!$a(i)&&t!==i.d.f()){var o=t?this.w:this.z;var f=t?this.z:this.w;var r=t?"GroupPinned":"GroupUnpinned";this.V(!0);try{var u=this.A===i;o.m(i,!0);f.r(0,i);i.w(t?3:2);this.dZ(r,i.d);u&&this.E(i)}finally{this.V(!1)}this.W()}},W:function(){for(var n=0,r=0;r<this.z.w.length;r++)this.z.w[r].y(n++);for(var u=0;u<this.w.w.length;u++)this.w.w[u].y(n++);for(var t=0;t<this.y.w.length;t++)this.y.w[t].y(n++);for(var i=0;i<this.H.w.length;i++)this.H.w[i].y(n++);this.bV()},bV:function(){var n=this.bH();this.R.g();this.R.p(n.f())},bH:function(){var n=new _js.f;n.p(this.z.f());if(n.w.length>=10)return n;for(var r=Math.min(10-n.w.length,this.w.w.length),i=0;i<r;i++)n.a(this.w.w[i]);if(n.w.length>=10)return n;r=Math.min(10-n.w.length,this.y.w.length);for(var t=0;t<r;t++)n.a(this.y.w[t]);return n},by:function(n){if(n.c!==1){var i=this,t=this;this.G.BeginGetGroup(n.bl.SmtpAddress,function(t){n.o(t)},function(i){if(n.c!==1){var r=t.bw(n.a());if(r&&r.e===4){_js.Trace.logWarning(_a.a.r,"BeginGetGroup failed for group {0}: {1}",n.a(),i);delete t.B[n.a()];t.y.m(r,!0);t.W()}}})}},bI:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};$a(this.B[t.key])&&t.value.dispose()}},bA:function(){this.bg=!1;if(this.bf){this.bf=!1;this.K()}}};_mgn.h=function(n,t,i,r,u,f,e,o){this.C=Function.createDelegate(this,this.K);this.B=Function.createDelegate(this,this.N);this.F=Function.createDelegate(this,this.L);this.G=Function.createDelegate(this,this.M);this.c=this.a;_mgn.h.initializeBase(this);_js.i.c(n,"group");_js.i.c(i,"groupsViewModel");_js.i.c(r,"groupsDataProvider");_js.i.c(u,"notificationProvider");this.i=f.a()==="Mouse"?49:9;this.k=r;this.s=u;this.m=i;this.d=n;this.w(t);this.d.position=65535;this.D=e;this.h=o;if(this.e!==1&&!o){this.z=new _C(this.G,_a.a.r);this.u=new _C(this.F,_a.a.r);this.A=new _fm.d(_u.R.Lb,null,this.z);this.v=new _fm.d(_u.R.Em,null,this.u);this.g=new _fm.f([this.A,this.v]);this.I()}this.d.unseenData||(this.d.unseenData=_g.fl.a());this.d.unseenData.apcl("UnseenCount",this.B);if(f.a()==="Mouse"&&t!==1){var h=_g.N.b(this.d);this.f=this.D.a(_h.k.a(h),2,!1,1);this.f.g(!0);var s=this.f.m()[0];this.f.g(!1);if(s){this.g||(this.g=new _fm.f([]));this.g.h.a(new _fm.d(_u.R.Uk,null,s.i))}}};_mgn.h.prototype={d:null,f:null,D:null,u:null,z:null,h:!1,e:0,g:null,A:null,v:null,m:null,k:null,s:null,i:0,j:null,b:function(){return this.d},H:function(){return this.d.unseenData.bl.UnseenCount>0},w:function(n){if(this.e!==n){this.d.k(n===3);this.d.isMember=n===3||n===2;this.e=n;this.I();this.cf(["GroupType","CanPin","CanUnpin","CanJoin"])}return n},y:function(n){if(this.d.position!==n){this.d.position=n;this.e!==4&&this.e!==5&&this.e!==1&&(!this.E()&&this.d.position<=this.i?this.P():this.E()&&this.d.position>this.i&&this.J())}return n},a:function(){return this.d.a()},n:function(){return!this.h&&this.e===2},p:function(){return!this.h&&this.e===3},o:function(){return!1},q:function(){return this.u},t:function(){return this.z},r:function(){return null},E:function(){return!$a(this.j)},l:function(n){_js.i.c(n,"notification");switch(n.a()){case"Exchange:GroupUnseenItem":var t=n;if(t.c==="Reload"){if(!this.H()){var i=this;this.k.BeginGetGroupUnseenData(this.d.a(),"Reload-"+t.b,this.C,function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get GroupUnseenCount: {0}",n)})}}else this.K(t.d);break;default:throw Error.notImplemented();}},O:function(){this.d.unseenData.c()},bu:function(){this.E()&&this.J();this.f&&this.f.ba();this.d&&this.d.unseenData&&this.d.unseenData.rpcl("UnseenCount",this.B);_js.x.prototype.bu.call(this)},P:function(){var n=this;this.k.BeginGetGroupUnseenData(this.d.a(),"SubscribeForNotifications",this.C,function(n){_js.Trace.logWarning(_a.a.r,"Failed to Get GroupUnseenCount: {0}",n)});this.j=this.s.a(["Exchange:GroupUnseenItem"],this)},K:function(n){if(n){this.d.unseenData.f(n);this.bt("HasUnseenData")}},J:function(){this.s.c(this.j);this.j=null},I:function(){if(!this.h&&this.g){this.v.c(this.e!==2);this.A.c(this.e!==3)}},M:function(){this.m.u(this.d.bl.SmtpAddress)},L:function(){this.m.q(this.d.bl.SmtpAddress)},N:function(n,t){this.bt("HasUnseenData")}};_mgn.m=function(){};_mgn.m.a=function(){return _fm.g.a("browse_groups","browse_groups","owa","ms-font-color-themePrimary")};_mgn.m.b=function(){return _fm.g.a("create_group","create_group","owa","ms-font-color-themePrimary")};_mgn.p=function(n){this.i=Function.createDelegate(this,this.m);_mgn.p.initializeBase(this,[n]);this.y("GroupsView");this.a={}};_mgn.p.prototype={d:null,c:null,b:null,e:null,a:null,g:function(){var t=this.E();if(!t)return null;var i=t.A;if(!i||t.U)return null;var n=null;switch(i.e){case 3:n=this.k()?this.k().bA():null;break;case 2:n=this.j()?this.j().bA():null;break;case 4:n=this.l()?this.l().bA():null;break}return n},f:function(){!this.d&&this.F&&(this.d=this.F.a("scrollRegionId"));return this.d},k:function(){this.c=this.h(this.c,"pinnedGroupsListViewId");return this.c},j:function(){this.b=this.h(this.b,"joinedGroupsListViewId");return this.b},l:function(){this.e=this.h(this.e,"visitedGroupsListViewId");return this.e},J:function(){_js.b.prototype.J.call(this);$a(this.g())||_js.g.a().a(this.I(),"ConversationReadingPaneView set SelectedItem - trigger scroll to selected item",this.i,0)},m:function(){if(this.P()&&!this.bL&&this.f()&&!$a(this.g())){var t=this.g();var n=t.B[0].offsetTop;var i=t.B[0].offsetHeight;if(n+i>this.f().B[0].offsetHeight){this.a.scrollTop=n;this.f().B.animate(this.a,400)}}},h:function(n,t){if(n)return n;this.F&&(n=this.F.a(t));return n}};_mgn.q=function(n){_mgn.q.initializeBase(this,[n]);this.y("GroupView");this.bk(8197)};_mgn._TI=function(){};_mgn._TI.$$cctor=function(){var l="GroupsView._tid1";new _A(l,function(){_mgn._TI.a[l]===undefined&&(_mgn._TI.a[l]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Pr]]]);var n=_mgn._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var a="GroupsView._tid2";new _A(a,function(){_mgn._TI.a[a]===undefined&&(_mgn._TI.a[a]=[[[-1,4,null,null,null,"BusyText",null,_mgn._TI.u,0,null,null,null,_u.R.KI]]]);var t=_mgn._TI._hf.childNodes[1].cloneNode(!0);var n=new _fce.g(t.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));n.a=0;n.b(!0);return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var h="GroupsView._tid3";new _A(h,function(){_mgn._TI.a[h]===undefined&&(_mgn._TI.a[h]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.NI]]]);var n=_mgn._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var c="GroupsView._tid4";new _A(c,function(){_mgn._TI.a[c]===undefined&&(_mgn._TI.a[c]=[null]);var t=_mgn._TI._hf.childNodes[2].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.b,function(n){return new _fce.b(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var v="GroupsView._tid5";new _A(v,function(){_mgn._TI.a[v]===undefined&&(_mgn._TI.a[v]=[null]);var t=_mgn._TI._hf.childNodes[3].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.b,function(n){return new _fce.b(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var w="GroupsView._tid6";new _A(w,function(){_mgn._TI.a[w]===undefined&&(_mgn._TI.a[w]=[null]);var t=_mgn._TI._hf.childNodes[4].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.b,function(n){return new _fce.b(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var b="GroupsView._tid7._tid8";new _A(b,function(){_mgn._TI.a[b]===undefined&&(_mgn._TI.a[b]=[[[-1,4,null,null,null,"Id",null,_mgn._TI.w,0,null,null,null,_mgn.m.a()]],[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Dw]]]);var n=_mgn._TI._hf.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_mgn.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_mgn._TI.a);var y="GroupsView._tid7";new _A(y,function(){_mgn._TI.a[y]===undefined&&(_mgn._TI.a[y]=[[[-1,0,["BrowseGroupsCommand"],[_mgn._TI.n],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var t=_mgn._TI._hf.childNodes[6].cloneNode(!0);var n=new _fc.b(t.children[0]);n.y("GroupsView._tid7._tid8");return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var p="GroupsView._tid9._tida";new _A(p,function(){_mgn._TI.a[p]===undefined&&(_mgn._TI.a[p]=[[[-1,4,null,null,null,"Id",null,_mgn._TI.w,0,null,null,null,_mgn.m.b()]],[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Qp]]]);var n=_mgn._TI._hf.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_mgn.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_mgn._TI.a);var i="GroupsView._tid9";new _A(i,function(){_mgn._TI.a[i]===undefined&&(_mgn._TI.a[i]=[[[-1,0,["IsTouchLayout"],[_mgn._TI.L],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0],[-1,0,["CreateGroupCommand"],[_mgn._TI.o],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var t=_mgn._TI._hf.childNodes[7].cloneNode(!0);var n=new _fc.b(t.children[0]);n.y("GroupsView._tid9._tida");return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var r="GroupsView.GroupsPanel";new _A(r,function(){_mgn._TI.a[r]===undefined&&(_mgn._TI.a[r]=[null]);var n=_mgn._TI._hf.childNodes[8].cloneNode(!0);var t=new _mgn.p(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var n="GroupsView.GroupFunctionsTemplate._tidb";new _A(n,function(){_mgn._TI.a[n]===undefined&&(_mgn._TI.a[n]=[[[-1,4,null,null,null,"ImageId",null,_mgn._TI.s,0,null,null,null,_mgn.m.a()],[-1,4,null,null,null,"AriaLabel",null,_mgn._TI.S,0,null,null,null,_u.R.Er],[-1,4,null,null,null,"Text",null,_mgn._TI.t,0,null,null,null,_u.R.Dw],[-1,0,["BrowseGroupsCommand"],[_mgn._TI.n],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var i=_mgn._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.b(i.children[0]);t.g("_mgn_e ms-font-color-themePrimary");t.f("_mgn_f");return new _B(i,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var t="GroupsView.GroupFunctionsTemplate";new _A(t,function(){_mgn._TI.a[t]===undefined&&(_mgn._TI.a[t]=[[[-1,0,["HideBrowseGroups"],[_mgn._TI.p],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mgn._TI.s,0,null,null,null,_mgn.m.b()],[-1,4,null,null,null,"Text",null,_mgn._TI.t,0,null,null,null,_u.R.Qp],[-1,0,["IsGroupCreationDisabled"],[_mgn._TI.q],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0],[-1,0,["CreateGroupCommand"],[_mgn._TI.o],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var i=_mgn._TI._hf.childNodes[10].cloneNode(!0);var n=new _fc.b(i.children[1]);n.g("_mgn_e ms-font-color-themePrimary");n.f("_mgn_f");var r=new _js.b(i.children[0]);r.y("GroupsView.GroupFunctionsTemplate._tidb");return new _B(i,[r,n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var u="GroupsView.NoGroups._tidc";new _A(u,function(){_mgn._TI.a[u]===undefined&&(_mgn._TI.a[u]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Pr]]]);var n=_mgn._TI._hf.childNodes[11].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_y.cC,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var o="GroupsView.NoGroups._tidd";new _A(o,function(){_mgn._TI.a[o]===undefined&&(_mgn._TI.a[o]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.NI]]]);var n=_mgn._TI._hf.childNodes[11].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_y.cC,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var s="GroupsView.NoGroups";new _A(s,function(){_mgn._TI.a[s]===undefined&&(_mgn._TI.a[s]=[[[-1,0,["IsWelcomeMessageHidden"],[_mgn._TI.B],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"BusyText",null,_mgn._TI.u,0,null,null,null,_u.R.KI],[-1,0,["IsReady"],[_mgn._TI.m],null,"IsBusy",null,_mgn._TI.T,1,_mgn._TI.d(),null,!1]],[[-1,0,["InitialGroupsLoadFailed"],[_mgn._TI.A],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]],[[-1,0,["IsReady"],[_mgn._TI.m],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]]]);var n=_mgn._TI._hf.childNodes[12].cloneNode(!0);var r=new _js.b(n.children[3]);r.y("GroupsView.GroupFunctionsTemplate");var u=new _js.b(n.children[2]);u.y("GroupsView.NoGroups._tidd");var t=new _fce.g(n.children[1],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));t.a=0;var i=new _js.b(n.children[0]);i.y("GroupsView.NoGroups._tidc");return new _B(n,[i,t,u,r])},_y.cC,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var f="GroupsView";new _A(f,function(){_mgn._TI.a[f]===undefined&&(_mgn._TI.a[f]=[null,null,[[-1,1,["DataContext","IsHomeSelected"],[_mgn._TI.x,_mgn._TI.J],null,"IsSelected",null,_mgn._TI.X,1,null,null,!1],[-1,1,["DataContext","HomeSelectedCommand"],[_mgn._TI.x,_mgn._TI.H],null,"ClickCommand",null,_mgn._TI.bb,1,null,null,null],[-1,0,["HomeGroup"],[_mgn._TI.G],null,"DataContext",null,_mgn._TI.ba,1,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.PZ]],[[-1,0,["IsWelcomeMessageHidden"],[_mgn._TI.M],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["IsReady"],[_mgn._TI.K],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["InitialGroupsLoadFailed"],[_mgn._TI.I],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]],[[-1,0,["PinnedGroups"],[_mgn._TI.O],null,"DataSource",null,_mgn._TI.k,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.h],_mgn._TI.i,"SelectedItem",_mgn._TI.j,_mgn._TI.l,2,null,null,null]],[[-1,5,["HasPinnedAndUnpinnedGroups"],[_mgn._TI.F],null,"_mgn_6",null,null,0,_mgn._TI.d(),null,null]],[[-1,0,["JoinedGroups"],[_mgn._TI.N],null,"DataSource",null,_mgn._TI.k,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.h],_mgn._TI.i,"SelectedItem",_mgn._TI.j,_mgn._TI.l,2,null,null,null]],[[-1,5,["HasJoinedAndVisitedGroups"],[_mgn._TI.E],null,"_mgn_6",null,null,0,_mgn._TI.d(),null,null]],[[-1,0,["VisitedGroups"],[_mgn._TI.P],null,"DataSource",null,_mgn._TI.k,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.h],_mgn._TI.i,"SelectedItem",_mgn._TI.j,_mgn._TI.l,2,null,null,null]],null,[[-1,0,["HideBrowseGroups"],[_mgn._TI.p],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["IsGroupCreationDisabled"],[_mgn._TI.q],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0]]]);var n=_mgn._TI._hf.childNodes[13].cloneNode(!0);var p=new _js.b(_B.a(n,[0,0,10,1]));p.y("GroupsView._tid9");var w=new _js.b(_B.a(n,[0,0,10,0]));w.y("GroupsView._tid7");var a=new _js.c(_B.a(n,[0,0,10]));a.z.parentNode.removeChild(a.z);var u=new _fce.b(_B.a(n,[0,0,9]),_js.a.Instance.a(_ff.a));u.bm("div");u.S("GroupView");u.y("GroupsView._tid6");u.z.parentNode.removeChild(u.z);var l=new _js.c(_B.a(n,[0,0,8]));l.z.parentNode.removeChild(l.z);var i=new _fce.b(_B.a(n,[0,0,7]),_js.a.Instance.a(_ff.a));i.bm("div");i.S("GroupView");i.y("GroupsView._tid5");i.z.parentNode.removeChild(i.z);var v=new _js.c(_B.a(n,[0,0,6]));v.z.parentNode.removeChild(v.z);var r=new _fce.b(_B.a(n,[0,0,5]),_js.a.Instance.a(_ff.a));r.bm("div");r.S("GroupView");r.y("GroupsView._tid4");r.z.parentNode.removeChild(r.z);var e=new _js.b(_B.a(n,[0,0,4]));e.y("GroupsView._tid3");e.z.parentNode.removeChild(e.z);var s=new _js.b(_B.a(n,[0,0,3]));s.y("GroupsView._tid2");s.z.parentNode.removeChild(s.z);var o=new _js.b(_B.a(n,[0,0,2]));o.y("GroupsView._tid1");o.z.parentNode.removeChild(o.z);var b=new _fc.a(_B.a(n,[0,0,1,0]));var h=new _js.c(_B.a(n,[0,0,1]));h.z.parentNode.removeChild(h.z);var c=new _mgn.q(_B.a(n,[0,0,0]));c.z.parentNode.removeChild(c.z);var t=new _fce.c(_B.a(n,[0,0]));var y=new _fce.f(n.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));t.a.a(c);t.a.a(h);t.a.a(o);t.a.a(s);t.a.a(e);t.a.a(r);t.a.a(v);t.a.a(i);t.a.a(l);t.a.a(u);t.a.a(a);return new _B(n,[y,t,c,h,b,o,s,e,r,v,i,l,u,a,w,p]).R({scrollRegionId:y,pinnedGroupsListViewId:r,joinedGroupsListViewId:i,visitedGroupsListViewId:u})},_mgn.b,_mgn.p,function(n){return new _mgn.p(n)},!1,!1,!1,0,_mgn._TI.a);var e="GroupView";new _A(e,function(){_mgn._TI.a[e]===undefined&&(_mgn._TI.a[e]=[[[-1,5,["ShowSelected"],[_mgn._TI.v],null,"ms-bg-color-themeLighter",null,null,1,null,null,null]],[[-1,0,["Group","DisplayName"],[_mgn._TI.Q,_mgn._TI.D],null,"Text",null,_mgn._TI.c,1,null,null,null]],[[-1,1,["ShowSelected"],[_mgn._TI.v],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0],[-1,0,["UnseenData","UnseenCount"],[_mgn._TI.R,_mgn._TI.C],null,"Text",null,_mgn._TI.c,1,_mgn._TI.y(),null,null]]]);var t=_mgn._TI._hf.childNodes[14].cloneNode(!0);var u=new _fc.a(_B.a(t,[0,1,0]));var r=new _fc.a(_B.a(t,[0,0,0]));var i=new _js.c(t.children[0]);var n=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));n.A(_E.a(["ContextMenuViewModel"],[_mgn._TI.r],null,"MenuDataContext",null,_mgn._TI.W,1)).A(_E.a(["ContextMenuViewModel","IsShown"],[_mgn._TI.r,_mgn._TI.Y],_mgn._TI.Z,"IsShown",_mgn._TI.U,_mgn._TI.V,2,null,null,!1));n.a=2;n.b=5;i.G([n]);return new _B(t,[i,r,u])},_mgn.h,_mgn.q,function(n){return new _mgn.q(n)},!1,!1,!1,0,_mgn._TI.a)};_mgn._TI.z=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div><div> <div class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div><div> <div autoid=\"_mgn_1\"></div> </div><div> <div autoid=\"_mgn_2\"></div> </div><div> <div autoid=\"_mgn_3\"></div> </div><div> <span></span> <span></span> </div><div> <button autoid=\"_mgn_4\" type='button' class='_mgn_b ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <button autoid=\"_mgn_5\" type='button' class='_mgn_b ms-font-weight-regular ms-font-color-neutralPrimary _mgn_d'></button> </div><div> <div></div> </div><div> <button autoid=\"_mgn_6\" type='button' class='_mgn_c ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div>  <div></div>  <button autoid=\"_mgn_7\" type='button' class='_mgn_c ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <span class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary region'></span> </div><div>  <div class='_mgn_g'></div>  <div class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary region'></div>  <div></div>  <div class='_mgn_h'></div> </div><div> <div class='_mgn_2'> <div class='_mgn_3 ms-bg-color-white'> <div autoid=\"_mgn_0\" class='_mgn_4'></div> <div class='_mgn_5 ms-font-weight-regular ms-font-color-themePrimary'> <span></span> </div>  <div class='_mgn_7'></div>  <div class='_mgn_7'></div>  <div class='_mgn_7'></div>  <div class='_mgn_i'></div> <div class='_mgn_9 ms-border-color-themeLighter'></div>  <div class='_mgn_i'></div> <div class='_mgn_9 ms-border-color-themeLighter'></div>  <div class='_mgn_i'></div>  <div class='_mgn_a'> <div></div> <div></div> </div> </div> </div>    </div><div> <div class='_mgn_j ms-font-weight-semilight ms-font-color-neutralPrimary'> <div class='_mgn_k'><span autoid=\"_mgn_8\"></span></div> <div class='_mgn_l'> <span autoid=\"_mgn_9\"></span> </div> <div class='_mgn_m'></div>  </div> </div>";_js.c.a().appendChild(n);return n};_mgn._TI.n=function(n){return n.P};_mgn._TI.L=function(n){return n.bv()};_mgn._TI.o=function(n){return n.Q};_mgn._TI.p=function(n){return n.M};_mgn._TI.q=function(n){return n.bJ()};_mgn._TI.B=function(n){return n.p()};_mgn._TI.m=function(n){return n.b()};_mgn._TI.A=function(n){return n.o()};_mgn._TI.G=function(n){return n.T};_mgn._TI.x=function(n){return n.E()};_mgn._TI.J=function(n){return _mgn.b.isInstanceOfType(n)?n.U:null};_mgn._TI.H=function(n){return _mgn.b.isInstanceOfType(n)?n.bk:null};_mgn._TI.M=function(n){return n.p()};_mgn._TI.K=function(n){return n.C};_mgn._TI.I=function(n){return n.N};_mgn._TI.O=function(n){return n.z};_mgn._TI.h=function(n){return n.A};_mgn._TI.j=function(n){return n.bc()};_mgn._TI.F=function(n){return n.ba};_mgn._TI.N=function(n){return n.w};_mgn._TI.E=function(n){return n.Z};_mgn._TI.P=function(n){return n.y};_mgn._TI.v=function(n){return n.k()};_mgn._TI.r=function(n){return n.g};_mgn._TI.Y=function(n){return n.i};_mgn._TI.U=function(n){return n.c()};_mgn._TI.Q=function(n){return n.d};_mgn._TI.D=function(n){return n.bl.DisplayName};_mgn._TI.R=function(n){return n.d.unseenData};_mgn._TI.C=function(n){return n.bl.UnseenCount};_mgn._TI.c=function(n,t){n.a(t)};_mgn._TI.u=function(n,t){n.d(t)};_mgn._TI.w=function(n,t){n.a(t)};_mgn._TI.g=function(n,t){n.be(t)};_mgn._TI.b=function(n,t){n.M(t)};_mgn._TI.s=function(n,t){n.i(t)};_mgn._TI.S=function(n,t){n.bb(t)};_mgn._TI.t=function(n,t){n.h(t)};_mgn._TI.T=function(n,t){n.b(t)};_mgn._TI.ba=function(n,t){n.ba(t)};_mgn._TI.X=function(n,t){n.g(t)};_mgn._TI.bb=function(n,t){n.be(t)};_mgn._TI.k=function(n,t){n.bn(t)};_mgn._TI.i=function(n,t){n.E(t)};_mgn._TI.l=function(n,t){n.bf(t)};_mgn._TI.W=function(n,t){n.f(t)};_mgn._TI.Z=function(n,t){n.j(t)};_mgn._TI.V=function(n,t){n.e(t)};_mgn._TI.d=function(){_mgn._TI.f||(_mgn._TI.f=new _fc.k);return _mgn._TI.f};_mgn._TI.y=function(){_mgn._TI.e||(_mgn._TI.e=new _mgn.r);return _mgn._TI.e};_mgn.F.registerClass("_mgn.F");_mgn.c.registerClass("_mgn.c",_mgn.F);_mgn.a.registerClass("_mgn.a",_js.x,IModernGroupsNavigationFactory,_y.fF);ModernGroupsNavigationComponent.registerClass("ModernGroupsNavigationComponent",null,_a.iM);_mgn.g.registerClass("_mgn.g");_mgn.l.registerClass("_mgn.l");_mgn.f.registerClass("_mgn.f",_cc.cO,IModernGroupCalendarsProvider,_g.TY,_js.y);_mgn.r.registerClass("_mgn.r",null,_js.S);_mgn.d.registerClass("_mgn.d",_h.dX.$$(_g.OS));_mgn.j.registerClass("_mgn.j",_mgn.d);_mgn.k.registerClass("_mgn.k",_h.dX.$$(_g.vy));_mgn.z.registerClass("_mgn.z",_mgn.d);_mgn.i.registerClass("_mgn.i",_h.dX.$$(_g.oT));_mgn.w.registerClass("_mgn.w",_h.dX.$$(_g.uT));_mgn.x.registerClass("_mgn.x",_h.dX.$$(_g.uU));_mgn.o.registerClass("_mgn.o",_h.dX.$$(_g.OS));_mgn.D.registerClass("_mgn.D",_a.hJ);_mgn.D.prototype.toString=_a.hJ.prototype.toString;_mgn.y.registerClass("_mgn.y",_h.dX.$$(_g.wP));_mgn.E.registerClass("_mgn.E",_a.hJ);_mgn.E.prototype.toString=_a.hJ.prototype.toString;_mgn.b.registerClass("_mgn.b",_a.bz,_mgn.I,_y.cC);_mgn.h.registerClass("_mgn.h",_js.x,_mgn.G,_mgn.I,_y.gU,_y.fE);_mgn.p.registerClass("_mgn.p",_js.b);_mgn.q.registerClass("_mgn.q",_fce.d);_mgn._TI.registerClass("_mgn._TI");ModernGroupsNavigationComponent.$$cctor();_mgn.k.a="OWA_GetUserUnifiedGroupsAction";_mgn.e.b=null;_mgn.i.a="GI";_mgn.o.a="OWA_GetUnifiedGroupsSettingsAction";_mgn._TI._hf=_mgn._TI.z();_mgn._TI.f=null;_mgn._TI.e=null;_mgn._TI.a={};_mgn._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.moderngroupsnavigation.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.moderngroupsnavigation.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
