try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.p.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.b()&&t.g().a()<9);var r=i.c().bl.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.m()&&i.m().bl.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bl.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={a:function(n,t,i){n.e(_mcp.B).b(IMailComposeActionFactory).a();n.e(_mcp.M).b(IGroupInlineComposeActionFactory).a();var v=this;n.b(_mcp.W,function(){return new _mcp.W(n.a(IInferenceTracker),n.a(_g.a),n.a(IMailComposeContextFactory),n.a(_mcp.B),n.d(ISmimeCommandFactory))}).b(IMailResponseViewModelFactory).a();var y=this;n.b(_mcp.Q,function(){return new _mcp.Q(n.a(_y.dx),n.a(_a.t))}).b(IMailComposeContextFactory).a();var e=n.a(_a.e);var o=n.a(_g.f);var f=MailComposeComponent.a(i.a(),e,o);var u=n.a(_a.h);var r=i.a()==="Mouse"&&u.a().be().Enabled;var w=this;n.b(_mcp.T,function(){return new _mcp.T(n.d(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.d(IForgottenAttachmentDetectorFactory):null,n.d(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.B),n.a(_pe.e),n.a(_y.a),n.d(IOfflineHelpProvider),n.a(_mcp.y),n.a(_y.L),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.c(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dM),n.a(_a.x),n.a(_g.bb).g(),n.c(IMyLocationBuilder),n.d(IMailTipsHandlerFactory),n.d(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.r):null,r?n.d(ISendNotificationProviderViewModel):null,r?n.d(ISendFailureNotificationProviderViewModel):null,n.d(IFindRecipientMailComposeViewModelFactory),n.c(IComponentOverrideFactory),n.a(_g.a).bl.AttachmentPolicy,n.d(IIntroductionControllerFactory),n.c(ILinkPreviewBuilderFactory),n.d(IToPeoplePickerViewModelFactory),n.a(_a.e),i)}).b(IMailComposeViewModelFactory).a();var p=this;n.b(_mcp.U,function(){return new _mcp.U(n.d(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.d(IForgottenAttachmentDetectorFactory):null,n.d(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.B),n.a(_pe.e),n.a(_y.a),n.d(IOfflineHelpProvider),n.a(_mcp.y),n.a(_y.L),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.c(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dM),n.a(_a.x),n.a(_g.bb).g(),n.c(IMyLocationBuilder),n.d(IMailTipsHandlerFactory),n.d(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.r):null,r?n.d(ISendNotificationProviderViewModel):null,r?n.d(ISendFailureNotificationProviderViewModel):null,n.d(IFindRecipientMailComposeViewModelFactory),n.c(IComponentOverrideFactory),n.a(_g.a).bl.AttachmentPolicy,n.d(IIntroductionControllerFactory),n.c(ILinkPreviewBuilderFactory),n.d(IToPeoplePickerViewModelFactory),n.a(_a.e),i)}).b(IMailInlineComposeViewModelFactory).a();var a=this;n.b(_mcp.N,function(){return new _mcp.N(n.d(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.d(IForgottenAttachmentDetectorFactory):null,n.d(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.M),n.a(_pe.e),n.a(_y.a),n.d(IOfflineHelpProvider),n.a(_mcp.y),n.a(_y.L),n.a(_ff.c),n.d(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.c(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dM),n.a(_a.x),n.a(_g.bb).g(),n.c(IMyLocationBuilder),n.d(IMailTipsHandlerFactory),n.d(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.r):null,r?n.d(ISendNotificationProviderViewModel):null,r?n.d(ISendFailureNotificationProviderViewModel):null,n.d(IFindRecipientMailComposeViewModelFactory),n.c(IComponentOverrideFactory),n.a(_g.a).bl.AttachmentPolicy,n.d(IIntroductionControllerFactory),n.c(ILinkPreviewBuilderFactory),n.d(IToPeoplePickerViewModelFactory),n.a(_a.e),i)}).b(IGroupInlineComposeViewModelFactory).a();var h=this;n.b(_mcp.y,function(){return new _mcp.y(n.a(IMailComposeActionFactory))}).b(IMailComposeDiscardManager).a();var s=this;n.b(_mcp.m,function(){return new _mcp.m(window.document.createElement("div"),i.a(),n.a(_a.e),n.a(_a.t),n.a(_a.h),n.a(_ff.c),n.a(_a.x),n.a(_b.e))});var l=this;n.b(_mcp.j,function(){return new _mcp.j(window.document.createElement("div"),i.a(),n.a(_a.e),n.a(_a.t),n.a(_a.h),n.a(_ff.c),n.a(_a.x),n.a(_b.e))});var c=this;n.b(_mcp.E,function(){return new _mcp.E(n.c(IPopOutHelper),i.a())}).a()},b:function(){return[new _a.B(_mcp.E,1,1)]}};_mcp.E=function(n,t){if(t==="Mouse"){var i=this;n.e(function(n){n.a(_mcp.a,"MailComposeContext")})}};_mcp.L=function(){};_mcp.L.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.L.registerEnum("_mcp.L",!1);_mcp.X=function(){};_mcp.X.prototype={to:0,cc:1,bcc:2};_mcp.X.registerEnum("_mcp.X",!1);var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.R=function(){};_mcp.R.a=function(n){var t=null;_h.o.isInstanceOfType(n)?t=n.d:_h.n.isInstanceOfType(n)&&(t=n.k);return t};_mcp.l=function(n,t,i,r,u,f,e,o){this.br=Function.createDelegate(this,this.bQ);this.bs=Function.createDelegate(this,this.bX);this.bg=Function.createDelegate(this,this.bE);this.bh=Function.createDelegate(this,this.bV);this.bz=Function.createDelegate(this,this.bG);this.bv=Function.createDelegate(this,this.bY);this.bx=Function.createDelegate(this,this.bZ);this.bi=Function.createDelegate(this,this.bW);this.be=Function.createDelegate(this,this.bR);this.bf=Function.createDelegate(this,this.bS);this.bp=Function.createDelegate(this,this.bJ);this.bq=Function.createDelegate(this,this.bM);this.bo=Function.createDelegate(this,this.bI);this.bn=Function.createDelegate(this,this.bH);this.k=this.a;_mcp.l.initializeBase(this,[5,n]);this.z=i;this.N=u;this.bj=t;this.v=new _C(this.bn,this.G());this.w=r;this.bb=f;this.X=e;this.W=o;this.bm=!!i&&i.a().d().Enabled;this.bk=new _C(this.bo,this.G())};_mcp.l.prototype={z:null,w:null,N:null,bj:null,bb:null,M:null,X:null,v:null,bm:!1,bk:null,B:null,Z:null,S:null,Q:null,ba:!1,y:null,u:null,R:!1,bF:!1,W:null,bl:!0,d:function(){return this.dS(_mcp.l.b)},cc:function(n){this.dR(_mcp.l.b,n);return n},ca:function(n){if(this.B!==n){this.B=n;this.bt("InsertPictureCommand")}return n},l:function(){this.Z||(this.Z=new _C(this.bq,this.G()));return this.Z},j:function(n){this.by("AttachmentWellInitialized",n)},o:function(n){this.bN("AttachmentWellInitialized",n)},a:function(){return this.dS(_mcp.l.a)},p:function(n){this.dR(_mcp.l.a,n);return n},b:function(){return(this.a()?this.a().g():!1)||(this.M?this.M.c():!1)},e:function(){return this.a()&&this.a().b()?this.a().b().w.length>0:!1},q:function(n){this.bl=n;return n},f:function(){var n=_a.UserAgent.getInstance();return n.c()&&!!this.z&&this.w.a()&&(this.z.a().w().Enabled&&n.a()||this.z.a().B().Enabled&&n.G)},K:function(){if(this.E.bH()&&!this.u){_js.Trace.logInfo(_a.a.a,"Setting attachment component override");this.u=this.E.bG().a();this.u.c(this.bp)}},J:function(){if(this.u){this.u.a();this.u=null}},C:function(){var t=this.D.a.L;this.K();this.bK();var i=t.bv();var r=t.B();var u=!((t.a()===4||t.a()===13)&&!this.w.a());if(this.a()){this.a().bC(t.h(),r,i,t.b(),t.X());this.bB(t,i)}else{var n=this;this.bj.a(function(f){if(_y.c.a.a()==="TouchNarrow")n.p(f.a(t.h(),r,i,u,t.X(),!0,n.D.a.M,t.b()));else{var e=f.b(t.h());e.e(t.ba());e.h(1);var o=n.E.L.bk();var s=o?o.EmailAddress:null;n.p(f.c(e,r,i,_y.c.a.a()==="Mouse"?3:0,u&&n.bl,t.X(),!0,n.D.a.M,t.b(),n.D.a.X,n.D.a.cK,s))}n.a().n(n.bf);n.a().u(n.be);n.a().apcl("EditorCallContext",n.bi);n.a().L(n.E.co);n.cb("AttachmentWellInitialized",n);n.bB(t,i)})}},bJ:function(){return this.a()},bW:function(n,t){t==="EditorCallContext"&&this.E.bo().a(this.a().Q())},i:function(n){this.S&&this.S.c(!n)},h:function(n){this.Q&&this.Q.c(!n)},bR:function(n){if(_a.bm.a){var t=this;_js.g.a().c(_a.a.J,"TriggerPolicyTipsIfNeeded",function(){var n=t.D.b(23);n.a(8)})}},bS:function(){var t=this.D.a;var n=t.L;if(n.h()){this.bC(n);this.a()&&this.a().d(n.h(),n.B(),n.X())}else t.d().b("Attach",this.bx,this.bv,!1)},r:function(){if(!this.ba&&this.a()){var n=this.D.a.L;if(_y.c.a.a()==="Mouse")this.a().d(n.h(),n.B(),n.X());else{_js.Trace.logInfo(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bk(n.h(),n.B(),n.X(),this.bz)}this.bG();this.D.a.S.a(_y.dv,new _y.dv);this.ba=!0}},bG:function(){var n=this.D.a.L;if(n.ee)if(n.B()){var t=new _js.f;t.p(n.B().f());n.ee.p(t);n.ed()&&n.ed().p(t)}else{n.ee.p(null);n.ed()&&n.ed().p(null)}},H:function(){var n=this.a();if(n){n.D(this.bf);n.C(this.be);n.rpcl("EditorCallContext",this.bi);this.a().ba(this.E.co)}this.ba=!1;this.J();_mcp.P.prototype.H.call(this)},m:function(){var n=[];var t=this.D.b(13);var i=this.D.b(20);if(t){t.a().b&&Array.add(n,new _y.g(_u.P.i,t.a()));t.b().b&&Array.add(n,new _y.g(_u.P.U,t.b()));this.O()&&Array.add(n,new _y.g(this.A(),this.v))}else if(i)Array.add(n,new _y.g(this.A(),i.a()));else if(_a.UserAgent.getInstance().y()){Array.add(n,new _y.g(this.A(),this.v));this.w.c()&&this.D.a.L.d()==="HTML"&&!_a.UserAgent.getInstance().c()&&Array.add(n,new _y.g(_u.P.G,this.B))}return n},g:function(){var n=new _ff.e;var t=this.D.b(13);var i=this.D.b(20);if(t){t.c.b&&n.c(new _fm.d(_u.P.i,null,t.c));t.d.b&&n.c(new _fm.d(_u.P.U,null,t.d));this.O()&&n.c(new _fm.d(this.A(),null,this.v))}else if(i)n.c(new _fm.d(this.A(),null,i.b));else if(_a.UserAgent.getInstance().y()){n.c(new _fm.d(this.A(),null,this.v));this.w.c()&&this.D.a.L.d()==="HTML"&&!_a.UserAgent.getInstance().c()&&n.c(new _fm.d(_u.P.G,null,this.B))}return n},s:function(){var n=this.D.a.L;if(!_js.d.a(n.bu())&&!this.R&&n.h()&&this.a()){this.R=!0;var t=!1;try{this.a().be(n.bu(),this.bh,this.bg);t=!0}finally{t||(this.R=!1)}}},t:function(n){this.X&&this.a()&&this.X.a(this.a(),this.G()).b(n)},c:function(){var t=this.D.a;var n=t.L;if($a(n)||!n.g()){_js.Trace.logInfo(_a.a.a,"Show not allowed to add attachment due to context={0}; Upgraded={1}",n?"non-null":"null",n.g());t.T.a(0,_nbs.a.Xy,null);return!1}return!0},bH:function(){var t=this.D.a;var i=t.L;_js.Trace.logInfo(_a.a.a,"Insert attachment start");if(this.c()&&this.a())if(this.u)this.u.b(!1);else if(this.O()){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_js.Trace.logInfo(_a.a.a,"Opening OWA's file picker");this.cd(n)}else{_js.Trace.logInfo(_a.a.a,"Opening OS's file picker");this.a().e(!1,null,null)}this.E.P().a("AttachFile");_js.Trace.logInfo(_a.a.a,"Insert attachment end")},bQ:function(){var n=this.D.a;var t=n.L;_js.Trace.logInfo(_a.a.a,"Insert picture start");if(this.c()&&this.a()){this.u?this.u.b(!0):this.a().e(!0,null,null);this.E.P().a("InsertPicture")}_js.Trace.logInfo(_a.a.a,"Insert picture end")},bM:function(){if(this.M)this.bD(this.M);else if(this.bb){var n=this;this.bb.a(function(t){n.M=t;n.bD(n.M)})}},bD:function(n){_js.Trace.logInfo(_a.a.a,"Inserting location");var i=_a.d.b(_a.a.bg,"BeamMeUpPlaceholderPopulated");var t=this;n.d(function(i){t.E.bo().a(i);n.a(t.a(),i.a())},this.bs,i)},bX:function(n){if(n){var t=this.D.a;t.T.a(0,n,null)}},bK:function(){if(!this.d()){var n=[];if(this.bm)if(this.O()){var t=new _fm.d(_u.P.A,null,this.bk);Array.add(n,t);t=new _fm.d(_u.P.D,null,this.v);Array.add(n,t)}else this.bA(n);else this.bA(n);if(this.w.c()){var i=this;this.ca(new _C(this.br,this.G(),this.D.a.L,"BodyType",function(){return i.D.a.L.d()==="HTML"}));this.S=new _fm.d(_u.P.G,null,this.B,!1,null,_nbs.a.kP);Array.add(n,this.S);this.i(this.D.a.L.d()==="HTML");if(_a.UserAgent.getInstance().c()&&this.z&&this.z.a().w().Enabled){this.Q=new _fm.d(_nbs.a.eA,null,this.l(),!1,null,_nbs.a.Ff);Array.add(n,this.Q)}this.h(this.D.a.L.d()==="HTML")}this.cc(new _fm.f(n))}},bA:function(n){var t=new _fm.d(this.A(),null,this.v,!1,null,_nbs.a.Lw);Array.add(n,t)},bB:function(n,t){this.a().bI(!n.g());_js.Trace.logInfo(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.g()&&this.r();_mcp.P.prototype.C.call(this)},bC:function(n){n.B()||n.bp(new _js.f)},bZ:function(n){var i=this.D.a;var t=i.L;if(n.I===t.b()){this.bC(t);this.a()&&this.a().d(t.h(),t.B(),t.X());this.s()}},bY:function(n){var t=this.D.a;var i=t.L;if(this.a()&&n.I===i.b()){this.a().E();t.T.a(0,_nbs.a.jt,null);this.s()}},cd:function(n){if(this.N){var t=this;this.N.a(function(i){t.y=i;t.y&&t.y.a(t.a(),n,!1,t.D.a.bx,t.D.a.X,t.E.L.d()==="Text")})}},n:function(){if(this.O()&&this.N){var n=this;this.N.a(function(t){n.y=t;n.y&&n.y.b()})}},O:function(){return!!this.w&&!!this.W&&this.w.d(this.W.AttachmentDataProviderAvailable)},bV:function(n){this.D.a.L.cg(null);this.bE(n)},bE:function(n){n.y(this.bh);n.S(this.bg);this.R=!1;this.bF&&this.D.b(7).o()},A:function(){return this.O()?_u.P.B:_u.P.S},bI:function(){this.c()&&this.a()?this.a().O():_js.Trace.logWarning(_a.a.c,"Can't attach from computer because IsItemUpgraded = {0},this.AttachmentWellViewModelIsNull={1}",this.c(),!!this.a())}};_mcp.ba=function(n,t,i){this.N=Function.createDelegate(this,this.bi);this.O=Function.createDelegate(this,this.bj);this.t=Function.createDelegate(this,this.bk);this.w=Function.createDelegate(this,this.bh);_mcp.ba.initializeBase(this,[n,t,i]);this.l=new _mcp.bq(this.w,6e4)};_mcp.ba.prototype={l:null,C:function(){var n=this.D.a;var t=n.L;_js.Trace.logInfo(_a.a.a,"Enabling timer during initialization of auto save component");this.l.b=!0;if(!t.bg()){this.bl();_js.Trace.logInfo(_a.a.a,"Auto save timer started")}_mcp.z.prototype.C.call(this);n.S.b(_a.cJ,this.t)},bh:function(){var u=this.D;var r=u.a;var n=r.L;if(!n.bg()){if(!n.bz()){_js.Trace.logInfo(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var f=u.b(5);_js.Trace.logInfo(_a.a.a,"Checking dirty before auto save");var t=r.bw();var i=f.b();if(t&&!i){_js.Trace.logInfo(_a.a.a,"AutoSave:Context:{0}",n);this.l.e();this.b("AutoSave",this.O,this.N,!1)}else{this.l.c();_js.Trace.logInfo(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},bl:function(){var n=this.D.a.L;!n.bg()&&n.bz()&&this.l.c()},H:function(){_js.Trace.logInfo(_a.a.a,"Disabling the timer on reset");this.l.h();var n=this.D.a;n.S.c(_a.cJ,this.t);_mcp.z.prototype.H.call(this)},bu:function(){var n=this.D.a;n.S.c(_a.cJ,this.t)},bk:function(n){_js.g.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.w)},bj:function(n){var r=this.D;var i=r.a;var t=i.L;t.bg()||this.l.c()},bi:function(n){_js.Trace.logInfo(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.s.message);this.D.a.L.bg()||this.l.c()}};_mcp.r=function(n){this.k=Function.createDelegate(this,this.J);this.h=Function.createDelegate(this,this.y);this.i=Function.createDelegate(this,this.z);_mcp.r.initializeBase(this,[0,n])};_mcp.r.prototype={c:null,e:null,f:null,g:null,d:null,a:null,A:function(n){if(this.a!==n){this.a=n;this.bt("ComposeCommandingBar")}return n},m:function(){return this.D.a.e().a()},p:function(){return this.D.a.bh().a()},w:function(){return this.D.a.bf().h},t:function(){return this.D.a.b().d()},s:function(){return this.D.a.Q().d()},j:function(){this.g||(this.g=new _fm.i(this.w(),_u.P.K,_mcp.c.o(),0,null,_mcp.c.p(),!1,!1));return this.g},v:function(){this.c||(this.c=this.F.l()?new _fm.i(this.m(),_u.P.a,_mcp.c.E(),0,null,null,!1,!1):new _fm.i(this.m(),_u.P.E,_mcp.c.G(),0,null,null,!1,!1));return this.c},q:function(){this.d||(this.d=new _fm.i(this.p(),_u.R.YJ,null,0,null,null,!1,!1));return this.d},r:function(){if(!this.e){var n=this;this.e=new _fm.m(_nbs.a.bj,function(t){t(n.s())},0,_nbs.a.bj,!1,!1,_mcp.c.t(),!1)}return this.e},u:function(){this.f||(this.f=new _fm.i(this.t(),null,_mcp.c.D(),0,null,null,!0,!1));return this.f},C:function(){_js.Trace.logInfo(_mcp.r.a,"Initializing compose commanding bar");this.A(new _fm.q(_u.R.Bp));this.a.H=!0;this.b(this.v(),!0);this.b(this.r(),!0);this.b(this.j(),!1);this.b(this.q(),!0);this.D.a.bF()||this.D.a.L.n()===3||this.b(this.u(),!0);this.D.a.apcl("ShouldShowToolbarMessage",this.i);this.D.a.W().c?this.l():this.D.a.W().apcl("IsSecondInitializationComplete",this.h);this.n(this.E.bf().be());_js.Trace.logInfo(_mcp.r.a,"Completed initializing compose commanding bar");this.o();_mcp.P.prototype.C.call(this)},o:function(){this.D.a.ce&&this.D.a.ce(this.a)},bu:function(){this.D.a.rpcl("ShouldShowToolbarMessage",this.i);this.D.a.W().rpcl("IsSecondInitializationComplete",this.h);_js.x.prototype.bu.call(this)},l:function(){_js.Trace.logInfo(_mcp.r.a,"Adding affordance items to compose commanding bar");for(var t=this.D.a.be().e,i=0;i<t.d.length;i++)this.a.a(t.d[i]);var n=t.d[0];n.a(!n.c);n.a(!n.c);_js.Trace.logInfo(_mcp.r.a,"Completed added affordance items to compose commanding bar")},b:function(n,t){if(!this.a.bj(n)){n.a(!0);n.b(t);this.a.a(n)}},y:function(n,t){var i=n;if(i.c){this.D.a.bi().b()&&this.D.a.bb.IsLoadingFromServer&&(this.D.a.be().n=this.k);this.l()}},z:function(n,t){var i=!this.D.a.bO;this.B(i)},B:function(n){for(var r=this.a.b.w.length,t=0;t<r;t++){var i=this.a.b.w[t];i&&i.h!==1&&i.a(n)}},J:function(n,t){var i=this.a.cD(n);if(i>0){var r=this.a.b.w[i];r.a(!1);if(!this.a.bj(t)){this.a.bT(i+1,t);t.a(!t.c);t.a(!t.c)}}},n:function(n){this.a&&this.a.bj(this.j())&&this.j().b(n)}};_mcp.s=function(n,t,i){this.u=Function.createDelegate(this,this.N);this.v=Function.createDelegate(this,this.O);this.p=Function.createDelegate(this,this.J);this.w=Function.createDelegate(this,this.t);_mcp.s.initializeBase(this,[3,n]);this.s=t;this.q=i};_mcp.s.b=function(n,t){return new _y.g(n,t)};_mcp.s.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.s.prototype={r:null,i:null,m:!1,o:null,j:null,l:null,k:!1,s:null,q:null,d:function(){return"IsIrmProtected"},a:function(){return this.r},e:function(){return this.i},c:function(){return this.m},n:function(n){if(this.m!==n){this.m=n;this.bt("IsIrmProtected")}return n},h:function(){return this.o},M:function(n){if(this.o!==n){this.o=n;this.bt("ShowIrmInformationCommand")}return n},g:function(){return this.j},K:function(n){if(this.j!==n){this.j=n;this.bt("DialogViewModel")}return n},f:function(n){this.k=n;return n},b:function(){var i=_g.a.a();if(!$a(i.e())&&!i.e().bl.Irm||this.q.c()){_js.Trace.logInfo(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.D.a.L.C();var t=!n||!!n.a()||n.b()||n.k();_js.Trace.logInfo(_a.a.a,"CanSetCompliance={0}",t);return t},C:function(){var n=this.D.a;var u=n.L;var o=n.dl;var r=n.bb;if(this.b())if(_g.k.b){_js.Trace.logInfo(_a.a.a,"Checking main window for compliance configuration");this.i=_mcp.s.a;_g.k.b.ho(this.w)}else if(r.WasLoadedFromServer)this.t(r);else{_js.Trace.logInfo(_a.a.a,"Adding the loading permissions menu item");this.i=_mcp.s.a;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.a.a,"Submitting GetComplianceConfigurationAction");var e=n.S;e.b(_a.cN,this.p);var s=new _h.cl(r,n.S);s.d()}}else if(this.i&&this.k&&o.a){n.dl.z(this.i);this.k=!1}var t=u.C();this.n(!!t&&!t.a());if(this.m&&"Mouse"===_y.c.a.a()){var i=n.bc();i.a.apply(i,[4499].concat([t.bl.TemplateName,t.bl.TemplateDescription]));i.a.apply(i,[4500].concat([t.bl.ContentOwner]))}else if(u.bw()){var f=n.bc();f.a.apply(f,[3800].concat([u.cx(),u.cy()]))}"Mouse"===_y.c.a.a()||this.o||this.M(new _C(this.v,this.G()));_mcp.P.prototype.C.call(this)},H:function(){this.n(!1);_mcp.P.prototype.H.call(this)},A:function(n){var t=this.D.a.bb;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_js.Trace.logInfo(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.m,new _C(this.u,this.G()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _C(this.y(c.Id),this.G()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _C(this.z(l.Id),this.G()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _C(this.y(s.Id),this.G()));r++}else{i[f++]=n(h.Name,new _C(this.z(h.Id),this.G()));u++}}return i},B:function(){if("Mouse"===_y.c.a.a()||this.s.b()){var r=this.A(_mcp.s.c);r&&(this.r=new _fm.f(r))}else if(!this.k){if(!this.i){var u=this.A(_mcp.s.b);u&&(this.i=new _y.g(_nbs.a.jE,null,u))}var i=this.D.a.dl;if(this.i&&i){var t=i.a;if(t)for(var n=0;n<t.length;n++)if(t[n]){if(_nbs.a.dd===t[n].b){i.w(this.i,n+1);this.k=!0}}else _js.Trace.logError(_a.a.a,"existingMenuItems at index {0} can't be null",n)}}},J:function(n){var t=this.D.a;this.t(t.bb);t.S.c(_a.cN,this.p)},t:function(n){var i=this.D.a;i.bb=n;_js.Trace.logInfo(_a.a.a,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.c.a.a()){this.i&&i.dl&&i.dl.z(this.i);this.i=null;this.k=!1}n.WasLoadedFromServer&&this.B();if("Mouse"===_y.c.a.a()){var t=this.D.b(16);if(t.b()){var r=t.d(_u.P.j);r>=0&&t.b().h.n(r);n.WasLoadedFromServer&&t.M()}}},N:function(){var i=this.D.a;var n=i.L;i.P().a(_mcp.L.toString(0));_js.Trace.logInfo(_a.a.a,"Set no restriction");n.bJ("0");var t=i.bc();if($a(n.C())){if(n.bw()){t.b(3800);n.bM(!1);n.bG(null);n.bH(null);n.bI(null)}}else{if("Mouse"===_y.c.a.a()){t.b(4499);t.b(4500)}n.bN(null);this.n(!1)}},z:function(n){var t=this;return function(){var h=_a.d.b(_a.a.a,"MailComposeSetIRM",!0);var e=t.D.a;var r=e.L;r.bJ(n);if(r.bw()){e.M.b(3800);t.E.N();r.bM(!1);r.bG(null);r.bH(null);r.bI(null)}for(var s=e.bb.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();e.P().a(c);var i=new _g.dI;i.u(n);i.r(_g.a.a().c().bl.UserEmailAddress);i.s(!0);i.t(0);i.y(u.Name);i.w(u.Description);i.q(r.d());r.bN(i);if("Mouse"===_y.c.a.a()){var f=e.bc();f.b(4499);f.b(4500);f.a.apply(f,[4499].concat([u.Name,u.Description]));f.a.apply(f,[4500].concat([i.bl.ContentOwner]))}t.n(!0);_js.Trace.logInfo(_a.a.a,"Set IRM {0}",u.Name);break}}_a.d.a(h)}},y:function(n){var t=this;return function(){var u=t.D.a;var r=u.L;r.bJ(n);if(!$a(r.C())&&"Mouse"===_y.c.a.a()){var s=u.bc();s.b(4499);s.b(4500);r.bN(null);t.n(!1)}for(var o=u.bb.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.P().a(h);r.bM(!0);r.bG(i.Name);r.bH(i.Description);r.bI(i.Id);var e=u.bc();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_js.Trace.logInfo(_a.a.a,"Set class {0}",i.Name);break}}}},O:function(){var t=this.D.a.L;if(t.C()){var n=t.C();this.Q(n.bl.TemplateName,n.bl.TemplateDescription,n.bl.ContentOwner)}else _js.Trace.logError(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},Q:function(n,t,i){if($a(this.j)){this.K(new _bc.j);this.j.h.a(new _ff.f(this.j.i,_nbs.a.Qa))}this.j.k(n);$a(this.l)&&(this.l=new _mcp.O);this.l.d(t);this.l.c(String.format(_nbs.a.mW,i));this.j.m(this.l);this.j.g(!0)}};_mcp.P=function(n,t){_mcp.P.initializeBase(this);this.bU=n;this.D=t;if(t&&t.a){this.E=t.a;this.F=this.E.L;this.L=this.E.M}};_mcp.P.prototype={bU:0,D:null,E:null,F:null,L:null,V:!1,I:function(){return this.V},bd:function(n){this.V=n;return n},G:function(){return _a.a.a},C:function(){this.V=!0},H:function(){this.V=!1},bc:function(n){var t=this.U(n);this.E.cR(t);if(t===55||t===50){var i=this;this.E.bK.a(function(n){n.a(i.L);i.E.N()})}else this.E.N()},T:function(n){this.L.i(n);this.E.N()},bT:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.L).f.apply(r,[t,n].concat(u));this.E.N()},P:function(){this.L.J();this.L.e(_mcp.z.a);this.L.e(_mcp.o.b);this.L.e(_mcp.k.b);var n=this;this.E.bK.a(function(t){t.b(n.L);n.E.N()})},U:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.bc=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.f=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bb(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y);this.a=n};_mcp.bc.prototype={c:null,a:null,e:null,b:function(n){var t=n;$a(this.c[t])&&(this.c[t]=this.e.p(n,this.a.V.a()));return this.c[t]},n:function(){this.d(this.g)},k:function(){_js.Trace.logInfo(_a.a.a,"Component Map Reset start.");this.d(this.h,!0);_js.Trace.logInfo(_a.a.a,"Component Map Reset end.")},r:function(){_js.Trace.logInfo(_a.a.a,"Component Map set override start.");this.d(this.i);_js.Trace.logInfo(_a.a.a,"Component Map set override end.")},m:function(){_js.Trace.logInfo(_a.a.a,"Component Map clear override start.");this.d(this.f);_js.Trace.logInfo(_a.a.a,"Component Map clear override end.")},d:function(n,t){if($a(t)||!t)for(var r=0;r<this.c.length;r++)this.j(n,r);else for(var i=this.c.length-1;i>=0;i--)this.j(n,i)},j:function(n,t){var i=this.c[t];$a(i)||n(i,t)},o:function(n,t){_mcp.I.isInstanceOfType(n)||n.I()||n.C()},p:function(n,t){var i=Object.getType(n).getName();if(n.I()){_js.Trace.logInfo(_a.a.a,"Reset {0} at index {1}",i,t);n.H()}else _js.Trace.logInfo(_a.a.a,"Skip uninitialized {0} at index {1}",i,t)},q:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.K()},l:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.J()}};_mcp.bd=function(n,t){this.h=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);this.g=Function.createDelegate(this,this.l);_mcp.bd.initializeBase(this,[15,n]);this.e=t};_mcp.bd.prototype={c:null,d:null,e:null,a:function(){return this.c},b:function(){return this.d},C:function(){this.d||(this.d=new _C(this.g,this.G()));this.c||(this.c=new _C(this.f,this.G()));_mcp.P.prototype.C.call(this)},l:function(){_js.Trace.logInfo(this.G(),"User chose to convert to plain text");this.D.a.P().a("SwitchToPlain");if(this.j(_nbs.a.Nw)){this.D.a.L.bT().a();var r=this.D.a.L.M();var n;var i,t;var f=(t=_a.v.g(r,i={val:n}),n=i.val,t);if(!f){n=r;_js.Trace.logInfo(this.G(),"Using html due to failed conversion")}if(n.length>0){var u=this.D.a.T;u.b(1,[_nbs.a.UQ],this.h,!1,null,null,null,this.e,null)}else this.i()}},m:function(n,t){n&&this.i()},i:function(){this.D.a.be().I()&&this.D.a.be().w();var n=this.D.b(5);n.i(!1);n.h(!1);n.a()&&n.a().bM();this.D.a.L.o("Text");_js.Trace.logInfo(this.G(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},k:function(){_js.Trace.logInfo(this.G(),"User chose to convert to html");this.D.a.P().a("SwitchToHTML");if(this.j(_nbs.a.PI)){var i=this.D;var t=i.a;var r=t.L;r.o("HTML");t.be().y();var n=this.D.b(5);n.i(!0);n.h(!0);_js.Trace.logInfo(this.G(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},j:function(n){_js.Trace.logInfo(this.G(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.D.a.L.g()){this.D.a.T.a(0,n,null);_js.Trace.logInfo(this.G(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.D.a.L.Q()){this.D.a.T.a(0,n,null);_js.Trace.logInfo(this.G(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.D.b(5);if(t.a()&&t.a().z()){this.D.a.T.a(0,_nbs.a.YB,null);_js.Trace.logInfo(this.G(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.v=function(n,t,i){_mcp.v.initializeBase(this,[16,n]);this.K=_g.a.a().a();this.a=this.D.a.L;this.f=t;this.t=i};_mcp.v.prototype={s:null,r:null,K:null,n:null,e:null,j:null,h:null,k:null,i:null,p:null,o:null,v:null,m:null,l:null,q:null,a:null,f:null,t:null,b:function(){return this.dS(_mcp.v.a)},W:function(n){this.dR(_mcp.v.a,n);return n},N:function(){return this.g()&&!!this.l&&!!this.m},Q:function(){return this.g()&&!!this.j&&!!this.h},R:function(){return this.g()&&!!this.k&&!!this.i},O:function(){return this.g()&&!!this.p&&!!this.o},g:function(){return this.t.a().f().Enabled&&this.f.a()==="Mouse"},z:function(){if(!this.q){var n=this.D.a.bi();var t=this;this.q=new _fm.m(_nbs.a.jE,function(t){t(n.a())},1,null,!1,!1,null,!1)}return this.q},w:function(){this.A(!1)},y:function(){this.A(!0)},C:function(){if("Mouse"===_y.c.a.a()){var t=[];var n;if(this.a.a()!==8&&!this.a.l()&&!_y.c.a.h()){n=new _fm.d(_nbs.a.Dg,null,this.E.d().d());Array.add(t,n)}var i=this.D.b(1);if(!this.a.l()){n=new _fm.d(_nbs.a.JS,null,i.r);_g.a.a().a().bl.AlwaysShowBcc&&n.c(!0);Array.add(t,n);n=new _fm.d(_nbs.a.Pc,null,i.v);_g.a.a().a().bl.AlwaysShowBcc||n.c(!0);Array.add(t,n)}if(this.a.S()||this.a.r()){var l=this.D.b(1);n=new _fm.d(_nbs.a.jK,null,i.m);(_g.a.a().a().bl.AlwaysShowFrom||this.a.i())&&n.c(!0);Array.add(t,n);i.m.c(!this.a.r());n=new _fm.d(_nbs.a.Mx,null,i.w);_g.a.a().a().bl.AlwaysShowFrom||this.a.i()||n.c(!0);Array.add(t,n)}if(!this.a.l()&&!_y.c.a.h()){n=new _fm.d(_nbs.a.dG,null,i.y);Array.add(t,n)}var h=this.D.b(30);h.b(t);var f=this.D.a.bX();if(!$a(f.a())){n=new _fm.k(_nbs.a.dd,null,f.a());Array.add(t,n)}var r=this.D.a.bi();if(r.a()){n=new _fm.k(_nbs.a.jE,null,r.a());Array.add(t,n)}else if(r.b()&&this.D.a.bb.IsLoadingFromServer){n=new _fm.d(_u.P.j,null,null);Array.add(t,n)}if(!_y.c.a.h()){var c=this.D.b(11);var s=this.D.b(5);n=new _fm.d(_nbs.a.Mr,null,c.a());n.bd(_nbs.a.Bp);s.d().h.a(n)}var u=this.D.b(15);this.s=new _fm.d(_nbs.a.YZ,null,u.b());Array.add(t,this.s);this.r=new _fm.d(_nbs.a.aR,null,u.a(),!0);Array.add(t,this.r);this.a.d()==="HTML"?this.y():this.w();if(!this.a.l()&&!this.f.c()){var e=this.D.b(9);n=new _fm.d(_nbs.a.Ms,null,e.b());Array.add(t,n)}var o=this.D.b(16);o.W(new _fm.f(t));this.E.bg()&&this.X();this.g()&&this.S()}_mcp.P.prototype.C.call(this)},Z:function(){var t=this.b().h.w[this.d(_nbs.a.JS)];var n=this.b().h.w[this.d(_nbs.a.Pc)];t.c(this.a.s());n.c(!this.a.s());if(this.Q()){this.j.a(!this.a.s());this.h.a(this.a.s())}},J:function(){var t=this.b().h.w[this.d(_nbs.a.jK)];var n=this.b().h.w[this.d(_nbs.a.Mx)];t.c(this.a.i());n.c(!this.a.i());if(this.R()){this.k.a(!this.a.i());this.i.a(this.a.i())}},B:function(n,t){if(this.O()){this.p.a(!t&&n);this.o.a(t&&n)}},d:function(n){var i=this.b().h;if(i)for(var t=0;t<i.w.length;t++)if(n===i.w[t].j)return t;return-1},M:function(){var t=this.D.a.bi();if(!$a(t.a())){var n=this.d(_nbs.a.dd);if(n>=0){var i=new _fm.k(_nbs.a.jE,null,t.a());this.b().h.r(n+1,i)}this.n&&this.n(this.v,this.z())}},S:function(){this.e=new _ff.e;this.a.a()===8||this.a.l()||_y.c.a.h()||this.c(this.E.d().d(),_nbs.a.Dg,null);var n=this.D.b(1);if(!this.a.l()){this.j=this.c(n.r,_nbs.a.JS,null);this.h=this.c(n.v,_nbs.a.Pc,null);this.j.a(!_g.a.a().a().bl.AlwaysShowBcc);this.h.a(_g.a.a().a().bl.AlwaysShowBcc)}if(this.a.S()||this.a.r()){this.k=this.c(n.m,_nbs.a.jK,null);this.i=this.c(n.w,_nbs.a.Mx,null);(_g.a.a().a().bl.AlwaysShowFrom||this.a.i())&&this.k.a(!1);n.m.c(!this.a.r());_g.a.a().a().bl.AlwaysShowFrom||this.a.i()||this.i.a(!1)}this.a.l()||_y.c.a.h()||this.c(n.y,_nbs.a.dG,null);if(!_y.c.a.h()){var t=this.D.b(30);this.p=this.c(t.d(),_nbs.a.Iq,null);this.o=this.c(t.c(),_nbs.a.OQ,null);this.B(t.a(),this.a.bn())}var u=this.D.a.bX();if(!$a(u.a())){var o=this;var e=new _fm.m(_nbs.a.dd,function(n){n(u.a())},1,null,!1,!1,null,!1);this.e.c(e)}if(!this.a.l()){var i=this.D.a.bi();i.a()?this.e.c(this.z()):i.b()&&this.D.a.bb.IsLoadingFromServer&&(this.v=this.c(null,_u.P.j,null))}var r=this.D.b(15);this.m=this.c(r.b(),_nbs.a.YZ,null);this.l=this.c(r.a(),_nbs.a.aR,null);this.a.d()==="HTML"?this.y():this.w();if(!this.a.l()&&!this.f.c()){var f=this.D.b(9);this.c(f.b(),_nbs.a.Ms,null)}},c:function(n,t,i){var r=new _fm.i(n,t,i,1,null,null,!1,!1);this.e.c(r);return r},A:function(n){this.r.c(n);this.s.c(!n);if(this.N()){this.l.a(!n);this.m.a(n)}},X:function(){this.u(_nbs.a.JS);this.u(_nbs.a.Pc);this.u(_nbs.a.Ms)},u:function(n){var t=this.d(n);this.b()&&t!==-1&&this.b().h.w[t].c(!0)}};_mcp.w=function(n,t,i){_mcp.w.initializeBase(this,[28,n]);this.g=_g.a.a().a();this.a=this.D.a.L;this.d=t;this.e=i};_mcp.w.prototype={d:null,e:null,g:null,a:null,b:function(){return this.dS(_mcp.w.a)},i:function(n){this.dR(_mcp.w.a,n);return n},h:function(){return!this.d.a()},C:function(){if("TouchNarrow"===_y.c.a.a()){var t=[];var n;if(this.d.a()){var l=this.D.b(5);var r=l.g();if(r)if(r.d.length>1){n=new _fm.k(_nbs.a.bj,null,new _fm.f(r.d));Array.add(t,n)}else if(r.d.length===1){var c=r.d[0].i;n=new _fm.d(_nbs.a.bj,null,c);Array.add(t,n)}}var h=this.D.b(22);n=new _fm.d(_u.P.e,null,h.h);Array.add(t,n);var i=this.D.b(1);if(!this.a.l()){n=new _fm.d(_nbs.a.JS,null,i.r);_g.a.a().a().bl.AlwaysShowBcc&&n.c(!0);Array.add(t,n);n=new _fm.d(_nbs.a.Pc,null,i.v);_g.a.a().a().bl.AlwaysShowBcc||n.c(!0);Array.add(t,n)}if(this.a.S()||this.a.r()){var a=this.D.b(1);n=new _fm.d(_nbs.a.jK,null,i.m);(_g.a.a().a().bl.AlwaysShowFrom||this.a.i())&&n.c(!0);Array.add(t,n);i.m.c(!this.a.r());n=new _fm.d(_nbs.a.Mx,null,i.w);_g.a.a().a().bl.AlwaysShowFrom||this.a.i()||n.c(!0);Array.add(t,n)}var s=this.D.b(30);s.b(t);var f=this.D.a.bX();if(f.a()){n=new _fm.k(_nbs.a.dd,null,f.a());Array.add(t,n)}var u=this.D.a.bi();if(u.a()){n=new _fm.k(_nbs.a.jE,null,u.a());Array.add(t,n)}else if(u.b()&&this.D.a.bb.IsLoadingFromServer){n=new _fm.d(_u.P.j,null,null);Array.add(t,n)}if(!this.a.l()&&!this.e.c()){var o=this.D.b(9);n=new _fm.d(_nbs.a.Ms,null,o.b());Array.add(t,n)}var e=this.D.b(28);e.i(new _fm.f(t))}_mcp.P.prototype.C.call(this)},j:function(){var t=this.b().h.w[this.c(_nbs.a.JS)];var n=this.b().h.w[this.c(_nbs.a.Pc)];t.c(this.a.s());n.c(!this.a.s())},f:function(){var t=this.b().h.w[this.c(_nbs.a.jK)];var n=this.b().h.w[this.c(_nbs.a.Mx)];t.c(this.a.i());n.c(!this.a.i())},c:function(n){var i=this.b().h;if(i)for(var t=0;t<i.w.length;t++)if(n===i.w[t].j)return t;return-1}};_mcp.x=function(n){this.s=Function.createDelegate(this,this.B);this.u=Function.createDelegate(this,this.p);this.t=Function.createDelegate(this,this.z);this.r=Function.createDelegate(this,this.y);this.v=Function.createDelegate(this,this.Q);this.w=Function.createDelegate(this,this.R);_mcp.x.initializeBase(this,[19,n]);this.o=new _C(this.w,this.G());this.n=new _C(this.v,this.G());this.k=n.a.bt};_mcp.x.prototype={o:null,n:null,k:null,j:null,i:null,m:!1,l:!1,a:function(){return this.o},e:function(){return this.n},f:function(){return this.j},K:function(n){if(n!==this.j){this.j=n;this.bt("DiscardConfirmDialogButtonData")}return n},J:function(n){if(n!==this.i){this.i=n;this.bt("CloseConfirmDialogButtonData")}return n},g:function(){return this.m},h:function(n){if(n!==this.m){this.m=n;this.bt("IsDiscardConfirmDialogShown")}return n},q:function(n){if(n!==this.l){this.l=n;this.bt("IsCloseConfirmDialogShown")}return n},d:function(){var i=this.D;var t=i.a;var n=t.L;t.P().a("Discard");if(n.a()||!n.a()&&(n.h()||t.d().a())){_js.Trace.logInfo(_a.a.a,"Discard");this.A(n.b(),n.h())}},b:function(n,t){if(this.k.a(n)){_js.Trace.logInfo(_a.a.a,"Resuming discard of {0}",_h.bj.a(t));this.A(n,t)}else _js.Trace.logInfo(_a.a.a,"User had already discarded.")},c:function(){if(!this.F.ee)return!0;_js.Trace.logInfo(_a.a.a,"Comparing initial baseline to baseline. Context:{0}",this.F);if(!this.F.ee.q(this.F.ed()))return!0;_js.Trace.logInfo(_a.a.a,"Checking dirty before showing discard confirmation.");return this.E.bw()?!0:this.F.bU()?!0:!1},O:function(){_js.Trace.logInfo(_a.a.a,"Comparing initial baseline to baseline. Context:{0}",this.F);if(!this.F.ee.q(this.F.ed()))return!0;_js.Trace.logInfo(_a.a.a,"Checking dirty before showing discard confirmation.");return this.E.bw()?!0:!1},A:function(n,t){this.z();var i=this.D.a;var r=i.L.bX()||i.L.bU();this.k.b(n,t,i.U,r)},R:function(){var t=this.D.a;var n=t.L;_js.Trace.logInfo(_a.a.a,"User chose to discard");if(this.c()){this.N();_js.Trace.logInfo(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:{0}",n);this.h(!0)}else{_js.Trace.logInfo(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:{0}",n);this.y()}},Q:function(){var t=this.D.a;var n=t.L;_js.Trace.logInfo(_a.a.a,"User chose to close");if(this.O()){this.M();_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog. Context:{0}",n);this.q(!0)}else{_js.Trace.logInfo(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away. Context:{0}",n);this.p()}},z:function(){_js.Trace.logInfo(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:{0}",this.D.a.L);this.h(!1)},B:function(){_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog. Context:{0}",this.D.a.L);this.q(!1)},N:function(){if($a(this.j)){_js.Trace.logInfo(_a.a.a,"Creating discard confirm dialog.");var n=new _js.f;n.a(new _ff.f(new _C(this.r,this.G()),_u.R.Hw,_u.R.TZ));n.a(new _ff.f(new _C(this.t,this.G()),_u.R.Pm,_u.R.IS));this.K(n)}},M:function(){if($a(this.i)){_js.Trace.logInfo(_a.a.a,"Creating close confirm dialog.");var n=new _js.f;n.a(new _ff.f(new _C(this.u,this.G()),_u.R.aw,_u.R.aa));n.a(new _ff.f(new _C(this.s,this.G()),_u.R.JY,_u.R.IS));this.J(n)}},y:function(){_js.Trace.logInfo(_a.a.a,"Discard and close");this.d();this.p()},p:function(){this.F.eA(null);this.E.b().b(this.E,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from compose")}};_mcp.be=function(n,t){this.h=Function.createDelegate(this,this.d);this.f=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.m);_mcp.be.initializeBase(this,[25,n]);this.e=t;this.j=new _C(this.k,_a.a.a);var i=n.a.L;i.dg(this.j)};_mcp.be.prototype={j:null,e:null,g:!1,i:null,b:function(){return this.i},a:function(n){this.i=n;this.bt("EditorCallContext");return n},d:function(){this.a(new _cmc.C)},C:function(){if(!this.g){this.o();this.g=!0;_g.a.a().b().E(this.f);_g.a.a().b().S(this.f)}_mcp.P.prototype.C.call(this)},H:function(){this.p();this.g=!1;_g.a.a().b().K(this.f);_g.a.a().b().W(this.f);_js.Trace.logInfo(_a.a.a,"Editor component reset.");_mcp.P.prototype.H.call(this)},c:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().cj();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_js.d.b(t)?"<P><BR></P>":_a.v.e+t+_a.v.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_js.d.b(t)?"\r\n":t;return i},m:function(){this.a(new _cmc.c(!1))},n:function(n,t){this.d()},o:function(){if(this.e)try{var n=this.e;if(!n.closed){var r=_js.m.b(n);var i=this;r.c("resize",function(n){i.d()},"MCEditorComponent")}}catch(u){var t=this.l(this.e);_js.Trace.logException(this.G(),u,"Projection window dump: {0}",t)}else _y.c.a.o(this.h)},p:function(){if(this.e){var n=_js.m.b(this.e);n.e("resize","MCEditorComponent")}else _y.c.a.q(this.h)},l:function(n){var t="";for(var i in n)t=t+i+",";return t}};_mcp.bf=function(n){_mcp.bf.initializeBase(this,[n,null])};_mcp.bf.prototype={d:function(){}};_mcp.H=function(n,t){this.l=Function.createDelegate(this,this.s);this.m=Function.createDelegate(this,this.t);this.k=Function.createDelegate(this,this.r);_mcp.H.initializeBase(this,[6,n]);this.h=t};_mcp.H.a=function(n,t){return new _y.g(n,t)};_mcp.H.b=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.H.prototype={e:null,d:null,i:!1,f:!1,j:!1,h:null,a:function(){return this.e},b:function(){return this.d},o:function(n){if(n!==this.i){this.i=n;this.bt("IsHighImportance")}return n},c:function(){return this.f},q:function(n){if(n!==this.f){this.f=n;this.bt("IsNormalImportance")}return n},p:function(n){if(n!==this.j){this.j=n;this.bt("IsLowImportance")}return n},C:function(){var i=this.D.a.L.bb();this.g(i);_js.Trace.logInfo(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||this.h.b()){if(!this.e){var t=this.n(_mcp.H.b);t&&(this.e=new _fm.f(t))}}else if(!this.d){var n=this.n(_mcp.H.a);n&&(this.d=new _y.g(_nbs.a.dd,null,n))}_mcp.P.prototype.C.call(this)},r:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_js.Trace.logInfo(_a.a.a,"User sets high importance");this.g("High");this.D.a.P().a("Importance:High");_a.d.a(n)},t:function(){_js.Trace.logInfo(_a.a.a,"User sets normal importance");this.g("Normal");this.D.a.P().a("Importance:Normal")},s:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_js.Trace.logInfo(_a.a.a,"User sets low importance");this.g("Low");this.D.a.P().a("Importance:Low");_a.d.a(n)},g:function(n){this.D.a.L.dj(n);this.o("High"===n);this.q("Normal"===n);this.p("Low"===n)},n:function(n){return[n(_nbs.a.Ve,new _C(this.k,this.G())),n(_nbs.a.Lr,new _C(this.m,this.G())),n(_nbs.a.Yr,new _C(this.l,this.G()))]}};_mcp.bh=function(n,t,i){this.Z=Function.createDelegate(this,this.bV);this.v=Function.createDelegate(this,this.bW);this.bi=Function.createDelegate(this,this.bR);this.bm=Function.createDelegate(this,this.ck);this.bh=Function.createDelegate(this,this.bH);this.w=Function.createDelegate(this,this.bx);this.O=Function.createDelegate(this,this.bC);this.R=Function.createDelegate(this,this.bE);this.Q=Function.createDelegate(this,this.bD);this.S=Function.createDelegate(this,this.bF);this.W=Function.createDelegate(this,this.bG);this.X=Function.createDelegate(this,this.bJ);this.bf=Function.createDelegate(this,this.bp);this.bj=Function.createDelegate(this,this.ce);this.bg=Function.createDelegate(this,this.bB);this.bk=Function.createDelegate(this,this.cg);this.bl=Function.createDelegate(this,this.ch);_mcp.bh.initializeBase(this,[24,n]);this.k=_h.w.c(t);this.be=i;this.n=_a.UserAgent.getInstance();this.z=t};_mcp.bh.prototype={m:null,A:null,k:!1,M:!1,K:!1,N:null,J:null,y:null,u:null,s:null,B:null,be:null,j:null,o:null,q:null,r:null,n:null,p:null,z:null,t:null,bY:function(n){if(n!==this.k){this.k=n;this.bt("IsLinkPreviewEnabled")}return n},bX:function(n){if(n!==this.m){this.m=n;this.ci()}return n},bI:function(){this.B||(this.B={});return this.B},bZ:function(n){this.A=n;this.bt("LinkPreviewResponse");this.A&&this.j&&this.bn(this.A,this.j.bq());return n},cc:function(n){if(n!==this.u){this.u=n;this.u&&_h.w.a(this.u,null,this.bl,null,null)}return n},ca:function(n){if(n!==this.s){this.s=n;this.s&&_h.w.a(this.s,null,this.bk,null,null)}return n},d:function(){return this.M},g:function(n){if(this.M!==n){this.M=n;this.bt("ShowYouTubePlayer")}return n},c:function(){return this.K},f:function(n){if(this.K!==n){this.K=n;this.bt("ShowOEmbedVideoPlayer")}return n},e:function(){return this.N},cd:function(n){this.N=n;this.bt("YouTubePlayerUrl");return n},b:function(){return this.J},bv:function(n){this.J=n;this.bt("OEmbedVideoPlayerHtml");return n},a:function(){this.y||(this.y=new _C(this.bg,_a.a.e));return this.y},ci:function(){if(_h.w.b){_js.Trace.logInfo(_a.a.e,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.m.Url);this.bp();return}if(this.m){var i=1;var r=_a.d.b(_a.a.e,"GetComposeLinkPreview");var n=[];Array.add(n,this.m);_js.Trace.logInfo(_a.a.e,"Preparing GetLinkPreview action for {0}",this.m.Url);this.m.Autoplay=!0;var u=new _h.w(this.m);_js.Trace.logInfo(_a.a.e,"Submitting GetLinkPreview action for {0}",this.m.Url);var t=this,f=this;this.D.a.U.a(u,function(u){_h.w.j(u,t.bj,t.bf,i,r,"GetComposeLinkPreview",n)},function(t){_h.w.g(t,i,r,"GetComposeLinkPreview",n)},null)}},ce:function(n){this.bZ(n)},bp:function(){this.bY(!1);this.j&&(this.j.cP=!1)},ch:function(n){this.cd(n);this.g(!!this.N)},cg:function(n){var t=this.o.b(n);t?this.bv(t):this.bv(n);this.f(!!this.J)},bB:function(){this.f(!1)},h:function(n){n.h(this.X);n.d(this.W);n.c(this.S);n.f(this.Q);n.g(this.R);n.e(this.O)},i:function(n){n.n(this.X);n.j(this.W);n.i(this.S);n.l(this.Q);n.m(this.R);n.k(this.O)},bM:function(n){if(!this.k){_js.Trace.logInfo(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var r="a[id^='"+t+"']";var i=$(n);return _b.k.a(n.id,t)||i.find(r).length>0},bK:function(n){if(!this.k){_js.Trace.logInfo(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var r=$(n);var i="a[id^='LPlnk']";t=_b.k.a(n.id,"LPlnk")||r.find(i).length>0;!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.k.a(n.parentNode.id,"LPlnk"));return t},bJ:function(n){var t=n.c();var i=n.d();if(_zz.f.isInstanceOfType(i))this.j=i;else{_js.Trace.logError(_a.a.e,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}if(t&&this.k){if(this.bM(t)||this.bK(t))return;if(t.href.toLowerCase().startsWith("http")){t.id=_b.k.d();_js.Trace.logInfo(_a.a.e,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.cj(t.id,t.href)}}},bD:function(n){var t=n.d();if(_zz.f.isInstanceOfType(t))this.j=t;else{_js.Trace.logError(_a.a.e,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.ba(n.c())},bE:function(n){this.bz(n.c())},bC:function(n){this.ba(n.c())},bG:function(n){var t=n.c();this.bA(t)},bF:function(n){var t=n.c();this.ba(t)},cj:function(n,t){if(!this.k){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview requests because previews are disabled");return}_js.Trace.logInfo(_a.a.e,"RTE: Trigger link preview request for {0}",t);var i=new _g.fC;i.Id=n;i.Url=t;i.RequestStartTimeMilliseconds=_a.c.a().h();this.bx(i)},bn:function(n,t){_js.Trace.logInfo(_a.a.e,"Adding link preview for {0}",n.Url);var i=!1;_h.w.d(n)&&(i=!0);if(!this.l()){this.q=n;this.r=t;this.o&&this.bs();return}if(i){this.l().g(this.w);return}if(this.j&&this.j.P()&&this.j.w){this.j.cn();this.l().c(n,this.w,t,this.bh);this.j.gm()}else _js.Trace.logInfo(_a.a.e,"Ignore AddLinkPreview since the editor isn't active or initialized")},l:function(){if(!this.o){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: Create LinkPreviewBuilder");var t=!0;var n=this;this.be.a(function(i){n.o=i.a(n.bm,n.bi,t,_y.c.a,n.z);n.o.a(n.bI());n.bs()})}return this.o},ck:function(n){this.cc(new _a.bZ(new _a.bj(n)))},bR:function(n){this.ca(new _a.bZ(new _a.bj(n)))},bs:function(){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: LinkPreviewBuilderFactoryOnOnCreated");if(this.q&&this.r){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: There was a deferred AddLinkPreview. Calling it now");this.bn(this.q,this.r);this.q=null;this.r=null}if(this.p){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.br(this.p);this.p=null}},br:function(n){this.p=n;var s=!1;if(this.l())this.p=null;else return;for(var u=0;u<n.length;u++){var r=n[u];if(_b.k.a(r.id,"LPUrlAnchor")){var t;var o,e;if(e=this.l().m(r,o={val:t}),t=o.val,e){var h=this.t+"[id^='LPRemovePreview']";var c=$(t).find(h);if(c.length>0){_js.Trace.logInfo(_a.a.e,"Remove preview button already added. Skipping preview initialization.");return}this.bb(t);var i=!1;var f;this.l().i(t,f={val:i}),i=f.val;if(i){this.l().h(r);s=!0}this.bo(t)}}}s&&this.l().g(this.w)},bx:function(n){this.bX(n)},bH:function(n){this.bo(n);var t=n;if(this.n.b()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.bb(t);return t},bo:function(n){this.z.a().S().Enabled?this.bQ(n):this.bS(n)},bS:function(n){var t=window.document.createElement("div");t.id="LPRemovePreview";this.t=t.tagName;t.setAttribute("unselectable","on");var i=$(t);i.css("-moz-user-select","none");i.css("-khtml-user-select","none");i.css("-webkit-user-select","none");i.css("-ms-user-select","none");t.style.textAlign="right";i.text(_nbs.a.Vr);t.style.width=n.children[0].style.width;t.style.fontSize="13px";t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.color="#000000";t.style.cursor="pointer";i.one("click",this.v);n.appendChild(t)},bQ:function(n){var t=window.document.createElement("a");t.id="LPRemovePreview";this.t=t.tagName;t.style.fontSize="12px";t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.color="#333333";t.style.fontWeight="normal";t.style.position="relative";t.style.cssText+="float: right";var i=$(t);t.style.cursor="pointer";i.one("click",this.v);i.text(_nbs.a.Vr);i.css("-moz-user-select","none");i.css("-khtml-user-select","none");i.css("-webkit-user-select","none");i.css("-ms-user-select","none");var f=$(n);var r=f.find("td[id^='LPRemovePreviewContainer']");if(r.length>0){var u=r.get(0);u.appendChild(t)}},bb:function(n){_js.Trace.logInfo(_a.a.e,"InitializePreviewForEditor: InitializePreviewForEditor.");if(this.n&&(this.n.f()||this.n.b()||this.n.j()||this.n.a())){n.setAttribute("contenteditable",!1);var t=$(n);t.bind("click",this.Z)}},bq:function(n){for(var r=[],i=n.getElementsByTagName(this.t),t=0;t<i.length;t++)i[t].id==="LPRemovePreview"&&Array.add(r,i[t]);return r},bW:function(n){var t=_a.d.b(_a.a.e,"RemoveLinkPreviewClickEvent");if(!this.j){_js.Trace.logError(_a.a.e,"RemovePreviewClicked: editor was null");return}this.j.cr(n);var r=n.target;var i=_b.k.b(r);var u=this.j.cy();if(i){this.j.mw(i);_a.d.a(t)}else if(t){t.k="Either cursor was invalid or Preview DOM was null";_a.d.a(t)}},bA:function(n){if(!this.k){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var r=this.bq(n),u=0;u<r.length;u++){var f=r[u];var t=_b.k.b(f);if(t){t.removeAttribute("contenteditable");var i=$(t);i.unbind("click",this.Z);$(f).remove();this.l().k(i);this.l().j(i)}}return r.length>0},ba:function(n){if(!this.k){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is text node");return}var t=n.getElementsByTagName("A");this.br(t)},bz:function(n){if(!this.k){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var u=this.bq(n),t=0;t<u.length;t++){var r=u[t];var i=_b.k.b(r);if(i){this.bb(i);var f=$(r);f.one("click",this.v)}}},bV:function(n){if(!this.j){_js.Trace.logError(_a.a.e,"PreviewClicked: editor was null");return}if(this.j.cy()){var i=n.target.parentNode;var t=_b.k.b(i);if(t){this.j.nc(t);this.D.a.S.a(_a.bE,new _a.bE(_nbs.a.Bi+t.innerText.replace(_nbs.a.Vr,"")))}}}};_mcp.G=function(n){_mcp.G.initializeBase(this,[14,n])};_mcp.G.prototype={b:null,c:0,a:null,C:function(){_mcp.P.prototype.C.call(this);this.a=this.h();var n=this.D.a;this.b=n.bc();this.c=n.L.a();_mcp.e.g(n.L)&&!n.L.by()&&this.l()},l:function(){this.b.e(_mcp.G.a);this.d()},h:function(){var n=this.D.a.L;var t=n.e()||n.ba();return t&&n.bm()?t:null},k:function(){if(_g.i.isInstanceOfType(this.a))return this.a.t();else if(_g.bj.isInstanceOfType(this.a)){var n=this.a;return n.u().t()==="RecurringMaster"?n.H()?"RecurringMaster":"Occurrence":n.u().t()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},d:function(){if(this.a){this.f();if(!_g.bB.isInstanceOfType(this.a)){this.b.a(6800);switch(this.k()){case"Occurrence":case"Exception":this.g();break;case"RecurringMaster":this.e();break}}}},i:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:t=3210;break;case 6:t=3215;break;case 7:t=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},j:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:t=3110;break;case 6:t=3115;break;case 7:t=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},e:function(){var n=this.j(this.c);this.b.a(n)},g:function(){var i=new _cc.bd;var t=i.a(this.a,null);var n=this.i(this.c);this.b.a(n,t)},f:function(){if(_g.H.isInstanceOfType(this.a)){var t=this.a;var i=t.dG()&&!!t.bl.ReceivedRepresenting;if(i){var n=-1;switch(this.c){case 5:n=3250;break;case 7:n=3260;break;case 6:n=3255;break}n!==-1&&this.b.a(n,t.bl.ReceivedRepresenting.Mailbox.Name)}}}};_mcp.I=function(n,t,i){this.k=Function.createDelegate(this,this.bg);this.l=Function.createDelegate(this,this.bi);this.A=Function.createDelegate(this,this.bq);this.v=Function.createDelegate(this,this.h);this.y=Function.createDelegate(this,this.Q);this.w=Function.createDelegate(this,this.bh);this.J=Function.createDelegate(this,this.bs);this.B=Function.createDelegate(this,this.br);this.d=Function.createDelegate(this,this.bk);this.z=Function.createDelegate(this,this.bn);this.m=Function.createDelegate(this,this.bl);this.n=Function.createDelegate(this,this.bo);_mcp.I.initializeBase(this,[0,n]);this.b=n.a.bt;this.f=t;this.u(!0);this.r=i};_mcp.I.prototype={b:null,c:!1,e:!1,j:!1,q:null,t:null,i:null,f:null,r:!1,a:null,I:function(){return _mcp.P.prototype.I.call(this)},bd:function(n){if(n!==_mcp.P.prototype.I.call(this)){_mcp.P.prototype.bd.call(this,n);this.bt("IsInitialized")}this.D.a.L.dw(n);return n},Z:function(n){if(n!==this.c){this.c=n;this.bt("IsSecondInitializationComplete")}return n},u:function(n){if(this.e!==n){this.e=n;this.bt("CanLoadPopoutSuccessfully")}return n},ba:function(){if(this.a){this.a.a();this.a=null}},C:function(){this.q=_js.e.s(_a.a.a,517,"VM.MailCompose.FirstInit");var i=this.D.a;var n=i.L;n.apcl("IsEditorInitialized",this.n);n.apcl("IsUpgraded",this.m);if(!n.ee&&!n.h()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline, context: {0}",n);n.ee=_mcp.b.b(n);n.en()||n.eq(!0)}if(n.eP()){_js.Trace.logInfo(_a.a.a,"Finish 1st init for complete context");this.g();_js.Trace.logInfo(_a.a.a,"Check begin upgrade for complete context");this.p()}else{var e=i.U;var r=n.h();var t=n.bf();var o=n.fQ();if(!r&&o){var u;var f=_g.a.a().c();u=_js.d.a(f.bl.SharePointUrl)?f.bl.UserEmailAddress||"":f.bl.LogonEmailAddress||"";var v=new _g.ex("StoreId",o,u);var a=new _c.R([v],"EwsId");var p=this;e.a(a,this.z,function(n){p.bm(n)},this.d);_js.Trace.logInfo(_a.a.a,"Calling server to convert id, storeId={0}",o)}else if(r)if(n.cd()&&n.en()){_js.Trace.logInfo(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.X()}else{_js.Trace.logInfo(_a.a.a,"Load draft {0}",_h.bj.a(r));this.s(r)}else if((4===n.a()||13===n.a())&&n.en()){_js.Trace.logInfo(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.X()}else if(t){i.M.b(3400);i.M.a(3400,null);if(n.eR()){var y=_cc.L.a(t,n.bY());var h=new _cc.L(200,y);h.I=n.b();var l=this;e.a(h,this.B,function(n){l.W(n)},this.d);_js.Trace.logInfo(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var s=i.bu.e(t);s.I=n.b();var c=this;e.a(s,this.J,function(n){c.W(n)},this.d);_js.Trace.logInfo(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cm(!0);n.er(!0);_js.Trace.logInfo(_a.a.a,"Finish 1st init for new mail");this.g()}else{this.h("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.l.b(_y.M,n.a())));}}_js.d.a(_g.a.a().c().bl.SharePointUrl)||i.M.a(110,null)},H:function(){var t=this.D.a;var n=t.L;n.rpcl("IsEditorInitialized",this.n);n.rpcl("IsUpgraded",this.m);this.bd(!1);this.Z(!1);this.u(!0);this.j=!1;this.ba()},K:function(){this.be();this.t=_js.e.s(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.D;var n=i.a;var r=n.L;_js.Trace.logInfo(_a.a.a,"Queue 2nd init task, context:{0}",r);_js.g.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.w);if(n.fy()&&!n.dl.a){var f=i.b(10);_js.Trace.logInfo(_a.a.a,"Queue appbar setup task");var t=f;_js.g.a().c(_a.a.a,"SetupApplicationBarMenu",t.c||(t.c=Function.createDelegate(t,t.h)))}if(r.bu()){_js.Trace.logInfo(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var o=this;_js.g.a().c(_a.a.a,"Diagnostics save:",function(){n.d().b("Diagnostics",null,null,!1)})}if(_a.cB.a){var u=i.b(17);_js.Trace.logInfo(_a.a.a,"Queue GetMailTips if needed task");var e=this;_js.g.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){u.a(32)})}},bq:function(n){var f=_js.e.s(_a.a.a,2,"VM.MailCompose.ProcessDraft");var o=this.D.a.L;var e=this.E.bh();var i=n;var t=n.I;_js.Trace.logInfo(_a.a.a,"Got draft, checking pending discards for {0}",t);if(this.b.a(t))e.b(t,i.c[0]);else if(t===this.F.b()){var r=i.a;if(_g.bM.isInstanceOfType(r)){this.F.cR(r);this.o(!0);this.S(i)}else _a.j.a&&r.bA()?this.bj(r,i):this.Q(r,i);if(_a.bm.a){var u=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){var n=u.D.b(23);n.a(32)})}}else _js.Trace.logInfo(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",t,this.F);_js.e.e(f);_js.e.e(this.i)},bj:function(n,t){var i=this;this.E.ct(function(){i.bb();i.a.c(n,t)})},bb:function(){if(!this.a){_js.Trace.logInfo(_a.a.a,"Setting initializer component override");this.a=this.E.bG().b();var n=this.D.b(27);this.a.b(this.y,n.a,this.v,this.E.U)}},Q:function(n,t){this.F.cQ(n);this.o(!1);this.S(t)},S:function(n){if(this.F.en()&&this.F.cP()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline for a loaded draft.");this.F.ee=_mcp.b.b(this.F)}_js.Trace.logInfo(_a.a.a,"Finish 1st init for a loaded draft.");this.g();var t=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){var n=t.D.b(23);n.a(32)})},br:function(n){var u=this.D;var f=u.a;var t=f.L;var i=n.I;if(i===t.b()&&!this.b.a(i)){var r=n;t.O(r.h);t.ck(!1);_js.Trace.logInfo(_a.a.a,"Got original cal item, finish 1st init with context:{0}",t);this.g();_js.Trace.logInfo(_a.a.a,"Check begin upgrade on original cal item");this.p()}},bs:function(n){var u=this.D;var f=u.a;var t=f.L;var i=n.I;if(i===t.b()&&!this.b.a(i)){var r=n;t.O(r.a);_js.Trace.logInfo(_a.a.a,"Got original message, finish 1st init with context:{0}",t);this.g();_js.Trace.logInfo(_a.a.a,"Check begin upgrade on original message item");this.p()}},bg:function(n,t){this.E.b().b(this.D.a,!1);_js.Trace.logInfo(_a.a.a,"Navigate away on action failure")},bk:function(n){var t=this.D.a;var i=t.L;if(n.I===i.b()){t.M.b(3400);this.E.N()}},g:function(){var e=_js.e.s(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.D;var u=n.a;var f=u.L;var s=f.a();n.b(7).C();n.b(8).C();n.b(1).C();f.bm()&&n.b(14).C();var i=n.b(11);i.C();if(this.F.a()!==4&&!this.F.M()||!this.F.a()&&this.F.M()){var t=this.E.bo().c(this.f.a()&&this.F.d()==="HTML",this.F.M());if(i.b()){var r=i.c();r&&(t=t+r)}this.F.I(t)}var o=_y.c.a.a();if(o!=="Mouse"){if(this.f.b()){n.b(5).C();n.b(6).C();n.b(3).C();n.b(9).C();n.b(22).C();n.b(28).C()}n.b(10).C()}else n.b(22).C();_js.e.e(e);_js.e.e(this.q);if(u.bI){_js.Trace.logInfo(_a.a.a,"Begin 2nd init in finish 1st because we are already in view.");this.K()}this.bd(!0)},bh:function(){var n=this.D;var i=n.a;var t=i.L;n.b(2);n.b(15);n.b(25);n.b(29);n.n();t.ed()||t.fk();this.Z(!0);_js.Trace.logInfo(_a.a.a,"Finish 2nd init, context:{0}",t);_js.e.e(this.t)},s:function(n){this.i=_js.e.s(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.D.a;var t=i.L;var e=i.U;if(t.en()){if(t.cP()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline since message was a clean new message before popout, context: {0}",t);t.ee=_mcp.b.b(t)}t.be()&&!t.g()&&this.o(!0)}else t.eZ(!0);i.M.b(3400);i.M.a(3400,null);t.eQ()&&i.M.a(3480);var r=this.f.a()&&t.d()==="HTML"?_h.b.c():_h.b.m();var o="MailCompose";var u=i.bu.e(n,r,o);u.I=t.b();var f=this;e.a(u,this.A,function(n){f.bp(n)},this.d);_js.Trace.logInfo(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.bj.a(n),r.BodyType,_y.c.a.a(),t.d())},o:function(n){if(n!==this.j){var t=this.D.a.M;t.b(3440);n&&t.a(3440,null);this.E.N();this.j=n}},bn:function(n){var i=n;var t=new _g.g(i.e().Id);this.D.a.L.E(t);this.s(t)},p:function(){var r=this.D;var n=r.a.L;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.h()||n.g()){if(i&&n.h()&&n.g()&&_a.UserAgent.getInstance().D){var u=this;_js.g.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){u.E.N()},1e3)}}else{var f=r.b(12);f.R()}},X:function(){var n=this.D.a.L.b();if(this.r){_js.Trace.logInfo(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.O.b,this.l)}else{_js.Trace.logInfo(_a.a.a,"Calling main window to process save result {0}",n);_g.k.b.getSaveResultForPopout(n,_a.O.b,this.l)}},bi:function(n){var t=this.D.a.L;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.be()&&!t.g()&&t.cm(!0);this.s(i)}else{_js.Trace.logInfo(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.u(!1);this.h("ErrorSaveFailedOnMainWindow",null,null)}},bo:function(n,t){var r=this.D.a;var i=r.L;i.et&&this.bf()},bl:function(n,t){var r=this.D.a;var f=r.L;if(f.g()){var i=this.D.b(12);if(i.d){var u=r.bA()?r.bA().toString():"";_y.k.a(i.d,null,null,null,u);i.d=null}}},bf:function(){var t=this.D.a;var n=t.L;if(n.eF()){var i=t.bA()?t.bA().toString():"";_y.k.a(n.eF(),null,"",null,i);n.T(null)}this.M()},h:function(n,t,i){var f=this.D.a;var r=f.L;if(r.cz()){var u=new _a.u;_js.d.a(i)||u.b("E",i);_y.k.a(r.cz(),null,n,t,this.R(u.toString(),r.cz().j));r.H(null)}if(r.eF()){_y.k.a(r.eF(),null,n,t,i);r.T(null)}this.M()},R:function(n,t){var i="";i=_js.d.a(n)?t:_js.d.a(t)?n:n+"|"+t;return i},be:function(){var i=this.D.a;var n=i.L;if(n.cz()){var t=n.cz().j;i.bA()&&(t=this.R(i.bA().toString(),t));_y.k.a(n.cz(),null,"",null,t);n.H(null)}},M:function(){var i=this.D.a;var t=i.L;if(t.fS()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.s.endPT(n);t.U(!1)}}},bm:function(n){this.O(n,"ConvertIdAction")},bp:function(n){this.O(n,n.f)},O:function(n,t){var i=this;this.N(n,t,function(t){t.g(n,_nbs.a.KW,_nbs.a.Cs,_nbs.a.KW,_bms.E.BC,i.k)})},W:function(n){var t=this;this.N(n,n.f,function(i){i.f(n,t.k)})},N:function(n,t,i){var u=t+"_UnknownError";var s=this.D;var e=s.a;var h=e.L;var f=n.I;f!==h.b()||this.b.a(f)||i(e.U);var r=u;r=_g.X.a(n.s)?_g.X.b(n.s)||u:n.s.ExceptionName||u;var o=n.s.FaultMessage||n.s.message;_js.e.e(this.i);this.h(r,n.C(),o)}};_mcp.e=function(n){_mcp.e.initializeBase(this,[4,n])};_mcp.e.f=function(){_mcp.e.b||(_mcp.e.b=new _H("LocationViewModel",_cc.I,_mcp.e));return _mcp.e.b};_mcp.e.e=function(){_mcp.e.a||(_mcp.e.a=new _H("IsMeetingForwardOnBehalfOf",Boolean,_mcp.e));return _mcp.e.a};_mcp.e.g=function(n){switch(n.a()){case 4:return n.by();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_mcp.e.prototype={c:function(){return this.dS(_mcp.e.c)},e:function(n){this.dR(_mcp.e.c,n);return n},b:function(){return this.dS(_mcp.e.d)},a:function(n){this.dR(_mcp.e.d,n);return n},g:function(){return this.dS(_mcp.e.f())},f:function(n){this.dR(_mcp.e.f(),n);return n},d:function(){return this.dS(_mcp.e.e())},h:function(n){this.dR(_mcp.e.e(),n);return n},C:function(){var n=this.D.a.L;var i=this.D.a.cf;n.bV()?this.f(new _cc.I(n.cF(),null,this.D.a.cf,this.D.a.V,!1,!1)):this.f(null);if(n.bm()&&n.bx()){var t=2;var f=_pc.a.k(n.k());var e=i.e(f,_bc.f.a,!0,t);this.e(e);this.h(!!n.bo()&&!!n.bo().Mailbox&&!!n.k()&&!!n.k().Mailbox&&!_g.n.b(n.k().Mailbox,n.bo().Mailbox));if(this.d()){var r=_pc.a.k(n.bo());var u=i.e(r,_bc.f.a,!0,t);this.a(u)}else this.b()&&this.a(null)}else{this.c()&&this.e(null);this.b()&&this.a(null)}_js.Trace.logInfo(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.bm(),n.bx());_mcp.P.prototype.C.call(this)}};_mcp.bj=function(n,t,i){this.g=Function.createDelegate(this,this.v);this.f=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.w);this.l=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.J);_mcp.bj.initializeBase(this,[9,n]);this.k=t;this.s=i};_mcp.bj.prototype={k:null,s:null,e:null,d:null,c:null,j:null,b:function(){return this.e},B:function(n){if(this.e!==n){this.e=n;this.bt("ShowMessageOptionsCommand")}return n},a:function(){return this.d},A:function(n){if(this.d!==n){this.d=n;this.bt("DialogViewModel")}return n},C:function(){this.e||this.B(new _C(this.o,this.G()));this.p();_mcp.P.prototype.C.call(this)},J:function(){_js.Trace.logInfo(_a.a.a,"User chose to show message options");$a(this.c)&&(this.c=new _mcp.C);this.c.t(this.F);if($a(this.d)){var t=new _bc.j;t.w(this.k);this.A(t);this.d.k(_nbs.a.Et);this.j=[new _ff.f(new _C(this.n,this.G()),_u.P.T,null),new _ff.f(new _C(this.l,this.G()),_u.R.fI,null)];this.d.h.p(this.j)}this.d.m(this.c);if("TouchNarrow"===_y.c.a.a()){var n=this.D.a.bs();this.c.u(n);n.b().d(this.i)}this.d.g(!0)},y:function(){if(this.d.D){_js.Trace.logInfo(_a.a.a,"User tried to click OK button more than once.");return}var n=this.E.L;if(n.D()!==this.c.d){this.D.a.P().a("Sensitivity:"+this.c.d);"Normal"!==n.D()&&this.z();n.dF(this.c.d);"Normal"!==n.D()&&this.p()}n.bc()!==this.c.e&&this.D.a.P().a("RequestDeliveryReceipt");n.bd()!==this.c.f&&this.D.a.P().a("ReadReceiptRequested");n.dm(this.c.e);n.dt(this.c.f);this.c.a&&!n.u()||this.c.b&&!n.F()?this.E.ct(this.m):this.r();this.c.a!==n.u()&&this.D.a.P().a("EncryptMessage");this.c.b!==n.F()&&this.D.a.P().a("SignMessage")},r:function(){var n=this.E.L;var u=this.D.a;var t=this.E.Q();var i=t.a();if(n.u()!==this.c.a){n.dH(this.c.a);this.bt("SmimeEncryptMessage");_js.Trace.logInfo(_a.a.g,"SmimeEncryptMessage option is changed to {0} by user.",this.c.a)}if(n.F()!==this.c.b){n.dJ(this.c.b);this.bt("SmimeSignMessage");_js.Trace.logInfo(_a.a.g,"SmimeSignMessage option is changed to {0} by user.",this.c.b)}var r=this.c.a||this.c.b;r&&u.dP();i&&i.bb(n.r());if(this.c.k&&!r&&t.e())if(t.b()){_js.Trace.logInfo(_a.a.g,"Waiting to move attachments because the attachment well is currently in progress.");this.d.r(!0);i.Y(this.f)}else this.u(null,null);else if(!this.c.k&&r){this.E.ca().K()&&!n.R()&&this.E.ca().l().a();if(t.e())if(t.b()){_js.Trace.logInfo(_a.a.g,"Waiting to move attachments because the attachment well is currently in progress.");this.d.r(!0);i.Y(this.g)}else this.v(null,null);else this.h()}else this.h()},u:function(n,t){if(this.t(n,t)){_js.Trace.logInfo(_a.a.g,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.x(this.f);this.d.r(!1)}var i=this.E.Q().a();if(this.E.L.h())i.V();else{var r=this;this.E.d().b("Attach",function(){i.V()},null,!1)}this.h()}},v:function(n,t){if(this.t(n,t)){_js.Trace.logInfo(_a.a.g,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.x(this.g);this.d.r(!1)}this.E.Q().a().W();this.h()}},t:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.g()},h:function(){_js.Trace.logInfo(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.F.D()+"; DeliveryReceipt="+this.F.bc()+"; ReadReceipt="+this.F.bd()+"; SmimeEncryptMessage="+this.F.u()+"; SmimeSignMessage="+this.F.F());this.q()},q:function(){if(this.d.D){_js.Trace.logInfo(_a.a.a,"User tried to close dialog when busy.");return}var t=this.D.a.L;var i=this.E.bc();if(t.r()&&t.i()){_a.S.a(_u.R.Hc,1);i.a(750)}else i.b(750);this.E.R().m.c(!t.r());var n=this.E.Q();if(n.a()){n.a().x(this.f);n.a().x(this.g)}"TouchNarrow"===_y.c.a.a()&&this.c.g.b().e(this.i);_js.Trace.logInfo(_a.a.a,"Close message options dialog");this.d.i.a()},w:function(n,t){_mcp.d.isInstanceOfType(this.D.a.bs().a())?this.d.g(!0):this.d.g(!1)},z:function(){var t=this.D.a;var n=t.bc();switch(t.L.D()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.E.N()},p:function(){var t=this.D.a;var n=t.bc();switch(t.L.D()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.E.N()}};_mcp.k=function(n,t){this.Q=Function.createDelegate(this,this.bi);this.bb=Function.createDelegate(this,this.bv);this.W=Function.createDelegate(this,this.bq);this.Z=Function.createDelegate(this,this.bl);this.ba=Function.createDelegate(this,this.bs);this.R=Function.createDelegate(this,this.bn);this.X=Function.createDelegate(this,this.br);this.y=Function.createDelegate(this,this.bo);this.be=Function.createDelegate(this,this.bx);this.S=Function.createDelegate(this,this.bp);_mcp.k.initializeBase(this,[2,n]);this.B=new _C(this.S,this.G());var u=this;this.N=new _C(function(){u.z("Upconvert")},this.G());var f=this;this.K=new _C(function(){f.z("ShowOriginalMessage")},this.G());var i=this,r=this;this.O=new _C(function(){i.z("UpconvertOnFormat")},this.G(),this.D.a.L,"BodyType",function(){return r.D.a.L.d()==="HTML"});this.M=new _C(this.be,this.G());this.m=n.a.bt;this.p=t};_mcp.k.prototype={m:null,p:null,B:null,N:null,O:null,K:null,M:null,r:!1,s:!1,l:!1,n:!1,v:!1,k:null,o:null,u:!1,d:function(){return this.B},t:function(n){this.r!==n&&(this.r=n);return n},i:function(){return this.s},w:function(n){if(this.s!==n){this.s=n;this.bf(n)}return n},h:function(){return this.l},J:function(n){if(this.l!==n){this.l=n;this.bf(n)}return n},j:function(){return this.n},g:function(){return this.q().n()},e:function(n){this.q().q(n);return n},q:function(){$a(this.o)&&(this.o=this.bh());return this.o},C:function(){var n=_y.c.a;"Mouse"!==n.a()||n.c()||n.w(this.y);_mcp.P.prototype.C.call(this)},a:function(n){this.o=n},b:function(n,t){n.D(!0);this.q().o(n,t)},f:function(n){this.D.a.bj&&(this.u=!0);if(!this.u){_js.Trace.logInfo(_a.a.a,"Checking dirty before prompting user for before unload confirmation. Context: {0}",this.D.a.L);this.D.a.bw()&&n.a(_nbs.a.JE)}this.u=!0;_js.g.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.X,100)},c:function(){var n=!0;var u=this.D;var t=u.a;var i=t.L;var r=t.e();var o=t.d();var e=i.b();var s=i.a();if(this.m.a(e))_js.Trace.logInfo(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.be()&&this.m.g(u,!1))_js.Trace.logInfo(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.bg())n=!1;else if(r.j){_js.Trace.logInfo(_a.a.a,"We're sending the message, can't exit yet.");n=!1}else if(r.s){_js.Trace.logInfo(_a.a.a,"We're resolving the recipients, can't exit yet.");r.bm();n=!1}else if(i.l()){var f=t.bh();f.a().a();n=!1}else{_js.Trace.logInfo(_a.a.a,"Checking dirty before navigating away from compose. Context:{0}",i);if(t.bw()){this.v=!1;_js.g.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.R,1e4);this.P();if(o.b("ReadingPaneExit",this.ba,this.Z,!1)){this.J(!0);_js.Trace.logInfo(_a.a.a,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},bh:function(){return new _y.bf},br:function(){this.u=!1},bo:function(){_y.c.a.H(this.y);this.m.g(this.D,!0)},bf:function(n){var t=this.D.a;t.de(_u.P.k);t.dd(n);t.dK(n)},bp:function(){var f=this.D;var t=f.a;var n=t.L;var o=n.b();_js.g.a().j(_a.a.a,"MailComposePopOut");if(this.r){_js.Trace.logInfo(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.bj()){n.H(this.k=_y.k.b(_a.a.a,"MailComposeReadingPanePopOut",!0));this.t(!0);var e=!1;try{var h=this.D.a.M;h.e(_mcp.k.b);this.E.N();var i=t.d();_js.Trace.logInfo(_a.a.a,"Checking dirty before popping out from reading pane. Context:{0}",n);var u=t.bw();var r=t.L.cD();var s=f.b(11);if(!n.h()||u||s.b()||r){this.w(!0);(n.h()&&!r||u||i.e())&&n.eq(!1);_js.Trace.logInfo(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.cP());this.n=!1;_js.g.a().a(_a.a.a,"PopoutSaveTimeout",this.W,1e4);n.ff(!0);this.P();t.bd.get_saveForPopoutMap()[o]=new _y.fM;this.bk();i.b("Popout",this.bb,this.Q,!1)}else{if(n.bX())n.eq(!1);else if(n.bU())n.eq(!1);else if(i.e())n.eq(!1);else if(n.ee){_js.Trace.logInfo(_a.a.a,"Comparing initial baseline with baseline. Context:{0}",n);n.ee.q(n.ed())||n.eq(!1)}else n.eq(!1);n.ff(!1);_js.i.c(t.bd,"PopoutManager");_js.i.c(t.bd.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bd.get_saveForPopoutMap()[o];this.bk()}_js.Trace.logInfo(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.q().p(!0);e=!0}finally{if(!e){this.t(!1);this.w(!1);_y.k.a(this.k,null,_mcp.k.a.toString(4));n.H(null);this.k=null}}}},bj:function(){var n=this.D;var r=n.a;var u=r.L;var t=u.b();var i=n.b(7);if(i.j){_js.Trace.logInfo(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.bg()||this.m.a(t)){_js.Trace.logInfo(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}return!0},bg:function(){var n=this.D.a;var t=n.Q();if(t.b()){if(!n.T.j){_js.Trace.logInfo(_a.a.a,"Show attachment in progress error dialog");n.T.a(0,_u.R.NG,null)}return!0}return!1},bk:function(){var r=this.D.a;var t=r.L;var n=new _mcp.a;if(this.p){n.dD(this.p.c());n.di(this.p.a())}n.p(0);n.m(!1);if(t.a()===11||t.a()===12){n.f(13);n.dB(t.ca());n.dA(t.bA())}else n.f(4);n.E(t.h());n.o(t.d());var i=this.bh();n.gd(!0);n.cm(t.g());n.dL(t.G());n.du(t.be());n.eZ(t.bX());n.eY(t.bU());n.eq(t.cP());n.ff(t.cd());n.fe(t.b());n.K(t.z());n.H(t.cz());t.g()||t.a()!==3||t.cS()||!t.e().T()||n.bp(t.e().T().c);i.a(n);if(!t.cd()){this.A();this.t(!1)}},bv:function(n){this.w(!1);if(this.n){_js.Trace.logInfo(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.k.a(this.k,null,_mcp.k.a.toString(3));this.k=null}else{var i=n.I;var t=this.D.a;if(i in t.bd.get_saveForPopoutMap()){var u=_mcp.R.a(n);var r=t.bd.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bd.pushSaveResultToPopout(f,r.a);delete t.bd.get_saveForPopoutMap()[i]}else r.b=u}if(t.L.b()===i){_js.Trace.logInfo(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.A();this.t(!1)}else _js.Trace.logInfo(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.L.b())}},bs:function(n){this.l&&this.J(!1);if(this.v){_js.Trace.logInfo(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.A()},bl:function(n){if(this.l){_js.Trace.logInfo(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.J(!1)}},A:function(){var n=this.D.a;this.b(n,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from reading-pane compose")},bm:function(){var u=this.D;var r=u.a;var n=r.L;if(!n.g()&&!n.h()&&!n.G()){_js.Trace.logInfo(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",n.b());r.T.a(0,_nbs.a.eo);return}if(this.bj()){var t=this.q();if(IInlineComposeConductorViewModel.isInstanceOfType(t)){var i=t;var f=u.b(12);f.l().a();i.e(!1);i.j(n)}}},bx:function(){var n=this;this.D.a.L.dC(function(n){var t=n.bf().g;t?t.a().a():_js.Trace.logError(_a.a.a,"ExtensibilityViewModel is null, Apps pane is not opened after upconvert")});this.E.P().a("UpconvertAndShowApps");this.bm()},bi:function(n){if(this.r){this.t(!1);this.w(!1);var f=this.D;var i=f.a;var t;t=n?n.I:i.L.b();if(t in i.bd.get_saveForPopoutMap()){var r=i.bd.get_saveForPopoutMap()[t];r.a.length>0&&i.bd.pushSaveResultToPopout(null,r.a);delete i.bd.get_saveForPopoutMap()[t]}}var u=this.n?2:1;_y.k.a(this.k,null,_mcp.k.a.toString(u));this.k=null},bq:function(){_js.Trace.logInfo(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.s){this.n=!0;this.bi(null);var t=this.D;var n=t.a.M;this.P();n.a(84);this.E.N()}},bn:function(){_js.Trace.logInfo(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.l){this.v=!0;this.bl(null);var n=this.E.M;this.P();n.a(86);this.E.N()}},z:function(n){this.E.P().a(n);this.bm()}};_mcp.k.a=function(){};_mcp.k.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.k.a.registerEnum("_mcp.k.a",!1);_mcp.bk=function(n,t,i){this.g=Function.createDelegate(this,this.p);this.m=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.r);_mcp.bk.initializeBase(this,[30,n]);this.l=t;this.h=i;this.f=new _C(this.n,this.G());this.e=new _C(this.m,this.G());if(this.E.L.bn()){var r=this.E.bc();r.a(10206)}};_mcp.bk.prototype={f:null,e:null,l:null,h:null,j:null,i:null,a:function(){return!!this.E.bb.OmeSettings},d:function(){return this.f},c:function(){return this.e},o:function(){return this.l.a().b().Enabled&&!!this.h&&this.h.a()==="TouchNarrow"},C:function(){if(!this.E.bb.WasLoadedFromServer){var n=this.E.S;n.b(_a.cN,this.g)}_mcp.P.prototype.C.call(this)},H:function(){this.E.S.c(_a.cN,this.g);this.f=null;this.e=null;_mcp.P.prototype.H.call(this)},b:function(n){if(!_y.c.a.h()){this.j=new _fm.d(_nbs.a.Iq,null,this.f);this.i=new _fm.d(_nbs.a.OQ,null,this.e);Array.add(n,this.j);Array.add(n,this.i);this.k()}},k:function(){var t=this.a();var n=this.E.L.bn();if(_y.c.a.a()==="Mouse"||this.o()){this.j.c(n||!t);this.i.c(!n||!t);if(_y.c.a.a()==="Mouse"){var r=this.D.b(16);r.B(t,n)}}else{var i=this.D.b(10);i.i()}},r:function(){this.E.L.cl(!0);this.k();var n=this.E.bc();n.a(10206,null)},q:function(){this.E.L.cl(!1);this.k();var n=this.E.bc();n.b(10206)},p:function(n){var t=this.D.a;this.k();t.S.c(_a.cN,this.g)}};_mcp.bl=function(n,t){this.c=Function.createDelegate(this,this.d);_mcp.bl.initializeBase(this,[13,n]);this.b=new _C(this.c,this.G());this.b.c(t.d().a().c())};_mcp.bl.prototype={b:null,a:function(){return this.b},d:function(){_js.Trace.logInfo(_a.a.a,"OpenFilePicker on PAL.");var n=this.D.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}if(!n.c()){_js.Trace.logError(_a.a.a,"Unable to open file picker, ViewModel is not upgraded.");return}n.a().by();_js.Trace.logInfo(_a.a.a,"OpenFilePicker on PAL end.")}};_mcp.bm=function(n,t){this.f=Function.createDelegate(this,this.h);this.e=Function.createDelegate(this,this.g);_mcp.bm.initializeBase(this,[13,n]);var i;i=t.b(t.d())?t.d().a():this;var u=this;this.c=new _C(this.e,this.G(),i,"CameraAvailable",function(){return t.b(t.d())&&t.d().a().e()});var r=this;this.d=new _C(this.f,this.G(),i,"GalleryAvailable",function(){return t.b(t.d())&&t.d().a().f()})};_mcp.bm.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d},g:function(){_js.Trace.logInfo(_a.a.a,"User chose to attach from camera");var n=this.D.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}if(!n.c()){_js.Trace.logError(_a.a.a,"Unable to open camera, ViewModel is not upgraded.");return}n.a().X(n.f());_js.Trace.logInfo(_a.a.a,"Attach from camera end")},h:function(){_js.Trace.logInfo(_a.a.a,"User chose to attach from gallery");var n=this.D.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}if(!n.c()){_js.Trace.logInfo(_a.a.a,"Unable to open gallery, ViewModel is not upgraded.");return}n.a().B(n.f());_js.Trace.logInfo(_a.a.a,"Attach from gallery end")}};_mcp.t=function(n,t){this.bZ=Function.createDelegate(this,this.db);this.ca=Function.createDelegate(this,this.dc);this.cc=Function.createDelegate(this,this.dd);this.cd=Function.createDelegate(this,this.de);this.bV=Function.createDelegate(this,this.cL);this.bW=Function.createDelegate(this,this.R);this.bX=Function.createDelegate(this,this.cm);this.bY=Function.createDelegate(this,this.cn);this.bv=Function.createDelegate(this,this.dp);this.bq=Function.createDelegate(this,this.dj);this.br=Function.createDelegate(this,this.dl);this.i=Function.createDelegate(this,this.dk);this.ci=Function.createDelegate(this,this.dq);this.K=Function.createDelegate(this,this.di);this.bs=Function.createDelegate(this,this.dn);this.J=Function.createDelegate(this,this.cC);this.ch=Function.createDelegate(this,this.dm);this.cj=Function.createDelegate(this,this.du);this.bp=Function.createDelegate(this,this.cK);this.cg=Function.createDelegate(this,this.dg);this.cl=Function.createDelegate(this,this.cv);this.ce=Function.createDelegate(this,this.df);this.ck=Function.createDelegate(this,this.dw);_mcp.t.initializeBase(this,[1,n]);this.p=t;this.c=this.bD();this.d=this.bD();this.e=this.bD();this.r=new _C(this.ck,this.G());this.v=new _C(this.ce,this.G());this.m=new _C(this.cl,this.G());this.w=new _C(this.cg,this.G());this.bE=new _C(this.bp,this.G());this.bB=new _C(this.cj,this.G());this.y=new _C(this.ch,this.G());n&&n.a&&(this.O=n.a.bE);this.s=new _ff.e;this.cF()};_mcp.t.d=function(n,t){n.bi(t)};_mcp.t.b=function(n,t){n.cf(t)};_mcp.t.e=function(n,t){n.dK(t)};_mcp.t.c=function(n,t){n.cY(t)};_mcp.t.a=function(n,t){n.cX(t)};_mcp.t.prototype={c:null,d:null,e:null,r:null,v:null,m:null,w:null,bE:null,bB:null,y:null,p:null,O:null,bb:!0,bn:null,N:null,M:null,bl:null,bm:null,Z:null,bk:null,X:null,g:null,k:null,bh:!1,f:!1,be:!1,bz:!1,h:null,t:null,Q:null,ba:null,q:!1,bK:!1,bR:!1,bj:!1,bi:!1,s:null,o:null,n:null,cA:function(n){this.by("ResolveOperationSucceeded",n)},ds:function(n){this.bN("ResolveOperationSucceeded",n)},cz:function(n){this.by("ResolveOperationCanceled",n)},dr:function(n){this.bN("ResolveOperationCanceled",n)},bg:function(n){if(this.g!==n){this.g=n;this.bt("FromPersonaViewModel")}return n},b:function(){return this.g&&this.g.bx?this.g.bx.a():null},j:function(){if(!this.k){var n=this;this.E.cB.a(function(t){var i=t.a();i.d(!0);i.F(!1);i.bq(100);i.G(0);i.bo("PersonaDetailedView");i.S();i.v(!0);i.J(new _C(n.J,_a.a.a));n.cT()&&n.cW()&&i.I(new _C(n.J,_a.a.a));_y.c.a.a()!=="Mouse"&&i.bj(new _C(n.J,_a.a.a));i.q(n.bs);n.k=i;if(n.bj){n.cv();n.bj=!1}else if(n.bi){n.bJ();n.bi=!1}})}return this.k},bQ:function(n){if(this.bh!==n){this.bh=n;this.bt("ShouldHighlightFromAsInvalid")}return n},bH:function(){return this.p.a().b().Enabled&&!!this.O&&this.O.a()==="TouchNarrow"},cW:function(){return!!this.p&&this.p.a().O().Enabled},cT:function(){return!!this.p&&this.p.a().d().Enabled},dv:function(n){this.f=n;this.bt("IsReadWrite");return n},z:function(n){this.bK=n;this.bt("IsPeoplePickerShown");return n},W:function(){var n=this.D.a.L;return!!n.k()&&!!n.k().Mailbox&&!_a.F.a(n.k().Mailbox.EmailAddress)},u:function(){this.bm||(this.bm=new _y.g(_nbs.a.jK,this.m));return this.bm},S:function(){this.Z||(this.Z=new _y.g(_nbs.a.Mx,this.w));return this.Z},bI:function(){this.bk||(this.bk=new _y.g(_nbs.a.JS,this.r));return this.bk},bG:function(){this.X||(this.X=new _y.g(_nbs.a.Pc,this.v));return this.X},cu:function(n){if(this.bb!==n){this.bb=n;this.bt("IsCCShown")}return n},cX:function(){var n=this.D.a.L;return!n.s()&&this.E.bg()},cV:function(){return!this.D.a.L.l()},cU:function(){return this.D.a.L.l()},cS:function(){return this.bA(this.f?this.c.a.v:this.c.b.c())||this.bA(this.f?this.d.a.v:this.d.b.c())||this.bA(this.f?this.e.a.v:this.e.b.c())},cp:function(){return this.D.a.L.l()||this.D.a.cV()},dx:function(){this.c.u();this.d.u();this.e.u()},cG:function(n,t,i){if(this.h){this.h.c(this.t);this.h.a(i);this.t=i;this.h.e(t);this.h.d(n);this.z(!0);this.D.a.bx(this.h)}else{var r=this;this.E.cL.a(function(u){r.h=u.a(n,t);r.h.a(i);r.h.b(r.K);r.t=i;r.z(!0);r.D.a.bx(r.h)})}},cE:function(){this.bx(0);this.bx(1)},a:function(){return this.s},cH:function(n,t,i){var u=null;i&&(i===_u.R.NN?u=this.c:i===_u.R.QQ?u=this.d:i===_u.R.My&&(u=this.e));if(!this.h&&u){var r=this;this.E.cN.a(function(i){r.n=i.a();r.n.c(r.K);r.n.a(n);r.n.b(t);r.Q=n;u.a.u().K(r.n);r.z(!0);u.a.u().L()})}else{u.a.u().K(this.n);this.n.d(this.Q);this.n.a(n);this.Q=n;this.z(!0);u.a.u().L()}},C:function(){var n=this.D.a.L;var t=n.C();this.dv(!t||!!t.a()||t.o()||t.b());this.o=new _mcp.g(n.bk(),this.cp());if(n.bC()&&n.bC().b()>0){this.c.F(n.bC(),this.f,_u.R.NN);n.cq(null)}else{var u,f;var e=(f=this.o.l(u={val:n}),n=u.val,f);this.c.s(e,n.bh(),this.f,_u.R.NN)}this.d.s(n.q(),n.Z(),this.f,_u.R.QQ);this.cu(!this.cp()&&(this.E.bg()?!$a(n.q())&&n.q().b()>0:!0));this.o.n(this.f?this.c.a:this.c.b,this.f?this.d.a:this.d.b);_y.c.a.h()&&this.cw(!0);this.cE();var i=_g.a.a().c();if(!_js.d.a(i.bl.SharePointUrl)&&!_js.d.a(i.bl.LogonEmailAddress)){var r=new _g.bh;r.Mailbox=this.bC(i.bl.LogonEmailAddress);n.ci(r)}("Mouse"===_y.c.a.a()||n.k()||_g.a.a().a().bl.AlwaysShowFrom||!$a(n.c())&&n.c().b()>0||_g.a.a().a().bl.AlwaysShowBcc)&&this.l();this.cx(n);_mcp.P.prototype.C.call(this)},H:function(){if(this.g){this.g.dispose();this.g=null}if(this.h){this.h.c(this.t);this.h.g(this.K);this.h.dispose();this.h=null;this.t=null}this.cs();if(this.k){this.k.j(this.bs);this.k.U();this.k=null}this.cs();this.dt();this.s.f();this.c.dispose();this.d.dispose();this.e.dispose();this.o=null;_mcp.P.prototype.H.call(this)},B:function(){this.l();var n=this.D.a.L;this.bo();this.bM(n,this.c,this.ci,_mcp.t.e);this.bM(n,this.d,_mcp.t.d,_mcp.t.c);this.bM(n,this.e,_mcp.t.b,_mcp.t.a)},A:function(n,t){var r=_a.F.a(n);if(r){this.j().b("");var e=this.bC(n);var o=_pc.a.b(e);var f=this.D.a.bM.c;var i=f.a(o,4,!0,2);i.bs(this.bB);i.b(!0);i.bW=!0;this.bg(i);this.cJ()}else{this.j().b(n);this.bg(null)}if(t&&_a.cB.a){var u=this.D.a.cE();u.a(1)}this.bQ(!r);this.B()},cr:function(){this.l();return this.c.f()+this.d.f()+this.e.f()},de:function(){this.l();return this.c.f()},dd:function(){this.l();return this.d.f()},dc:function(){this.l();return this.e.f()},ct:function(n){this.l();this.bo();this.cI();this.bR=n;this.cO()},da:function(){var n=new _ff.e;this.c.a?n.h(this.c.a.h()):this.c.b&&n.h(this.c.b.h());this.d.a?n.h(this.d.a.h()):this.d.b&&n.h(this.d.b.h());this.e.a?n.h(this.e.a.h()):this.e.b&&n.h(this.e.b.h());return n.i()},cO:function(){this.c.d?this.c.r():this.cn(!0)},cn:function(n){n?this.d.d?this.d.r():this.cm(!0):this.R(!1)},cm:function(n){n?this.e.d?this.e.r():this.R(!0):this.R(!1)},R:function(n){if(this.bR)if(n){_js.Trace.logInfo(_a.a.a,"Force resolve completed");this.co("ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.a.a,"Force resolve cancelled");this.co("ResolveOperationCanceled")}},cN:function(){this.l();this.bo();this.c.q();this.d.q();this.e.q()},l:function(){if(!this.bz){this.bz=!0;var n=this.D.a.L;this.e.s(n.c(),n.L(),this.f,_u.R.My);if(!$a(n.c())&&0<n.c().b()||!_js.d.a(n.L())||_g.a.a().a().bl.AlwaysShowBcc){n.bL(!0);_js.Trace.logInfo(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$a(n.c())?0:n.c().b(),!_js.d.a(n.L()),_g.a.a().a().bl.AlwaysShowBcc)}this.bx(2);_js.Trace.logInfo(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.k()||!n.k().Mailbox?"<not set>":n.k().Mailbox.EmailAddress,$a(n.j())?0:n.j().b(),$a(n.q())?0:n.q().b(),$a(n.c())?0:n.c().b());this.cx(n);if(n.S()&&(n.k()||_g.a.a().a().bl.AlwaysShowFrom))if(this.j()){this.bJ();_js.Trace.logInfo(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.k()||!n.k().Mailbox?"<not set>":n.k().Mailbox.EmailAddress,_g.a.a().a().bl.AlwaysShowFrom)}else this.bi=!0;else if(_g.a.a().a().bl.AlwaysShowFrom&&!$a(n.C())&&!n.C().b()){var t=this.D.a.M;t.b(4525);t.a(4525);this.E.N()}}},dh:function(){this.c.t();this.d.t();this.e.t()},db:function(){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.D.a.L;var t=new _ff.e;var u=this.f?this.c.a.v:this.c.b.c();var f=this.f?this.d.a.v:this.d.b.c();var r=this.f?this.e.a.v:this.e.b.c();if(u){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.h(u.f())}if(f){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.h(f.f())}if(r){_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.h(r.f())}_js.Trace.logInfo(_a.a.g,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.ce();if(!n){var i=_g.a.a().c();n=new _g.d;n.Name=i.bl.UserDisplayName;n.EmailAddress=i.bl.UserEmailAddress||i.bl.LogonEmailAddress;n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.c(n);return t},du:function(){if(this.g){_js.Trace.logInfo(_a.a.a,"User selected from persona");this.g.n(!0);this.ba&&this.ba()}else _js.Trace.logInfo(_a.a.a,"User tries to select from persona, but it is null")},dm:function(){this.D.a.P().a("ResolveRecipients");this.ct(!1)},cK:function(){_js.Trace.logInfo(_a.a.a,"User chose to delete from persona");this.bg(null);this.j().k(!0)},cC:function(){this.A(this.j().a(),!0)},dn:function(n,t){this.cD()},bD:function(){return new _mcp.u(this.D.a.bM,this,this.p)},dq:function(n,t){if(this.o){var i;this.o.k(t,i={val:n}),n=i.val}else n.v(t)},dk:function(n,t){this.s.f();this.bS(this.c);this.bS(this.d);this.bS(this.e)},bS:function(n){n.a?this.s.c(n.a):n.b&&this.s.c(n.b)},cF:function(){this.c.apcl("ReadWriteRecipientWellViewModel",this.i);this.d.apcl("ReadWriteRecipientWellViewModel",this.i);this.e.apcl("ReadWriteRecipientWellViewModel",this.i);this.c.apcl("ReadOnlyRecipientWellViewModel",this.i);this.d.apcl("ReadOnlyRecipientWellViewModel",this.i);this.e.apcl("ReadOnlyRecipientWellViewModel",this.i)},dt:function(){this.c.rpcl("ReadWriteRecipientWellViewModel",this.i);this.d.rpcl("ReadWriteRecipientWellViewModel",this.i);this.e.rpcl("ReadWriteRecipientWellViewModel",this.i);this.c.rpcl("ReadOnlyRecipientWellViewModel",this.i);this.d.rpcl("ReadOnlyRecipientWellViewModel",this.i);this.e.rpcl("ReadOnlyRecipientWellViewModel",this.i)},dj:function(n,t){this.c.c()||this.d.c()||this.e.c()||this.D.a.M.b(65);this.c.h()&&this.d.h()&&this.e.h()||this.D.a.M.b(70);_y.c.a.h()&&this.cw(!1);if(t&&t.c===2){var r=this.D.a.cE();r.b();if(_a.bm.a){var i=this;_js.g.a().c(_a.a.J,"TriggerPolicyTipsIfNeeded",function(){if(i.D&&i.D.a){var n=i.D.a.cW();n.a(1)}})}}},dp:function(n,t){this.o&&this.o.m(n,t)},cI:function(){this.c.a&&this.c.a.ba();this.d.a&&this.d.a.ba();this.e.a&&this.e.a.ba()},di:function(){this.z(!1)},cs:function(){this.bf(0);this.bf(1);this.bf(2)},bx:function(n){var t=this.bf(n);if(t){t.bL(this.cq(n));t.dj(this.br);t.t.d(this.bq);n||t.t.d(this.bv)}return t},bf:function(n){var t=null;switch(n){case 0:t=this.c.a;break;case 1:t=this.d.a;break;case 2:t=this.e.a;break}if(t){t.bS(this.cq(n));t.dt(this.br);t.t.e(this.bq);n||t.t.e(this.bv)}return t},cq:function(n){switch(n){case 0:return this.bY;case 1:return this.bX;case 2:return this.bW;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},dl:function(){this.E.N()},dw:function(){var t=_a.d.b(_a.a.a,"MailComposeShowBcc",!0);this.D.a.P().a("ShowBcc");_js.Trace.logInfo(_a.a.a,"User chose to show bcc");this.l();var n=this.D.a.L;if(!n.s()){n.bL(!0);this.bt("ShowBccButton");this.E.N();this.cy()}_a.d.a(t)},df:function(){var t=_a.d.b(_a.a.a,"MailComposeHideBcc",!0);this.D.a.P().a("HideBcc");_js.Trace.logInfo(_a.a.a,"User chose to hide bcc");this.l();var n=this.D.a.L;if(n.s()){n.bL(!1);this.bt("ShowBccButton");this.E.N();this.cy()}_a.d.a(t)},cy:function(){if(_y.c.a.a()==="Mouse"){var f=this.D.b(16);f.Z()}else if(this.bH()){var u=this.D.b(28);u.j()}else{var n=this.D.a.L;var r=n.s()?this.bG():this.bI();var t=n.s()?this.bI():this.bG();var i=this.D.a.dl;i.F(t,r)}},cx:function(n){if("Mouse"!==_y.c.a.a()){var f=this.D;var u=f.a;var r=u.dl;if(r){var i=r.a;if(i)if(n.S()){if(!this.q)for(var t=0;t<i.length;t++)if(_nbs.a.JS===i[t].b){r.w(this.u(),t+1);this.q=!0}}else if(this.q){u.dl.z(this.u());this.q=!1}}}},bo:function(){var i=this.D.a.L;var n=null;if(i.i()){var t=null;this.g?t=this.g.bx.a():this.k&&!_js.d.a(this.k.a())&&(t=this.bC(this.k.a()));n=new _g.bh;n.Mailbox=t;i.ci(n);this.W()||this.D.a.M.b(66)}return n},bC:function(n){var t=new _g.d;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},cJ:function(){var t=_mcp.u.a;var n=[];(t&4)==4&&Array.add(n,new _fm.d(_u.R.VM,null,new _C(this.bV,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.d(_u.R.TX,null,new _C(this.bp,_a.a.a)));$a(this.g.bM)||(t&1)!=1||Array.addRange(n,this.g.bM);this.g.U(n)},bJ:function(){var n=this.D.a.L;var i=null;var t=_g.a.a().c();i=_js.d.a(t.bl.SharePointUrl)||_js.d.a(t.bl.LogonEmailAddress)?null!==n.k()&&n.k().Mailbox?n.k().Mailbox.EmailAddress:_h.l.f(null)||t.bl.UserEmailAddress:t.bl.LogonEmailAddress;this.A(i,!1);n.dp(!0);var u=this.bo();n.ed()&&n.ed().z(u);var r=this.D.b(18);$a(r.a())&&r.C()},cL:function(){var n=this.g.bx.a().EmailAddress;this.bg(null);this.j().b(n);this.j().k(!0)},cD:function(){var n=this.j().h();if($a(n)||$a(n.a())||$a(n.a().a()))_js.Trace.logWarning(_a.a.a,"User selected from but the SelectedResultItem persona is invalid");else{var t=n.a().a().EmailAddress;_js.Trace.logInfo(_a.a.a,"User selected from={0}",t);this.A(t,!0)}},cv:function(){if(!this.j()){this.bj=!0;return}var t=_a.d.b(_a.a.a,"MailComposeShowFrom",!0);this.D.a.P().a("ShowFrom");var n=this.D.a.L;if(n.i())_js.Trace.logInfo(_a.a.a,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.a.a,"User chose to show from");this.be=!0;this.bJ();this.E.N();this.dy()}_a.d.a(t)},dg:function(){var r=_a.d.b(_a.a.a,"MailComposeHideFrom",!0);this.D.a.P().a("HideFrom");var n=this.D.a.L;if(n.i()){n.dp(!1);this.be=!1;this.E.N();if(_y.c.a.a()==="Mouse"){var u=this.D.b(16);u.J()}else if(this.bH()){var t=this.D.b(28);t.f()}else{var i=this.D.a.dl;i.F(this.S(),this.u())}}else _js.Trace.logInfo(_a.a.a,"Skip hide from since it is already hidden");this.D.a.M.b(750);_a.d.a(r)},dy:function(){if(_y.c.a.a()==="Mouse"){var f=this.D.b(16);f.J()}else if(this.bH()){var u=this.D.b(28);u.f()}else{var n=this.D.a.L;var r=n.i()?this.S():this.u();var t=n.i()?this.u():this.S();var i=this.D.a.dl;i.F(t,r)}},bM:function(n,t,i,r){var u=this.f?t.a:t.b;if(!$a(u)){i(n,u.c());if(_rw.d.isInstanceOfType(u)){var f=u;f.u()&&r(n,f.u().a())}}},cw:function(n){var e=this.D.a.L;var i=!1;var u=e.ce();if(u){var t=this.d.a.v;if(t)for(var r=0;r<t.w.length;r++){var f=t.w[r];if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.D.a.M.b(4450);this.D.a.M.a(4450)}else n||i||this.D.a.M.b(4450)},bA:function(n){if(!n||!n.w.length)return!1;for(var t=0;t<n.w.length;t++){var i=n.w[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},bF:function(n){var t=this.c.p(n)||this.d.p(n)||this.e.p(n);t&&n.a.cA(t)},cZ:function(){if(!this.bn){var n=this;this.bn=new _C(function(){n.bF(n.c)},_a.a.a)}return this.bn},cR:function(){if(!this.N){var n=this;this.N=new _C(function(){n.bF(n.d)},_a.a.a)}return this.N},cP:function(){if(!this.M){var n=this;this.M=new _C(function(){n.bF(n.e)},_a.a.a)}return this.M},cY:function(){if(!this.bl){var n=this;this.bl=new _C(function(){n.cu(!0);n.E.N();n.D.a.P().a("ShowCc")},_a.a.a)}return this.bl}};_mcp.u=function(n,t,i){this.y=Function.createDelegate(this,this.J);this.w=Function.createDelegate(this,this.I);this.z=Function.createDelegate(this,this.K);this.j=Function.createDelegate(this,this.H);this.v=Function.createDelegate(this,this.G);_mcp.u.initializeBase(this);this.n=n;this.l=t;this.k=i};_mcp.u.prototype={n:null,o:null,a:null,b:null,d:!1,l:null,g:null,i:null,m:null,k:null,D:function(){return!!this.k&&this.k.a().bb().Enabled&&_y.c.a.a()==="Mouse"},B:function(n){if(this.a!==n){this.a=n;this.bt("ReadWriteRecipientWellViewModel")}return n},E:function(){this.o||(this.o=new _C(this.v,_a.a.bl));return this.o},L:function(n){if(n!==this.b){this.b=n;this.bt("ReadOnlyRecipientWellViewModel")}return n},h:function(){var o=this.d&&_rw.a.g(this.a);if(this.d){var f;var n;var s="";var t="";var i="";var r="";if(this.a){for(var u=0;u<this.a.t.w.length;u++){f=this.a.t.w[u];if(f){s=f.g.d();i=i+" "+s}}for(var e=0;e<this.a.v.w.length;e++){n=this.a.v.w[e];if(n){t="";_js.d.b(n.EmailAddress)?_js.d.b(n.Name)||(t=n.Name):t=n.EmailAddress;r=r+" "+t}}}_js.Trace.logInfo(_a.a.V,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.g,o,i,r)}return o},c:function(){return this.d&&!$a(this.a)&&this.a.H},e:function(){this.d&&this.a&&this.a.dg()},F:function(n,t,i){this.i=n;this.d=t;this.a?this.a.p(null):this.B(this.A(null));var r=this.a.u();if(r){r.b("");r.C(this.i)}else this.a.apcl("FindRecipientViewModel",this.j);this.g=i},s:function(n,t,i,r){this.d=i;this.m=t;if(i){this.a?this.a.p(n):this.B(this.A(n));var u=this.a.u();if(u){!_js.d.a(u.a())&&_js.d.a(t)&&u.b(t);_js.d.a(t)||u.b(t)}else this.a.apcl("FindRecipientViewModel",this.j);this.g=r}else this.b?this.b.p(n):this.L(this.C(n))},r:function(){$a(this.a)||this.a.bP()},q:function(){this.a&&this.a.bf()},u:function(){if(!$a(this.a)&&this.a.u().z())if(this.a.u().bd()){this.a.cu(!0);this.a.cu(!1)}else{this.a.cw(!0);this.a.cw(!1)}},f:function(){var n;n=this.d?$a(this.a)?0:!this.a.u()||_js.d.a(this.a.u().a())?this.a.v.w.length:this.a.v.w.length+1:$a(this.b)?0:this.b.c().w.length;return n},t:function(){if(this.a){for(var f="",u="",r="",i,n,t=0,o=this.a.t.w.length;t<o;t++){i=this.a.t.w[t];if(i&&!i.i){n=this.a.v.w[t];if(n){u=_js.d.b(n.Name)?"":n.Name;f=_js.d.b(n.EmailAddress)?"":n.EmailAddress;var e=String.format("( {0} , {1} ),",u,f);r+=e}}}r!==""&&_js.Trace.logInfo(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.g,r)}},bu:function(){if(!$a(this.a)){this.a.cd(!1);this.a.dispose();this.a=null}},A:function(n){return this.n.b(_mcp.u.a,_pe.c.b,n,!0,!0)},C:function(n){return this.n.a(_mcp.u.b,_bc.f.a,n,2)},H:function(n,t){var r=n;var i=r.u();if(this.i&&this.i.w.length>0){i.b("");i.C(this.i)}_js.d.b(this.m)||i.b(this.m);r.rpcl("FindRecipientViewModel",this.j)},G:function(){if(this.d&&!OwaApplication.b)if(this.D()){_js.Trace.logInfo(_a.a.a,"User chose to launch the new people picker");_a.l.a.c("VM.PeoplePicker.Launched",_a.c.a());var n=_a.d.b(_a.a.bl,"LaunchV2PeoplePicker");_a.d.a(n);this.l.cH(this.z,this.w,this.g)}else{_js.Trace.logInfo(_a.a.a,"User chose to launch rich people picker");this.a.bf();_a.l.a.c("VM.PeoplePicker.Launched",_a.c.a());_a.k.b(_a.a.bl,"PeoplePicker",!0);this.l.cG(this.a.t,this.g,this.y)}},I:function(n){this.a&&this.a.u().bp(n)},K:function(n){var t=n;t.a()&&(_a.F.a(_g.n.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.m(t):this.a.bc(t))},J:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.t.g();var t=this;n.u(function(n){var i=n;i.i?t.a.m(i.h):t.a.bc(i.h)})},p:function(n){var u=this.a.t;var r=null;if(this!==n)for(var t=0;t<u.w.length;t++){var i=u.w[t];if(i.v){r=i;this.a.R(i);break}}return r}};_mcp.z=function(n,t,i){this.Q=Function.createDelegate(this,this.bn);this.R=Function.createDelegate(this,this.bo);this.W=Function.createDelegate(this,this.bf);this.X=Function.createDelegate(this,this.bg);this.S=Function.createDelegate(this,this.bp);this.i={};_mcp.z.initializeBase(this,[8,n]);this.A=t;this.B=new _C(this.S,this.G());this.u=n.a.bt;this.y=i};_mcp.z.prototype={u:null,B:null,y:null,m:!1,k:!1,q:!1,s:null,o:!1,n:null,r:null,v:null,A:null,j:null,d:function(){return this.B},a:function(){return this.m},M:function(n){if(n!==this.m){this.m=n;this.bt("IsSaving")}return n},bq:function(n){if(n!==this.v){this.v=n;this.bt("DraftSavedTime")}return n},f:function(){return this.o},h:function(n){this.o=n;return n},e:function(){return this.k},c:function(n,t){var i=this.D;var f=i.b(5);var u=i.a.T;var r=i.a.L;_js.Trace.logInfo(_a.a.a,"UserInitiatedSave - SaveStart:Context:{0}",r);i.a.P().a("Save");this.P();if(!r.bz()){_js.Trace.logInfo(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_js.Trace.logInfo(_a.a.a,"Skip save and show attachment in progress dialog");u.j||u.a(0,_u.R.NG,null);return}this.k=!0;this.b("Save",n,t,!1)},C:function(){this.K();_mcp.P.prototype.C.call(this)},K:function(){if(this.E.bH()&&!this.j){_js.Trace.logInfo(_a.a.a,"Setting save component override");this.j=this.E.bG().d();var n=this.D.b(27);this.j.b(this.X,this.W,n.b,n.a)}},J:function(){if(this.j){this.j.a();this.j=null}},b:function(n,t,i,r){if(this.j&&!this.j.c()){_js.Trace.logInfo(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var o=this.D;var s=o.a;var u=s.L;var h=s.M;var f=u.b();var a=this.D.b(5);var c=o.b(7);if(c.j&&!r){_js.Trace.logInfo(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.u.a(f)){_js.Trace.logInfo(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.i={};return!1}var e=o.b(1);e.cN();if(_g.a.a().bl.MaxRecipientsPerMessage<e.cr()){h.a(800,null);this.E.N();return!0}this.E.L.Q()&&this.E.bo().a(new _cmc.X);e.B();u.bT().a();this.i[n]=new _mcp.bu(t,i);if(!this.m||r){this.s=_mcp.b.b(u);this.M(!0)}else{this.q=!this.s.t(u);return!0}if(!u.g()&&!u.h()&&!u.G()){_js.Trace.logInfo(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}_a.s.stPT(_a.a.a,"MailComposeSave",5);this.n=_y.k.b(_a.a.a,"MailComposeSave",!0);this.r=n;_js.g.a().j(_a.a.a,"MailComposeSave");_js.Trace.logInfo(_a.a.a,"Started new task runner context before starting save.");try{this.j?this.j.d(n):this.bg(n);return!0}catch(l){this.bf(l);throw l;}},H:function(){this.m=!1;this.q=!1;this.k=!1;this.o=!1;this.i={};this.s=null;this.J();_mcp.P.prototype.H.call(this)},g:function(){this.m=!1;this.q=!1;_js.Trace.logInfo(_a.a.a,"ResumeSave:Context:{0}",this.D.a.L);var i=this.i;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.b(n.key,t.a,t.b,!0);break}},U:function(n){return _y.t.c(n.s,40,50,60,700,88,89,43,57)},bc:function(n){if("ReadingPaneExit"in this.i||"Popout"in this.i){var u=this.D.a;var t=u.M;var r=this.U(n);var e=new _y.df;var i=e.a(r,null);t.e(_mcp.k.b);"ReadingPaneExit"in this.i?t.a(87,i):t.a(85,i);if(r===50){var f=this;u.bK.a(function(n){n.a(t);f.E.N()})}else this.E.N()}else"Save"in this.i&&_mcp.P.prototype.bc.call(this,n)},bg:function(n){_js.Trace.logInfo(_a.a.Y,"Setup save action, context:{0}; OriParentFolderId={1}",this.F,this.F.e()&&this.F.e().bl.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.F.e().bl.ParentFolderId):"null");var t=this.E.bu.d(this.E,0,this.y);if((_h.l.isInstanceOfType(t)||_h.n.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.F.l()){var i=t;i.Q=new _g.T(new _g.B("internalsubmission"))}this.E.U.a(t,this.R,this.Q,null);_js.Trace.logInfo(_a.a.a,"Save action submitted")},bp:function(){this.D.a.P().a("Save");this.c(null,null)},bf:function(n){this.M(!1);this.k=!1;var t=n.toString();_y.k.a(this.n,null,t,null,this.z(this.r,n.message));this.n=null;_a.s.endPT("MailComposeSave");_js.Trace.logWarning(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},be:function(n){var o=this.D;var u=o.a;var f=u.L;var t=n.I;var r=!1;if(this.u.a(t)){f.b()===t&&(this.i={});this.p(n);var e=_mcp.R.a(n);if(e){_js.Trace.logInfo(_a.a.a,"Resume discard for context {0}",t);u.bh().b(t,e)}r=!0}else if(t===f.b()){if(this.o){this.o=!1;_js.Trace.logInfo(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.i={};this.p(n);var i=null;_h.o.isInstanceOfType(n)?i=n.d:_h.n.isInstanceOfType(n)&&(i=n.k);i&&f.E(i);var s=o.b(7);s.o();r=!0}else if(this.q){_js.Trace.logInfo(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.g();r=!0}}else _js.Trace.logInfo(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,u.L.b());return r},bo:function(n){var e=this.D;var r=e.a;var u=r.L;var h=r.bh();var f=n.I;_js.Trace.logInfo(_a.a.a,"Save action returned success, ContextId={0}; Context:{1}",f,u);if(!this.be(n)&&f===u.b()){this.bm(n);this.bb();var i=!1;var t=null;if("Attach"in this.i){if("AutoSave"in this.i){t=this.i.AutoSave;t&&t.a(n)}t=this.i.Attach}else if("Popout"in this.i){t=this.i.Popout;var o=r.b();if(o&&o.j()&&"ReadingPaneExit"in this.i){t&&t.a(n);t=this.i.ReadingPaneExit}}else if("ReadingPaneExit"in this.i)t=this.i.ReadingPaneExit;else if("AutoSave"in this.i){t=this.i.AutoSave;i=!0}else if("Save"in this.i){t=this.i.Save;i=!0}else"Diagnostics"in this.i&&(i=!0);t&&t.a&&t.a(n);if(i){var s=e.b(5);s.s()}this.i={}}_y.k.a(this.n,null,"",this.ba(n),this.z(this.r,""));this.n=null},bb:function(){var i="";var t=this.i;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_js.Trace.logInfo(_a.a.a,"ProcessorKeys:{0}",i)},bn:function(n){var o=this.D.a.L;var e=n.I;_js.Trace.logInfo(_a.a.a,"Save action returned a failure, ContextId={0}; Context:{1}",e,o);if(!this.be(n)&&e===o.b()){this.bb();var t=!1;var h=this.i;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.b){u.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.Z(n);t=!0}}else if(!t){this.Z(n);t=!0}}t||this.p(n);this.i={}}var r="SaveFailure_UnknownError";var f="";if(_g.X.a(n.s)){r=_g.X.b(n.s)||"SaveFailure_UnknownError";f=n.s.FaultMessage}_y.k.a(this.n,null,r,this.ba(n),this.z(this.r,f));this.n=null},bm:function(n){var f=this.D;var t=f.a;var i=t.L;var e=n.I;var h=this.k;if(e===i.b()){this.br(n);i.cj(!1);t.df()}this.co("MailSaveSucceeded");if(e===i.b()){var s=_a.c.a();var r=s.a(0);this.bq(String.format(_nbs.a.Yq,r));if(h&&!t.bg()){var u=t.M;u.e(_mcp.z.a);u.a(1001,r);this.E.N()}}if(_a.bm.a){var o=f.b(23);o.a(this.k?4:2)}this.p(n)},Z:function(n){_js.Trace.logInfo(_a.a.a,"SaveActionFailed: Error: {0}",n.s.message);n.I===this.D.a.L.b()&&this.bc(n);var t=this.D.a;t.bj&&t.D(!1);this.p(n)},p:function(n){var i=this.D;var t=i.a.L;if(n.I===t.b()){this.M(!1);this.k=!1}_a.s.endPT("MailComposeSave")},ba:function(n){var t=null;_h.o.isInstanceOfType(n)&&n.B?t=n.B.correlationId:_h.n.isInstanceOfType(n)&&n.B&&(t=n.B.correlationId);return t},z:function(n,t){var i=new _a.u;i.b("Ctx",n||"");i.b("Err",t||"");return i.toString()},br:function(n){var t=this.D.a.L;t.eA(this.s);if(this.k){t.eY(!0);this.k=!1;_js.Trace.logInfo(_a.a.a,"Explicit save recorded. ContextId={0}",t.b())}if(_h.l.isInstanceOfType(n)){var u=n;var r=u.d;u.c.bL(r);t.E(r);t.dc(u.c);_js.Trace.logInfo(_a.a.a,"Updated context from create action. Context:{0}",t.toString());this.A.y(r)}else if(_h.n.isInstanceOfType(n)){var i=n;var s=i.k;i.a.bL(s);t.E(s);t.dc(i.a);_js.Trace.logInfo(_a.a.a,"Updated context from update action. Context:{0}",t)}else if(_h.O.isInstanceOfType(n)){var y=n;var v=y.d;t.E(v);_js.Trace.logInfo(_a.a.a,"Updated context from create response action. Context:{0}",t)}else if(_mcp.A.isInstanceOfType(n)){var p=n;var b=p.a.d;t.E(b);_js.Trace.logInfo(_a.a.a,"Updated context from create response from modern group action. Context:{0}",t)}else if(_cc.bx.isInstanceOfType(n)){var e=n;var w=e.meetingResponseMessageId;t.E(w);t.dc(e.c);_js.Trace.logInfo(_a.a.a,"Updated context from create meeting response message. Context:{0}",t)}else if(_c.v.isInstanceOfType(n)){var a=n;var c=a.d;t.E(c);_js.Trace.logInfo(_a.a.a,"Updated context from create approval response action. Context:{0}",t)}if(_h.o.isInstanceOfType(n)&&t.ba()){var l=n;var f=l.bs;var o=t.ba().dO();if(f&&o){var h=0;var k=this;o.u(function(n){var t=n;t.g(f[h]);h++});_js.Trace.logInfo(_a.a.a,"Attachment IDs have been updated.")}}}};_mcp.q=function(n,t){this.d=Function.createDelegate(this,this.h);_mcp.q.initializeBase(this,[18,n]);this.c=t};_mcp.q.b=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.q.prototype={c:null,a:function(){return this.dS(_mcp.q.a)},e:function(n){this.dR(_mcp.q.a,n);return n},C:function(){if($a(this.a())){var n=this.g(_mcp.q.b);if(n){this.e(new _fm.f(n));this.a().bK(new _C(this.d,this.G()))}}_mcp.P.prototype.C.call(this)},H:function(){this.a()&&this.e(null);_mcp.P.prototype.H.call(this)},f:function(n,t){if(this.a()){for(var u=_mcp.q.b(n,new _C(this.b(n),this.G())),i=this.a().h,r=i.w.length-1;r>0;r--)if(_fm.j.isInstanceOfType(i.w[r])){i.r(r+1,u);var f=i.w.length-r-1;f>t&&i.n(i.w.length-1);return}i.a(new _fm.j);i.a(u)}},h:function(){if(this.a()&&this.a().k){var f=this.a().k;var r=_g.a.a().a().bL();var e=r.q(f.j);if(e){for(var n=this.a().h,t=n.w.length-1;t>0;t--)if(n.w[t].j===f.j){n.n(t);var u=n.w.length;_fm.j.isInstanceOfType(n.w[u-1])&&n.n(u-1);break}var i=new(_a.gb.$$(String));r.b()>0?i.B(r):i.e("");_g.a.a().a().cS(i);_h.g.a(_g.a.a().a().u,OwaApplication.a)}}},g:function(n){var a=_g.a.a().c().m();var p=$a(a)?0:a.b();var f=_g.a.a().a().bL();var u=$a(f)?0:f.b();if(u===1&&f.a(0)===""){f.m(0);u=0}var k=u>0?1:0;var l=_g.a.a().c().a();var w=this.c.c()&&!$a(l)?l.b():0;var v=_g.a.a().c().h();var b=this.c.c()&&!$a(v)?v.b():0;var i=new Array(1+p+u+k+w+b);var r=0;var t=_g.a.a().c().bl.UserEmailAddress;i[r++]=n(t,new _C(this.b(t),this.G()));if(this.c.c()){for(var e,c=0;c<w;c++){e=l.a(c);t!==e&&(i[r++]=n(e,new _C(this.b(e),this.G())))}for(var o=0;o<b;o++){var h=v.a(o);t!==h&&(i[r++]=n(h,new _C(this.b(h),this.G())))}}for(var s=0;s<p;s++){t=a.a(s).EmailAddress;i[r++]=n(t,new _C(this.b(t),this.G()))}if(u>0){i[r++]=new _fm.j;for(var y=0;y<u;y++){t=f.a(y);i[r++]=n(t,new _C(this.b(t),this.G()))}}return i},b:function(n){var t=this;return function(){_js.Trace.logInfo(_a.a.a,"User chose from={0}",n);t.D.a.R().A(n,!0)}}};_mcp.o=function(n,t,i,r){this.S=Function.createDelegate(this,this.bB);this.X=Function.createDelegate(this,this.bJ);this.be=Function.createDelegate(this,this.bQ);this.W=Function.createDelegate(this,this.bI);this.p=Function.createDelegate(this,this.bH);this.v=Function.createDelegate(this,this.bF);this.Q=Function.createDelegate(this,this.bo);this.R=Function.createDelegate(this,this.bp);this.bf=Function.createDelegate(this,this.bS);this.bg=Function.createDelegate(this,this.bV);this.t=Function.createDelegate(this,this.bi);this.Z=Function.createDelegate(this,this.o);this.ba=Function.createDelegate(this,this.bK);this.bb=Function.createDelegate(this,this.bM);_mcp.o.initializeBase(this,[7,n]);this.h=new _C(this.bb,this.G());this.w=new _C(this.ba,this.G());this.y=n.a.bt;this.z=t;this.q=i;this.i=r};_mcp.o.prototype={y:null,w:null,z:null,q:null,i:null,N:null,M:null,h:null,j:!1,s:!1,r:null,l:null,n:null,k:null,u:!1,B:!1,g:null,bz:function(){return this.g?this.g.c():null},a:function(){return this.h},e:function(n){this.h=n;return n},b:function(){return this.j},m:function(n){if(n!==this.j){this.j=n;this.bt("IsSending");var t=this.D.a;t.de(_u.P.M);t.dd(n)}return n},d:function(){return this.A()&&this.B},A:function(){return this.q.a().be().Enabled&&this.E.V.a()==="Mouse"&&!this.E.bF()&&!this.F.r()&&!!this.E.by&&!!this.E.bC&&this.F.n()!==3},c:function(){return this.n},K:function(){if(this.E.bH()&&!this.g){_js.Trace.logInfo(_a.a.a,"Setting send component override");this.g=this.E.bG().e();var t=this.D.b(27);var n=this.D.b(1);this.g.d(this.E.s(),this.Z,this.t,this.bg,this.bf,this.R,this.Q,this.E.U,this.D.a.bM,n.cd,n.cc,n.ca,n.bZ,t.b,t.c,t.a)}},J:function(){if(this.g){this.g.a();this.g=null}},C:function(){this.K();var n=this.D.b(1);if(n){n.ds(this.v);n.dr(this.t);n.cA(this.v);n.cz(this.t)}_mcp.P.prototype.C.call(this)},H:function(){this.m(!1);this.J();_mcp.P.prototype.H.call(this)},o:function(){var u=this.D;var i=u.a;var n=i.L;var r=i.d();u.b(23).d();if(r.a()){r.h(!0);_js.Trace.logInfo(_a.a.a,"Send deferred due to in progress save.")}if(n.g()||n.h()||n.G()){if(!r.f()){var o=this.D.b(1);o.B();_js.Trace.logInfo(_a.a.a,"Send without pending saves, context:{0}; OriParentFolderId={1}",n,n.e()&&n.e().bl.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.e().bl.ParentFolderId):"null");var t=i.bu.d(i,1,this.z);_js.Trace.logInfo(_a.a.a,"Submitting send action");var f=_g.k.a;_bc.k.isInstanceOfType(f)?_h.n.isInstanceOfType(t)?t.bD(this.p):_h.l.isInstanceOfType(t)&&t.W(this.p):this.bq();i.U.a(t,this.bp(),this.bo(),this.W);_js.Trace.logInfo(_a.a.a,"Send action submitted")}}else{var e=n.b();_js.Trace.logInfo(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",e)}},bi:function(){var i=this.D.a.M;var t=this.D.a.R();var n=null;this.m(!1);if(t.c.c()||t.d.c()||t.e.c()){i.a(65,null);n=_js.l.b(_bc.InfoBarMessageId,65);this.i.a(_a.bE,new _a.bE(_u.R.aB))}if(t.W()){i.a(66,null);n=_js.l.b(_bc.InfoBarMessageId,66)}this.E.N();this.bm();n=n||"CancelSend_UnknownError";this.f(n,null,null)},bm:function(){var n=this;_js.g.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.s=!1},2e3)},bh:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bl.UserEmailAddress&&!_h.l.e(n)){var i=_g.a.a().a().bL();if(!$a(i)){if(i.j(r))return;i.b()===1&&i.a(0)===""&&i.m(0)}var t=new(_a.gb.$$(String));t.e(r);t.B(i);t.b()>_mcp.o.a&&t.m(t.b()-1);_g.a.a().a().cS(t);_h.g.a(_g.a.a().a().u,OwaApplication.a);var u=this.D.b(18);u.f(r,_mcp.o.a)}}},U:function(n){var t;var i=_a.b.l(n.s);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.bW(n.s,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:_y.t.c(n.s,45,55,62,700,88,89,46,58))}return t},bp:function(){return this.N||this.be},bo:function(){return this.M||this.X},bV:function(n){this.N=n},bS:function(n){this.M=n},bW:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.Q.b(i)==="Value"&&_a.Q.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.Q.a(i))){t.val=48;return!0}}t.val=-1;return!1},bM:function(){if(this.g&&!this.g.e()){_js.Trace.logInfo(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.s.stPT(_a.a.a,"MailComposeSend",5);this.u=!0;this.l=_y.k.b(_a.a.a,"MailComposeSend",!0);if(this.A()){this.n=_y.k.b(_a.a.a,"MailComposeSendAsync",!0);if(_mcp.f.isInstanceOfType(this.E)){var n=this.E;_g.q.isInstanceOfType(this.F.e())&&n.bl&&(this.k=_y.k.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0))}}_js.Trace.logInfo(_a.a.a,"SendStart:Context:{0}",this.F);this.P();this.F.F()?this.bG():this.bs();this.E.P().a("Send")},bG:function(){var n=this;var t=function(t){n.f(_js.l.b(_bc.InfoBarMessageId,t),null,null);n.F.fB(null);n.bi();t!==-1&&n.bT(_u.R.KX,t)};if(this.F.eS())this.bv(t);else{var i=this;this.E.dA().i(13,function(n){if(i.F.fB(n))i.bv(t);else{t(-1);_js.Trace.logWarning(_a.a.g,"The send is canceled due to unavailable cert.")}})}},bv:function(n){var t=new _h.ck(200,this.F.eS(),!0);var i=this,r=this;this.D.a.U.a(t,function(){_js.Trace.logInfo(_a.a.g,"Retrieving certs info completed.");if(t.A.IsValid)i.bs();else{_js.Trace.logWarning(_a.a.g,"Retrieving certs info determined the certificate is INVALID.");switch(t.A.ChainValidityStatus){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){_js.Trace.logWarning(_a.a.g,"Retrieving certs info failed. "+t.s.message);n(743)},null)},bs:function(){_js.Trace.logInfo(_a.a.a,"User chose to send, start force resolve recipients");this.s=!0;var n=this.D.b(1);n.ct(!0)},bF:function(){if(this.j){_js.Trace.logInfo(_a.a.a,"Skip send since another send is in progress");return}this.m(!0);this.s=!0;_js.g.a().j(_a.a.a,"MailComposeSend");_js.Trace.logInfo(_a.a.a,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.bE(i={val:n}),n=i.val,t)?n?_js.Trace.logInfo(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.O():this.m(!1);r=!1}finally{if(r){this.m(!1);_js.Trace.logWarning(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.f("SendFailure_UnhandledException",null,null)}}},O:function(){this.F.fu(!1);if(this.E.L.Q()){this.F.ch(new _cmc.Q);this.F.gh(this.F.cA().b)}if(this.g)this.g.b();else{this.o();var n=!1;if(this.A()&&!this.F.eG()){if(this.E.bC.b()){var i=this;this.E.bC.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.E.by.b()){var r=this;this.E.by.a(function(t){t.a()>0&&(n=!0)})}if(!n){_js.Trace.logInfo(_a.a.a,"Navigating away after submitting action for send via notification");this.F.fu(!0);this.B=!0;this.br();this.bq();var t=this;this.E.by.a(function(){t.i.a(ISendEvent,new _mcp.bw(t.E))})}}}},bq:function(){if(_mcp.f.isInstanceOfType(this.E)&&_g.q.isInstanceOfType(this.F.e())&&this.F.bW()){var n=this.E;if(n.bl&&n.bz){var u=this.F.e();var r=_cmc.j.b(n.bl.bl,n.bz,this.F.k()||this.F.bo(),this.F.bo(),"sentitems");var f="MC:"+r.InternetMessageId;this.i.a(_a.bV,new _a.bV(f,this.F));_h.d.z(r,u.bl.InternetMessageId,n.bS?u:null);var i="OMC:"+n.bl.bl.ConversationId.Id;var t=n.cl.c[i];if(t)t.d.c(n.bz.bl.InternetMessageId);else{t=new _cmc.R(n.bz.bl.InternetMessageId);this.i.a(_a.bV,new _a.bV(i,t))}if(this.k){_y.k.a(this.k);this.k=null}}}},bE:function(n){n.val=!1;var f=this.D;var r=f.a;var t=f.b(1);var o=f.a.Q();var u=r.M;var h=f.b(23);if(this.y.a(r.L.b())){_js.Trace.logInfo(_a.a.a,"User had already discarded, skipping send.");this.f("InvalidToSend",null,"User has already discarded, skipping send");return!1}else if(t.W()){_js.Trace.logInfo(_a.a.a,"Not valid to send since sender's address is invalid");u.a(66,null);this.E.N();this.f("InvalidToSend",null,"Sender's address is invalid, not valid to send");return!1}else if(!r.L.l()&&t.c.h()&&t.d.h()&&t.e.h()){_js.Trace.logInfo(_a.a.a,"Not valid to send since no recipients were specified");u.a(70,null);this.E.N();this.f("InvalidToSend",null,"No recipients were specified, not valid to send");return!1}else if(t.c.c()||t.d.c()||t.e.c()){_js.Trace.logInfo(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.W(),t.c.c(),t.d.c(),t.e.c());t.dh();u.a(65,null);this.E.N();this.f("InvalidToSend",null,"Invalid recipients are present, not valid to send");return!1}else if(o.b()){_js.Trace.logInfo(_a.a.a,"Not valid to send since attachment is in progress");var c=r.T;c.a(0,_u.R.NG,null,!1,null,null,null,c.u);this.f("InvalidToSend",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bl.MaxRecipientsPerMessage<t.cr()){u.a(800,null);this.E.N();this.f("InvalidToSend",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.bm.a&&h.c()){_js.Trace.logInfo(_a.a.a,"Not valid to send since policy violation detected");var l=r.T;l.a(0,h.b(),null,!1,null,null,null,l.u);this.f("InvalidToSend",null,"PolicyTip violation detected, not valid to send");return!1}else if(_js.d.a(this.E.L.z())){n.val=!0;var s=r.T;s.b(2,[_nbs.a.QR],this.S,!1,_nbs.a.RO,_nbs.a.HY,_nbs.a.JU,s.u,null);return!1}else if(o&&o.a()&&this.E.bW)if(this.r)return this.bj();else{n.val=!0;var i=this;this.E.bW.a(function(n){i.r=n.a(i.E.T,i.h);i.bj()?i.O():i.m(!1)})}else if(this.F.r())if(this.F.i()){_a.S.a(_u.R.Hc,0);this.f("InvalidToSend",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.cS()){_a.S.a(_u.R.Pq,0);this.f("InvalidToSend",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.F.B()){var e=new _ff.e;var a=this;this.F.B().u(function(n){_g.l.isInstanceOfType(n)||_g.x.isInstanceOfType(n)||_g.A.isInstanceOfType(n)||e.c(n.bl.Name)});if(e.d.length>0){_a.S.a(String.format(_u.R.Qx,e.d.join(", ")),0);this.f("InvalidToSend",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},bj:function(){var n=this.E.Q();try{if(this.r.a(this.E.L,n.a().b())){this.f("InvalidToSend",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_js.Trace.logException(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.r,this.E.L,n.a().b())}return!0},bQ:function(n){var s=this.D;var i=s.a;var t=i.L;var r=n.I;_js.Trace.logInfo(_a.a.a,"Send action succeeded, ContextId={0}; Context:{1}",r,t);this.bR();var u=!1;var h=_g.k.a;_bc.k.isInstanceOfType(h)&&(u=!0);t.S()&&!u&&this.bh(t.k());if(t.ek&&t.ek.length>0){var c=this.D.a.M;c.a(742,t.ek);_js.Trace.logInfo(_a.a.a,"Showing infobar message for Bcc forking failed");this.m(!1);i.U.d(n);this.f(_js.l.b(_bc.InfoBarMessageId,742),null,null)}else{if(r===t.b()){t.eA(null);if(this.F.bW()){_js.Trace.logInfo(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.E.by.a(function(){f.i.a(ISendSucceededEvent,new _mcp.by(i))});this.F.fn()}else{_js.Trace.logInfo(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",r);this.br()}}else _js.Trace.logInfo(_a.a.a,"Context does not match, skipping navigating away from compose.");this.co("MailSendSucceeded");var e=!i.Q()||!i.Q().a()?null:i.Q().a().bt();var o=this.bn(t,null,e);this.bx(o)}this.i.a(_a.bE,new _a.bE(_nbs.a.CM))},br:function(){this.E.b().b(this.E,!0)},bJ:function(n){var r=this.D.a;var t=r.L;var f=n.I;_js.Trace.logInfo(_a.a.a,"Send action failed, ContextId={0}; Context:{1}",f,t);var i="SendFailure_UnknownError";var u="";if(_g.X.a(n.s)){i=_g.X.b(n.s);u=n.s.FaultMessage}if(f===t.b()){if(t.ek&&t.ek.length>0){var o=this.D.a.M;o.a(65,t.ek)}this.m(!1);_js.Trace.logInfo(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",i);this.bc(n);if(this.F.bW()){_js.Trace.logInfo(_a.a.a,"Raise send failed event for send via notification");t.ge(this.U(n));var e=this;this.E.bC.a(function(){e.i.a(ISendFailedEvent,new _mcp.bx(r))});t.fn()}}else _js.Trace.logInfo(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",i);this.f(i,this.bA(n),u);r.U.d(n)},bI:function(n){this.bl();this.bD()?this.i.a(_y.cY,new _y.cY(32)):this.bC()&&this.i.a(_y.cY,new _y.cY(64))},bD:function(){return this.q.a().bV().Enabled||_a.A.e(window.location.href,"survey")==="1"?!0:!1},bC:function(){return this.q.a().bU().Enabled||_a.A.e(window.location.href,"survey")==="2"?!0:!1},bA:function(n){var t=null;_h.o.isInstanceOfType(n)&&n.B?t=n.B.correlationId:_h.n.isInstanceOfType(n)&&n.B&&(t=n.B.correlationId);return t},bK:function(){this.D.a.cU()&&this.h.b&&this.h.a()},bR:function(){var t=this.E.R();var n=this.E.Q();_js.Trace.logInfo(_a.a.a,"Check to see if we have attachments to set permissions for");n.a()&&n.a().z()&&n.a().bd(t.da())},bn:function(n,t,i){var r;if(n){var e=n.d()==="HTML"?"html":"text";var f;f=n.a()===1||n.a()===2||n.a()===3?n.g()?"yes":"no":"na";var u=new _a.u;u.b("BT",e);u.b("U",f);n.eu!==-1&&u.a("S",n.eu);u.a("O",n.a());_js.d.a(t)||u.b("E",t);r=u.toString()}else r=null;r?i&&(r=r+"|"+i):r=i;return r},f:function(n,t,i){var r=this.bn(this.F,i,null);if(this.l){_y.k.a(this.l,null,n,t,r);this.l=null}if(this.n){_y.k.a(this.n,null,n,t,r);this.n=null}this.bk(n,t,r);this.bl()},bx:function(n){if(this.l){_y.k.a(this.l,null,null,null,n);this.l=null}this.bk(null,null,n)},bl:function(){if(this.u){_a.s.endPT("MailComposeSend");this.u=!1}},bk:function(n,t,i){if(this.k){if(this.F.bW()){_js.Trace.logError(this.G(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.k.a(this.k,null,n,t,i);this.k=null}},bB:function(n,t){n?this.O():this.f("MissingSubject_NotSent",null,'No subject was specified, and user chose "Don\'t Send"')},bH:function(n){var i=this.D;var r=i.a;var t=r.L;_h.l.isInstanceOfType(n)&&n.l(this.p);_h.n.isInstanceOfType(n)&&n.bC(this.p);t.S()&&this.bh(t.k())}};_mcp.bp=function(n){this.c=Function.createDelegate(this,this.g);this.b=Function.createDelegate(this,this.h);this.a=Function.createDelegate(this,this.f);_mcp.bp.initializeBase(this,[27,n])};_mcp.bp.prototype={g:function(n,t){this.bT(n,t)},f:function(n){this.T(n)},i:function(n,t){var e=this;var f=function(i){_js.Trace.logWarning(_a.a.g,i.message);if(_a.I.b(i)){_a.I.c(i,n);e.T(i);t(null)}else{_a.j.i(i,"An error occurred when choosing cert.");throw i;}};try{var i=_a.j.r(!0,!0,!1,!1,!1);if(i)if(_a.I.d(i))this.T(i);else throw i;_js.Trace.logInfo(_a.a.g,"S/MIME choosing a cert...");var r;var u=_g.a.a();r=u.bl.SmimeAdminSettings.AllowUserChoiceOfSigningCertificate&&u.a().bl.ManuallyPickCertificate?u.a().bl.SigningCertificateId:null;_js.Trace.logInfo(_a.a.g,"Choosing a cert. KeyIdentifier={0}",r);var s=this;_a.j.b.f(r,function(n){var i=JsonParser.deserialize(n);i.ErrorCode?f(_a.I.a("No certificate was found.",i.ErrorCode)):t(i.Data)})}catch(o){f(o)}},h:function(n,t,i,r){var h=_g.a.a().bl.SmimeAdminSettings;var c=_g.a.a().a();var p=this.l(t,this.F.F(),this.F.u());p=p||"SMIMEComposeUndefinedCtq";var e=_a.d.b(_a.a.g,p);var tt=this.F.a();var nt=this.F.n();var y=h.AlwaysSign;var w=h.AlwaysEncrypt;var b=c.bl.SmimeSign;var v=c.bl.SmimeEncrypt;var l=h.ClearSign;var o=h.TripleWrapSignedEncryptedMail;var ht=this;var st=function(n){if(e){e.j=ht.d(tt,nt,y,w,b,v,l,o);_a.d.a(e)}$a(i)||i(n)};var ot=this;var it=function(n){if(e){e.j=ot.d(tt,nt,y,w,b,v,l,o);e.k=n.message;_a.d.a(e)}$a(r)||r(n)};try{_js.Trace.logInfo(_a.a.g,"Building S/MIME data package...");_js.Trace.logInfo(_a.a.g,"Admin.AlwaysEncrypt="+w);_js.Trace.logInfo(_a.a.g,"Admin.AlwaysSign="+y);_js.Trace.logInfo(_a.a.g,"Admin.IsClearSign="+l);_js.Trace.logInfo(_a.a.g,"Admin.TripleWrap="+o);_js.Trace.logInfo(_a.a.g,"User.AlwaysEncrypt="+v);_js.Trace.logInfo(_a.a.g,"User.AlwaysSign="+b);_js.Trace.logInfo(_a.a.g,"User.SigningCert="+c.bl.SigningCertificateSubject);_js.Trace.logInfo(_a.a.g,"User.SigningCertId="+c.bl.SigningCertificateId);_js.Trace.logInfo(_a.a.g,"Context.Encrypt="+this.F.u());_js.Trace.logInfo(_a.a.g,"Context.Sign="+this.F.F());var f;if(t===2&&this.F.u()){var u=this.E.R();var d=u.f?u.c.a.v:u.c.b.c();var g=u.f?u.d.a.v:u.d.b.c();var k=u.f?u.e.a.v:u.e.b.c();var at=d?d.w.length:0;var lt=g?g.w.length:0;var ct=k?k.w.length:0;var a=at+lt;f=this.F.ei?this.F.ei===1?this.F.ey(0,a):this.F.ei===2?this.F.ey(a+this.F.ex,1):this.F.ei===3?this.F.ey(a,ct):null:this.F.cL()}else f=null;var rt=this.j();var et=JsonParser.serialize(rt.bl);var ft=f?JsonParser.serialize(f):null;var s;if(!this.F.F()&&this.F.u())s=6;else if(this.F.F()&&!this.F.u())s=l?11:10;else if(this.F.F()&&this.F.u())s=o?14:12;else throw Error.invalidOperation("The context is not in S/MIME mode.");var ut=this;_a.j.b.i(s,et,ft,this.F.eS(),function(t){ut.k(t,n,st,it)})}catch(vt){this.e(vt,it)}},j:function(){var n=new _g.q;n.ck(this.F.fi());n.w().a()==="HTML"&&n.w().b(_a.J.f(n.w().bl.Value,!0));this.m(n,this.E.Q().a().b());n.cF(new _g.bh);n.bl.From.Mailbox=this.F.ce();if(!n.bl.From.Mailbox){var t=_g.a.a().c();n.bl.From.Mailbox=new _g.d;n.bl.From.Mailbox.Name=t.bl.UserDisplayName;n.bl.From.Mailbox.EmailAddress=t.bl.UserEmailAddress||t.bl.LogonEmailAddress;n.bl.From.Mailbox.MailboxType="Mailbox";n.bl.From.Mailbox.RoutingType="SMTP"}n.ce(new(_a.gb.$$(_g.d)));this.F.j()&&n.k().g(this.F.j().f());n.ct(new(_a.gb.$$(_g.d)));this.F.q()&&n.m().g(this.F.q().f());n.bQ(this.F.A());n.dp(this.F.bb());n.cN(this.F.D());n.hZ(_a.c.a());n.cP(this.F.bd());n.cO(this.F.bc());if(n.fa(this.F.bw())){n.fM(this.F.fl());n.eX(this.F.eN());n.eV(this.F.cx());n.eW(this.F.cy())}return n},m:function(n,t){if(t&&t.w.length){var i=new(_a.gc.$$(_g.Attachment,_g.bN));var f=new _ff.e;var s=this;t.u(function(t){var o=t;var r=o.a();if(r.q()){_js.Trace.logInfo(_a.a.g,"Skipping SmimeDataPackage.");return}if(!(_g.l.isInstanceOfType(r)||_g.x.isInstanceOfType(r)||_g.A.isInstanceOfType(r))){_js.Trace.logWarning(_a.a.g,"S/MIME only supports FileAttachment, ItemAttachment, and ItemIdAttachment. The attachment {0} is ignored.",r.bl.Name);return}if(n.w().a()==="HTML"&&r.b()&&n.w().bl.Value.indexOf(r.bl.ContentId)<0){_js.Trace.logInfo(_a.a.g,"Removing unreferenced inline attachment: {0}",r.bl.ContentId);f.c(o);return}if(_g.A.isInstanceOfType(r)){var e=r;var u=new _g.x;u.e(e.bl.Name);u.j(e.bl.ContentType||"message/rfc822");u.h(e.a());u.p(e.bl.MimeContent);i.e(u)}else i.e(r)});for(var u=f.d,e=u.length,r=0;r<e;++r){var o=u[r];this.E.Q().a().j(o,!1)}n.bb(i.b()>0?i:null)}},k:function(n,t,i,r){var u=JsonParser.deserialize(n);if(u.ErrorCode){var f=_a.I.c(_a.I.a("Cannot encode the message.",u.ErrorCode),15);this.e(f,r)}else{_js.Trace.logInfo(_a.a.g,"S/MIME data package built successfully.");this.F.gf(u.Data);i(t)}},e:function(n,t){_js.Trace.logWarning(_a.a.g,n.message);if(_a.I.b(n))this.T(n);else{_a.j.i(n,"Unknown error occurred when building data package.");n=_a.I.c(_a.I.a(n.message,11),15);this.T(n)}t(n)},d:function(n,t,i,r,u,f,e,o){var s=new _a.u;s.b("O",_y.M.toString(n));s.b("M",_y.dw.toString(t));s.c("AS",i);s.c("AE",r);s.c("UAS",u);s.c("UAE",f);s.c("CS",e);s.c("TW",o);return s.toString()},l:function(n,t,i){var r=null;t&&!i?n===2?r="SMIMESendSign":n===3&&(r="SMIMESaveSign"):!t&&i?n===2?r="SMIMESendEncrypt":n===3&&(r="SMIMESaveEncrypt"):t&&i&&(n===2?r="SMIMESendSignAndEncrypt":n===3&&(r="SMIMESaveSignAndEncrypt"));return r}};_mcp.bo=function(n,t){_mcp.bo.initializeBase(this,[21,n]);this.a=t};_mcp.bo.prototype={a:null,C:function(){if(!this.I()&&this.a.a().a().f()===2&&this.a.k().c().a()){var n=this.D.b(5);n&&n.a()&&n.c()&&n.a().bg()}_mcp.P.prototype.C.call(this)}};_mcp.p=function(n,t){this.j=Function.createDelegate(this,this.l);_mcp.p.initializeBase(this,[11,n]);this.i=new _C(this.j,this.G());this.f=t;this.e=_a.UserAgent.getInstance();this.d=_a.bb.a()};_mcp.p.a=function(n,t){return t?n.bl.SignatureHtml:n.bl.SignatureText};_mcp.p.prototype={i:null,f:null,h:null,g:null,e:null,d:null,c:function(){var t=this.D.a.L;var n=t.d()==="HTML"&&this.f.a();return n?this.g:this.h},b:function(){return this.D.a.L.cJ()&&this.m()?!0:!1},a:function(){return this.i},C:function(){var u=_g.a.a().a();if(!this.I()){var n=this.k(u,!0);if(_js.d.a(n)){_js.Trace.logInfo(_a.a.a,"No html signature.");this.g=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var i=_mcp.p.c+e+n.replace(_mcp.p.b," ")+f;_js.Trace.logInfo(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",n,i);this.g=i}var t=this.k(u,!1);if(_js.d.a(t)){_js.Trace.logInfo(_a.a.a,"No plain text signature.");this.h=null}else{var r="\n"+t;_js.Trace.logInfo(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.h=r}_mcp.P.prototype.C.call(this)}},m:function(){var n=_g.a.a().a();return"Mouse"===_y.c.a.a()?n.bl.AutoAddSignature:this.e.c()?this.d.b("MOWA.IsSignatureChanged")==="true"?this.d.b("MOWA.AutoAddSignature")==="true":!0:n.bl.AutoAddSignatureOnMobile},k:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.p.a(n,t);if(this.e.c()){if(this.d.b("MOWA.IsSignatureChanged")==="true")if(this.d.b("MOWA.UseDesktopSignature")==="true")return _mcp.p.a(n,t);else{var r=this.d.b("MOWA.SignatureText")||"";return t?_a.v.b(r):r}return t?_a.v.b(_c.s.a(this.e)):_c.s.a(this.e)}if(n.bl.UseDesktopSignature)return _mcp.p.a(n,t);else{var i=n.bl.SignatureTextOnMobile||"";return t?_a.v.b(i):i}},l:function(){var i=this.D.a.L;var u=_g.a.a().a();i.cj(!0);var r=i.d()==="HTML"&&this.f.a();var t=!_js.d.a(this.c());if(t){var n=new _cmc.d(0,this.c(),r);n.l=!0;n.m=!1;this.E.bo().a(n)}else _js.Trace.logInfo(_a.a.a,"Skip insert signature due to HasSignature={0};",t)}};_mcp.S=function(n,t,i,r){this.y=Function.createDelegate(this,this.t);this.w=Function.createDelegate(this,this.r);this.z=Function.createDelegate(this,this.O);this.A=Function.createDelegate(this,this.J);_mcp.S.initializeBase(this,[10,n]);this.k=new _C(this.A,this.G());this.j=t;this.s=i;this.o=r};_mcp.S.a=function(n){if(OwaApplication.b)return null;var t=n.b(22);return new _y.f(_y.b.bp(),_y.b.bq(),_u.P.e,t.h)};_mcp.S.prototype={k:null,m:null,n:!1,j:null,s:null,o:null,u:!1,q:null,p:null,l:null,a:function(){return this.k},d:function(){return this.m},Q:function(n){if(n!==this.m){this.m=n;this.bt("CloseConfirmDialogButtonData")}return n},e:function(){return this.n},g:function(n){if(n!==this.n){this.n=n;this.bt("IsCloseConfirmDialogShown")}return n},R:function(n){if(n!==this.u){this.u=n;this.bt("IsAppBarSetup")}return n},h:function(){var i=this.D;var f=i.a.L;_js.Trace.logInfo(_a.a.a,"Setup appbar menu. Context: {0}",f);var n=new _ff.e;var t=i.b(1);_g.a.a().a().bl.AlwaysShowBcc?n.c(t.bG()):n.c(t.bI());if(f.S())if(_g.a.a().a().bl.AlwaysShowFrom){n.c(t.S());t.q=!1}else{n.c(t.u());t.q=!0}else t.q=!1;OwaApplication.b||n.c(new _y.g(_nbs.a.dG,t.y));var u=this.D.b(30);if(!_y.c.a.h()&&u.a()){this.q=new _y.g(_nbs.a.Iq,u.d());this.p=new _y.g(_nbs.a.OQ,u.c());this.l=this.D.a.L.bn()?this.p:this.q;n.c(this.l)}var o=i.b(6);n.c(o.b());var r=i.b(3);if(r.e()&&r.b()){n.c(r.e());r.f(!0)}else r.f(!1);if(this.o&&!this.o.c()){var e=i.b(9);n.c(new _y.g(_nbs.a.Ms,e.b()))}i.a.dl.f(n.d);this.R(!0)},C:function(){var t=this.D;var n=t.a;var i=n.L;_js.Trace.logInfo(_a.a.a,"InitTouchComponent:Context:{0}",i);this.j&&this.j.a().b().Enabled&&n.V.a()==="TouchNarrow"?this.N():n.dl||this.K();t.b(21);_mcp.P.prototype.C.call(this)},f:function(n,t){if(this.D.a.bj)return!1;else if(this.E.bh().c()){this.n||this.J();return!0}else if(this.D.a.L.be()&&!this.B()){_js.Trace.logInfo(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.r();return!0}else{this.D.a.D(!0);return!1}},i:function(){var i=this.D.b(30);if(i.a()){var n=this.F.bn()?this.p:this.q;var t=this.D.a.dl;if(this.l){t.F(this.l,n);this.l=n}else this.h()}},B:function(){var n=this.D.b(7);return n.j},K:function(){var t=this.D;var f=t.a;var o=f.L;var l=t.b(7);var c=new _y.f(_y.b.F(),_y.b.G(),_u.P.V,l.h);var h=_y.f.a(_nbs.a.Qa,this.k);var u=_mcp.S.a(t);var r=this.M(o,t);var e=2;e+=u?1:0;e+=r?1:0;var n=new Array(e);var i=0;n[i++]=c;u&&(n[i++]=u);n[i++]=h;r&&(n[i++]=r);_js.Trace.logInfo(_a.a.a,"Creating appbar. ContextId={0}",o.b());var s=_y.h.a(f,n,null);s.H("TouchNarrow"===_y.c.a.a());f.dL(s)},N:function(){var r=this.D;var u=r.a;var o=u.L;var i=r.b(7);var n=new _ms.b;if(_a.UserAgent.getInstance().a()){n.e(2);n.h(_nbs.a.WU);n.f(new _ms.a(_fm.a.a,_fm.a.a,this.k,_u.R.ZN));n.g(new _ms.a(_fm.a.a,_fm.a.a,i.h,_u.R.KW));n.i.a(!0)}else{n.e(1);n.h(_nbs.a.OS);n.f(new _ms.a(_y.b.a(),_y.b.a(),this.k,""));n.m(new _ms.a(_fm.a.h,_fm.a.h,null,""));n.n(this.D.b(28).b());var e=r.a.Q();var t=e.g();if(t&&t.d.length>0){if(t.d.length>1){n.g(new _ms.a(_y.b.I(),_y.b.I(),null,""));n.E(new _fm.f(t.d))}else{var f=t.d[0].i;n.g(new _ms.a(_y.b.I(),_y.b.I(),f,""))}n.l(new _ms.a(_y.b.r(),_y.b.r(),i.h,""))}else n.g(new _ms.a(_y.b.r(),_y.b.r(),i.h,""))}u.dO(n)},J:function(){var t=this.D;var i=t.a;var n=i.L;_js.Trace.logInfo(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",n);if(this.B()){_js.Trace.logInfo(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.E.bh().c()){this.S();_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.g(!0)}else if(n.be()){_js.Trace.logInfo(_a.a.a,"Removing unedited reply forward draft on close.");this.r()}else{_js.Trace.logInfo(_a.a.a,"Navigate away due to unmodified message.");this.v()}},t:function(){_js.Trace.logInfo(_a.a.a,"Hide close confirm dialog");this.g(!1)},S:function(){if($a(this.m)){_js.Trace.logInfo(_a.a.a,"Create close confirm dialog.");var n=new _js.f;OwaApplication.b||n.a(new _ff.f(new _C(this.z,this.G()),_u.P.b,_nbs.a.kw));n.a(new _ff.f(new _C(this.w,this.G()),_u.R.Hw,_u.R.TZ));n.a(new _ff.f(new _C(this.y,this.G()),_bcs.D.A,_u.R.IS));this.Q(n)}},O:function(){_js.Trace.logInfo(_a.a.a,"User select save and close");var i=this.D;this.t();var t=i.a.d();var n=this;t.c(function(t){n.v()},null)},r:function(){_js.Trace.logInfo(_a.a.a,"User select discard and close");var n=this.D;this.t();n.a.bh().d();this.v()},v:function(){var n=this.D.a;n.b().b(n,!1)},M:function(n,t){if(n.bv())return null;var i=new _ff.e;var e=t.a.Q();var r=e.m();if(r&&r.length>0)for(var f=r,h=f.length,u=0;u<h;++u){var c=f[u];i.c(c)}if(!OwaApplication.b){var o=t.b(11);i.c(new _y.g(_nbs.a.Bp,o.a()));this.j&&(this.j.a().w().Enabled&&_a.UserAgent.getInstance().a()&&!_a.UserAgent.getInstance().Z||this.j.a().B().Enabled&&_a.UserAgent.getInstance().G)&&this.s.a()&&_a.UserAgent.getInstance().c()&&this.D.a.L.d()==="HTML"&&i.c(new _y.g(_nbs.a.eA,e.l()))}if(OwaApplication.b&&i.d.length===1){var s=i.d[0];return new _y.f(_y.b.bd(),_y.b.be(),_u.P.P,s.a())}else return new _y.f(_y.b.bd(),_y.b.be(),_u.P.P,null,i.d)}};_mcp.br=function(n,t,i){this.v=Function.createDelegate(this,this.O);this.s=Function.createDelegate(this,this.y);this.w=Function.createDelegate(this,this.bb);this.t=Function.createDelegate(this,this.S);this.g=Function.createDelegate(this,this.z);this.u=Function.createDelegate(this,this.ba);_mcp.br.initializeBase(this,[12,n]);this.j=this.D.a.bt;this.b=t;this.J=i};_mcp.br.prototype={j:null,b:null,J:null,m:null,f:null,d:null,e:null,q:null,p:null,r:null,i:null,a:null,l:function(){this.i||(this.i=new _C(this.u,_a.a.a));return this.i},N:function(){var n=this.D.a.L;return this.c()&&!n.R()},M:function(){var n=this.D.a.L;return this.c()&&n.R()&&!this.a&&!n.G()},c:function(){return this.K()&&!this.F.r()},K:function(){var t=this.D.a;var n=t.L.a();var i=n===1||n===2||n===3;return i&&t.bg()},Z:function(){return this.N()||this.M()},C:function(){if(this.c()){var n=this.E.L;if(n.R()&&n.G()){_js.Trace.logInfo(_a.a.Y,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.n();this.E.N()}}_mcp.P.prototype.C.call(this)},R:function(){_a.s.stPT(_a.a.a,"MailComposeUpgrade",3);this.f=_y.k.b(_a.a.a,"MailComposeUpgrade",!0);this.d=_y.k.b(_a.a.a,"MailComposeQuoteBody",!0);var i=this.D.a;var n=i.L;var u=n.b();this.m=u;if(!n.g()){if(!this.c()){var f=this;_js.g.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.g()||n.G()||u!==f.m||f.o(i.M)},5e3)}var t;t=this.b.a()||n.d()!=="HTML"?n.d()==="Text"?_h.b.m():_h.b.c():_h.b.J();if(t===_h.b.c()||t===_h.b.J()){t.BlockExternalImages=n.e().bl.HasBlockedImages;t.FilterHtmlContent=n.e().bl.HasBlockedImages}var r=i.bu.c(n,t,this.b);n.a()===12&&(r.Q=new _g.T(new _g.B("internalsubmission")));r.bS(this.g);_js.Trace.logInfo(_a.a.Y,"Begin upgrade, context:{0}; OriParentFolderId={1}",n,n.e()&&n.e().bl.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.e().bl.ParentFolderId):"null");r.f="MailComposeUpgrade";if(n.bl()){var e=new _mcp.A(r);i.U.a(e,this.t,this.w,null)}else i.U.a(r,this.s,this.v,null)}},S:function(n){var t=n;this.y(t.a)},bb:function(n){var i=n;var t=i.a;t.bk(this.g);this.O(t);this.Q(n.s,t.I,t.B?t.B.correlationId:null,this.D.a.L)},y:function(n){var c=this.D;var e=c.a;var r=e.L;var t=n;var h=e.bh();var u=t.d;var i=n.I;var o=t.B?t.B.correlationId:null;var l=!!t.c;if(this.j.a(i)){_js.Trace.logInfo(_a.a.Y,"Check upgrade callback, resume discard for context {0}",i);h.b(i,u)}else if(i===r.b()){r.E(u);_js.Trace.logInfo(_a.a.Y,"Context match, updated the draft id. Context:{0}; ResponseMessageBodyType={1}",r,l&&t.c.w()?t.c.w().a():"null");var f=e.d();var s=e.e();if(!f.a()&&s.j){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.h("SkipUpgrade",o,"Skip upgrade since send is in progress");s.o();return}if(f.a()&&f.f()){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.h("SkipUpgrade",o,"SkipUpgrade since saving is in progress");f.g();return}}if(t.c){_js.Trace.logInfo(_a.a.Y,"Check upgrade, action has response message, call complete upgrade. context:{0}; ActionItemId={1}",r,_h.bj.a(u));this.z(n)}else if(n.I===r.b()){_js.Trace.logInfo(_a.a.Y,"Check upgrade: action has id only, updated draft id. context:{0}; ActionItemId={1}",r,_h.bj.a(u));this.A()}},W:function(n){n.cS()&&this.D.a.M.a(3050)},z:function(n){var o=this.D;var r=o.a;var t=r.L;var i=n;var c=i.B?i.B.correlationId:null;var e=n.I;i.bk(this.g);if(e===t.b()){t.dc(i.c);this.a=i.c;t.gj(i.c.bB());try{if(this.c())if(t.R()){_js.Trace.logInfo(_a.a.Y,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.k();this.bw("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.E.N()}else t.cm(!0);else this.k();i.c.T()&&t.bp(i.c.T().c);var s=r.Q();s.r()}finally{t.g()&&r.M.b(3440);_js.Trace.logInfo(_a.a.Y,"IsUpgraded for context is {0}",t.g())}this.W(t);this.E.N();_js.Trace.logInfo(_a.a.Y,"Complete upgrade context:{0}",t);var u=r.d();if(u.a())u.g();else if(_a.bm.a){var f=this.D.b(23);var h=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){f&&f.a(32)})}r.S.a(_y.dY,new _mcp.bs(t.ba().bl.ItemId.Id,r))}else _js.Trace.logInfo(_a.a.Y,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",e,t)},ba:function(){this.e=_y.k.b(_a.a.a,"MailComposeOnDemandUpgrade",!0);var n=this.D.a.L;n.dr(!0);if(this.a||n.ba()&&n.g()){this.a||(this.a=n.ba());_js.Trace.logInfo(_a.a.Y,"user requests for quoted body, upgrade was successful, complete the body merge");this.k();this.bw("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.G()){_js.Trace.logInfo(_a.a.Y,"user requests for quoted body, upgrade failed, show error message");this.bw("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.n();this.E.N();this.B()}else{_js.Trace.logInfo(_a.a.Y,"user requests for quoted body, upgrade has yet to come back, show spinner");this.bw("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},k:function(){var n=this.D.a.L;var e=!1;if(this.b.c()){if(n.ed()){n.ej.a();n.M()===n.ed().a()&&(e=!0)}else n.eI=!0;n.eH=!0}if(this.E.bg()&&this.c()&&this.a.w()&&n.d()!==this.a.w().a()&&this.b.a()){var f=this.a.w().bl.Value;if(n.d()==="HTML")n.eB(_a.v.b(f));else{var i;var o,r;r=_a.v.a(f,o={val:i}),i=o.val,r;n.eB(i);var h=this;n.ew=function(n){n.Q().q(!1)}}}else if(this.b.a()||n.d()!=="HTML"){var u=this.a.w().bl.Value;n.eB(!this.b.c()&&n.d()==="Text"?_a.v.F(u):u)}else n.eB(this.a.bC().bl.Value);if(_y.c.a.a()==="Mouse"||this.b.c()){var t=new _cmc.d(2,n.cI(),n.d()==="HTML");t.o=!1;t.t=!0;var c=this;t.u=function(){n.cm(!0)};this.E.bo().a(t)}else n.cm(!0);if(e){n.ej.a();n.ed().s(n.M());var s=n.ee;s&&n.ee.s(n.M())}this.A()},O:function(n){var h=this.D;var i=h.a;var u=i.L;var s=i.bh();var r=n;var f=r.B?r.B.correlationId:null;r.bk(this.g);u.dL(!0);var t=n.I;if(this.j.a(t)){_js.Trace.logInfo(_a.a.Y,"Resume discard for context {0}",t);s.b(t,r.d)}else if(t===u.b()){_js.Trace.logInfo(_a.a.Y,"Recording on context upgrade failed");var e=i.d();var o=i.e();if(e.m){if(e.o){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",t);this.h("SkipUpgrade",f,"Skip upgrade since saving is in progress");e.g();return}this.o(i.M)}else if(o.j){_js.Trace.logInfo(_a.a.Y,"Skipping upgrade for context {0} since send was triggered during upgrade",t);this.h("SkipUpgrade",f,"Skip upgrade since send is in progress");o.o();return}else this.o(i.M);if(this.c()&&u.R()){_js.Trace.logInfo(_a.a.Y,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.bw("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.n();this.E.N()}}n.s&&this.Q(n.s,t,f,u)},Q:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.X.a(n)){f=_g.X.b(n);u=n.FaultMessage}_js.Trace.logWarning(_a.a.Y,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.h(f,i,u)},o:function(n){if(!this.c()){n.b(3440);n.a(3440,null);this.E.N()}},n:function(){var n=this.D.a.M;n.b(3450);n.a(3450,null)},h:function(n,t,i){this.q=n;this.p=t;this.r=i;if(this.f){_y.k.a(this.f,null,n,t,i);this.f=null;_a.s.endPT("MailComposeUpgrade")}if(this.d){_y.k.a(this.d,null,n,t,i);this.d=null}this.B()},A:function(){if(this.f){_y.k.a(this.f);this.f=null;_a.s.endPT("MailComposeUpgrade")}this.X()},X:function(){if(this.e){_y.k.a(this.e);this.e=null}},B:function(){if(this.e){_y.k.a(this.e,null,this.q,this.p,this.r);this.e=null}}};_mcp.bi=function(n,t){this.f=Function.createDelegate(this,this.g);_mcp.bi.initializeBase(this,[17,n]);if(_a.cB.a){var i=this;t.a(function(t){i.c=t.a(n.b(1),n.a.M);i.c.d(i.f);if(i.d){i.c.b();i.d=!1}if(i.e){i.c.a();i.e=!1}})}};_mcp.bi.prototype={c:null,d:!1,e:!1,C:function(){if(!_a.cB.a){_mcp.P.prototype.C.call(this);return}this.c?this.c.b():this.d=!0;_mcp.P.prototype.C.call(this)},a:function(n){if(_a.cB.a){if(n===32){var r=this.D;var i=r.a;var t=i.L;if(t.cE()){i.M.b(4400);i.M.a(4400);this.E.N()}if(!t.a()||t.a()===3||t.a()===11)return}this.I()||this.C();this.h()}},b:function(){if(_a.cB.a){this.I()||this.C();if(this.c){_js.Trace.logInfo(_a.a.a,"Remove MailTips for deleted recipients");this.c.c()}else _js.Trace.logInfo(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},h:function(){if(_a.cB.a)if(this.c){_js.Trace.logInfo(_a.a.a,"Prepares to submit mailtips action");this.c.a()}else{_js.Trace.logInfo(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.e=!0}},g:function(){_a.cB.a&&this.E.N()}};_mcp.bn=function(n,t){this.n=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.r);this.j=Function.createDelegate(this,this.q);_mcp.bn.initializeBase(this,[23,n]);if(_a.bm.a){var i=this;t.a(function(t){i.e=t.a(i.D.b(1),i.D.b(5),n.a.M);i.e.i(i.j);i.e.e(i.k);i.e.d(i.l);i.e.f(i.m);i.e.g(i.n);if(i.g){i.e.b();i.g=!1}if(i.h){i.a(i.i);i.h=!1}})}};_mcp.bn.prototype={f:null,e:null,g:!1,h:!1,i:0,C:function(){if(!_a.bm.a){_mcp.P.prototype.C.call(this);return}this.e?this.e.b():this.g=!0;_mcp.P.prototype.C.call(this)},bu:function(){this.f&&(this.f=_js.g.a().b(this.f));_js.x.prototype.bu.call(this)},c:function(){if(!_a.bm.a)return!1;switch(this.o()){case 1:return!1;case 2:case 3:return $a(this.D.a.L.bS())&&$a(this.D.a.L.bR());case 4:case 5:return $a(this.D.a.L.bR());default:return!1}},b:function(){if(!_a.bm.a)return"";switch(this.o()){case 2:case 3:return _u.P.O;case 4:case 5:return _u.P.Y;default:return""}},d:function(){if(_a.bm.a){if(!this.e){_js.Trace.logInfo(_a.a.J,"skip setting message sent flag since handler hasn't been created yet.");return}this.e.h(!0);if(!$a(this.D.a.L.bS())){var n=_a.d.b(_a.a.J,"DlpPolicyTipOverridden");_a.d.a(n)}}},a:function(n){this.p(n,0)},v:function(n,t,i){_js.Trace.logInfo(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.ed()){u=_a.J.b(n.ed().f());r=_a.J.b(n.ed().a())}else{u=_a.J.b(n.A());r=_a.J.b(n.M())}this.e.c(i,n.B(),u,r,t)},p:function(n,t){if(_a.bm.a){if(!this.e){_js.Trace.logInfo(_a.a.J,"Remember to resume triggering policy tips once the handler is created");this.i=n;this.h=!0;return}var f=this.D;var e=f.a;var r=e.L;this.I()||this.C();this.f&&(this.f=_js.g.a().b(this.f));var i=r.h();if(i){_bc.g.a(i)&&!_g.k.b&&(i=_g.k.a.q(i));if(_bc.g.a(i)){if(t<4){var u=this;this.f=_js.g.a().a(_a.a.J,"TriggerPolicyTipsIfNeeded",function(){u.p(n,t+1)},5e3)}}else this.v(r,n,i)}}},o:function(){this.I()||this.C();return this.e?this.e.a():0},q:function(){this.E.N()},r:function(n){var r=this.D;var i=r.a;var t=i.L;t.db(n)},s:function(n){var r=this.D;var i=r.a;var t=i.L;t.da(n)},t:function(){this.a(64)},u:function(n){var r=this.D;var i=r.a;var t=i.L;t.cZ(n)}};_mcp.bg=function(n,t){this.O=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.bj);this.M=Function.createDelegate(this,this.bl);this.N=Function.createDelegate(this,this.bm);this.k=Function.createDelegate(this,this.bi);this.K=Function.createDelegate(this,this.bk);this.W=Function.createDelegate(this,this.bh);this.X=Function.createDelegate(this,this.bp);_mcp.bg.initializeBase(this,[22,n]);this.i=!1;this.R=t;this.h=new _C(this.X,_a.a.j);this.h.c(!1)};_mcp.bg.prototype={i:!1,g:null,R:null,Q:null,h:null,bo:function(n){if(this.g!==n){this.g=n;this.bt("ExtensibilityViewModel")}return n},be:function(){return!!this.g&&this.g.b()&&this.h.b},Z:!1,C:function(){if(!OwaApplication.b&&!this.I()){var n=this;this.R.a(function(t){if(!n.g){n.Q=t;n.bo(t.d(n,n.W));var u=n.D.a.bi();n.g.q(u.c());var c=n.D.a.S;c.b(_a.dq,n.K);n.g.f();u.apcl(u.d(),n.k);n.g.h(n.N);n.g.g(n.M);if(n.g.v()){n.h.c(n.g.a().b);n.S()}else n.g.a().k(n.J);n.E.bY()&&n.g.apcl("ShowAppsButton",n.O);_mcp.P.prototype.C.call(n);var r;if(n.F.el()&&n.F.el().length>0){for(var i=0;i<n.F.el().length;i++)if(n.F.el()[i][0]==="file"){var s,o;o=n.ba(n.F.el()[i][2],n.F.el()[i][1],s={val:r},!0),r=s.val,o}else if(n.F.el()[i][0]==="item"){var f=new _g.A;f.p(new _g.g(n.F.el()[i][2]));f.e(n.F.el()[i][1]);var e,h;h=n.bb(f,e={val:r},!0),r=e.val,h}n.F.cW(null)}}})}},S:function(){if(this.E.bY()){var n=this.D.b(29);n.n(this.be())}},bn:function(n,t){this.S()},H:function(){if(this.I()){var n=this.D.a.bi();n.rpcl(n.d(),this.k);this.g.o(this.N);this.g.n(this.M);this.g.k();var t=this.D.a.S;t.c(_a.dq,this.K)}_mcp.P.prototype.H.call(this)},a:function(){return _y.c.a.a()==="Mouse"?this.D.a.L.d():this.D.a.L.cC()?"HTML":"Text"},s:function(){return this.D.a.L.z()},z:function(n){this.D.a.L.K(n)},r:function(n,t,i){i.val=0;var r=new _cmc.e(n);this.D.a.L.co(r);r.d&&(i.val=9016);t.val=r.e;return r.a},y:function(n,t,i){i.val=0;var r=new _cmc.g(n,!0,t);this.D.a.L.co(r);r.q?i.val=2006:r.r&&(i.val=9016)},o:function(){this.Z=!0;this.bt("RequestCloseComposeForm")},q:function(n){var t=this.bf(n);return t.t},B:function(n,t){return this.bg(n,t,!1)},w:function(n,t){this.bg(n,t,!0)},m:function(n,t){return this.bb(n,t,!1)},bb:function(n,t,i){t.val=0;if(!this.D.a.L.g()){_js.Trace.logInfo(_a.a.j,"Attachment not added - well not upgraded.");t.val=9005;return null}var u=this.D.b(5);var f=_y.G.b(n);if(u.a()){var e=_a.d.b(_a.a.c,"AttachmentExtensibilityItemAttachments");var r=new _ff.e;u.a().v(f,r,e);if(!r.d.length){_js.Trace.logInfo(_a.a.j,"Attachment not added - max number exceeded.");t.val=9001;return null}r.d[0].z(i);return r.d[0]}else{_js.Trace.logInfo(_a.a.j,"Attachment not added - max number exceeded.");t.val=9001;return null}},l:function(n,t,i){return this.ba(n,t,i,!1)},ba:function(n,t,i,r){i.val=0;if(!this.D.a.L.g()){_js.Trace.logInfo(_a.a.j,"Attachment not added - well not upgraded.");i.val=9005;return null}var e=this.D.b(5);var f=e.a();if(f){var o=this.Q.b(n,t);var u=f.N(o);u.z(r);return u}_js.Trace.logError(_a.a.j,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},f:function(){return this.D.a.L.bj()?this.D.a.L.bj().Id:null},d:function(n,t){var i=new _cmc.d(0,n,t);i.m=!0;i.l=!0;this.j(i)},e:function(n,t){var i=new _cmc.d(1,n,t);this.j(i)},u:function(n,t){var r=this,i=this;this.D.a.d().c(function(t){n()},function(n){_js.Trace.logInfo(_a.a.j,"SaveActionFailed: Error: {0}",n.s.message);t()})},p:function(n){var t=new _cmc.w(n);this.D.a.L.ch(t);return t.a},v:function(n,t,i){i.val=0;var r=new _cmc.K(n,t);this.D.a.L.ch(r);r.c&&(i.val=2006)},bp:function(){this.g&&this.g.z()},bj:function(n,t){this.h.c(this.g.a().b);this.S()},bm:function(){if(_y.c.a.a()==="TouchWide"&&this.g.m()){var n=this.D.a;n.db(6)}},bl:function(){var n=this.D.a;n.db(4)},j:function(n){this.E.bo().a(n)},c:function(){return this.D.a.L.h()?this.D.a.L.h().Id:null},b:function(){this.D.a.L.N()||this.D.a.L.df(new _js.f);return this.D.a.L.N()},t:function(){},A:function(){var n=new _cmc.f(null);this.j(n)},n:function(n){var t=new _cmc.f(n);this.j(t)},bu:function(){this.E.bY()&&this.g.rpcl("ShowAppsButton",this.O);this.g.a().i(this.J);_js.x.prototype.bu.call(this)},bg:function(n,t,i){var u=this.bf(n);i&&u.bA();var f=t.d.length;if(f+u.t.w.length>500)return!1;n===2&&this.D.a.R().r.a();for(var r=0;r<f;r++){var e=t.d[r];u.Z(e)}return!0},bk:function(n){if(this.i){this.i=!1;this.g.e(!1)}},bh:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.D.a.S;i.a(_a.dL,new _a.dL(!0));this.i=!0}}else if(n===2&&this.i){var t=this.D.a.S;t.a(_a.dL,new _a.dL(!1));this.i=!1}this.E.N()},bf:function(n){var t=this.D.a.R();return n?n===1?t.d.a:n===2?t.e.a:null:t.c.a},bi:function(n,t){var i=this.D.a.bi();t===i.d()&&this.bq(i)},bq:function(n){this.g.q(n.c());n.c()&&this.g.e(!1)}};_mcp.bt=function(n,t,i){this.d=n;this.f=t;this.e=i};_mcp.bt.prototype={d:null,f:null,e:null,a:function(){return this.d},c:function(){return this.f},b:function(){return this.e}};_mcp.bs=function(n,t){this.c=n;this.d=t};_mcp.bs.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bw=function(n){this.a=n};_mcp.bw.prototype={a:null};_mcp.bx=function(n){this.b=n};_mcp.bx.prototype={b:null,a:function(){return this.b}};_mcp.D=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.D.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.Y=function(n){this.b=n};_mcp.Y.prototype={b:!1,a:function(){return this.b}};_mcp.by=function(n){this.b=n};_mcp.by.prototype={b:null,a:function(){return this.b}};_mcp.B=function(){};_mcp.B.prototype={d:function(n,t,i){var r=n.L;var f=r.a();var c=3===f||2===f||1===f;var h=i.c()&&r.g();n.ca().c()&&(h=!!(h&r.R()));var e=null;if(c&&!h){_js.Trace.logInfo(_a.a.a,"Creating CreateResponseAction for context:{0}; layout={1}; disposition={2}",r,_y.c.a.a(),t);var l=r.w(!1);var o=this.b(r,l,i);o.a=t;r.h()&&t===1&&(o.bF=n.ck);o.be=r.bE(100);o.bE=_y.M.toString(r.a());o.bp=r.bD();if(r.bl()){var a=new _mcp.A(o);e=a}else e=o}else if(r.by()){_js.Trace.logInfo(_a.a.a,"Creating UpdateMessageForComposeAction for context:{0}; disposition={1}",r,t);var s=this.f(t,r,i);t===1&&(s.bp=n.ck);if(r.bl()&&!r.a()){s.a.bQ(s.U);r.K(s.U)}e=s}else if(8===r.a()){_js.Trace.logInfo(_a.a.a,"Creating CancelCalendarItemAction for context:{0}; disposition={1}",r,t);e=this.h(r,t)}else if(f===5||f===6||f===7){_js.Trace.logInfo(_a.a.a,"Creating MeetingResponseAction for context:{0}; disposition={1}",r,t);e=this.i(r,t)}else if(f===9||f===10){_js.Trace.logInfo(_a.a.a,"CreateComposeAction: ApprovalRequestAction");e=this.g(r,t,i)}else{_js.Trace.logInfo(_a.a.a,"Creating CreateMessageForComposeAction for context:{0}; disposition={1}",r,t);var u=null;if(f===11||f===12){u=new _h.l(r.bs(!1),r.bA());u.a=0}else{u=new _h.l(r.w(!1),null);u.a=t}u.S=!i.a();$a(r.t())||(u.V=r.t());u.be=r.bE(100);u.bE=_y.M.toString(r.a());u.bp=r.bD();if(r.bl()&&!r.a()){u.c.bQ(u.be);r.K(u.be)}e=u}e.I=r.b();return e},e:function(n,t,i){var r=new _h.cN(200,n);r.d=t||_h.b.c();r.i=$a(i)?"MailCompose":i;return r},a:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _h.ei([n],r,2)},c:function(n,t,i){var u=null;u=n.l()?n.bs(!0):n.w(!0);var r=this.b(n,u,i);r.n=t;r.Z=!i.a()&&n.d()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.bB=_g.a.a().a().bl.TimeFormat;return r},h:function(n,t){var i=new _c.z(n.bf(),1,n.cB());i.c=n.w(!1);n.t()&&(i.V=n.t());return i},b:function(n,t,i){var u=n.bY()?new _h.U(n.bf()):n.bf();var r=null;r=new _h.O(this.j(n.a()),u,i);r.bb(t);r.e=n.cG();r.S=!i.a();n.t()&&(r.V=n.t());r.o=n.bj();r.i=n.cH();r.I=n.b();n.e()&&_g.q.isInstanceOfType(n.e())&&n.e().bl.IsReadReceiptRequested&&(r.W=!0);switch(n.a()){case 1:case 2:r.br=_u.R.JN;break;case 3:r.br=_nbs.a.Pj;break}return r},i:function(n,t){return _cc.f.b(n.e(),_cc.f.c(n.a()),n.w(!1),t,n.cb())},f:function(n,t,i){var r=null;if(t.l()){r=new _h.n(t.bs(!1));r.Q=_g.r.c(t.bA());r.h=0}else{r=new _h.n(t.w(!1));r.h=n}r.bB=!i.a();r.X=t.bD();r.Z=t.cO();t.t()&&(r.m=t.t());r.U=t.bE(100);r.S="AlwaysOverwrite";r.bb=_y.M.toString(t.a());return r},j:function(n){switch(n){case 1:return new _g.cA;case 2:return new _g.bX;case 3:return new _g.cw;case 12:return new _g.la;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.M.toString(n));}},g:function(n,t,i){var u=n.e();var r=new _c.v(u,n.w(!1),n.a()===9,t);r.S=!i.a();return r}};_mcp.M=function(){_mcp.M.initializeBase(this)};_mcp.M.prototype={d:function(n,t,i){if(_mcp.f.isInstanceOfType(n)){var r=n;if(r.bR&&t===1&&(r.L.a()===2||!r.L.a())){r.L.e()&&r.bl&&r.L.e().bl.ConversationId.Id!==r.bl.bl.ConversationId.Id&&r.L.e().fN(r.bl.bl.ConversationId);var f=this;var u=r.bR(r.bS,r.L,function(n){r.bz=n});u.I=r.L.b();return u}}return _mcp.B.prototype.d.call(this,n,t,i)}};_mcp.bb=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_a.b.b(e,"nativeBridge");this.a=n;this.d=i;this.b=r;this.k=u;this.j=t;this.l=f;this.c=e;this.f=o;this.n=s;this.g=h;this.h=c;this.i=l;this.m=a;this.o=v;this.e=y};_mcp.bb.prototype={a:null,d:null,b:null,k:null,n:null,j:null,l:null,c:null,f:null,g:null,h:null,m:null,o:null,e:null,i:null,p:function(n,t){switch(n){case 0:return new _mcp.I(this.a,this.b,!!this.f);case 1:return new _mcp.t(this.a,this.d);case 2:return new _mcp.k(this.a,this.b);case 3:return new _mcp.s(this.a,this.b,this.e);case 4:return new _mcp.e(this.a);case 5:return new _mcp.l(this.a,this.j,this.d,this.b,this.k,this.n,this.a.a.cs,this.i);case 6:return new _mcp.H(this.a,this.b);case 7:return new _mcp.o(this.a,this.b,this.d,this.a.a.S);case 8:return new _mcp.ba(this.a,this.l,this.b);case 9:return new _mcp.bj(this.a,this.f,this.d);case 10:if("Mouse"!==t)return new _mcp.S(this.a,this.d,this.b,this.e);break;case 11:return new _mcp.p(this.a,this.b);case 12:return new _mcp.br(this.a,this.b,this.d);case 13:if(this.c.b(this.c.d())&&this.c.d().a().a())return new _mcp.bm(this.a,this.c);break;case 20:if(this.c.b(this.c.d())&&this.c.d().a().c())return new _mcp.bl(this.a,this.c);break;case 14:return new _mcp.G(this.a);case 15:if("Mouse"===t)return new _mcp.bd(this.a,this.f);break;case 16:if("Mouse"===t)return new _mcp.v(this.a,this.e,this.d);break;case 18:return new _mcp.q(this.a,this.e);case 17:return new _mcp.bi(this.a,this.g);case 23:return new _mcp.bn(this.a,this.h);case 19:return new _mcp.x(this.a);case 21:if(this.c.b(this.c.k()))return new _mcp.bo(this.a,this.c);break;case 22:return new _mcp.bg(this.a,this.a.a.cz);case 24:if(this.b.a())return new _mcp.bh(this.a,this.d,this.m);break;case 25:return t!=="Mouse"?new _mcp.bf(this.a):new _mcp.be(this.a,this.f);case 27:return new _mcp.bp(this.a);case 28:if(this.b.b())return new _mcp.w(this.a,this.o,this.e);break;case 29:if(this.d.a().f().Enabled&&t==="Mouse")return new _mcp.r(this.a);break;case 30:return new _mcp.bk(this.a,this.d,this.e)}return null}};_mcp.Q=function(n,t){this.d=n;this.c=t};_mcp.Q.prototype={c:null,d:null,a:function(n,t){var i=new _mcp.a;if(this.c){i.dD(this.c.c());i.di(this.c.a())}i.p(n?0:this.d.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.p(this.d.a());u.f(4);u.m(!1);u.E(n);u.dq(t);r&&!r.a()?u.o(r.e()):u.o(i===1?"Text":"HTML");return u}};_mcp.T=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){_a.b.b(k,"nativeBridge");this.m=n;this.B=t;this.r=i;this.C=r;this.K=u;this.c=f;this.z=e;this.y=o;this.x=s;this.k=h;this.A=c;this.l=l;this.q=v;this.n=y;this.o=p;this.g=a;this.s=w;this.i=b;this.w=k;this.I=d;this.v=g;this.d=nt;this.e=tt;this.j=it;this.E=rt;this.D=ut;this.p=ft;this.F=et;this.f=ot;this.t=st;this.u=ht;this.G=ct;this.H=lt;this.h=at};_mcp.T.prototype={m:null,B:null,r:null,C:null,K:null,c:null,l:null,z:null,y:null,x:null,k:null,A:null,q:null,n:null,o:null,G:null,g:null,i:null,s:null,j:null,v:null,w:null,I:null,d:null,e:null,E:null,D:null,p:null,F:null,f:null,t:null,u:null,H:null,h:null,b:function(n,t,i){return this.L(n,null,t,i)},a:function(n,t,i){return this.J(n,null,t,i)},L:function(n,t,i,r){var u=this.K.a(!1,!1);u.fY(n);return this.J(u,t,i,r)},J:function(n,t,i,r){var u=new _mcp.d(n,t,this.m,this.B,this.r,this.C,this.z,this.y,this.x,this.k,this.A,this.l,this.g,this.q,this.n,this.o,this.s,this.i,this.w,this.I,this.c,i,r,this.v,this.d,this.e,this.j,this.E,this.D,this.p,this.F,this.f,this.t,this.u,this.G,this.H,this.h);u.cG();return u}};_mcp.U=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){_mcp.U.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at])};_mcp.U.prototype={J:function(n,t,i,r){var u=new _mcp.h(n,t,this.m,this.B,this.r,this.C,this.z,this.y,this.x,this.k,this.A,this.l,this.g,this.q,this.n,this.o,this.s,this.i,this.w,this.I,this.c,i,r,this.v,this.d,this.e,this.j,this.E,this.D,this.p,this.F,this.f,this.t,this.u,this.G,this.H,this.h);u.cG();return u}};_mcp.N=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){_mcp.N.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at])};_mcp.N.prototype={J:function(n,t,i,r){var u=new _mcp.f(n,t,this.m,this.B,this.r,this.C,this.z,this.y,this.x,this.k,this.A,this.l,this.g,this.q,this.n,this.o,this.s,this.i,this.w,this.I,this.c,i,r,this.v,this.d,this.e,this.j,this.E,this.D,this.p,this.F,this.f,this.t,this.u,this.G,this.H,this.h);u.cG();return u}};_mcp.O=function(){_mcp.O.initializeBase(this)};_mcp.O.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.dQ("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.dQ("ConversationOwner")}return n}};_mcp.F=function(n){this.e=Function.createDelegate(this,this.i);_mcp.F.initializeBase(this);this.b=OwaApplication.a;this.c=n};_mcp.F.prototype={b:null,c:null,a:function(n,t,i,r){$a(t)||n.v(t);n.u(i||this.e);$a(r)||n.z(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.Ll;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.s;if(o){if(_g.X.a(o)){var h=o;if(h.ErrorCode===503){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.eH);e=_u.R.eH}else if(h.ErrorCode===408&&u){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.X.c(h)&&i){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.b.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.Xk:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.a.bW,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.a.bW,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_js.Trace.logInfo(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.a(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.cb("MailComposeActionFailed",n)}};_mcp.a=function(){this.eL=Function.createDelegate(this,this.fI);this.z=this.A;this.bQ=this.K;this.cu=this.M;this.cv=this.bT;this.dP=this.d;this.dO=this.B;_mcp.a.initializeBase(this);this.o("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.a.b.a,this.eL);this.apcl(_mcp.a.h.a,this.eL);if(_a.j.a&&_a.j.d()){this.dH(_g.a.a().a().bl.SmimeEncrypt);this.dJ(_g.a.a().a().bl.SmimeSign)}this.eu=-1};_mcp.a.$$cctor=function(){_mcp.a.n.c(new _a.bv(_g.d));_mcp.a.f.c(new _a.bv(_g.d));_mcp.a.e.c(new _a.bv(_g.d));_mcp.a.m.c(new _a.bv(_pc.a));_mcp.a.d.c(new _a.bv(_g.Attachment));_mcp.a.g.c(new _a.bv(_g.bL))};_mcp.a.bQ=function(){_mcp.a.i||(_mcp.a.i=new _H("MeetingCalendarTimePeriod",_cc.r,_mcp.a));return _mcp.a.i};_mcp.a.bW=function(){_mcp.a.k||(_mcp.a.k=new _H("ProposedNewTime",_cc.s,_mcp.a));return _mcp.a.k};_mcp.a.bT=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.d.a(u)?r:_js.l.a(n,u)};_mcp.a.bS=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.d.a(r)?i:Boolean.parse(r)};_mcp.a.bR=function(n){return!_js.d.b(_mcp.a.a)&&!_js.d.b(n)&&(_mcp.a.a===n||_mcp.a.a.toLowerCase()===n.toLowerCase())};_mcp.a.bk=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.b();u++){r.val+=_g.n.g(t.c(u));u!==t.b()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.a.bX=function(n){return n.replace(_mcp.a.bU,"\r\n")};_mcp.a.prototype={eV:null,ej:null,eh:null,et:!1,fD:!1,eD:null,eU:!1,ee:null,eI:!1,fE:!1,eH:!1,fp:!1,ei:0,ex:0,ek:null,eu:0,eJ:null,ez:!1,ev:null,ew:null,eO:function(){return!!this.cb()},cb:function(){return this.dS(_mcp.a.bW())},fT:function(){return this.eO()?_nbs.a.Ya:_u.P.N},cw:function(n){this.dV("OnAsyncSendCallbackEvent",n)},cU:function(n){this.dW("OnAsyncSendCallbackEvent",n)},cD:function(){return this.eH},cj:function(n){this.eH=n;return n},b:function(){return this.dS(_mcp.a.bM)},fe:function(n){this.dR(_mcp.a.bM,n);return n},a:function(){return this.dS(_mcp.a.b)},f:function(n){this.dR(_mcp.a.b,n);return n},n:function(){return this.dS(_mcp.a.j)},p:function(n){this.dR(_mcp.a.j,n);return n},bf:function(){return this.dS(_mcp.a.bm)},cn:function(n){this.dR(_mcp.a.bm,n);return n},cG:function(){return this.dS(_mcp.a.bl)},dy:function(n){this.dR(_mcp.a.bl,n);return n},e:function(){this.eh||(this.eh=this.dS(_mcp.a.bn));return this.eh},dz:function(n){this.eh=n;this.dR(_mcp.a.bn,this.eh);return n},h:function(){return this.dS(_mcp.a.E)},E:function(n){if($a(this.h())||!n)this.dR(_mcp.a.E,n);else{this.h().Id=n.Id;this.h().ChangeKey=n.ChangeKey}return n},by:function(){return!!this.h()},W:function(){return!this.fq()},fQ:function(){return this.dS(_mcp.a.bG)},gg:function(n){this.dR(_mcp.a.bG,n);return n},A:function(){return this.dS(_mcp.a.bH)},K:function(n){this.dR(_mcp.a.bH,n);return n},M:function(){return this.dS(_mcp.a.H)},I:function(n){this.dR(_mcp.a.H,n);return n},y:function(){return this.dS(_mcp.a.bw)},co:function(n){this.dR(_mcp.a.bw,n);return n},cA:function(){return this.dS(_mcp.a.G)},ch:function(n){this.dR(_mcp.a.G,n);return n},bT:function(){return this.ej},dg:function(n){this.ej=n;return n},d:function(){return this.dS(_mcp.a.s)},o:function(n){this.dR(_mcp.a.s,n);return n},j:function(){return this.dS(_mcp.a.n)},v:function(n){this.dR(_mcp.a.n,n);return n},bC:function(){return this.dS(_mcp.a.m)},cq:function(n){this.dR(_mcp.a.m,n);return n},bh:function(){return this.dS(_mcp.a.bI)},dK:function(n){this.dR(_mcp.a.bI,n);return n},q:function(){return this.dS(_mcp.a.f)},bi:function(n){this.dR(_mcp.a.f,n);return n},Z:function(){return this.dS(_mcp.a.t)},cY:function(n){this.dR(_mcp.a.t,n);return n},c:function(){return this.dS(_mcp.a.e)},cf:function(n){this.dR(_mcp.a.e,n);return n},L:function(){return this.dS(_mcp.a.r)},cX:function(n){this.dR(_mcp.a.r,n);return n},cJ:function(){return this.dS(_mcp.a.l)},m:function(n){this.dR(_mcp.a.l,n);return n},bb:function(){return this.dS(_mcp.a.Q)},dj:function(n){this.dR(_mcp.a.Q,n);return n},cI:function(){return this.dS(_mcp.a.bu)},eB:function(n){this.dR(_mcp.a.bu,n);return n},fP:function(){return this.dS(_mcp.a.bA)},gf:function(n){this.dR(_mcp.a.bA,n);return n},bB:function(){return this.dS(_mcp.a.bC)},cp:function(n){this.dR(_mcp.a.bC,n);return n},fm:function(){return this.dS(_mcp.a.bD)},dI:function(n){this.dR(_mcp.a.bD,n);return n},el:function(){return this.dS(_mcp.a.o)},cW:function(n){this.dR(_mcp.a.o,n);return n},P:function(){return this.ex},bK:function(n){this.ex=n;return n},bt:function(){return this.ek},bF:function(n){this.ek=n;return n},cK:function(){return this.ei},J:function(n){this.ei=n;return n},eP:function(){return this.dS(_mcp.a.U)},er:function(n){this.dR(_mcp.a.U,n);return n},bm:function(){return this.dS(_mcp.a.h)},fa:function(n){this.dR(_mcp.a.h,n);return n},bx:function(){return this.dS(_mcp.a.Y)},fc:function(n){this.dR(_mcp.a.Y,n);return n},cE:function(){return this.dS(_mcp.a.bf)},fy:function(n){this.dR(_mcp.a.bf,n);return n},cF:function(){return this.dS(_mcp.a.bj)},fz:function(n){this.dR(_mcp.a.bj,n);return n},bV:function(){return this.dS(_mcp.a.M)},ft:function(n){this.dR(_mcp.a.M,n);return n},eo:function(){return this.dS(_mcp.a.bQ())},fA:function(n){this.dR(_mcp.a.bQ(),n);return n},k:function(){return this.dS(_mcp.a.J)},ci:function(n){this.dR(_mcp.a.J,n);return n},bo:function(){return this.dS(_mcp.a.bx)},dE:function(n){this.dR(_mcp.a.bx,n);return n},g:function(){return this.dS(_mcp.a.bi)},cm:function(n){this.dR(_mcp.a.bi,n);return n},i:function(){return this.dS(_mcp.a.W)},dp:function(n){this.dR(_mcp.a.W,n);return n},s:function(){return this.dS(_mcp.a.S)},bL:function(n){this.dR(_mcp.a.S,n);return n},ca:function(){return this.dS(_mcp.a.bq)},dB:function(n){this.dR(_mcp.a.bq,n);return n},bA:function(){return this.dS(_mcp.a.bp)},dA:function(n){this.dR(_mcp.a.bp,n);return n},eR:function(){return this.dS(_mcp.a.bc)},ds:function(n){this.dR(_mcp.a.bc,n);return n},bY:function(){return this.dS(_mcp.a.ba)},ck:function(n){this.dR(_mcp.a.ba,n);return n},cB:function(){return this.dS(_mcp.a.I)},de:function(n){this.dR(_mcp.a.I,n);return n},fL:function(){return this.dS(_mcp.a.R)},dk:function(n){this.dR(_mcp.a.R,n);return n},bU:function(){return this.dS(_mcp.a.L)},eY:function(n){this.dR(_mcp.a.L,n);return n},bD:function(){return this.dS(_mcp.a.bJ)},cr:function(n){this.dR(_mcp.a.bJ,n);return n},cO:function(){return this.dS(_mcp.a.bK)},gh:function(n){this.dR(_mcp.a.bK,n);return n},be:function(){return this.dS(_mcp.a.bg)},du:function(n){this.dR(_mcp.a.bg,n);return n},ba:function(){return this.dS(_mcp.a.F)},dc:function(n){this.dR(_mcp.a.F,n);return n},X:function(){return this.dS(_mcp.a.p)},gc:function(n){this.dR(_mcp.a.p,n);return n},bk:function(){return this.dS(_mcp.a.K)},dh:function(n){this.dR(_mcp.a.K,n);return n},B:function(){return this.dS(_mcp.a.d)},bp:function(n){var i=null;if(n){i=new _js.f;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.dR(_mcp.a.d,i);this.fG();return n},G:function(){return this.dS(_mcp.a.bL)},dL:function(n){this.dR(_mcp.a.bL,n);return n},ed:function(){return this.dS(_mcp.a.q)},eA:function(n){this.dR(_mcp.a.q,n);return n},bl:function(){return this.ez},dl:function(n){this.ez=n;return n},C:function(){return this.dS(_mcp.a.bv)},bN:function(n){if(n!==this.C()){this.dR(_mcp.a.bv,n);this.dU("IsCopyRestricted","IsPrintRestricted")}return n},t:function(){return this.dS(_mcp.a.y)},bJ:function(n){this.dR(_mcp.a.y,n);return n},dG:function(n){this.fD=n;return n},Q:function(){return this.et},dn:function(n){if(this.et!==n){this.et=n;n&&!this.ed()&&this.fk();this.dQ("IsEditorInitialized")}return n},dd:function(n){this.eD!==n&&(this.eD=n);return n},dw:function(n){this.eU=n;return n},bX:function(){return this.dS(_mcp.a.X)},eZ:function(n){this.dR(_mcp.a.X,n);return n},cP:function(){return this.dS(_mcp.a.bN)},eq:function(n){this.dR(_mcp.a.bN,n);return n},bv:function(){return this.dS(_mcp.a.O)},fv:function(n){this.dR(_mcp.a.O,n);return n},eQ:function(){return this.dS(_mcp.a.Z)},dq:function(n){this.dR(_mcp.a.Z,n);return n},cd:function(){return this.dS(_mcp.a.bO)},ff:function(n){this.dR(_mcp.a.bO,n);return n},fN:function(){return!!this.C()&&!this.C().a()&&!this.C().h()&&!this.C().b()},cc:function(){return this.bm()&&_mcp.e.g(this)},fM:function(){return!!this.C()&&0===this.C().a()&&!this.C().f()&&!this.C().b()},V:function(){return null},bO:function(){return this.A()},br:function(){return this.eV},bw:function(){return this.dS(_mcp.a.T)},bM:function(n){this.dR(_mcp.a.T,n);return n},eN:function(){return this.dS(_mcp.a.v)},bI:function(n){this.dR(_mcp.a.v,n);return n},bS:function(){return this.dS(_mcp.a.D)},db:function(n){this.dR(_mcp.a.D,n);return n},bR:function(){return this.dS(_mcp.a.C)},da:function(n){this.dR(_mcp.a.C,n);return n},fK:function(){return this.dS(_mcp.a.B)},cZ:function(n){this.dR(_mcp.a.B,n);return n},cx:function(){return this.dS(_mcp.a.x)},bG:function(n){this.dR(_mcp.a.x,n);return n},cy:function(){return this.dS(_mcp.a.u)},bH:function(n){this.dR(_mcp.a.u,n);return n},fl:function(){return this.dS(_mcp.a.w)},fs:function(n){this.dR(_mcp.a.w,n);return n},D:function(){return this.dS(_mcp.a.bz)},dF:function(n){this.dR(_mcp.a.bz,n);return n},bc:function(){return this.dS(_mcp.a.V)},dm:function(n){this.dR(_mcp.a.V,n);return n},bd:function(){return this.dS(_mcp.a.be)},dt:function(n){this.dR(_mcp.a.be,n);return n},fR:function(){return this.r()},eS:function(){return this.dS(_mcp.a.bE)},fB:function(n){this.dR(_mcp.a.bE,n);return n},r:function(){return _a.j.a&&(this.u()||this.F())},u:function(){if(!_a.j.a||!_a.j.k()||!this.cT()||_g.a.a().a().bl.AlwaysShowFrom)return!1;var n=_g.a.a().bl.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.dS(_mcp.a.bB)},dH:function(n){this.dR(_mcp.a.bB,n);this.dQ(_mcp.a.c);_js.Trace.logInfo(_a.a.g,"Context.SmimeEncryptMessage is set to {0}",n);return n},F:function(){if(!_a.j.a||!_a.j.k()||!this.cT()||_g.a.a().a().bl.AlwaysShowFrom)return!1;var n=_g.a.a().bl.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.dS(_mcp.a.bF)},dJ:function(n){this.dR(_mcp.a.bF,n);this.dQ(_mcp.a.c);_js.Trace.logInfo(_a.a.g,"Context.SmimeSignMessage is set to {0}",n);return n},cM:function(){return _g.a.a().bl.SmimeAdminSettings&&(_g.a.a().bl.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bl.AlwaysShowFrom)||this.i()?!1:!0},cN:function(){return _g.a.a().bl.SmimeAdminSettings&&(_g.a.a().bl.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bl.AlwaysShowFrom)||this.i()?!1:!0},bj:function(){return this.dS(_mcp.a.z)},eX:function(n){this.dR(_mcp.a.z,n);return n},cH:function(){return this.dS(_mcp.a.bo)},fd:function(n){this.dR(_mcp.a.bo,n);return n},S:function(){if(this.bm()||_y.c.a.h()||this.r())return!1;var n=this.C();return!n||!!n.a()||n.b()},bz:function(){return OwaApplication.b?!1:this.a()!==8&&!this.l()},en:function(){return this.dS(_mcp.a.bd)},gd:function(n){this.dR(_mcp.a.bd,n);return n},bg:function(){return this.fE},l:function(){return this.a()===11||this.a()===12||this.a()===13},cz:function(){return this.dS(_mcp.a.bs)},H:function(n){this.dR(_mcp.a.bs,n);return n},eF:function(){return this.dS(_mcp.a.br)},T:function(n){this.dR(_mcp.a.br,n);return n},fS:function(){return this.dS(_mcp.a.bP)},U:function(n){this.dR(_mcp.a.bP,n);return n},dD:function(n){this.dR(_mcp.a.bV,n);return n},cC:function(){return this.dS(_mcp.a.P)},di:function(n){this.dR(_mcp.a.P,n);return n},N:function(){return this.dS(_mcp.a.g)},df:function(n){this.dR(_mcp.a.g,n);return n},R:function(){return this.dS(_mcp.a.bb)},dr:function(n){this.dR(_mcp.a.bb,n);return n},eG:function(){return this.dS(_mcp.a.bh)},dv:function(n){this.dR(_mcp.a.bh,n);return n},bW:function(){return this.dS(_mcp.a.N)},fu:function(n){this.dR(_mcp.a.N,n);return n},fO:function(){return this.dS(_mcp.a.by)},ge:function(n){this.dR(_mcp.a.by,n);return n},cL:function(){this.eJ||(this.eJ=this.ey());return this.eJ},ct:function(){return this.dS(_mcp.a.bt)},bP:function(n){this.dR(_mcp.a.bt,n);return n},bu:function(){return this.dS(_mcp.a.A)},cg:function(n){this.dR(_mcp.a.A,n);return n},bn:function(){if(!$a(this.N())){var n=_g.c.p(this.N().f(),_g.c.a());return!!n&&n.bl.Value.toUpperCase()==="TRUE"}return!1},cl:function(n){_js.Trace.logInfo(_a.a.a,"Setting IsOmeRequested to {0}",n);this.gk(n);return n},bZ:function(){return this.ev},dx:function(n){this.ev=n;return n},dC:function(n){this.ew=n;return n},fY:function(n){this.p(_mcp.a.bT(_y.dw,n,_mcp.a.j.a,0));this.f(_mcp.a.bT(_y.M,n,_mcp.a.b.a,0));this.m(_mcp.a.bS(n,_mcp.a.l.a,!0));this.ds(_mcp.a.bS(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.er(!1);this.gg(n.StoreId)}this.fZ(n);this.cm(0===this.a()||4===this.a())},cR:function(n){_g.dH.isInstanceOfType(n)?this.f(1):_g.dG.isInstanceOfType(n)?this.f(2):_g.ek.isInstanceOfType(n)&&this.f(3);this.fH(n,n.f());this.cn(n.bl.ReferenceItemId);this.dy(n.p());this.E(n.bl.ItemId);this.K(n.bl.Subject);this.I(n.f().bl.Value);this.ci(n.bl.From);this.v(n.k()?n.k().c:null);this.bi(n.m()?n.m().c:null);this.cf(n.o()?n.o().c:null);this.m(!1);this.dj(n.bB());this.eC(n);this.bN(n.by());this.dF(n.bH());this.dm(n.bl.IsDeliveryReceiptRequested);this.dt(n.bl.IsReadReceiptRequested);this.C()&&!this.C().a()?this.o(this.C().e()):$a(n.f())||(n.bN()?this.o(n.bN().a()):this.o(n.cJ()===1?"Text":"HTML"));this.fo(n);this.cm(!1);this.er(!0);_js.Trace.logInfo(_a.a.a,"Initialized context with smart response, context: {0}",this)},cQ:function(n){if($a(n))throw Error.argumentNull("message");this.fH(n,n.w());this.dc(n);this.E(n.bl.ItemId);this.K(n.bl.Subject);this.I(n.bN()?n.bN().bl.Value:n.w().bl.Value);this.eX(n.bl.ConversationId);if(_g.q.isInstanceOfType(n)){var t=n;this.ci(t.bl.From);this.v(t.k()?t.k().C():null);this.bi(t.m()?t.m().C():null);this.cf(t.o()?t.o().C():null);this.dm(t.bl.IsDeliveryReceiptRequested);this.dt(t.bl.IsReadReceiptRequested)}else if(_g.bw.isInstanceOfType(n)){var u=n;this.ci(u.bl.From)}this.m(!1);this.dj(n.bB());this.eC(n);this.bN(n.by());this.dF(n.bH());n.by()&&!n.by().a()?this.o(n.by().e()):n.bN()?this.o(n.bN().a()):this.o(n.cJ()===1?"Text":"HTML");this.fa(_g.bj.isInstanceOfType(n));if(this.bm()){var i=n;this.eE(i.u());this.fc(_g.H.isInstanceOfType(i));i.bl.From&&this.ci(i.bl.From);i.bl.Sender&&this.dE(i.bl.Sender)}n.bT()&&n.bT().b()?this.bp(n.bT()?n.bT().c:null):(!this.en()||this.g())&&this.bp(n.T()?n.T().c:null);if(this.B()&&n.w().a()==="Text")for(var r=0;r<this.B().b();r++)this.B().c(r)&&this.B().c(r).b()&&this.B().c(r).f(!1);this.fo(n);this.cm(!0);this.er(!0);_js.Trace.logInfo(_a.a.a,"Initialized context with draft, context: {0}",this)},O:function(n){this.dz(n);this.fV(n)},fn:function(){this.dZ("OnAsyncSendCallbackEvent",this)},w:function(n){var i=new _g.q;var t;this.fC(i,t={val:n}),n=t.val;return i},bs:function(n){var i=new _g.bw;var t;this.fC(i,t={val:n}),n=t.val;return i},fi:function(){var t=this.fj();_a.b.b(this.ej,"GetEditorContentCommand");this.ej.a();var n=this.M();t.a()==="Text"&&(n=_mcp.a.bX(n));t.b(n);this.eu=_js.d.a(n)?0:n.length;_js.Trace.logInfo(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.eu);return t},gj:function(n){var t=this.ed();if(!t||this.bb()===t.i()){this.dj(n);t&&t.A(n)}},fk:function(){if(this.et&&this.eU){this.ej.a();if($a(this.ed())){this.eA(_mcp.b.b(this));_js.Trace.logInfo(_a.a.a,"Captured baseline for the first time, context: {0}",this);if(this.eI&&this.ee){this.ee.s(this.ed().a());this.eI=!1}if(!this.h()||this.en()&&this.cP()){this.ee=_mcp.b.b(this);_js.Trace.logInfo(_a.a.a,"Captured initial baseline for context: {0}",this)}}else{_mcp.b.z(this.ed(),this);_js.Trace.logInfo(_a.a.a,"Updated baseline, context: {0}",this)}}},fq:function(){if($a(this.ed()))return!1;this.ej.a();return!this.ed().t(this)},bE:function(n){var t=null;if(this.d()==="HTML"){var r,i;i=_a.v.a(this.M(),r={val:t}),t=r.val,i}else t=this.M();t=t?t.length>n?t.substr(0,n)+"...":t:"";return t},em:function(n,t,i,r,u){this.v(new _js.f);var f=n?n.Mailbox:null;if(!_mcp.a.a){var h=_g.a.a().c();_mcp.a.a=_js.d.a(h.bl.SharePointUrl)?h.bl.UserEmailAddress||"":h.bl.LogonEmailAddress||""}if(this.fL()||this.a()!==8&&(!u||!u.b())&&f&&(2!==this.a()||!_mcp.a.bR(f.EmailAddress))){this.j().a(f);_js.Trace.logInfo(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.n.g(n),_mcp.a.a)}if(this.a()===2||this.a()===8){_js.Trace.logInfo(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.eM(t,this.j(),f,null);_js.Trace.logInfo(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.bi(new _js.f);this.eM(i,this.q(),f,this.j());_js.Trace.logInfo(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.cf(new _js.f);this.eM(r,this.c(),f,this.j())}if(u&&u.b()>0)if(this.a()===1){this.j().g();for(var s=0;s<u.b();s++){var l=u.c(s);this.j().a(l)}}else if(this.a()===2)for(var e=0;e<u.b();e++){var o=u.c(e);var a=this;if(this.j().b()===this.j().h(function(n){return _g.n.b(o,n)})){var v=this;var c=this.q().h(function(n){return _g.n.b(o,n)});c!==this.q().b()&&this.q().n(c);this.j().a(o)}}if(this.a()!==8&&f&&0===this.j().b()&&(!this.q()||0===this.q().b())){this.j().a(f);_js.Trace.logInfo(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.n.g(n))}this.fg()},toString:function(){var n="Id="+this.b()+"; Op="+this.a()+"; Mode="+this.n()+"; Oid=";n+=this.bf()?this.bf().Id+":"+this.bf().ChangeKey+";":this.eh&&this.eh.bl.ItemId?this.eh.bl.ItemId.Id+":"+this.eh.bl.ItemId.ChangeKey+";":"null;";n+=" Did=";n+=this.h()?this.h().Id+":"+this.h().ChangeKey+";":this.ba()&&this.ba().bl.ItemId?this.ba().bl.ItemId.Id+":"+this.ba().bl.ItemId.ChangeKey+";":"null;";n+=" Subject="+this.A()+"; ContentLength="+(_js.d.a(this.M())?"0":this.M().length.toString())+"; BodyType="+this.d()+";";var r;_mcp.a.bk("To",this.j(),this.bh(),r={val:n}),n=r.val;var i;_mcp.a.bk("Cc",this.q(),this.Z(),i={val:n}),n=i.val;var t;_mcp.a.bk("Bcc",this.c(),this.L(),t={val:n}),n=t.val;n+=" AutoSig="+this.cJ()+"; Imp="+this.bb()+"; QuotedBodyLength="+(_js.d.a(this.cI())?"0":this.cI().length.toString())+"; IsComplete="+this.eP()+"; IsMeeting="+this.bm()+"; IsMeetingForward="+this.bx()+"; IsReplyBcc="+this.cE()+"; HasLocation="+this.bV()+"; MeetingTime="+(this.eo()?this.eo().S()+":"+(this.eo().L()?this.eo().L().j():"null")+":"+(this.eo().K()?this.eo().K().j():"null"):"null")+"; From="+_g.n.g(this.k())+"; Sender="+_g.n.g(this.bo())+"; IsFromShown="+this.i()+"; IsBccShown="+this.s()+"; AttachmentCount="+(this.B()?this.B().b().toString():"0")+"; UpgradeFailed="+this.G()+"; HasBaseline="+(!!this.ed()).toString()+"; HasInitBaseline="+(!!this.ee).toString()+"; UserSaved="+this.bU()+"; IsReplyForward="+this.be()+"; HasDraft="+(!!this.ba()).toString()+"; HasRMLD="+(!!this.C()).toString()+"; Classified="+this.bw()+"; Class="+this.cx()+"; Sensitivity="+this.D()+"; DeliveryReceipt="+this.bc()+"; ReadReceipt="+this.bd()+"; SmimeEncryptMessage="+this.u()+"; SmimeSignMessage="+this.F()+"; ConversationId="+(this.bj()?this.bj().Id+":"+this.bj().ChangeKey:"null")+" ParentConversationNodeId="+this.cH()+"; IsOriCalId="+this.eR()+"; OccurrenceRefMaster="+this.bY()+"; IsLoadedDraft="+this.bX()+"; IsMovedToDraftFromOutbox="+this.eQ()+"; IsUpgraded="+this.g()+"; IsCached="+this.fp+";";return n},cV:function(){_js.Trace.logInfo(_a.a.a,"Context reset start.");this.fe(null);this.a()&&this.f(0);this.n()&&this.p(0);this.bf()&&this.cn(null);this.e()&&this.dz(null);this.h()&&this.E(null);_js.d.a(this.A())||this.K(null);_js.d.a(this.M())||this.I("");this.j()&&this.v(null);_js.d.a(this.bh())||this.dK(null);this.q()&&this.bi(null);_js.d.a(this.Z())||this.cY(null);this.c()&&this.cf(null);_js.d.a(this.L())||this.cX(null);this.cJ()||this.m(!0);this.bb()!=="Normal"&&this.dj("Normal");_js.d.a(this.cI())||this.eB(null);this.eP()&&this.er(!1);this.bm()&&this.fa(!1);this.bx()&&this.fc(!1);this.cE()&&this.fy(!1);this.cF()&&this.fz(null);this.bV()&&this.ft(!1);this.eo()&&this.fA(null);this.k()&&this.ci(null);this.bo()&&this.dE(null);this.g()&&this.cm(!1);this.i()&&this.dp(!1);this.s()&&this.bL(!1);this.B()&&this.bp(null);this.G()&&this.dL(!1);this.ed()&&this.eA(null);this.bU()&&this.eY(!1);this.be()&&this.du(!1);this.ba()&&this.dc(null);this.C()&&this.bN(null);_js.d.a(this.t())||this.bJ(null);this.bw()&&this.bM(!1);_js.d.a(this.eN())||this.bI(null);_js.d.a(this.cx())||this.bG(null);_js.d.a(this.cy())||this.bH(null);this.fl()&&this.fs(!1);this.D()!=="Normal"&&this.dF("Normal");this.bc()&&this.dm(!1);this.bd()&&this.dt(!1);this.u()&&this.dH(!1);this.F()&&this.dJ(!1);this.fm()&&this.dI(null);this.bj()&&this.eX(null);_js.d.a(this.cH())||this.fd(null);this.eR()&&this.ds(!1);this.bY()&&this.ck(!1);this.bX()&&this.eZ(!1);this.eQ()&&this.dq(!1);this.N()&&this.df(null);if(this.cz()){_y.k.a(this.cz(),null,"ContextReset",null,null);this.H(null)}_js.Trace.logInfo(_a.a.a,"Context reset end.")},cS:function(){return!!this.e().by()&&0===this.e().by().a()&&!this.e().by().j()&&!this.e().by().k()},ce:function(){var n=null;if(this.k()&&this.k().Mailbox&&!_js.d.a(this.k().Mailbox.EmailAddress))n=this.k().Mailbox;else if(this.bo()&&this.bo().Mailbox&&!_js.d.a(this.bo().Mailbox.EmailAddress))n=this.bo().Mailbox;else if(!_js.d.a(_mcp.a.a)){n=new _g.d;n.EmailAddress=_mcp.a.a;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},cT:function(){if(!_a.j.a||_a.j.s)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.ba()&&!this.eT(this.ba())?!1:this.e()&&!this.eT(this.e())?!1:_js.d.a(this.bu())?!0:!1},eT:function(n){if(_js.d.a(n.bl.ItemClass)||n.bl.ItemClass==="IPM.Note"||n.bA())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bl.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bl.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bl.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bl.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bl.ItemClass==="IPM.Post"?!0:!1}},cs:function(n){_js.Trace.logInfo(_a.a.g,"Updating S/MIME options...");if(_a.j.a)switch(n){case 6:this.dH(!0);this.dJ(!1);break;case 10:case 11:this.dH(!1);this.dJ(!0);break;case 12:case 13:case 14:this.dH(!0);this.dJ(!0);break;case-1:case 0:default:this.dH(!1);this.dJ(!1);break}},gl:function(n){_js.Trace.logInfo(_a.a.g,"Upgrading S/MIME options...");if(_a.j.a)switch(n){case 6:this.dH(!0);break;case 10:case 11:this.dJ(!0);break;case 12:case 13:case 14:this.dH(!0);this.dJ(!0);break;case-1:case 0:default:break}},bq:function(){if(this.cz()){var t=!1;var n=this;this.eV=function(i){if(!t&&n.cz()){_y.k.a(n.cz(),null,i);n.H(null);t=!0}}}},ey:function(n,t){var i=this.fm();if(!i||!i.length)return null;$a(n)&&(n=0);$a(t)&&(t=i.length);for(var r=new _ff.e,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_js.d.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_js.d.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},fC:function(n,t){t.val=$a(t.val)?!1:t.val;n.bQ(this.A());n.dp(this.bb());n.bL(this.h());n.bb(new(_a.gc.$$(_g.Attachment,_g.bN)));if(this.r()){var o=_g.a.a().bl.SmimeAdminSettings.ClearSign;n.eL(this.u()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bl.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.ck(this.fh(t.val)):n.ck(new _g.u(new _g.G(this.d(),"")));var e=_a.bk.b(this.fP());n.gL(new _g.kC(e))}else{n.ck(this.fh(t.val));(this.ba()&&this.ba().bA()||this.e()&&this.e().bA())&&n.eL("IPM.Note");this.B()&&n.T().g(this.B().f())}n.ir(this.C());n.cN(this.D());n.fa(this.bw());n.eV(this.cx());n.eW(this.cy());n.eX(this.eN());n.gD(this.bS());n.gC(this.bR());n.gB(this.fK());if(this.N()){n.fO(new(_a.gc.$$(_g.bL,_g.bq)));n.bJ().g(this.N().f())}if(_g.q.isInstanceOfType(n)){var i=n;i.cF(this.k());if(this.r()&&this.ei){if(this.ei===1){i.ce(new(_a.gb.$$(_g.d)));this.j()&&i.k().g(this.j().f());i.ct(new(_a.gb.$$(_g.d)));this.q()&&i.m().g(this.q().f())}else if(this.ei===2){i.cC(new(_a.gb.$$(_g.d)));this.c()&&i.o().e(this.c().c(this.ex))}else if(this.ei===3){i.cC(new(_a.gb.$$(_g.d)));this.c()&&i.o().g(this.c().f())}}else{i.ce(new(_a.gb.$$(_g.d)));this.j()&&i.k().g(this.j().f());i.ct(new(_a.gb.$$(_g.d)));this.q()&&i.m().g(this.q().f());i.cC(new(_a.gb.$$(_g.d)));this.c()&&i.o().g(this.c().f())}i.cO(this.bc());i.cP(this.bd());i.fq(this.u());i.fr(this.F())}else{var u=n;u.ca(this.bA());var f=_g.a.a().c();var r=null;r=_js.d.a(f.bl.LogonEmailAddress)?null!==this.k()&&this.k().Mailbox?this.k().Mailbox.EmailAddress:_h.l.f(null)||f.bl.UserEmailAddress:f.bl.LogonEmailAddress;if(r){u.g(new _g.bh);u.bl.From.Mailbox=new _g.d;u.bl.From.Mailbox.EmailAddress=r}}},eM:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.n.b(u,i)){_js.Trace.logInfo(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.a.bR(u.EmailAddress)||this.ga(u.EmailAddress)){_js.Trace.logInfo(_a.a.a,"Excluding self address {0}",_mcp.a.a||"null");continue}var e=this;if(r&&r.b()!==r.h(function(n){return _g.n.b(u,n)})){_js.Trace.logInfo(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},ga:function(n){var t=this.k();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},fI:function(n,t){this.dQ("ShowMeetingReadonlyFields")},fZ:function(n){var t=this.gb(n);switch(this.a()){case 0:case 4:this.E(t);break;case 1:case 2:case 3:this.cn(t);break}},fo:function(n){if(n.bJ()){this.df(new _js.f);this.N().p(n.bJ().f())}},gb:function(n){var t=null;if(!$a(n)&&"Id"in n){t=new _g.g(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},fH:function(n,t){0===n.cJ()&&n.fU(t&&t.a()==="Text"?1:3)},fX:function(n){var r=_h.l.f(n);if(r){this.ci(new _g.bh);this.k().Mailbox=new _g.d;this.k().Mailbox.EmailAddress=r}this.ds(!1);this.C()&&!this.C().a()?this.o(n.by().e()):n.bN()?this.o(n.bN().a()):n.w()&&this.o(n.w().a());switch(this.a()){case 1:case 2:case 12:this.eC(n);if(_g.q.isInstanceOfType(n)){var t=n;t.q()?this.em(t.bl.From||t.bl.Sender,null,null,null,null):this.em(t.bl.From||t.bl.Sender,t.k()?t.k().c:null,t.m()?t.m().c:null,t.o()?t.o().c:null,t.cE()?t.cE().c:null);this.fy(this.a()===2&&n.hP()&&!t.bl.IsGroupEscalationMessage);this.dy(n.eF())}else if(_g.bw.isInstanceOfType(n)){var u=n;this.em(u.bl.From||u.bl.Sender,null,null,null,null)}this.eW(n);break;case 5:case 6:case 7:if(_g.q.isInstanceOfType(n)){var i=n;this.em(i.bl.From||i.bl.Sender,i.k()?i.k().c:null,i.m()?i.m().c:null,i.o()?i.o().c:null,i.cE()?i.cE().c:null)}break;case 3:_g.bj.isInstanceOfType(n)||this.eC(n);this.dy(n.eF());this.fg();this.eW(n);break;case 9:case 10:_g.q.isInstanceOfType(n)?this.em(n.bl.Sender,null,null,null,null):_g.bw.isInstanceOfType(n)&&this.em(n.bl.Sender,null,null,null,null);this.eW(n);break;default:this.fF();break}_js.Trace.logInfo(_a.a.a,"Initialized context with original email message, context: {0}",this)},fV:function(n){this.cn(n.bl.ItemId);var i=this.cS();this.bN(i?null:n.by());this.gi(n.cK());this.dF(n.bH());this.I(this.M()||"");this.C()&&!this.C().a()?this.o(this.C().e()):n.bN()?this.o(n.bN().a()):this.o(n.cJ()===1?"Text":"HTML");if(!this.g()){this.cm(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.j.a&&n.bA()||i||this.C()&&this.C().a()||this.bp(n.T()?n.T().c:null)}if(_g.ICalendaring.isInstanceOfType(n)){var t=n;t.bf();this.fW(t)}else if(_g.q.isInstanceOfType(n)||_g.bw.isInstanceOfType(n)){if(3===this.a()&&!this.g()){this.dj(n.bB());_js.Trace.logInfo(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.bb(),_h.bj.a(n.bl.ItemId))}this.fX(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.fG();_g.q.isInstanceOfType(n)&&n.bG?this.er(!1):this.er(!0)},fU:function(n){var t=null;_g.bB.isInstanceOfType(n)||_g.ba.isInstanceOfType(n)?t=n.bl.From:n.z()?t=n.z():_js.Trace.logError(_a.a.a,"ICalendaring doesnt have an organizer");return t},fG:function(){var n=new _ff.e;this.bx()&&n.h(_g.H.a(this.B()));if(this.eh&&_a.j.a&&this.eh.bA()&&this.eh.ej()){var t=this.eh.T().a(0).bl.AttachmentId.Id;n.c(t)}this.gc(n.i())},fW:function(n){this.ds(!0);n.w()&&this.o(n.w().a());var r=this.fU(n);var t;var i;if(_g.bB.isInstanceOfType(n)||_g.ba.isInstanceOfType(n)){t=n.k()?_g.n.f(n.k().c):null;i=n.m()?_g.n.f(n.m().c):null}else{t=n.p()?_g.n.f(_g.s.d(n.p().c)):null;i=n.s()?_g.n.f(_g.s.d(n.s().c)):null}switch(this.a()){case 1:case 2:this.em(r,t,i,null,null);break;case 5:case 6:case 7:this.em(r,t,i,null,null);this.eE(n);this.fv(!0);break;case 8:var u=n.p().s();u.g(n.C().f());t=_g.n.f(_g.s.d(u.c));this.em(r,t,i,null,null);this.eE(n);this.fv(!0);break;case 3:if(_g.H.isInstanceOfType(n)||_g.i.isInstanceOfType(n)){this.fc(!0);this.ci(r);this.eE(n)}break;default:this.fF();break}this.fa(!0);_js.Trace.logInfo(_a.a.a,"Initialized context from original calendar item, context: {0}",this)},eE:function(n){this.fA(_cc.r.e(n));this.fz(n.r());this.ft(!!this.cF()&&!_js.d.a(this.cF().bl.DisplayName))},gi:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.R.JN;break;case 3:t=_nbs.a.Pj;break;case 5:t=_nbs.a.TX;break;case 6:t=_nbs.a.dc;break;case 7:t=_nbs.a.bV;break;case 8:t=_nbs.a.Qk;break;case 9:t=_nbs.a.jD;break;case 10:t=_nbs.a.MI;break}this.eO()&&(t=_nbs.a.eB);var i=String.format(_nbs.a.fE,t,n);_js.Trace.logInfo(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.K(i.substr(0,255));_js.Trace.logInfo(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.A(),255)}else this.K(i)},eW:function(n){this.eX(n.bl.ConversationId);_g.q.isInstanceOfType(n)?this.fd(n.bl.InternetMessageId):_g.bw.isInstanceOfType(n)&&this.fd(n.bl.InternetMessageId)},fF:function(){var n=_js.l.b(_y.M,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},eC:function(n){this.bM(n.dB());this.bI(n.eE());this.bG(n.eC());this.bH(n.eD());this.fs(n.hK())},fh:function(n){return n?this.fj():this.fi()},fj:function(){var n=new _g.u(new _g.G("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.cC()){_js.Trace.logInfo(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.d());n.c(this.d())}else{_js.Trace.logInfo(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},fg:function(){if(_y.c.a.h()){var n=this.ce();if(n){if(!this.fr(this.j(),n.EmailAddress)&&!this.fr(this.q(),n.EmailAddress)){this.q()||this.bi(new _js.f);this.q().a(n);_js.Trace.logInfo(_a.a.a,"Adding self to CC")}}else _js.Trace.logError(_a.a.a,"Could not add self to CC as the address was missing")}},fr:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},gk:function(n){var t=null;if(n){$a(this.N())?this.df(new _js.f):t=_g.c.p(this.N().f(),_g.c.a());if($a(t)){var i=new _g.bq;i.ExtendedFieldURI=_g.c.a();t=new _g.bL(i);this.N().a(t)}t.c("True")}else{if($a(this.N()))return;t=_g.c.p(this.N().f(),_g.c.a());$a(t)||t.c("False")}}};_mcp.y=function(n){this.e={};this.f=n};_mcp.y.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.J(t))}else this.e[n]=new _mcp.J(t)},g:function(n,t){var u=n.a;var i=u.L;var r=i.b();var o=i.h();var f=!1;if(i.bX())_js.Trace.logInfo(_a.a.a,"Not discarding a loaded draft for context {0}",r);else if(i.bU())_js.Trace.logInfo(_a.a.a,"Not discarding an explicitly saved draft for context {0}",r);else if(u.d().e())_js.Trace.logInfo(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",r);else if(u.e().b())_js.Trace.logInfo(_a.a.a,"Not discarding a draft currently being sent for context {0}",r);else{var e=!1;if(t)_js.Trace.logInfo(_a.a.a,"Skipping dirty check for context {0}",r);else{_js.Trace.logInfo(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away. Context:{0}",i);e=u.bw()}if(e)_js.Trace.logInfo(_a.a.a,"Not discarding a dirty draft for context {0}",r);else if(i.ee)if(i.ee.q(i.ed())){if(_g.k.b&&i.be()&&!i.h()){_js.Trace.logInfo(_a.a.a,"Calling main window to remember the pending discard for context {0}",r);_g.k.b.hy(r,!i.bU());f=!0}else if(!i.l()){_js.Trace.logInfo(_a.a.a,"Discarding unused draft for context {0}",r);this.b(r,o,u.U,i.bU());f=!0}}else _js.Trace.logInfo(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",r);else _js.Trace.logInfo(_a.a.a,"Not discarding without an initial baseline for context {0}",r)}return f},b:function(n,t,i,r){i||(i=new _mcp.F(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.a(t,u);i.a(f,null,null,null);delete this.e[n];_js.Trace.logInfo(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.e[n]=new _mcp.J(u);_js.Trace.logInfo(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.F(new _bc.b),!1)}};_mcp.b=function(){_mcp.b.initializeBase(this)};_mcp.b.$$cctor=function(){_mcp.b.h.c(_mcp.b.f);_mcp.b.e.c(_mcp.b.f);_mcp.b.d.c(_mcp.b.f);_mcp.b.c.c(new _a.bv(_g.Attachment));_mcp.b.g.c(new _a.bv(_g.bL))};_mcp.b.b=function(n){var t=new _mcp.b;_mcp.b.z(t,n);return t};_mcp.b.z=function(n,t){n.K(t.z());n.s(t.M());if(t.j()){n.B(new _js.f);n.e().p(t.j().f())}else n.B(null);n.L(t.bh());if(t.q()){n.x(new _js.f);n.d().p(t.q().f())}else n.x(null);n.D(t.Z());if(t.c()){n.w(new _js.f);n.c().p(t.c().f())}else n.w(null);if(t.B()){n.p(new _js.f);n.b().p(t.B().f())}else n.p(null);if(t.N()){n.y(new _js.f);n.r().p(t.N().f())}else n.y(null);n.C(t.L());n.A(t.bb());n.z(t.k());n.E(t.t());n.H(t.D());n.F(t.bc());n.G(t.bd());n.I(t.u());n.J(t.F())};_mcp.b.a=function(n,t,i,r){if(i!==r&&!(_js.d.a(i)&&_js.d.a(r))||!_mcp.b.x(n,t))return!1;if($a(n)||$a(t))return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.b.i(e,f))return!1}return!0};_mcp.b.i=function(n,t){return $a(n)&&!$a(t)||$a(t)&&!$a(n)?!1:$a(n)&&$a(t)?!0:_g.n.b(n,t)};_mcp.b.x=function(n,t){var r=_mcp.b.y(n);var i=_mcp.b.y(t);return r===i};_mcp.b.y=function(n){return $a(n)?0:n.b()};_mcp.b.w=function(n,t){if(!_mcp.b.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.b.B(u,r))return!1}return!0};_mcp.b.A=function(n,t){return _h.cI.a(n,t)};_mcp.b.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bl.AttachmentId&&t.bl.AttachmentId||!t.bl.AttachmentId&&n.bl.AttachmentId?!1:n.bl.AttachmentId&&n.bl.AttachmentId.Id!==t.bl.AttachmentId.Id?!1:n.bl.Name!==t.bl.Name?!1:n.bl.ContentType!==t.bl.ContentType?!1:n.bl.ContentId!==t.bl.ContentId?!1:n.bl.ContentLocation!==t.bl.ContentLocation?!1:n.a()!==t.a()?!1:!n.o()&&t.o()||!t.o()&&n.o()?!1:n.o()&&!n.o().Z(t.o())?!1:n.b()!==t.b()?!1:!0};_mcp.b.prototype={f:function(){return this.dS(_mcp.b.u)},K:function(n){this.dR(_mcp.b.u,n);return n},a:function(){return this.dS(_mcp.b.m)},s:function(n){this.dR(_mcp.b.m,n);return n},e:function(){return this.dS(_mcp.b.h)},B:function(n){this.dR(_mcp.b.h,n);return n},j:function(){return this.dS(_mcp.b.v)},L:function(n){this.dR(_mcp.b.v,n);return n},d:function(){return this.dS(_mcp.b.e)},x:function(n){this.dR(_mcp.b.e,n);return n},h:function(){return this.dS(_mcp.b.k)},D:function(n){this.dR(_mcp.b.k,n);return n},c:function(){return this.dS(_mcp.b.d)},w:function(n){this.dR(_mcp.b.d,n);return n},g:function(){return this.dS(_mcp.b.j)},C:function(n){this.dR(_mcp.b.j,n);return n},i:function(){return this.dS(_mcp.b.o)},A:function(n){this.dR(_mcp.b.o,n);return n},l:function(){return this.dS(_mcp.b.n)},z:function(n){this.dR(_mcp.b.n,n);return n},k:function(){return this.dS(_mcp.b.l)},E:function(n){this.dR(_mcp.b.l,n);return n},o:function(){return this.dS(_mcp.b.r)},H:function(n){this.dR(_mcp.b.r,n);return n},m:function(){return this.dS(_mcp.b.p)},F:function(n){this.dR(_mcp.b.p,n);return n},n:function(){return this.dS(_mcp.b.q)},G:function(n){this.dR(_mcp.b.q,n);return n},u:function(){return this.dS(_mcp.b.s)},I:function(n){this.dR(_mcp.b.s,n);return n},v:function(){return this.dS(_mcp.b.t)},J:function(n){this.dR(_mcp.b.t,n);return n},b:function(){return this.dS(_mcp.b.c)},p:function(n){this.dR(_mcp.b.c,n);return n},r:function(){return this.dS(_mcp.b.g)},y:function(n){this.dR(_mcp.b.g,n);return n},t:function(n){if(this.i()!==n.bb()){_js.Trace.logInfo(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.bb());return!1}if(this.f()!==n.z()){_js.Trace.logInfo(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$a(this.f())?0:this.f().length,$a(n.z())?0:n.z().length);return!1}if(this.k()!==n.t()){_js.Trace.logInfo(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.t());return!1}if(this.o()!==n.D()){_js.Trace.logInfo(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.D());return!1}if(this.m()!==n.bc()){_js.Trace.logInfo(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.bc());return!1}if(this.n()!==n.bd()){_js.Trace.logInfo(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.bd());return!1}if(this.u()!==n.u()){_js.Trace.logInfo(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.u());return!1}if(this.v()!==n.F()){_js.Trace.logInfo(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.F());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.k()?n.k().Mailbox:null;if(!_mcp.b.i(i,t)){_js.Trace.logInfo(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.b.a(this.e(),n.j(),this.j(),n.bh())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.e())?0:this.e().w.length,$a(n.j())?0:n.j().b(),$a(this.j())?0:this.j().length,$a(n.bh())?0:n.bh().length);return!1}if(!_mcp.b.a(this.d(),n.q(),this.h(),n.Z())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.d())?0:this.d().w.length,$a(n.q())?0:n.q().b(),$a(this.h())?0:this.h().length,$a(n.Z())?0:n.Z().length);return!1}if(!_mcp.b.a(this.c(),n.c(),this.g(),n.L())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.c())?0:this.c().w.length,$a(n.c())?0:n.c().b(),$a(this.g())?0:this.g().length,$a(n.L())?0:n.L().length);return!1}if(!_mcp.b.w(this.b(),n.B())){_js.Trace.logInfo(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.B()?n.B().b():0));return!1}if(!_mcp.b.A(this.r(),n.N())){_js.Trace.logInfo(_a.a.a,"snapshotExtendedPropertyCount="+(this.r()?this.r().w.length:0)+", contextExtendedPropertyCount="+(n.N()?n.N().w.length:0));return!1}if(this.a()!==n.M()){_js.Trace.logInfo(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$a(this.a())?0:this.a().length,$a(n.M())?0:n.M().length);return!1}_js.Trace.logInfo(_a.a.a,"Context is clean");return!0},q:function(n){if(!n){_js.Trace.logInfo(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_js.Trace.logInfo(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_js.Trace.logInfo(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_js.Trace.logInfo(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_js.Trace.logInfo(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_js.Trace.logInfo(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_js.Trace.logInfo(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.b.i(i,t)){_js.Trace.logInfo(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.b.a(this.e(),n.e(),this.j(),n.j())){_js.Trace.logInfo(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().w.length:0,n.e()?n.e().w.length:0,this.j(),n.j());return!1}if(!_mcp.b.a(this.d(),n.d(),this.h(),n.h())){_js.Trace.logInfo(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().w.length:0,n.d()?n.d().w.length:0,this.h(),n.h());return!1}if(!_mcp.b.a(this.c(),n.c(),this.g(),n.g())){_js.Trace.logInfo(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().w.length:0,n.c()?n.c().w.length:0,this.g(),n.g());return!1}if(!_mcp.b.w(this.b(),n.b())){_js.Trace.logInfo(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_js.Trace.logInfo(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_js.Trace.logInfo(_a.a.a,"snapshot is clean");return!0}};_mcp.bq=function(n,t){this.g=Function.createDelegate(this,this.i);if($a(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.bq.prototype={f:0,d:null,a:null,b:!0,c:function(){!this.a&&this.b&&(this.a=_js.g.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_js.Trace.logInfo(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_js.Trace.logInfo(_a.a.a,"Clearing timer.");this.a=_js.g.a().b(this.a)}},i:function(){_js.Trace.logInfo(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt){this.cm=Function.createDelegate(this,this.dF);this.cQ=Function.createDelegate(this,this.ed);this.bT=Function.createDelegate(this,this.cY);this.cO=Function.createDelegate(this,this.cT);this.cn=Function.createDelegate(this,this.dG);this.cP=Function.createDelegate(this,this.dD);this.co=Function.createDelegate(this,this.N);_mcp.d.resolveInheritance();this.G=this.dispose;_mcp.d.initializeBase(this);_a.b.b(k,"nativeBridge");this.bL=4;this.L=n;this.T=t||new _bc.b;this.T.w(nt);this.M=this.bc();this.cz=i;this.bM=r;this.bW=u;this.U=new _mcp.F(this.T);this.cL=f;this.bK=s;this.cf=e;this.V=o;this.bt=h;this.bd=c;this.S=l;this.bv=v;this.cA=p;this.cr=a;this.cF=w;this.bb=b;this.bV=y;this.cJ=k;this.ck=d;this.bu=g;this.X=nt;this.cK=tt;this.cI=it;this.cp=rt;this.cq=ut;this.cs=ft;this.by=et;this.bC=ot;this.cB=st;this.bQ=ht;this.bD=ct;this.cc=lt;this.cH=at;this.cN=vt;this.bk=yt;this.bE=pt;if(o){var wt=o;this.bx=wt.v||(wt.v=Function.createDelegate(wt,wt.d))}this.X||(this.bJ=!0);this.V&&this.V.a()==="Mouse"&&this.dE();_js.Trace.logInfo(_a.a.a,"ViewModel created")};_mcp.d.a=function(){return+new Date+":"+Math.random()};_mcp.d.prototype={cz:null,L:null,bM:null,bW:null,cL:null,cf:null,bK:null,T:null,V:null,bv:null,cA:null,cN:null,bt:null,S:null,bd:null,bV:null,cJ:null,cF:null,cc:null,ck:null,bu:null,cp:null,cq:null,cs:null,X:null,cK:null,by:null,bC:null,cB:null,bk:null,bb:null,O:null,U:null,cb:null,M:null,cd:!1,bI:!1,ch:!1,bO:!1,cj:null,cg:!1,bj:!1,cu:!0,cM:!0,cr:null,cI:null,bL:0,cZ:null,bx:null,ce:null,bJ:!1,ci:!1,br:null,bq:null,bQ:null,bD:null,bN:!1,bU:null,bE:null,cH:null,a:function(){return this.L},dH:function(n){if(this.M!==n){this.M=n;this.dQ("InfoBarViewModel")}return n},bG:function(){_a.b.d(this.bQ.c(),"MailComposeViewModel: Smime override factory has not been created");return this.bQ.b()},dC:function(){return this.O.b(7).bz()},W:function(){return this.O.b(0)},z:function(){return this.O.b(10)},b:function(){return this.O.b(2)},Q:function(){return this.O.b(5)},dx:function(){return this.O.b(4)},R:function(){return this.O.b(1)},bX:function(){return this.O.b(6)},e:function(){return this.O.b(7)},d:function(){return this.O.b(8)},bB:function(){return this.O.b(9)},be:function(){return this.O.b(16)},dy:function(){return this.O.b(18)},bi:function(){return this.O.b(3)},cE:function(){return this.O.b(17)},cW:function(){return this.O.b(23)},bh:function(){return this.O.b(19)},bf:function(){return this.O.b(22)},cC:function(){return this.O.b(24)},bo:function(){return this.O.b(25)},ca:function(){return this.O.b(12)},dA:function(){return this.O.b(27)},du:function(){return this.O.b(28)},ds:function(){return this.O.b(29)},c:function(){return this.X},bF:function(){return!this.V.c()||!!this.X},dc:function(n){if(this.ci!==n){this.ci=n;this.dQ("ShouldShowModernAttachmentsIntroductionPeek")}return n},bg:function(){return!1},cD:function(){return"MailCompose"},cV:function(){return!1},bA:function(){var t=this.bF();var n=new _a.u;n.c("P",t);n.b("I",t?this.bZ().toString():"NA");n.b("ET",this.L.eD);return n},dj:function(){return this.bF()||this.V.h()},dJ:function(n){if(this.bJ!==n){this.bJ=n;this.dQ("IsReadyForViewInitialization")}return n},bZ:function(){return!!this.X},bm:function(){return this.bL},db:function(n){if(this.bL!==n){this.bL=n;this.dQ("PopupPanelSize")}return n},q:function(){if(this.z()){var n=this.z();return n.b||(n.b=Function.createDelegate(n,n.f))}else return this.cP},n:function(){return this.cb},f:function(n){_js.Trace.logInfo(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.cb?"non-null":"null",n?"non-null":"null");this.cb=n;return n},bn:function(){return this.cu},C:function(n){this.cu=n;return n},F:function(n){this.cM=n;return n},dm:function(){return this.bk.f()},dk:function(){return this.bk.d()},dr:function(){return this.bk.j()},dp:function(){return this.bk.e()},dq:function(){return this.bk.b()},j:function(){return this.V.a()==="Mouse"?0:1},dh:function(){return this.bk.A()},w:function(){return this.cd},E:function(n){this.cd=n;return n},da:function(n){if(this.bI!==n){this.bI=n;this.dQ("IsInView")}return n},m:function(n){this.ch=n;return n},dd:function(n){var t=this.cX();if(this.bO!==t){this.bO=t;this.dQ("ShouldShowToolbarMessage")}return n},de:function(n){if(this.cj!==n){this.cj=n;this.dQ("ToolbarMessage")}return n},dK:function(n){var t=this.cX();if(t!==this.cg){this.cg=t;this.dQ("ShouldBlockView")}return n},D:function(n){if(this.bj!==n){this.bj=n;this.dQ("IsNavigatingAway")}return n},cX:function(){return this.b()&&(this.b().i()||this.b().h())?!0:this.e()&&this.e().b()?!0:!1},cU:function(){return!this.bk.h()},h:function(n){this.cZ=n;return n},y:function(n){this.bx=n;return n},l:function(n){this.ce=n;var t=this.O.b(29);t&&t.I()&&t.o();return n},bH:function(){return this.L.fR()},g:function(n){if(this.bN!==n){this.bN=n;this.dQ("SharedCommandingBarShown")}return n},bY:function(){return!!this.bv&&this.bv.a().f().Enabled&&this.V.a()==="Mouse"},P:function(){this.bU||(this.bU=new _cmc.T);return this.bU},dG:function(n,t){if(this.L.r()){this.K();this.O.r();this.dQ("SmimeInvalidRecipientsDialogViewModel")}else{this.J();this.O.m();this.dQ("SmimeInvalidRecipientsDialogViewModel")}},dg:function(){this.L.apcl(_mcp.a.c,this.cn)},K:function(){if(this.bH()&&!this.bq){_js.Trace.logInfo(_a.a.a,"Setting mail compose viewmodel override");this.bq=this.bG().c();this.bq.b(this.M)}},J:function(){if(this.bq){this.bq.a();this.bq=null}},N:function(){this.bo().d();this.R().dx()},cG:function(){this.L.b()&&(this.L.en()||this.L.eG())||this.L.fe(_mcp.d.a());_js.Trace.logInfo(_a.a.a,"Init:Context:{0}",this.L);this.O||(this.O=new _mcp.bc(this,this.cr,this.bv,this.bV,this.cA,this.cF,this.cJ,this.X,this.cI,this.cp,this.cq,this.bD,this.cH,this.bk,this.bE));if(this.bH()){_js.Trace.logInfo(_a.a.a,"Creating Smime override factory");this.ct(this.cO)}else this.cT()},ct:function(n){_js.Trace.logInfo(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.bQ.a(function(i){_js.Trace.logInfo(_a.a.a,"Smime override factory created");i.f(t.L,t.S);_js.Trace.logInfo(_a.a.a,"Calling createFactoryCallback");n()})},cT:function(){_js.Trace.logInfo(_a.a.a,"Completing initialization");this.K();this.dg();if(this.M){this.M.p();this.S.a(_y.dy,new _y.dy);this.L.eG()&&this.cR(this.L.fO())}this.D(!1);this.O.b(0).C();if(!this.X){this.V.n(this.bT);this.V.k(this.bT);_js.Trace.logInfo(_a.a.a,"Before unload handler has been hooked up")}},cR:function(n){n===90||n===91||n===92||n===94?this.M.d(n,null,_u.R.RV,this.cQ):this.M.a(n,null)},ed:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.M.b(90);this.M.b(91);this.M.b(92);this.M.b(93);this.M.b(94)},dL:function(n){this.dn(n);_js.Trace.logInfo(_a.a.a,"Set screen view model appbar. ContextId={0}",this.L.b())},dO:function(n){this.dv(n);_js.Trace.logInfo(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.L.b())},cv:function(){_y.hE.prototype.cv.call(this);var n=this.W();if(n.I()){_js.Trace.logInfo(_a.a.a,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.K()}else _js.Trace.logInfo(_a.a.a,"PostTransitionIn view model, not initialized yet");this.da(!0);if(this.L.eG()&&this.L.bW()){var i=this.L.b();this.S.a(_y.ex,new _y.ex(i))}(this.L.a()||this.V.a()!=="TouchNarrow")&&this.L.ev&&this.L.ev();if(this.V.a()==="Mouse"){var t=this;_js.g.a().c(_a.a.c,"PreloadOwaFilePicker",function(){var n=t.Q();n&&n.n()})}if(this.L.ew){this.L.ew(this);this.L.ew=null}this.P().i(this.cD())},cw:function(){_js.Trace.logInfo(_a.a.a,"Post transition out");if(this.e().c()){var n=this.e().c();n.j=this.L.bW()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.d.a(n)}this.da(!1);this.P().d();if(!this.e().d()){if(this.ch){this.R().B();this.L.ej.a()}this.k()}_y.hE.prototype.cw.call(this)},k:function(){_js.Trace.logInfo(_a.a.a,"Calling reset on the mail compose view model, context:{0}",this.L);this.J();this.L.rpcl(_mcp.a.c,this.cn);if(this.O){var n=this.b();if(n&&n.g()){this.O.k();this.L&&!this.ch&&this.L.cV();this.M&&this.M.c.g();this.bf()&&this.bf().g&&this.bf().g.e(!1);this.X||this.V.n(this.bT);this.bx=null;n.e(!1)}else _js.Trace.logWarning(_a.a.a,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.a.a,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.cd=!1},bw:function(){if(this.Q().b()){_js.Trace.logInfo(_a.a.a,"Dirty due to attachment in progress");return!0}var n=this.O.b(1);n.B();return this.L.fq()},bc:function(){$a(this.M)&&this.dH(new _y.t);return this.M},A:function(){_h.v.k()},B:function(){_h.v.g()},dP:function(){this.bq&&this.bq.c()},I:function(){this.dJ(!0)},H:function(){var n=new _y.eF;this.cY(n);return n.b},cY:function(n){this.b().f(n);this.P().d()},o:function(){this.P().d()},df:function(){this.bF()&&this.L&&!_js.d.a(this.L.A())&&!this.X&&(document.title=this.L.A())},dT:function(){_js.Trace.logInfo(_a.a.a,"Disposing view model, context: {0}",this.L?this.L:"null");this.O&&this.O.k();this.br&&this.br.e(this.cm);this.dt&&_ms.b.isInstanceOfType(this.dt)&&this.dt.dispose();_a.jX.prototype.dT.call(this)},cS:function(){this.br&&this.br.a(!0)},dE:function(){if(this.cc&&this.bv&&this.bD&&_y.j.b(9)&&this.bV.d(this.bD.AttachmentDataProviderAvailable)&&!this.bv.a().d().Enabled){var t=this.bE.c()?_u.R.Gg:_u.R.GH;var n=this;this.cc.a(function(i){n.br=i.a(_u.R.MM,t,10,null,null,9);n.dc(!0);n.br.d(n.cm);n.br.b()})}},dF:function(){this.dc(!1)},dD:function(n,t){return t===1?!this.cM:!1}};_mcp.h=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt){_mcp.h.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt])};_mcp.h.prototype={bg:function(){return!0},cD:function(){return"MailInlineCompose"}};_mcp.f=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt){_mcp.f.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt])};_mcp.f.prototype={bg:function(){return!0},cV:function(){return!0},cD:function(){return"GroupInlineCompose"},bR:null,t:function(n){this.bR=n;return n},bS:!1,v:function(n){this.bS=n;return n},bl:null,r:function(n){this.bl=n;return n},bz:null,cl:null,p:function(n){this.cl=n;return n}};_mcp.g=function(n,t){this.b=n;this.c=t};_mcp.g.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.g.prototype={b:null,e:null,c:!1,a:null,f:null,d:null,g:function(){!this.e&&this.b&&(this.e=_a.J.a(this.b.EmailAddress));return this.e},l:function(n){if(!this.c)return n.val.j();_js.Trace.logInfo(_mcp.g.a,"begin calculating initial audience");var t=new _js.f;this.a={};if(this.b){_js.Trace.logInfo(_mcp.g.a,"adding always keep address "+this.g()+" as the first To recipient");t.a(this.b);this.a[this.g()]=0}this.h(t,n.val.j(),0);this.h(t,n.val.q(),1);_js.Trace.logInfo(_mcp.g.a,"end calculating initial audience");this.k(t,n);return t},n:function(n,t){_rw.d.isInstanceOfType(n)&&(this.f=n);this.d=t},k:function(n,t){if(!this.c||!n){t.val.v(n);return}for(var f=new _js.f,e=new _js.f,o=n.w.length,r=0;r<o;r++){var i=n.w[r];var u=_mcp.g.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_js.Trace.logInfo(_mcp.g.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.v(f);t.val.bi(e);if(this.d){this.d.q(e);_js.Trace.logInfo(_mcp.g.a,"Update Cc recipient well with the separated Cc recipients")}},m:function(n,t){if(this.c){var i=t.c;_js.Trace.logInfo(_mcp.g.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.i(r);break;case 2:this.j(u);break;case 3:this.j(u);this.i(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},j:function(n){if(n)for(var u=n.length,r=0;r<u;r++){var f=n[r].h.a();var t=_mcp.g.b(f);_js.Trace.logInfo(_mcp.g.a,"recording removed recipient "+t);if(t in this.a)if(t===this.g()){var i=this;_js.g.a().a(_mcp.g.a,"ProcessAlwaysKeepRecipients",function(){if(i.f){_js.Trace.logInfo(_mcp.g.a,"adding the always keep address "+t+" back in To well");i.f.Z(i.b)}},0)}else{_js.Trace.logInfo(_mcp.g.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},i:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].h.a();var i=_mcp.g.b(u);_js.Trace.logInfo(_mcp.g.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},h:function(n,t,i){var e=t?t.b():0;_js.Trace.logInfo(_mcp.g.a,"merging "+e+" "+_mcp.X.toString(i)+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.g.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.V=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.L);this.A=Function.createDelegate(this,this.D);this.H=Function.createDelegate(this,this.J);_mcp.V.initializeBase(this);this.C=f;this.k=f.a;this.o=n;this.u=t;this.l=f.e;this.z=i;this.B=r;this.G=u};_mcp.V.prototype={u:null,o:null,k:null,l:null,C:null,z:null,B:null,G:null,p:null,m:0,y:!1,t:null,n:null,q:null,v:!1,F:null,f:function(){$a(this.p)&&(this.p=new _y.bf);return this.p},e:function(n){this.p=n;return n},w:function(){return this.l?this.l.bL():null},j:function(n){this.F=n;return n},c:function(n){_a.s.stPT(_a.a.z,"MailComposeReplyLoad",3);this.v=!0;this.n=_y.k.b(_a.a.z,"MailComposeReply",!0);this.q=_y.k.b(_a.a.z,"MailComposeReplyLoad",!0);this.o.f("Inference.Reply",this.k.bl.ItemId,this.k.bl.ConversationId,this.l?this.l.G():null,this.w());this.r(1,n)},d:function(n){_a.s.stPT(_a.a.z,"MailComposeReplyAllLoad",3);this.v=!0;this.n=_y.k.b(_a.a.z,"MailComposeReplyAll",!0);this.q=_y.k.b(_a.a.z,"MailComposeReplyAllLoad",!0);this.o.f("Inference.ReplyAll",this.k.bl.ItemId,this.k.bl.ConversationId,this.l?this.l.G():null,this.w());this.r(2,n)},h:function(n){this.y=!0;this.d(n)},b:function(n){this.o.a("Inference.PostReply",this.k.bl.ItemId,this.w());this.r(12,n)},a:function(n){_a.s.stPT(_a.a.z,"MailComposeForwardLoad",3);this.v=!0;this.n=_y.k.b(_a.a.z,"MailComposeForward",!0);this.q=_y.k.b(_a.a.z,"MailComposeForwardLoad",!0);this.o.f("Inference.Forward",this.k.bl.ItemId,this.k.bl.ConversationId,this.l?this.l.G():null,this.w());this.r(3,n)},g:function(n){this.y=!0;this.a(n)},i:function(){if(!this.C.o())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _c.bt(this.k.bl.ItemId.Id,t.Id);n.v(this.H);n.u(this.A);OwaApplication.a.a(n)},J:function(n){var i=n.d;if(i.length>0){var t=this.B.e(_g.g.b(i));t.v(this.I);t.u(this.A);OwaApplication.a.a(t)}else this.D(n)},D:function(n){this.l.E().b(9500);this.l.E().a(9500)},L:function(n){var t=n;if(t.a){this.l.E().b(9500);var i=this.z.b(t.c[0],!1,t.a.cJ(),t.a.by());_y.c.a.c()||i.p(0);this.f().a(i)}else this.D(n)},r:function(n,t){this.m=n;this.M(t)},M:function(n){var u=_g.i.isInstanceOfType(this.k);n||(n=!_y.c.a.c());var t=this.z.a(n,!1);t.U(this.v);n&&t.p(0);var r=null;switch(this.m){case 1:r=!t.n()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:r=!t.n()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:r=!t.n()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(r&&this.n){this.n.p=r;t.H(this.n);t.T(this.q);t.bq()}t.dA(this.k.bl.ParentFolderId);this.l&&t.dB(this.l.bS());t.f(this.m);t.du(!0);t.ez=this.y;t.m(!t.ez||this.m===3);var i=new _g.bh;i.Mailbox=new _g.d;i.Mailbox.EmailAddress=this.u.c().bl.UserEmailAddress;i.Mailbox.Name=this.u.c().bl.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.dE(i);t.ev=this.F;if(u){var o=this.k;if(o.bS())t.O(o);else{t.ds(!0);t.cn(this.k.bl.ItemId);t.ck(_g.i.d(o))}}else t.O(this.k);if((this.m===1||this.m===2)&&_g.q.isInstanceOfType(this.k)){var e;var f=this.k;var l=this.E(f.o())+this.E(f.m())+this.E(f.k());e=this.m===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.d.b(_a.a.z,e);c.j=l.toString();_a.d.a(c)}if((_g.q.isInstanceOfType(this.k)||u)&&t.eT(this.k)){var s=_a.j.d();s&&t.gl(this.k.dh());if(this.k.bR()||t.r()&&s){var h=this;this.K(function(n){n.b(t,h.k,h.m)})}else this.f().a(t)}else this.f().a(t)},K:function(n){_js.Trace.logInfo(_a.a.g,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.G.a(function(i){if(!t.t){_js.Trace.logInfo(_a.a.g,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");t.t=i.f();t.t.a(t,t.u,function(n,t){var i=new _cc.L(200,_cc.L.a(n.bl.ItemId,t.bY()));i.I=t.b();return i},function(n,t,i){var r=new _mcp.bv(n,t,i);return r.toString()})}_js.Trace.logInfo(_a.a.g,"[MailResponseViewModel] Executing smime operation.");n(t.t)})},E:function(n){return n?n.b():0}};_mcp.W=function(n,t,i,r,u){this.c=n;this.f=t;this.d=i;this.b=r;this.e=u};_mcp.W.prototype={c:null,f:null,d:null,b:null,e:null,a:function(n){return new _mcp.V(this.c,this.f,this.d,this.b,this.e,n)}};_mcp.C=function(){_mcp.C.initializeBase(this)};_mcp.C.prototype={c:null,d:"Normal",e:!1,f:!1,a:!1,b:!1,i:!1,j:!1,g:null,h:!1,k:!1,l:!1,r:function(){if($a(this.c)){this.c=new _js.f;this.c.a("Normal");this.c.a("Personal");this.c.a("Private");this.c.a("Confidential")}return this.c},o:function(n){if(this.d!==n){this.d=n;this.dQ("Sensitivity")}return n},m:function(n){if(this.e!==n){this.e=n;this.dQ("IsDeliveryReceiptRequested")}return n},n:function(n){if(this.f!==n){this.f=n;this.dQ("IsReadReceiptRequested")}return n},v:function(n){if(this.h!==n){this.h=n;this.dQ("ShowSmimeOptions")}return n},p:function(n){if(this.a!==n){this.a=n;this.dQ("SmimeEncryptMessage")}return n},q:function(n){if(this.b!==n){this.b=n;this.dQ("SmimeSignMessage")}return n},w:function(n){if(this.i!==n){this.i=n;this.dQ("SmimeEncryptMessageIsEnabled")}return n},y:function(n){if(this.j!==n){this.j=n;this.dQ("SmimeSignMessageIsEnabled")}return n},z:function(n){if(this.l!==n){this.l=n;this.dQ("WaitingForPreviousAction")}return n},u:function(n){if(this.g!==n){this.g=n;this.dQ("Conductor")}return n},t:function(n){this.k=n.r();this.v(_a.j.a&&_a.j.k()&&n.cT());this.z(!1);this.o(n.D());this.m(n.bc());this.n(n.bd());this.p(n.u());this.q(n.F());this.w(n.cM());this.y(n.cN())}};_mcp.J=function(n){this.a=n};_mcp.J.prototype={a:!1};_mcp.bu=function(n,t){this.a=n;this.b=t};_mcp.bu.prototype={a:null,b:null};_mcp.bv=function(n,t,i){this.i=new RegExp("<","g");this.h=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.bv.prototype={e:0,a:null,d:!1,toString:function(){_js.Trace.logInfo(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.m();var t=this.f(!0);var r=this.f(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.R.Np,r,t));var o=this.a.cp()||this.a.cy();var w=o?o.toString():this.a.hQ();var h=this.g(!0);var e=this.g(!1);var i,n;var s,u;this.n(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.bd,t);var k=this.b(_nbs.a.Jl,w);var b=h?this.b(_u.R.NN,h.join("; ")):null;var y=e?this.b(_u.R.QQ,e.join("; ")):null;var l=this.b(_u.P.X,a);var c=i?this.b(_u.P.N,i):null;var v=n?this.b(_u.P.I,n):null;var f=this.j(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},j:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _ff.e,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_js.d.a(i)||f.c(i)}return f.i()},m:function(){if(this.a.bl.Subject)return this.a.bl.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.R.JN;break;case 3:n=_nbs.a.Pj;break;case 5:n=_nbs.a.TX;break;case 6:n=_nbs.a.dc;break;case 7:n=_nbs.a.bV;break;case 8:n=_nbs.a.Qk;break;case 9:n=_nbs.a.jD;break;case 10:n=_nbs.a.MI;break;default:n="";break}return String.format(_nbs.a.fE,n,this.a.cK()||_u.R.Ti)}},f:function(n){if(_g.q.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bl.From:r.bl.Sender;return i?this.c(i.Mailbox):null}else if(_g.i.isInstanceOfType(this.a)){var t=this.a;return t.bl.Organizer?this.c(t.bl.Organizer.Mailbox):null}else return null},g:function(n){if(_g.q.isInstanceOfType(this.a)){var i=this.a;return this.l(n?i.k():i.m())}else if(_g.i.isInstanceOfType(this.a)){var t=this.a;return this.k(n?t.p():t.s(),n)}else return null},n:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_g.bj.isInstanceOfType(this.a)){var f=this.a;i=f.u();r=f.eO()}else if(_g.i.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=new _cc.bd;n.val=e.a(r,null)||" "}i&&(t.val=i.r()?i.r().bl.DisplayName||" ":" ")},l:function(n){if(!n||!n.b())return null;var t=new _ff.e;var i=this;n.p(function(n){t.c(i.c(n))});return t.i()},k:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bl.Organizer.Mailbox)]:null;var i=new _ff.e;var r=this;n.p(function(n){i.c(r.c(n.bl.Mailbox))});return i.i()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.o(t):n+" "+t},o:function(n){if(!n)return null;n=n.replace(this.i,"&lt;");n=n.replace(this.h,"&gt;");return n}};_mcp.A=function(n){_mcp.A.initializeBase(this);this.a=n};_mcp.A.prototype={a:null,t:function(n){var i=this.c();var t=new _g.AR(this.w);t.explicitLogonUser=this.a.J;$a(this.a.f)||t.actionName||(t.actionName=this.a.f);n.di(i,t,this.r,this.q)},c:function(){var t=this.a.bT();var i=new _g.mY(this.y());var n=new _g.jh;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},O:function(n){_h.dX.prototype.O.call(this,n)},cq:function(n){this.a.bV(n)}};_mcp.Z=function(){};_mcp.Z.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.lJ;break;case"Personal":i=_nbs.a.Se;break;case"Private":i=_nbs.a.Ko;break;case"Confidential":i=_nbs.a.p;break;default:i=_nbs.a.lJ;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.n=function(n){_mcp.n.initializeBase(this,[n])};_mcp.n.prototype={a:null,p:function(){},o:function(){},s:function(n){},q:function(n){},r:function(n){},u:function(n){},t:function(n,t){t.val=3;this.a.a();return!0}};_mcp.c=function(){};_mcp.c.F=function(){return _fm.b.a(_fm.a.p,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.G=function(){return _fm.b.a(_fm.a.p,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.H=function(){return _fm.b.a(_fm.a.p,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.E=function(){return _fm.b.a(_fm.a.bl,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.h=function(){return _fm.b.a(_fm.a.bl,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.s=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.t=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.o=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.p=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.c.i=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_mcp.c.j=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.d,"ms-fcl-nd-b")};_mcp.c.q=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.c.r=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.c.w=function(){return _fm.b.a(_fm.a.bJ,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.y=function(){return _fm.b.a(_fm.a.bJ,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.x=function(){return _fm.b.a(_fm.a.bJ,_fm.WebfontSizes.a.b,"ms-fcl-nta-b")};_mcp.c.u=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.f=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.D=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.f,"ms-fcl-tp-b")};_mcp.c.g=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.I=function(){return _fm.b.a(_fm.a.bu,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.J=function(){return _fm.b.a(_fm.a.bu,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.z=function(){return _fm.b.a(_fm.a.L,_fm.WebfontSizes.a.h,"ms-fcl-ns-b")};_mcp.c.B=function(){return _fm.b.a(_fm.a.L,_fm.WebfontSizes.a.h,"ms-fcl-nd-b")};_mcp.c.A=function(){return _fm.b.a(_fm.a.L,_fm.WebfontSizes.a.h,"ms-fcl-nta-b")};_mcp.c.a=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.b=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.c=function(){return _fm.b.a(_fm.a.bw,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.c.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.c.v=function(){return _fm.b.a(_fm.a.cO,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_mcp.c.k=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-ns-b")};_mcp.c.m=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-nd-b")};_mcp.c.n=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-tp-b")};_mcp.c.l=function(){return _fm.b.a(_fm.a.j,_fm.WebfontSizes.a.h,"ms-fcl-nta-b")};_mcp.c.C=function(){return _fm.b.a(_fm.a.h,"ms-fcl-ns-b")};_mcp.i=function(n){_mcp.i.initializeBase(this,[n])};_mcp.i.prototype={a:null,b:function(){this.a&&_rw.b.a(this.a.B,this.a.B)},K:function(){_js.b.prototype.K.call(this);this.a=this.F?this.F.a("FromPersona"):null}};_mcp.m=function(n,t,i,r,u,f,e,o){this.dp=Function.createDelegate(this,this.fU);this.dq=Function.createDelegate(this,this.fV);this.bp=Function.createDelegate(this,this.fy);this.dV=Function.createDelegate(this,this.et);this.cE=Function.createDelegate(this,this.eT);this.cH=Function.createDelegate(this,this.eU);this.cw=Function.createDelegate(this,this.eN);this.cy=Function.createDelegate(this,this.eP);this.cA=Function.createDelegate(this,this.eR);this.cx=Function.createDelegate(this,this.eO);this.cD=Function.createDelegate(this,this.eS);this.cJ=Function.createDelegate(this,this.eV);this.dW=Function.createDelegate(this,this.eh);this.cG=Function.createDelegate(this,this.ef);this.cz=Function.createDelegate(this,this.eQ);this.dj=Function.createDelegate(this,this.fD);this.cO=Function.createDelegate(this,this.eZ);this.di=Function.createDelegate(this,this.fC);this.bW=Function.createDelegate(this,this.fB);this.bV=Function.createDelegate(this,this.fA);this.cV=Function.createDelegate(this,this.fq);this.bT=Function.createDelegate(this,this.fr);this.bn=Function.createDelegate(this,this.fl);this.bR=Function.createDelegate(this,this.fo);this.db=Function.createDelegate(this,this.ej);this.dk=Function.createDelegate(this,this.fE);this.cT=Function.createDelegate(this,this.fn);this.cX=Function.createDelegate(this,this.ft);this.dl=Function.createDelegate(this,this.fF);this.cR=Function.createDelegate(this,this.fk);this.cY=Function.createDelegate(this,this.fu);this.da=Function.createDelegate(this,this.fv);this.du=Function.createDelegate(this,this.ek);this.dt=Function.createDelegate(this,this.fX);this.cL=Function.createDelegate(this,this.eY);this.cP=Function.createDelegate(this,this.fj);this.dd=Function.createDelegate(this,this.fx);this.dc=Function.createDelegate(this,this.fw);this.dh=Function.createDelegate(this,this.fz);this.cS=Function.createDelegate(this,this.fm);this.dm=Function.createDelegate(this,this.fS);this.dn=Function.createDelegate(this,this.fT);this.bm=Function.createDelegate(this,this.ev);this.bY=Function.createDelegate(this,this.fW);this.r=Function.createDelegate(this,this.ec);this.cv=Function.createDelegate(this,this.ew);this.dY=Function.createDelegate(this,this.eW);this.bU=Function.createDelegate(this,this.fs);this.cU=Function.createDelegate(this,this.fp);this.cW=Function.createDelegate(this,this.dE);this.dX=Function.createDelegate(this,this.ei);this.bX=Function.createDelegate(this,this.fR);this.ea=Function.createDelegate(this,this.em);this.cK=Function.createDelegate(this,this.eX);this.a={};this.n={};_mcp.m.initializeBase(this,[n]);this.j=t;this.o=i;this.bZ=r;this.p=u;this.S=f;this.R=e;this.dC=o;this.p.a().K().Enabled&&(this.ci=!0);this.p&&this.p.a().i().Enabled&&this.S.b(_cmc.o,this.cK);_js.Trace.logInfo(_a.a.a,"View created with layout={0}",this.j)};_mcp.m.prototype={t:!1,o:null,bZ:null,p:null,d:null,m:null,c:null,bA:null,k:null,bf:!1,ce:!1,cc:!1,ca:!1,j:0,bg:!1,bM:!1,bQ:!1,u:!1,cr:!1,bK:!1,Z:!1,cd:!1,bc:!1,cq:!1,dD:!1,dJ:null,R:null,ci:!1,S:null,dC:null,bv:function(){return this.a?this.a.EditorControl:null},ed:function(){return this.p.a().M().Enabled},ex:function(){var n;n=this.j==="TouchNarrow"?50:100;return n},ey:function(){var t=this.j==="Mouse"||this.dz()?1:3;var i=this.E();if(i)if(i.bg())t=2;else{var n=i.L;this.j==="Mouse"||this.dz()||n.g()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},q:function(n){if(this.c!==n){this.c=n;this.gg()}return n},eC:function(){return _y.c.a.h()||this.dA()?!1:this.ce},cn:function(n){if(this.ce!==n){this.ce=n;this.bt("IsToRecipientWellPeoplePickerButtonShown")}return n},eA:function(){return _y.c.a.h()||this.dA()?!1:this.cc},cl:function(n){if(this.cc!==n){this.cc=n;this.bt("IsCcRecipientWellPeoplePickerButtonShown")}return n},ez:function(){return _y.c.a.h()||this.dA()?!1:this.ca},ck:function(n){if(this.ca!==n){this.ca=n;this.bt("IsBccRecipientWellPeoplePickerButtonShown")}return n},eL:function(){var n=this.E();return n&&n.L&&n.W()?n.L.Q()&&n.W().e:!0},fc:function(){return!0},dG:function(n){if(this.Z!==n){this.Z=n;this.bt("IsReadyToShowContent")}return n},dH:function(n){if(this.bc!==n){this.bc=n;this.bt("IsReadyToShowEditor");this.bc&&this.dK()}return n},dI:function(n){if(this.cq!==n){this.cq=n;this.bt("ShowRibbon")}return n},dF:function(n){if(this.cd!==n){this.cd=n;this.bt("IsReadyToShowAppBarContent")}return n},s:function(n){if(this.bf!==n){this.bf=n;this.bt("ShouldPreventShiftTabDefault")}return n},fY:function(n){this.dD=n;this.bt("IsTabAnchorNeeded");return n},dz:function(){return this.bZ.c()},eK:function(){return this.E()?this.E().bN:!1},eM:function(){return this.a.SubjectTextBox.B},eB:function(){return!!this.p&&this.p.a().i().Enabled},I:function(){return _a.a.a},en:function(){var i=this.E();var r=this.a.Ribbon;var n=this.a.EditorControl;var t=!1;r&&i&&n&&(t=this.Z&&this.ci&&this.t&&!i.bg()&&_zz.f.isInstanceOfType(n));this.dI(t)},dA:function(){return this.p.a().f().Enabled&&this.j==="Mouse"},fZ:function(){this.bA?this.b(this.bA):this.ga()},ga:function(){if(!this.E()){_js.Trace.logInfo(_a.a.a,"No data context yet, skipping set initial focus");return}var n=this.E();if(this.gd()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to To well. Context:{0}",n.L);if(this.o.a()||this.o.d()){var r=this.a.ComposeViewContent;r.M(!1);this.dw();this.n&&this.n.ToRecipientWellControl&&this.n.ToRecipientWellControl.removeAttr("disabled");this.b("ToRecipientWellControl")}else{var i=this;_js.g.a().a(_a.a.a,"SetFocusToRecipientWell",function(){i.b("ToRecipientWellControl")},500)}}else if(this.gc()){_js.Trace.logInfo(_a.a.a,"Set initial focus to subject. Context: {0}",n.L);this.b("SubjectTextBox");if(this.o.b()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to subject for IE. Context:{0}",n.L);var t=this;_js.g.a().a(_a.a.a,"SetFocusToSubject",function(){t.b("SubjectTextBox")},500)}}else{_js.Trace.logInfo(_a.a.a,"Set initial focus to body. Context: {0}",n.L);if(this.o.b()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to body for IE. Context:{0}",n.L);_js.g.a().a(_a.a.a,"SetFocusToEditor",this.ea,1500)}else this.em()}},gd:function(){var n=this.E();return n.R().c.f()<1},gc:function(){return _js.d.a(this.a.SubjectTextBox.B.val())},g:function(n){},e:function(n){this.cr=!this.E();if(this.cr)_js.Trace.logInfo(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.E();var i=t.W();if(i.I()){this.bK=!!this.a.EditorControl;this.bK?this.P()?t.bZ()&&!t.bJ?t.apcl("IsReadyForViewInitialization",this.bX):this.bz():_js.Trace.logInfo(_a.a.a,"PostTransitionIn view not active yet. Context:{0}",t.L):_js.Trace.logInfo(_a.a.a,"PostTransitionIn template not applied yet. Context:{0}",t.L)}else this.eo(i,t.L);this.j==="Mouse"&&t.df()}this.u=!0},h:function(){this.u=!1;_js.Trace.logInfo(_a.a.a,"PreTransitionOut view");var n=this.c;this.bA=n;if(n&&n in this.a)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.dw();this.bg=!0;var t=this.n[n];if(t[0]===document.activeElement){_js.Trace.logInfo(_a.a.a,"Blur from {0}",n);t.blur()}this.c=null;this.bg=!1;break;case"EditorControl":this.bg=!0;this.a.EditorControl.cq();this.c=null;this.bg=!1;break}else _js.Trace.logInfo(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},f:function(){_js.Trace.logInfo(_a.a.a,"PostTransitionOut view");this.cn(!0);this.cl(!1);this.ck(!1);this.el();this.dG(!1);this.dI(!1);this.dH(!1);this.dF(!1)},X:function(){this.v();return!0},bu:function(){_js.Trace.logInfo(_a.a.a,"Disposing view");this.S.c(_cmc.o,this.cK);this.gf();this.gh();this.dL();this.n=null;this.a=null;this.c=null;_js.b.prototype.bu.call(this)},K:function(){_js.b.prototype.K.call(this);var n=this.F;var t=null;this.E()&&(t=this.E());if(n){this.a.SubjectTextBox=n.a("SubjectTextBox");this.a.FromFieldControl=n.a("FromFieldControl");this.a.ToRecipientWellControl=n.a("ToRecipientWellControl");this.a.CcRecipientWellControl=n.a("CcRecipientWellControl");this.a.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.a.EditorControl=i;this.a.ComposeViewContent=n.a("ComposeViewContent");var r=n.a("Ribbon");this.a.Ribbon=r;if(this.ci&&!t.bg()&&_zz.f.isInstanceOfType(i)){r.bQ(i);i.Z=r;i.cl=2}else i.cl=t.bg()?0:1;this.a.CancelConfirmDialog=n.a("CancelConfirmDialog");this.a.MessageBox=n.a("MessageBox");this.a.ComposeDockPanel=n.a("ComposeDockPanel");this.a.ToRecipientButton=n.a("ToRecipientButton");this.a.CcRecipientButton=n.a("CcRecipientButton");this.a.BccRecipientButton=n.a("BccRecipientButton");this.a.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.a.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.a.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.a.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");if(this.j==="Mouse"){this.a.SendButton=n.a("SendButton");this.a.DiscardButton=n.a("DiscardButton");this.a.InsertButton=n.a("InsertButton");this.a.AppsButton=n.a("AppsButton");this.a.AffordanceMenuButton=n.a("AffordanceMenuButton");this.a.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.a.ComposeAppsPane=n.a("ComposeAppsPane");this.t=t.L.d()==="HTML"}this.dJ=new _C(this.dX,this.I());this.gb();if(this.u&&!this.bK){_js.Trace.logInfo(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:{0}",t?t.L:"null");this.e(null)}else _js.Trace.logInfo(_a.a.a,"Applying template. Context:{0}",!t||!t.L?"null":t.L.toString());this.a.EditorControl&&this.a.EditorControl.apcl("IsPlainTextContent",this.cW)}else{_js.Trace.logInfo(_a.a.a,"Applying null template. Context:{0}",t?t.L.toString():"null");this.a.SubjectTextBox=null;this.a.FromFieldControl=null;this.a.ToRecipientWellControl=null;this.a.CcRecipientWellControl=null;this.a.BccRecipientWellControl=null;this.a.EditorControl=null;this.a.CancelConfirmDialog=null;this.a.MessageBox=null;this.a.ComposeDockPanel=null}this.ep()},bF:function(){var t=new _b.f(this.dC);t.i("ShowAddressBook");var r=this;t.k=new _C(function(){r.b("ToRecipientWellControl")},this.I());var n=new _fc.g;n.a([t]);var i=_js.c.prototype.bF.call(this);return i?i.concat(n):[n]},Q:function(){_js.c.prototype.Q.call(this);if(this.E()){var t=this.E();var i=t.L;var n=t.W();i.apcl("IsUpgraded",this.cU);this.t=i.d()==="HTML";if(this.cr)if(n.I()){_js.Trace.logInfo(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: {0}",t.L);this.e(null)}else this.eo(n,i);n.c||n.apcl("IsSecondInitializationComplete",this.bU);t.R().ba=this.dY}else _js.Trace.logInfo(_a.a.a,"Updated DataContext to null")},J:function(){_js.b.prototype.J.call(this);if(this.u&&this.E()&&this.bK){var t=this.E();var n=t.W();n.I()&&this.bz()}},O:function(){this.el();_js.b.prototype.O.call(this)},dv:function(){var n=this.E();if(this.bQ){_js.Trace.logInfo(_a.a.a,"Events already bound. Context:{0}",n.L);return}if(this.o.a()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.cv);var u=this;_js.g.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",u.cv)},1e3)}this.d=new _ff.e;if(this.j==="Mouse"){this.d.c(new _mcp.m.a("DiscardButton",this.r));this.d.c(new _mcp.m.a("InsertButton",this.r));this.d.c(new _mcp.m.a("AppsButton",this.r));this.d.c(new _mcp.m.a("AffordanceMenuButton",this.r));this.d.c(new _mcp.m.a("OpenSeperateWindowButton",this.r));this.d.c(new _mcp.m.a("ToRecipientButton",this.r))}this.d.c(new _mcp.m.a("SubjectTextBox",this.r));this.d.c(new _mcp.m.a("FromFieldControl",this.r));this.d.c(new _mcp.m.a("ToRecipientWellControl",this.bY));this.d.c(new _mcp.m.a("CcRecipientWellControl",this.bY));this.d.c(new _mcp.m.a("BccRecipientWellControl",this.bY));this.m=new _ff.e;this.m.c(new _mcp.m.a("FromFieldControl",this.bm));this.m.c(new _mcp.m.a("ToRecipientWellControl",this.bm));this.m.c(new _mcp.m.a("CcRecipientWellControl",this.bm));this.m.c(new _mcp.m.a("BccRecipientWellControl",this.bm));if(n.bZ()){n.X.addEventListener("focusin",this.dn,!0);n.X.addEventListener("focusout",this.dm,!0)}else{for(var i=0;i<this.d.d.length;i++)this.a[this.d.d[i].a].B.bind("focusin",{uiComponent:this.d.d[i].a},this.d.d[i].b);for(var t=0;t<this.m.d.length;t++)this.a[this.m.d[t].a].B.bind("focusout",{uiComponent:this.m.d[t].a},this.m.d[t].b)}this.eb();this.a.CancelConfirmDialog.apcl("IsHidden",this.cS);this.a.MessageBox.apcl("IsHidden",this.dh);this.bq();n.M.apcl("ActionPerformed",this.dc);n.M.apcl("Count",this.dd);n.Q().j(this.cP);if(!$a(this.a.ComposeAppsPane)){this.a.ComposeAppsPane.apcl("IsHidden",this.cL);_y.c.a.o(this.dt);_y.c.a.o(this.du);_g.a.a().b().E(this.da)}if(this.R.b(this.R.f())&&this.j==="TouchWide"){var r=n.bf().g;if(r){r.i(this.cY);r.r(this.cR)}}n.L.apcl("SelectedDataCallContext",this.dl);n.L.apcl("EditorCallContext",this.cX);n.W().apcl("CanLoadPopoutSuccessfully",this.cT);n.bf().apcl("RequestCloseComposeForm",this.dk);this.a.FromFieldControl.apcl("IsHidden",this.db);this.a.CcRecipientWellControl.apcl("IsHidden",this.bR);this.a.BccRecipientWellControl.apcl("IsHidden",this.bn);this.bQ=!0},dL:function(){var n=this.E();if(n){var e=n.W();e.rpcl("IsInitialized",this.bT);e.rpcl("IsSecondInitializationComplete",this.bU);var s=n.L;s.rpcl("IsUpgraded",this.cU)}if(!this.bQ){_js.Trace.logInfo(_a.a.a,"Events aren't bound. Context:{0}",n?n.L.toString():"null");return}if(this.a){"CancelConfirmDialog"in this.a&&this.a.CancelConfirmDialog.rpcl("IsHidden",this.cS);"MessageBox"in this.a&&this.a.MessageBox.rpcl("IsHidden",this.dh);this.bG();this.a&&this.a.BccRecipientWellControl&&this.a.BccRecipientWellControl.rpcl("IsHidden",this.bn);this.a.CcRecipientWellControl&&this.a.CcRecipientWellControl.rpcl("IsHidden",this.bR);this.a.FromFieldControl&&this.a.FromFieldControl.rpcl("IsHidden",this.db);if(n&&n.bZ()){var u=n.X;if(u&&!u.closed){u.removeEventListener("focusin",this.dn,!0);u.removeEventListener("focusout",this.dm,!0)}}else{for(var t=0;t<this.d.d.length;t++)this.d.d[t].a in this.a&&this.a[this.d.d[t].a].B.unbind("focusin",this.d.d[t].b);for(var i=0;i<this.m.d.length;i++)this.m.d[i].a in this.a&&this.a[this.m.d[i].a].B.unbind("focusout",this.m.d[i].b)}"EditorControl"in this.a&&this.a.EditorControl.rpcl("IsPlainTextContent",this.cW)}if(n){_js.Trace.logInfo(_a.a.a,"Unbind view events on view model. Context:{0}",n.L);n.be()&&n.be().b()&&n.be().b().rpcl("IsShown",this.cV);var r=n.bB();if(r){r.rpcl("DialogViewModel",this.bV);r.a()&&r.a().rpcl("IsShown",this.bW)}var o=n.R();o&&o.rpcl("IsPeoplePickerShown",this.di);n.M.rpcl("ActionPerformed",this.dc);n.M.rpcl("Count",this.dd);n.Q().o(this.cP);n.rpcl("IsReadyForViewInitialization",this.bX);n.Q().a()&&n.Q().a().C(this.cO);if(this.R.b(this.R.f())&&this.j==="TouchWide"){var f=n.bf().g;if(f){f.p(this.cY);f.y(this.cR)}}n.L.rpcl("SelectedDataCallContext",this.dl);n.L.rpcl("EditorCallContext",this.cX);n.W().rpcl("CanLoadPopoutSuccessfully",this.cT);n.bf().rpcl("RequestCloseComposeForm",this.dk)}if(this.a.ComposeAppsPane){this.a.ComposeAppsPane.rpcl("IsHidden",this.cL);_y.c.a.q(this.dt);_y.c.a.q(this.du);_g.a.a().b().K(this.da)}this.bQ=!1},eQ:function(n){_js.Trace.logInfo(_a.a.a,"Focused in the RTE");this.c!=="EditorControl"&&this.q("EditorControl")},ec:function(n){var i=n.data;var t=i.uiComponent;this.dx(t)},fW:function(n){this.ec(n);this.dB()},ev:function(n){_js.Trace.logInfo(_a.a.a,"User blured from {0}",this.c);if(this.E()&&_mcp.d.isInstanceOfType(this.E())&&!this.bg&&!this.E().bj){if(this.c==="FromFieldControl"){var t=this.E().R();if(t&&t.j()){var u=t.j().a();_js.d.a(u)||t.A(u,!0)}}if(_a.cB.a){var r=this;_js.g.a().a(this.I(),"Delayed MailTips retrieval",function(){if(r.E()){var n=r.E().cE();n.a(1)}},100)}if(_a.bm.a){var i=this;_js.g.a().a(this.I(),"Delayed PolicyTips retrieval",function(){if(i.E()){var n=i.E().cW();n.a(1)}},100)}}},v:function(){if(this.a&&this.P()&&this.u&&this.c&&this.E()&&!this.E().bj){_js.Trace.logInfo(_a.a.a,"Restore focus to {0}",this.c);this.b(this.c)}else _js.Trace.logInfo(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.a?"non-null":"null",this.P(),this.u,this.c,this.E()?"non-null":"null")},b:function(n){this.dw();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.n&&this.n[n]){this.n[n].focus();this.q(n);this.dB()}break;case"EditorControl":if(this.a&&this.a[n]){this.a[n].cX(!1);this.q(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"AppsButton":case"AffordanceMenuButton":if(this.a&&this.i(n)){this.a[n].X();this.q(n)}break}},dw:function(){if(this.n&&!("SubjectTextBox"in this.n)){this.n.SubjectTextBox=this.a.SubjectTextBox.B;this.n.FromFieldControl=this.a.FromFieldControl.B.find("input");this.n.ToRecipientWellControl=this.a.ToRecipientWellControl.B.find("input");this.n.CcRecipientWellControl=this.a.CcRecipientWellControl.B.find("input");this.n.BccRecipientWellControl=this.a.BccRecipientWellControl.B.find("input")}},dE:function(n,t){this.eb();var i=this.E();this.t=i.L.d()==="HTML";this.en();this.t||this.ee()},ew:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_js.Trace.logInfo(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},gb:function(){this.a.FromFieldControl.fK(this.dj)},eY:function(n,t){var i=this.a.ComposeAppsPane;if(this.u){i.bB()?this.b("ToRecipientWellControl"):this.dK();this.ek()}},fn:function(n,t){this.bt("ShouldHideSpinner")},fF:function(n,t){var i=this.E();var u=this.c||this.bA;if(u==="SubjectTextBox"){i.L.y().c("subject");this.a.SubjectTextBox.q(i.L.y())}else if(u==="EditorControl"){if("EditorControl"in this.a){var r=this.a.EditorControl;if(r.w)r.bm(i.L.y());else if(_cmc.e.isInstanceOfType(i.L.y()))i.L.y().a=r.ev;else if(_cmc.g.isInstanceOfType(i.L.y())){r.ev=i.L.y().n;r.bm(i.L.y())}}i.L.y().c("body")}else i.L.y().f(!0)},fE:function(n,t){var r=this.E();if(r){var u=r.O;var i=null;if(this.j==="Mouse"){var e=u.b(19);i=e.e()}else{var f=u.b(10);i=f.a()}i&&i.b&&i.a();this.j==="TouchNarrow"&&r.bf().g.j()}},ft:function(n,t){if("EditorControl"in this.a){var i=this.E();this.a.EditorControl.bm(i.L.cA())}},gf:function(){var n=this.a.FromFieldControl;var r=this.a.ToRecipientWellControl;var i=this.a.CcRecipientWellControl;var t=this.a.BccRecipientWellControl;n&&n.ir(this.dj)},fD:function(n){if(this.a.FromFieldControl===n){var t=n.B.find("input");t.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}},eW:function(){var n=this.a.FromFieldControl;n&&n.b()},dB:function(){switch(this.c){case"ToRecipientWellControl":this.cn(!0);this.cl(!1);this.ck(!1);break;case"CcRecipientWellControl":this.cl(!0);this.cn(!1);this.ck(!1);break;case"BccRecipientWellControl":this.ck(!0);this.cl(!1);this.cn(!1);break}},ei:function(){var n=!0;if(this.bf){switch(this.c){case"DiscardButton":this.b("SendButton");break;case"InsertButton":this.b("DiscardButton");n=!1;break;case"AppsButton":this.b("InsertButton");n=!1;break;case"AffordanceMenuButton":var i=this.a.AppsButton;i&&!i.bB()?this.b("AppsButton"):this.b("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.b("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":var t=this.E();if(t.R().be||t.M.c.w.length)this.s(!1);else{var u=this.a.ComposeAppsPane;if(u.bB()){this.b("OpenSeperateWindowButton");n=!1}else this.s(!1)}break;case"ToRecipientWellControl":if(this.j==="Mouse"){this.b("ToRecipientButton");n=!1}else this.s(!1);break;case"CcRecipientWellControl":this.b("CcRecipientButton");break;case"BccRecipientWellControl":this.b("BccRecipientButton");break}if(n){var r=this;_js.g.a().a(this.I(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.s(!1)},100)}}},gg:function(){if(this.ge()){var n=this.E();switch(this.c){case"ToRecipientWellControl":n.R().d.e();n.R().e.e();break;case"CcRecipientWellControl":n.R().c.e();n.R().e.e();break;case"BccRecipientWellControl":n.R().c.e();n.R().d.e();break;default:n.R().c.e();n.R().d.e();n.R().e.e();break}}},eX:function(n){if(this.bv()&&n.b===this.bv().bj()&&n.a){var i=this.a.ToReadWriteRecipientWellView;if(i){var t=i.E();t&&(t.cr(n.a)||t.Z(n.a))}}},ge:function(){return this.j!=="Mouse"&&this.E()?!0:!1},fm:function(n,t){if(this.a.CancelConfirmDialog.bB()&&this.E()&&!this.E().bj){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.v()}},fz:function(n,t){if(this.a.MessageBox.bB()){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of message box.");this.v()}},fr:function(n,t){var i=this.E();i.W().rpcl("IsInitialized",this.bT);_js.Trace.logInfo(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.e(null)},fp:function(n,t){var i=this.E();i.L.g()&&this.bt("EditorSizingMode")},fs:function(n,t){var i=this.E();i.W().rpcl("IsSecondInitializationComplete",this.bU);this.j==="Mouse"&&i.be().b()&&i.be().b().apcl("IsShown",this.cV);var r=i.bB();r.a()?r.a().apcl("IsShown",this.bW):r.apcl("DialogViewModel",this.bV);var u=i.R();u&&u.apcl("IsPeoplePickerShown",this.di)},fq:function(n,t){var i=this.E();if(!i.be().b().i){var r=i.bB();var u=this;_js.g.a().a(this.I(),"MailComposeView.OnContextMenuShownChanged",function(){var t=!r.a()||!r.a().j;var n=!i.T||!i.T.j;if(t&&n){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of context menu");u.v()}},100)}},fA:function(n,t){var r=this.E();var i=r.bB();i.rpcl("DialogViewModel",this.bV);i.a().apcl("IsShown",this.bW)},fB:function(n,t){var r=this.E();var i=this;_js.g.a().a(this.I(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.bB().a().j){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of message options dialog");i.v()}},100)},fC:function(n,t){var i=this.E();if(!i.R().bK){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of people picker");this.v()}},fw:function(n,t){this.v()},fx:function(n,t){this.ep();this.dK()},ep:function(){var a=this.F.a("InfoBarControl");if(a){var f=this.E();if(f.M.c.w.length>0){for(var l=new _y.df,o=_nbs.a.Gq+". ",n,r=0;r<f.M.c.w.length;r++){n="";var t=f.M.c.w[r];if(_y.bT.isInstanceOfType(t)){var h=t;h&&(n=h.c)}else if(_y.bU.isInstanceOfType(t)){var e=t;e&&(n=e.c)}else if(_y.cl.isInstanceOfType(t)){var i=t;if(i&&_y.fq.isInstanceOfType(i.c)){var u=i.c;u&&u.a()&&(n=u.a())}}if(n===""){var s=t;s&&(n=l.a(s.a,null))}o+=n+". "}var c=this.F.a("InfoBarControl").B;c.attr("aria-label",o)}}},fj:function(n){n.a().u(this.cO)},eZ:function(n){if(n.bo()){n.bH(!1);this.q("EditorControl")}this.v()},eo:function(n,t){if(n.ss("IsInitialized"))_js.Trace.logInfo(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:{0}",t);else{_js.Trace.logInfo(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:{0}",t);n.apcl("IsInitialized",this.bT)}},eu:function(){if(this.bM){_js.Trace.logWarning(this.I(),"Editor events were already bound.");return}var i=this.E().cC();if("EditorControl"in this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.hh(this.cz);n.fW(this.cG);n.lD(this.dW);n.ew(this.cJ);n.hj(this.cD);n.jC(this.cx);n.hi(this.cA);n.hg(this.cy);n.d(this.cw);n.fX(this.cH);n.lC(this.cE);i&&i.h(n)}if(this.o.b()){var t=this.F.a("TabAnchor");t&&t.B.bind("focusin",this.dV)}this.bM=!0},gh:function(){if(!this.bM){_js.Trace.logWarning(this.I(),"Editor events weren't bound. No need to unbind.");return}var i=this.E().cC();if("EditorControl"in this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.ht(this.cz);n.eB(this.cG);n.eC(this.cJ);n.hv(this.cD);n.jH(this.cx);n.hu(this.cA);n.hs(this.cy);n.j(this.cw);n.gl(this.cH);n.lI(this.cE);i&&i.i(n)}if(this.o.b()){var t=this.F.a("TabAnchor");t&&t.B.unbind("focusin")}this.bM=!1},et:function(n){var t=new _a.U(n);this.b("EditorControl");t.b()},ef:function(n){_js.d.a(this.k)||this.b(this.k);n.a(!0)},eh:function(n){},bq:function(){this.k=null;var n=this.E();n.L.cc()||this.i("SubjectTextBox")&&(this.k="SubjectTextBox");_js.d.a(this.k)&&this.i("BccRecipientWellControl")&&(this.k="BccRecipientWellControl");if(_js.d.a(this.k)&&this.i("CcRecipientWellControl")){this.k="CcRecipientWellControl";this.a.BccRecipientWellControl.rpcl("IsHidden",this.bn);this.a.BccRecipientWellControl.apcl("IsHidden",this.bn)}_js.d.a(this.k)&&this.i("ToRecipientWellControl")&&(this.k="ToRecipientWellControl");!_js.d.a(this.k)&&this.a&&this.a[this.k]?this.a[this.k].B.bind("keydown",this.bp):_js.Trace.logWarning(this.I(),"Compose form doesn't have any control preceeding editor")},bG:function(){!_js.d.a(this.k)&&this.a&&this.a[this.k]&&this.a[this.k].B.unbind("keydown",this.bp)},i:function(n){if(!this.a)return!1;var t=this.a[n];return!!t&&!t.bB()},fl:function(n,t){this.i("BccRecipientWellControl")&&this.b("BccRecipientWellControl");this.bG();this.bq()},fo:function(n,t){this.a.CcRecipientWellControl.rpcl("IsHidden",this.bR);this.i("CcRecipientWellControl")&&this.b("CcRecipientWellControl");this.bG();this.bq()},ej:function(n,t){},eV:function(n){var t=this.E();if(t){t.L.dG(n.f());t.L.dd(n.e());t.L.dn(n.c())}n.c()&&this.bt("ShouldHideSpinner")},eS:function(n){var t=this.E();t&&t.Q().t(n.c())},eO:function(n){var i=this.E();if(i){var t=i.Q().a().S();t.b(n.c());t.a(n.c())}},eR:function(n){var i=this.E();if(i){var t=i.Q().a();t.G(n.e());t.H(n.f());t.F(n.c());t.bE(n.h());t.bD(n.g());t.k().a()}},eP:function(n){var t=this.E();if(t){var i=t.Q().a();i.r(n.c())}},eN:function(n){this.ee()},eU:function(n){var f=this.E();if(f){var u=f.O;switch(n.c()){case 0:var s=u.b(7);var i=s.h;i&&i.b&&i.a();break;case 1:this.S&&this.S.a(_y.el,new _y.el);break;case 2:var r=f.d().d();r&&r.b&&r.a();break;case 3:var t=null;if(this.j==="Mouse"){var o=u.b(19);t=o.a()}else{var e=u.b(10);t=e.a()}t&&t.b&&t.a();break;case 4:this.b("ToRecipientWellControl");break}}},eT:function(n){var i=this.E();if(i){var r=!!this.p&&this.p.a().i().Enabled;if(r){var t=n.c().outerText;t=_js.d.a(t)?n.c().text:t;n.a(_cmc.h.a(0,n.c().id,n.c().href,t,i.S))}}},dK:function(){var t=this.E();if(this.a&&t){var n;n=this.a.EditorControl;n&&n.w&&t.bI&&this.Z&&this.bc&&n.dX()}},el:function(){if(this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.w&&n.bm(new _cmc.c(!1))}},ee:function(){var t=this.E();if(this.t&&this.a&&this.a.EditorControl){var n=this.a.EditorControl;if(n.w&&!n.ey()){n.bm(new _cmc.P);t.L.cr(n.ca.b)}}else t.L.cr(0)},fv:function(n,t){},fX:function(){},ek:function(){var i=this.a.ToReadWriteRecipientWellView;var t=this.a.CcReadWriteRecipientWellView;var n=this.a.BccReadWriteRecipientWellView;this.dM(i);this.dM(t);this.dM(n)},dM:function(n){if(n&&_rw.d.isInstanceOfType(n.E())){var t=n.E();t.br(!0);t.br(!1)}},fu:function(){var n=this.a.QuotedBodyHtmlLabel;if(n){this.a.QuotedBodyHtmlLabel.B.on("touchstart",null,null,this.dq);this.a.QuotedBodyHtmlLabel.B.on("touchend",null,null,this.dp)}},fk:function(){var n=this.a.QuotedBodyHtmlLabel;if(n){this.a.QuotedBodyHtmlLabel.B.off("touchstart",null,this.dq);this.a.QuotedBodyHtmlLabel.B.off("touchend",null,this.dp)}},fU:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.R.f().a(t);n.stopImmediatePropagation();n.preventDefault()}},fV:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},bz:function(){var n=this.E();var t=this.a.EditorControl;this.o.f()&&this.a&&this.a.SubjectTextBox&&_zz.p.a(this.o,this.a.SubjectTextBox.B,null);this.eu();this.bZ.b()?this.dF(!1):this.dF(!0);this.dG(!0);this.en();this.dH(!0);_js.Trace.logInfo(_a.a.a,"PostTransitionIn active view. Context: {0}",n.L);this.fZ();this.dv()},fR:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.bX);this.bz()},em:function(){if(this.a&&this.a.EditorControl){var n=this.a.EditorControl;n.cX(!0);this.q("EditorControl")}},fT:function(n){for(var t=0;t<this.d.d.length;t++){var r=this.d.d[t];var i=this.a[r.a];if(n.target===i.z||i.B.has(n.target).length){this.dx(r.a);this.dB();break}}return!0},fS:function(n){for(var t=0;t<this.m.d.length;t++){var r=this.m.d[t];var i=this.a[r.a];if(n.target===i.z||i.B.has(n.target).length){r.b(null);break}}return!0},dx:function(n){_js.Trace.logInfo(_a.a.a,"Focused in {0}",n);this.q(n);this.s(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.E()&&_mcp.d.isInstanceOfType(this.E())){var i=this.E();if(this.c==="FromFieldControl"){var t=i.R();t&&t.bQ(!1)}this.c==="InsertButton"&&i.cS()}},eb:function(){var n=this.E();n&&this.fY(this.o.b()&&n.L.d()==="Text"?!0:!1)},fy:function(n){var t=new _a.U(n);var i=t.q.which;if(i===9&&!t.l()){this.b("EditorControl");this.fb(t)}}};_mcp.m.a=function(n,t){this.a=n;this.b=t};_mcp.m.a.prototype={a:null,b:null};_mcp.K=function(n){this.g=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.o);this.b={};_mcp.K.initializeBase(this,[n])};_mcp.K.prototype={c:null,a:null,d:null,e:function(){this.b.UpConvertButton.X();this.c="UpConvertButton";_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!0)},K:function(){_js.b.prototype.K.call(this);this.b.ShowCcButton=this.F.a("ShowCcButton");this.b.ShowBccButton=this.F.a("ShowBccButton");this.b.UpConvertButton=this.F.a("UpConvertButton")},dZ:function(){_js.c.prototype.dZ.call(this);this.q()},O:function(){this.i();_js.b.prototype.O.call(this)},bu:function(){this.i();_js.b.prototype.bu.call(this)},j:function(n){if(!$a(this.b[n])){this.b[n].X();this.c=n}},q:function(){this.d=this.L;this.a=this.d.L;_mcp.i.isInstanceOfType(this.a)&&(this.a=this.a.L);_mcp.j.isInstanceOfType(this.a)&&this.a.gl(this);this.d.B.bind("focusout",this.f);this.d.B.bind("keydown",this.g)},h:function(n){if(!this.b)return!1;var t=this.b[n];return!!t&&!t.bB()},p:function(n){var t=new _a.U(n);var i=t.q.which;if(i===9&&t.h())if(this.b.UpConvertButton.z===document.activeElement){this.c="UpConvertButton";this.n()}else if(this.b.ShowBccButton.z===document.activeElement){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.z===document.activeElement){this.c="ShowCcButton";this.l()}},n:function(){if(this.h("ShowBccButton")){this.j("ShowBccButton");_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!0)}else this.h("ShowCcButton")&&this.k()},k:function(){if(this.h("ShowCcButton")){this.j("ShowCcButton");_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!0)}else this.l()},l:function(){this.c=null;this.a.gm();this.a.w=!1},i:function(){this.m();this.d.B.unbind("focusout",this.f);this.d.B.unbind("keydown",this.g)},o:function(n){this.m()},m:function(){this.c=null;_mcp.j.isInstanceOfType(this.a)&&(this.a.w=!1)}};_mcp.j=function(n,t,i,r,u,f,e,o){this.dN=Function.createDelegate(this,this.gj);_mcp.j.initializeBase(this,[n,t,i,r,u,f,e,o]);this.dT=f;this.dU=i};_mcp.j.prototype={dT:null,dU:null,ct:!1,cs:!1,bj:null,l:null,w:!1,gk:function(n){this.cs=n;this.bt("EnableRichTextOptions");return n},gl:function(n){n&&(this.bj=n)},gm:function(){if(this.i("FromFieldControl"))this.b("FromFieldControl");else{this.ct=!0;this.b("ToRecipientWellControl")}},K:function(){_mcp.m.prototype.K.call(this);if(this.F){this.a.InlineComposeBottomEdge=this.F.a("InlineComposeBottomEdge");this.a.InlineComposeBody=this.F.a("InlineComposeBody");this.a.InsertPictureButton=this.F.a("InsertPictureButton");this.a.FormatButton=this.F.a("FormatButton");this.a.Emoji=this.F.a("Emoji");this.a.ShowOriginalMessage=this.F.a("ShowOriginalMessage")}else{this.a.InlineComposeBottomEdge=null;this.a.InlineComposeBody=null;this.a.InsertPictureButton=null;this.a.FormatButton=null;this.a.Emoji=null;this.a.ShowOriginalMessage=null}},bz:function(){_mcp.m.prototype.bz.call(this);var t=this.a.InlineComposeBody;var n=this.a.InlineComposeBottomEdge;this.es();t&&this.bv()&&n&&this.dT.a(IMailComposeViewInitializedEvent,new _mcp.bt(t.B,this.bv().B,n.B))},dE:function(n,t){_mcp.m.prototype.dE.call(this,n,t);this.es()},b:function(n){if(this.a)switch(n){case"Emoji":if(this.a[n]){this.a[n].X();this.q(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":if(this.i(n)){this.a[n].X();this.q(n)}break;default:_mcp.m.prototype.b.call(this,n);break}},bq:function(){this.l=null;$a(this.l)&&this.i("BccRecipientWellControl")&&(this.l="BccRecipientWellControl");$a(this.l)&&this.i("CcRecipientWellControl")&&(this.l="CcRecipientWellControl");$a(this.l)&&this.i("ToRecipientWellControl")&&(this.l="ToRecipientWellControl");!_js.d.a(this.l)&&this.i(this.l)?this.a[this.l].B.bind("keydown",this.bp):_js.Trace.logWarning(this.I(),"Compose form doesn't have any control preceeding editor")},bG:function(){!_js.d.a(this.l)&&this.a&&this.a[this.l]&&this.a[this.l].B.unbind("keydown",this.bp)},ei:function(){this.bf&&this.gi()},ef:function(n){if(!_js.d.a(this.l)){this.b(this.l);this.l!=="ToRecipientWellControl"||this.i("FromFieldControl")||this.bj.e()}n.a(!0)},eh:function(n){if(!$a(this.a.SendButton)){if(!this.dU.f()){this.a.ShowOriginalMessage.X();this.q("ShowOriginalMessage")}n.a(!0)}},dx:function(n){_js.Trace.logInfo(_a.a.a,"Focused in {0}",n);this.q(n);this.s(n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl");if(this.E()&&_mcp.d.isInstanceOfType(this.E())){var i=this.E();if(this.c==="FromFieldControl"){var t=i.R();t&&t.bQ(!1)}this.c==="InsertButton"&&i.cS()}},dv:function(){_mcp.m.prototype.dv.call(this);var n=this.a.ShowOriginalMessage;$a(n)||n.B.bind("keydown",this.dN)},dL:function(){_mcp.m.prototype.dL.call(this);var n=this.a.ShowOriginalMessage;$a(n)||n.B.unbind("keydown",this.dN)},ej:function(n,t){this.bG();this.bq()},es:function(){this.gk(this.t);this.gn(!this.cs)},gn:function(n){this.i("FormatButton")&&this.a.FormatButton.gS(n);this.i("InsertPictureButton")&&this.a.InsertPictureButton.gS(n);if(this.ed()){var t=this.a.Emoji;t&&!t.bB()&&t.gS(n)}},gj:function(n){var t=new _a.U(n);var i=t.q.which;if(i===9&&!t.l()){this.b("SendButton");this.fb(t)}},gi:function(){if(!this.w)switch(this.c){case"BccRecipientWellControl":this.b("BccRecipientButton");break;case"BccRecipientButton":this.i("CcRecipientWellControl")?this.b("CcRecipientWellControl"):this.i("FromFieldControl")?this.b("ToRecipientWellControl"):this.bj.e();break;case"CcRecipientWellControl":this.b("CcRecipientButton");break;case"CcRecipientButton":this.i("FromFieldControl")?this.b("ToRecipientWellControl"):this.bj.e();break;case"ToRecipientWellControl":this.ct?this.ct=!1:this.b("ToRecipientButton");break;case"ToRecipientButton":this.i("FromFieldControl")?this.bj.e():this.s(!1);break;case"FromFieldControl":this.w||this.s(!1);break;case"ShowOriginalMessage":this.b("EditorControl");break;case"SendButton":this.b("ShowOriginalMessage");break;default:this.s(!1);break}}};_mcp._TI=function(){};_mcp._TI.$$cctor=function(){var l="IrmDialogView";new _A(l,function(){_mcp._TI.b[l]===undefined&&(_mcp._TI.b[l]=[[[-1,0,["Description"],[_mcp._TI.fl],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp._TI.fk],null,"Text",null,_mcp._TI.h,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.O,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.b);var a="MailComposeView._tid1._tid3";new _A(a,function(){_mcp._TI.b[a]===undefined&&(_mcp._TI.b[a]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.D],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_v ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.BasicDetailsPopup");n.bd("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var h="MailComposeView._tid1._tid4";new _A(h,function(){_mcp._TI.b[h]===undefined&&(_mcp._TI.b[h]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp._TI.d,_mcp._TI.cO],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[2].cloneNode(!0);var n=new _fp.e(t.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));n.bd("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var c="MailComposeView._tid1";new _A(c,function(){_mcp._TI.b[c]===undefined&&(_mcp._TI.b[c]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_b.d.b()],[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.Uw],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.iu],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.R,_mcp._TI.O,_mcp._TI.A],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.D],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.u(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.D],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.u(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.d,_mcp._TI.D],null,"IsHidden",null,_mcp._TI.a,1,new _js.j([_mcp._TI.u(),_mcp._TI.c()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp._TI.d,_mcp._TI.cQ],null,"_mcp_d",null,null,0,null,null,null]]]);var t=_mcp._TI._hf.childNodes[3].cloneNode(!0);var u=new _js.b(t.children[3]);u.y("MailComposeView._tid1._tid4");var f=new _js.b(t.children[2]);var r=new _js.b(t.children[1]);r.y("MailComposeView._tid1._tid3");var n=new _fc.b(t.children[0]);n.y("MailComposeView.FromButtonTemplate");n.U("MailCompose.FromRecipientWellButton");n.C(0);var i=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));i.A(_E.a(["SendAsContextMenuComponent","Menu"],[_mcp._TI.R,_mcp._TI.O],null,"MenuDataContext",null,_mcp._TI.bd,1)).A(_E.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.R,_mcp._TI.O,_mcp._TI.A],_mcp._TI.be,"IsShown",_mcp._TI.bb,_mcp._TI.bc,2,null,null,!1));i.a=3;i.b=1;n.G([i]);return new _B(t,[n,r,f,u]).R({FromPersona:r})},_mcp.d,_mcp.i,function(n){return new _mcp.i(n)},!1,!0,!1,0,_mcp._TI.b);var v="MailComposeView._tid9";new _A(v,function(){_mcp._TI.b[v]===undefined&&(_mcp._TI.b[v]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.P.X]],[[-1,0,["Context","Subject"],[_mcp._TI.e,_mcp._TI.bq],null,"Text",null,_mcp._TI.h,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var w="MailComposeView._tida._tidb";new _A(w,function(){_mcp._TI.b[w]===undefined&&(_mcp._TI.b[w]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp._TI.s,_mcp._TI.cM],_mcp._TI.cN,"DataContext",_mcp._TI.bC,_mcp._TI.f,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.s,_mcp._TI.br],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var i=_mcp._TI._hf.childNodes[5].cloneNode(!0);var t=new _pe.b(i.children[1],_js.a.Instance.a(_a.m));t.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");t.y("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.b(i.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _B(i,[n,t])},_mcp.d,_b.i,function(n){return new _b.i(n)},!1,!0,!1,0,_mcp._TI.b);var b="MailComposeView._tida._tidc";new _A(b,function(){_mcp._TI.b[b]===undefined&&(_mcp._TI.b[b]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.s,_mcp._TI.br],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[6].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var y="MailComposeView._tida";new _A(y,function(){_mcp._TI.b[y]===undefined&&(_mcp._TI.b[y]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.bd]],[[-1,4,null,null,null,"FormatString",null,_mcp._TI.cl,0,null,null,null,_u.R.Np],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.s,_mcp._TI.bs],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.s,_mcp._TI.bs],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]]]);var n=_mcp._TI._hf.childNodes[7].cloneNode(!0);var i=new _js.b(_B.a(n,[1,1]));i.y("MailComposeView._tida._tidc");var t=new _b.i(_B.a(n,[1,0]));t.y("MailComposeView._tida._tidb");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var p="MailComposeView._tidd";new _A(p,function(){_mcp._TI.b[p]===undefined&&(_mcp._TI.b[p]=[[[-1,0,["Context","WhenLabel"],[_mcp._TI.e,_mcp._TI.cK],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,0,["Context","MeetingCalendarTimePeriod"],[_mcp._TI.e,_mcp._TI.cJ],null,"Text",null,_mcp._TI.h,1,_mcp._TI.ch(),null,null]]]);var n=_mcp._TI._hf.childNodes[8].cloneNode(!0);var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var i="MailComposeView._tide";new _A(i,function(){_mcp._TI.b[i]===undefined&&(_mcp._TI.b[i]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.We]],[[-1,0,["Context","ProposedNewTime"],[_mcp._TI.e,_mcp._TI.cw],null,"Text",null,_mcp._TI.h,1,_mcp._TI.cg(),null,null]]]);var n=_mcp._TI._hf.childNodes[9].cloneNode(!0);var r=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,r])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var r="MailComposeView._tidf";new _A(r,function(){_mcp._TI.b[r]===undefined&&(_mcp._TI.b[r]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.P.I]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp._TI.s,_mcp._TI.cL],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[10].cloneNode(!0);var n=new _js.b(_B.a(t,[1,0]));n.y("LocationView");n.T(!0);var i=new _fc.a(t.children[0]);return new _B(t,[i,n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var n="MailComposeView._tidg";new _A(n,function(){_mcp._TI.b[n]===undefined&&(_mcp._TI.b[n]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_b.d.a()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.p,0,null,null,null,_n.a.h()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.ba,0,null,null,null,_n.a.h()],[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.hN],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.hN],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp._TI.H,_mcp._TI.dU],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp._TI.H,_mcp._TI.cU],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.S,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp._TI.bu,0,null,null,null,_nbs.a.hN],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp._TI.H,_mcp._TI.cT],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]]]);var i=_mcp._TI._hf.childNodes[11].cloneNode(!0);var t=new _fce.g(i.children[1],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));t.a=0;t.C(-1);var r=new _fc.b(i.children[0]);r.C(0);return new _B(i,[r,t])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var t="MailComposeView._tidh";new _A(t,function(){_mcp._TI.b[t]===undefined&&(_mcp._TI.b[t]=[[[-1,0,["IsOwaExtensibilityActive"],[_mcp._TI.eW],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["IsXOwaExtensibilityActive"],[_mcp._TI.eX],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]]]);var n=_mcp._TI._hf.childNodes[12].cloneNode(!0);var r=new _js.b(n.children[1]);r.y("XComposeExtensibilityView");var i=new _js.b(n.children[0]);i.y("ComposeExtensibilityView");return new _B(n,[i,r])},_y.fB,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var u="MailComposeView.FromButtonTemplate";new _A(u,function(){_mcp._TI.b[u]===undefined&&(_mcp._TI.b[u]=[[[-1,1,["Text"],[_mcp._TI.eI],null,"Text",null,_mcp._TI.h,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp._TI.eH],null,"Id",null,_mcp._TI.I,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[13].cloneNode(!0);var i=new _fc.d(n.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _B(n,[t,i]).R({Label:t,Image:i})},Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp._TI.b);var o="MailComposeView";new _A(o,function(){_mcp._TI.b[o]===undefined&&(_mcp._TI.b[o]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.S,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp._TI.z],null,"IsBusy",null,_mcp._TI.dg,1,_mcp._TI.c(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp._TI.eD],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,5,["GenericMailMode"],[_mcp._TI.eq],null,"_mcp_P",null,null,0,_mcp._TI.c(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp._TI.P,_mcp._TI.L,_mcp._TI.bp],null,"_mcp_Y",null,null,0,_mcp._TI.c(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp._TI.eD],null,"_mcp_O",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp._TI.eq],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp._TI.fz],null,"_mcp_K",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.S,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp._TI.db],null,"BusyText",null,_mcp._TI.bu,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp._TI.bt],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.z],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp._TI.by],null,"DataSource",null,_mcp._TI.ck,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp._TI.bz],null,"_mcp_T",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp._TI.eC],null,"_mcp_4",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp._TI.e,_mcp._TI.bP],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_u.R.NN],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.Rm],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.G,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.ba,0,null,null,null,_mcp.c.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp._TI.eE],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.G,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.dV],null,"_mcp_R",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.q,0,null,null,null,_nbs.a.Ys],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.G,_mcp._TI.N],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bD],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.G,_mcp._TI.M],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bD],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_u.R.QQ],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.Ph],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.F,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.ba,0,null,null,null,_mcp.c.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp._TI.eb],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.F,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.dV],null,"_mcp_R",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.q,0,null,null,null,_nbs.a.Va],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.F,_mcp._TI.N],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bD],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.F,_mcp._TI.M],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bD],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp._TI.e,_mcp._TI.dC],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_u.R.My],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.ey],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.E,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.n],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.ba,0,null,null,null,_mcp.c.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp._TI.ea],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.d,_mcp._TI.E,_mcp._TI.v],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.dV],null,"_mcp_R",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.q,0,null,null,null,_nbs.a.PU],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.E,_mcp._TI.N],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bD],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.d,_mcp._TI.r],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.d,_mcp._TI.E,_mcp._TI.M],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bD],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.W],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_u.P.X]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_mcp.c.c()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp._TI.bH,_mcp._TI.fa],null,"ClickCommand",null,_mcp._TI.i,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.bH,_mcp._TI.cr],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.I,0,null,null,null,_n.a.bz()],[-1,0,["Context","SmimeSignMessage"],[_mcp._TI.e,_mcp._TI.dF],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.I,0,null,null,null,_n.a.bF()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp._TI.e,_mcp._TI.dE],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.cX,_mcp._TI.cD],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.e,_mcp._TI.cv],null,"Id",null,_mcp._TI.I,1,_mcp._TI.cj(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.l,0,null,null,null,_mcp.c.C()],[-1,0,["MailComposeContextMenuTouchComponent","IsNotIOS"],[_mcp._TI.dW,_mcp._TI.fp],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,0,["Context","Subject"],[_mcp._TI.e,_mcp._TI.bq],_mcp._TI.cA,"Text",_mcp._TI.dj,_mcp._TI.dl,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp._TI.e,_mcp._TI.cI],null,"MaxLength",null,_mcp._TI.dk,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp._TI.e,_mcp._TI.cx],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.W],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.W],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],null,[[-1,0,["Context","HasProposedNewTime"],[_mcp._TI.e,_mcp._TI.cH],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.u(),null,!0]],[[-1,0,["Context","HasLocation"],[_mcp._TI.e,_mcp._TI.cu],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp._TI.T,_mcp._TI.bO,_mcp._TI.co],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp._TI.T,_mcp._TI.bO],_mcp._TI.eY,"DataContext",_mcp._TI.bC,_mcp._TI.f,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.Fh],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.C],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.C],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,1,["ShowRibbon"],[_mcp._TI.eF],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp._TI.ds,0,null,null,null,_nbs.a.NL],[-1,1,["EditorSizingMode"],[_mcp._TI.dd],null,"SizingMode",null,_mcp._TI.dw,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp._TI.dc],null,"MinHeight",null,_mcp._TI.dv,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp._TI.z],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bF],null,"IsCopyRestricted",null,_mcp._TI.bU,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.C],null,"IsPrintRestricted",null,_mcp._TI.du,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp._TI.e,_mcp._TI.ct],_mcp._TI.cz,"Content",_mcp._TI.dn,_mcp._TI.dr,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp._TI.e,_mcp._TI.cs],_mcp._TI.cy,"IsPlainTextContent",_mcp._TI.dp,_mcp._TI.dt,2,_mcp._TI.ci(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp._TI.cW,_mcp._TI.cB],_mcp._TI.cC,"CallContext",_mcp._TI.dm,_mcp._TI.dq,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.C],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.z],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp._TI.H,_mcp._TI.cS],null,"_mcp_J",null,null,0,_mcp._TI.c(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp._TI.eC],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bF],null,"TextSelectionType",null,_mcp._TI.fW,1,_mcp._TI.eS(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bF],null,"IsCopyRestricted",null,_mcp._TI.bU,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp._TI.e,_mcp._TI.em],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.u(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp._TI.e,_mcp._TI.em],null,"Html",null,_mcp._TI.eh,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp._TI.P,_mcp._TI.L],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp._TI.bp],null,"IsHidden",null,_mcp._TI.a,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp._TI.cY],null,"DataContext",null,_mcp._TI.f,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp._TI.bM,0,null,null,null,_nbs.a.Gc],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp._TI.dZ,_mcp._TI.ff],null,"ButtonDataList",null,_mcp._TI.bL,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp._TI.dZ,_mcp._TI.fg],_mcp._TI.fh,"IsShown",_mcp._TI.w,_mcp._TI.x,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp._TI.bH,_mcp._TI.eZ],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsShown"],[_mcp._TI.bm],_mcp._TI.bo,"IsShown",_mcp._TI.w,_mcp._TI.x,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bn],null,"DialogTitle",null,_mcp._TI.bw,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bk],null,"CloseCommand",null,_mcp._TI.bx,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bN],null,"ContentDataContext",null,_mcp._TI.bT,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bl],null,"ButtonDataList",null,_mcp._TI.bv,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp._TI.cZ,_mcp._TI.cE],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.cm],_mcp._TI.cn,"IsBusy",_mcp._TI.dh,_mcp._TI.di,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.bm],_mcp._TI.bo,"IsShown",_mcp._TI.w,_mcp._TI.x,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bn],null,"DialogTitle",null,_mcp._TI.bw,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bk],null,"CloseCommand",null,_mcp._TI.bx,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bN],null,"ContentDataContext",null,_mcp._TI.bT,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bl],null,"ButtonDataList",null,_mcp._TI.bv,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp._TI.fB],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]]]);var n=_mcp._TI._hf.childNodes[14].cloneNode(!0);var yi=new _js.c(n.children[8]);var vt=new _fce.m(n.children[7],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));vt.d("MessageOptionsView");var bt=new _fce.m(n.children[6],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));bt.d("IrmDialogView");var et=new _b.m(n.children[5],_js.a.Instance.a(_y.a),_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));et.i(!1);var ot=new _js.b(n.children[4]);ot.y("MessageBoxDefaultView");var pt=new _js.b(n.children[3]);pt.y("MailComposeView._tidh");var yt=new _b.n(_B.a(n,[2,1,3,0]));var ki=new _js.c(_B.a(n,[2,1,3]));var ht=new _js.b(_B.a(n,[2,1,2,2]));ht.y("MailComposeView._tidg");var t=_js.a.Instance.a(_js.L.$$(_zz.e)).a(_B.a(n,[2,1,2,1]));t.bn("_mcp_z ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");t.T(!0);t.C(-1);t.bY="0";var at=new _zz.b(_B.a(n,[2,1,2,0]),_js.a.Instance.a(_a.z),_js.a.Instance.a(_y.a));var vi=new _js.c(_B.a(n,[2,1,2]));var gi=new _fc.a(_B.a(n,[2,1,1,7]));var k=new _js.b(_B.a(n,[2,1,1,6,0,0]));k.y("AttachmentWellViewWrapper");k.cF(!0);k.T(!0);var wi=new _js.c(_B.a(n,[2,1,1,6]));var dt=new _js.b(_B.a(n,[2,1,1,5,4]));dt.y("MailComposeView._tidf");var ct=new _js.b(_B.a(n,[2,1,1,5,3]));ct.y("MailComposeView._tide");var gt=new _js.b(_B.a(n,[2,1,1,5,2]));gt.y("MailComposeView._tidd");var ti=new _js.b(_B.a(n,[2,1,1,5,1]));ti.y("MailComposeView._tida");var ii=new _js.b(_B.a(n,[2,1,1,5,0]));ii.y("MailComposeView._tid9");var fi=new _js.c(_B.a(n,[2,1,1,5]));var ft=new _cmc.i(_B.a(n,[2,1,1,4,1,5,0]));ft.C(0);var ni=new _fc.b(_B.a(n,[2,1,1,4,1,4]));var s=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));s.A(_E.a(["MailComposeContextMenuTouchComponent","Menu"],[_mcp._TI.dW,_mcp._TI.en],null,"MenuDataContext",null,_mcp._TI.bd,1)).A(_E.a(["MailComposeContextMenuTouchComponent","Menu","IsShown"],[_mcp._TI.dW,_mcp._TI.en,_mcp._TI.A],_mcp._TI.be,"IsShown",_mcp._TI.bb,_mcp._TI.bc,2,null,null,!1));s.a=3;s.b=5;ni.G([s]);var si=new _fc.d(_B.a(n,[2,1,1,4,1,3]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var oi=new _fc.d(_B.a(n,[2,1,1,4,1,2]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var pi=new _fc.d(_B.a(n,[2,1,1,4,1,1]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var ir=new _fc.b(_B.a(n,[2,1,1,4,1,0]));var ri=new _fc.a(_B.a(n,[2,1,1,4,0]));ri.C(-1);var ur=new _js.c(_B.a(n,[2,1,1,4]));var h=new _js.b(_B.a(n,[2,1,1,3,2,0]));h.y("ReadOnlyRecipientWellView");h.cF(!0);h.T(!0);var nr=new _js.c(_B.a(n,[2,1,1,3,2]));var c=new _js.b(_B.a(n,[2,1,1,3,1,1]));c.y("ReadWriteRecipientWellView");c.H(26);c.cF(!0);var u=new _fc.b(_B.a(n,[2,1,1,3,1,0,0]));u.l=!0;u.C(-1);u.N(!0);var ei=new _js.c(_B.a(n,[2,1,1,3,1,0]));var ui=new _js.c(_B.a(n,[2,1,1,3,1]));var tt=new _fc.b(_B.a(n,[2,1,1,3,0]));tt.C(-1);var kt=new _js.c(_B.a(n,[2,1,1,3]));var f=new _js.b(_B.a(n,[2,1,1,2,2,0]));f.y("ReadOnlyRecipientWellView");f.cF(!0);f.T(!0);var hi=new _js.c(_B.a(n,[2,1,1,2,2]));var r=new _js.b(_B.a(n,[2,1,1,2,1,1]));r.y("ReadWriteRecipientWellView");r.cF(!0);r.H(26);r.T(!0);var p=new _fc.b(_B.a(n,[2,1,1,2,1,0,0]));p.l=!0;p.C(-1);p.N(!0);var tr=new _js.c(_B.a(n,[2,1,1,2,1,0]));var di=new _js.c(_B.a(n,[2,1,1,2,1]));var it=new _fc.b(_B.a(n,[2,1,1,2,0]));it.C(-1);var wt=new _js.c(_B.a(n,[2,1,1,2]));var rt=new _js.b(_B.a(n,[2,1,1,1,2,0]));rt.y("ReadOnlyRecipientWellView");rt.T(!0);var bi=new _js.c(_B.a(n,[2,1,1,1,2]));var i=new _js.b(_B.a(n,[2,1,1,1,1,1]));i.y("ReadWriteRecipientWellView");i.H(26);i.T(!0);var b=new _fc.b(_B.a(n,[2,1,1,1,1,0,0]));b.l=!0;b.C(-1);b.N(!0);var fr=new _js.c(_B.a(n,[2,1,1,1,1,0]));var er=new _js.c(_B.a(n,[2,1,1,1,1]));var d=new _fc.b(_B.a(n,[2,1,1,1,0]));d.C(0);var nt=new _mcp.i(_B.a(n,[2,1,1,0,0]));nt.y("MailComposeView._tid1");var rr=new _js.c(_B.a(n,[2,1,1]));var g=_js.a.Instance.a(_js.L.$$(_b.w)).a(_B.a(n,[2,1,0]));g.C(0);var a=new _js.c(_B.a(n,[2,1]));a.C(-1);var lt=new _fc.g;var ut=new _fc.c;ut.A(_E.a(["TouchComponent","CloseCommand"],[_mcp._TI.dZ,_mcp._TI.fe],null,"Command",null,_mcp._TI.o,1));ut.i("ESC");var v=new _fc.c;v.A(_E.a(["SaveComponent","SaveCommand"],[_mcp._TI.bS,_mcp._TI.cF],null,"Command",null,_mcp._TI.o,1));v.i("S");v.j=2;var y=new _fc.c;y.A(_E.a(["SendComponent","AltSSendCommand"],[_mcp._TI.Y,_mcp._TI.cR],null,"Command",null,_mcp._TI.o,1)).A(_E.a(["DoesSupportAltSForSend"],[_mcp._TI.cV],null,"PreventDefault",null,_mcp._TI.U,1,null,null,!1));y.i("S");y.j=4;var w=new _fc.c;w.A(_E.a(["SendComponent","SendCommand"],[_mcp._TI.Y,_mcp._TI.X],null,"Command",null,_mcp._TI.o,1));w.i("ENTER");w.j=2;var l=new _fc.c;l.A(_E.a(["RecipientComponent","ResolveCommand"],[_mcp._TI.d,_mcp._TI.cP],null,"Command",null,_mcp._TI.o,1));l.i("K");l.j=2;var e=new _fc.c;e.D(_E.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp._TI.k,_mcp._TI.k,_mcp._TI.bA],null,"Command",null,_mcp._TI.o,1)).D(_E.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.k,_mcp._TI.k,_mcp._TI.K],null,"PreventDefault",null,_mcp._TI.U,1,null,null,!1)).D(_E.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.k,_mcp._TI.k,_mcp._TI.K],null,"StopPropagation",null,_mcp._TI.bB,1,null,null,!1));e.i("TAB");e.j=1;lt.a([ut,v,y,w,l,e]);a.G([lt]);var ai=new _fce.g(_B.a(n,[2,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));var ci=new _fce.f(n.children[2],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));var li=new _js.c(n.children[1]);var st=new _fce.g(n.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));st.a=0;st.d("");return new _B(n,[st,li,ci,ai,a,g,rr,nt,d,er,fr,b,i,bi,rt,wt,it,di,tr,p,r,hi,f,kt,tt,ui,ei,u,c,nr,h,ur,ri,ir,pi,oi,si,ni,ft,fi,ii,ti,gt,ct,dt,wi,k,gi,vi,at,t,ht,ki,yt,pt,ot,et,bt,vt,yi]).R({ComposeViewContent:a,InfoBarControl:g,FromFieldControl:nt,ToRecipientButton:d,ToRecipientWellControl:i,CcRecipientWellControl:wt,CcRecipientButton:it,BccRecipientWellControl:kt,BccRecipientButton:tt,SubjectTextBox:ft,Ribbon:at,EditorControl:t,QuotedBodyHtmlLabel:yt,MessageBox:ot,CancelConfirmDialog:et})},_mcp.d,_mcp.m,function(n){return new _mcp.m(n,_js.a.Instance.a(_js.F),_js.a.Instance.a(_a.e),_js.a.Instance.a(_a.t),_js.a.Instance.a(_a.h),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.x),_js.a.Instance.a(_b.e))},!1,!1,!1,0,_mcp._TI.b);var s="MessageOptionsView._tidj1";new _A(s,function(){_mcp._TI.b[s]===undefined&&(_mcp._TI.b[s]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.LX],[-1,0,["SmimeEncryptMessage"],[_mcp._TI.fE],_mcp._TI.fI,"IsChecked",_mcp._TI.bJ,_mcp._TI.bK,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp._TI.fF],null,"IsEnabled",null,_mcp._TI.df,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.MD],[-1,0,["SmimeSignMessage"],[_mcp._TI.fG],_mcp._TI.fJ,"IsChecked",_mcp._TI.bJ,_mcp._TI.bK,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp._TI.fH],null,"IsEnabled",null,_mcp._TI.df,1,null,null,!1]]]);var n=_mcp._TI._hf.childNodes[54].cloneNode(!0);var i=new _fc.i(n.children[1],_js.a.Instance.a(_ff.a));var t=new _fc.i(n.children[0],_js.a.Instance.a(_ff.a));return new _B(n,[t,i])},_mcp.C,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.b);var f="MessageOptionsView.SensitivityTemplate";new _A(f,function(){_mcp._TI.b[f]===undefined&&(_mcp._TI.b[f]=[[[-1,1,["DataContext"],[_mcp._TI.bC],null,"Text",null,_mcp._TI.h,1,_mcp._TI.eg(),null,null]]]);var n=_mcp._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},Object,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.b);var e="MessageOptionsView";new _A(e,function(){_mcp._TI.b[e]===undefined&&(_mcp._TI.b[e]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.h,0,null,null,null,_nbs.a.TK]],[[-1,0,["SensitivityOptions"],[_mcp._TI.ew],null,"Options",null,_mcp._TI.eK,1,null,null,null],[-1,0,["Sensitivity"],[_mcp._TI.ev],_mcp._TI.eB,"SelectedValue",_mcp._TI.eJ,_mcp._TI.eL,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.Vh],[-1,0,["IsDeliveryReceiptRequested"],[_mcp._TI.et],_mcp._TI.ez,"IsChecked",_mcp._TI.bJ,_mcp._TI.bK,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp._TI.ex],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.m,0,null,null,null,_nbs.a.Ym],[-1,0,["IsReadReceiptRequested"],[_mcp._TI.eu],_mcp._TI.eA,"IsChecked",_mcp._TI.bJ,_mcp._TI.bK,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp._TI.ey],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp._TI.fD],null,"IsHidden",null,_mcp._TI.a,1,_mcp._TI.c(),null,!0]]]);var n=_mcp._TI._hf.childNodes[55].cloneNode(!0);var i=new _js.b(n.children[4]);i.y("MessageOptionsView._tidj1");var u=new _fc.i(n.children[3],_js.a.Instance.a(_ff.a));var f=new _fc.i(n.children[2],_js.a.Instance.a(_ff.a));var t=new _fce.j(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,f,u,i])},_mcp.C,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.b)};_mcp._TI.eU=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mcp_2'></span> <span class='_mcp_2'></span> </div><div> <span></span> </div><div> <div class='_mcp_s ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_e'></button> <div class='_mcp_u'></div> <div class='_mcp_c'></div> <div class='_mcp_c'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_j ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_q'></span> <span class='_mcp_q'></span> </div><div> <span class='_mcp_q'></span> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_n _mcp_o _mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <div class='_mcp_7'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_V _mcp_W'></div>  <div class='_mcp_V _mcp_X'></div> </div><div> <span class='_mcp_g ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_f'></span> </div><div> <div class='_mcp_E'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_G'> <div class='_mcp_H ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_N'></div> <div class='_mcp_L'> <div class='_mcp_a'> <div class='_mcp_5 _mcp_M _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_5 _mcp_Q _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_D'></button> <div> <div class='_mcp_C'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_Q _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_D'></button> <div> <div class='_mcp_C'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_Q _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_D'></button> <div> <div class='_mcp_C'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_9 _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <span class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_k'></span> <div class='_mcp_r'> <button type='button' class='_mcp_w _mcp_m'></button> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <button type='button' class='_mcp_w ms-font-xl'></button> <div class='_mcp_x'> <input autoid=\"_mcp_3\" class='_mcp_s _mcp_t ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6'></div> <div class='_mcp_6 ms-bg-color-white'></div> </div> <div> <div class='_mcp_5 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_L ms-bg-color-white'> <div></div> <div autoid=\"_mcp_4\" class='_mcp_y'></div> <div class='_mcp_I ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_L ms-bg-color-white'> <span class='_mcp_A ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_F'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_B1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_p1'></button> <div class='_mcp_E1'></div> <div class='_mcp_m1'></div> <div class='_mcp_m1'></div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <span autoid=\"_mcp_l\" class='_mcp_u1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_J1'></span> <span class='_mcp_J1'></span> </div><div> <span class='_mcp_J1'></span> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <div> <span class='_mcp_J1 _mcp_I1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_K1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <span autoid=\"_mcp_m\" class='_mcp_I1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <span autoid=\"_mcp_n\" class='_mcp_I1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_v1'></span> <div class='_mcp_x1'> <div class='_mcp_i1'></div> </div> </div><div> <button autoid=\"_mcp_o\" type='button'></button> <div></div> </div><div> <span class='_mcp_r1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_q1'></span> </div><div> <iframe autoid=\"_mcp_t\" class='_mcp_62'></iframe> </div><div> <div class='_mcp_72'> <button type='button' class='_mcp_82 _mcp_P1 ms-font-weight-regular'></button> <span></span> </div> </div><div> <div></div> <div class='_mcp_Z1'></div> <span class='_mcp_Z1'></span> <div class='_mcp_81 ms-bg-color-white'> <div class='_mcp_52'></div> <div class='_mcp_b1'>  <span class='_mcp_d1'> <div class='_mcp_U1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_P1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_P1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_P1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_P1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_P1 ms-font-weight-regular _mcp_S1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_P1 ms-font-weight-regular'></button> </span> <span class='_mcp_e1'> <button autoid=\"_mcp_b\" type='button' class='_mcp_P1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_c1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_11'> <div class='_mcp_21 _mcp_51'></div> <div class='_mcp_21 _mcp_41'> <div class='_mcp_61 ms-bg-color-white customScrollBar'>  <div class='_mcp_f1 ms-font-weight-regular'></div> <div class='_mcp_g1 _mcp_l1 ms-border-color-neutralTertiary'></div> <div class='_mcp_g1 _mcp_j1 _mcp_l1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_32'></button> <div class='_mcp_x1 _mcp_z1 _mcp_y1'> <div class='_mcp_22'> <button autoid=\"_mcp_e\" type='button'></button> </div> <div autoid=\"_mcp_f\" class='_mcp_W1'></div> </div> <div class='_mcp_x1 _mcp_z1 _mcp_y1 _mcp_A1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_g1 _mcp_j1 _mcp_l1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_32'></button> <div class='_mcp_x1 _mcp_z1 _mcp_y1'> <div class='_mcp_22'> <button type='button'></button> </div> <div autoid=\"_mcp_g\" class='_mcp_W1'></div> </div> <div class='_mcp_x1 _mcp_z1 _mcp_y1 _mcp_A1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_g1 _mcp_j1 _mcp_l1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_32'></button> <div class='_mcp_x1 _mcp_z1 _mcp_y1'> <div class='_mcp_22'> <button type='button'></button> </div> <div autoid=\"_mcp_h\" class='_mcp_W1'></div> </div> <div class='_mcp_x1 _mcp_z1 _mcp_y1 _mcp_A1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_g1'> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_w1 '></span> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_w1 '></span> </div> <div class='_mcp_g1 _mcp_h1 _mcp_l1 ms-border-color-neutralTertiary'> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_w1'></span> <div class='_mcp_x1'> <span class='_mcp_Y1'></span> <span autoid=\"_mcp_i\" class='_mcp_X1'></span> <span autoid=\"_mcp_j\" class='_mcp_X1'></span> <span class='_mcp_X1'></span> <div class='_mcp_W1'> <input autoid=\"_mcp_k\" class='_mcp_B1 _mcp_C1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> </div> <div class='_mcp_G1 ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> <span></span> <span></span> <div class='_mcp_L1 ms-bg-color-white'> <div class='_mcp_Z'></div> <div class='_mcp_M1'></div> <div class='_mcp_92 ms-border-color-neutralTertiary'></div> </div> </div> </div> <div></div> <div class='_mcp_02 ms-bg-color-white'></div> <div autoid=\"_mcp_p\"></div> <div autoid=\"_mcp_q\"></div> <div></div> <div></div>  <div autoid=\"_mcp_r\"></div> <div autoid=\"_mcp_s\"></div>     </div><div> <div class='_mcp_Q2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_u\" type='button' class='_mcp_D2'></button> <div class='_mcp_T2'></div> <div class='_mcp_B2'></div> <div class='_mcp_B2'></div> <div></div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <span autoid=\"_mcp_A\" class='_mcp_I2 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_03'></span> <span class='_mcp_03'></span> </div><div> <span class='_mcp_03'></span> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <div> <span class='_mcp_03 _mcp_Z2 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_13'></span> <div></div> </div> </div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <span autoid=\"_mcp_B\" class='_mcp_Z2 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <span autoid=\"_mcp_C\" class='_mcp_Z2 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_J2'></span> <div class='_mcp_L2'> <div class='_mcp_t2'></div> </div> </div><div> <span class='ms-font-weight-regular ms-font-color-neutralSecondary ms-font-m'></span> </div><div> <span class='_mcp_p2'></span> <span class='_mcp_p2'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_p2 ms-border-color-neutralTertiary'></button> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_p2 _mcp_y2 ms-border-color-neutralTertiary'></button> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_p2 _mcp_q2'></button> </div><div> <div class='_mcp_l2 _mcp_n2'></div> </div><div> <div class='_mcp_n3'></div> <span class='_mcp_n3'></span> <div class='_mcp_c2'> <div class='_mcp_d2 _mcp_s3'></div> <div class='_mcp_d2 _mcp_e2 ms-bg-color-white'> <div class='_mcp_g2'> <div class='_mcp_m2 ms-font-weight-regular'></div> </div> <div class='ms-border-color-neutralTertiary _mcp_x2'> <div class='_mcp_f2 ms-bg-color-white customScrollBar _mcp_z2 ms-border-color-neutralTertiary'>  <div class='_mcp_r2 _mcp_z2 ms-border-color-neutralLight'></div> <div class='_mcp_r2 _mcp_u2'> <button autoid=\"_mcp_v\" type='button' class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_q3'></button> <div class='_mcp_L2 _mcp_M2'> <div autoid=\"_mcp_w\" class='_mcp_k3'></div> </div> <div class='_mcp_L2 _mcp_M2 _mcp_N2'> <div class='_mcp_k3'></div> </div> <div></div>  </div> <div class='_mcp_r2 _mcp_u2 _mcp_A2 ms-border-color-neutralLight'> <button type='button' class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_q3'></button> <div class='_mcp_L2 _mcp_M2'> <div autoid=\"_mcp_x\" class='_mcp_k3'></div> </div> <div class='_mcp_L2 _mcp_N2'> <div class='_mcp_k3'></div> </div>  </div> <div class='_mcp_r2 _mcp_u2 _mcp_A2 ms-border-color-neutralLight'> <button type='button' class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_q3'></button> <div class='_mcp_L2 _mcp_M2'> <div autoid=\"_mcp_y\" class='_mcp_k3'></div> </div> <div class='_mcp_L2 _mcp_N2'> <div class='_mcp_k3'></div> </div>  </div> <div class='_mcp_r2'> <span class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_K2 '></span> <span class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_K2 '></span> </div> <div class='_mcp_r2 _mcp_s2 _mcp_z2 ms-border-color-neutralTertiary'> <span class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_K2'></span> <div class='_mcp_L2'> <div class='_mcp_k3'> <input autoid=\"_mcp_z\" class='_mcp_Q2 _mcp_R2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> </div> <div class='_mcp_V2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_W2 ms-border-color-neutralLight'></div> </div> <span></span> <span></span> <div class='_mcp_a2 ms-bg-color-white'></div> <div class='_mcp_23'> <div></div> </div> <div class='_mcp_w3'> <button autoid=\"_mcp_D\" type='button'></button> <div></div> </div> </div> <div class='_mcp_g2 ms-bg-color-white ms-border-color-neutralTertiary'> <div class='_mcp_i2'>  <span> <div class='_mcp_i3'> <button autoid=\"_mcp_E\" type='button' class='_mcp_73 _mcp_a3'></button> <button type='button' class='_mcp_63 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_i3'> <button autoid=\"_mcp_F\" type='button' class='_mcp_73 _mcp_b3'></button> </div> <div class='_mcp_i3'> <button autoid=\"_mcp_G\" type='button' class='_mcp_c3'></button> </div> <div class='_mcp_i3'> <button autoid=\"_mcp_H\" type='button' class='_mcp_c3'></button> </div> <div class='_mcp_i3'> <div></div> </div> <div class='_mcp_i3'> <span class='_mcp_c3 _mcp_y3 ms-fwt-r ms-fcl-nt ms-font-m'></span> </div> <div class='_mcp_i3'> <button type='button' class='_mcp_c3'></button> </div> <div class='_mcp_i3'> <button autoid=\"_mcp_I\" type='button' class='_mcp_c3'></button> </div> <div class='_mcp_i3'> <button autoid=\"_mcp_J\" type='button' class='_mcp_c3'></button> </div> </span> <span class='_mcp_l2'> <button autoid=\"_mcp_K\" type='button' class='_mcp_63 ms-font-weight-regular'></button> <div class='_mcp_z3'></div> </span> </div> <div class='_mcp_j2 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_o3 ms-bg-color-white'></div> <div autoid=\"_mcp_L\"></div> <div></div> <div></div> <div autoid=\"_mcp_M\"></div> <div autoid=\"_mcp_N\"></div>  </div><div> <div class='_mcp_84 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_O\" type='button' class='_mcp_W3'></button> <div class='_mcp_b4'></div> <div class='_mcp_T3'></div> <div class='_mcp_T3'></div> </div><div> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_44'> <span autoid=\"_mcp_X\" class='_mcp_14 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_h4'></span> <span class='_mcp_h4'></span> </div><div> <span class='_mcp_h4'></span> </div><div> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_44'> <div> <span class='_mcp_h4 _mcp_g4 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_i4'></span> <div></div> </div> </div> </div><div> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_44'> <span autoid=\"_mcp_Y\" class='_mcp_g4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_44'> <span autoid=\"_mcp_Z\" class='_mcp_g4 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_04 ms-font-weight-semibold ms-font-color-black _mcp_24'></span> <div class='_mcp_44'> <div class='_mcp_P3'></div> </div> </div><div> <button autoid=\"_mcp_01\" type='button'></button> <div></div> </div><div> <div class='_mcp_D4'></div> <span class='_mcp_D4'></span> <div class='_mcp_C3'> <div class='_mcp_D3 _mcp_J4'></div> <div class='_mcp_D3 _mcp_E3 ms-bg-color-white'> <div class='_mcp_F3 ms-bg-color-white customScrollBar'>  <div class='_mcp_M3 ms-font-weight-regular'></div> <div class='_mcp_N3 _mcp_S3 ms-border-color-neutralTertiary'></div> <div class='_mcp_N3 _mcp_Q3 _mcp_S3 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_P\" type='button' class='_mcp_Z3 ms-font-weight-semibold ms-font-color-black _mcp_H4'></button> <div class='_mcp_44 _mcp_64 _mcp_54'> <div class='_mcp_G4'> <button autoid=\"_mcp_Q\" type='button'></button> </div> <div autoid=\"_mcp_R\" class='_mcp_A4'></div> </div> <div class='_mcp_44 _mcp_64 _mcp_54'> <div class='_mcp_A4'></div> </div>  </div> <div class='_mcp_N3 _mcp_Q3 _mcp_S3 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_Z3 ms-font-weight-semibold ms-font-color-black _mcp_H4'></button> <div class='_mcp_44 _mcp_64 _mcp_54'> <div class='_mcp_G4'> <button type='button'></button> </div> <div autoid=\"_mcp_S\" class='_mcp_A4'></div> </div> <div class='_mcp_44 _mcp_64'> <div class='_mcp_A4'></div> </div>  </div> <div class='_mcp_N3 _mcp_Q3 _mcp_S3 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_Z3 ms-font-weight-semibold ms-font-color-black _mcp_H4'></button> <div class='_mcp_44 _mcp_64 _mcp_54'> <div class='_mcp_G4'> <button type='button'></button> </div> <div autoid=\"_mcp_T\" class='_mcp_A4'></div> </div> <div class='_mcp_44 _mcp_64'> <div class='_mcp_A4'></div> </div>  </div> <div class='_mcp_N3'> <span class='_mcp_Z3 ms-font-weight-semibold ms-font-color-black _mcp_34 '></span> <span class='_mcp_Z3 ms-font-weight-semibold ms-font-color-black _mcp_34 '></span> </div> <div class='_mcp_N3 _mcp_O3 _mcp_S3 ms-border-color-neutralTertiary'> <span class='_mcp_Z3 ms-font-weight-semibold ms-font-color-black _mcp_34'></span> <div class='_mcp_44'> <span class='_mcp_C4'></span> <span autoid=\"_mcp_U\" class='_mcp_B4'></span> <span autoid=\"_mcp_V\" class='_mcp_B4'></span> <span class='_mcp_B4'></span> <div class='_mcp_A4'> <input autoid=\"_mcp_W\" class='_mcp_84 _mcp_94 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_R3'></div> <div class='_mcp_R3'></div> <div class='_mcp_R3'></div> <div class='_mcp_R3'></div> <div class='_mcp_R3'></div> </div> </div> <span></span> <span></span> <div class='_mcp_A3 ms-bg-color-white'></div> <div class='_mcp_j4 ms-bg-color-white'></div> <div class='_mcp_N4 ms-border-color-neutralTertiary'></div> <div class='_mcp_d4 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_e4 ms-bg-color-white'></div> <div class='_mcp_G3 ms-bg-color-white ms-border-color-neutralTertiary'> <div class='_mcp_I3'>  <span> <div class='_mcp_y4'> <button autoid=\"_mcp_11\" type='button' class='_mcp_n4 _mcp_q4'></button> <button type='button' class='_mcp_m4 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_y4'> <button autoid=\"_mcp_21\" type='button' class='_mcp_n4 _mcp_r4'></button> </div> <div class='_mcp_x4'> <button autoid=\"_mcp_31\" type='button' class='_mcp_m4 ms-font-weight-regular _mcp_v4'></button> </div> <button autoid=\"_mcp_41\" type='button' class='_mcp_m4 ms-font-weight-regular'></button> </span> <span class='_mcp_L3'> <div class='_mcp_y4'> <button autoid=\"_mcp_51\" type='button' class='_mcp_s4'></button> </div> <button autoid=\"_mcp_61\" type='button' class='_mcp_m4 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_J3 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_E4 ms-bg-color-white'></div> <div autoid=\"_mcp_71\"></div> <div></div> <div></div> <div autoid=\"_mcp_81\"></div> <div autoid=\"_mcp_91\"></div> </div><div> <button autoid=\"_mcp_d1\" type='button' class='_mcp_Q4'></button> <button autoid=\"_mcp_e1\" type='button' class='_mcp_Q4'></button> </div><div> <span class='_mcp_O4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_a1\" class='_mcp_P4'></div> <button autoid=\"_mcp_b1\" type='button' class='_mcp_Q4'></button> <button autoid=\"_mcp_c1\" type='button' class='_mcp_Q4'></button>  <div></div> <div class='_mcp_R4'></div>  </div><div> <span class='_mcp_S4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_T4'></div> <button type='button' class='_mcp_U4'></button> <button type='button' class='_mcp_U4'></button>  </div>";_js.c.a().appendChild(n);return n};_mcp._TI.fl=function(n){return n.b};_mcp._TI.fk=function(n){return n.a};_mcp._TI.d=function(n){return n.R()};_mcp._TI.D=function(n){return n.g};_mcp._TI.cO=function(n){return n.j()};_mcp._TI.R=function(n){return n.dy()};_mcp._TI.O=function(n){return n.a()};_mcp._TI.A=function(n){return n.i};_mcp._TI.bb=function(n){return n.c()};_mcp._TI.cQ=function(n){return n.bh};_mcp._TI.e=function(n){return n.L};_mcp._TI.bq=function(n){return n.z()};_mcp._TI.s=function(n){return n.dx()};_mcp._TI.cM=function(n){return n.b()};_mcp._TI.bC=function(n){return n.E()};_mcp._TI.br=function(n){return n.c()};_mcp._TI.bs=function(n){return n.d()};_mcp._TI.cK=function(n){return _mcp.a.isInstanceOfType(n)?n.fT():null};_mcp._TI.cJ=function(n){return _mcp.a.isInstanceOfType(n)?n.eo():null};_mcp._TI.cw=function(n){return n.cb()};_mcp._TI.cL=function(n){return n.g()};_mcp._TI.H=function(n){return n.ca()};_mcp._TI.dU=function(n){return n.l()};_mcp._TI.cU=function(n){return n.N()};_mcp._TI.cT=function(n){return n.M()};_mcp._TI.eW=function(n){return n.c()};_mcp._TI.eX=function(n){return n.d()};_mcp._TI.eI=function(n){return n.v};_mcp._TI.eH=function(n){return n.s()};_mcp._TI.z=function(n){return n.Z};_mcp._TI.eD=function(n){return n.cd};_mcp._TI.eq=function(n){return OwaApplication.b};_mcp._TI.P=function(n){return n.bf()};_mcp._TI.L=function(n){return n.g};_mcp._TI.bp=function(n){return n.l()};_mcp._TI.fz=function(n){return n.dh()};_mcp._TI.db=function(n){return n.cj};_mcp._TI.bt=function(n){return n.bO};_mcp._TI.dZ=function(n){return n.z()};_mcp._TI.fe=function(n){return n.a()};_mcp._TI.bS=function(n){return n.d()};_mcp._TI.cF=function(n){return n.d()};_mcp._TI.Y=function(n){return n.e()};_mcp._TI.cR=function(n){return _mcp.o.isInstanceOfType(n)?n.w:null};_mcp._TI.cV=function(n){return n.cU()};_mcp._TI.X=function(n){return n.a()};_mcp._TI.cP=function(n){return n.y};_mcp._TI.k=function(n){return n.L};_mcp._TI.bA=function(n){return _mcp.m.isInstanceOfType(n)?n.dJ:null};_mcp._TI.K=function(n){return _mcp.m.isInstanceOfType(n)?n.bf:null};_mcp._TI.by=function(n){return n.M};_mcp._TI.n=function(n){return n.dp()};_mcp._TI.bz=function(n){return n.dq()};_mcp._TI.eC=function(n){return n.dz()};_mcp._TI.bP=function(n){return n.i()};_mcp._TI.G=function(n){return n.c};_mcp._TI.v=function(n){return n.E()};_mcp._TI.g=function(n){return n.dm()};_mcp._TI.r=function(n){return n.f};_mcp._TI.eE=function(n){return n.eC()};_mcp._TI.dV=function(n){return n.dk()};_mcp._TI.N=function(n){return n.a};_mcp._TI.bD=function(n){return _rw.a.isInstanceOfType(n)?n.dn():null};_mcp._TI.M=function(n){return n.b};_mcp._TI.F=function(n){return n.d};_mcp._TI.eb=function(n){return n.eA()};_mcp._TI.dC=function(n){return n.s()};_mcp._TI.E=function(n){return n.e};_mcp._TI.ea=function(n){return n.ez()};_mcp._TI.W=function(n){return n.bx()};_mcp._TI.bH=function(n){return n.bi()};_mcp._TI.fa=function(n){return n.h()};_mcp._TI.cr=function(n){return n.c()};_mcp._TI.dF=function(n){return n.F()};_mcp._TI.dE=function(n){return n.u()};_mcp._TI.cX=function(n){return n.bX()};_mcp._TI.cD=function(n){return n.c()};_mcp._TI.cv=function(n){return n.bb()};_mcp._TI.dW=function(n){return n.du()};_mcp._TI.fp=function(n){return n.h()};_mcp._TI.en=function(n){return n.b()};_mcp._TI.dj=function(n){return n.b};_mcp._TI.cI=function(n){return _mcp.a.isInstanceOfType(n)?255:null};_mcp._TI.cx=function(n){return n.cc()};_mcp._TI.cH=function(n){return _mcp.a.isInstanceOfType(n)?n.eO():null};_mcp._TI.cu=function(n){return n.bV()};_mcp._TI.T=function(n){return n.Q()};_mcp._TI.bO=function(n){return n.a()};_mcp._TI.co=function(n){return n.p()};_mcp._TI.C=function(n){return _mcp.a.isInstanceOfType(n)?n.fN():null};_mcp._TI.eF=function(n){return n.cq};_mcp._TI.bF=function(n){return _mcp.a.isInstanceOfType(n)?n.fM():null};_mcp._TI.ct=function(n){return n.M()};_mcp._TI.dn=function(n){return n.bW()};_mcp._TI.cs=function(n){return n.d()};_mcp._TI.dp=function(n){return n.ey()};_mcp._TI.cW=function(n){return n.bo()};_mcp._TI.cB=function(n){return n.b()};_mcp._TI.dm=function(n){return n.ca};_mcp._TI.dd=function(n){return n.ey()};_mcp._TI.dc=function(n){return n.ex()};_mcp._TI.cS=function(n){return n.Z()};_mcp._TI.em=function(n){return n.cI()};_mcp._TI.cY=function(n){return n.T};_mcp._TI.ff=function(n){return n.d()};_mcp._TI.fg=function(n){return n.e()};_mcp._TI.w=function(n){return n.b()};_mcp._TI.eZ=function(n){return n.g()};_mcp._TI.bm=function(n){return n.j};_mcp._TI.bn=function(n){return n.p};_mcp._TI.bk=function(n){return n.i};_mcp._TI.bN=function(n){return n.q};_mcp._TI.bl=function(n){return n.h};_mcp._TI.cZ=function(n){return n.bB()};_mcp._TI.cE=function(n){return n.a()};_mcp._TI.cm=function(n){return n.D};_mcp._TI.dh=function(n){return n.bX};_mcp._TI.fB=function(n){return n.bj};_mcp._TI.y=function(n){return n.dr()};_mcp._TI.bG=function(n){return n.bE};_mcp._TI.bi=function(n){return n.cC()};_mcp._TI.fd=function(n){return n.e()};_mcp._TI.fb=function(n){return n.a()};_mcp._TI.fc=function(n){return n.b()};_mcp._TI.fQ=function(n){return n.eM()};_mcp._TI.fM=function(n){return n.eB()};_mcp._TI.fT=function(n){return n.m};_mcp._TI.fP=function(n){return n.eL()};_mcp._TI.bR=function(n){return n.W()};_mcp._TI.bQ=function(n){return n.e};_mcp._TI.V=function(n){return n.bB()};_mcp._TI.Q=function(n){return n.bY()};_mcp._TI.fC=function(n){return n.ds()};_mcp._TI.fo=function(n){return n.a};_mcp._TI.fO=function(n){return n.eK()};_mcp._TI.bg=function(n){return n.cU()};_mcp._TI.J=function(n){return n.bh()};_mcp._TI.bE=function(n){return n.a()};_mcp._TI.dB=function(n){return n.bv()};_mcp._TI.cq=function(n){return n.d()};_mcp._TI.es=function(n){return n.ci};_mcp._TI.da=function(n){return n.br};_mcp._TI.cp=function(n){return n.c()};_mcp._TI.ek=function(n){return n.b()};_mcp._TI.eQ=function(n){return n.c()};_mcp._TI.eM=function(n){return n.B};_mcp._TI.ei=function(n){return n.a()};_mcp._TI.ej=function(n){return n.b()};_mcp._TI.bh=function(n){return n.be()};_mcp._TI.bf=function(n){return n.b()};_mcp._TI.fA=function(n){return n.dj()};_mcp._TI.bI=function(n){return n.b()};_mcp._TI.dN=function(n){return n.d()};_mcp._TI.er=function(n){return n.bN};_mcp._TI.dA=function(n){return n.u()};_mcp._TI.dO=function(n){return n.c};_mcp._TI.ee=function(n){return n.w.length};_mcp._TI.dS=function(n){return n.cV()};_mcp._TI.dT=function(n){return n.cZ()};_mcp._TI.dR=function(n){return n.bb};_mcp._TI.dQ=function(n){return n.cR()};_mcp._TI.dP=function(n){return n.cP()};_mcp._TI.dD=function(n){return n.ca()};_mcp._TI.ec=function(n){return n.dD};_mcp._TI.fN=function(n){return n.bc};_mcp._TI.dX=function(n){return n.cg};_mcp._TI.dG=function(n){return n.f()};_mcp._TI.dH=function(n){return n.g()};_mcp._TI.fq=function(n){return _mcp.x.isInstanceOfType(n)?n.i:null};_mcp._TI.fr=function(n){return _mcp.x.isInstanceOfType(n)?n.l:null};_mcp._TI.dz=function(n){return n.u};_mcp._TI.dY=function(n){return n.dC()};_mcp._TI.dK=function(n){return n.d()};_mcp._TI.dJ=function(n){return n.c()};_mcp._TI.ep=function(n){return _mcp.z.isInstanceOfType(n)?n.v:null};_mcp._TI.fy=function(n){return n.cY()};_mcp._TI.eo=function(n){return n.cX()};_mcp._TI.fx=function(n){return n.r};_mcp._TI.fv=function(n){return _mcp.k.isInstanceOfType(n)?n.N:null};_mcp._TI.eV=function(n){return n.q()};_mcp._TI.ft=function(n){return _mcp.k.isInstanceOfType(n)?n.K:null};_mcp._TI.fm=function(n){return _mcp.l.isInstanceOfType(n)?n.v:null};_mcp._TI.fn=function(n){return _mcp.l.isInstanceOfType(n)?n.B:null};_mcp._TI.eG=function(n){return n.cs};_mcp._TI.fK=function(n){return n.bv()};_mcp._TI.fL=function(n){return n.ed()};_mcp._TI.fw=function(n){return _mcp.k.isInstanceOfType(n)?n.O:null};_mcp._TI.fu=function(n){return _mcp.k.isInstanceOfType(n)?n.M:null};_mcp._TI.t=function(n){return n.a()};_mcp._TI.fj=function(n){return n.d()};_mcp._TI.cG=function(n){return n.e()};_mcp._TI.fi=function(n){return n.b()};_mcp._TI.fE=function(n){return n.a};_mcp._TI.bJ=function(n){return n.o()};_mcp._TI.fF=function(n){return n.i};_mcp._TI.fG=function(n){return n.b};_mcp._TI.fH=function(n){return n.j};_mcp._TI.ew=function(n){return n.r()};_mcp._TI.ev=function(n){return n.d};_mcp._TI.eJ=function(n){return n.b()};_mcp._TI.et=function(n){return n.e};_mcp._TI.ex=function(n){return!OwaApplication.b};_mcp._TI.eu=function(n){return n.f};_mcp._TI.ey=function(n){return!OwaApplication.b};_mcp._TI.fD=function(n){return n.h};_mcp._TI.h=function(n,t){n.a(t)};_mcp._TI.f=function(n,t){n.ba(t)};_mcp._TI.l=function(n,t){n.i(t)};_mcp._TI.m=function(n,t){n.h(t)};_mcp._TI.j=function(n,t){n.bb(t)};_mcp._TI.bd=function(n,t){n.f(t)};_mcp._TI.be=function(n,t){n.j(t)};_mcp._TI.bc=function(n,t){n.e(t)};_mcp._TI.a=function(n,t){n.M(t)};_mcp._TI.cN=function(n,t){n.a(t)};_mcp._TI.cl=function(n,t){n.a(t)};_mcp._TI.i=function(n,t){n.be(t)};_mcp._TI.p=function(n,t){n.k(t)};_mcp._TI.ba=function(n,t){n.q(t)};_mcp._TI.S=function(n,t){n.c(t)};_mcp._TI.bu=function(n,t){n.d(t)};_mcp._TI.I=function(n,t){n.a(t)};_mcp._TI.dg=function(n,t){n.b(t)};_mcp._TI.o=function(n,t){n.k=t};_mcp._TI.U=function(n,t){n.m=t};_mcp._TI.bB=function(n,t){n.l=t};_mcp._TI.ck=function(n,t){n.e(t)};_mcp._TI.q=function(n,t){n.bb(t)};_mcp._TI.cA=function(n,t){n.K(t)};_mcp._TI.dl=function(n,t){n.c(t)};_mcp._TI.dk=function(n,t){n.a(t)};_mcp._TI.eY=function(n,t){n.p(t)};_mcp._TI.bU=function(n,t){n.gU(t)};_mcp._TI.du=function(n,t){n.jI(t)};_mcp._TI.cz=function(n,t){n.I(t)};_mcp._TI.dr=function(n,t){n.ct(t)};_mcp._TI.cy=function(n,t){n.o(t)};_mcp._TI.dt=function(n,t){n.hw(t)};_mcp._TI.cC=function(n,t){n.a(t)};_mcp._TI.dq=function(n,t){n.bm(t)};_mcp._TI.ds=function(n,t){n.cc=t};_mcp._TI.dw=function(n,t){n.bZ(t)};_mcp._TI.dv=function(n,t){n.cE=t};_mcp._TI.fW=function(n,t){n.cg(t)};_mcp._TI.eh=function(n,t){n.a(t)};_mcp._TI.bM=function(n,t){n.j(t)};_mcp._TI.bL=function(n,t){n.d(t)};_mcp._TI.fh=function(n,t){n.g(t)};_mcp._TI.x=function(n,t){n.a(t)};_mcp._TI.bo=function(n,t){n.g(t)};_mcp._TI.bw=function(n,t){n.k(t)};_mcp._TI.bx=function(n,t){n.h(t)};_mcp._TI.bT=function(n,t){n.m(t)};_mcp._TI.bv=function(n,t){n.j(t)};_mcp._TI.cn=function(n,t){n.r(t)};_mcp._TI.di=function(n,t){n.dl(t)};_mcp._TI.fU=function(n,t){n.a(t)};_mcp._TI.fV=function(n,t){n.H(t)};_mcp._TI.B=function(n,t){n.bC(t)};_mcp._TI.ga=function(n,t){n.k(t)};_mcp._TI.Z=function(n,t){n.dG(t)};_mcp._TI.eP=function(n,t){n.b(t)};_mcp._TI.eO=function(n,t){n.n(t)};_mcp._TI.el=function(n,t){n.a(t)};_mcp._TI.eR=function(n,t){n.e(t)};_mcp._TI.eN=function(n,t){n.d(t)};_mcp._TI.bj=function(n,t){n.a=t};_mcp._TI.ef=function(n,t){n.C(t)};_mcp._TI.fS=function(n,t){n.dI(t)};_mcp._TI.fR=function(n,t){n.dH(t)};_mcp._TI.dI=function(n,t){n.h(t)};_mcp._TI.fs=function(n,t){n.q(t)};_mcp._TI.ed=function(n,t){n.bq(t)};_mcp._TI.dM=function(n,t){n.g(t)};_mcp._TI.dL=function(n,t){n.f(t)};_mcp._TI.de=function(n,t){n.t(t)};_mcp._TI.df=function(n,t){n.p(t)};_mcp._TI.fY=function(n,t){n.i=t};_mcp._TI.fX=function(n,t){n.o=t};_mcp._TI.fZ=function(n,t){n.s(t)};_mcp._TI.fI=function(n,t){n.p(t)};_mcp._TI.bK=function(n,t){n.m(t)};_mcp._TI.fJ=function(n,t){n.q(t)};_mcp._TI.eK=function(n,t){n.c(t)};_mcp._TI.eB=function(n,t){n.o(t)};_mcp._TI.eL=function(n,t){n.e(t)};_mcp._TI.ez=function(n,t){n.m(t)};_mcp._TI.eA=function(n,t){n.n(t)};_mcp._TI.u=function(){_mcp._TI.cf||(_mcp._TI.cf=new _fc.m);return _mcp._TI.cf};_mcp._TI.c=function(){_mcp._TI.cc||(_mcp._TI.cc=new _fc.k);return _mcp._TI.cc};_mcp._TI.ch=function(){_mcp._TI.bW||(_mcp._TI.bW=new _cc.bd);return _mcp._TI.bW};_mcp._TI.cg=function(){_mcp._TI.bV||(_mcp._TI.bV=new _cc.bi);return _mcp._TI.bV};_mcp._TI.cj=function(){_mcp._TI.bZ||(_mcp._TI.bZ=new _n.r);return _mcp._TI.bZ};_mcp._TI.ci=function(){_mcp._TI.bX||(_mcp._TI.bX=new _b.co);return _mcp._TI.bX};_mcp._TI.eS=function(){_mcp._TI.bY||(_mcp._TI.bY=new _n.U);return _mcp._TI.bY};_mcp._TI.dy=function(){_mcp._TI.cd||(_mcp._TI.cd=new _fce.t);return _mcp._TI.cd};_mcp._TI.dx=function(){_mcp._TI.ca||(_mcp._TI.ca=new _n.v);return _mcp._TI.ca};_mcp._TI.eT=function(){_mcp._TI.ce||(_mcp._TI.ce=new _fce.D);return _mcp._TI.ce};_mcp._TI.eg=function(){_mcp._TI.cb||(_mcp._TI.cb=new _mcp.Z);return _mcp._TI.cb};MailComposeComponent.registerClass("MailComposeComponent",null,_a.iM);_mcp.E.registerClass("_mcp.E");_mcp.P.registerClass("_mcp.P",_js.x,IMailComposeComponent,_js.y);_mcp.l.registerClass("_mcp.l",_mcp.P,IMailComposeAttachmentComponent,IMailComposeComponent,_js.y,_y.go,IMailComposeOverridable);_mcp.z.registerClass("_mcp.z",_mcp.P,IMailComposeSaveComponent,IMailComposeOverridable);_mcp.ba.registerClass("_mcp.ba",_mcp.z,IMailComposeAutoSaveComponent,IMailComposeComponent,_js.y);_mcp.r.registerClass("_mcp.r",_mcp.P);_mcp.s.registerClass("_mcp.s",_mcp.P,IMailComposeComplianceComponent,IMailComposeComponent,_js.y);_mcp.bc.registerClass("_mcp.bc");_mcp.bd.registerClass("_mcp.bd",_mcp.P,IMailComposeContentConversionComponent,IMailComposeComponent,_js.y);_mcp.v.registerClass("_mcp.v",_mcp.P);_mcp.w.registerClass("_mcp.w",_mcp.P);_mcp.x.registerClass("_mcp.x",_mcp.P,IMailComposeDiscardComponent,IMailComposeComponent,_js.y);_mcp.be.registerClass("_mcp.be",_mcp.P,IMailComposeEditorComponent,IMailComposeComponent,_js.y);_mcp.bf.registerClass("_mcp.bf",_mcp.be);_mcp.H.registerClass("_mcp.H",_mcp.P,IMailComposeImportanceComponent,IMailComposeComponent,_js.y);_mcp.bh.registerClass("_mcp.bh",_mcp.P,IMailComposeLinkPreviewComponent,IMailComposeComponent,_js.y);_mcp.G.registerClass("_mcp.G",_mcp.P,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_js.y);_mcp.I.registerClass("_mcp.I",_mcp.P);_mcp.e.registerClass("_mcp.e",_mcp.P);_mcp.bj.registerClass("_mcp.bj",_mcp.P,IMailComposeMessageOptionsComponent,IMailComposeComponent,_js.y);_mcp.k.registerClass("_mcp.k",_mcp.P,IMailComposeNavigationComponent);_mcp.bk.registerClass("_mcp.bk",_mcp.P,IMailComposeOmeComponent,IMailComposeComponent,_js.y);_mcp.bl.registerClass("_mcp.bl",_mcp.P,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_js.y);_mcp.bm.registerClass("_mcp.bm",_mcp.P,IMailComposePhotoComponent,IMailComposeComponent,_js.y);_mcp.t.registerClass("_mcp.t",_mcp.P,_y.hH);_mcp.u.registerClass("_mcp.u",_js.x);_mcp.q.registerClass("_mcp.q",_mcp.P);_mcp.o.registerClass("_mcp.o",_mcp.P,IMailComposeSendComponent,IMailComposeOverridable);_mcp.bp.registerClass("_mcp.bp",_mcp.P);_mcp.bo.registerClass("_mcp.bo",_mcp.P,IMailComposeShareAttachmentComponent,IMailComposeComponent,_js.y);_mcp.p.registerClass("_mcp.p",_mcp.P,IMailComposeSignatureComponent,IMailComposeComponent,_js.y);_mcp.S.registerClass("_mcp.S",_mcp.P,IMailComposeTouchComponent,IMailComposeComponent,_js.y);_mcp.br.registerClass("_mcp.br",_mcp.P);_mcp.bi.registerClass("_mcp.bi",_mcp.P,IMailComposeMailTipsComponent,IMailComposeComponent,_js.y);_mcp.bn.registerClass("_mcp.bn",_mcp.P,IMailComposePolicyTipsComponent,IMailComposeComponent,_js.y);_mcp.bg.registerClass("_mcp.bg",_mcp.P,_y.gP,_y.gO,_y.gM);_mcp.B.registerClass("_mcp.B",null,IMailComposeActionFactory);_mcp.M.registerClass("_mcp.M",_mcp.B,IGroupInlineComposeActionFactory,IMailComposeActionFactory);_mcp.Q.registerClass("_mcp.Q",null,IMailComposeContextFactory);_mcp.T.registerClass("_mcp.T",null,IMailComposeViewModelFactory,_bc.bd);_mcp.U.registerClass("_mcp.U",_mcp.T,IMailInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.bd);_mcp.N.registerClass("_mcp.N",_mcp.T,IGroupInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.bd);_mcp.O.registerClass("_mcp.O",_a.bz);_mcp.F.registerClass("_mcp.F",_js.x,_y.hd);_mcp.a.registerClass("_mcp.a",_a.jX,_g.Ua,_y.eU,_bc.bM,IContext,_js.y);_mcp.y.registerClass("_mcp.y",null,IMailComposeDiscardManager);_mcp.b.registerClass("_mcp.b",_a.dY);_mcp.d.registerClass("_mcp.d",_y.hE,_y.m,_y.B,_bc.t,_a.jJ,_js.y,Sys.IDisposable,_y.dn,_y.cB,_bc.i,_bc.q,_y.F,IMailComposeOverridable);_mcp.h.registerClass("_mcp.h",_mcp.d);_mcp.f.registerClass("_mcp.f",_mcp.d,IGroupInlineComposeViewModel,_y.m,_y.B,_bc.t,_a.jJ,_js.y,Sys.IDisposable,_y.dn,_y.cB,_bc.i,_bc.q);_mcp.g.registerClass("_mcp.g");_mcp.V.registerClass("_mcp.V",_a.bz,_y.hf);_mcp.W.registerClass("_mcp.W",null,IMailResponseViewModelFactory);_mcp.C.registerClass("_mcp.C",_a.bz);_mcp.J.registerClass("_mcp.J");_mcp.bu.registerClass("_mcp.bu");_mcp.A.registerClass("_mcp.A",_h.dj.$$(_g.tM,_g.ks));_mcp.Z.registerClass("_mcp.Z",null,_js.S);_mcp.n.registerClass("_mcp.n",_js.c,_b.ck);_mcp.i.registerClass("_mcp.i",_js.b);_mcp.m.registerClass("_mcp.m",_js.b,_ff.n);_mcp.K.registerClass("_mcp.K",_js.b);_mcp.j.registerClass("_mcp.j",_mcp.m);_mcp._TI.registerClass("_mcp._TI");MailComposeComponent.$$cctor();_mcp.l.a=new _H("AttachmentWellViewModel",_y.w,_mcp.l);_mcp.l.b=new _H("Menu",_fm.f,_mcp.P);_mcp.r.a=_a.a.es;_mcp.s.a=new _y.g(_u.P.j,null,null);_mcp.v.a=new _H("Menu",_fm.f,_mcp.v);_mcp.w.a=new _H("Menu",_fm.f,_mcp.w);_mcp.G.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.e.c=new _H("FromDetailsViewModel",_pe.d,_mcp.e);_mcp.e.d=new _H("SenderDetailsViewModel",_pe.d,_mcp.e);_mcp.e.b=null;_mcp.e.a=null;_mcp.e.h=new _H("RecurrencePatternDataObject",_cc.bk,_mcp.e);_mcp.k.b=[84,85,86,87];_mcp.u.a=7;_mcp.u.b=1;_mcp.z.a=[60,40,43,1001,700,50,800,88,89];_mcp.q.a=new _H("Menu",_fm.f,_mcp.q);_mcp.o.a=10;_mcp.o.b=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_mcp.p.c="<P><BR></P>";_mcp.p.b=new RegExp("[\n\r]+","g");_mcp.a.bM=new _H("ViewModelId",String,_mcp.a);_mcp.a.b=new _H("Operation",_y.M,_mcp.a);_mcp.a.j=new _H("Mode",_y.dw,_mcp.a);_mcp.a.bm=new _H("OriginalId",_g.g,_mcp.a);_mcp.a.bl=new _H("OriginalDocumentId",Number,_mcp.a);_mcp.a.bn=new _H("OriginalItem",_g.h,_mcp.a);_mcp.a.E=new _H("DraftId",_g.g,_mcp.a);_mcp.a.bG=new _H("StoreId",String,_mcp.a);_mcp.a.bH=new _H("Subject",String,_mcp.a,"");_mcp.a.bw=new _H("SelectedDataCallContext",_h.du,_mcp.a);_mcp.a.G=new _H("EditorCallContext",_h.du,_mcp.a);_mcp.a.H=new _H("EditorContent",String,_mcp.a,"");_mcp.a.s=new _H("BodyType",String,_mcp.a);_mcp.a.n=new _H("ToRecipients",_js.v,_mcp.a);_mcp.a.m=new _H("SpeechResultRecipients",_js.v,_mcp.a);_mcp.a.bI=new _H("ToQueryString",String,_mcp.a);_mcp.a.f=new _H("CcRecipients",_js.v,_mcp.a);_mcp.a.t=new _H("CcQueryString",String,_mcp.a);_mcp.a.e=new _H("BccRecipients",_js.v,_mcp.a);_mcp.a.r=new _H("BccQueryString",String,_mcp.a);_mcp.a.l=new _H("AutoAddSignature",Boolean,_mcp.a,!0);_mcp.a.Q=new _H("Importance",String,_mcp.a,"Normal");_mcp.a.bu=new _H("QuotedBody",String,_mcp.a);_mcp.a.bA=new _H("SmimeContent",String,_mcp.a);_mcp.a.bC=new _H("SmimeErrorCode",Number,_mcp.a);_mcp.a.bD=new _H("SmimeRecipientCerts",Array,_mcp.a);_mcp.a.bE=new _H("SmimeSigningCert",String,_mcp.a);_mcp.a.o=new _H("AttachmentsToAdd",Array,_mcp.a);_mcp.a.U=new _H("IsComplete",Boolean,_mcp.a);_mcp.a.h=new _H("IsMeeting",Boolean,_mcp.a);_mcp.a.Y=new _H("IsMeetingForward",Boolean,_mcp.a);_mcp.a.bf=new _H("IsReplyAllOnBcc",Boolean,_mcp.a);_mcp.a.bj=new _H("Location",_g.y,_mcp.a);_mcp.a.M=new _H("HasLocation",Boolean,_mcp.a);_mcp.a.i=null;_mcp.a.k=null;_mcp.a.J=new _H("From",_g.bh,_mcp.a);_mcp.a.bx=new _H("Sender",_g.bh,_mcp.a);_mcp.a.bi=new _H("IsUpgraded",Boolean,_mcp.a);_mcp.a.W=new _H("IsFromShown",Boolean,_mcp.a);_mcp.a.S=new _H("IsBccShown",Boolean,_mcp.a);_mcp.a.bq=new _H("ParentFolderNameToPost",String,_mcp.a);_mcp.a.bp=new _H("ParentFolderIdToPost",_g.m,_mcp.a);_mcp.a.d=new _H("AttachmentCollection",_js.f,_mcp.a);_mcp.a.p=new _H("AttachmentsToHide",Array,_mcp.a);_mcp.a.bL=new _H("UpgradeFailed",Boolean,_mcp.a);_mcp.a.q=new _H("Baseline",_mcp.b,_mcp.a);_mcp.a.L=new _H("HasBeenSavedByUser",Boolean,_mcp.a);_mcp.a.bJ=new _H("UnpromotedEmojiCountProperty",Number,_mcp.a);_mcp.a.bK=new _H("UnpromotedInlineImageCountProperty",Number,_mcp.a);_mcp.a.bg=new _H("IsReplyForward",Boolean,_mcp.a);_mcp.a.F=new _H("Draft",_g.h,_mcp.a);_mcp.a.K=new _H("GroupEmailAddress",_g.d,_mcp.a);_mcp.a.bv=new _H("RightsManagementLicenseData",_g.dI,_mcp.a);_mcp.a.y=new _H("ComplianceId",String,_mcp.a);_mcp.a.T=new _H("IsClassified",Boolean,_mcp.a);_mcp.a.v=new _H("ClassificationGuid",String,_mcp.a);_mcp.a.x=new _H("Classification",String,_mcp.a);_mcp.a.u=new _H("ClassificationDescription",String,_mcp.a);_mcp.a.w=new _H("ClassificationKeep",Boolean,_mcp.a);_mcp.a.bz=new _H("Sensitivity",String,_mcp.a,"Normal");_mcp.a.V=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.a);_mcp.a.be=new _H("IsReadReceiptRequested",Boolean,_mcp.a);_mcp.a.bB=new _H("SmimeEncryptMessage",Boolean,_mcp.a);_mcp.a.bF=new _H("SmimeSignMessage",Boolean,_mcp.a);_mcp.a.z=new _H("ConversationId",_g.g,_mcp.a);_mcp.a.bo=new _H("ParentConversationNodeId",String,_mcp.a);_mcp.a.bc=new _H("IsOriginalIdCalendarItemId",Boolean,_mcp.a);_mcp.a.ba=new _H("IsOccurrenceReferencingMaster",Boolean,_mcp.a);_mcp.a.bd=new _H("IsPoppedOutFromReadingPane",Boolean,_mcp.a);_mcp.a.X=new _H("IsLoadedDraft",Boolean,_mcp.a);_mcp.a.bN=new _H("WasCleanNewMessageBeforePopout",Boolean,_mcp.a);_mcp.a.O=new _H("HideIncludeEntrypoint",Boolean,_mcp.a,!1);_mcp.a.bO=new _H("WasSavingBeforePopout",Boolean,_mcp.a,!1);_mcp.a.Z=new _H("IsMovedToDraftFromOutbox",Boolean,_mcp.a,!1);_mcp.a.bs=new _H("PerfContext",_a.bM,_mcp.a,null);_mcp.a.br=new _H("PerfContextE2E",_a.bM,_mcp.a,null);_mcp.a.bP=new _H("WaterfallTraceStarted",Boolean,_mcp.a,null);_mcp.a.bV=new _H("RichTextEditorSupported",Boolean,_mcp.a,null);_mcp.a.P=new _H("HtmlSupportedProperty",Boolean,_mcp.a,null);_mcp.a.D=new _H("DlpSenderOverride",String,_mcp.a,null);_mcp.a.C=new _H("DlpFalsePositive",String,_mcp.a,null);_mcp.a.B=new _H("DlpDetectedClassification",String,_mcp.a,null);_mcp.a.I=new _H("ExplicitLogonUser",String,_mcp.a,null);_mcp.a.R=new _H("IncludeOriginalFromInToRecipients",Boolean,_mcp.a,!1);_mcp.a.g=new _H("ExtendedPropertyCollection",_js.f,_mcp.a,null);_mcp.a.bb=new _H("IsOnDemandUpgradeRequested",Boolean,_mcp.a,!1);_mcp.a.bh=new _H("IsResumingSendFailure",Boolean,_mcp.a,!1);_mcp.a.N=new _H("HasSentViaNotification",Boolean,_mcp.a,!1);_mcp.a.by=new _H("SendFailureInfobarMessageId",_bc.InfoBarMessageId,_mcp.a,45);_mcp.a.bt=new _H("PopoutPerfContext",_a.bM,_mcp.a);_mcp.a.A=new _H("DiagnosticContent",String,_mcp.a);_mcp.a.c="UseOverride";_mcp.a.bU=new RegExp("(\r)?\n","gi");_mcp.a.a=null;_mcp.a.$$cctor();_mcp.b.u=new _H("Subject",String,_mcp.b,"");_mcp.b.m=new _H("EditorContent",String,_mcp.b,"");_mcp.b.h=new _H("ToRecipients",_js.f,_mcp.b);_mcp.b.v=new _H("ToQueryString",String,_mcp.b);_mcp.b.e=new _H("CcRecipients",_js.f,_mcp.b);_mcp.b.k=new _H("CcQueryString",String,_mcp.b);_mcp.b.d=new _H("BccRecipients",_js.f,_mcp.b);_mcp.b.j=new _H("BccQueryString",String,_mcp.b);_mcp.b.o=new _H("Importance",String,_mcp.b,"Normal");_mcp.b.n=new _H("From",_g.d,_mcp.b);_mcp.b.l=new _H("ComplianceId",String,_mcp.b);_mcp.b.r=new _H("Sensitivity",String,_mcp.b,"Normal");_mcp.b.p=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.q=new _H("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.s=new _H("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.t=new _H("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.c=new _H("AttachmentCollection",_js.f,_mcp.b);_mcp.b.g=new _H("ExtendedPropertyCollection",_js.f,_mcp.b,null);_mcp.b.f=new _a.bv(_g.d);_mcp.b.$$cctor();_mcp.g.a=_a.a.a;_mcp.V.a=_a.a.a;_mcp._TI._hf=_mcp._TI.eU();_mcp._TI.cf=null;_mcp._TI.cc=null;_mcp._TI.bW=null;_mcp._TI.bV=null;_mcp._TI.bZ=null;_mcp._TI.bX=null;_mcp._TI.bY=null;_mcp._TI.cd=null;_mcp._TI.ca=null;_mcp._TI.ce=null;_mcp._TI.cb=null;_mcp._TI.b={};_mcp._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
