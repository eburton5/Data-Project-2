try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.shellplusg2.o365.js'] = (new Date()).getTime();
Type.registerNamespace("_sp2");_sp2.m=function(n,t,i,r,u,f,e){this.g=Function.createDelegate(this,this.A);this.i=Function.createDelegate(this,this.y);this.p=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.r=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.x);this.j=f;this.h=u;this.f=e;_o365sg2p.a.b=this.j;this.b=new _o365sg2p.bg;this.b.O(new _o365sg2p.T);if(this.b.l){var a=this;this.b.l.bo(function(n,i,r){t.a(_mgn.g,new _mgn.g(n,i,r))})}t.b(ISendFailedO365Event,this.q);t.b(ISendFailureRemoveO365Event,this.r);t.b(_y.eN,this.n);t.b(_y.eO,this.o);t.b(_y.bX,this.p);this.m=i;var c=this;n.a(function(n){c.t(n.a())});this.s(r);if(!this.h){var o=this.b.k;var s=this.b.r;var h=this.b.g;if(o){var l=_a.im.a(window.location.href);o.J=l;o.bq(this.f("email_notify.mp3"))}s&&s.H(this.f("calendar_notify.mp3"));h&&h.bk(this.f("calendar_notify.mp3"))}};_sp2.m.prototype={m:null,b:null,d:null,c:null,l:!1,j:null,h:!1,f:null,a:function(){return this.b},e:function(){if(!this.d){this.d=new _o365sa.SAl;this.d.Title=_u.R.SW;this.d.IsLocal=!0}return this.d},k:function(){if(!this.c){this.c=new _o365sa.SAl;this.c.Title=_u.R.YT;this.c.ActionText=_u.R.HU;this.c.IsLocal=!0}return this.c},t:function(n){this.b.j(new _o365sg2p.I(new _sp2.t(n)));var t=this.b.s;!this.h&&t&&t.K(this.f("im_notify.mp3"))},x:function(n){if(n.c()){if(n.d()){this.e().ActionText=n.b();this.e().ActionCallback=n.a();this.b.g.r(this.e());this.b.g.a.d(this.i)}else{this.k().ActionCallback=n.a();this.b.g.r(this.k())}this.b.g.apcl("ShowPopup",this.g);this.b.g.y().c(!1)}},z:function(n){this.b.g.rpcl("ShowPopup",this.g);this.b.g.y().c(!0);if(n.a()){this.l=!0;this.b.g.a.e(this.i);this.b.g.a.m(this.e(),!0)}else this.b.g.a.m(this.k(),!0);this.b.g.d(!1)},u:function(n){var t=new _o365sa.SAl;t.Title=n.d()?_u.R.Rf:_u.R.Hd;t.IsLocal=!0;t.ActionText=n.b();t.ActionCallback=n.a();this.b.g.r(t);if(n.c()){this.b.g.apcl("ShowPopup",this.g);this.b.g.y().c(!1)}},v:function(n){this.b.g.rpcl("ShowPopup",this.g);this.b.g.y().c(!0);this.b.g.d(!1)},w:function(n){this.s(n.a)},s:function(n){n&&this.b.Z(!n.a&&!n.d)},y:function(n,t){if(!$a(t.b))for(var r=0;r<t.b.length;r++)if(t.b[r]===this.e()){var i=this;this.m.a(_a.a.h,"Process send failure alert",function(){i.l||i.b.g.r(i.e())},0)}},A:function(n,t){var i=n;i.g()||i.d(!0)}};_sp2.t=function(n){this.g=Function.createDelegate(this,this.i);this.h=Function.createDelegate(this,this.j);this.f=n;this.d=new _js.f;this.e=new _js.f;this.f.l().d(this.h);this.f.k().d(this.g)};_sp2.t.prototype={f:null,d:null,e:null,b:function(){return this.d},a:function(n,t){this.f.i(n.f)},c:function(n){this.f.p(n.f)},j:function(n,t){if(t.c===2||t.c===3)for(var u=0;u<t.b.length;u++)for(var r=0;r<this.d.w.length;r++){var e=t.b[u];var f=this.d.w[r];e===f.f&&this.d.m(f,!0)}if(!t.c||t.c===3)for(var i=0;i<t.a.length;i++)this.d.a(new _sp2.s(t.a[i]))},i:function(n,t){if(t.c===2||t.c===3)for(var u=0;u<t.b.length;u++)for(var r=0;r<this.e.w.length;r++){var e=t.b[u];var f=this.e.w[r];e===f.e&&this.e.m(f,!0)}if(!t.c||t.c===3)for(var i=0;i<t.a.length;i++)this.e.a(new _sp2.n(t.a[i]))}};_sp2.s=function(n){this.f=n};_sp2.s.prototype={f:null,d:function(){return this.f.q},e:function(){return new _sp2.n(this.f.j)},a:function(){try{return Microsoft.O365.SuiteApi.SkypeIntegration.c.d(this.f.B)}catch(n){return"Unknown"}},b:function(){return this.f.v},c:function(){return this.f.z}};_sp2.n=function(n){this.e=n};_sp2.n.prototype={e:null,b:function(){return this.e.d()},c:function(){return this.e.dj},a:function(){return this.e.cL()},d:function(){return this.e.dh()}};function O365ShellPlusG2Component(){}O365ShellPlusG2Component.$$cctor=function(){_a.p.a().a(O365ShellPlusG2Component)};O365ShellPlusG2Component.prototype={a:function(n,t,i){_o365sa.a.g(n);if(i.a()==="Mouse"){var p=this;n.b(_sp2.m,function(){var t=n.a(_y.a);return new _sp2.m(n.d(IChatManagerFactory),n.a(_ff.c),n.a(_js.k),n.a(_y.r).a(),n.a(_g.bb).bl.IsBposUser,n.a(_o365sg2c.o),t.C||(t.C=Function.createDelegate(t,t.K)))}).b(IGlobalNotificationTrayViewModel).a();var w=this;n.b(IChangeThemeMenuItemClickHandler,function(){return new _sp2.u(n.a(IUserThemesHandler))});n.e(_sp2.B).b(IGlobalAppsManager).a();var r=i.f().a().D().Enabled;if(r){var v=this;n.b(_sp2.k,function(){return new _sp2.k(n.a(_a.dK),n.a(_ff.c))});var y=this;n.b(IUserThemesHandler,function(){return new _sp2.z(n.a(_ff.c),n.a(_a.q),n.a(_g.a),n.a(_sp2.k))}).a();var d=this;n.b(_sp2.a,function(){return new _sp2.a(_o365sg2p.u.a(),n.a(_o365sg2c.o),n.c(IUserThemesHandler),n.a(_a.cY),n.a(_ff.c),n.c(INFDContentProvider))}).b(IFlexPanePanelViewModel).a();var u=i.f().a().t().Enabled;if(u){var g=this;n.b(_sp2.p,function(){return new _sp2.p(n.a(_g.a),n.a(_y.a),_a.l.a,n.a(_sp2.b),n.a(_sp2.h),n.a(_sp2.i),n.a(_sp2.d),n.a(_sp2.g),n.a(_sp2.j),n.a(_sp2.f),n.a(_sp2.c),n.a(_sp2.e))}).b(INFDContentProvider).a();var b=this;n.b(_sp2.b,function(){return new _sp2.b(n.a(_a.bn))});var k=this;n.b(_sp2.h,function(){return new _sp2.h(n.a(_a.bn))});var f=this;n.b(_sp2.i,function(){return new _sp2.i(n.a(_a.h),_o365sg2p.u.a())});var o=this;n.b(_sp2.d,function(){return new _sp2.d(n.a(_y.cc).e())});var e=this;n.b(_sp2.g,function(){return new _sp2.g(n.a(_y.cc).f())});var s=this;n.b(_sp2.j,function(){return new _sp2.j(n.a(_y.cc).d())});var l=this;n.b(_sp2.f,function(){return new _sp2.f(n.a(_y.r))});var a=this;n.b(_sp2.c,function(){return new _sp2.c(n.a(_a.bn),n.d(IOptionsPathGenerator))});var h=this;n.b(_sp2.e,function(){return new _sp2.e(n.a(_g.bb).bl.UserVoiceUrl)})}}}else{var c=this;n.b(IGlobalMiniaturesPlusViewModel,function(){return new _sp2.C(n.c(ICalendarMiniatureNextAppointmentManager),i.a(),t.a(),n.a(_a.h),n.c(IModernGroupsNavigationFactory),n.a(IGlobalMiniaturesViewModel),n.a(_o365sg2c.o))}).a()}},b:function(){return null}};_sp2.z=function(n,t,i,r){this.e=t;this.h=n;this.g=i;this.f=r};_sp2.z.prototype={h:null,e:null,g:null,f:null,b:null,c:null,d:null,OverrideGetUserThemeId:function(){return!0},OverrideChangeTheme:function(){return!0},OverrideLoadUserThemesData:function(){return!0},OverrideSaveTheme:function(){return!0},GetUserThemeId:function(n){var t=this.i();n(t)},ChangeTheme:function(n){var t=n.Id;var r=[];var i=[];if(this.d){r=this.d[t].ColorNames;i=this.d[t].ColorValues}this.f.j(t,r,i)},SaveTheme:function(n,t,i){this.c=_a.d.b(_a.a.h,"SaveTheme");var r=new _c.Y(n);if(r){var f=this;r.v(function(n){if(f.c){var i=new _a.u;i.b("T",r.a);f.c.l=r.C();f.c.j=i.toString();_a.d.a(f.c);f.c=null}t()});var u=this;r.u(function(n){if(u.c){u.c.k=r.s?r.s.toString():"unknown";u.c.l=r.C();_a.d.a(u.c);u.c=null}i(n.s)});this.e.a(r)}else{if(this.c){_a.d.a(this.c);this.c=null}t()}},LoadUserThemesData:function(n,t){this.b=_a.d.b(_a.a.h,"LoadUserThemesData");var f=[];var r=new _c.U;var i=this;r.v(function(u){var y=r.a;var l=y.Themes;var p=y.ThemePath;if(!l){var v="No loaded themes return from OWA";if(i.b){i.b.k=v;i.b.l=r.C();_a.d.a(i.b);i.b=null}t(Error.create(v))}i.d={};for(var c=0;c<l.length;c++){var s={};var e=l[c];var h=e.FolderName;s.Id=h;s.Name=i.f.h(e.DisplayName);s.ThumbnailUrl=String.format(p,h)+"images/0/themepreview.png";if(h&&h.toLowerCase()==="base"&&e.ColorNames){var a=Array.indexOf(e.ColorNames,"color-themePrimary");if(a>-1){var o=e.ColorValues[a];o.startsWith("#")&&(o=o.substring(1,o.length));s.ThemeColors=[o]}}i.d[h]=e;Array.add(f,s)}if(i.b){i.b.l=r.C();_a.d.a(i.b);i.b=null}n(f)});var u=this;r.u(function(n){if(u.b){u.b.k=n.s?n.s.toString():"unknown";u.b.l=r.C();_a.d.a(u.b);u.b=null}t(n.s)});this.e.a(r)},i:function(){var t=this.g.bl.PolicySettings.DefaultTheme;_js.d.b(t)&&(t="base");var n=this.g.a().bl.ThemeStorageId;_js.d.b(n)&&(n=t);return n}};_sp2.u=function(n){this.b=n};_sp2.u.prototype={b:null,a:function(){return!0}};_sp2.k=function(n,t){this.c=new RegExp("themes\\/\\w+\\/images");this.e=n;this.b=t};_sp2.k.prototype={a:null,e:null,b:null,h:function(n){var t=n;switch(n){case"__base__":t=_nbs.a.Rh;break;case"__black__":t=_nbs.a.gN;break;case"__blueprint__":t=_nbs.a.hR;break;case"__cats__":t=_nbs.a.Kf;break;case"__circuit__":t=_nbs.a.lU;break;case"__contrast__":t=_nbs.a.Of;break;case"__cordovan__":t=_nbs.a.GD;break;case"__cubism__":t=_nbs.a.L;break;case"__darkcordovan__":t=_nbs.a.G;break;case"__darkorange__":t=_nbs.a.EC;break;case"__lightblue__":t=_nbs.a.PZ;break;case"__lightgreen__":t=_nbs.a.Sy;break;case"__lite__":t=_nbs.a.US;break;case"__blueberry__":t=_nbs.a.Ry;break;case"__grape__":t=_nbs.a.Tv;break;case"__orange__":t=_nbs.a.bZ;break;case"__mediumdarkblue__":t=_nbs.a.Sf;break;case"__pink__":t=_nbs.a.mZ;break;case"__pomegranate__":t=_nbs.a.Mq;break;case"__raspberry__":t=_nbs.a.mE;break;case"__teal__":t=_nbs.a.VJ;break;case"__watermelon__":t=_nbs.a.Xm;break;case"__minimal__":t=_nbs.a.mM;break;case"__modern__":t=_nbs.a.Uc;break;case"__paint__":t=_nbs.a.kH;break;case"__primary__":t=_nbs.a.TJ;break;case"__super__":t=_nbs.a.UU;break;case"__teagarden__":t=_nbs.a.Wx;break;case"__whimsical__":t=_nbs.a.FY;break;case"__wntrld__":t=_nbs.a.hB;break;case"__wrld__":t=_nbs.a.kf;break;default:break}return t},j:function(n,t,i){this.k();_js.i.e(t,"colorNames");_js.i.e(i,"colorValues");var u=this.f(t,i);var f=this.d(".ms-bg-color-themeDark, .ms-bgc-td, .ms-bg-color-themeDark-hover:hover, .ms-bg-color-themeDark-before:before, .ms-bgc-td-h:hover, .ms-bgc-td-b:before { background-color: @color-themeDark; }.ms-bg-color-themeDarkAlt, .ms-bgc-tda, .ms-bg-color-themeDarkAlt-hover:hover, .ms-bg-color-themeDarkAlt-before:before, .ms-bgc-tda-h:hover, .ms-bgc-tda-b:before { background-color: @color-themeDarkAlt; }.ms-bg-color-themeDarker, .ms-bgc-tdr, .ms-bg-color-themeDarker-hover:hover, .ms-bg-color-themeDarker-before:before, .ms-bgc-tdr-h:hover, .ms-bgc-tdr-b:before { background-color: @color-themeDarker; }.ms-bg-color-themePrimary, .ms-bgc-tp, .ms-bg-color-themePrimary-hover:hover, .ms-bg-color-themePrimary-before:before, .ms-bgc-tp-h:hover, .ms-bgc-tp-b:before { background-color: @color-themePrimary; }.ms-bg-color-themeSecondary, .ms-bgc-ts, .ms-bg-color-themeSecondary-hover:hover, .ms-bg-color-themeSecondary-before:before, .ms-bgc-ts-h:hover, .ms-bgc-ts-b:before { background-color: @color-themeSecondary; }.ms-bg-color-themeTertiary, .ms-bgc-tt, .ms-bg-color-themeTertiary-hover:hover, .ms-bg-color-themeTertiary-before:before, .ms-bgc-tt-h:hover, .ms-bgc-tt-b:before { background-color: @color-themeTertiary; }.ms-bg-color-themeLight, .ms-bgc-tl, .ms-bg-color-themeLight-hover:hover, .ms-bg-color-themeLight-before:before, .ms-bgc-tl-h:hover, .ms-bgc-tl-b:before { background-color: @color-themeLight; }.ms-bg-color-themeLighter, .ms-bgc-tlr, .ms-bg-color-themeLighter-hover:hover, .ms-bg-color-themeLighter-before:before, .ms-bgc-tlr-h:hover, .ms-bgc-tlr-b:before { background-color: @color-themeLighter; }.ms-bg-color-themeLighterAlt, .ms-bgc-tlr, .ms-bg-color-themeLighterAlt-hover:hover, .ms-bg-color-themeLighterAlt-before:before, .ms-bgc-tla-h:hover, .ms-bgc-tla-b:before { background-color: @color-themeLighterAlt; }.ms-border-color-themeDark, .ms-bcl-td, .ms-border-color-themeDark-hover:hover, .ms-border-color-themeDark-before:before, .ms-bcl-td-h:hover, .ms-bcl-td-b:before { border-color: @color-themeDark; }.ms-border-color-themeDarkAlt, .ms-bcl-tda, .ms-border-color-themeDarkAlt-hover:hover, .ms-border-color-themeDarkAlt-before:before, .ms-bcl-tda-h:hover, .ms-bcl-tda-b:before { border-color: @color-themeDarkAlt; }.ms-border-color-themeDarker, .ms-bcl-tdr, .ms-border-color-themeDarker-hover:hover, .ms-border-color-themeDarker-before:before, .ms-bcl-tdr-h:hover, .ms-bcl-tdr-b:before { border-color: @color-themeDarker; }.ms-border-color-themePrimary, .ms-bcl-tp, .ms-border-color-themePrimary-hover:hover, .ms-border-color-themePrimary-before:before, .ms-bcl-tp-h:hover, .ms-bcl-tp-b:before { border-color: @color-themePrimary; }.ms-border-color-themeSecondary, .ms-bcl-ts, .ms-border-color-themeSecondary-hover:hover, .ms-border-color-themeSecondary-before:before, .ms-bcl-ts-h:hover, .ms-bcl-ts-b:before { border-color: @color-themeSecondary; }.ms-border-color-themeTertiary, .ms-bcl-tt, .ms-border-color-themeTertiary-hover:hover, .ms-border-color-themeTertiary-before:before, .ms-bcl-tt-h:hover, .ms-bcl-tt-b:before { border-color: @color-themeTertiary; }.ms-border-color-themeLight, .ms-bcl-tl, .ms-border-color-themeLight-hover:hover, .ms-border-color-themeLight-before:before, .ms-bcl-tl-h:hover, .ms-bcl-tl-b:before { border-color: @color-themeLight; }.ms-border-color-themeLighter, .ms-bcl-tlr, .ms-border-color-themeLighter-hover:hover, .ms-border-color-themeLighter-before:before, .ms-bcl-tlr-h:hover, .ms-bcl-tlr-b:before { border-color: @color-themeLighter; }.ms-border-color-themeLighterAlt, .ms-bcl-tla, .ms-border-color-themeLighterAlt-hover:hover, .ms-border-color-themeLighterAlt-before:before, .ms-bcl-tla-h:hover, .ms-bcl-tla-b:before { border-color: @color-themeLighterAlt; }.ms-border-color-top-themePrimary, .ms-bcl-t-tp, .ms-border-color-top-themePrimary-hover:hover, .ms-border-color-top-themePrimary-before:before, .ms-bcl-t-tp-h:hover, .ms-bcl-t-tp-b:before { border-top-color: @color-themePrimary; }.ms-font-color-themeDark, .ms-fcl-td, .ms-font-color-themeDark-hover:hover, .ms-font-color-themeDark-before:before, .ms-fcl-td-h:hover, .ms-fcl-td-b:before { color: @color-themeDark; }.ms-font-color-themeDarkAlt, .ms-fcl-ta, .ms-font-color-themeDarkAlt-hover:hover, .ms-font-color-themeDarkAlt-before:before, .ms-fcl-ta-h:hover, .ms-fcl-tda-b:before { color: @color-themeDarkAlt; }.ms-font-color-themeDarker, .ms-fcl-tdr, .ms-font-color-themeDarker-hover:hover, .ms-font-color-themeDarker-before:before, .ms-fcl-tdr-h:hover, .ms-fcl-tdr-b:before { color: @color-themeDarker; }.ms-font-color-themePrimary, .ms-fcl-tp, .ms-font-color-themePrimary-hover:hover, .ms-font-color-themePrimary-before:before, .ms-fcl-tp-h:hover, .ms-fcl-tp-b:before { color: @color-themePrimary; }.ms-font-color-themeSecondary, .ms-fcl-ts, .ms-font-color-themeSecondary-hover:hover, .ms-font-color-themeSecondary-before:before, .ms-fcl-ts-h:hover, .ms-fcl-ts-b:before { color: @color-themeSecondary; }.ms-font-color-themeTertiary, .ms-fcl-tt, .ms-font-color-themeTertiary-hover:hover, .ms-font-color-themeTertiary-before:before, .ms-fcl-tt-h:hover, .ms-fcl-tt-b:before { color: @color-themeTertiary; }.ms-font-color-themeLight, .ms-fcl-tl, .ms-font-color-themeLight-hover:hover, .ms-font-color-themeLight-before:before, .ms-fcl-tl-h:hover, .ms-fcl-tl-b:before { color: @color-themeLight; }.ms-font-color-themeLighter, .ms-fcl-tlr, .ms-font-color-themeLighter-hover:hover, .ms-font-color-themeLighter-before:before, .ms-fcl-tlr-h:hover, .ms-fcl-tlr-b:before { color: @color-themeLighter; }.ms-font-color-themeLighterAlt, .ms-fcl-tla, .ms-font-color-themeLighterAlt-hover:hover, .ms-font-color-themeLighterAlt-before:before, .ms-fcl-tla-h:hover, .ms-fcl-tla-b:before { color: @color-themeLighterAlt; }",u);var o=this.d(".o365cs-base.o365cst .o365cs-topnavLinkBackground-2{background-color:@topnavLinkBG;background-color:@topnavLinkBGrgb;}.o365cs-base.o365cst .o365cs-topnavText,.o365cs-base.o365cst .o365cs-topnavText:hover{color:@topnavText;}.o365cs-base.o365cst .o365cs-navMenuButton{color:@navmenu;}.o365cs-base.o365cst.o365cs-topnavBGColor-2{background-color:@topnavBG;}",u);var e=window.self.document.getElementsByTagName("head")[0];var r=window.document.createElement("style");r.id=String.format("previewTheme{0}_{1}",n,"ThemeColorStyle");r.innerHTML=f+o;e.appendChild(r);this.a=n;this.i(n)},k:function(){_js.d.a(this.a)||this.g(this.a,"ThemeColorStyle").remove()},g:function(n,t){var i=String.format("previewTheme{0}_{1}",n,t);return $("#"+i)},i:function(n){var i=$get("O365_NavHeader");i&&(i.style.backgroundImage="none");this.b.a(_a.cT,new _a.cT(n));if(!_js.d.b(n)&&n!=="base"){var r=$get("HeaderImages");if(r){var t=r.innerHTML;var f=t.substring(t.indexOf("(")+1,t.indexOf(")"));var u=f.replace(this.c,String.format("themes/{0}/images",n));i.style.backgroundImage=String.format("url({0})",u)}}},f:function(n,t){for(var r={},i=0;i<n.length;i++)r["@"+n[i]]=t[i];return r},d:function(n,t){for(var s=new RegExp("@([^;}\\/\\\\]+)","g"),o=new RegExp("(^(#)?[0-9A-F]{6}$)|(^(#)?[0-9A-F]{3}$)","i"),f,u=n.match(s),r=0;r<u.length;r++){var e=t[u[r]];if(e){var i=e.toString();f=o.test(i)?i.startsWith("#")?i:"#"+i:"transparent";n=n.replace(u[r],f)}}return n}};_sp2.a=function(n,t,i,r,u,f){this.n=Function.createDelegate(this,this.t);_sp2.a.initializeBase(this);this.e=n;this.h=t;this.m=i;this.i=r;this.g=u;this.l=f};_sp2.a.prototype={e:null,k:!1,f:null,h:null,m:null,i:null,g:null,l:null,j:null,c:function(){return this.k},u:function(n){if(this.k!==n){this.k=n;this.dQ("ShowFlexPane")}return n},t:function(n){this.u(n)},p:function(){return this.i.a().t()?this.i.a().t().Enabled:!1},a:function(n){_a.b.b(n,"sharedHeaderViewModel");_a.b.d(_o365sg2c.n.isInstanceOfType(n),"sharedHeaderViewModel type not match.");this.f=n;this.e.K(this.f);if(this.f.w()){var i=new _o365sg2p.T;this.f.a.P(i);var r=this;this.e.i.p=function(n,t,i){r.g.a(_mgn.g,new _mgn.g(n,t,i))};var t=this;this.e.i.d=function(){t.g.a(_y.s,new _y.s(2,function(){t.g.a(_y.cf,new _y.cf)},!0,!0,!0,!1,!0))};this.e.i.P(!1,i)}this.p()&&this.q();this.e.T(!1);this.e.w(!0);this.e.H(this.n)},q:function(){if(this.e.j){var n=this;this.l.a(function(t){n.e.j.U(t.a())})}},b:function(){if(this.j)this.e.k("ThemePanelViewTemplateID");else{var n=this;this.m.a(function(t){n.j=t;n.r(n.j);n.e.k("ThemePanelViewTemplateID")})}},d:function(){this.e.k("NFD")},o:function(){this.e.o("ThemePanelViewTemplateID")},r:function(n){var i=this;var t=function(){i.o()};this.f.G(n);this.e.E(new _o365sg2p.U(this.f,n,this.h,new _o365sg2p.bI(this.h),t));if(this.f.a.h){this.e.c.h=this.f.a.h;this.e.c.h.C(!1)}this.e.b.ThemePanelViewTemplateID=this.e.c}};_sp2.B=function(){this.b=new _o365sg2p.bZ};_sp2.B.prototype={b:null,a:function(n){_a.b.b(n,"sharedHeaderViewModel");_a.b.d(_o365sg2c.n.isInstanceOfType(n),"sharedHeaderViewModel type not match.");this.b.M(n)}};_sp2.A=function(n){this.c=n;this.a=new _js.f};_sp2.A.prototype={c:null,a:null,b:null,BegineGetNextAppointments:function(n,t,i,r,u){this.b=this.c.f();this.c.l(r);this.a.g();if(this.b)for(var o=0;o<this.b.w.length;o++){var e=new _o365sg2p.H;var f=this.b.w[o];e.m=f.bl.ItemId;e.n=f.bl.ParentFolderId;e.i=f.k();e.h=f.bl.Subject;e.g=f.q()?f.q().bl.DisplayName:"";e.a=f.a();e.b=f.b();e.d=f.bl.IsAllDayEvent;e.l=f.e()?f.e().e():!1;this.a.a(e)}t&&t(this.a.f())}};_sp2.C=function(n,t,i,r,u,f,e){_sp2.C.initializeBase(this);this.f=e;_o365sg2p.a.b=this.f;t==="Mouse"&&_a.b.i("Mouse layout is not supported in GlobalMiniaturesPlusViewModel");this.c=f.c;var h=t==="TouchWide"?1:2;if(u){var s=this;u.a(function(n){var t=i||r.a().bn().Enabled;s.e=t?new _sp2.l(n,f,i):null;s.c.u(s.e)})}if(n){var o=this;n.a(function(n){o.d=new _o365sg2p.j(new _sp2.A(n),h);o.c.a&&o.c.a.i(o.d)})}};_sp2.C.prototype={c:null,d:null,e:null,f:null,a:function(){return this.d},b:function(){return this.e}};_sp2.l=function(n,t,i){this.q=Function.createDelegate(this,this.K);this.o=Function.createDelegate(this,this.s);this.r=Function.createDelegate(this,this.L);this.p=Function.createDelegate(this,this.u);_sp2.l.initializeBase(this);_js.Trace.logInfo(_a.a.h,"GroupsViewModelAdapter -- initialize");this.c=t;this.c.c.m(this.p);this.c.G(this.r);this.k=i;var r=this;_js.g.a().d(_ff.d.a,"GroupsViewModelAdapter",function(){r.a=n.g;r.d=new _sp2.q(r.a.A);r.t();r.e=new _js.f;r.g=new _js.f;r.h=new _js.f;r.H();r.s();r.a.m(r.o)})};_sp2.l.prototype={c:null,d:null,a:null,e:null,g:null,h:null,k:!1,y:function(){return this.a?this.a.ba:!1},w:function(){return this.a?this.a.Z:!1},z:function(){return this.a?this.a.M:!1},A:function(){return!this.k},B:function(){return this.a?this.a.N:!1},i:function(){var n=this.a?this.a.C:!1;_js.Trace.logInfo(_a.a.h,"GroupsViewModelAdapter IsReady {0}",n);return n},C:function(){return this.a?this.a.p():!0},D:function(){return this.e},E:function(){return this.g},G:function(){return this.h},F:function(){return this.d},n:function(n){this.d=n;if(null===this.d){if(!this.a.A){_js.Trace.logInfo(_a.a.h,"Clear selected group");this.O()}}else{_js.Trace.logInfo(_a.a.h,"Cache selected group");this.N(this.d.a.a());this.a.E(this.d.a)}this.b("SelectedGroup");return n},v:function(){var n=this;return new _C(function(){n.c.a();n.a.P.a()},_ff.d.a)},b:function(n){this.bt(n)},J:function(n){this.cf(n)},I:function(n){for(var t=0;t<n.w.length;t++)n.w[t].dispose();n.g()},L:function(){if(this.i()){this.a.E(null);this.n(null)}},H:function(){var r=this;this.a.apcl("HasJoinedAndVisitedGroups",function(){r.b("HasJoinedAndVisitedGroups")});var u=this;this.a.apcl("HasPinnedAndUnpinnedGroups",function(){u.b("HasPinnedAndUnpinnedGroups")});var f=this;this.a.apcl("InitialGroupsLoadFailed",function(){f.b("InitialGroupsLoadFailed")});var n=this;this.a.apcl("IsReady",function(){n.b("IsReady")});var t=this;this.a.apcl("IsWelcomeMessageHidden",function(){t.b("IsWelcomeMessageHidden")});var i=this;this.a.apcl("HideBrowseGroups",function(){i.b("HideBrowseGroups")});this.a.bu(this.q);this.J(_sp2.l.a)},K:function(n){this.u()},u:function(){this.c.c.d||this.t()},t:function(){this.c.c.o(this.i()&&!!this.a.A&&this.a.A.e!==1)},s:function(){this.j(this.a.w,this.e,"JoinedGroups");this.j(this.a.z,this.g,"PinnedGroups");this.j(this.a.y,this.h,"VisitedGroups")},j:function(n,t,i){if(t){t.w.length&&this.I(t);for(var r=n.w.length-1;r>=0;r--)t.r(0,new _sp2.q(n.w[r]));this.b(i)}}};_sp2.q=function(n){this.e=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.k);_sp2.q.initializeBase(this);this.a=n;this.i(this.a.d.unseenData.bl.UnseenCount);this.h(this.a.d.bl.DisplayName);this.a.d.unseenData.apcl("LastVisitedTime",this.g);this.a.d.apcl("DisplayName",this.e)};_sp2.q.prototype={a:null,bu:function(){_js.x.prototype.bu.call(this);this.a.d.unseenData.rpcl("LastVisitedTime",this.g);this.a.d.rpcl("DisplayName",this.e)},k:function(n,t){this.i(this.a.d.unseenData.bl.UnseenCount)},j:function(n,t){this.h(this.a.d.bl.DisplayName)}};_sp2.o=function(){};_sp2.o.registerInterface("_sp2.o");var INFDContentProvider=function(){};INFDContentProvider.registerInterface("INFDContentProvider");_sp2.D=function(){};_sp2.D.registerInterface("_sp2.D");_sp2.b=function(n){this.l=Function.createDelegate(this,this.m);this.k=n;this.f=!1};_sp2.b.prototype={k:null,a:function(){return _nbs.a.NS},h:function(){return _nbs.a.Xr},g:function(){return _nbs.a.fN},c:function(){return _nbs.a.eQ},e:function(){return"calendar_card.m.png"},d:function(){return null},b:function(){return new _C(this.l,_a.a.h)},j:function(){return!0},m:function(){this.f=!0;var n=_a.bc.a(1);this.k.a(n)},f:!1,i:function(){return this.f}};_sp2.c=function(n,t){this.m=Function.createDelegate(this,this.n);this.l=n;this.k=t;this.f=!1};_sp2.c.prototype={l:null,k:null,a:function(){return _nbs.a.Kx},h:function(){return _nbs.a.ak},g:function(){return _nbs.a.YT},c:function(){return _nbs.a.cA},e:function(){return"filters_card.m.png"},d:function(){return null},b:function(){return new _C(this.m,_a.a.h)},f:!1,i:function(){return this.f},j:function(){return!0},n:function(){this.f=!0;var n=this;this.k.a(function(t){var i=t.a(1060);n.l.a(i)})}};_sp2.d=function(n){this.l=Function.createDelegate(this,this.m);this.k=n;this.f=!1};_sp2.d.prototype={k:null,a:function(){return _nbs.a.WX},h:function(){return _nbs.a.XE},g:function(){return _nbs.a.PG},c:function(){return _nbs.a.aJ},e:function(){return"displaysettings_card.m.png"},d:function(){return null},b:function(){return new _C(this.l,_a.a.h)},j:function(){return!0},f:!1,i:function(){return this.f},m:function(){this.f=!0;this.k.b&&this.k.a()}};_sp2.e=function(n){this.f=!1;this.k=n};_sp2.e.prototype={k:null,a:function(){return _nbs.a.ja},h:function(){return _nbs.a.If},g:function(){return _nbs.a.jw},c:function(){return _nbs.a.ZX},e:function(){return null},d:function(){return this.k},b:function(){return null},j:function(){return!0},f:!1,i:function(){return this.f}};_sp2.f=function(n){_js.i.b(n,"primaryViewModel");var t=new _o365sg2p.bo(_nbs.a.mB,_nbs.a.hs);t.j(-5);this.k=new _sp2.r(t);!n.a().a&&n.e&&n.e.lM(this.k)};_sp2.f.prototype={k:null,a:function(){return _nbs.a.Iy},h:function(){return _nbs.a.lL},g:function(){return _nbs.a.SF},c:function(){return null},e:function(){return"filters_card.m.png"},d:function(){return null},b:function(){return null},j:function(){return!0},f:function(){return this.k},l:!1,i:function(){return this.l}};_sp2.p=function(n,t,i,r,u,f,e,o,s,h,c,l){this.e=n;var a=t;this.b=a.u||(a.u=Function.createDelegate(a,a.r));this.d=i;this.c=[l,new _sp2.y,r,u,f,new _sp2.x,new _sp2.v,c,e,o,s,h]};_sp2.p.prototype={e:null,b:null,d:null,c:null,a:function(){return this.e.z?this.g():null},g:function(){for(var i=new _js.f,r=this.c,u=r.length,n=0;n<u;++n){var t=r[n];t.j()&&i.a(this.f(t))}return i},f:function(n){var t=new _o365sg2p.be(n.a(),n.h());t.k(new _o365sg2p.cr);t.a.j(n.g());if(n.e()){t.a.h(this.b(n.e()));t.a.g(n.a())}if(n.c()){t.a.i(new _o365sg2c.h);t.a.a.e(n.c());t.a.a.n(n.a())}n.d()&&t.a.a.o(n.d());n.b()&&t.a.a.d(n.b());if(_sp2.o.isInstanceOfType(n)){var r=n;var u=this;t.i(function(n){r.f().a.e(n.b)})}var i=this;t.apcl("ShowDetails",function(){if(!t.b){var r=new _sp2.w;r.a.cn=n.a();r.a.cc=n.i()?1:0;i.d.a(r)}});return t}};_sp2.v=function(){};_sp2.v.prototype={a:function(){return _nbs.a.fv},h:function(){return _nbs.a.cc},g:function(){return _nbs.a.Dq},c:function(){return _nbs.a.cD},e:function(){return"mobile_card.m.png"},d:function(){return"http://www.microsoft.com/en-us/outlook-com/mobile/"},b:function(){return null},j:function(){return!0},f:!1,i:function(){return this.f}};_sp2.w=function(){_sp2.w.initializeBase(this,[1,"NFD"])};_sp2.g=function(n){this.k=n;this.f=!1};_sp2.g.prototype={k:null,a:function(){return _nbs.a.fl},h:function(){return _nbs.a.fG},g:function(){return _nbs.a.Rn},c:function(){return _nbs.a.ZD},e:function(){return"offline_card.m.png"},d:function(){return null},b:function(){return this.k},j:function(){return!0},f:!1,i:function(){return this.f}};_sp2.x=function(){};_sp2.x.prototype={a:function(){return _nbs.a.dx},h:function(){return _nbs.a.jy},g:function(){return _nbs.a.NV},c:function(){return _nbs.a.kh},e:function(){return"onedrive_card.m.png"},d:function(){return null},b:function(){return null},j:function(){return!0},f:!1,i:function(){return this.f}};_sp2.h=function(n){this.l=Function.createDelegate(this,this.m);this.k=n;this.f=!1};_sp2.h.prototype={k:null,a:function(){return _nbs.a.eR},h:function(){return _nbs.a.ZI},g:function(){return _nbs.a.YO},c:function(){return _nbs.a.Cl},e:function(){return"people_card.m.png"},d:function(){return null},b:function(){return new _C(this.l,_a.a.h)},j:function(){return!0},m:function(){this.f=!0;var n=_a.bc.a(2);this.k.a(n)},f:!1,i:function(){return this.f}};_sp2.y=function(){};_sp2.y.prototype={a:function(){return _nbs.a.hG},h:function(){return _nbs.a.FQ},g:function(){return _nbs.a.Ds},c:function(){return null},e:function(){return"pintotop_card.m.png"},d:function(){return null},b:function(){return null},j:function(){return!0},f:!1,i:function(){return this.f}};_sp2.i=function(n,t){this.m=Function.createDelegate(this,this.n);this.k=n;this.l=t};_sp2.i.prototype={k:null,l:null,a:function(){return _nbs.a.OJ},h:function(){return _nbs.a.ZP},g:function(){return _nbs.a.Jb},c:function(){return _nbs.a.kx},e:function(){return"skype_card.m.png"},d:function(){return null},b:function(){return new _C(this.m,_a.a.h)},j:function(){return this.k.a().o().Enabled},n:function(){this.f=!0;this.l.k("SkypeID")},f:!1,i:function(){return this.f}};_sp2.j=function(n){this.l=Function.createDelegate(this,this.m);this.f=n};_sp2.j.prototype={f:null,a:function(){return _nbs.a.kT},h:function(){return _nbs.a.gR},g:function(){return _nbs.a.KH},c:function(){return _nbs.a.N},e:function(){return"themes_card.m.png"},d:function(){return null},b:function(){return new _C(this.l,_a.a.h)},j:function(){return!0},k:!1,i:function(){return this.k},m:function(){this.k=!0;this.f.b&&this.f.a()}};_sp2.r=function(n){_sp2.r.initializeBase(this);this.a=n};_sp2.r.prototype={a:null};_sp2._TI=function(){};_sp2._TI.$$cctor=function(){var t="FlexPanePanelView";new _A(t,function(){_sp2._TI.a[t]===undefined&&(_sp2._TI.a[t]=[[[-1,0,["FlexPanePanelViewModel","FlexPaneViewModel"],[_sp2._TI.g,_sp2._TI.d],null,"DataContext",null,_sp2._TI.b,1,null,null,null]]]);var n=_sp2._TI._hf.childNodes[0].cloneNode(!0);var i=new _o365sg2p.W(n.children[0]);return new _B(n,[i])},_y.r,_o365sg2p.W,function(n){return new _o365sg2p.W(n)},!1,!1,!1,0,_sp2._TI.a);var n="CalloutView";new _A(n,function(){_sp2._TI.a[n]===undefined&&(_sp2._TI.a[n]=[[[-1,0,["ShellCalloutViewModel"],[_sp2._TI.h],null,"DataContext",null,_sp2._TI.b,1,null,null,null],[0,0,["VerticalOffset"],[_sp2._TI.e],null,"VerticalOffset",null,_sp2._TI.f,1,null,null,0]]]);var i=_sp2._TI._hf.childNodes[1].cloneNode(!0);var t=new _o365sg2p.t(i.children[0]);t.i(0);t.j(1);return new _B(i,[t])},_sp2.r,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_sp2._TI.a)};_sp2._TI.c=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_ShellPlusG2_O365_templates_cs_2'></div> </div><div> <div></div> </div>";_js.c.a().appendChild(n);return n};_sp2._TI.g=function(n){return n.h};_sp2._TI.d=function(n){return _sp2.a.isInstanceOfType(n)?n.e:null};_sp2._TI.h=function(n){return n.a};_sp2._TI.e=function(n){return n.b};_sp2._TI.b=function(n,t){n.ba(t)};_sp2._TI.f=function(n,t){n.g(t)};_sp2.m.registerClass("_sp2.m",null,IGlobalNotificationTrayViewModel);_sp2.s.registerClass("_sp2.s",null,_o365sg2p.cG);_sp2.n.registerClass("_sp2.n",null,_o365sg2p.cI);O365ShellPlusG2Component.registerClass("O365ShellPlusG2Component",null,_a.iM);_sp2.k.registerClass("_sp2.k");_sp2.a.registerClass("_sp2.a",_a.bz,IFlexPanePanelViewModel);_sp2.B.registerClass("_sp2.B",null,IGlobalAppsManager);_sp2.C.registerClass("_sp2.C",_a.bz,IGlobalMiniaturesPlusViewModel);_sp2.l.registerClass("_sp2.l",_o365sg2p.e);_sp2.q.registerClass("_sp2.q",_o365sg2p.bd);_sp2.b.registerClass("_sp2.b",null,_sp2.D);_sp2.c.registerClass("_sp2.c",null,_sp2.D);_sp2.d.registerClass("_sp2.d",null,_sp2.D);_sp2.e.registerClass("_sp2.e",null,_sp2.D);_sp2.f.registerClass("_sp2.f",null,_sp2.D,_sp2.o);_sp2.p.registerClass("_sp2.p",null,INFDContentProvider);_sp2.v.registerClass("_sp2.v");_sp2.w.registerClass("_sp2.w",_a.ca);_sp2.g.registerClass("_sp2.g",null,_sp2.D);_sp2.x.registerClass("_sp2.x");_sp2.h.registerClass("_sp2.h",null,_sp2.D);_sp2.y.registerClass("_sp2.y");_sp2.i.registerClass("_sp2.i",null,_sp2.D);_sp2.j.registerClass("_sp2.j",null,_sp2.D);_sp2.r.registerClass("_sp2.r",_a.bz);_sp2._TI.registerClass("_sp2._TI");O365ShellPlusG2Component.$$cctor();_sp2.l.a=["IsReady","IsWelcomeMessageHidden","InitialGroupsLoadFailed","HasPinnedAndUnpinnedGroups","HasJoinedAndVisitedGroups"];_sp2._TI._hf=_sp2._TI.c();_sp2._TI.a={};_sp2._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.shellplusg2.o365.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.shellplusg2.o365.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
