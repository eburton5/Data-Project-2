try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.recipientwell.js'] = (new Date()).getTime();
function RecipientWellComponent(){}RecipientWellComponent.$$cctor=function(){_a.p.a().a(RecipientWellComponent)};RecipientWellComponent.prototype={a:function(n,t,i){var f=this;n.b(_rw.b,function(){return new _rw.b(window.document.createElement("div"),n.a(_y.a))});var e=this;n.b(_rw.h,function(){return new _rw.h(n.a(_y.a),n.a(_pe.h))}).a();var r=this;n.b(_rw.g,function(){return new _rw.g(n.a(_y.a),n.a(IBasePersonaViewModelFactory),n.c(IFindRecipientMailComposeViewModelFactory),n.a(_a.h))}).b(IRecipientWellViewModelFactory).a();var u=this;n.b(_rw.j,function(){return new _rw.j(window.document.createElement("div"),n.a(_y.a),n.a(_ff.c),n.a(_a.h))})},b:function(){return[]}};Type.registerNamespace("_rw");_rw.h=function(n,t){this.d=n;this.c=t};_rw.h.prototype={d:null,c:null,a:function(n,t,i,r,u,f,e,o,s,h){return new _rw.a(this.d.a(),n,t,i,r,u,f,this.c,e,o,s,h)},g:function(n){return new _rw.a(this.d.a(),3,n,null,4,!1,!1,this.c)}};_rw.d=function(n,t,i,r,u,f,e,o,s){this.bG=Function.createDelegate(this,this.cR);this.ck=Function.createDelegate(this,this.cT);this.cm=Function.createDelegate(this,this.dc);this.cl=Function.createDelegate(this,this.cW);this.bI=Function.createDelegate(this,this.cY);this.bH=Function.createDelegate(this,this.cX);this.bK=Function.createDelegate(this,this.db);this.X=Function.createDelegate(this,this.da);this.bJ=Function.createDelegate(this,this.cZ);this.z=-1;_rw.d.initializeBase(this,[n,t,i,r,1,u,!1,f]);_a.b.b(e,"findRecipientMailComposeViewModelFactoryAsyncLazy");this.bN=e;this.bb=o;this.bM=s};_rw.d.b=function(n){var t=n.g.d();!_js.d.b(t)&&t.endsWith(";")&&(t=t.substr(0,t.length-1));return t};_rw.d.e=function(n,t){t.val=!1;if(_js.d.b(n))return null;var i="";var s="";var v="SMTP";var r=n.indexOf("[");var e=n.lastIndexOf("]");var o=n.indexOf(":");if(r>=0&&e>=0&&o>=0&&o>r&&o<e){s=n.substring(0,r);v=n.substring(r+1,o);i=n.substring(o+1,e).trim();if(_js.d.b(i))return null;t.val=!0}else{var a=n.indexOf("<");var p=n.indexOf(">");var y=n.indexOf("(");var l=n.indexOf(")");if(r>=0&&e>=0&&e>r||a>=0&&p>=0&&p>a||y>=0&&l>=0&&l>y){var f=n.match(_rw.d.c);if(f&&f.length>0){if(!_js.d.b(f[0])){var c=n.indexOf(f[0]);if(c!==-1){i=f[0];var b=i.replace(_rw.d.d,"\\$1");var k=new RegExp(String.format("\\(\\s*{0}\\s*\\)|\\<\\s*{0}\\s*\\>|\\[\\s*{0}\\s*\\]",b));var h=n.match(k);h&&h.length>0&&!_js.d.b(h[0])&&(c=n.indexOf(h[0]));s=n.substring(0,c).trimEnd()}}}else i=n}else i=n;if(_js.d.b(i))return null;i=i.trim();t.val=_a.F.a(i)}var u=new _g.d;u.MailboxType="OneOff";u.RoutingType=v.trim();u.EmailAddress=i;u.Name=_js.d.b(s)?i:s.trim();return _pc.a.b(u)};_rw.d.prototype={bN:null,bg:null,A:null,H:!1,M:null,E:null,bQ:null,bR:null,G:!1,bs:!1,bt:!1,bo:!1,bm:!1,bp:!1,bM:!1,N:!1,O:null,bb:null,bL:function(n){this.dV("BulkResolveOperationComplete",n)},bS:function(n){this.dW("BulkResolveOperationComplete",n)},F:function(n){if(this.A!==n){!this.A||this.z!==-1||this.u().i(this.bJ);this.A=n;!this.A||this.z!==-1||this.u().p(this.bJ);this.dQ("RecipientBeingEdited")}return n},u:function(){if(!this.M){var n=this;this.bN.a(function(t){n.de(t)})}return this.M},dd:function(n){if(this.M!==n){this.M=n;this.dQ("FindRecipientViewModel")}return n},ct:function(n){if(this.H!==n){this.H=n;this.dQ("IsAnyRecipientInvalid")}return n},I:function(n){if(this.bg!==n){this.bg=n;this.dQ("TextBeingEdited")}return n},bq:function(n){if(this.G!==n){this.G=n;this.cU(n);this.dQ("DisableActionsOnAllRecipients")}return n},cv:function(n){if(this.bs!==n){this.bs=n;this.dQ("ShouldShowHiddenRecipient")}return n},cw:function(n){if(this.bt!==n){this.bt=n;this.dQ("UpdateFindControlPopupPosition")}return n},cu:function(n){if(this.bo!==n){this.bo=n;this.dQ("ResetFindControlPopupPosition")}return n},cs:function(n){if(this.bm!==n){this.bm=n;this.dQ("HandleBackspaceCommandAtEndOfReadWriteWell")}return n},br:function(n){if(this.bp!==n){this.bp=n;this.dQ("ResizeFindControl")}return n},cV:function(){return _a.UserAgent.getInstance().E},bl:function(){return!!this.bb&&this.bb.a().O().Enabled},co:function(){return!!this.bb&&this.bb.a().d().Enabled},bf:function(){this.bO()},dg:function(){this.u()&&this.u().l(!1)},bP:function(){this.bO();this.N=!0;if(this.co()||!this.H||OwaApplication.b){this.dZ("BulkResolveOperationComplete",!0);this.N=!1}else{this.E=new _js.f;this.u().br(new _js.f);for(var i=0,r=this.t.w.length;i<r;i++){var n=this.t.w[i];if(!n.i){this.E.a(n);var t=_rw.d.b(n);this.u().be().a(t);if(!(this.z!==-1)){this.u().bf(t);this.bq(!0);this.u().c(null);this.cq(n);this.I(t);this.F(n);this.u().p(this.X)}}}}},bA:function(){_rw.a.prototype.bA.call(this);this.M&&this.M.b(null)},ba:function(){if(this.z!==-1){this.z=-1;this.u().D();this.bq(!1);this.u().i(this.X);this.u().c(this.O);if(this.u().a()===this.bg)this.cv(!0);else{var n=this.u().a();_js.d.a(n)||this.bu(n)}this.I("");this.F(null);this.cv(!1);if(this.N){this.dZ("BulkResolveOperationComplete",!1);this.N=!1}}},cr:function(n){if(this.t)for(var t=0;t<this.t.w.length;t++){var i=this.t.w[t];if(i.h&&i.h.a().EmailAddress===n.EmailAddress)return!0}return!1},Z:function(n){return this.bX(n)},bX:function(n){var i;var u;var t=!1;if(this.cf){var o=n.EmailAddress;var r=n.Name;if(_js.d.a(o))if(_js.d.a(r))throw Error.argumentNull("Address and Name parameters are set to null in emailAddress");else if(n.RoutingType!=="MAPIPDL"){var e,f;i=(f=_rw.d.e(r,e={val:t}),t=e.val,f)}else{t=!0;i=_pc.a.b(n);_js.Trace.logInfo(_rw.d.a,"AddRecipientGivenEmail: Creating PDL with name: {0}",r)}else{t=_g.n.d(n)?!0:_a.F.a(o);i=_pc.a.b(n)}}else{t=!0;i=_pc.a.b(n)}u=this.K(i);this.C(u,this.B,t);this.ct(!!(this.H|!t));return u},dT:function(){this.u().j(this.bK);this.u().bh(this.bH);this.u().bi(this.bI);this.F(null);this.z!==-1&&this.u().i(this.X);_rw.a.prototype.dT.call(this)},cW:function(){if(this.t.w.length>0){this.cs(!0);this.cs(!1)}},cT:function(){var n=this.t.w.length;if(n>0){var t=this.t.w[n-1];this.R(t);this.u().E(!0)}},db:function(n,t){var i=this.u().h();if(i){this.cQ();this.A||this.bn()}},cR:function(){this.z!==-1?this.bu(this.u().a()):this.u().iy()||this.cp();_pc.b.b(2,-1,-1,-1,4,1);this.A||this.bn()},cE:function(n,t){var i=n;if(i.n){this.u().c(null);this.I(_rw.d.b(i));this.F(i)}},ce:function(n){if(n.i()===1||n.i()===2){_rw.a.b(n,!0,0);n.e(0,n.d(),0)}},Q:function(n,t,i){this.bl()&&(t|=8);return _rw.a.prototype.Q.call(this,n,t,i)},ca:function(){this.bl()?this.y&&!this.y.c()&&this.y.f(!0):_rw.a.prototype.ca.call(this)},cb:function(n,t){_rw.a.prototype.cb.call(this,n,t);this.di()},C:function(n,t,i){if(!n)throw Error.argument("personaViewModel");if($a(n.a()))throw Error.argument("personaViewModel.BasePersona");var f=this.dh(t,i);var r=this.Q(n,f,i);this.bw(r,f);if(this.A){var e=this.t.k(this.A);this.R(this.t.w[e]);var u=r.g;u.g(!this.G);u.z(!this.G);u.J(!this.G);this.G&&r.I();this.t.r(e,r);this.bT()}else this.t.a(r);this.be();return r},de:function(n){var t=n.a();if(this.bl()){this.O=new _C(this.cl,_rw.d.a);t.Q(this.cm)}else this.O=new _C(this.ck,_rw.d.a);t.bn(new _C(this.cy,_rw.d.a));t.c(this.O);t.J(new _C(this.bG,_rw.d.a));this.co()&&this.bl()&&t.I(new _C(this.bG,_rw.d.a));t.q(this.bK);t.P(this.bH);t.R(this.bI);t.bm(this.D);t.bl(this.t);t.H(this.bM);this.dd(t)},bO:function(){if(this.z!==-1)this.ba();else{var n=this.u().r();this.u().d(!1);this.cp();this.u().d(n);this.u().E(!1)}},cX:function(n){if(!$a(n)&&n.w.length&&!$a(this.u().s())&&this.u().s().w.length){this.E=new _js.f;for(var t=0,i=n.w.length;t<i;t++)this.cS(n.w[t],this.u().s().w[t]);if(this.E.w.length>0){this.bq(!0);this.u().c(null);this.I(this.bR);this.F(this.bQ);this.u().p(this.X)}_pc.b.b(2,-1,-1,-1,4,1)}},cY:function(n,t){for(var u=0,f=this.t.w.length;u<f;u++){var i=this.t.w[u];var r=i.g.a();if(i.i&&r.i()===1&&!_js.d.b(r.a().EmailAddress)&&r.a().EmailAddress.toLowerCase()===n.toLowerCase()){i.g.H(t);this.ce(i.g)}}},cn:function(n,t){t&&this.u().bs(n.a())},cQ:function(){var t=this.u().h();var n=this.df(t);n&&n.A()&&t.a().cF(n.A());var i=this.K(t.a());i.z(!0);this.C(i,this.B,!0)},df:function(n){return _pe.k.isInstanceOfType(n)?n:null},bn:function(){this.u().es=_js.d.b(this.u().a())?-1:this.u().a().length;this.u().b("");this.be()},cp:function(){var i=this.u().a();if(!_js.d.b(i)){for(var t=this.u().bg(i),n=0,r=t.length;n<r;n++)this.bu(t[n]);this.bn()}},bu:function(n){var t;var u,f;var i=(f=this.u().T(n,u={val:t}),t=u.val,f);if(i){var r=this.K(i);this.C(r,this.B,t);this.cn(r,t)}},cS:function(n,t){var r=this.K(n);var i=this.C(r,this.B,t);this.cn(r,t);this.bn();if(!t&&!OwaApplication.b){this.E.a(i);this.z!==-1||this.cq(i)}},cq:function(n){this.z=0;this.bQ=n;this.bR=_rw.d.b(n)},di:function(){for(var t=!1,i=this.t.w.length,n=0;n<i;n++){t=!this.t.w[n].i;if(t)break}this.ct(t)},bT:function(){if(!(this.z!==-1)){this.u().c(this.O);this.I("");this.F(null);return}this.u().t(!1);var n=this.E.w[this.z];var t=n.g.d();this.E.n(this.z);if(this.z<this.E.w.length){n=this.E.w[this.z];this.I(_rw.d.b(n));this.F(n)}else{this.E=null;this.z=-1;this.u().D();this.bq(!1);this.u().c(this.O);this.u().i(this.X);this.I("");this.F(null);if(this.N){this.dZ("BulkResolveOperationComplete",!0);this.N=!1}}},cU:function(n){for(var r=0,u=this.t.w.length;r<u;r++){var t=this.t.w[r];var i=t.g;i.g(!n);i.z(!n);i.J(!n);n?t.I():t.F()}},dh:function(n,t){var i=n;t||(i^=1);return i},dc:function(n,t){var i=n;i.ba()&&this.bO()},cZ:function(n,t){var e=n;if(!e.A()){var r=this.t.k(this.A);if(r>=0){var i=this.u().a();if(_js.d.a(i)){this.R(this.t.w[r]);this.bT()}else if(this.A&&i===this.A.h.d()){var f=this.A.g.a();var u=this.K(f);this.C(u,this.B,this.A.i)}else this.bu(i)}}},da:function(n,t){var u=n;if(!u.A()){var i=this.t.k(this.A);if(i>=0){var r=this.u().a();if(_js.d.a(r)){this.R(this.t.w[i]);this.bT()}else this.u().X()&&this.ba()}}}};_rw.e=function(n,t,i){this.E=Function.createDelegate(this,this.W);this.B=Function.createDelegate(this,this.G);this.z=Function.createDelegate(this,this.U);this.t=Function.createDelegate(this,this.V);this.C=Function.createDelegate(this,this.S);this.D=Function.createDelegate(this,this.T);_rw.e.initializeBase(this);this.g=n;this.g.J(!0);this.F();this.bb(i);this.H(n.a(),t,!0);if(this.p){this.g.bt(new _C(this.D,_rw.e.a));this.g.v(!0)}else this.g.p(!0);if(this.q()){this.g.b(!0);this.g.bs(this.M())}this.g.j(!this.g.S()&&!this.p&&this.q())};_rw.e.prototype={g:null,k:null,u:null,h:null,i:!0,j:0,r:!1,w:!1,n:!1,o:!1,y:!1,p:!1,v:!1,l:null,N:function(){return this.i&&_g.n.j(this.h.a())},Q:function(){var n=this;return new _C(function(){n.v=!0},_a.a.V)},R:function(){var n=this;return new _C(function(){n.v=!1},_a.a.V)},d:function(n){if(this.r!==n){this.r=n;this.dQ("IsSelected")}this.g.R()!==n&&this.g.n(n);return n},X:function(n){if(this.w!==n){this.w=n;this.dQ("IsDeleted")}return n},c:function(){return this.n},f:function(n){if(this.n!==n){this.n=n;this.dQ("IsBeingEdited")}return n},bb:function(n){if(this.i!==n){this.i=n;this.dU("IsValid","DisplayAsValid")}return n},q:function(){return this.i&&!this.N()},O:function(){return this.q()?"":_nbs.a.Nm},Z:function(n){if(this.o!==n){this.o=n;this.dU("IsMailTipsTriggered","IsMailTipsOrPolicyTipsTriggered")}return n},ba:function(n){if(this.y!==n){this.y=n;this.dU("IsTriggeredPolicyTips","IsMailTipsOrPolicyTipsTriggered")}return n},P:function(){return this.o||this.y},a:function(){return this.h},e:function(){var t;if(this.i){var n=this.h.a();if(n.RoutingType==="SMTP"){var r=n.EmailAddress;var i=n.Name;t=_js.d.b(i)?r:String.format("{0} <{1}>",n.MailboxType==="OneOff"?i:'"'+i.replace('"','\\"')+'"',r)}else t=n.RoutingType==="MAPIPDL"?n.Name:String.format("{0} [{1}:{2}]",n.Name,n.RoutingType,n.EmailAddress)}else t=this.g.d();return t},b:function(){return this.g},M:function(){this.u||(this.u=new _C(this.C,_rw.e.a));return this.u},bc:function(n){if(this.k!==n){this.k=n;this.dQ("RemoveRecipientCommand")}return n},H:function(n,t,i){i||this.g.bo(n);this.h=n;if(i||this.j!==t){this.j=t;this.L()}},F:function(){this.g.apcl("IsSelected",this.t);this.g.apcl("IsPersonaCardShown",this.z)},I:function(){this.g.rpcl("IsSelected",this.t);this.g.rpcl("IsPersonaCardShown",this.z)},V:function(n,t){this.d(n.bO)},U:function(n,t){this.g.t()&&(_rw.a.e=this)},S:function(){var t=this;var n=function(){t.g.u();t.l=null};if(this.p){var i=this;this.l=_js.g.a().a(_rw.e.a,"RecipientViewModel.OnClick",function(){i.l&&n()},300)}else n()},T:function(){if(this.g&&this.g.bd()){this.g.t()&&this.g.f(!1);if(this.p&&this.l){_js.g.a().b(this.l);this.l=null}this.G()}},L:function(){var n=[];if(((this.j&8)==8||OwaApplication.b&&_y.c.a.a()==="TouchNarrow")&&this.g&&this.g.a()&&this.g.a().a()){var t=this.g.a().a().EmailAddress;_js.d.b(t)||Array.add(n,new _fm.n(t))}if((this.j&4)==4&&!_y.c.a.h()){Array.add(n,new _fm.d(_u.R.VM,null,new _C(this.B,_rw.e.a),!1,null,null,null,null,null));this.p=!0}if((this.j&2)==2){this.bc(new _C(this.E,_rw.e.a));Array.add(n,new _fm.d(_u.R.TX,null,this.k));this.g.bu(this.k)}!$a(this.g.m())&&this.q()&&(this.j&1)==1&&Array.addRange(n,this.g.m());this.g.U(n)},G:function(){_a.l.b("VM.Recipient.Edit");this.f(!0)},W:function(){this.g.rpcl("IsSelected",this.t);this.X(!0)}};_rw.g=function(n,t,i,r){_rw.g.initializeBase(this,[n,t]);this.e=i;this.f=r};_rw.g.prototype={e:null,f:null,b:function(n,t,i,r,u){return new _rw.d(this.d.a(),n,t,i,r,this.c,this.e,this.f,u)}};_rw.a=function(n,t,i,r,u,f,e,o,s,h,c,l){this.bW=Function.createDelegate(this,this.ds);this.bU=Function.createDelegate(this,this.dr);this.bV=Function.createDelegate(this,this.cE);this.cx=Function.createDelegate(this,this.ca);this.bh=Function.createDelegate(this,this.cb);this.cy=Function.createDelegate(this,this.be);this.L=_bc.f.a;_rw.a.initializeBase(this);_a.b.a(o,"personaViewModelFactory");this.bB=n;this.bk=l;this.cf=$a(f)?!1:f;this.bz=o;this.cg=s;this.cc=c;this.S=e;this.B=t;this.L=i;this.U=u;this.by=$a(h)?r?r.b():0:h;this.r(new _js.f);this.q(new _js.f);this.D={};this.T=[];this.cD(r);r&&_js.Trace.logInfo(_a.a.V,"RecipientWellViewModel::Number of EmailAddresses passed in: {0} and Number of recipients created: {1}",r.b(),this.t.w.length);this.t.d(this.bh)};_rw.a.b=function(n,t,i){OwaApplication.b&&(t=!1);var r=n.a().a();if(r&&!_js.d.b(r.EmailAddress)&&n.a().b()===1){if(i===9){n.e(0,r,4);return}t||r.MailboxType==="Contact"?_js.d.b(r.Name)||r.Name===r.EmailAddress?n.e(0,r.EmailAddress,0):n.e(0,r.Name,0):(r.MailboxType==="OneOff"||r.MailboxType==="Unknown")&&n.e(0,r,2)}};_rw.a.g=function(n){return $a(n)||0===n.v.w.length};_rw.a.f=function(){var n=null;if(_rw.a.a>=0){n=_rw.a.c[_rw.a.a];_rw.a.c[_rw.a.a]=null;_rw.a.a-=1}return n};_rw.a.prototype={cf:!1,U:1,S:!1,bz:null,cg:!1,by:0,bB:0,B:1,y:null,v:null,t:null,T:null,ch:0,bi:0,bD:!1,bx:null,bC:!0,bd:0,bZ:!1,D:null,cc:0,bk:null,dj:function(n){this.dV("RefreshLayoutRequest",n)},dt:function(n){this.dW("RefreshLayoutRequest",n)},dn:function(){return _a.UserAgent.getInstance().G},a:function(){return this.t},r:function(n){if(this.t!==n){this.t=n;this.dQ("Recipients")}return n},dm:function(){this.bx||(this.bx=new _C(this.cx,_rw.a.d));return this.bx},c:function(){return this.v},q:function(n){if(this.v!==n){this.v=n;this.dQ("Addresses")}return n},i:function(){return this.y},l:function(n){if(this.y!==n){this.y&&this.y.d(!1);this.y=n;if(this.y){this.y.d(!0);this.dl()}this.dQ("SelectedRecipient")}return n},o:function(){return this.L},cd:function(n){this.bC!==n&&(this.bC=n);return n},cG:function(n){this.ch!==n&&(this.ch=n);return n},f:function(n){if(this.bi!==n){this.bi=n;if(this.bi===2){for(var i=0,f=this.T.length;i<f;i++)this.cz(this.T[i]);Array.clear(this.T);this.cG(1)}else if(this.bi===1){if(this.t)for(var r=this.t.w.length,t=this.bd;t<r;r--){var u=this.t.w[t];$a(u)||Array.add(this.T,u);this.t.n(t)}this.cG(0)}}return n},bY:function(){return!!_y.c.a&&_y.c.a.a()==="Mouse"&&!!this.bk&&this.bk.a().bx().Enabled&&this.bk.a().e().Enabled},g:function(){return this.bD&&!this.bY()},b:function(n){if(this.bD!==n){this.bD=n;this.dQ("ShowEllipsis")}return n},e:function(){return this.bZ},dp:function(){return this.bY()?"ReadOnlyRecipientViewAggregated":"ReadOnlyRecipientView"},p:function(n){if(this.t){this.bA();this.t.e(this.bh)}this.cD(n);this.t&&this.t.d(this.bh)},d:function(){if(!$a(this.t)&&this.t.w.length){if(!_rw.a.c){_rw.a.c=[];_rw.a.a=-1}for(var n=0,t=this.t.w.length;n<t&&_rw.a.a<49;n++){_rw.a.a+=1;_rw.a.c[_rw.a.a]=this.t.w[n]}this.t=null}},n:function(n,t){if(n.i()!==this.U)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");this.bj(n);var i=this.Q(n,t,!0);this.bw(i,t);this.t.r(0,i)},P:function(n){if(n.i()!==this.U)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");this.bj(n);this.C(n,this.B,!0)},J:function(n,t){if(n.i()!==this.U)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");t=$a(t)?this.B:t;this.bj(n);this.C(n,t,!0)},m:function(n){var t=this.K(n);this.C(t,this.B,!0)},k:function(n){for(var i,t=0,r=this.t.w.length;t<r;t++){i=this.t.w[t];if(i.g===n){this.R(this.t.w[t]);return}}},bc:function(n){var t=this.K(n);this.C(t,this.B,!1)},bA:function(){this.t&&this.t.g();this.v&&this.v.g()},bX:function(n){var r=_h.k.a(n);var i=this.S?_rw.a.f():null;var t;if(i){i.H(r,this.B,!1);t=i.g;this.bj(t);this.t.a(i)}else{t=this.K(r);this.C(t,this.B,!0)}return t},h:function(){for(var i=new _ff.e,n=0,u=this.t.w.length;n<u;n++){var t=this.t.w[n].h.a();if(!$a(t.EmailAddress))if(this.t.w[n].h.b()===5){var r=new _a.F(t.EmailAddress);_js.d.a(r.b)||i.c(r.b)}else i.c(t.EmailAddress)}return i.i()},dT:function(){this.t.e(this.bh);if(!$a(this.t)&&this.t.w.length){for(var n=0,i=this.t.w.length;n<i;n++){var t=this.t.w[n];this.cB(t)}_a.jX.prototype.dT.call(this)}},ce:function(n){if(n.i()===1||n.i()===2||OwaApplication.b){_rw.a.b(n,!1,this.cc);n.e(0,_js.d.c("{0};",n.d()),0)}},be:function(){this.dX("RefreshLayoutRequest")},cb:function(n,t){switch(t.c){case 0:for(var r=0,e=t.a.length;r<e;r++)this.dk(t.a[r],t.d+r);break;case 2:for(var u=t.b.length-1;u>=0;u--)this.cF(t.d+u);break;case 3:for(var i=0,o=t.b.length;i<o;i++)this.dv(t.a[i],t.d+i);break;case 4:for(var f=t.b.length-1;f>=0;f--)this.cF(t.d+f);break;default:break}},Q:function(n,t,i){return new _rw.e(n,t,i)},bw:function(n,t){if(!this.S){(t&4)==4&&n.apcl("IsBeingEdited",this.bV);(t&2)==2&&n.apcl("IsDeleted",this.bU);n.apcl("IsSelected",this.bW)}},cB:function(n){var t=n.j;if(!this.S){(t&4)==4&&n.rpcl("IsBeingEdited",this.bV);(t&2)==2&&n.rpcl("IsDeleted",this.bU);n.rpcl("IsSelected",this.bW)}},ds:function(n,t){var i=n;i.r?this.l(i):this.l(null);this.be()},dr:function(n,t){var i=n;i.w&&this.R(i)},cE:function(n,t){},K:function(n){var t=null;t=this.bz.a(n,this.L,!0,this.U);this.bj(t);return t},C:function(n,t,i){if($a(n))throw Error.argument("personaViewModel");var r=this.Q(n,t,i);return this.cA(r)},cA:function(n){this.bw(n,n.j);this.t.a(n);this.be();return n},R:function(n){this.cB(n);this.t.m(n,!0);this.be()},j:function(n){for(var r=[],t=0,e=this.t.w.length;t<e;t++){var f=this.t.w[t].h;if(!$a(f)){var u=f.a();$a(u.EmailAddress)||u.EmailAddress!==n||Array.add(r,t)}}for(var i=r.length-1;i>=0;i--)this.t.n(r[i])},ca:function(){this.y&&!this.y.c()&&this.y.b().T()},cD:function(n){if(!$a(n)){var r=n.b();switch(this.bB){case"TouchWide":this.bd=4;break;case"TouchNarrow":this.bd=2;break;default:this.bd=this.bY()?20:7;break}for(var i=this.S?this.bd:r,t=0;t<i&&t<r;t++){var e=n.c(t);$a(e)||this.cz(e)}(i<r||this.by>i)&&(this.bZ=!0);for(var u=i;u<r;u++){var f=n.c(u);$a(f)||Array.add(this.T,f)}}},bj:function(n){this.ce(n);n.z(!this.S)},cz:function(n){if(_bc.x.isInstanceOfType(n)){var u=n;this.v.a(u.a());this.m(u);this.bv(u.a())}else if(_rw.e.isInstanceOfType(n)){var i=n;this.v.a(i.h.a());this.bv(i.h.a());i.i?this.m(i.h):this.bc(i.h)}else{var t;if(_g.n.n(n))t=n.Mailbox;else if(_g.n.a(n))t=n;else throw Error.invalidOperation("Recipient is not a known type.");if(!t.Submitted||this.cg){if(_js.d.a(t.EmailAddress)){for(var f="A new zombie contact was added in the recipients",r=0;r<this.v.w.length;r++)if(this.v.w[r].Name===t.Name){f="A zombie contact was added for an existing recipient";break}_js.Trace.logError(_a.a.V,f)}this.v.a(t);this.bX(t);this.bv(t)}}},dk:function(n,t){var i=this.cC(n);this.v.r(t,i);this.bv(i)},cF:function(n){var t=this.v.w[n];this.v.n(n);this.du(t)},dv:function(n,t){var i=this.cC(n);this.v.n(t);this.v.r(t,i)},cC:function(n){return this.dq(n)},dq:function(n){var t;var i=n.g.y();t=$a(i)?$a(n.h.a())?!$a(n.h.c())&&n.h.c().length>0?n.h.c()[0]:new _g.d:n.h.a():i;return t},bv:function(n){if(n&&n.EmailAddress){var t=n.EmailAddress;this.D[t]=t in this.D?this.D[t]+1:1}},du:function(n){if(n&&n.EmailAddress){var t=n.EmailAddress;t in this.D&&this.D[t]>1?this.D[t]=this.D[t]-1:delete this.D[t]}},dl:function(){_pe.c.c&&_pe.c.c!==this.y.b()&&_pe.c.c.f(!1)}};_rw.k=function(n){_rw.k.initializeBase(this,[n])};_rw.k.prototype={b:null,a:null,g:function(){return null},j:function(n){this.b&&this.b.b&&this.b.a()},h:function(n){},i:function(n){this.a&&this.a.b&&this.a.a()}};_rw.j=function(n,t,i,r){this.r=Function.createDelegate(this,this.cS);_rw.j.initializeBase(this,[n,t]);this.k=i;this.l=r};_rw.j.prototype={k:null,m:null,g:null,c:null,u:!1,bV:!1,v:!1,s:!1,t:!1,l:null,cX:function(n){if(this.m!==n){this.m=n;this.cR(n)}return n},cV:function(n){this.g!==n&&(this.g=n);return n},dh:function(n){if(this.u!==n){this.u=n;n&&this.dj()}return n},di:function(n){if(this.v!==n){this.v=n;n&&this.bW()}return n},da:function(n){if(this.s!==n){this.s=n;n&&this.dz()}return n},cW:function(n){this.bV=n;n&&this.i();return n},db:function(n){if(this.t!==n){this.t=n;n&&this.dt()}return n},bz:function(){return!!this.l&&this.l.a().O().Enabled},V:function(){_rw.b.prototype.V.call(this);this.bY.a()!=="Mouse"&&_rw.f.isInstanceOfType(this.R)&&this.k.b(_ff.p,this.r)},bu:function(){this.bY.a()!=="Mouse"&&_rw.f.isInstanceOfType(this.R)&&this.k.c(_ff.p,this.r);_rw.b.prototype.bu.call(this)},bQ:function(){if(_rw.f.isInstanceOfType(this.R)){this.bf(null);var n=this.R.b;n.e()}},i:function(){var n=_rw.f.isInstanceOfType(this.R);if(n&&this.R.b.bW()){this.R.b.bv();this.B.focus()}_rw.b.prototype.i.call(this)},dj:function(){this.c.length===1&&this.c.show()},cR:function(n){var t=this.R;var i=t.b;if(n){var r=this.bR(n);if(r<0)return;this.c=t.a.c(r).B;this.c.hide();if(r!==this.Z().b()-1){var u=t.a.c(r+1).B[0];t.B[0].insertBefore(i.B[0],u);t.b.c(this.c.width()+10)}else t.B[0].appendChild(i.B[0]);t.c.a()===this.g&&t.c.b("");t.c.b(this.g);t.c.bk(!0)}else{this.c=null;t.B[0].appendChild(i.B[0]);t.c.b("")}var f=this;_js.g.a().c(_a.a.V,"RecipientWellView.AdjustFindControlPosition",function(){i.e();i.bY();t.c&&(n?t.c.t(!0):t.c.t(!1))})},cS:function(n){this.bW()},bW:function(){if(_rw.f.isInstanceOfType(this.R)){var n=this;_js.g.a().c(_a.a.V,"RecipientWellView.TryUpdateTextBoxDropDownPosition",function(){n.R.b.bz()})}},dz:function(){if(_rw.f.isInstanceOfType(this.R)){var n=this;_js.g.a().c(_a.a.V,"RecipientWellView.TryResetTextBoxDropDownPosition",function(){n.R.b.bR()})}},dt:function(){if(_rw.f.isInstanceOfType(this.R)){var n=this;_js.g.a().c(_a.a.V,"RecipientWellView.TriggerResizeFindControl",function(){n.R.bc()})}}};_rw.i=function(n){_rw.i.initializeBase(this,[n]);this.y("ReadWriteRecipientWellView")};_rw.i.prototype={a:null,c:null,b:null,cC:function(){return this.c},bd:function(n){if(this.c!==n){this.c=n;this.bt("AriaLabelledBy")}return n},cu:function(){return this.b},bb:function(n){if(this.b!==n){this.b=n;this.bt("AriaLabel")}return n},d:function(){var n=null;if(this.a){var t=this.a.h();n=this.a.R.a.c(t)}return n},e:function(){this.P()&&this.a&&this.a.R.b.e()},K:function(){_js.b.prototype.K.call(this);var n=this.F;this.a=n?n.a("RecipientWell"):null}};_rw.f=function(n){this.w=Function.createDelegate(this,this.k);this.m=Function.createDelegate(this,this.bz);this.r=Function.createDelegate(this,this.F);this.s=Function.createDelegate(this,this.bK);this.v=Function.createDelegate(this,this.Z);_rw.f.initializeBase(this,[n]);this.B.attr("tabIndex","-1");this.b=this.bq();this.b.q(new _C(this.v,_rw.f.a));this.l=_y.c.a.a()==="Mouse"?25:50;var i=this;this.B.bind("click",function(n){i.y(n)});var t=256;this.bk(t)};_rw.f.prototype={b:null,l:0,c:null,f:null,bf:function(n){if(this.c!==n){if(!$a(this.c)){this.c.rpcl("IsTextBoxFocused",this.s);this.c.rpcl("IsTypedown",this.r)}this.c=n;this.b.ba(this.c);if(!$a(this.c)){this.b.o(this.c.y());this.b.s(this.c.B());this.c.apcl("IsTextBoxFocused",this.s);this.c.apcl("IsTypedown",this.r);this.F(null,"IsTypedown")}this.bt("FindRecipientViewModelForWell")}return n},bG:function(n){this.b.bV(n);return n},bD:function(n){this.b.bU(n);return n},g:function(){if($a(this.f)){this.f=$(window.document.createElement("SPAN"));this.f.addClass("dynamicResizingElement");this.f.addClass("ms-fwt-r")}return this.f},h:function(){return this.B.width()},bc:function(){this.b.c(0);this.c&&this.k()},V:function(){_js.c.prototype.V.call(this);$(window).bind("resize",this.m);_js.g.a().a(_a.a.V,"RecipientWell.FindControl.Resize",this.w,500)},J:function(){_js.C.prototype.J.call(this);this.b.B.addClass("findControlWrapper");this.b.B.css("line-height","normal");this.b.B[0].appendChild(this.g().get(0));_y.c.a.a()!=="Mouse"&&this.Z()},j:function(n,t){_fce.c.prototype.j.call(this,n,t);if(this.E()&&this.E().bC){t.c!==2&&t.c||this.k();if(!this.c||this.c.bc()){if(!t.c||t.c===2&&!this.a.b()){var i=this;_js.g.a().c(_a.a.V,"RecipientWellPanelView.OnChildrenModified",function(){i.b.e()})}}else this.c.w(!0)}},bm:function(n,t){if(n.B.parents().length)throw Error.argument("Can't add already added control to panel");var i=this.B[0];this.b.B.width("auto");this.b.c(0);i.insertBefore(n.B[0],this.b.B[0])},bu:function(){$(window).unbind("resize",this.m);var i=this;this.B.unbind("click",function(n){i.y(n)});this.bf(null);var n=this.g().get(0);var t=this.b.B.has(n);t.length===1&&this.b.B[0].removeChild(n);this.b.dispose();_fce.c.prototype.bu.call(this)},y:function(n){var t="";if($a(window.document.selection))$a(window.getSelection)||(t=window.getSelection().toString());else{var r=window.document.selection.createRange();t=r.text}if(_js.d.a(t))if(n.target.nodeName==="SPAN"||n.target.nodeName==="IMG")this.b.bv();else if(this.bA()){var i=this;_js.g.a().c(_a.a.V,"RecipientWellPanelView.OnClickPanel",function(){i.b.e()})}else this.b.e()},bq:function(){var n=new _b.t(window.document.createElement("SPAN"));n.ba(this.c);n.y("FindRecipientView");n.M(!1);n.j(!0);n.p(0);n.t(100);n.bs();this.B[0].appendChild(n.B[0]);return n},F:function(n,t){this.b&&this.b.n!==this.c.r()&&this.b.j(this.c.r())},bK:function(n,t){this.c.z()?this.b.bn()<this.l&&this.b.c(this.h()-30):_js.d.a(this.c.a())&&this.k()},Z:function(){if(this.c){var n=this.c.a();if(_js.d.a(n)){this.g().text("");this.k()}else{n=_ff.i.a(n);this.g().text(n);var i=this.g().innerWidth();if(i<this.b.bn())return;var t=this.h()-30;this.b.c(t)}}},k:function(){this.b.c(this.h()-this.bv()-30)},bv:function(){var n=0;if(this.a.b()>0){var t=this.a.c(this.a.b()-1).B;n=_g.a.a().c().bl.IsUserCultureRightToLeft?this.h()-t.position().left:t.position().left+t.outerWidth(!0)}return this.h()-n-30<this.l?0:n},bz:function(n){this.bc()},bA:function(){return _a.UserAgent.getInstance().O&&_y.c.a.a()!=="Mouse"}};_rw.c=function(n){_rw.c.initializeBase(this,[n])};_rw.c.prototype={b:null,a:null,cC:function(){return this.b},bd:function(n){if(this.b!==n){this.b=n;this.bt("AriaLabelledBy")}return n},cu:function(){return this.a},bb:function(n){if(this.a!==n){this.a=n;this.bt("AriaLabel")}return n}};_rw.b=function(n,t){this.n=Function.createDelegate(this,this.ca);this.o=Function.createDelegate(this,this.ck);this.w=Function.createDelegate(this,this.bX);_rw.b.initializeBase(this,[n,t]);this.cO();this.bg(this.w)};_rw.b.a=function(n,t){if($a(window.getSelection)){if(!$a(window.document.selection)){var i=document.selection.createRange();i.moveToElementText(n.get(0));_js.g.a().c(_a.a.V,"RecipientWellView.HighLightSelectedElement",function(){i.select();t.focus()})}}else{var u=window.getSelection();var r=document.createRange();r.selectNodeContents(n.get(0));u.removeAllRanges();_js.g.a().c(_a.a.V,"RecipientWellView.HighLightSelectedElement",function(){u.addRange(r);t.focus()})}};_rw.b.prototype={b:null,e:!1,p:!1,d:!1,a:function(n){this.e!==n&&(this.e=n);return n},cG:function(n){if(this.p!==n){this.p=n;this.hZ(n)}return n},j:function(n){n!==this.d&&(this.d=n);return n},h:function(){return this.Z().k(this.bc())},bz:function(){return!1},V:function(){_fce.b.prototype.V.call(this);this.bk(524288);this.B.bind("click",this.o);this.B.bind("cut",this.n)},K:function(){_fce.b.prototype.K.call(this);var n=this.F;this.b=n?n.a("ClipboardTextArea"):null},bu:function(){this.B.unbind("click",this.o);this.B.unbind("cut",this.n);try{_fce.b.prototype.bu.call(this)}catch(u){var t="UIObject.Remove threw while disposing RecipientWellView: "+u.message+u.stack;if(this.E()){var n=this.E();if(n){_rw.d.isInstanceOfType(n)&&(t+=" ReadWrite well ");if(n.t){t+=" NumRecipients:"+n.t.w.length+"[";for(var r=0;r<n.t.w.length;r++){var i=n.t.w[r];i&&i.h&&(t+=i.h.d()+",")}t+="]"}}}else t+="RecipientWellView datacontext is null";_js.Trace.logError(_a.a.V,t)}},cp:function(n){var t=n.a();if(n.e().nodeName!=="INPUT"||t===_ff.k.a)if(t===46||t===8){if(!$a(this.bc())&&!this.e){this.bp(t===46);n.b()}}else if(t===_ff.k.a){this.cr();n.b()}else if(t===_ff.k.b){this.cq();n.b()}},eQ:function(){_fce.b.prototype.eQ.call(this);_js.Trace.logInfo(_a.a.V,"RecipientWellView::FinishedRendering: Panel children count: {0}, data count: {1}",this.R.a.b(),this.eS())},bQ:function(){},i:function(){this.f(this.Z().c(this.Z().b()-1))},q:function(){if(!$a(this.bA()))if(this.b){var n=this.bA().E();this.b.c(n.e()+";");this.b.B.focus().select()}else _rw.b.a(this.bA().B,this.B)},ck:function(n){if(n.target.nodeName!=="DIV"&&n.target.nodeName!=="INPUT"){this.d&&this.q();return}this.bf(null)},ca:function(n){if(this.b&&this.b.B[0]===n.target){var t=this;_js.g.a().c(_a.a.V,"RecipientWellView.OnCut",function(){t.bp(!1)})}},eG:function(n){var t=this;_js.g.a().c(_a.a.V,"RecipientWellView.OnFocusOut",function(){if(t.E()&&(!document.activeElement||!t.z.contains(document.activeElement))){var n=t.E().y;!n||n.b()&&n.b().t()||t.E().l(null)}})},cO:function(){this.e?this.B.attr("tabIndex","0"):this.B.attr("tabIndex","-1");var n=256;this.bk(n)},bX:function(){return new _fce.d(window.document.createElement(this.hL()))},bp:function(n){if(this.bz()){var t=this.Z().k(this.bc());t&&(t+=n&&t+1<this.Z().b()?0:-1);this.Z().m(this.bc());this.Z().b()&&this.f(this.Z().c(t))}else{var i=this.Z().k(this.bc());i&&i--;this.Z().m(this.bc());this.Z().b()&&this.f(this.Z().c(i))}},cq:function(){if(this.Z().b())if(this.bc())if(this.h()<this.Z().b()-1)this.f(this.Z().c(this.h()+1));else{this.e||this.bf(null);this.bQ()}else this.f(this.Z().c(0))},cr:function(){this.Z().b()&&(this.bc()?this.h()>0?this.f(this.Z().c(this.h()-1)):this.d&&this.q():this.i())},f:function(n){this.bf(n);this.d&&this.q()}};_rw._TI=function(){};_rw._TI.$$cctor=function(){var f="ReadOnlyRecipientView";new _A(f,function(){_rw._TI.a[f]===undefined&&(_rw._TI.a[f]=[[[-1,0,["CurrentPersonaViewModel"],[_rw._TI.c],null,"DataContext",null,_rw._TI.d,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[0].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.y("PersonaView.ReadOnlyRecipientPopup");n.m=!0;return new _B(t,[n])},_rw.e,_js.b,function(n){return new _js.b(n)},!1,!1,!0,5,_rw._TI.a);var u="ReadOnlyRecipientViewAggregated";new _A(u,function(){_rw._TI.a[u]===undefined&&(_rw._TI.a[u]=[[[-1,0,["CurrentPersonaViewModel"],[_rw._TI.c],null,"DataContext",null,_rw._TI.d,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.y("PersonaView.ReadOnlyRecipientPopupAggregated");n.m=!0;return new _B(t,[n])},_rw.e,_js.b,function(n){return new _js.b(n)},!1,!1,!0,5,_rw._TI.a);var o="ReadOnlyRecipientWellExpandCollapseView._tid1";new _A(o,function(){_rw._TI.a[o]===undefined&&(_rw._TI.a[o]=[null,[[-1,5,["ShowEllipsis"],[_rw._TI.J],null,"hidden",null,null,0,_rw._TI.b(),null,null]]]);var n=_rw._TI._hf.childNodes[2].cloneNode(!0);var i=new _js.c(n.children[1]);var t=new _fce.c(n.children[0]);return new _B(n,[t,i]).R({ListPanel:t})},_rw.a,_rw.b,function(n){return new _rw.b(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_rw._TI.a);var e="ReadOnlyRecipientWellExpandCollapseView";new _A(e,function(){_rw._TI.a[e]===undefined&&(_rw._TI.a[e]=[[[-1,1,["AriaLabel"],[_rw._TI.M],null,"AriaLabel",null,_rw._TI.bd,1,null,null,null],[-1,0,["Recipients"],[_rw._TI.i],null,"DataSource",null,_rw._TI.m,1,null,null,null],[-1,0,["ReadOnlyRecipientTemplateId"],[_rw._TI.p],null,"DataTemplateId",null,_rw._TI.q,0,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.j],_rw._TI.k,"SelectedItem",_rw._TI.l,_rw._TI.n,2,null,null,null]]]);var i=_rw._TI._hf.childNodes[3].cloneNode(!0);var n=new _rw.b(i.children[0],_js.a.Instance.a(_y.a));n.a(!0);n.bv=!0;n.bG(!1);n.bm("span");n.bq("_rw_6");n.j(!0);n.C(0);var r=new _fc.g;var t=new _fc.c;t.A(_E.a(["EnterKeyCommand"],[_rw._TI.h],null,"Command",null,_rw._TI.o,1));t.i("ENTER");r.a([t]);n.G([r]);n.y("ReadOnlyRecipientWellExpandCollapseView._tid1");return new _B(i,[n])},_rw.a,_rw.c,function(n){return new _rw.c(n)},!1,!1,!0,5,_rw._TI.a);var t="ReadOnlyRecipientWellView._tid2";new _A(t,function(){_rw._TI.a[t]===undefined&&(_rw._TI.a[t]=[null]);var i=_rw._TI._hf.childNodes[4].cloneNode(!0);var n=new _fce.c(i.children[0]);return new _B(i,[n]).R({ListPanel:n})},_rw.a,_rw.b,function(n){return new _rw.b(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_rw._TI.a);var n="ReadOnlyRecipientWellView";new _A(n,function(){_rw._TI.a[n]===undefined&&(_rw._TI.a[n]=[[[-1,0,["Recipients"],[_rw._TI.i],null,"DataSource",null,_rw._TI.m,1,null,null,null],[-1,0,["ReadOnlyRecipientTemplateId"],[_rw._TI.p],null,"DataTemplateId",null,_rw._TI.q,0,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.j],_rw._TI.k,"SelectedItem",_rw._TI.l,_rw._TI.n,2,null,null,null]]]);var r=_rw._TI._hf.childNodes[5].cloneNode(!0);var t=new _rw.b(_B.a(r,[0,0]),_js.a.Instance.a(_y.a));t.a(!0);t.bv=!0;t.bG(!0);t.bK(5);t.bm("span");t.bq("_rw_a");t.j(!0);t.C(0);var u=new _fc.g;var i=new _fc.c;i.A(_E.a(["EnterKeyCommand"],[_rw._TI.h],null,"Command",null,_rw._TI.o,1));i.i("ENTER");u.a([i]);t.G([u]);t.y("ReadOnlyRecipientWellView._tid2");return new _B(r,[t])},_rw.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_rw._TI.a);var r="ReadWriteRecipientWellView._tid4";new _A(r,function(){_rw._TI.a[r]===undefined&&(_rw._TI.a[r]=[null,[[-1,4,null,null,null,"TextSelectionType",null,_rw._TI.be,0,null,null,0,2],[-1,1,["TemplatedParent","AriaLabelledBy"],[_rw._TI.r,_rw._TI.bc],null,"FindTextBoxAriaLabelledBy",null,_rw._TI.P,0,null,null,null],[-1,1,["TemplatedParent","AriaLabel"],[_rw._TI.r,_rw._TI.bb],null,"FindTextBoxAriaLabel",null,_rw._TI.O,0,null,null,null],[-1,0,["FindRecipientViewModel"],[_rw._TI.u],null,"FindRecipientViewModelForWell",null,_rw._TI.N,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[10].cloneNode(!0);var i=new _rw.f(t.children[1]);var n=new _fce.q(t.children[0]);n.H(0);n.N(!0);n.C(-1);return new _B(t,[n,i]).R({ClipboardTextArea:n,ListPanel:i})},_rw.d,_rw.j,function(n){return new _rw.j(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.h))},!1,!0,!1,0,_rw._TI.a);var i="ReadWriteRecipientWellView";new _A(i,function(){_rw._TI.a[i]===undefined&&(_rw._TI.a[i]=[[[-1,0,["Recipients"],[_rw._TI.i],null,"DataSource",null,_rw._TI.m,1,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.j],_rw._TI.k,"SelectedItem",_rw._TI.l,_rw._TI.n,2,null,null,null],[-1,0,["RecipientBeingEdited"],[_rw._TI.x],_rw._TI.D,"ItemBeingEdited",_rw._TI.S,_rw._TI.V,2,null,null,null],[-1,0,["TextBeingEdited"],[_rw._TI.B],_rw._TI.E,"FindControlText",_rw._TI.R,_rw._TI.T,2,null,null,null],[-1,0,["DisableActionsOnAllRecipients"],[_rw._TI.t],null,"DisableActions",null,_rw._TI.Q,1,null,null,!1],[-1,0,["ShouldShowHiddenRecipient"],[_rw._TI.A],null,"ShouldShowHiddenEditItem",null,_rw._TI.Y,1,null,null,!1],[-1,0,["UpdateFindControlPopupPosition"],[_rw._TI.C],null,"UpdateFindControlDropDownPosition",null,_rw._TI.Z,1,null,null,!1],[-1,0,["ResetFindControlPopupPosition"],[_rw._TI.y],null,"ResetFindControlDropDownPosition",null,_rw._TI.W,1,null,null,!1],[-1,0,["HandleBackspaceCommandAtEndOfReadWriteWell"],[_rw._TI.v],null,"HandleBackspaceCommandAtEndOfWell",null,_rw._TI.U,1,null,null,!1],[-1,0,["ResizeFindControl"],[_rw._TI.z],null,"ResizeFindControl",null,_rw._TI.X,1,null,null,!1],[-1,5,["IsFirefox"],[_rw._TI.w],null,"_rw_i",null,null,0,_rw._TI.b(),null,null]]]);var r=_rw._TI._hf.childNodes[11].cloneNode(!0);var n=new _rw.j(r.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.h));n.a(!1);n.H(41);n.S("ReadWriteRecipientView");n.j(!0);n.bm("span");n.bq("_rw_h");var u=new _fc.g;var t=new _fc.c;t.A(_E.a(["EnterKeyCommand"],[_rw._TI.h],null,"Command",null,_rw._TI.o,1));t.i("ENTER");u.a([t]);n.G([u]);n.y("ReadWriteRecipientWellView._tid4");return new _B(r,[n]).R({RecipientWell:n})},_rw.d,_rw.i,function(n){return new _rw.i(n)},!1,!1,!1,0,_rw._TI.a)};_rw._TI.s=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_rw_2'></span> </div><div> <span class='_rw_3'></span> </div><div> <div class='_rw_4'></div> <span class='_rw_7 ms-font-weight-regular ms-font-color-black'>...</span>  </div><div> <div class='_rw_5'></div> </div><div> <div class='_rw_8'></div>  </div><div> <div> <div class='_rw_9'></div> </div> </div><div> <span class='_rw_b ms-fwt-r'> <span class='_rw_d'></span> </span>  </div><div> <div class='_rw_c'></div> </div><div> <span class='_rw_e ms-font-m ms-font-color-themeDark ms-font-color-themePrimary-hover ms-bg-color-neutralLighter'> <span></span> </span> </div><div> <span class='_rw_f ms-fwt-r ms-font-color-themeDark ms-font-color-themePrimary-hover ms-bg-color-neutralLighter'> <span></span> </span> </div><div> <textarea class='_rw_j'></textarea> <div class='_rw_g'></div>  </div><div> <div autoid=\"_rw_0\" class='_rw_g'></div> </div>";_js.c.a().appendChild(n);return n};_rw._TI.c=function(n){return n.g};_rw._TI.J=function(n){return n.g()};_rw._TI.i=function(n){return n.t};_rw._TI.p=function(n){return n.dp()};_rw._TI.j=function(n){return n.y};_rw._TI.l=function(n){return n.bc()};_rw._TI.M=function(n){return n.cu()};_rw._TI.h=function(n){return n.dm()};_rw._TI.g=function(n){return n.P()};_rw._TI.f=function(n){return n.q()};_rw._TI.G=function(n){return n.r};_rw._TI.H=function(n){return n.Q()};_rw._TI.I=function(n){return n.R()};_rw._TI.F=function(n){return n.O()};_rw._TI.ba=function(n){return n.bg()};_rw._TI.u=function(n){return n.u()};_rw._TI.r=function(n){return n.L};_rw._TI.bc=function(n){return n.cC()};_rw._TI.bb=function(n){return n.cu()};_rw._TI.x=function(n){return n.A};_rw._TI.S=function(n){return n.m};_rw._TI.B=function(n){return n.bg};_rw._TI.R=function(n){return n.g};_rw._TI.t=function(n){return n.G};_rw._TI.A=function(n){return n.bs};_rw._TI.C=function(n){return n.bt};_rw._TI.y=function(n){return n.bo};_rw._TI.v=function(n){return n.bm};_rw._TI.z=function(n){return n.bp};_rw._TI.w=function(n){return n.cV()};_rw._TI.d=function(n,t){n.ba(t)};_rw._TI.m=function(n,t){n.bn(t)};_rw._TI.q=function(n,t){n.S(t)};_rw._TI.k=function(n,t){n.l(t)};_rw._TI.n=function(n,t){n.bf(t)};_rw._TI.bd=function(n,t){n.bb(t)};_rw._TI.o=function(n,t){n.k=t};_rw._TI.L=function(n,t){n.b=t};_rw._TI.K=function(n,t){n.a=t};_rw._TI.bf=function(n,t){n.bC(t)};_rw._TI.N=function(n,t){n.bf(t)};_rw._TI.be=function(n,t){n.cg(t)};_rw._TI.P=function(n,t){n.bG(t)};_rw._TI.O=function(n,t){n.bD(t)};_rw._TI.D=function(n,t){n.F(t)};_rw._TI.V=function(n,t){n.cX(t)};_rw._TI.E=function(n,t){n.I(t)};_rw._TI.T=function(n,t){n.cV(t)};_rw._TI.Q=function(n,t){n.cG(t)};_rw._TI.Y=function(n,t){n.dh(t)};_rw._TI.Z=function(n,t){n.di(t)};_rw._TI.W=function(n,t){n.da(t)};_rw._TI.U=function(n,t){n.cW(t)};_rw._TI.X=function(n,t){n.db(t)};_rw._TI.b=function(){_rw._TI.e||(_rw._TI.e=new _fc.k);return _rw._TI.e};RecipientWellComponent.registerClass("RecipientWellComponent",null,_a.iM);_rw.h.registerClass("_rw.h");_rw.a.registerClass("_rw.a",_a.bz,_y.eZ);_rw.d.registerClass("_rw.d",_rw.a);_rw.e.registerClass("_rw.e",_a.bz,_y.dp);_rw.g.registerClass("_rw.g",_rw.h,IRecipientWellViewModelFactory);_rw.k.registerClass("_rw.k",_js.b,_b.cj);_rw.b.registerClass("_rw.b",_fce.b);_rw.j.registerClass("_rw.j",_rw.b);_rw.i.registerClass("_rw.i",_js.b);_rw.f.registerClass("_rw.f",_fce.c);_rw.c.registerClass("_rw.c",_js.b);_rw._TI.registerClass("_rw._TI");RecipientWellComponent.$$cctor();_rw.d.d=new RegExp("([.*+?${}/])","g");_rw.d.c=new RegExp("[\\w-\\.!#%&'=~`/\\$\\|\\?\\*\\+\\{\\}]+@[\\w-\\.]+");_rw.d.a=_a.a.V;_rw.e.a=_a.a.V;_rw.a.d=_a.a.V;_rw.a.c=null;_rw.a.a=-1;_rw.a.e=null;_rw.f.a=_a.a.V;_rw._TI._hf=_rw._TI.s();_rw._TI.e=null;_rw._TI.a={};_rw._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.recipientwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.recipientwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
