try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['suiteextensions.js'] = (new Date()).getTime();
var AzureDataPipe=function(){function n(){this.unittestFlag=!1}n.prototype.getData=function(n,t){t.getDataCall(n,SuiteExtensionsDataStore.dataPipeSuccessCallback,SuiteExtensionsDataStore.dataPipeFailCallback)};return n}();var SharePointHostConfig=function(){function n(n,t,i){this.host="SharePoint";this.logging=new SharePointLogging;this.cultureName=n;this.resourceId=t;this.getDataCall=i}n.prototype.GetUserId=function(){var n="";typeof _spPageContextInfo!="undefined"&&(n=_spPageContextInfo.userId);return n};return n}();var OwaHostConfig=function(){function n(n,t,i){this.host="OutlookWebAccess";this.logging=new OwaLogging;this.cultureName=n;this.resourceId=t;this.getDataCall=i}n.prototype.GetUserId=function(){return""};return n}();var SharePointLogging=function(){function n(){}n.prototype.WriteDebugLog=function(n,t,i){WriteDebugLog(n,t,i)};n.prototype.WriteEngagementLog=function(n,t){WriteEngagementLog(n,t)};n.prototype.WriteStart=function(n){WriteStart(n)};n.prototype.WriteSuccess=function(n){WriteSuccess(n)};n.prototype.WriteFailure=function(n){WriteFailure(n)};return n}();var OwaLogging=function(){function n(){}n.prototype.WriteDebugLog=function(n,t,i){};n.prototype.WriteEngagementLog=function(n,t){};n.prototype.WriteStart=function(n){};n.prototype.WriteSuccess=function(n){};n.prototype.WriteFailure=function(n){};return n}();var ScriptOnDemand=function(){function n(){}n.LoadControlsJavascript=function(){if(n.isControlsJavascriptLoaded==!1){var t=document.createElement("script");t.src="/_layouts/15/online/scripts/SuiteExtensionsControls.js";t.type="text/javascript";navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0?t.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&InitializeIconControls()}:t.onload=function(){InitializeIconControls()};document.getElementsByTagName("head")[0].appendChild(t)}};n.isControlsJavascriptLoaded=!1;return n}();var SuiteExtensionsLocalStorage=function(){function n(){if(n.instance)throw new Error("Error: Instantiation failed: Use SuiteExtensionsLocalStorage.GetInstance() instead of new.");n.instance=this;this.lastUpdatedTime=+new Date-n.MaximumExpiredPeriod-1}n.GetInstance=function(){if(!n.Supported())return null;n.instance===null&&(n.instance=new n);return n.instance};n.prototype.SetItem=function(n,t){this.SetItemInternal(this.GetExtensionTypeKey(n),t);this.lastUpdatedTime=+new Date};n.prototype.GetItem=function(n){return this.GetItemInternal(this.GetExtensionTypeKey(n))};n.prototype.SetItemObject=function(n,t){this.SetItem(n,JSON.stringify(t))};n.prototype.GetItemObject=function(n){return JSON.parse(this.GetItem(n))};n.prototype.RemoveItem=function(n){this.RemoveItemInternal(this.GetExtensionTypeKey(n))};n.prototype.Expired=function(){var t=+new Date;return t-this.lastUpdatedTime>=n.MaximumExpiredPeriod?!0:!1};n.Supported=function(){try{return"localStorage"in window&&window.localStorage!==null}catch(n){return!1}};n.prototype.GetExtensionTypeKey=function(n){return"Office365.Extensions.Type."+n+"."+SuiteExtensionsDataStore.GetInstance().hostConfig.GetUserId()};n.prototype.SetItemInternal=function(n,t){localStorage.setItem(n,t)};n.prototype.GetItemInternal=function(n){return localStorage.getItem(n)};n.prototype.RemoveItemInternal=function(n){localStorage.removeItem(n)};n.MaximumExpiredPeriod=9e5;n.instance=null;return n}();var TestDataPipe=function(){function n(){}n.prototype.getData=function(n,t){var u=n;var r=[{type:"FileHandler",appId:"4463c52c-491f-4559-a2b1-8b688fca9eb9",displayName:"GPX App",addInId:"12b4c4f2-d1c5-c12a-6245-1b5c3fdd85b1",properties:{extension:"gpx",fileIcon:"https://gpxfileapp-int.azurewebsites.net/content/pinpoint-16x16.png",openUrl:"https://gpxfileapp-int.azurewebsites.net/FileHandler/Open",previewUrl:"https://gpxfileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"6f7b9f0c-e0f9-41f9-9bff-bcf66d599c2b",displayName:"TEST or INI App",addInId:"5f0b526b-f1e4-4def-9d43-3b0d28d4ff53",properties:{extension:"test",fileIcon:"https://testorinifileapp-int.azurewebsites.net/content/test.png",openUrl:"https://testorinifileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"6f7b9f0c-e0f9-41f9-9bff-bcf66d599c2b",displayName:"TEST or INI App",addInId:"e94ca6fe-66c3-4212-b4db-3c32c2b00d85",properties:{extension:"ini",previewUrl:"https://testorinifileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"f02cf431-6830-4090-9e3e-f8526e676852",displayName:"DRW App",addInId:"b0497361-9dff-4fcf-a8ac-ae11b5f27f1c",properties:{extension:"drw",openUrl:"https://drwfileapp-int.azurewebsites.net/FileHandler/Open",previewUrl:"https://drwfileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"523f34b4-200f-4239-aa3d-67682bf24bdc",displayName:"OFF App",addInId:"55d5929b-e6d3-4518-8297-98078e4f0ee8",properties:{extension:"off",fileIcon:"https://offfileapp-int.azurewebsites.net/content/off.png",openUrl:"https://offfileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"f266399a-ab8d-4407-9f2d-797a35a75d3f",displayName:"OFF or OFFICE App",addInId:"5afb40fd-3604-4cbe-b991-82d01a66a29b",properties:{extension:"off",fileIcon:"https://offorofficefileapp-int.azurewebsites.net/content/off-mt.png",previewUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"f266399a-ab8d-4407-9f2d-797a35a75d3f",displayName:"OFF or OFFICE App",addInId:"3a3ff70e-23c7-4dae-8bad-43c314a98b82",properties:{extension:"office",fileIcon:"https://offorofficefileapp-int.azurewebsites.net/content/office.png",previewUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/Preview",openUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"0c21f706-6071-4b2c-9273-59ea1f486eb9",properties:{extension:"ext1",previewUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Preview",openUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"88551be5-def0-4aeb-b2b6-6bf2e259f3ea",properties:{extension:"ext2",fileIcon:"https://extfileapp-int.azurewebsites.net/content/ext2.png",openUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"da4b51ef-4b12-434a-b79d-0e930db6f133",properties:{extension:"ext3",fileIcon:"https://extfileapp-int.azurewebsites.net/content/ext3.png",previewUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"92f9bcf2-aa0f-4a68-8714-c648af3fb715",properties:{extension:"ext4",fileIcon:"https://extfileapp-int.azurewebsites.net/content/ext4.png"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"7fed2d59-55b3-490d-819c-474dfd772900",properties:{extension:"ext5",previewUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Preview",openUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Open"}}];var i=JSON.stringify(r);SuiteExtensionsDataStore.dataPipeSuccessCallback(u,i)};return n}();var SuiteExtensionsDataStore=function(){function n(){this.extensionsDictionary={};if(n._instance)throw new Error("Error: Instantiation failed: Use SuiteExtensionsDataStore.GetInstance() instead of new.");n._instance=this;this.localStorage=SuiteExtensionsLocalStorage.GetInstance();this.useAzureDataPipe=!1}n.InitializeSuiteExtensionsDataStore=function(t,i,r,u,f){var e=n.GetInstance();e.SetHost(t,i,r,f);e.SetDataPipe(u);e.GetDataFromLocalStorage()};n.GetInstance=function(){n._instance===null&&(n._instance=new n);return n._instance};n.dataPipeSuccessCallback=function(t,i){var r=n.GetInstance();try{r.hostConfig.logging.WriteStart("FED_StartSetLocalStorage");r.localStorage.SetItem(t,i);r.hostConfig.logging.WriteSuccess("FED_SuccessSetLocalStorage")}catch(u){r.hostConfig.logging.WriteFailure("FED_FailedSetLocalStorage");r.hostConfig.logging.WriteDebugLog("FED_FailedSetLocalStorage",!1,"Failed to set local storage in this browser "+u.message)}r.GetDataFromStorageAndLoadControlsJS(t,"FED_StartLoadControlsScriptOnNewData","FED_SuccessLoadControlsScriptOnNewData")};n.dataPipeFailCallback=function(t){n.GetInstance().hostConfig.logging.WriteDebugLog("FED_DataRetrivalFailed",!1,"Failed to get the add-in data "+t.message)};n.prototype.SetDataPipe=function(n){this.useAzureDataPipe=n;this.dataPipe=this.useAzureDataPipe===!0?new AzureDataPipe:new TestDataPipe};n.prototype.SetHost=function(n,t,i,r){this.hostConfig=n=="SharePoint"?new SharePointHostConfig(t,i,r):(n="OWA")?new OwaHostConfig(t,i,r):null};n.prototype.GetDataFromLocalStorage=function(){var n="FileExtensionDefinitions";if(this.localStorage!=null){this.GetDataFromStorageAndLoadControlsJS(n,"FED_StartLoadControlsScript","FED_SuccessLoadControlsScript");this.localStorage.Expired()&&this.dataPipe.getData(n,this.hostConfig)}else{this.hostConfig.logging.WriteEngagementLog("FED_LocalStorageNotSupportedInBrowser",null);var t=navigator.appCodeName+navigator.appName+navigator.appVersion;this.hostConfig.logging.WriteDebugLog("FED_LocalStorageNotSupportedInBrowser",!1,"Local Storage is not supported in this browser: "+t)}};n.prototype.GetFileHandlerProperty=function(n,t){var u=this.GetExtensions("FileExtensionDefinitions");if(u!=null)for(var r=0;r<u.length;r++){var i=u[r];if(i.properties.extension==t)return n!="appId"?i.properties[n]:i[n]}return null};n.prototype.GetExtensions=function(n){return this.extensionsDictionary[n]?this.extensionsDictionary[n]:null};n.prototype.GetDataFromStorageAndLoadControlsJS=function(n,t,i){if(this.localStorage!=null){try{this.hostConfig.logging.WriteStart("FED_StartGetLocalStorageItem");var r=this.localStorage.GetItemObject(n);this.hostConfig.logging.WriteSuccess("FED_SuccessGetLocalStorageItem")}catch(u){this.hostConfig.logging.WriteFailure("FED_FailedGetLocalStorageItem");this.hostConfig.logging.WriteDebugLog("FED_FailedGetLocalStorageItem",!1,"GetItemObject method for local storage failed")}if(r!=null){this.extensionsDictionary[n]=r;this.hostConfig.logging.WriteStart(t);ScriptOnDemand.LoadControlsJavascript();this.hostConfig.logging.WriteSuccess(i)}}};n._instance=null;return n}();var ControlType;(function(n){n[n.Icon=0]="Icon";n[n.Preview=1]="Preview";n[n.Open=2]="Open"})(ControlType||(ControlType={}));var SuiteExtensionsControlFactory=function(){function n(){}n.CreateControl=function(n,t){var i=SuiteExtensionsDataStore.GetInstance();var r=i.GetFileHandlerProperty("appId",n);if(typeof SuiteExtensionsControl!="undefined"&&r!=null)switch(t){case 0:var s=i.GetFileHandlerProperty("fileIcon",n);return new IconControl(n,r,s);case 1:var h=i.GetFileHandlerProperty("previewUrl",n);var u=i.hostConfig.resourceId;var f=i.hostConfig.cultureName;var e=i.hostConfig.host;return new PreviewControl(n,r,h,u,f,e);case 2:var o=i.GetFileHandlerProperty("openUrl",n);var u=i.hostConfig.resourceId;var f=i.hostConfig.cultureName;var e=i.hostConfig.host;return new OpenControl(n,r,o,u,f,e);default:return null}else return null};return n}();
window.scriptsLoaded['suiteextensions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['suiteextensions.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
