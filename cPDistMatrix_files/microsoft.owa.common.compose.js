try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.common.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_cmc");_cmc.z=function(n,t){this.e=n;this.f=t};_cmc.z.prototype={e:null,f:!1,d:function(){return this.e},c:!1,b:function(){return this.c},a:function(n){this.c=n;return n}};_cmc.o=function(n,t){this.a=n;this.b=t};_cmc.o.prototype={a:null,b:null};_cmc.X=function(){};_cmc.X.prototype={k:function(){return!0}};_cmc.H=function(){};_cmc.H.prototype={a:null,b:null,k:function(){return!1}};_cmc.P=function(){};_cmc.P.prototype={b:0,a:function(n){this.b=n;return n},k:function(){return!1}};_cmc.Q=function(){};_cmc.Q.prototype={b:0,a:function(n){this.b=n;return n},k:function(){return!1}};_cmc.d=function(n,t,i){this.s=n;this.n=t;this.p=i};_cmc.d.prototype={n:null,b:function(){return this.n},p:!1,d:function(){return this.p},s:0,a:function(){return this.s},m:!1,j:function(){return this.m},l:!1,h:function(){return this.l},o:!1,g:function(){return this.o},t:!1,e:function(){return this.t},u:null,i:function(){return this.u},k:function(){return!0}};_cmc.I=function(n){this.a=n};_cmc.I.prototype={a:null,k:function(){return!0}};function CommonComposeComponent(){}CommonComposeComponent.$$cctor=function(){_a.p.a().a(CommonComposeComponent)};CommonComposeComponent.prototype={a:function(n,t,i){n.e(_cmc.r).a()},b:function(){return null}};_cmc.j=function(){};_cmc.j.b=function(n,t,i,r,u){var f=new _g.bg;f.BlockStatus=!1;f.ConversationId=n.ConversationId;var e=_a.c.l(_a.c.a());f.DateTimeCreated=e;f.DateTimeReceived=e;f.DateTimeSent=e;var h=t.k();if(h){f.DisplayTo=_cmc.j.a(h.c);f.ToRecipients=h.f()}var s=t.m();if(s){f.DisplayCc=_cmc.j.a(s.c);f.CcRecipients=s.f()}var c=n.ConversationTopic;var o=new _bc.g;f.ExtendedProperty=new Array(3);f.ExtendedProperty[0]=new _g.bq;f.ExtendedProperty[0].ExtendedFieldURI=_g.c.bd();f.ExtendedProperty[0].Value=c;f.ExtendedProperty[1]=new _g.bq;f.ExtendedProperty[1].ExtendedFieldURI=_g.c.T();f.ExtendedProperty[1].Value="3";f.ExtendedProperty[2]=new _g.bq;f.ExtendedProperty[2].ExtendedFieldURI=_g.c.X();f.ExtendedProperty[2].Value=o.d;f.Flag=new _g.eB;f.Flag.FlagStatus=t.bu()?t.bu().a():"NotFlagged";f.From=i;f.HasAttachments=!!t.T()&&t.T().b()>0;f.HasBlockedImages=t.bl.HasBlockedImages;f.Importance=t.bB();f.InstanceKey="INSK:"+o.a;f.InternetMessageId=t.bl.InternetMessageId;f.IsDeliveryReceiptRequested=undefined===t.bl.IsDeliveryReceiptRequested?!1:t.bl.IsDeliveryReceiptRequested;f.IsDraft=!1;f.IsRead=!0;f.IsReadReceiptRequested=undefined===t.bl.IsReadReceiptRequested?!1:t.bl.IsReadReceiptRequested;f.ItemClass="IPM.Note";f.ItemId=o.b;f.LastModifiedTime=e;f.ParentFolderId=_g.t.a(u).bl.FolderId;f.Preview=t.w().bl.Value;f.ResponseObjects=new Array(3);f.ResponseObjects[0]=new _g.cA;f.ResponseObjects[1]=new _g.bX;f.ResponseObjects[2]=new _g.cw;f.Sender=r;f.Sensitivity=t.bH();f.Subject=_nbs.a.Ke+" "+c;f.UniqueBody=new _g.G("HTML",t.w().bl.Value);f.Conversation=n;return f};_cmc.j.a=function(n){var t=_cmc.j.c.a(n,!1);_cmc.j.d(t);return t};_cmc.j.d=function(n){!_js.d.a(n)&&n.length>2&&(n=n.substr(0,n.length-2));return n};_cmc.s=function(n,t){this.f=n;this.e=t};_cmc.s.prototype={f:null,e:null,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.k=function(n,t){this.f=n;this.e=t};_cmc.k.prototype={f:null,e:null,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.B=function(n,t){this.f=n;this.e=t};_cmc.B.prototype={f:null,e:null,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.t=function(n,t){this.f=n;this.e=t};_cmc.t.prototype={f:null,e:null,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.V=function(n,t){this.f=n;this.e=t};_cmc.V.prototype={f:null,d:function(){return this.f},e:0,c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.q=function(n,t){this.f=n;this.e=t};_cmc.q.prototype={f:null,e:null,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.G=function(n,t){this.g=n;this.f=t;this.e=!1};_cmc.G.prototype={g:null,f:null,e:!1,d:function(){return this.g},c:function(){return this.f},b:function(){return this.e},a:function(n){this.e=n;return n}};_cmc.l=function(n,t){this.f=n;this.e=t};_cmc.l.prototype={f:null,e:0,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.w=function(n){if(_js.d.a(n))throw Error.argument("coercionType","coercionType cannot be null or empty.");if(n==="text"||n==="html")this.b=n;else throw Error.argument("coercionType","Unsupported coercionType value.");};_cmc.w.prototype={b:null,a:null,k:function(){return!1}};_cmc.c=function(n){this.e=n};_cmc.c.prototype={d:null,c:function(){return this.d},a:function(n){this.d=n;return n},k:function(){return!1},e:!1,b:function(){return this.e}};_cmc.n=function(n){this.b=n};_cmc.n.prototype={b:null,a:function(){return this.b},k:function(){return!0}};_cmc.L=function(n){this.b=n};_cmc.L.prototype={b:!1,a:function(){return this.b},k:function(){return!0}};_cmc.f=function(n){this.a=n};_cmc.f.prototype={a:null,k:function(){return!0}};_cmc.p=function(n){this.a=n};_cmc.p.prototype={a:null,k:function(){return!0}};_cmc.J=function(n,t,i,r,u,f){this.g=n;this.f=t;this.e=i;this.c=r;this.b=u;this.d=f};_cmc.J.prototype={g:null,f:null,e:null,c:null,b:null,a:function(){return this.b},d:null,k:function(){return!0}};_cmc.x=function(n,t,i,r){this.b=n;this.a=t;this.d=i;this.c=r};_cmc.x.prototype={b:null,a:null,d:0,c:0,k:function(){return!0}};_cmc.y=function(n,t,i,r){this.a=n;this.b=t;this.d=i;this.c=r};_cmc.y.prototype={a:null,b:null,d:0,c:0,k:function(){return!0}};_cmc.m=function(n,t,i,r,u){this.c=n;this.e=t;this.a=i;this.d=r;this.b=u};_cmc.m.prototype={c:null,e:null,a:null,d:0,b:null,k:function(){return!0}};_cmc.e=function(n){if(n==="text"||n==="html")this.b=n;else throw Error.argument("coercionType","Unsupported coercionType value.");};_cmc.e.prototype={e:null,b:null,a:null,d:!1,f:function(n){this.d=n;return n},c:function(n){if(n==="subject"||n==="body")this.e=n;else throw Error.argument("sourceProperty","Unsupported sourceProperty value.");return n},k:function(){return!1}};_cmc.g=function(n,t,i){_cmc.g.initializeBase(this,[0,n,i]);this.l=t};_cmc.g.prototype={v:null,q:!1,r:!1,f:function(n){this.r=n;return n},c:function(n){if(n==="subject"||n==="body")this.v=n;else throw Error.argument("sourceProperty","Unsupported sourceProperty value.");return n}};_cmc.K=function(n,t){_cmc.K.initializeBase(this,[3,n,t]);this.l=!1};_cmc.K.prototype={c:!1};_cmc.C=function(){};_cmc.C.prototype={k:function(){return!0}};_cmc.F=function(n,t){this.f=n;this.e=t};_cmc.F.prototype={f:null,e:null,c:function(){return this.e},d:function(){return this.f},b:function(){return!1},a:function(n){return n}};_cmc.O=function(n,t){this.f=n;this.e=t};_cmc.O.prototype={f:null,e:null,c:function(){return this.e},d:function(){return this.f},b:function(){return!1},a:function(n){return n}};_cmc.u=function(n){this.c=n};_cmc.u.prototype={c:null,d:function(){return this.c},b:function(){return!1},a:function(n){return n}};_cmc.v=function(n,t){this.e=n;this.c=t};_cmc.v.prototype={e:null,c:!1,d:function(){return this.e},b:function(){return this.c},a:function(n){this.c=n;return n}};_cmc.W=function(n,t,i,r){this.j=n;this.h=t;this.g=i;this.i=r};_cmc.W.prototype={j:null,h:!1,g:null,i:!1,c:function(){return this.h},e:function(){return this.g},f:function(){return this.i},d:function(){return this.j},b:function(){return!1},a:function(n){return n}};_cmc.U=function(n,t){_cmc.U.initializeBase(this);this.a=n;this.c=t};_cmc.U.prototype={a:null,c:null,b:function(n){if(this.a){var t=this;_js.g.a().a(_a.a.c,"ComposeCopyPasteViewModel.OnAttachViaString",function(){var i=_a.d.b(_a.a.c,"AttachmentCopyAndPasteItemAttachments");t.a.v(n,null,i)},0)}}};_cmc.r=function(){};_cmc.r.prototype={a:function(n,t){return new _cmc.U(n,t)}};_cmc.T=function(){_cmc.T.initializeBase(this);this.c="ComposeUsage"};_cmc.T.prototype={a:function(n){_cmc.Y.prototype.k.call(this,n)}};_cmc.S=function(n,t){_cmc.S.initializeBase(this,[1,t]);this.a.ComposeControl=n};_cmc.S.prototype={b:function(n){this.a.Duration=n},c:function(n){this.a.Total=n}};_cmc.Y=function(){this.m()};_cmc.Y.prototype={b:null,h:null,f:null,l:0,j:0,e:!1,g:null,c:null,k:function(n){if(this.e&&n&&n.length>0){if(n in this.b){var t=this.b[n];this.b[n]=t+1}else this.b[n]=1;this.j++}},i:function(n){this.g=n;this.h=_a.c.get_utcNow();this.e=!0},d:function(){if(this.e){this.f=_a.c.get_utcNow();this.l=this.f.h()-this.h.h();this.n()}this.m()},m:function(){this.b=null;this.b={};this.j=0;this.h=null;this.f=null;this.e=!1},n:function(){if(this.c&&this.g){var n=new _cmc.S(this.g,this.c);n.b(this.l);n.c(this.j);var r=this.b;for(var i in r){var t={key:i,value:r[i]};n.a[t.key]=t.value}_a.l.d.b()&&_a.l.d.a(n)}}};_cmc.a=function(n,t,i,r){_cmc.a.initializeBase(this,[n]);this.j=t;this.cg(2);this.W().a(22);n.setAttribute("contenteditable","true");n.setAttribute("spellcheck","true");n.setAttribute("useinlinestyle","true");this.m=r&&r.g()?"rtl":"ltr";n.setAttribute("dir",this.m);n.style.outline="none";this.bf(n,i.a());this.bk(360)};_cmc.a.prototype={j:null,i:null,F:!1,a:null,n:!1,m:null,c:null,e:null,d:null,f:null,h:function(n){if(n){var i=this.i===n;var t=_y.dt.isInstanceOfType(n)?n.b():!1;this.i=n;t||this.bm(this.i);i||this.bt("CallContext")}return n},cc:function(n){this.F=n;this.bt("IsInitialized");return n},R:function(n){this.c||(this.c=new _js.r);this.c.b(n)},bW:function(n){this.c&&this.c.c(n)},Z:function(n){this.e||(this.e=new _js.r);this.e.b(n)},bY:function(n){this.e&&this.e.c(n)},S:function(n){this.d||(this.d=new _js.r);this.d.b(n)},bX:function(n){this.d&&this.d.c(n)},bc:function(n){this.f||(this.f=new _js.r);this.f.b(n)},bZ:function(n){this.f&&this.f.c(n)},t:function(){var n=this.o();return n?n.toString():null},u:function(){var n=this.o();return n?n.startContainer:null},bj:function(){this.k("bold",!1,null)},bM:function(){this.k("italic",!1,null)},cd:function(){this.k("underline",!1,null)},bn:function(n){this.k("forecolor",!1,n)},bg:function(n){this.k("backcolor",!1,n)},bq:function(){var t=null;var n=this.p();if(!this.s(n.getRangeAt(0)))return null;if(n.focusNode.hasChildNodes()){var i=n.focusNode.getElementsByTagName("a");i.length>0&&n.focusNode.childNodes[n.focusOffset-1].nodeName.toLowerCase()==="a"&&(t=n.focusNode.childNodes[n.focusOffset-1])}else n.focusNode.previousSibling&&n.focusNode.previousSibling.nodeName.toLowerCase()==="a"&&(t=n.focusNode.previousSibling);return t},g:function(n){var t=this.p();t.removeAllRanges();t.addRange(n)},o:function(){var u=this.b();if(u){var i=u.startContainer;var t=u.startOffset;if(!t)return null;if(i.nodeName==="#text"){var f=t;var n=document.createRange();n.setEnd(i,f);for(;;){t--;n.setStart(i,t);var r=n.toString();if(r.startsWith(" ")||r.startsWith(String.fromCharCode(160))||r.startsWith(String.fromCharCode(8203))){n.setStart(i,t+1);return n}else if(!t)return n}}}return null},ca:function(n){var t=this.o();if(t){t.deleteContents();this.q(t,$(n));t.collapse(!1);this.g(t)}},bG:function(){return!!this.l()},bR:function(n){this.c&&this.c.a(n)},bU:function(n){this.e&&this.e.a(n)},bT:function(n){this.d&&this.d.a(n)},bV:function(n){this.f&&this.f.a(n)},dr:function(n){if(this.n)_js.Trace.logInfo(this.I(),"selectionRangeAtLastBlur is preserved on focus");else{this.a=null;_js.Trace.logInfo(this.I(),"selectionRangeAtLastBlur set to null on focus")}this.bR(new _cmc.u(this))},X:function(){_js.Trace.logInfo(this.I(),"Focus in CED");this.n=!0;var t=_js.c.prototype.X.call(this);this.n=!1;_js.Trace.logInfo(this.I(),t?"can focus":"cannot focus");_js.Trace.logInfo(this.I(),this.a?"selectionRangeAtLastBlur is not null":"selectionRangeAtLastBlur is null");if(t&&this.a&&this.s(this.a)){this.g(this.a);_js.Trace.logInfo(this.I(),"focus set to selectionRangeAtLastBlur");this.a=null}else if(t&&_a.UserAgent.getInstance().E){var n=this.l();if(n&&n.startContainer===this.B[0]&&!n.startOffset&&n.endContainer===this.B[0]&&!n.endOffset){var r=this.B.find("p");if(r.length>0){var i=r[0];n.setStart(i,0);n.setEnd(i,0);this.g(n)}}}return t},bK:function(n){if(!this.r(n))return!1;for(var t=n;t&&t!==this.B[0];)if(_js.d.a(t.tagName)||t.tagName.toLowerCase()!=="table")t=t.parentNode;else return!0;return!1},b:function(){var n=null;var t=null;try{var i=this.bp();if(!this.r(i)&&this.a)n=this.a;else{this.j.b()||(n=this.l());if(!n){t=i;this.B.focus();n=this.l()}}}catch(r){_js.Trace.logException(_cmc.a.a,r,"Exception encountered attempting to get selection for insertion")}finally{$a(t)||t.focus()}return n},J:function(){_js.c.prototype.J.call(this);this.B[0].parentNode.appendChild($('<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>')[0]);var n=new _cmc.c(!0);n.d=this.v();this.h(n);_js.Trace.logInfo(_cmc.a.a,"sending get content callback with content on activation with content "+n.d);this.cc(!0)},dg:function(n){var i=n.e();if(i.tagName==="A"&&n.j()){var t=new _cmc.G(this,n.e());this.bT(t);t.e&&this.fb(n)}_js.c.prototype.dg.call(this,n)},cp:function(n){_js.c.prototype.cp.call(this,n);n.a()===8&&n.c();if(n.a()===9)if(n.h()){this.j.b()&&this.eq(null);var i=new _cmc.v(this,!0);this.bU(i);i.b()&&this.fb(n)}else if(!n.l()){var t=new _cmc.z(this,!0);this.bV(t);t.b()&&this.fb(n)}},eq:function(n){_js.c.prototype.eq.call(this,n);var t=this.l();if(t){this.a=t;_js.Trace.logInfo(this.I(),"selectionRangeAtLastBlur is set to current selection")}},v:function(){var n=this.B.clone();n.removeAttr("contenteditable");n.removeAttr("spellcheck");n.removeClass();n.css("min-height","");n.css("height","");n.css("overflow","");n.css("box-sizing","");n.css("outline","");n.removeAttr("tabindex");n.removeAttr("aria-label");n.removeAttr("id");n.removeAttr("autoid");n.removeAttr("class");n.removeAttr("role");var t=n.wrap("<div>").parents().html();this.j.b()&&document.documentMode===11&&(t=t.replace(_cmc.a.e,""));t=String.format('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">{0}</head><body dir="{1}">{2}</body></html>','<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>',this.m,t);_js.Trace.logInfo(_cmc.a.a,"Got full content from CED: "+t);return t},bp:function(){var n=null;var t=this.E()&&_y.F.isInstanceOfType(this.E())?this.E().c():null;n=t?t.document.activeElement:document.activeElement;return n},bm:function(n){if(_y.bL.isInstanceOfType(n)){var r=this.v();n.a(r);_js.Trace.logInfo(_cmc.a.a,"executing get content call context, content="+r)}else if(_y.dq.isInstanceOfType(n)){var u=n.a();var h=this.K(u);var s=this.w(h);this.B.html(s);_js.Trace.logInfo(_cmc.a.a,"executing set content call context, content="+u)}else if(_y.dm.isInstanceOfType(n)){var t=n;var i=null;if(t.d()){var c=n.b();var f=this.K(c);var e=this.w(f);i=$("<div>"+e+"</div>").contents()}else{var o=$("<div/>").text(t.b()).html();i=$("<div>"+o+"</div>").contents()}t.a()===1?this.bA(i):t.a()===2?this.y(i,t.g()):t.a()===3?this.bQ(i):this.bD(i,t.j(),t.h())}else if(_y.dr.isInstanceOfType(n))this.B.focus();else throw Error.notImplemented("content editable div does not support call context type "+Object.getType(n).getName());},bf:function(n,t){var u="Calibri";var f="#000000";var i="12";if(t){t.bl.ComposeFontName&&(u=t.bl.ComposeFontName);t.bl.ComposeFontColor&&(f=t.bl.ComposeFontColor);t.bl.ComposeFontSize>0&&(i=t.bl.ComposeFontSize<_cmc.b.b.length?_cmc.b.b[t.bl.ComposeFontSize]:t.bl.ComposeFontSize.toString())}var r=n.style;r.fontSize=i+"pt";r.color=f;r.backgroundColor="#FFFFFF";var e=this.bv(u);r.fontFamily=e;_js.Trace.logInfo(_cmc.a.a,"applying user default font "+u+", color "+f+", size "+i+", family "+e)},bv:function(n){for(var t=0;t<_cmc.b.a.length;++t)if(_cmc.b.a[t][0]===n)return _cmc.b.a[t][1];return n},bz:function(n){for(var t=0;t<_cmc.b.a.length;++t)if(_cmc.b.a[t][0]===n){var i;if(i=_cmc.b.a[t][2])return i}return null},l:function(){var t=this.p();if(t)try{var n=t.getRangeAt(0);if(this.s(n))return n}catch(i){_js.Trace.logInfo(_cmc.a.a,"CED: TryGetSelectionRange: Ignoring an exception. Details: "+i.message)}return null},s:function(n){if($a(n.commonAncestorContainer))return!1;var t=n.commonAncestorContainer;return this.r(t)},r:function(n){var r=$(n);var i=this.B;var t=r.closest(i);return t.length?!0:!1},q:function(n,t){for(var u=t.get(),e=u.length,i=0;i<e;++i){var r=u[i];n.collapse(!1);if($a(n.insertNode))$a(n.pasteHTML)||n.pasteHTML(r.innerHTML);else{var f=document.importNode(r,!0);n.insertNode(f);n.setStartAfter(f)}}},y:function(n,t){_js.Trace.logInfo(_cmc.a.a,"Appending element. Html: "+n.html()+"");var u=this.B.find('div[id^="Signature"]');if(t&&u&&u.length>0){var r=u.get(0);var i=document.createRange();i.selectNodeContents(r.previousSibling?r.previousSibling:r);i.collapse(!0);this.q(i,n)}else this.B.append(n)},bA:function(n){_js.Trace.logInfo(_cmc.a.a,"Prepending element. Html: "+n.html()+"");this.B.prepend(n)},bQ:function(n){_js.Trace.logInfo(_cmc.a.a,"Overwriting element. Html: "+n.html()+"");this.B.empty().prepend(n)},bD:function(n,t,i){var r=this.b();if(r){_js.Trace.logInfo(_cmc.a.a,"Got a good selection range. Calling InsertElementAtRange");!r.collapsed&&i&&r.deleteContents();var u=r.cloneRange();this.q(r,n);if(t){_js.Trace.logInfo(_cmc.a.a,"Set new selection after insertion");r.collapse(!1);this.g(r)}else{_js.Trace.logInfo(_cmc.a.a,"Restore original selection range after insertion");this.g(u)}}else{_js.Trace.logInfo(_cmc.a.a,"Could not get a Range to insert content, so appending the element to the end of the CED");this.y(n,!0)}},k:function(n,t,i){this.X();if(this.E()&&_y.F.isInstanceOfType(this.E())){var r=this.E().c();if(r){r.document.execCommand(n,t,i);return}}document.execCommand(n,t,i)},K:function(n){_js.Trace.logInfo(this.I(),"RemovePStyles: RemovePStyles");return n.replace(_cmc.a.c,"$1").replace(_cmc.a.d,"")},w:function(n){return this.j.b()&&document.documentMode===11?n.replace(_cmc.a.b,"<p>&#8203;</p>"):n},p:function(){if(this.E()&&_y.F.isInstanceOfType(this.E())){var n=this.E().c();if(n)return n.getSelection()}return window.getSelection()}};_cmc.A=function(n,t,i,r,u){this.m=Function.createDelegate(this,this.bU);this.n=Function.createDelegate(this,this.bV);this.o=Function.createDelegate(this,this.bW);this.bc=Function.createDelegate(this,this.bY);this.bf=Function.createDelegate(this,this.bZ);this.Z=Function.createDelegate(this,this.bX);this.t=Function.createDelegate(this,this.ca);_cmc.A.initializeBase(this,[n]);this.p=$(n);this.y("EntitySuggesterView");this.q=t;this.v=i;_cmc.A.a(r);this.cd(r);this.w=u};_cmc.A.a=function(n){n.F(!1);n.d(!0);n.G(1);n.H(!0);n.k(!0)};_cmc.A.prototype={e:!1,p:null,f:0,q:null,i:null,c:null,b:null,v:null,w:null,R:function(){return!!this.w&&this.w.a().i().Enabled},a:function(){return this.i},k:function(n){this.i=n;return n},bu:function(){this.c.j(this.t);this.c=null;if(this.p){this.ce();this.p=null}_js.b.prototype.bu.call(this)},V:function(){_js.b.prototype.V.call(this);this.b=this.p.find("div").first();this.bR()},bv:function(n){var r=[];if(this.f===2&&this.q&&this.q.f()){var o=this.q.f().c();if(o&&o.length>0)for(var s=o,c=s.length,e=0;e<c;++e){var h=s[e];var i=h.bl.Name;i.startsWith("#")&&i.length>1&&(i=i.substr(1));r.push(i)}}this.b.empty();var t=new _ff.e;if(n)for(var l=n.toLowerCase(),u=0;u<r.length;u++)r[u].toLowerCase().indexOf(l)||t.c(r[u]);else t.h(r);if(t.d.length>0){for(var f=0;f<t.d.length;f++)$(document.createElement("div")).attr("class","entity-suggester-item").text(t.d[f]).appendTo(this.b);this.b.show()}else this.b.hide()},bz:function(){var t=this.j();if(!_js.d.a(t)){var n=t.substr(1);if(this.f===1){if(this.c){this.c.b(n);this.c.B().a()}}else this.bv(n)}},cc:function(n){var r=5;var b=20;this.f=n;var f,u;var v,a;this.S(v={val:f},a={val:u}),f=v.val,u=a.val;var y=this.i.offset();var i=y.top+u+b;var t=y.left+f;if(n===1){if(this.c){var p,l;this.bg(p={val:i},l={val:t}),i=p.val,t=l.val;var o=this.c.bb();o.a(t);o.b(i)}}else{var e=this.i[0].ownerDocument.body.clientWidth;var c=this.b.width();t+c+r>e&&(t=e-c-r);t=Math.max(r,t);var h,s;this.bg(h={val:i},s={val:t}),i=h.val,t=s.val;this.bv(null);this.b.show();var w={top:i,left:t};this.b.offset(w)}},bg:function(n,t){},d:function(){this.e=!1;this.u()},u:function(){this.f===1?this.c&&this.c.Z().a():this.b&&this.b.hide()},bq:function(){if(this.f===1)this.c&&this.c.y().a();else{this.u();var t=this.b.find("."+"ms-bg-color-themeLight");var n=t.text();_js.d.a(n)&&(n=this.j().substr(1));this.h(n)}},bT:function(n){if(this.f===1)this.c&&(n===38?this.c.W().a():this.c.V().a());else{var i=this.b.find("."+"entity-suggester-item");var u=i.length;var r=this.b.find("."+"ms-bg-color-themeLight");var t=r.length>0?i.index(r[0]):-1;n===38?t=t===-1||!t?u-1:t-1:n===40&&(t=t===-1||t===u-1?0:t+1);i.removeClass("ms-bg-color-themeLight");var f=i.eq(t);f.addClass("ms-bg-color-themeLight")}},bp:function(n){if(this.e)if(this.f===2){var i=this.b.find("."+"ms-bg-color-themeLight");var t=this.j();if(i.length>0||t.length>1){this.bq();n.preventDefault();n.stopPropagation()}else this.d()}else{this.bq();n.preventDefault();n.stopPropagation()}},bW:function(n){var t=0;switch(n.which){case 64:this.e&&this.d();this.c&&(t=1);break;case 35:this.e&&this.d();t=2;break;case 32:this.e&&(this.f===2?this.bp(n):this.d());break;default:if(this.e){var i=this;_js.g.a().c(_a.a.F,"EntitySuggesterBase",function(){i.bz()})}break}if(t){this.bj();this.e=!0;this.cc(t)}},bU:function(n){this.e&&this.f===2&&(this.a().is(":focus")||this.d())},bV:function(n){if(this.e)switch(n.which){case 37:case 39:case 36:case 35:case 33:case 34:this.d();break;case 27:this.d();n.preventDefault();n.stopImmediatePropagation();break;case 38:case 40:this.bT(n.which);n.preventDefault();break;case 13:case 9:this.bp(n);break;case 8:if(this.j().length===1)this.d();else{var t=this;_js.g.a().c(_a.a.F,"EntitySuggesterBase",function(){t.bz()})}break}},bR:function(){if(this.R()){this.b.bind("mousedown",this.Z);this.b.bind("mouseover",this.bf);this.b.bind("mouseout",this.bc)}},ce:function(){if(this.b){this.b.unbind("mousedown",this.Z);this.b.unbind("mouseover",this.bf);this.b.unbind("mouseout",this.bc)}},bX:function(n){if(n.which===1){this.u();var t=$(n.target);t.hasClass("entity-suggester-item")&&this.h(t.text());n.preventDefault()}},bZ:function(n){this.b.find("."+"entity-suggester-item").removeClass("ms-bg-color-themeLight");var t=$(n.target);t.hasClass("entity-suggester-item")&&t.addClass("ms-bg-color-themeLight")},bY:function(n){this.b.find("."+"entity-suggester-item").removeClass("ms-bg-color-themeLight")},cd:function(n){this.c&&this.c.j(this.t);this.c=n;this.c&&this.c.q(this.t);return n},ca:function(n,t){var i=this.c.h();if(i){this.v&&this.v.a(_cmc.o,new _cmc.o(i.a().a(),this.i[0]));this.a().focus();var f=i.a().a().EmailAddress;var u=f.replace(new RegExp("@.*"),"");this.h(u);var r=this;_js.g.a().c(_a.a.F,"EntitySuggesterBase",function(){r.a().focus()})}}};_cmc.h=function(){};_cmc.h.c=function(n){return n+Math.round(Math.random()*1e6).toString()};_cmc.h.b=function(n,t,i){return!_js.d.a(n)&&!_js.d.a(i)&&!_js.d.a(t)&&n.startsWith("OWAHT")&&t.lastIndexOf("#")>0&&i.startsWith("#")?!0:!1};_cmc.h.e=function(n){if(null!==n){var t=n.outerText;_js.d.a(t)&&(t=n.text);return _cmc.h.b(n.id,n.href,t)}return!1};_cmc.h.d=function(n){return String.format('<a href="{0}" ID="{1}">{0}</a>',n,_cmc.h.c("OWAHT"))};_cmc.h.a=function(n,t,i,r,u){if(null!==u&&_cmc.h.b(t,i,r)){u.a(_y.W,new _y.W(n,r,!0));return!0}return!1};_cmc.i=function(n){_cmc.i.initializeBase(this,[n])};_cmc.i.prototype={q:function(n){n&&this.v(n);return n},v:function(n){if(_cmc.g.isInstanceOfType(n)){var t=n;if(t.p){t.q=!0;return}var f=t.n?_ff.i.b(t.n):"";var r=this.b;var i=r.substring(0,this.cA())+f+r.substr(this.cz());i=this.cl(i,this.bK);this.c(i)}else if(_cmc.e.isInstanceOfType(n)){var u=n;u.a=this.b.substring(this.cA(),this.cz())}}};_cmc.b=function(){};_cmc.M=function(n,t){this.f=n;this.e=t};_cmc.M.prototype={f:null,e:0,c:function(){return this.e},d:function(){return this.f},b:function(){return!1},a:function(n){return n}};_cmc.D=function(n,t,i,r,u,f){this.n=n;this.i=t;this.k=i;this.l=r;this.m=u;this.j=f};_cmc.D.prototype={n:null,i:null,k:0,l:null,m:0,j:0,c:function(){return this.i},e:function(){return this.k},f:function(){return this.l},h:function(){return this.m},g:function(){return this.j},d:function(){return this.n},b:function(){return!1},a:function(n){return n}};_cmc.N=function(n,t,i,r,u){this.bn=Function.createDelegate(this,this.cq);_cmc.N.initializeBase(this,[n,t,i,r,u]);n.style.display="none"};_cmc.N.prototype={l:null,a:function(){return _cmc.A.prototype.a.call(this)},k:function(n){_cmc.A.prototype.a.call(this)&&this.bQ();_cmc.A.prototype.k.call(this,n);_cmc.A.prototype.a.call(this)&&this.cn();return n},s:function(n){this.k($(n));return n},bu:function(){this.a()&&this.bQ();_cmc.A.prototype.bu.call(this)},d:function(){this.a().find("#entity-begin-mark").remove();_cmc.A.prototype.d.call(this)},cn:function(){if(this.R()){this.a().bind("keypress",this.o);this.a().bind("keydown",this.n);this.a().bind("mousedown",this.bn);this.a().bind("blur",this.m)}},bQ:function(){this.a().unbind("keypress",this.o);this.a().unbind("keydown",this.n);this.a().unbind("mousedown",this.bn);this.a().unbind("blur",this.m)},h:function(n){var r=this.a().find("#entity-begin-mark");if(r.length>0){this.r("<span id=entity-end-mark></span>");var u=this.a().find("#entity-end-mark");var t=document.createRange();t.setStart(r[0],0);t.setEnd(u[0],0);t.deleteContents();r.remove();u.remove()}var i="";switch(this.f){case 2:i=_cmc.h.d(_ff.i.a("#"+n));break;case 1:i="@"+_ff.i.a(n)+" ";break}this.r(i);this.e=!1},j:function(){var i=this.a().find("#"+"entity-begin-mark");if(i.length>0){var r=this.bM();if(r){var n=r.cloneRange();n.setStart(i[0],0);var u=n.toString();var f=new RegExp("[#@][^\\s#@]*$");var t=f.exec(u);if(t)return t[0].replace(new RegExp("​","g"),"")}}return""},S:function(n,t){var f="<span id=medina-mark></span>";this.r(f);var r=this.a().find("#medina-mark");var i=r.offset();r.remove();var u=this.a().offset();n.val=i.left-u.left;t.val=i.top-u.top},bg:function(n,t){if(this.l){var r=parseInt(this.l.css("padding-top"),10);var u=parseInt(this.l.css("padding-left"),10);var i=this.l.offset();t.val+=i.left+u;n.val+=i.top+r}},r:function(n){n+="​";var i=this.bM();if(i){i.deleteContents();var e=document.createElement("div");e.innerHTML=n;for(var o,t=null,f=document.createDocumentFragment();o=e.firstChild;)t=f.appendChild(o);i.insertNode(f);if(t){var u=document.createRange();u.setStartAfter(t);var r=this.bK();r.removeAllRanges();r.addRange(u)}}},bj:function(){this.r("<span id=entity-begin-mark>​</span>")},cq:function(n){this.d()},bK:function(){var n=this.a()[0].ownerDocument;return n?n.getSelection():null},bM:function(){var n=this.bK();return n&&n.rangeCount>0?n.getRangeAt(0):null}};_cmc.E=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.bM);this.g=-1;_cmc.E.initializeBase(this,[n,t,i,r,u])};_cmc.E.prototype={a:function(){return _cmc.A.prototype.a.call(this)},k:function(n){_cmc.A.prototype.a.call(this)&&this.bm();_cmc.A.prototype.k.call(this,n);_cmc.A.prototype.a.call(this)&&this.bn();return n},bu:function(){this.bm();_cmc.A.prototype.bu.call(this)},bn:function(){if(this.R()){this.a().bind("keypress",this.o);this.a().bind("keydown",this.n);this.a().bind("mousedown",this.r);this.a().bind("blur",this.m)}},bm:function(){this.a().unbind("keypress",this.o);this.a().unbind("keydown",this.n);this.a().unbind("mousedown",this.r);this.a().unbind("blur",this.m)},bM:function(n){this.d()},bj:function(){this.g=this.l()},d:function(){this.g=-1;_cmc.A.prototype.d.call(this)},h:function(n){this.u();var i=this.l();this.bA(this.g,i-this.g);this.s(this.g);var t="";switch(this.f){case 2:t="#";break;case 1:t="@";break}this.bK(t+n+" ");this.e=!1},j:function(){if(this.g===-1)return"";var t=this.l();var n=this.a().val();return n.substr(this.g,t-this.g)},l:function(){var n=this.a()[0];return n.selectionStart},s:function(n){var t=this.a()[0];t.focus();t.setSelectionRange(n,n)},bG:function(){var t=this.l();var n=this.a().val();return n.substr(0,t)},bK:function(n){this.a().focus();var r=this.l();var i=this.a().val();var t=i.substr(0,r);var u=i.substr(r,i.length-t.length);this.a().val(t+n+u);this.s(t.length+n.length)},bA:function(n,t){var i=this.a().val();var u=i.substr(0,n);var r=i.substr(n+t);this.a().val(u+r)},S:function(n,t){for(var r=$("<div></div>").appendTo($(document.body)),o={position:"absolute",visibility:"hidden",display:"inline-block",whiteSpace:"pre"},c=window.getComputedStyle(this.a()[0]),e=_cmc.E.a,s=e.length,u=0;u<s;++u){var f=e[u];o[f]=c[f]}r.css(o);var h=this.bG();r.text(h);var i=r.width();r.remove();i=Math.min(i,this.a().width());i+=parseInt(this.a().css("padding-left"),10);n.val=i;t.val=0}};_cmc.R=function(n){this.d=new _ff.e;this.d.c(n)};_cmc.R.prototype={d:null,a:function(){return this.d},W:function(){return!this.d.d.length}};_cmc._TI=function(){};_cmc._TI.$$cctor=function(){var n="EntitySuggesterView";new _A(n,function(){_cmc._TI.a[n]===undefined&&(_cmc._TI.a[n]=[null,[[-1,1,["FindRecipientViewModel"],[_cmc._TI.d],null,"DataContext",null,_cmc._TI.c,1,null,null,null]]]);var t=_cmc._TI._hf.childNodes[0].cloneNode(!0);var i=new _js.b(t.children[1]);i.y("PeopleSuggesterViewWrapper");var r=new _js.b(t.children[0]);return new _B(t,[r,i])},_cmc.A,_cmc.A,function(n){return _js.a.Instance.a(_js.L.$$(_cmc.A)).a(n)},!1,!1,!1,0,_cmc._TI.a)};_cmc._TI.b=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_cc_2 ms-font-s ms-bgc-w'></div> <div></div> </div>";_js.c.a().appendChild(n);return n};_cmc._TI.d=function(n){return n.c};_cmc._TI.c=function(n,t){n.ba(t)};_cmc.o.registerClass("_cmc.o");_cmc.X.registerClass("_cmc.X",null,_y.fb,_h.du);_cmc.H.registerClass("_cmc.H",null,_h.du);_cmc.P.registerClass("_cmc.P",null,_y.eP,_h.du);_cmc.Q.registerClass("_cmc.Q",null,_y.eQ,_h.du);_cmc.d.registerClass("_cmc.d",null,_y.dm,_h.du);_cmc.I.registerClass("_cmc.I",null,_h.du);CommonComposeComponent.registerClass("CommonComposeComponent",null,_a.iM);_cmc.w.registerClass("_cmc.w",null,_h.du);_cmc.c.registerClass("_cmc.c",null,_y.bL,_h.du,_y.dt);_cmc.n.registerClass("_cmc.n",null,_y.dq,_h.du);_cmc.L.registerClass("_cmc.L",null,_y.dr,_h.du);_cmc.f.registerClass("_cmc.f",null,_h.du);_cmc.p.registerClass("_cmc.p",null,_h.du);_cmc.J.registerClass("_cmc.J",null,_y.gW,_h.du);_cmc.x.registerClass("_cmc.x",null,_h.du);_cmc.y.registerClass("_cmc.y",null,_h.du);_cmc.m.registerClass("_cmc.m",null,_h.du);_cmc.e.registerClass("_cmc.e",null,_y.hr,_h.du);_cmc.g.registerClass("_cmc.g",_cmc.d,_y.hr,_h.du);_cmc.K.registerClass("_cmc.K",_cmc.d,_h.du);_cmc.C.registerClass("_cmc.C",null,_y.fa,_h.du);_cmc.U.registerClass("_cmc.U",_a.bz);_cmc.r.registerClass("_cmc.r");_cmc.Y.registerClass("_cmc.Y");_cmc.T.registerClass("_cmc.T",_cmc.Y);_cmc.S.registerClass("_cmc.S",_a.ca);_cmc.a.registerClass("_cmc.a",_js.c);_cmc.A.registerClass("_cmc.A",_js.b);_cmc.i.registerClass("_cmc.i",_fc.h);_cmc.N.registerClass("_cmc.N",_cmc.A);_cmc.E.registerClass("_cmc.E",_cmc.A);_cmc.R.registerClass("_cmc.R",null,IOutstandingComposeContext,IContext);_cmc._TI.registerClass("_cmc._TI");CommonComposeComponent.$$cctor();_cmc.j.c=new _y.cr;_cmc.a.b=new RegExp("<p>\\s*</p>","gim");_cmc.a.e=new RegExp("​","gim");_cmc.a.a=_a.a.t;_cmc.a.c=new RegExp("(<style[^>]*>)[\\s]*p[\\s]*{[^}]*}","i");_cmc.a.d=new RegExp("}[\\s]*p[\\s]*{[^}]*","gi");_cmc.b.a=[["Angsana New","'Angsana New',Serif","'Times'"],["Arial","Arial,Helvetica,sans-serif"],["Arial Black","'Arial Black',Arial,Helvetica,sans-serif","'Helvetica'"],["Calibri","Calibri,Arial,Helvetica,sans-serif"],["Cambria","Cambria,Serif","'Times'"],["Comic Sans MS","'Comic Sans MS',Fantasy,cursive"],["Candara","Candara,Sans-Serif","'Helvetica'"],["Consolas","Consolas,monospace","'Courier'"],["Constantia","Constantia,Serif","'Times'"],["Corbel","Corbel,Sans-Serif","'Helvetica'"],["Cordia New","'Cordia New',Sans-Serif","'Helvetica'"],["Courier New","'Courier New',monospace"],["DaunPenh","DaunPenh,Sans-Serif","'Helvetica'"],["Franklin Gothic Medium","'Franklin Gothic Medium',sans-serif","'Helvetica'"],["Garamond","Garamond,Georgia,serif","'Times'"],["Gautami","Gautami,Sans-Serif","'Helvetica'"],["Georgia","Georgia,serif"],["Gungsuh","Gungsuh,Serif","'Apple Myungjo'"],["Helvetica","Helvetica, Sans-Serif"],["Impact","Impact, Charcoal, sans-serif"],["Iskoola Pota","'Iskoola Pota',Sans-Serif","'Helvetica'"],["Kalinga","Kalinga,Sans-Serif","'Helvetica'"],["Kartika","Kartika,Sans-Serif","'Helvetica'"],["Latha","Latha,Sans-Serif","'Helvetica'"],["Lucida Console","'Lucida Console', Monaco, monospace","'Courier'"],["Lucida Handwriting","'Lucida Handwriting','Comic Sans MS',Fantasy,cursive"],["Lucida Sans Unicode","'Lucida Sans Unicode', 'Lucida Grande', sans-serif","'Helvetica'"],["Mangal","Mangal,Sans-Serif","'Helvetica'"],["Palatino Linotype","'Palatino Linotype', 'Book Antiqua', Palatino, serif"],["Segoe","Segoe,'Segoe UI', Sans-Serif","'Helvetica'"],["Segoe UI","'Segoe UI',Sans-Serif","'Helvetica'"],["Symbol","Symbol,'Segoe UI',Tahoma,Sans-Serif"],["Tahoma","Tahoma, Geneva, sans-serif"],["Times","Times,'Times New Roman',Serif"],["Times New Roman","'Times New Roman', Times, serif"],["Trebuchet MS","'Trebuchet MS', sans-serif"],["Tunga","Tunga,Sans-Serif","'Helvetica'"],["Verdana","Verdana, Geneva, sans-serif"],["Vrinda","Vrinda,Sans-Serif","'Helvetica'"],["Wingdings","Wingdings,Zapf Dingbats"],["黑体","SimHei,'黑体',Sans-Serif","'Heiti SC'"],["微軟正黑體","'Microsoft JhengHei','微軟正黑體',Sans-Serif","'Heiti TC'"],["微软雅黑","'Microsoft YaHei','微软雅黑',Sans-Serif","'Heiti SC'"],["宋体","SimSun,'宋体',Serif","'ST Song'"],["宋体-ExtB","SimSun-ExtB,Serif","'ST Song'"],["新宋体","NSimSun,SimSun,'新宋体',Serif","'ST Song'"],["仿宋","FangSong,'仿宋',Serif","'ST Song'"],["隶书","SimLi,FangSong,'隶书',Serif","'ST Song'"],["楷体","KaiTi,'楷体'，Sans-Serif","'Heiti SC'"],["細明體","MingLiU,'細明體',Serif","'Apple LiSung'"],["細明體_HKSCS","MingLiU_HKSCS,'細明體_HKSCS',Serif","'Apple LiSung'"],["新細明體","PMingLiU,'新細明體',Serif","'Apple LiSung'"],["新細明體-ExtB","PMingLiU-ExtB,'新細明體-ExtB',Serif","'Apple LiSung'"],["標楷體","DFKai-SB,MingLiU,'標楷體',Serif","'Apple LiSung'"],["맑은 고딕","'Malgun Gothic','맑은 고딕',Sans-Serif","'Apple Gothic'"],["굴림","Gulim,'굴림',Sans-Serif","'Apple Gothic'"],["돋움","Dotum,'돋움',Sans-Serif","'Apple Gothic'"],["바탕","Batang,'바탕',Serif","'Apple Myungjo'"],["メイリオ","Meiryo,'メイリオ',Sans-Serif","'Hiragino Kaku Gothic ProN'"],["ＭＳ ゴシック","'MS Gothic','ＭＳ ゴシック',Sans-Serif","'Hiragino Kaku Gothic ProN'"],["ＭＳ Ｐゴシック","'MS PGothic','ＭＳ Ｐゴシック',Sans-Serif","'Hiragino Kaku Gothic ProN'"],["ＭＳ 明朝","'MS Mincho','ＭＳ 明朝',Serif","'Hiragino Mincho ProN'"],["ＭＳ Ｐ明朝","'MS PMincho','ＭＳ Ｐ明朝',Serif","'Hiragino Mincho ProN'"],["Nyala","Nyala,Sans-Serif"],["Raavi","Raavi,Sans-Serif","'Gurmukhi'"],["Shruti","Shruti,Sans-Serif","'Gujarati'"],["Sylfaen","Sylfaen,Serif","'Mshtakan'"]];_cmc.b.c=[["Batang","바탕"],["Dotum","돋움"],["FangSong","仿宋"],["Gulim","굴림"],["Malgun Gothic","맑은 고딕"],["Meiryo","メイリオ"],["Microsoft JhengHei","微軟正黑體"],["Microsoft YaHei","微软雅黑"],["MingLiU","細明體"],["MingLiU_HKSCS","細明體_HKSCS"],["MS Gothic","ＭＳ ゴシック"],["MS Mincho","ＭＳ 明朝"],["MS PGothic","ＭＳ Ｐゴシック"],["MS PMincho","ＭＳ Ｐ明朝"],["PMingLiU","新細明體"],["PMingLiU-ExtB","新細明體-ExtB"],["SimHei","黑体"],["SimSun","宋体"],["SimSun-ExtB","宋体-ExtB"],["KaiTi","楷体"],["DFKai-SB","標楷體"],["SimLi","隶书"],["NSimSun","新宋体"]];_cmc.b.b=["","8","10","12","14","18","24","36"];_cmc.E.a=["textTransform","textIndent","letterSpacing","wordSpacing","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","fontFamily"];_cmc._TI._hf=_cmc._TI.b();_cmc._TI.a={};_cmc._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.common.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.common.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
